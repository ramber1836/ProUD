2019-02-24 14:48:40.071413: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 14:48:41.307369: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 14:48:41.314146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 14:48:41.314197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.330000 seconds
loading data in 31.500000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.747397    reg_loss: 0.000000    l2_loss: 0.013290    loss: 0.760687
steps 200    v_Prec: 0.165977  v_Recall: 1.000000  v_F1: 0.284701  v_AUC: 0.529206
steps 200    running time 41 seconds

steps 400    base_loss: 0.545516    reg_loss: 0.000000    l2_loss: 0.013083    loss: 0.558600
steps 400    v_Prec: 0.178070  v_Recall: 0.738836  v_F1: 0.286975  v_AUC: 0.554576
steps 400    running time 48 seconds

steps 600    base_loss: 0.482998    reg_loss: 0.000000    l2_loss: 0.013004    loss: 0.496002
steps 600    v_Prec: 0.194953  v_Recall: 0.648585  v_F1: 0.299793  v_AUC: 0.586680
steps 600    running time 54 seconds

steps 800    base_loss: 0.471313    reg_loss: 0.000000    l2_loss: 0.012885    loss: 0.484197
steps 800    v_Prec: 0.205573  v_Recall: 0.602044  v_F1: 0.306492  v_AUC: 0.596831
steps 800    running time 61 seconds

steps 1000    base_loss: 0.448623    reg_loss: 0.000000    l2_loss: 0.012792    loss: 0.461415
steps 1000    v_Prec: 0.216476  v_Recall: 0.585456  v_F1: 0.316080  v_AUC: 0.613479
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.445595    reg_loss: 0.000000    l2_loss: 0.012795    loss: 0.458390
steps 1200    v_Prec: 0.281383  v_Recall: 0.471384  v_F1: 0.352405  v_AUC: 0.661056
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.423104    reg_loss: 0.000000    l2_loss: 0.012867    loss: 0.435970
steps 1400    v_Prec: 0.411389  v_Recall: 0.435613  v_F1: 0.423155  v_AUC: 0.720619
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.395003    reg_loss: 0.000000    l2_loss: 0.013033    loss: 0.408036
steps 1600    v_Prec: 0.476516  v_Recall: 0.492925  v_F1: 0.484581  v_AUC: 0.770809
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.373564    reg_loss: 0.000000    l2_loss: 0.013213    loss: 0.386777
steps 1800    v_Prec: 0.524366  v_Recall: 0.536321  v_F1: 0.530276  v_AUC: 0.804412
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.346941    reg_loss: 0.000000    l2_loss: 0.013469    loss: 0.360410
steps 2000    v_Prec: 0.629828  v_Recall: 0.535849  v_F1: 0.579050  v_AUC: 0.832631
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.330426    reg_loss: 0.000000    l2_loss: 0.013740    loss: 0.344167
steps 2200    v_Prec: 0.669469  v_Recall: 0.550943  v_F1: 0.604451  v_AUC: 0.847406
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.322909    reg_loss: 0.000000    l2_loss: 0.014025    loss: 0.336934
steps 2400    v_Prec: 0.690347  v_Recall: 0.568396  v_F1: 0.623464  v_AUC: 0.858523
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.309100    reg_loss: 0.000000    l2_loss: 0.014318    loss: 0.323417
steps 2600    v_Prec: 0.703496  v_Recall: 0.582154  v_F1: 0.637099  v_AUC: 0.866340
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.301578    reg_loss: 0.000000    l2_loss: 0.014614    loss: 0.316192
steps 2800    v_Prec: 0.715716  v_Recall: 0.590016  v_F1: 0.646815  v_AUC: 0.871948
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.297163    reg_loss: 0.000000    l2_loss: 0.014944    loss: 0.312107
steps 3000    v_Prec: 0.719851  v_Recall: 0.607233  v_F1: 0.658763  v_AUC: 0.877043
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.286665    reg_loss: 0.000000    l2_loss: 0.015223    loss: 0.301889
steps 3200    v_Prec: 0.737048  v_Recall: 0.607311  v_F1: 0.665920  v_AUC: 0.880875
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.280850    reg_loss: 0.000000    l2_loss: 0.015484    loss: 0.296334
steps 3400    v_Prec: 0.735605  v_Recall: 0.622720  v_F1: 0.674472  v_AUC: 0.884268
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.278598    reg_loss: 0.000000    l2_loss: 0.015756    loss: 0.294355
steps 3600    v_Prec: 0.727160  v_Recall: 0.642610  v_F1: 0.682275  v_AUC: 0.887404
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.281623    reg_loss: 0.000000    l2_loss: 0.016049    loss: 0.297672
steps 3800    v_Prec: 0.733651  v_Recall: 0.641195  v_F1: 0.684314  v_AUC: 0.890995
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.275532    reg_loss: 0.000000    l2_loss: 0.016279    loss: 0.291811
steps 4000    v_Prec: 0.728213  v_Recall: 0.652987  v_F1: 0.688552  v_AUC: 0.893433
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.268267    reg_loss: 0.000000    l2_loss: 0.016587    loss: 0.284855
steps 4200    v_Prec: 0.732272  v_Recall: 0.661635  v_F1: 0.695164  v_AUC: 0.897011
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.261603    reg_loss: 0.000000    l2_loss: 0.016762    loss: 0.278365
steps 4400    v_Prec: 0.744800  v_Recall: 0.658726  v_F1: 0.699124  v_AUC: 0.899644
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.271041    reg_loss: 0.000000    l2_loss: 0.017075    loss: 0.288115
steps 4600    v_Prec: 0.737258  v_Recall: 0.674371  v_F1: 0.704414  v_AUC: 0.901843
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.263692    reg_loss: 0.000000    l2_loss: 0.017407    loss: 0.281100
steps 4800    v_Prec: 0.767496  v_Recall: 0.652673  v_F1: 0.705442  v_AUC: 0.904229
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.264799    reg_loss: 0.000000    l2_loss: 0.017760    loss: 0.282559
steps 5000    v_Prec: 0.756754  v_Recall: 0.665016  v_F1: 0.707925  v_AUC: 0.905093
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.265205    reg_loss: 0.000000    l2_loss: 0.018070    loss: 0.283275
steps 5200    v_Prec: 0.742479  v_Recall: 0.679088  v_F1: 0.709370  v_AUC: 0.905768
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.249873    reg_loss: 0.000000    l2_loss: 0.018432    loss: 0.268306
steps 5400    v_Prec: 0.753278  v_Recall: 0.673035  v_F1: 0.710899  v_AUC: 0.907248
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.167740    reg_loss: 0.000000    l2_loss: 0.019036    loss: 0.186775
steps 5600    v_Prec: 0.756658  v_Recall: 0.665645  v_F1: 0.708239  v_AUC: 0.903711
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.184582    reg_loss: 0.000000    l2_loss: 0.019667    loss: 0.204249
steps 5800    v_Prec: 0.766415  v_Recall: 0.663443  v_F1: 0.711222  v_AUC: 0.903179
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.174289    reg_loss: 0.000000    l2_loss: 0.020344    loss: 0.194633
steps 6000    v_Prec: 0.754026  v_Recall: 0.669969  v_F1: 0.709516  v_AUC: 0.900694
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.175688    reg_loss: 0.000000    l2_loss: 0.020945    loss: 0.196633
steps 6200    v_Prec: 0.758479  v_Recall: 0.668082  v_F1: 0.710416  v_AUC: 0.902074
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.182251    reg_loss: 0.000000    l2_loss: 0.021411    loss: 0.203663
steps 6400    v_Prec: 0.765368  v_Recall: 0.668553  v_F1: 0.713692  v_AUC: 0.903786
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.178753    reg_loss: 0.000000    l2_loss: 0.021893    loss: 0.200646
steps 6600    v_Prec: 0.768707  v_Recall: 0.665487  v_F1: 0.713383  v_AUC: 0.903302
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.181366    reg_loss: 0.000000    l2_loss: 0.022204    loss: 0.203570
steps 6800    v_Prec: 0.765413  v_Recall: 0.670519  v_F1: 0.714830  v_AUC: 0.903307
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.187281    reg_loss: 0.000000    l2_loss: 0.022696    loss: 0.209977
steps 7000    v_Prec: 0.767573  v_Recall: 0.674764  v_F1: 0.718183  v_AUC: 0.904207
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.188511    reg_loss: 0.000000    l2_loss: 0.023012    loss: 0.211523
steps 7200    v_Prec: 0.779102  v_Recall: 0.668239  v_F1: 0.719424  v_AUC: 0.905864
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.172322    reg_loss: 0.000000    l2_loss: 0.023323    loss: 0.195645
steps 7400    v_Prec: 0.788342  v_Recall: 0.668789  v_F1: 0.723661  v_AUC: 0.907365
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.193253    reg_loss: 0.000000    l2_loss: 0.023616    loss: 0.216869
steps 7600    v_Prec: 0.777398  v_Recall: 0.680346  v_F1: 0.725641  v_AUC: 0.909225
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.183499    reg_loss: 0.000000    l2_loss: 0.023795    loss: 0.207294
steps 7800    v_Prec: 0.773665  v_Recall: 0.686871  v_F1: 0.727689  v_AUC: 0.910403
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.182063    reg_loss: 0.000000    l2_loss: 0.023864    loss: 0.205927
steps 8000    v_Prec: 0.778640  v_Recall: 0.686635  v_F1: 0.729749  v_AUC: 0.908837
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.180252    reg_loss: 0.000000    l2_loss: 0.024112    loss: 0.204364
steps 8200    v_Prec: 0.770317  v_Recall: 0.698978  v_F1: 0.732916  v_AUC: 0.912832
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.190754    reg_loss: 0.000000    l2_loss: 0.024176    loss: 0.214930
steps 8400    v_Prec: 0.766159  v_Recall: 0.704481  v_F1: 0.734027  v_AUC: 0.912593
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.190480    reg_loss: 0.000000    l2_loss: 0.024417    loss: 0.214897
steps 8600    v_Prec: 0.781561  v_Recall: 0.698428  v_F1: 0.737659  v_AUC: 0.912529
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.181369    reg_loss: 0.000000    l2_loss: 0.024525    loss: 0.205894
steps 8800    v_Prec: 0.775334  v_Recall: 0.706761  v_F1: 0.739461  v_AUC: 0.915312
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.182572    reg_loss: 0.000000    l2_loss: 0.024569    loss: 0.207142
steps 9000    v_Prec: 0.776477  v_Recall: 0.703774  v_F1: 0.738340  v_AUC: 0.914172
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.185581    reg_loss: 0.000000    l2_loss: 0.024600    loss: 0.210180
steps 9200    v_Prec: 0.769775  v_Recall: 0.718396  v_F1: 0.743199  v_AUC: 0.917230
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.191727    reg_loss: 0.000000    l2_loss: 0.024710    loss: 0.216437
steps 9400    v_Prec: 0.783213  v_Recall: 0.708648  v_F1: 0.744067  v_AUC: 0.917388
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.185994    reg_loss: 0.000000    l2_loss: 0.024816    loss: 0.210810
steps 9600    v_Prec: 0.759318  v_Recall: 0.728695  v_F1: 0.743692  v_AUC: 0.918143
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.184169    reg_loss: 0.000000    l2_loss: 0.024770    loss: 0.208939
steps 9800    v_Prec: 0.795702  v_Recall: 0.707311  v_F1: 0.748907  v_AUC: 0.920877
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.182162    reg_loss: 0.000000    l2_loss: 0.024909    loss: 0.207071
steps 10000    v_Prec: 0.765801  v_Recall: 0.727752  v_F1: 0.746292  v_AUC: 0.921022
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.185228    reg_loss: 0.000000    l2_loss: 0.024860    loss: 0.210087
steps 10200    v_Prec: 0.772796  v_Recall: 0.724921  v_F1: 0.748093  v_AUC: 0.922095
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.173112    reg_loss: 0.000000    l2_loss: 0.024884    loss: 0.197996
steps 10400    v_Prec: 0.784053  v_Recall: 0.718160  v_F1: 0.749661  v_AUC: 0.922419
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.178001    reg_loss: 0.000000    l2_loss: 0.024907    loss: 0.202909
steps 10600    v_Prec: 0.791232  v_Recall: 0.715094  v_F1: 0.751239  v_AUC: 0.923193
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.174403    reg_loss: 0.000000    l2_loss: 0.024903    loss: 0.199306
steps 10800    v_Prec: 0.793618  v_Recall: 0.715566  v_F1: 0.752573  v_AUC: 0.924483
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.067140    reg_loss: 0.000000    l2_loss: 0.024958    loss: 0.092099
steps 11000    v_Prec: 0.786738  v_Recall: 0.716352  v_F1: 0.749897  v_AUC: 0.921617
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.066251    reg_loss: 0.000000    l2_loss: 0.024878    loss: 0.091130
steps 11200    v_Prec: 0.781361  v_Recall: 0.710535  v_F1: 0.744266  v_AUC: 0.915759
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.064440    reg_loss: 0.000000    l2_loss: 0.024812    loss: 0.089252
steps 11400    v_Prec: 0.778461  v_Recall: 0.706918  v_F1: 0.740967  v_AUC: 0.914153
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.068212    reg_loss: 0.000000    l2_loss: 0.024761    loss: 0.092973
steps 11600    v_Prec: 0.799546  v_Recall: 0.692374  v_F1: 0.742111  v_AUC: 0.912995
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.068593    reg_loss: 0.000000    l2_loss: 0.024870    loss: 0.093462
steps 11800    v_Prec: 0.781242  v_Recall: 0.703302  v_F1: 0.740226  v_AUC: 0.912797
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.069672    reg_loss: 0.000000    l2_loss: 0.024995    loss: 0.094667
steps 12000    v_Prec: 0.768438  v_Recall: 0.715094  v_F1: 0.740807  v_AUC: 0.913601
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.071380    reg_loss: 0.000000    l2_loss: 0.024952    loss: 0.096332
steps 12200    v_Prec: 0.777885  v_Recall: 0.699607  v_F1: 0.736672  v_AUC: 0.911701
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.077820    reg_loss: 0.000000    l2_loss: 0.024869    loss: 0.102689
steps 12400    v_Prec: 0.781903  v_Recall: 0.685456  v_F1: 0.730510  v_AUC: 0.910847
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.076932    reg_loss: 0.000000    l2_loss: 0.024793    loss: 0.101726
steps 12600    v_Prec: 0.796476  v_Recall: 0.682390  v_F1: 0.735033  v_AUC: 0.912729
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.072822    reg_loss: 0.000000    l2_loss: 0.024867    loss: 0.097688
steps 12800    v_Prec: 0.766184  v_Recall: 0.711792  v_F1: 0.737988  v_AUC: 0.911440
steps 12800    running time 451 seconds

Early stop model F1: 0.752573
testing thre: 0.58676064
testing Prec: 0.5982111194294496
testing Recall: 0.7378857837181045
testing F1: 0.6607477042259652
testing AUC: 0.9005639584598556
overall running time 454 seconds
(0.7059130798161304, 0.65681652490887, 0.6804803746317883, 0.9005639584598556, 0.79393697)

2019-02-24 14:53:34.874547: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 14:53:35.237708: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 14:53:35.275110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 14:53:35.275190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.510000 seconds
loading data in 30.650000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.523879    reg_loss: 0.000000    l2_loss: 0.013289    loss: 0.537168
steps 200    v_Prec: 0.163888  v_Recall: 0.997689  v_F1: 0.281529  v_AUC: 0.534595
steps 200    running time 41 seconds

steps 400    base_loss: 0.506810    reg_loss: 0.000000    l2_loss: 0.013271    loss: 0.520081
steps 400    v_Prec: 0.172617  v_Recall: 0.829814  v_F1: 0.285785  v_AUC: 0.555277
steps 400    running time 47 seconds

steps 600    base_loss: 0.470116    reg_loss: 0.000000    l2_loss: 0.013200    loss: 0.483317
steps 600    v_Prec: 0.192573  v_Recall: 0.650785  v_F1: 0.297202  v_AUC: 0.585726
steps 600    running time 54 seconds

steps 800    base_loss: 0.450400    reg_loss: 0.000000    l2_loss: 0.013124    loss: 0.463524
steps 800    v_Prec: 0.251708  v_Recall: 0.484264  v_F1: 0.331244  v_AUC: 0.641915
steps 800    running time 60 seconds

steps 1000    base_loss: 0.433913    reg_loss: 0.000000    l2_loss: 0.013162    loss: 0.447075
steps 1000    v_Prec: 0.336078  v_Recall: 0.445463  v_F1: 0.383116  v_AUC: 0.696307
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.415344    reg_loss: 0.000000    l2_loss: 0.013197    loss: 0.428541
steps 1200    v_Prec: 0.411979  v_Recall: 0.469126  v_F1: 0.438699  v_AUC: 0.740680
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.383253    reg_loss: 0.000000    l2_loss: 0.013343    loss: 0.396596
steps 1400    v_Prec: 0.504228  v_Recall: 0.470321  v_F1: 0.486685  v_AUC: 0.775298
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.365876    reg_loss: 0.000000    l2_loss: 0.013505    loss: 0.379380
steps 1600    v_Prec: 0.587044  v_Recall: 0.475819  v_F1: 0.525612  v_AUC: 0.803698
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.348881    reg_loss: 0.000000    l2_loss: 0.013697    loss: 0.362578
steps 1800    v_Prec: 0.623851  v_Recall: 0.508087  v_F1: 0.560049  v_AUC: 0.824731
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.334328    reg_loss: 0.000000    l2_loss: 0.013904    loss: 0.348232
steps 2000    v_Prec: 0.628988  v_Recall: 0.543542  v_F1: 0.583152  v_AUC: 0.837364
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.319964    reg_loss: 0.000000    l2_loss: 0.014154    loss: 0.334118
steps 2200    v_Prec: 0.687821  v_Recall: 0.544897  v_F1: 0.608073  v_AUC: 0.848791
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.311750    reg_loss: 0.000000    l2_loss: 0.014459    loss: 0.326209
steps 2400    v_Prec: 0.672095  v_Recall: 0.575492  v_F1: 0.620053  v_AUC: 0.857118
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.313316    reg_loss: 0.000000    l2_loss: 0.014750    loss: 0.328066
steps 2600    v_Prec: 0.703337  v_Recall: 0.582742  v_F1: 0.637386  v_AUC: 0.865081
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.296537    reg_loss: 0.000000    l2_loss: 0.014970    loss: 0.311507
steps 2800    v_Prec: 0.711813  v_Recall: 0.583300  v_F1: 0.641181  v_AUC: 0.868171
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.289574    reg_loss: 0.000000    l2_loss: 0.015307    loss: 0.304881
steps 3000    v_Prec: 0.694759  v_Recall: 0.616764  v_F1: 0.653442  v_AUC: 0.872711
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.286668    reg_loss: 0.000000    l2_loss: 0.015537    loss: 0.302205
steps 3200    v_Prec: 0.712536  v_Recall: 0.616365  v_F1: 0.660971  v_AUC: 0.878145
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.281135    reg_loss: 0.000000    l2_loss: 0.015858    loss: 0.296993
steps 3400    v_Prec: 0.722080  v_Recall: 0.628476  v_F1: 0.672034  v_AUC: 0.882067
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.281264    reg_loss: 0.000000    l2_loss: 0.016114    loss: 0.297378
steps 3600    v_Prec: 0.736146  v_Recall: 0.633973  v_F1: 0.681250  v_AUC: 0.885288
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.278160    reg_loss: 0.000000    l2_loss: 0.016428    loss: 0.294587
steps 3800    v_Prec: 0.720902  v_Recall: 0.657318  v_F1: 0.687643  v_AUC: 0.888874
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.271078    reg_loss: 0.000000    l2_loss: 0.016740    loss: 0.287818
steps 4000    v_Prec: 0.744311  v_Recall: 0.648952  v_F1: 0.693369  v_AUC: 0.891968
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.269246    reg_loss: 0.000000    l2_loss: 0.016960    loss: 0.286206
steps 4200    v_Prec: 0.740989  v_Recall: 0.660107  v_F1: 0.698213  v_AUC: 0.895502
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.263844    reg_loss: 0.000000    l2_loss: 0.017262    loss: 0.281106
steps 4400    v_Prec: 0.761052  v_Recall: 0.650147  v_F1: 0.701242  v_AUC: 0.898645
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.267470    reg_loss: 0.000000    l2_loss: 0.017530    loss: 0.285000
steps 4600    v_Prec: 0.748759  v_Recall: 0.660824  v_F1: 0.702048  v_AUC: 0.900079
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.257861    reg_loss: 0.000000    l2_loss: 0.017824    loss: 0.275685
steps 4800    v_Prec: 0.743034  v_Recall: 0.671341  v_F1: 0.705370  v_AUC: 0.902653
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.260620    reg_loss: 0.000000    l2_loss: 0.018073    loss: 0.278693
steps 5000    v_Prec: 0.757225  v_Recall: 0.661780  v_F1: 0.706293  v_AUC: 0.905607
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.255577    reg_loss: 0.000000    l2_loss: 0.018344    loss: 0.273921
steps 5200    v_Prec: 0.757250  v_Recall: 0.674050  v_F1: 0.713232  v_AUC: 0.907689
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.247361    reg_loss: 0.000000    l2_loss: 0.018767    loss: 0.266127
steps 5400    v_Prec: 0.740265  v_Recall: 0.689188  v_F1: 0.713814  v_AUC: 0.908163
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.164986    reg_loss: 0.000000    l2_loss: 0.019241    loss: 0.184227
steps 5600    v_Prec: 0.741806  v_Recall: 0.678034  v_F1: 0.708488  v_AUC: 0.899790
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.158501    reg_loss: 0.000000    l2_loss: 0.019938    loss: 0.178440
steps 5800    v_Prec: 0.773795  v_Recall: 0.653573  v_F1: 0.708621  v_AUC: 0.897466
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.174338    reg_loss: 0.000000    l2_loss: 0.020713    loss: 0.195051
steps 6000    v_Prec: 0.741975  v_Recall: 0.675882  v_F1: 0.707388  v_AUC: 0.896150
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.171318    reg_loss: 0.000000    l2_loss: 0.021381    loss: 0.192699
steps 6200    v_Prec: 0.772805  v_Recall: 0.650705  v_F1: 0.706518  v_AUC: 0.896050
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.176624    reg_loss: 0.000000    l2_loss: 0.021923    loss: 0.198547
steps 6400    v_Prec: 0.763493  v_Recall: 0.663851  v_F1: 0.710194  v_AUC: 0.895797
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.174788    reg_loss: 0.000000    l2_loss: 0.022468    loss: 0.197255
steps 6600    v_Prec: 0.737217  v_Recall: 0.684647  v_F1: 0.709960  v_AUC: 0.898010
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.173074    reg_loss: 0.000000    l2_loss: 0.022929    loss: 0.196003
steps 6800    v_Prec: 0.763046  v_Recall: 0.674528  v_F1: 0.716062  v_AUC: 0.901235
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.169444    reg_loss: 0.000000    l2_loss: 0.023229    loss: 0.192673
steps 7000    v_Prec: 0.771760  v_Recall: 0.673253  v_F1: 0.719149  v_AUC: 0.899258
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.180356    reg_loss: 0.000000    l2_loss: 0.023603    loss: 0.203959
steps 7200    v_Prec: 0.761456  v_Recall: 0.683133  v_F1: 0.720171  v_AUC: 0.901472
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.175695    reg_loss: 0.000000    l2_loss: 0.023885    loss: 0.199580
steps 7400    v_Prec: 0.757182  v_Recall: 0.690941  v_F1: 0.722546  v_AUC: 0.902887
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.181141    reg_loss: 0.000000    l2_loss: 0.024175    loss: 0.205316
steps 7600    v_Prec: 0.772091  v_Recall: 0.681539  v_F1: 0.723995  v_AUC: 0.902877
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.177252    reg_loss: 0.000000    l2_loss: 0.024296    loss: 0.201548
steps 7800    v_Prec: 0.745167  v_Recall: 0.697076  v_F1: 0.720319  v_AUC: 0.904727
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.179208    reg_loss: 0.000000    l2_loss: 0.024440    loss: 0.203648
steps 8000    v_Prec: 0.763841  v_Recall: 0.691419  v_F1: 0.725828  v_AUC: 0.906645
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.184217    reg_loss: 0.000000    l2_loss: 0.024662    loss: 0.208878
steps 8200    v_Prec: 0.764354  v_Recall: 0.703211  v_F1: 0.732509  v_AUC: 0.911674
steps 8200    running time 301 seconds

steps 8400    base_loss: 0.184822    reg_loss: 0.000000    l2_loss: 0.024792    loss: 0.209614
steps 8400    v_Prec: 0.765989  v_Recall: 0.702334  v_F1: 0.732782  v_AUC: 0.910099
steps 8400    running time 308 seconds

steps 8600    base_loss: 0.174877    reg_loss: 0.000000    l2_loss: 0.024904    loss: 0.199781
steps 8600    v_Prec: 0.761905  v_Recall: 0.704964  v_F1: 0.732329  v_AUC: 0.911444
steps 8600    running time 314 seconds

steps 8800    base_loss: 0.185610    reg_loss: 0.000000    l2_loss: 0.025157    loss: 0.210767
steps 8800    v_Prec: 0.775579  v_Recall: 0.699387  v_F1: 0.735515  v_AUC: 0.912407
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.182576    reg_loss: 0.000000    l2_loss: 0.025320    loss: 0.207897
steps 9000    v_Prec: 0.757947  v_Recall: 0.710541  v_F1: 0.733479  v_AUC: 0.913617
steps 9000    running time 327 seconds

steps 9200    base_loss: 0.187231    reg_loss: 0.000000    l2_loss: 0.025403    loss: 0.212634
steps 9200    v_Prec: 0.761380  v_Recall: 0.715640  v_F1: 0.737802  v_AUC: 0.916502
steps 9200    running time 333 seconds

steps 9400    base_loss: 0.180422    reg_loss: 0.000000    l2_loss: 0.025417    loss: 0.205839
steps 9400    v_Prec: 0.782589  v_Recall: 0.698351  v_F1: 0.738074  v_AUC: 0.916088
steps 9400    running time 339 seconds

steps 9600    base_loss: 0.188674    reg_loss: 0.000000    l2_loss: 0.025584    loss: 0.214258
steps 9600    v_Prec: 0.795883  v_Recall: 0.696200  v_F1: 0.742711  v_AUC: 0.917643
steps 9600    running time 346 seconds

steps 9800    base_loss: 0.181928    reg_loss: 0.000000    l2_loss: 0.025668    loss: 0.207596
steps 9800    v_Prec: 0.779122  v_Recall: 0.718349  v_F1: 0.747502  v_AUC: 0.920877
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.178657    reg_loss: 0.000000    l2_loss: 0.025597    loss: 0.204254
steps 10000    v_Prec: 0.781855  v_Recall: 0.711338  v_F1: 0.744931  v_AUC: 0.919122
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.187640    reg_loss: 0.000000    l2_loss: 0.025711    loss: 0.213352
steps 10200    v_Prec: 0.800855  v_Recall: 0.701697  v_F1: 0.748004  v_AUC: 0.921485
steps 10200    running time 366 seconds

steps 10400    base_loss: 0.179931    reg_loss: 0.000000    l2_loss: 0.025616    loss: 0.205547
steps 10400    v_Prec: 0.771057  v_Recall: 0.727193  v_F1: 0.748483  v_AUC: 0.920306
steps 10400    running time 373 seconds

steps 10600    base_loss: 0.191381    reg_loss: 0.000000    l2_loss: 0.025646    loss: 0.217027
steps 10600    v_Prec: 0.764511  v_Recall: 0.733567  v_F1: 0.748719  v_AUC: 0.920865
steps 10600    running time 379 seconds

steps 10800    base_loss: 0.168678    reg_loss: 0.000000    l2_loss: 0.025766    loss: 0.194444
steps 10800    v_Prec: 0.767434  v_Recall: 0.733009  v_F1: 0.749827  v_AUC: 0.922133
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.067121    reg_loss: 0.000000    l2_loss: 0.025755    loss: 0.092876
steps 11000    v_Prec: 0.775171  v_Recall: 0.721377  v_F1: 0.747307  v_AUC: 0.918799
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.064268    reg_loss: 0.000000    l2_loss: 0.025587    loss: 0.089855
steps 11200    v_Prec: 0.783316  v_Recall: 0.702494  v_F1: 0.740707  v_AUC: 0.913257
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.062823    reg_loss: 0.000000    l2_loss: 0.025588    loss: 0.088411
steps 11400    v_Prec: 0.762249  v_Recall: 0.713967  v_F1: 0.737318  v_AUC: 0.912897
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.069490    reg_loss: 0.000000    l2_loss: 0.025671    loss: 0.095161
steps 11600    v_Prec: 0.797483  v_Recall: 0.681460  v_F1: 0.734920  v_AUC: 0.909829
steps 11600    running time 411 seconds

steps 11800    base_loss: 0.070096    reg_loss: 0.000000    l2_loss: 0.025623    loss: 0.095719
steps 11800    v_Prec: 0.774785  v_Recall: 0.703609  v_F1: 0.737484  v_AUC: 0.909700
steps 11800    running time 417 seconds

steps 12000    base_loss: 0.064982    reg_loss: 0.000000    l2_loss: 0.025659    loss: 0.090641
steps 12000    v_Prec: 0.748985  v_Recall: 0.720341  v_F1: 0.734384  v_AUC: 0.909388
steps 12000    running time 423 seconds

steps 12200    base_loss: 0.075340    reg_loss: 0.000000    l2_loss: 0.025618    loss: 0.100958
steps 12200    v_Prec: 0.792777  v_Recall: 0.687356  v_F1: 0.736312  v_AUC: 0.910435
steps 12200    running time 429 seconds

steps 12400    base_loss: 0.074478    reg_loss: 0.000000    l2_loss: 0.025582    loss: 0.100060
steps 12400    v_Prec: 0.777728  v_Recall: 0.695562  v_F1: 0.734354  v_AUC: 0.907338
steps 12400    running time 436 seconds

steps 12600    base_loss: 0.074682    reg_loss: 0.000000    l2_loss: 0.025578    loss: 0.100260
steps 12600    v_Prec: 0.768001  v_Recall: 0.704486  v_F1: 0.734874  v_AUC: 0.907636
steps 12600    running time 442 seconds

steps 12800    base_loss: 0.078010    reg_loss: 0.000000    l2_loss: 0.025614    loss: 0.103624
steps 12800    v_Prec: 0.771494  v_Recall: 0.699944  v_F1: 0.733979  v_AUC: 0.907402
steps 12800    running time 448 seconds

Early stop model F1: 0.749827
testing thre: 0.4844209
testing Prec: 0.5716847189695551
testing Recall: 0.7593195625759417
testing F1: 0.6522764753773251
testing AUC: 0.9016150886990197
overall running time 451 seconds
(0.7101990049751243, 0.6660510328068043, 0.687416919565599, 0.9016150886990197, 0.77084243)

2019-02-24 14:58:28.360903: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 14:58:28.725153: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 14:58:28.727163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 14:58:28.727200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.970000 seconds
loading data in 31.250000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.507340    reg_loss: 0.000000    l2_loss: 0.013333    loss: 0.520673
steps 200    v_Prec: 0.165076  v_Recall: 0.998497  v_F1: 0.283313  v_AUC: 0.513202
steps 200    running time 41 seconds

steps 400    base_loss: 0.490961    reg_loss: 0.000000    l2_loss: 0.013306    loss: 0.504267
steps 400    v_Prec: 0.169972  v_Recall: 0.888151  v_F1: 0.285337  v_AUC: 0.533893
steps 400    running time 48 seconds

steps 600    base_loss: 0.472878    reg_loss: 0.000000    l2_loss: 0.013196    loss: 0.486074
steps 600    v_Prec: 0.173585  v_Recall: 0.825581  v_F1: 0.286857  v_AUC: 0.545521
steps 600    running time 55 seconds

steps 800    base_loss: 0.454354    reg_loss: 0.000000    l2_loss: 0.013037    loss: 0.467392
steps 800    v_Prec: 0.182458  v_Recall: 0.742604  v_F1: 0.292940  v_AUC: 0.575604
steps 800    running time 62 seconds

steps 1000    base_loss: 0.454325    reg_loss: 0.000000    l2_loss: 0.012948    loss: 0.467273
steps 1000    v_Prec: 0.223852  v_Recall: 0.511944  v_F1: 0.311498  v_AUC: 0.615388
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.444623    reg_loss: 0.000000    l2_loss: 0.012872    loss: 0.457495
steps 1200    v_Prec: 0.293982  v_Recall: 0.485762  v_F1: 0.366288  v_AUC: 0.678502
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.426259    reg_loss: 0.000000    l2_loss: 0.012899    loss: 0.439157
steps 1400    v_Prec: 0.420877  v_Recall: 0.438222  v_F1: 0.429374  v_AUC: 0.728594
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.395564    reg_loss: 0.000000    l2_loss: 0.013031    loss: 0.408595
steps 1600    v_Prec: 0.545545  v_Recall: 0.475162  v_F1: 0.507927  v_AUC: 0.781886
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.368230    reg_loss: 0.000000    l2_loss: 0.013310    loss: 0.381540
steps 1800    v_Prec: 0.607378  v_Recall: 0.510520  v_F1: 0.554753  v_AUC: 0.812540
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.340596    reg_loss: 0.000000    l2_loss: 0.013607    loss: 0.354203
steps 2000    v_Prec: 0.618050  v_Recall: 0.546037  v_F1: 0.579816  v_AUC: 0.831375
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.326073    reg_loss: 0.000000    l2_loss: 0.013897    loss: 0.339969
steps 2200    v_Prec: 0.686380  v_Recall: 0.536149  v_F1: 0.602034  v_AUC: 0.845567
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.310028    reg_loss: 0.000000    l2_loss: 0.014226    loss: 0.324254
steps 2400    v_Prec: 0.686284  v_Recall: 0.569135  v_F1: 0.622243  v_AUC: 0.854002
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.308654    reg_loss: 0.000000    l2_loss: 0.014579    loss: 0.323233
steps 2600    v_Prec: 0.710155  v_Recall: 0.576966  v_F1: 0.636669  v_AUC: 0.862537
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.292024    reg_loss: 0.000000    l2_loss: 0.014853    loss: 0.306877
steps 2800    v_Prec: 0.721987  v_Recall: 0.594289  v_F1: 0.651944  v_AUC: 0.869693
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.299202    reg_loss: 0.000000    l2_loss: 0.015203    loss: 0.314405
steps 3000    v_Prec: 0.709459  v_Recall: 0.612878  v_F1: 0.657641  v_AUC: 0.874940
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.289446    reg_loss: 0.000000    l2_loss: 0.015558    loss: 0.305004
steps 3200    v_Prec: 0.740483  v_Recall: 0.606233  v_F1: 0.666667  v_AUC: 0.879940
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.277217    reg_loss: 0.000000    l2_loss: 0.015829    loss: 0.293047
steps 3400    v_Prec: 0.720402  v_Recall: 0.640168  v_F1: 0.677919  v_AUC: 0.884134
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.278892    reg_loss: 0.000000    l2_loss: 0.016129    loss: 0.295020
steps 3600    v_Prec: 0.733430  v_Recall: 0.640721  v_F1: 0.683948  v_AUC: 0.887792
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.279589    reg_loss: 0.000000    l2_loss: 0.016461    loss: 0.296050
steps 3800    v_Prec: 0.748285  v_Recall: 0.638665  v_F1: 0.689143  v_AUC: 0.891176
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.271373    reg_loss: 0.000000    l2_loss: 0.016717    loss: 0.288090
steps 4000    v_Prec: 0.738947  v_Recall: 0.651796  v_F1: 0.692641  v_AUC: 0.893437
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.275187    reg_loss: 0.000000    l2_loss: 0.016993    loss: 0.292180
steps 4200    v_Prec: 0.737226  v_Recall: 0.656225  v_F1: 0.694371  v_AUC: 0.895396
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.264673    reg_loss: 0.000000    l2_loss: 0.017345    loss: 0.282018
steps 4400    v_Prec: 0.755845  v_Recall: 0.646970  v_F1: 0.697183  v_AUC: 0.897157
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.268936    reg_loss: 0.000000    l2_loss: 0.017664    loss: 0.286600
steps 4600    v_Prec: 0.737889  v_Recall: 0.674735  v_F1: 0.704900  v_AUC: 0.900826
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.262037    reg_loss: 0.000000    l2_loss: 0.018004    loss: 0.280041
steps 4800    v_Prec: 0.740349  v_Recall: 0.675051  v_F1: 0.706194  v_AUC: 0.901805
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.269479    reg_loss: 0.000000    l2_loss: 0.018353    loss: 0.287832
steps 5000    v_Prec: 0.745487  v_Recall: 0.669593  v_F1: 0.705505  v_AUC: 0.904926
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.261559    reg_loss: 0.000000    l2_loss: 0.018783    loss: 0.280342
steps 5200    v_Prec: 0.722906  v_Recall: 0.688024  v_F1: 0.705034  v_AUC: 0.904774
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.252885    reg_loss: 0.000000    l2_loss: 0.019134    loss: 0.272020
steps 5400    v_Prec: 0.743892  v_Recall: 0.674340  v_F1: 0.707410  v_AUC: 0.906907
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.169702    reg_loss: 0.000000    l2_loss: 0.019559    loss: 0.189261
steps 5600    v_Prec: 0.741944  v_Recall: 0.679323  v_F1: 0.709254  v_AUC: 0.901972
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.166827    reg_loss: 0.000000    l2_loss: 0.020274    loss: 0.187101
steps 5800    v_Prec: 0.770188  v_Recall: 0.651084  v_F1: 0.705645  v_AUC: 0.897387
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.168775    reg_loss: 0.000000    l2_loss: 0.021040    loss: 0.189815
steps 6000    v_Prec: 0.765189  v_Recall: 0.656542  v_F1: 0.706714  v_AUC: 0.896208
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.185334    reg_loss: 0.000000    l2_loss: 0.021650    loss: 0.206984
steps 6200    v_Prec: 0.745439  v_Recall: 0.675447  v_F1: 0.708719  v_AUC: 0.896783
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.173360    reg_loss: 0.000000    l2_loss: 0.022215    loss: 0.195575
steps 6400    v_Prec: 0.766752  v_Recall: 0.660734  v_F1: 0.709806  v_AUC: 0.898581
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.179295    reg_loss: 0.000000    l2_loss: 0.022665    loss: 0.201960
steps 6600    v_Prec: 0.781635  v_Recall: 0.657174  v_F1: 0.714022  v_AUC: 0.898921
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.190593    reg_loss: 0.000000    l2_loss: 0.022953    loss: 0.213546
steps 6800    v_Prec: 0.773281  v_Recall: 0.657491  v_F1: 0.710701  v_AUC: 0.897682
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.184986    reg_loss: 0.000000    l2_loss: 0.023296    loss: 0.208282
steps 7000    v_Prec: 0.768218  v_Recall: 0.673786  v_F1: 0.717910  v_AUC: 0.902379
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.183214    reg_loss: 0.000000    l2_loss: 0.023653    loss: 0.206867
steps 7200    v_Prec: 0.770080  v_Recall: 0.678769  v_F1: 0.721547  v_AUC: 0.904010
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.180509    reg_loss: 0.000000    l2_loss: 0.023917    loss: 0.204426
steps 7400    v_Prec: 0.789305  v_Recall: 0.660813  v_F1: 0.719366  v_AUC: 0.903264
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.186357    reg_loss: 0.000000    l2_loss: 0.024334    loss: 0.210691
steps 7600    v_Prec: 0.751189  v_Recall: 0.699731  v_F1: 0.724547  v_AUC: 0.904410
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.179396    reg_loss: 0.000000    l2_loss: 0.024490    loss: 0.203886
steps 7800    v_Prec: 0.785635  v_Recall: 0.673153  v_F1: 0.725058  v_AUC: 0.905877
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.178938    reg_loss: 0.000000    l2_loss: 0.024750    loss: 0.203689
steps 8000    v_Prec: 0.762842  v_Recall: 0.689527  v_F1: 0.724334  v_AUC: 0.905259
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.179810    reg_loss: 0.000000    l2_loss: 0.024897    loss: 0.204708
steps 8200    v_Prec: 0.760627  v_Recall: 0.690713  v_F1: 0.723986  v_AUC: 0.906470
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.190462    reg_loss: 0.000000    l2_loss: 0.024920    loss: 0.215382
steps 8400    v_Prec: 0.778277  v_Recall: 0.685255  v_F1: 0.728810  v_AUC: 0.909361
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.184556    reg_loss: 0.000000    l2_loss: 0.025142    loss: 0.209698
steps 8600    v_Prec: 0.778314  v_Recall: 0.689290  v_F1: 0.731102  v_AUC: 0.910591
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.193993    reg_loss: 0.000000    l2_loss: 0.025297    loss: 0.219289
steps 8800    v_Prec: 0.766156  v_Recall: 0.708037  v_F1: 0.735951  v_AUC: 0.912443
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.184756    reg_loss: 0.000000    l2_loss: 0.025373    loss: 0.210129
steps 9000    v_Prec: 0.799669  v_Recall: 0.687391  v_F1: 0.739291  v_AUC: 0.913437
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.181072    reg_loss: 0.000000    l2_loss: 0.025402    loss: 0.206474
steps 9200    v_Prec: 0.794235  v_Recall: 0.690951  v_F1: 0.739002  v_AUC: 0.915313
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.187079    reg_loss: 0.000000    l2_loss: 0.025506    loss: 0.212585
steps 9400    v_Prec: 0.783526  v_Recall: 0.702025  v_F1: 0.740540  v_AUC: 0.915025
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.185333    reg_loss: 0.000000    l2_loss: 0.025491    loss: 0.210824
steps 9600    v_Prec: 0.783901  v_Recall: 0.698703  v_F1: 0.738854  v_AUC: 0.916355
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.191898    reg_loss: 0.000000    l2_loss: 0.025576    loss: 0.217474
steps 9800    v_Prec: 0.782242  v_Recall: 0.705268  v_F1: 0.741764  v_AUC: 0.918966
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.191429    reg_loss: 0.000000    l2_loss: 0.025597    loss: 0.217026
steps 10000    v_Prec: 0.789017  v_Recall: 0.697833  v_F1: 0.740629  v_AUC: 0.917931
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.196917    reg_loss: 0.000000    l2_loss: 0.025590    loss: 0.222506
steps 10200    v_Prec: 0.780085  v_Recall: 0.710172  v_F1: 0.743489  v_AUC: 0.918203
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.191612    reg_loss: 0.000000    l2_loss: 0.025715    loss: 0.217327
steps 10400    v_Prec: 0.809395  v_Recall: 0.686917  v_F1: 0.743143  v_AUC: 0.918915
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.189176    reg_loss: 0.000000    l2_loss: 0.025802    loss: 0.214978
steps 10600    v_Prec: 0.777778  v_Recall: 0.714839  v_F1: 0.744982  v_AUC: 0.920491
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.176899    reg_loss: 0.000000    l2_loss: 0.025802    loss: 0.202701
steps 10800    v_Prec: 0.779164  v_Recall: 0.721168  v_F1: 0.749045  v_AUC: 0.921017
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.074800    reg_loss: 0.000000    l2_loss: 0.025674    loss: 0.100474
steps 11000    v_Prec: 0.783139  v_Recall: 0.716421  v_F1: 0.748296  v_AUC: 0.919846
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.075816    reg_loss: 0.000000    l2_loss: 0.025600    loss: 0.101416
steps 11200    v_Prec: 0.797465  v_Recall: 0.696725  v_F1: 0.743699  v_AUC: 0.917264
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.072316    reg_loss: 0.000000    l2_loss: 0.025588    loss: 0.097904
steps 11400    v_Prec: 0.787183  v_Recall: 0.699573  v_F1: 0.740797  v_AUC: 0.912522
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.072365    reg_loss: 0.000000    l2_loss: 0.025530    loss: 0.097895
steps 11600    v_Prec: 0.787747  v_Recall: 0.700759  v_F1: 0.741711  v_AUC: 0.911780
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.072138    reg_loss: 0.000000    l2_loss: 0.025681    loss: 0.097820
steps 11800    v_Prec: 0.785663  v_Recall: 0.690951  v_F1: 0.735269  v_AUC: 0.910875
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.073465    reg_loss: 0.000000    l2_loss: 0.025669    loss: 0.099135
steps 12000    v_Prec: 0.778710  v_Recall: 0.697833  v_F1: 0.736056  v_AUC: 0.911482
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.078895    reg_loss: 0.000000    l2_loss: 0.025769    loss: 0.104664
steps 12200    v_Prec: 0.793223  v_Recall: 0.686996  v_F1: 0.736298  v_AUC: 0.910784
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.075531    reg_loss: 0.000000    l2_loss: 0.025632    loss: 0.101163
steps 12400    v_Prec: 0.792946  v_Recall: 0.688261  v_F1: 0.736905  v_AUC: 0.907868
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.078247    reg_loss: 0.000000    l2_loss: 0.025618    loss: 0.103865
steps 12600    v_Prec: 0.780617  v_Recall: 0.698307  v_F1: 0.737172  v_AUC: 0.908618
steps 12600    running time 444 seconds

steps 12800    base_loss: 0.082696    reg_loss: 0.000000    l2_loss: 0.025632    loss: 0.108328
steps 12800    v_Prec: 0.793260  v_Recall: 0.692612  v_F1: 0.739527  v_AUC: 0.911395
steps 12800    running time 450 seconds

Early stop model F1: 0.749045
testing thre: 0.40926307
testing Prec: 0.5767362527346213
testing Recall: 0.7559659781287971
testing F1: 0.6542991755005889
testing AUC: 0.9016030242633037
overall running time 453 seconds
(0.6992723918835827, 0.663280680437424, 0.6808011773215934, 0.9016030242633037, 0.6873811)

2019-02-24 15:03:21.916450: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:03:22.869354: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:03:22.875318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:03:22.875354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.770000 seconds
loading data in 29.850000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.063006    reg_loss: 0.000000    l2_loss: 0.013291    loss: 1.076297
steps 200    v_Prec: 0.164254  v_Recall: 0.999682  v_F1: 0.282149  v_AUC: 0.516931
steps 200    running time 40 seconds

steps 400    base_loss: 0.603555    reg_loss: 0.000000    l2_loss: 0.013144    loss: 0.616698
steps 400    v_Prec: 0.165508  v_Recall: 0.979662  v_F1: 0.283175  v_AUC: 0.526232
steps 400    running time 46 seconds

steps 600    base_loss: 0.480672    reg_loss: 0.000000    l2_loss: 0.013029    loss: 0.493701
steps 600    v_Prec: 0.176034  v_Recall: 0.821165  v_F1: 0.289918  v_AUC: 0.562078
steps 600    running time 53 seconds

steps 800    base_loss: 0.464022    reg_loss: 0.000000    l2_loss: 0.012928    loss: 0.476950
steps 800    v_Prec: 0.207375  v_Recall: 0.608088  v_F1: 0.309278  v_AUC: 0.608115
steps 800    running time 60 seconds

steps 1000    base_loss: 0.452443    reg_loss: 0.000000    l2_loss: 0.012816    loss: 0.465259
steps 1000    v_Prec: 0.239772  v_Recall: 0.534520  v_F1: 0.331045  v_AUC: 0.642789
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.449280    reg_loss: 0.000000    l2_loss: 0.012737    loss: 0.462017
steps 1200    v_Prec: 0.294366  v_Recall: 0.464924  v_F1: 0.360489  v_AUC: 0.674774
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.431837    reg_loss: 0.000000    l2_loss: 0.012763    loss: 0.444600
steps 1400    v_Prec: 0.337771  v_Recall: 0.453563  v_F1: 0.387195  v_AUC: 0.700984
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.429296    reg_loss: 0.000000    l2_loss: 0.012764    loss: 0.442060
steps 1600    v_Prec: 0.387233  v_Recall: 0.453007  v_F1: 0.417545  v_AUC: 0.728244
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.404107    reg_loss: 0.000000    l2_loss: 0.012894    loss: 0.417000
steps 1800    v_Prec: 0.421141  v_Recall: 0.456106  v_F1: 0.437927  v_AUC: 0.747834
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.394500    reg_loss: 0.000000    l2_loss: 0.013042    loss: 0.407542
steps 2000    v_Prec: 0.475792  v_Recall: 0.473902  v_F1: 0.474845  v_AUC: 0.774567
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.379483    reg_loss: 0.000000    l2_loss: 0.013311    loss: 0.392794
steps 2200    v_Prec: 0.481484  v_Recall: 0.523715  v_F1: 0.501712  v_AUC: 0.794211
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.361886    reg_loss: 0.000000    l2_loss: 0.013630    loss: 0.375516
steps 2400    v_Prec: 0.524723  v_Recall: 0.541273  v_F1: 0.532869  v_AUC: 0.816749
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.352101    reg_loss: 0.000000    l2_loss: 0.013994    loss: 0.366095
steps 2600    v_Prec: 0.528634  v_Recall: 0.565425  v_F1: 0.546411  v_AUC: 0.830086
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.338122    reg_loss: 0.000000    l2_loss: 0.014416    loss: 0.352539
steps 2800    v_Prec: 0.578318  v_Recall: 0.561135  v_F1: 0.569597  v_AUC: 0.845902
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.331040    reg_loss: 0.000000    l2_loss: 0.014853    loss: 0.345893
steps 3000    v_Prec: 0.582065  v_Recall: 0.583221  v_F1: 0.582642  v_AUC: 0.855183
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.317381    reg_loss: 0.000000    l2_loss: 0.015332    loss: 0.332713
steps 3200    v_Prec: 0.571070  v_Recall: 0.615397  v_F1: 0.592406  v_AUC: 0.860463
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.324922    reg_loss: 0.000000    l2_loss: 0.015831    loss: 0.340753
steps 3400    v_Prec: 0.596437  v_Recall: 0.595773  v_F1: 0.596105  v_AUC: 0.865060
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.321511    reg_loss: 0.000000    l2_loss: 0.016474    loss: 0.337984
steps 3600    v_Prec: 0.598152  v_Recall: 0.617065  v_F1: 0.607461  v_AUC: 0.868449
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.313477    reg_loss: 0.000000    l2_loss: 0.017120    loss: 0.330597
steps 3800    v_Prec: 0.591596  v_Recall: 0.625248  v_F1: 0.607957  v_AUC: 0.871266
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.310584    reg_loss: 0.000000    l2_loss: 0.017804    loss: 0.328388
steps 4000    v_Prec: 0.610184  v_Recall: 0.615953  v_F1: 0.613055  v_AUC: 0.874080
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.302661    reg_loss: 0.000000    l2_loss: 0.018465    loss: 0.321126
steps 4200    v_Prec: 0.615529  v_Recall: 0.624136  v_F1: 0.619803  v_AUC: 0.875226
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.306369    reg_loss: 0.000000    l2_loss: 0.019286    loss: 0.325654
steps 4400    v_Prec: 0.600181  v_Recall: 0.632081  v_F1: 0.615718  v_AUC: 0.875182
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.307445    reg_loss: 0.000000    l2_loss: 0.020057    loss: 0.327502
steps 4600    v_Prec: 0.631877  v_Recall: 0.611345  v_F1: 0.621442  v_AUC: 0.877955
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.308866    reg_loss: 0.000000    l2_loss: 0.020858    loss: 0.329724
steps 4800    v_Prec: 0.613583  v_Recall: 0.626599  v_F1: 0.620023  v_AUC: 0.878038
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.304306    reg_loss: 0.000000    l2_loss: 0.021804    loss: 0.326111
steps 5000    v_Prec: 0.628320  v_Recall: 0.623977  v_F1: 0.626141  v_AUC: 0.880265
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.298328    reg_loss: 0.000000    l2_loss: 0.022786    loss: 0.321115
steps 5200    v_Prec: 0.619906  v_Recall: 0.628426  v_F1: 0.624137  v_AUC: 0.879175
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.295793    reg_loss: 0.000000    l2_loss: 0.023664    loss: 0.319457
steps 5400    v_Prec: 0.627726  v_Recall: 0.626678  v_F1: 0.627202  v_AUC: 0.879511
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.163384    reg_loss: 0.000000    l2_loss: 0.024445    loss: 0.187829
steps 5600    v_Prec: 0.624058  v_Recall: 0.618654  v_F1: 0.621345  v_AUC: 0.875765
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.177756    reg_loss: 0.000000    l2_loss: 0.024912    loss: 0.202669
steps 5800    v_Prec: 0.627823  v_Recall: 0.607373  v_F1: 0.617429  v_AUC: 0.874231
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.173154    reg_loss: 0.000000    l2_loss: 0.025455    loss: 0.198609
steps 6000    v_Prec: 0.616331  v_Recall: 0.608644  v_F1: 0.612464  v_AUC: 0.870442
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.186448    reg_loss: 0.000000    l2_loss: 0.026028    loss: 0.212476
steps 6200    v_Prec: 0.626763  v_Recall: 0.607293  v_F1: 0.616874  v_AUC: 0.870710
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.178785    reg_loss: 0.000000    l2_loss: 0.026487    loss: 0.205272
steps 6400    v_Prec: 0.597894  v_Recall: 0.622547  v_F1: 0.609972  v_AUC: 0.868306
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.184156    reg_loss: 0.000000    l2_loss: 0.027075    loss: 0.211232
steps 6600    v_Prec: 0.612128  v_Recall: 0.619131  v_F1: 0.615609  v_AUC: 0.871006
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.174587    reg_loss: 0.000000    l2_loss: 0.027567    loss: 0.202154
steps 6800    v_Prec: 0.620695  v_Recall: 0.612855  v_F1: 0.616750  v_AUC: 0.872735
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.198161    reg_loss: 0.000000    l2_loss: 0.027891    loss: 0.226052
steps 7000    v_Prec: 0.612111  v_Recall: 0.629618  v_F1: 0.620741  v_AUC: 0.874092
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.189906    reg_loss: 0.000000    l2_loss: 0.028329    loss: 0.218235
steps 7200    v_Prec: 0.590692  v_Recall: 0.649400  v_F1: 0.618657  v_AUC: 0.873931
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.201200    reg_loss: 0.000000    l2_loss: 0.028774    loss: 0.229974
steps 7400    v_Prec: 0.610416  v_Recall: 0.627632  v_F1: 0.618904  v_AUC: 0.873144
steps 7400    running time 274 seconds

Early stop model F1: 0.627202
testing thre: 0.2842877
testing Prec: 0.4508524397413286
testing Recall: 0.7454678007290401
testing F1: 0.5618829563146809
testing AUC: 0.8669809544051491
overall running time 277 seconds
(0.5986752386518606, 0.5974240583232078, 0.5980489940885981, 0.8669809544051491, 0.49458477)

2019-02-24 15:06:27.043255: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:06:27.789606: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:06:27.794775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:06:27.794834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.090000 seconds
loading data in 31.200000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.671534    reg_loss: 0.000000    l2_loss: 0.013292    loss: 0.684826
steps 200    v_Prec: 0.163134  v_Recall: 0.999840  v_F1: 0.280502  v_AUC: 0.493453
steps 200    running time 41 seconds

steps 400    base_loss: 0.538792    reg_loss: 0.000000    l2_loss: 0.013151    loss: 0.551944
steps 400    v_Prec: 0.163131  v_Recall: 1.000000  v_F1: 0.280503  v_AUC: 0.497566
steps 400    running time 48 seconds

steps 600    base_loss: 0.490907    reg_loss: 0.000000    l2_loss: 0.013005    loss: 0.503912
steps 600    v_Prec: 0.163232  v_Recall: 0.997360  v_F1: 0.280549  v_AUC: 0.514654
steps 600    running time 55 seconds

steps 800    base_loss: 0.480235    reg_loss: 0.000000    l2_loss: 0.012805    loss: 0.493039
steps 800    v_Prec: 0.163239  v_Recall: 0.998160  v_F1: 0.280591  v_AUC: 0.524521
steps 800    running time 61 seconds

steps 1000    base_loss: 0.463196    reg_loss: 0.000000    l2_loss: 0.012572    loss: 0.475768
steps 1000    v_Prec: 0.164461  v_Recall: 0.955127  v_F1: 0.280605  v_AUC: 0.528941
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.455517    reg_loss: 0.000000    l2_loss: 0.012446    loss: 0.467964
steps 1200    v_Prec: 0.221575  v_Recall: 0.487122  v_F1: 0.304599  v_AUC: 0.609209
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.438071    reg_loss: 0.000000    l2_loss: 0.012368    loss: 0.450439
steps 1400    v_Prec: 0.348411  v_Recall: 0.418333  v_F1: 0.380184  v_AUC: 0.688791
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.420436    reg_loss: 0.000000    l2_loss: 0.012330    loss: 0.432766
steps 1600    v_Prec: 0.435734  v_Recall: 0.447688  v_F1: 0.441630  v_AUC: 0.738935
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.398110    reg_loss: 0.000000    l2_loss: 0.012394    loss: 0.410504
steps 1800    v_Prec: 0.515768  v_Recall: 0.478803  v_F1: 0.496599  v_AUC: 0.780989
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.370386    reg_loss: 0.000000    l2_loss: 0.012558    loss: 0.382944
steps 2000    v_Prec: 0.540441  v_Recall: 0.530715  v_F1: 0.535534  v_AUC: 0.808883
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.346607    reg_loss: 0.000000    l2_loss: 0.012759    loss: 0.359366
steps 2200    v_Prec: 0.551364  v_Recall: 0.570549  v_F1: 0.560792  v_AUC: 0.828870
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.332110    reg_loss: 0.000000    l2_loss: 0.013042    loss: 0.345152
steps 2400    v_Prec: 0.597067  v_Recall: 0.566549  v_F1: 0.581408  v_AUC: 0.842525
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.329753    reg_loss: 0.000000    l2_loss: 0.013373    loss: 0.343125
steps 2600    v_Prec: 0.587581  v_Recall: 0.612302  v_F1: 0.599687  v_AUC: 0.854934
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.312699    reg_loss: 0.000000    l2_loss: 0.013780    loss: 0.326479
steps 2800    v_Prec: 0.623803  v_Recall: 0.594065  v_F1: 0.608571  v_AUC: 0.862630
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.304488    reg_loss: 0.000000    l2_loss: 0.014209    loss: 0.318697
steps 3000    v_Prec: 0.626443  v_Recall: 0.607503  v_F1: 0.616828  v_AUC: 0.868147
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.310105    reg_loss: 0.000000    l2_loss: 0.014538    loss: 0.324643
steps 3200    v_Prec: 0.657269  v_Recall: 0.606063  v_F1: 0.630628  v_AUC: 0.874587
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.301203    reg_loss: 0.000000    l2_loss: 0.014958    loss: 0.316161
steps 3400    v_Prec: 0.676224  v_Recall: 0.599904  v_F1: 0.635782  v_AUC: 0.878954
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.294616    reg_loss: 0.000000    l2_loss: 0.015414    loss: 0.310030
steps 3600    v_Prec: 0.672722  v_Recall: 0.610142  v_F1: 0.639906  v_AUC: 0.882787
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.288587    reg_loss: 0.000000    l2_loss: 0.015836    loss: 0.304423
steps 3800    v_Prec: 0.657561  v_Recall: 0.629579  v_F1: 0.643266  v_AUC: 0.884945
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.287871    reg_loss: 0.000000    l2_loss: 0.016302    loss: 0.304172
steps 4000    v_Prec: 0.676468  v_Recall: 0.618301  v_F1: 0.646078  v_AUC: 0.886772
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.286691    reg_loss: 0.000000    l2_loss: 0.016825    loss: 0.303516
steps 4200    v_Prec: 0.679348  v_Recall: 0.617021  v_F1: 0.646687  v_AUC: 0.888240
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.284987    reg_loss: 0.000000    l2_loss: 0.017314    loss: 0.302302
steps 4400    v_Prec: 0.677031  v_Recall: 0.633979  v_F1: 0.654798  v_AUC: 0.891044
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.284450    reg_loss: 0.000000    l2_loss: 0.017887    loss: 0.302337
steps 4600    v_Prec: 0.649030  v_Recall: 0.666213  v_F1: 0.657509  v_AUC: 0.892137
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.283235    reg_loss: 0.000000    l2_loss: 0.018507    loss: 0.301742
steps 4800    v_Prec: 0.679760  v_Recall: 0.633979  v_F1: 0.656072  v_AUC: 0.893269
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.271950    reg_loss: 0.000000    l2_loss: 0.019109    loss: 0.291059
steps 5000    v_Prec: 0.665640  v_Recall: 0.656855  v_F1: 0.661218  v_AUC: 0.895369
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.279122    reg_loss: 0.000000    l2_loss: 0.019660    loss: 0.298782
steps 5200    v_Prec: 0.671468  v_Recall: 0.656215  v_F1: 0.663754  v_AUC: 0.897284
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.268584    reg_loss: 0.000000    l2_loss: 0.020396    loss: 0.288979
steps 5400    v_Prec: 0.669659  v_Recall: 0.668213  v_F1: 0.668935  v_AUC: 0.899838
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.185653    reg_loss: 0.000000    l2_loss: 0.021237    loss: 0.206890
steps 5600    v_Prec: 0.673968  v_Recall: 0.644857  v_F1: 0.659091  v_AUC: 0.894406
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.174094    reg_loss: 0.000000    l2_loss: 0.022044    loss: 0.196138
steps 5800    v_Prec: 0.663492  v_Recall: 0.651976  v_F1: 0.657683  v_AUC: 0.892952
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.191585    reg_loss: 0.000000    l2_loss: 0.022830    loss: 0.214416
steps 6000    v_Prec: 0.651159  v_Recall: 0.649336  v_F1: 0.650246  v_AUC: 0.890204
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.190154    reg_loss: 0.000000    l2_loss: 0.023346    loss: 0.213501
steps 6200    v_Prec: 0.677694  v_Recall: 0.635738  v_F1: 0.656046  v_AUC: 0.891577
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.184111    reg_loss: 0.000000    l2_loss: 0.023871    loss: 0.207983
steps 6400    v_Prec: 0.675314  v_Recall: 0.645497  v_F1: 0.660069  v_AUC: 0.892511
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.196652    reg_loss: 0.000000    l2_loss: 0.024424    loss: 0.221076
steps 6600    v_Prec: 0.680743  v_Recall: 0.653735  v_F1: 0.666966  v_AUC: 0.894567
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.196840    reg_loss: 0.000000    l2_loss: 0.024792    loss: 0.221632
steps 6800    v_Prec: 0.700673  v_Recall: 0.641097  v_F1: 0.669563  v_AUC: 0.898472
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.194448    reg_loss: 0.000000    l2_loss: 0.025415    loss: 0.219862
steps 7000    v_Prec: 0.673063  v_Recall: 0.667733  v_F1: 0.670387  v_AUC: 0.897468
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.184863    reg_loss: 0.000000    l2_loss: 0.025827    loss: 0.210690
steps 7200    v_Prec: 0.688357  v_Recall: 0.658295  v_F1: 0.672990  v_AUC: 0.897745
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.190442    reg_loss: 0.000000    l2_loss: 0.026191    loss: 0.216634
steps 7400    v_Prec: 0.680182  v_Recall: 0.670933  v_F1: 0.675525  v_AUC: 0.900207
steps 7400    running time 275 seconds

steps 7600    base_loss: 0.193770    reg_loss: 0.000000    l2_loss: 0.026555    loss: 0.220325
steps 7600    v_Prec: 0.699923  v_Recall: 0.654855  v_F1: 0.676640  v_AUC: 0.899677
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.194301    reg_loss: 0.000000    l2_loss: 0.026843    loss: 0.221144
steps 7800    v_Prec: 0.719618  v_Recall: 0.638458  v_F1: 0.676613  v_AUC: 0.900763
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.189968    reg_loss: 0.000000    l2_loss: 0.027204    loss: 0.217173
steps 8000    v_Prec: 0.689936  v_Recall: 0.678291  v_F1: 0.684064  v_AUC: 0.903396
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.197867    reg_loss: 0.000000    l2_loss: 0.027526    loss: 0.225393
steps 8200    v_Prec: 0.706680  v_Recall: 0.671013  v_F1: 0.688385  v_AUC: 0.906282
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.195161    reg_loss: 0.000000    l2_loss: 0.027780    loss: 0.222941
steps 8400    v_Prec: 0.715987  v_Recall: 0.663814  v_F1: 0.688914  v_AUC: 0.906803
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.192336    reg_loss: 0.000000    l2_loss: 0.028059    loss: 0.220395
steps 8600    v_Prec: 0.732376  v_Recall: 0.656455  v_F1: 0.692340  v_AUC: 0.907775
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.189068    reg_loss: 0.000000    l2_loss: 0.028390    loss: 0.217458
steps 8800    v_Prec: 0.724144  v_Recall: 0.664774  v_F1: 0.693190  v_AUC: 0.909440
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.192994    reg_loss: 0.000000    l2_loss: 0.028591    loss: 0.221585
steps 9000    v_Prec: 0.731468  v_Recall: 0.663014  v_F1: 0.695561  v_AUC: 0.910250
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.183573    reg_loss: 0.000000    l2_loss: 0.028727    loss: 0.212300
steps 9200    v_Prec: 0.766534  v_Recall: 0.647096  v_F1: 0.701770  v_AUC: 0.913107
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.192788    reg_loss: 0.000000    l2_loss: 0.029140    loss: 0.221928
steps 9400    v_Prec: 0.735251  v_Recall: 0.674852  v_F1: 0.703758  v_AUC: 0.914046
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.195523    reg_loss: 0.000000    l2_loss: 0.029282    loss: 0.224805
steps 9600    v_Prec: 0.726851  v_Recall: 0.688770  v_F1: 0.707298  v_AUC: 0.915774
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.190376    reg_loss: 0.000000    l2_loss: 0.029323    loss: 0.219699
steps 9800    v_Prec: 0.741697  v_Recall: 0.675252  v_F1: 0.706917  v_AUC: 0.913618
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.198585    reg_loss: 0.000000    l2_loss: 0.029483    loss: 0.228068
steps 10000    v_Prec: 0.725441  v_Recall: 0.697008  v_F1: 0.710941  v_AUC: 0.915933
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.190721    reg_loss: 0.000000    l2_loss: 0.029685    loss: 0.220405
steps 10200    v_Prec: 0.729987  v_Recall: 0.694369  v_F1: 0.711732  v_AUC: 0.917404
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.201738    reg_loss: 0.000000    l2_loss: 0.029942    loss: 0.231680
steps 10400    v_Prec: 0.751338  v_Recall: 0.684930  v_F1: 0.716599  v_AUC: 0.919845
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.188430    reg_loss: 0.000000    l2_loss: 0.030149    loss: 0.218579
steps 10600    v_Prec: 0.745292  v_Recall: 0.686930  v_F1: 0.714922  v_AUC: 0.921161
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.175032    reg_loss: 0.000000    l2_loss: 0.030269    loss: 0.205301
steps 10800    v_Prec: 0.747959  v_Recall: 0.688850  v_F1: 0.717189  v_AUC: 0.921113
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.075992    reg_loss: 0.000000    l2_loss: 0.030569    loss: 0.106561
steps 11000    v_Prec: 0.729966  v_Recall: 0.673972  v_F1: 0.700853  v_AUC: 0.912007
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.075371    reg_loss: 0.000000    l2_loss: 0.030596    loss: 0.105967
steps 11200    v_Prec: 0.700993  v_Recall: 0.688770  v_F1: 0.694828  v_AUC: 0.908562
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.073838    reg_loss: 0.000000    l2_loss: 0.030575    loss: 0.104414
steps 11400    v_Prec: 0.712343  v_Recall: 0.674452  v_F1: 0.692880  v_AUC: 0.906891
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.078857    reg_loss: 0.000000    l2_loss: 0.030717    loss: 0.109574
steps 11600    v_Prec: 0.703022  v_Recall: 0.675412  v_F1: 0.688941  v_AUC: 0.905168
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.072782    reg_loss: 0.000000    l2_loss: 0.030768    loss: 0.103550
steps 11800    v_Prec: 0.725211  v_Recall: 0.652296  v_F1: 0.686824  v_AUC: 0.904979
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.082019    reg_loss: 0.000000    l2_loss: 0.030939    loss: 0.112958
steps 12000    v_Prec: 0.697851  v_Recall: 0.662294  v_F1: 0.679608  v_AUC: 0.900646
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.083107    reg_loss: 0.000000    l2_loss: 0.031016    loss: 0.114123
steps 12200    v_Prec: 0.698055  v_Recall: 0.654615  v_F1: 0.675638  v_AUC: 0.898603
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.084237    reg_loss: 0.000000    l2_loss: 0.031104    loss: 0.115341
steps 12400    v_Prec: 0.703540  v_Recall: 0.648616  v_F1: 0.674963  v_AUC: 0.897286
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.081595    reg_loss: 0.000000    l2_loss: 0.031243    loss: 0.112838
steps 12600    v_Prec: 0.714439  v_Recall: 0.637978  v_F1: 0.674047  v_AUC: 0.896489
steps 12600    running time 443 seconds

steps 12800    base_loss: 0.085128    reg_loss: 0.000000    l2_loss: 0.031263    loss: 0.116391
steps 12800    v_Prec: 0.691064  v_Recall: 0.656295  v_F1: 0.673231  v_AUC: 0.896589
steps 12800    running time 449 seconds

Early stop model F1: 0.717189
testing thre: 0.39600632
testing Prec: 0.5359616595536276
testing Recall: 0.7446415552855407
testing F1: 0.6232989564899004
testing AUC: 0.8977216632895725
overall running time 452 seconds
(0.6895867945763439, 0.6253705953827461, 0.6559106897079063, 0.8977216632895725, 0.7189525)

2019-02-24 15:11:21.379265: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:11:22.250518: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:11:22.253330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:11:22.253370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.720000 seconds
loading data in 29.810000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.565220    reg_loss: 0.000000    l2_loss: 0.013330    loss: 0.578550
steps 200    v_Prec: 0.164375  v_Recall: 0.947094  v_F1: 0.280131  v_AUC: 0.538579
steps 200    running time 40 seconds

steps 400    base_loss: 0.494955    reg_loss: 0.000000    l2_loss: 0.013256    loss: 0.508210
steps 400    v_Prec: 0.172576  v_Recall: 0.787010  v_F1: 0.283078  v_AUC: 0.550878
steps 400    running time 46 seconds

steps 600    base_loss: 0.477143    reg_loss: 0.000000    l2_loss: 0.013165    loss: 0.490308
steps 600    v_Prec: 0.183717  v_Recall: 0.690591  v_F1: 0.290226  v_AUC: 0.572947
steps 600    running time 53 seconds

steps 800    base_loss: 0.459257    reg_loss: 0.000000    l2_loss: 0.013024    loss: 0.472281
steps 800    v_Prec: 0.197255  v_Recall: 0.641618  v_F1: 0.301744  v_AUC: 0.600197
steps 800    running time 60 seconds

steps 1000    base_loss: 0.443708    reg_loss: 0.000000    l2_loss: 0.012989    loss: 0.456697
steps 1000    v_Prec: 0.254228  v_Recall: 0.527376  v_F1: 0.343074  v_AUC: 0.661634
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.429408    reg_loss: 0.000000    l2_loss: 0.013017    loss: 0.442425
steps 1200    v_Prec: 0.386266  v_Recall: 0.424936  v_F1: 0.404679  v_AUC: 0.719168
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.404730    reg_loss: 0.000000    l2_loss: 0.013151    loss: 0.417880
steps 1400    v_Prec: 0.452132  v_Recall: 0.451188  v_F1: 0.451660  v_AUC: 0.759188
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.379753    reg_loss: 0.000000    l2_loss: 0.013357    loss: 0.393109
steps 1600    v_Prec: 0.530300  v_Recall: 0.473507  v_F1: 0.500297  v_AUC: 0.793452
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.354732    reg_loss: 0.000000    l2_loss: 0.013575    loss: 0.368307
steps 1800    v_Prec: 0.580578  v_Recall: 0.511641  v_F1: 0.543934  v_AUC: 0.818556
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.340677    reg_loss: 0.000000    l2_loss: 0.013873    loss: 0.354550
steps 2000    v_Prec: 0.611856  v_Recall: 0.541908  v_F1: 0.574762  v_AUC: 0.835873
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.330563    reg_loss: 0.000000    l2_loss: 0.014232    loss: 0.344795
steps 2200    v_Prec: 0.653157  v_Recall: 0.544717  v_F1: 0.594029  v_AUC: 0.846993
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.311838    reg_loss: 0.000000    l2_loss: 0.014605    loss: 0.326443
steps 2400    v_Prec: 0.654652  v_Recall: 0.581808  v_F1: 0.616084  v_AUC: 0.856973
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.298004    reg_loss: 0.000000    l2_loss: 0.014879    loss: 0.312883
steps 2600    v_Prec: 0.676473  v_Recall: 0.583333  v_F1: 0.626460  v_AUC: 0.862708
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.295163    reg_loss: 0.000000    l2_loss: 0.015239    loss: 0.310402
steps 2800    v_Prec: 0.702431  v_Recall: 0.577633  v_F1: 0.633949  v_AUC: 0.866974
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.298893    reg_loss: 0.000000    l2_loss: 0.015630    loss: 0.314522
steps 3000    v_Prec: 0.700075  v_Recall: 0.601718  v_F1: 0.647181  v_AUC: 0.872202
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.285849    reg_loss: 0.000000    l2_loss: 0.015919    loss: 0.301768
steps 3200    v_Prec: 0.730525  v_Recall: 0.591763  v_F1: 0.653863  v_AUC: 0.876435
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.284758    reg_loss: 0.000000    l2_loss: 0.016343    loss: 0.301101
steps 3400    v_Prec: 0.747363  v_Recall: 0.597303  v_F1: 0.663960  v_AUC: 0.879343
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.281774    reg_loss: 0.000000    l2_loss: 0.016691    loss: 0.298466
steps 3600    v_Prec: 0.740964  v_Recall: 0.610629  v_F1: 0.669513  v_AUC: 0.883133
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.276977    reg_loss: 0.000000    l2_loss: 0.017066    loss: 0.294043
steps 3800    v_Prec: 0.727990  v_Recall: 0.629978  v_F1: 0.675447  v_AUC: 0.886763
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.276783    reg_loss: 0.000000    l2_loss: 0.017474    loss: 0.294257
steps 4000    v_Prec: 0.732235  v_Recall: 0.638648  v_F1: 0.682247  v_AUC: 0.889869
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.271515    reg_loss: 0.000000    l2_loss: 0.017797    loss: 0.289311
steps 4200    v_Prec: 0.725062  v_Recall: 0.653581  v_F1: 0.687468  v_AUC: 0.892220
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.268813    reg_loss: 0.000000    l2_loss: 0.018239    loss: 0.287051
steps 4400    v_Prec: 0.744480  v_Recall: 0.646997  v_F1: 0.692324  v_AUC: 0.895198
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.265218    reg_loss: 0.000000    l2_loss: 0.018575    loss: 0.283793
steps 4600    v_Prec: 0.727742  v_Recall: 0.667389  v_F1: 0.696260  v_AUC: 0.896641
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.258053    reg_loss: 0.000000    l2_loss: 0.018873    loss: 0.276926
steps 4800    v_Prec: 0.749840  v_Recall: 0.659361  v_F1: 0.701696  v_AUC: 0.898603
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.255152    reg_loss: 0.000000    l2_loss: 0.019138    loss: 0.274290
steps 5000    v_Prec: 0.740810  v_Recall: 0.668192  v_F1: 0.702630  v_AUC: 0.901839
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.257057    reg_loss: 0.000000    l2_loss: 0.019436    loss: 0.276493
steps 5200    v_Prec: 0.739416  v_Recall: 0.677264  v_F1: 0.706977  v_AUC: 0.903322
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.253415    reg_loss: 0.000000    l2_loss: 0.019831    loss: 0.273246
steps 5400    v_Prec: 0.758772  v_Recall: 0.666667  v_F1: 0.709744  v_AUC: 0.905966
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.168113    reg_loss: 0.000000    l2_loss: 0.020280    loss: 0.188394
steps 5600    v_Prec: 0.745783  v_Recall: 0.660164  v_F1: 0.700366  v_AUC: 0.896384
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.172546    reg_loss: 0.000000    l2_loss: 0.020947    loss: 0.193493
steps 5800    v_Prec: 0.740781  v_Recall: 0.662813  v_F1: 0.699631  v_AUC: 0.895627
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.171192    reg_loss: 0.000000    l2_loss: 0.021660    loss: 0.192852
steps 6000    v_Prec: 0.734085  v_Recall: 0.663776  v_F1: 0.697163  v_AUC: 0.892754
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.169093    reg_loss: 0.000000    l2_loss: 0.022322    loss: 0.191415
steps 6200    v_Prec: 0.744793  v_Recall: 0.657434  v_F1: 0.698392  v_AUC: 0.892834
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.185163    reg_loss: 0.000000    l2_loss: 0.022770    loss: 0.207934
steps 6400    v_Prec: 0.755872  v_Recall: 0.661448  v_F1: 0.705515  v_AUC: 0.897028
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.165146    reg_loss: 0.000000    l2_loss: 0.023049    loss: 0.188195
steps 6600    v_Prec: 0.749195  v_Recall: 0.672688  v_F1: 0.708883  v_AUC: 0.897945
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.179592    reg_loss: 0.000000    l2_loss: 0.023577    loss: 0.203169
steps 6800    v_Prec: 0.758452  v_Recall: 0.660967  v_F1: 0.706362  v_AUC: 0.897641
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.182958    reg_loss: 0.000000    l2_loss: 0.023936    loss: 0.206894
steps 7000    v_Prec: 0.772654  v_Recall: 0.651012  v_F1: 0.706636  v_AUC: 0.898717
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.174775    reg_loss: 0.000000    l2_loss: 0.024240    loss: 0.199015
steps 7200    v_Prec: 0.780876  v_Recall: 0.654303  v_F1: 0.712008  v_AUC: 0.898662
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.180729    reg_loss: 0.000000    l2_loss: 0.024428    loss: 0.205158
steps 7400    v_Prec: 0.767852  v_Recall: 0.667309  v_F1: 0.714059  v_AUC: 0.899345
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.188866    reg_loss: 0.000000    l2_loss: 0.024831    loss: 0.213697
steps 7600    v_Prec: 0.765591  v_Recall: 0.674133  v_F1: 0.716957  v_AUC: 0.901761
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.185600    reg_loss: 0.000000    l2_loss: 0.024938    loss: 0.210537
steps 7800    v_Prec: 0.757282  v_Recall: 0.684570  v_F1: 0.719093  v_AUC: 0.903467
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.183377    reg_loss: 0.000000    l2_loss: 0.025187    loss: 0.208564
steps 8000    v_Prec: 0.742977  v_Recall: 0.696452  v_F1: 0.718962  v_AUC: 0.904863
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.181792    reg_loss: 0.000000    l2_loss: 0.025284    loss: 0.207076
steps 8200    v_Prec: 0.755876  v_Recall: 0.689306  v_F1: 0.721058  v_AUC: 0.903922
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.189070    reg_loss: 0.000000    l2_loss: 0.025508    loss: 0.214578
steps 8400    v_Prec: 0.758292  v_Recall: 0.695649  v_F1: 0.725621  v_AUC: 0.907354
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.191136    reg_loss: 0.000000    l2_loss: 0.025565    loss: 0.216701
steps 8600    v_Prec: 0.733185  v_Recall: 0.715880  v_F1: 0.724429  v_AUC: 0.908278
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.182489    reg_loss: 0.000000    l2_loss: 0.025770    loss: 0.208259
steps 8800    v_Prec: 0.772986  v_Recall: 0.687781  v_F1: 0.727898  v_AUC: 0.910693
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.180950    reg_loss: 0.000000    l2_loss: 0.025792    loss: 0.206741
steps 9000    v_Prec: 0.765005  v_Recall: 0.700947  v_F1: 0.731577  v_AUC: 0.911571
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.183839    reg_loss: 0.000000    l2_loss: 0.025850    loss: 0.209689
steps 9200    v_Prec: 0.773598  v_Recall: 0.700064  v_F1: 0.734997  v_AUC: 0.911796
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.176571    reg_loss: 0.000000    l2_loss: 0.026005    loss: 0.202576
steps 9400    v_Prec: 0.765943  v_Recall: 0.707771  v_F1: 0.735709  v_AUC: 0.912068
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.182309    reg_loss: 0.000000    l2_loss: 0.026051    loss: 0.208360
steps 9600    v_Prec: 0.765326  v_Recall: 0.710581  v_F1: 0.736939  v_AUC: 0.913636
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.183767    reg_loss: 0.000000    l2_loss: 0.026040    loss: 0.209807
steps 9800    v_Prec: 0.777837  v_Recall: 0.707209  v_F1: 0.740844  v_AUC: 0.915162
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.177430    reg_loss: 0.000000    l2_loss: 0.026133    loss: 0.203564
steps 10000    v_Prec: 0.782504  v_Recall: 0.701590  v_F1: 0.739841  v_AUC: 0.916379
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.183097    reg_loss: 0.000000    l2_loss: 0.026146    loss: 0.209242
steps 10200    v_Prec: 0.783422  v_Recall: 0.705684  v_F1: 0.742524  v_AUC: 0.917373
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.185272    reg_loss: 0.000000    l2_loss: 0.026265    loss: 0.211537
steps 10400    v_Prec: 0.792095  v_Recall: 0.704721  v_F1: 0.745858  v_AUC: 0.920359
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.176500    reg_loss: 0.000000    l2_loss: 0.026269    loss: 0.202769
steps 10600    v_Prec: 0.793812  v_Recall: 0.710581  v_F1: 0.749894  v_AUC: 0.920677
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.170435    reg_loss: 0.000000    l2_loss: 0.026244    loss: 0.196679
steps 10800    v_Prec: 0.806532  v_Recall: 0.697816  v_F1: 0.748246  v_AUC: 0.920336
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.067546    reg_loss: 0.000000    l2_loss: 0.026236    loss: 0.093782
steps 11000    v_Prec: 0.802497  v_Recall: 0.686336  v_F1: 0.739885  v_AUC: 0.914084
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.066178    reg_loss: 0.000000    l2_loss: 0.026251    loss: 0.092429
steps 11200    v_Prec: 0.789858  v_Recall: 0.685292  v_F1: 0.733869  v_AUC: 0.907405
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.063954    reg_loss: 0.000000    l2_loss: 0.026159    loss: 0.090114
steps 11400    v_Prec: 0.772635  v_Recall: 0.700867  v_F1: 0.735003  v_AUC: 0.908444
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.068410    reg_loss: 0.000000    l2_loss: 0.026171    loss: 0.094581
steps 11600    v_Prec: 0.792809  v_Recall: 0.686898  v_F1: 0.736063  v_AUC: 0.906990
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.074542    reg_loss: 0.000000    l2_loss: 0.026083    loss: 0.100625
steps 11800    v_Prec: 0.801600  v_Recall: 0.667550  v_F1: 0.728459  v_AUC: 0.905235
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.077404    reg_loss: 0.000000    l2_loss: 0.026162    loss: 0.103566
steps 12000    v_Prec: 0.781104  v_Recall: 0.684971  v_F1: 0.729886  v_AUC: 0.905151
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.081167    reg_loss: 0.000000    l2_loss: 0.026064    loss: 0.107232
steps 12200    v_Prec: 0.777122  v_Recall: 0.687219  v_F1: 0.729411  v_AUC: 0.905284
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.077938    reg_loss: 0.000000    l2_loss: 0.026113    loss: 0.104050
steps 12400    v_Prec: 0.794597  v_Recall: 0.677665  v_F1: 0.731487  v_AUC: 0.905799
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.073061    reg_loss: 0.000000    l2_loss: 0.026112    loss: 0.099173
steps 12600    v_Prec: 0.777206  v_Recall: 0.691474  v_F1: 0.731838  v_AUC: 0.906549
steps 12600    running time 443 seconds

Early stop model F1: 0.749894
testing thre: 0.5314325
testing Prec: 0.6173151354654716
testing Recall: 0.7364277035236938
testing F1: 0.6716312056737589
testing AUC: 0.903372305155272
overall running time 446 seconds
(0.7258856167306872, 0.6612879708383961, 0.6920827081054961, 0.903372305155272, 0.74101037)

2019-02-24 15:16:12.853083: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:16:14.148459: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:16:14.282556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:16:14.282616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.580000 seconds
loading data in 31.770000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.550896    reg_loss: 0.000000    l2_loss: 0.013305    loss: 0.564201
steps 200    v_Prec: 0.163790  v_Recall: 0.999602  v_F1: 0.281461  v_AUC: 0.477195
steps 200    running time 41 seconds

steps 400    base_loss: 0.495491    reg_loss: 0.000000    l2_loss: 0.013372    loss: 0.508864
steps 400    v_Prec: 0.163803  v_Recall: 0.999602  v_F1: 0.281480  v_AUC: 0.497374
steps 400    running time 48 seconds

steps 600    base_loss: 0.477912    reg_loss: 0.000000    l2_loss: 0.013256    loss: 0.491168
steps 600    v_Prec: 0.164017  v_Recall: 0.998885  v_F1: 0.281768  v_AUC: 0.527525
steps 600    running time 55 seconds

steps 800    base_loss: 0.458997    reg_loss: 0.000000    l2_loss: 0.013142    loss: 0.472139
steps 800    v_Prec: 0.196660  v_Recall: 0.573261  v_F1: 0.292855  v_AUC: 0.584896
steps 800    running time 61 seconds

steps 1000    base_loss: 0.443163    reg_loss: 0.000000    l2_loss: 0.013047    loss: 0.456210
steps 1000    v_Prec: 0.308314  v_Recall: 0.425464  v_F1: 0.357537  v_AUC: 0.671882
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.424263    reg_loss: 0.000000    l2_loss: 0.012986    loss: 0.437249
steps 1200    v_Prec: 0.441288  v_Recall: 0.434467  v_F1: 0.437851  v_AUC: 0.748767
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.391370    reg_loss: 0.000000    l2_loss: 0.012994    loss: 0.404364
steps 1400    v_Prec: 0.514603  v_Recall: 0.484344  v_F1: 0.499015  v_AUC: 0.792582
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.359785    reg_loss: 0.000000    l2_loss: 0.013047    loss: 0.372832
steps 1600    v_Prec: 0.587281  v_Recall: 0.516533  v_F1: 0.549640  v_AUC: 0.821372
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.345922    reg_loss: 0.000000    l2_loss: 0.013247    loss: 0.359169
steps 1800    v_Prec: 0.635402  v_Recall: 0.531113  v_F1: 0.578596  v_AUC: 0.841942
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.333587    reg_loss: 0.000000    l2_loss: 0.013399    loss: 0.346986
steps 2000    v_Prec: 0.659589  v_Recall: 0.556848  v_F1: 0.603880  v_AUC: 0.857841
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.311802    reg_loss: 0.000000    l2_loss: 0.013641    loss: 0.325443
steps 2200    v_Prec: 0.635079  v_Recall: 0.601785  v_F1: 0.617984  v_AUC: 0.865138
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.303348    reg_loss: 0.000000    l2_loss: 0.013873    loss: 0.317221
steps 2400    v_Prec: 0.660498  v_Recall: 0.594295  v_F1: 0.625650  v_AUC: 0.873265
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.303317    reg_loss: 0.000000    l2_loss: 0.014086    loss: 0.317404
steps 2600    v_Prec: 0.653695  v_Recall: 0.620986  v_F1: 0.636921  v_AUC: 0.879349
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.291189    reg_loss: 0.000000    l2_loss: 0.014426    loss: 0.305615
steps 2800    v_Prec: 0.703791  v_Recall: 0.596128  v_F1: 0.645501  v_AUC: 0.884039
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.289664    reg_loss: 0.000000    l2_loss: 0.014719    loss: 0.304383
steps 3000    v_Prec: 0.679709  v_Recall: 0.624253  v_F1: 0.650802  v_AUC: 0.887242
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.282235    reg_loss: 0.000000    l2_loss: 0.015020    loss: 0.297254
steps 3200    v_Prec: 0.662438  v_Recall: 0.640746  v_F1: 0.651411  v_AUC: 0.890236
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.286365    reg_loss: 0.000000    l2_loss: 0.015349    loss: 0.301714
steps 3400    v_Prec: 0.684220  v_Recall: 0.626325  v_F1: 0.653993  v_AUC: 0.891562
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.282848    reg_loss: 0.000000    l2_loss: 0.015716    loss: 0.298564
steps 3600    v_Prec: 0.694730  v_Recall: 0.629193  v_F1: 0.660339  v_AUC: 0.894413
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.274323    reg_loss: 0.000000    l2_loss: 0.016096    loss: 0.290420
steps 3800    v_Prec: 0.679959  v_Recall: 0.639869  v_F1: 0.659305  v_AUC: 0.895820
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.271121    reg_loss: 0.000000    l2_loss: 0.016509    loss: 0.287630
steps 4000    v_Prec: 0.708549  v_Recall: 0.622739  v_F1: 0.662878  v_AUC: 0.896841
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.268519    reg_loss: 0.000000    l2_loss: 0.016919    loss: 0.285438
steps 4200    v_Prec: 0.697454  v_Recall: 0.639551  v_F1: 0.667249  v_AUC: 0.898152
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.271323    reg_loss: 0.000000    l2_loss: 0.017429    loss: 0.288752
steps 4400    v_Prec: 0.718998  v_Recall: 0.619951  v_F1: 0.665811  v_AUC: 0.898415
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.269455    reg_loss: 0.000000    l2_loss: 0.017855    loss: 0.287310
steps 4600    v_Prec: 0.684281  v_Recall: 0.654131  v_F1: 0.668866  v_AUC: 0.901261
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.264752    reg_loss: 0.000000    l2_loss: 0.018406    loss: 0.283158
steps 4800    v_Prec: 0.711409  v_Recall: 0.638913  v_F1: 0.673215  v_AUC: 0.900877
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.265411    reg_loss: 0.000000    l2_loss: 0.018953    loss: 0.284364
steps 5000    v_Prec: 0.678216  v_Recall: 0.667517  v_F1: 0.672824  v_AUC: 0.901920
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.270512    reg_loss: 0.000000    l2_loss: 0.019500    loss: 0.290013
steps 5200    v_Prec: 0.689927  v_Recall: 0.662497  v_F1: 0.675934  v_AUC: 0.905746
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.265641    reg_loss: 0.000000    l2_loss: 0.020213    loss: 0.285854
steps 5400    v_Prec: 0.682155  v_Recall: 0.667915  v_F1: 0.674960  v_AUC: 0.906034
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.174557    reg_loss: 0.000000    l2_loss: 0.020982    loss: 0.195539
steps 5600    v_Prec: 0.653967  v_Recall: 0.679707  v_F1: 0.666589  v_AUC: 0.899955
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.172769    reg_loss: 0.000000    l2_loss: 0.021883    loss: 0.194651
steps 5800    v_Prec: 0.681040  v_Recall: 0.653095  v_F1: 0.666775  v_AUC: 0.897918
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.175647    reg_loss: 0.000000    l2_loss: 0.022512    loss: 0.198159
steps 6000    v_Prec: 0.660021  v_Recall: 0.664648  v_F1: 0.662326  v_AUC: 0.896541
steps 6000    running time 229 seconds

steps 6200    base_loss: 0.167859    reg_loss: 0.000000    l2_loss: 0.023126    loss: 0.190985
steps 6200    v_Prec: 0.661547  v_Recall: 0.655486  v_F1: 0.658502  v_AUC: 0.893526
steps 6200    running time 235 seconds

steps 6400    base_loss: 0.177568    reg_loss: 0.000000    l2_loss: 0.023693    loss: 0.201261
steps 6400    v_Prec: 0.691461  v_Recall: 0.645845  v_F1: 0.667875  v_AUC: 0.896469
steps 6400    running time 241 seconds

steps 6600    base_loss: 0.179936    reg_loss: 0.000000    l2_loss: 0.024251    loss: 0.204187
steps 6600    v_Prec: 0.682694  v_Recall: 0.655008  v_F1: 0.668564  v_AUC: 0.896741
steps 6600    running time 247 seconds

steps 6800    base_loss: 0.178395    reg_loss: 0.000000    l2_loss: 0.024694    loss: 0.203089
steps 6800    v_Prec: 0.709698  v_Recall: 0.625050  v_F1: 0.664690  v_AUC: 0.895669
steps 6800    running time 253 seconds

steps 7000    base_loss: 0.185275    reg_loss: 0.000000    l2_loss: 0.025147    loss: 0.210422
steps 7000    v_Prec: 0.686338  v_Recall: 0.656043  v_F1: 0.670849  v_AUC: 0.897412
steps 7000    running time 259 seconds

steps 7200    base_loss: 0.181346    reg_loss: 0.000000    l2_loss: 0.025696    loss: 0.207042
steps 7200    v_Prec: 0.707741  v_Recall: 0.646164  v_F1: 0.675552  v_AUC: 0.899982
steps 7200    running time 265 seconds

Early stop model F1: 0.675934
testing thre: 0.30230218
testing Prec: 0.5175692741995395
testing Recall: 0.6772296476306197
testing F1: 0.5867317935869634
testing AUC: 0.8702273757911795
overall running time 268 seconds
(0.6252293818486866, 0.5795868772782503, 0.601543583535109, 0.8702273757911795, 0.44622743)

2019-02-24 15:19:12.804487: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:19:13.463700: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:19:13.466773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:19:13.466813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.140000 seconds
loading data in 31.280000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.530630    reg_loss: 0.000000    l2_loss: 0.013290    loss: 0.543920
steps 200    v_Prec: 0.165067  v_Recall: 0.985870  v_F1: 0.282787  v_AUC: 0.536643
steps 200    running time 41 seconds

steps 400    base_loss: 0.513363    reg_loss: 0.000000    l2_loss: 0.013251    loss: 0.526614
steps 400    v_Prec: 0.171928  v_Recall: 0.861237  v_F1: 0.286635  v_AUC: 0.558567
steps 400    running time 48 seconds

steps 600    base_loss: 0.485604    reg_loss: 0.000000    l2_loss: 0.013139    loss: 0.498743
steps 600    v_Prec: 0.178270  v_Recall: 0.762880  v_F1: 0.289005  v_AUC: 0.566008
steps 600    running time 54 seconds

steps 800    base_loss: 0.458532    reg_loss: 0.000000    l2_loss: 0.013014    loss: 0.471546
steps 800    v_Prec: 0.191666  v_Recall: 0.703660  v_F1: 0.301271  v_AUC: 0.591959
steps 800    running time 61 seconds

steps 1000    base_loss: 0.450885    reg_loss: 0.000000    l2_loss: 0.012963    loss: 0.463849
steps 1000    v_Prec: 0.246021  v_Recall: 0.519092  v_F1: 0.333827  v_AUC: 0.647010
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.438538    reg_loss: 0.000000    l2_loss: 0.012923    loss: 0.451461
steps 1200    v_Prec: 0.323400  v_Recall: 0.453997  v_F1: 0.377729  v_AUC: 0.703180
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.417903    reg_loss: 0.000000    l2_loss: 0.012969    loss: 0.430872
steps 1400    v_Prec: 0.376415  v_Recall: 0.485751  v_F1: 0.424150  v_AUC: 0.744492
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.393020    reg_loss: 0.000000    l2_loss: 0.013093    loss: 0.406112
steps 1600    v_Prec: 0.409987  v_Recall: 0.531873  v_F1: 0.463043  v_AUC: 0.777462
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.380689    reg_loss: 0.000000    l2_loss: 0.013298    loss: 0.393987
steps 1800    v_Prec: 0.478559  v_Recall: 0.532428  v_F1: 0.504058  v_AUC: 0.806932
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.360043    reg_loss: 0.000000    l2_loss: 0.013590    loss: 0.373633
steps 2000    v_Prec: 0.530727  v_Recall: 0.533381  v_F1: 0.532051  v_AUC: 0.826172
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.341142    reg_loss: 0.000000    l2_loss: 0.013897    loss: 0.355039
steps 2200    v_Prec: 0.545665  v_Recall: 0.562515  v_F1: 0.553962  v_AUC: 0.837946
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.334179    reg_loss: 0.000000    l2_loss: 0.014259    loss: 0.348438
steps 2400    v_Prec: 0.576174  v_Recall: 0.572835  v_F1: 0.574499  v_AUC: 0.849095
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.326040    reg_loss: 0.000000    l2_loss: 0.014660    loss: 0.340700
steps 2600    v_Prec: 0.587003  v_Recall: 0.585139  v_F1: 0.586070  v_AUC: 0.857993
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.319878    reg_loss: 0.000000    l2_loss: 0.015042    loss: 0.334920
steps 2800    v_Prec: 0.629397  v_Recall: 0.572438  v_F1: 0.599568  v_AUC: 0.865086
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.303523    reg_loss: 0.000000    l2_loss: 0.015500    loss: 0.319023
steps 3000    v_Prec: 0.652239  v_Recall: 0.586171  v_F1: 0.617443  v_AUC: 0.871002
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.304524    reg_loss: 0.000000    l2_loss: 0.015908    loss: 0.320431
steps 3200    v_Prec: 0.639363  v_Recall: 0.609113  v_F1: 0.623872  v_AUC: 0.875212
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.297717    reg_loss: 0.000000    l2_loss: 0.016345    loss: 0.314062
steps 3400    v_Prec: 0.658813  v_Recall: 0.608240  v_F1: 0.632517  v_AUC: 0.877322
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.292891    reg_loss: 0.000000    l2_loss: 0.016784    loss: 0.309675
steps 3600    v_Prec: 0.681339  v_Recall: 0.600857  v_F1: 0.638573  v_AUC: 0.878583
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.295550    reg_loss: 0.000000    l2_loss: 0.017313    loss: 0.312863
steps 3800    v_Prec: 0.667699  v_Recall: 0.616020  v_F1: 0.640819  v_AUC: 0.881749
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.287798    reg_loss: 0.000000    l2_loss: 0.017809    loss: 0.305607
steps 4000    v_Prec: 0.696484  v_Recall: 0.603874  v_F1: 0.646881  v_AUC: 0.881272
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.284248    reg_loss: 0.000000    l2_loss: 0.018286    loss: 0.302535
steps 4200    v_Prec: 0.685213  v_Recall: 0.625705  v_F1: 0.654108  v_AUC: 0.885386
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.288257    reg_loss: 0.000000    l2_loss: 0.018834    loss: 0.307091
steps 4400    v_Prec: 0.684644  v_Recall: 0.626816  v_F1: 0.654455  v_AUC: 0.886078
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.289015    reg_loss: 0.000000    l2_loss: 0.019347    loss: 0.308362
steps 4600    v_Prec: 0.677392  v_Recall: 0.635072  v_F1: 0.655550  v_AUC: 0.887599
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.280449    reg_loss: 0.000000    l2_loss: 0.019963    loss: 0.300412
steps 4800    v_Prec: 0.665639  v_Recall: 0.651584  v_F1: 0.658537  v_AUC: 0.889317
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.280425    reg_loss: 0.000000    l2_loss: 0.020549    loss: 0.300974
steps 5000    v_Prec: 0.707666  v_Recall: 0.628007  v_F1: 0.665461  v_AUC: 0.891983
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.282247    reg_loss: 0.000000    l2_loss: 0.021093    loss: 0.303340
steps 5200    v_Prec: 0.694084  v_Recall: 0.641740  v_F1: 0.666887  v_AUC: 0.891004
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.269463    reg_loss: 0.000000    l2_loss: 0.021777    loss: 0.291240
steps 5400    v_Prec: 0.700140  v_Recall: 0.637056  v_F1: 0.667110  v_AUC: 0.891053
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.164451    reg_loss: 0.000000    l2_loss: 0.022370    loss: 0.186821
steps 5600    v_Prec: 0.668590  v_Recall: 0.643963  v_F1: 0.656045  v_AUC: 0.885994
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.156779    reg_loss: 0.000000    l2_loss: 0.023002    loss: 0.179782
steps 5800    v_Prec: 0.665995  v_Recall: 0.629991  v_F1: 0.647493  v_AUC: 0.882720
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.173704    reg_loss: 0.000000    l2_loss: 0.023642    loss: 0.197346
steps 6000    v_Prec: 0.642789  v_Recall: 0.640391  v_F1: 0.641587  v_AUC: 0.881009
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.164350    reg_loss: 0.000000    l2_loss: 0.024334    loss: 0.188684
steps 6200    v_Prec: 0.681233  v_Recall: 0.613797  v_F1: 0.645759  v_AUC: 0.880270
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.164092    reg_loss: 0.000000    l2_loss: 0.024907    loss: 0.188999
steps 6400    v_Prec: 0.682846  v_Recall: 0.608637  v_F1: 0.643610  v_AUC: 0.880340
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.167735    reg_loss: 0.000000    l2_loss: 0.025387    loss: 0.193122
steps 6600    v_Prec: 0.691705  v_Recall: 0.595777  v_F1: 0.640167  v_AUC: 0.877301
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.184923    reg_loss: 0.000000    l2_loss: 0.025956    loss: 0.210879
steps 6800    v_Prec: 0.655225  v_Recall: 0.645551  v_F1: 0.650352  v_AUC: 0.881517
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.182517    reg_loss: 0.000000    l2_loss: 0.026495    loss: 0.209012
steps 7000    v_Prec: 0.685088  v_Recall: 0.619989  v_F1: 0.650915  v_AUC: 0.880287
steps 7000    running time 261 seconds

steps 7200    base_loss: 0.185058    reg_loss: 0.000000    l2_loss: 0.026966    loss: 0.212025
steps 7200    v_Prec: 0.663777  v_Recall: 0.644280  v_F1: 0.653883  v_AUC: 0.881620
steps 7200    running time 267 seconds

steps 7400    base_loss: 0.175507    reg_loss: 0.000000    l2_loss: 0.027362    loss: 0.202868
steps 7400    v_Prec: 0.681787  v_Recall: 0.639517  v_F1: 0.659976  v_AUC: 0.884109
steps 7400    running time 274 seconds

Early stop model F1: 0.667110
testing thre: 0.33833945
testing Prec: 0.5497005536931712
testing Recall: 0.7093074119076549
testing F1: 0.6193871487989137
testing AUC: 0.8832937246515558
overall running time 276 seconds
(0.6487037866348211, 0.6336330498177399, 0.641079858379229, 0.8832937246515558, 0.47857106)

2019-02-24 15:22:17.285191: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:22:18.286039: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:22:18.289793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:22:18.289837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.430000 seconds
loading data in 30.490000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.553323    reg_loss: 0.000000    l2_loss: 0.013350    loss: 0.566674
steps 200    v_Prec: 0.163727  v_Recall: 1.000000  v_F1: 0.281383  v_AUC: 0.493090
steps 200    running time 41 seconds

steps 400    base_loss: 0.492577    reg_loss: 0.000000    l2_loss: 0.013372    loss: 0.505949
steps 400    v_Prec: 0.164132  v_Recall: 0.986611  v_F1: 0.281444  v_AUC: 0.512594
steps 400    running time 47 seconds

steps 600    base_loss: 0.488025    reg_loss: 0.000000    l2_loss: 0.013287    loss: 0.501312
steps 600    v_Prec: 0.166838  v_Recall: 0.943338  v_F1: 0.283531  v_AUC: 0.538764
steps 600    running time 54 seconds

steps 800    base_loss: 0.469753    reg_loss: 0.000000    l2_loss: 0.013085    loss: 0.482838
steps 800    v_Prec: 0.176388  v_Recall: 0.788094  v_F1: 0.288259  v_AUC: 0.562124
steps 800    running time 61 seconds

steps 1000    base_loss: 0.457207    reg_loss: 0.000000    l2_loss: 0.012951    loss: 0.470158
steps 1000    v_Prec: 0.182259  v_Recall: 0.721788  v_F1: 0.291030  v_AUC: 0.575786
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.446878    reg_loss: 0.000000    l2_loss: 0.012879    loss: 0.459757
steps 1200    v_Prec: 0.233432  v_Recall: 0.508368  v_F1: 0.319950  v_AUC: 0.623259
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.425284    reg_loss: 0.000000    l2_loss: 0.012899    loss: 0.438183
steps 1400    v_Prec: 0.322289  v_Recall: 0.442620  v_F1: 0.372989  v_AUC: 0.676795
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.412505    reg_loss: 0.000000    l2_loss: 0.012884    loss: 0.425389
steps 1600    v_Prec: 0.438065  v_Recall: 0.440230  v_F1: 0.439145  v_AUC: 0.731980
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.386472    reg_loss: 0.000000    l2_loss: 0.013017    loss: 0.399489
steps 1800    v_Prec: 0.467168  v_Recall: 0.475135  v_F1: 0.471118  v_AUC: 0.760460
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.373965    reg_loss: 0.000000    l2_loss: 0.013150    loss: 0.387115
steps 2000    v_Prec: 0.514205  v_Recall: 0.509165  v_F1: 0.511673  v_AUC: 0.788017
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.362907    reg_loss: 0.000000    l2_loss: 0.013097    loss: 0.376004
steps 2200    v_Prec: 0.542801  v_Recall: 0.532117  v_F1: 0.537406  v_AUC: 0.804747
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.362080    reg_loss: 0.000000    l2_loss: 0.013137    loss: 0.375217
steps 2400    v_Prec: 0.546856  v_Recall: 0.551084  v_F1: 0.548962  v_AUC: 0.814960
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.353094    reg_loss: 0.000000    l2_loss: 0.013073    loss: 0.366167
steps 2600    v_Prec: 0.554153  v_Recall: 0.570449  v_F1: 0.562183  v_AUC: 0.824553
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.342028    reg_loss: 0.000000    l2_loss: 0.012987    loss: 0.355015
steps 2800    v_Prec: 0.564870  v_Recall: 0.580491  v_F1: 0.572574  v_AUC: 0.828738
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.342685    reg_loss: 0.000000    l2_loss: 0.012964    loss: 0.355649
steps 3000    v_Prec: 0.560173  v_Recall: 0.588699  v_F1: 0.574082  v_AUC: 0.831502
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.338040    reg_loss: 0.000000    l2_loss: 0.012877    loss: 0.350917
steps 3200    v_Prec: 0.559037  v_Recall: 0.594278  v_F1: 0.576119  v_AUC: 0.834805
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.334297    reg_loss: 0.000000    l2_loss: 0.012834    loss: 0.347131
steps 3400    v_Prec: 0.553586  v_Recall: 0.604718  v_F1: 0.578023  v_AUC: 0.838099
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.334132    reg_loss: 0.000000    l2_loss: 0.012710    loss: 0.346842
steps 3600    v_Prec: 0.541421  v_Recall: 0.629184  v_F1: 0.582013  v_AUC: 0.842399
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.325844    reg_loss: 0.000000    l2_loss: 0.012742    loss: 0.338586
steps 3800    v_Prec: 0.603427  v_Recall: 0.580969  v_F1: 0.591985  v_AUC: 0.847555
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.318469    reg_loss: 0.000000    l2_loss: 0.013002    loss: 0.331470
steps 4000    v_Prec: 0.617087  v_Recall: 0.602088  v_F1: 0.609495  v_AUC: 0.855208
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.311284    reg_loss: 0.000000    l2_loss: 0.013533    loss: 0.324817
steps 4200    v_Prec: 0.623618  v_Recall: 0.633806  v_F1: 0.628671  v_AUC: 0.866439
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.301122    reg_loss: 0.000000    l2_loss: 0.014290    loss: 0.315411
steps 4400    v_Prec: 0.640446  v_Recall: 0.636516  v_F1: 0.638475  v_AUC: 0.874523
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.296974    reg_loss: 0.000000    l2_loss: 0.015216    loss: 0.312190
steps 4600    v_Prec: 0.690523  v_Recall: 0.612050  v_F1: 0.648923  v_AUC: 0.879006
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.287676    reg_loss: 0.000000    l2_loss: 0.016132    loss: 0.303808
steps 4800    v_Prec: 0.689987  v_Recall: 0.634284  v_F1: 0.660964  v_AUC: 0.883426
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.286003    reg_loss: 0.000000    l2_loss: 0.016861    loss: 0.302865
steps 5000    v_Prec: 0.682497  v_Recall: 0.651658  v_F1: 0.666721  v_AUC: 0.886937
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.279324    reg_loss: 0.000000    l2_loss: 0.017613    loss: 0.296937
steps 5200    v_Prec: 0.721746  v_Recall: 0.631097  v_F1: 0.673384  v_AUC: 0.890329
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.278623    reg_loss: 0.000000    l2_loss: 0.018281    loss: 0.296904
steps 5400    v_Prec: 0.723721  v_Recall: 0.639225  v_F1: 0.678854  v_AUC: 0.893854
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.204683    reg_loss: 0.000000    l2_loss: 0.018787    loss: 0.223470
steps 5600    v_Prec: 0.692925  v_Recall: 0.661062  v_F1: 0.676618  v_AUC: 0.892142
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.211223    reg_loss: 0.000000    l2_loss: 0.019122    loss: 0.230345
steps 5800    v_Prec: 0.697343  v_Recall: 0.658830  v_F1: 0.677540  v_AUC: 0.893218
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.213294    reg_loss: 0.000000    l2_loss: 0.019568    loss: 0.232862
steps 6000    v_Prec: 0.722450  v_Recall: 0.645760  v_F1: 0.681956  v_AUC: 0.894271
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.217220    reg_loss: 0.000000    l2_loss: 0.019965    loss: 0.237184
steps 6200    v_Prec: 0.704893  v_Recall: 0.661301  v_F1: 0.682401  v_AUC: 0.893636
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.216360    reg_loss: 0.000000    l2_loss: 0.020238    loss: 0.236598
steps 6400    v_Prec: 0.713021  v_Recall: 0.661141  v_F1: 0.686102  v_AUC: 0.896820
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.206174    reg_loss: 0.000000    l2_loss: 0.020610    loss: 0.226783
steps 6600    v_Prec: 0.735021  v_Recall: 0.656997  v_F1: 0.693823  v_AUC: 0.896700
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.211295    reg_loss: 0.000000    l2_loss: 0.020934    loss: 0.232228
steps 6800    v_Prec: 0.724961  v_Recall: 0.672617  v_F1: 0.697809  v_AUC: 0.899403
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.213285    reg_loss: 0.000000    l2_loss: 0.021307    loss: 0.234592
steps 7000    v_Prec: 0.757173  v_Recall: 0.654048  v_F1: 0.701843  v_AUC: 0.902000
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.210603    reg_loss: 0.000000    l2_loss: 0.021547    loss: 0.232151
steps 7200    v_Prec: 0.738363  v_Recall: 0.673813  v_F1: 0.704613  v_AUC: 0.902962
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.215590    reg_loss: 0.000000    l2_loss: 0.021804    loss: 0.237393
steps 7400    v_Prec: 0.750763  v_Recall: 0.666401  v_F1: 0.706071  v_AUC: 0.903171
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.211370    reg_loss: 0.000000    l2_loss: 0.021913    loss: 0.233283
steps 7600    v_Prec: 0.751545  v_Recall: 0.668712  v_F1: 0.707713  v_AUC: 0.902757
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.204157    reg_loss: 0.000000    l2_loss: 0.022145    loss: 0.226302
steps 7800    v_Prec: 0.751900  v_Recall: 0.670226  v_F1: 0.708718  v_AUC: 0.904306
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.220131    reg_loss: 0.000000    l2_loss: 0.022305    loss: 0.242436
steps 8000    v_Prec: 0.760862  v_Recall: 0.667118  v_F1: 0.710913  v_AUC: 0.907125
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.203130    reg_loss: 0.000000    l2_loss: 0.022310    loss: 0.225440
steps 8200    v_Prec: 0.760263  v_Recall: 0.671501  v_F1: 0.713131  v_AUC: 0.908209
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.206895    reg_loss: 0.000000    l2_loss: 0.022576    loss: 0.229471
steps 8400    v_Prec: 0.744588  v_Recall: 0.690708  v_F1: 0.716636  v_AUC: 0.910164
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.204203    reg_loss: 0.000000    l2_loss: 0.022635    loss: 0.226838
steps 8600    v_Prec: 0.750952  v_Recall: 0.691584  v_F1: 0.720046  v_AUC: 0.911083
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.207949    reg_loss: 0.000000    l2_loss: 0.022678    loss: 0.230627
steps 8800    v_Prec: 0.754710  v_Recall: 0.686325  v_F1: 0.718895  v_AUC: 0.911925
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.211824    reg_loss: 0.000000    l2_loss: 0.022832    loss: 0.234657
steps 9000    v_Prec: 0.750237  v_Recall: 0.694453  v_F1: 0.721268  v_AUC: 0.912931
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.215169    reg_loss: 0.000000    l2_loss: 0.022811    loss: 0.237980
steps 9200    v_Prec: 0.762993  v_Recall: 0.689114  v_F1: 0.724174  v_AUC: 0.914953
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.206645    reg_loss: 0.000000    l2_loss: 0.022801    loss: 0.229446
steps 9400    v_Prec: 0.770757  v_Recall: 0.687281  v_F1: 0.726629  v_AUC: 0.916293
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.209221    reg_loss: 0.000000    l2_loss: 0.022893    loss: 0.232114
steps 9600    v_Prec: 0.770246  v_Recall: 0.688237  v_F1: 0.726936  v_AUC: 0.916044
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.212078    reg_loss: 0.000000    l2_loss: 0.022912    loss: 0.234989
steps 9800    v_Prec: 0.766552  v_Recall: 0.694772  v_F1: 0.728899  v_AUC: 0.917420
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.208376    reg_loss: 0.000000    l2_loss: 0.022952    loss: 0.231328
steps 10000    v_Prec: 0.766065  v_Recall: 0.703060  v_F1: 0.733211  v_AUC: 0.920680
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.204310    reg_loss: 0.000000    l2_loss: 0.023126    loss: 0.227436
steps 10200    v_Prec: 0.777936  v_Recall: 0.695171  v_F1: 0.734228  v_AUC: 0.919455
steps 10200    running time 372 seconds

steps 10400    base_loss: 0.205233    reg_loss: 0.000000    l2_loss: 0.023111    loss: 0.228344
steps 10400    v_Prec: 0.775867  v_Recall: 0.704574  v_F1: 0.738504  v_AUC: 0.920744
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.202835    reg_loss: 0.000000    l2_loss: 0.023177    loss: 0.226012
steps 10600    v_Prec: 0.776988  v_Recall: 0.705531  v_F1: 0.739537  v_AUC: 0.922893
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.196419    reg_loss: 0.000000    l2_loss: 0.023167    loss: 0.219586
steps 10800    v_Prec: 0.782918  v_Recall: 0.702741  v_F1: 0.740666  v_AUC: 0.923193
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.086754    reg_loss: 0.000000    l2_loss: 0.023330    loss: 0.110084
steps 11000    v_Prec: 0.782167  v_Recall: 0.699076  v_F1: 0.738291  v_AUC: 0.920127
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.088324    reg_loss: 0.000000    l2_loss: 0.023339    loss: 0.111663
steps 11200    v_Prec: 0.791170  v_Recall: 0.692620  v_F1: 0.738622  v_AUC: 0.918738
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.088273    reg_loss: 0.000000    l2_loss: 0.023418    loss: 0.111691
steps 11400    v_Prec: 0.774552  v_Recall: 0.699554  v_F1: 0.735145  v_AUC: 0.916925
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.090536    reg_loss: 0.000000    l2_loss: 0.023563    loss: 0.114098
steps 11600    v_Prec: 0.766030  v_Recall: 0.702662  v_F1: 0.732979  v_AUC: 0.916848
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.088269    reg_loss: 0.000000    l2_loss: 0.023630    loss: 0.111899
steps 11800    v_Prec: 0.748576  v_Recall: 0.712305  v_F1: 0.729990  v_AUC: 0.915773
steps 11800    running time 423 seconds

steps 12000    base_loss: 0.084607    reg_loss: 0.000000    l2_loss: 0.023673    loss: 0.108280
steps 12000    v_Prec: 0.758272  v_Recall: 0.710472  v_F1: 0.733594  v_AUC: 0.914918
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.086245    reg_loss: 0.000000    l2_loss: 0.023660    loss: 0.109905
steps 12200    v_Prec: 0.762356  v_Recall: 0.698199  v_F1: 0.728869  v_AUC: 0.914272
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.091540    reg_loss: 0.000000    l2_loss: 0.023774    loss: 0.115314
steps 12400    v_Prec: 0.757891  v_Recall: 0.708001  v_F1: 0.732097  v_AUC: 0.915813
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.092208    reg_loss: 0.000000    l2_loss: 0.023678    loss: 0.115886
steps 12600    v_Prec: 0.784999  v_Recall: 0.687281  v_F1: 0.732897  v_AUC: 0.915236
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.091367    reg_loss: 0.000000    l2_loss: 0.023744    loss: 0.115111
steps 12800    v_Prec: 0.743831  v_Recall: 0.718282  v_F1: 0.730833  v_AUC: 0.913844
steps 12800    running time 454 seconds

Early stop model F1: 0.740666
testing thre: 0.5705374
testing Prec: 0.6070905974330031
testing Recall: 0.7057594167679222
testing F1: 0.6527172202993662
testing AUC: 0.8931172323444003
overall running time 457 seconds
(0.6563381628652034, 0.6671202916160389, 0.661685306594678, 0.8931172323444003, 0.6705821)

2019-02-24 15:27:15.049222: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:27:16.399400: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:27:16.407010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:27:16.407052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.620000 seconds
loading data in 29.720000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.581511    reg_loss: 0.000000    l2_loss: 0.013269    loss: 0.594780
steps 200    v_Prec: 0.164011  v_Recall: 1.000000  v_F1: 0.281803  v_AUC: 0.500594
steps 200    running time 40 seconds

steps 400    base_loss: 0.512248    reg_loss: 0.000000    l2_loss: 0.013179    loss: 0.525427
steps 400    v_Prec: 0.169054  v_Recall: 0.879854  v_F1: 0.283615  v_AUC: 0.533995
steps 400    running time 47 seconds

steps 600    base_loss: 0.487819    reg_loss: 0.000000    l2_loss: 0.013069    loss: 0.500888
steps 600    v_Prec: 0.182490  v_Recall: 0.766550  v_F1: 0.294798  v_AUC: 0.578740
steps 600    running time 53 seconds

steps 800    base_loss: 0.457956    reg_loss: 0.000000    l2_loss: 0.012929    loss: 0.470885
steps 800    v_Prec: 0.245359  v_Recall: 0.513208  v_F1: 0.331995  v_AUC: 0.642714
steps 800    running time 60 seconds

steps 1000    base_loss: 0.430132    reg_loss: 0.000000    l2_loss: 0.012852    loss: 0.442984
steps 1000    v_Prec: 0.305320  v_Recall: 0.526098  v_F1: 0.386396  v_AUC: 0.704584
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.417007    reg_loss: 0.000000    l2_loss: 0.012796    loss: 0.429803
steps 1200    v_Prec: 0.390870  v_Recall: 0.488463  v_F1: 0.434251  v_AUC: 0.748687
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.399123    reg_loss: 0.000000    l2_loss: 0.012842    loss: 0.411965
steps 1400    v_Prec: 0.459697  v_Recall: 0.508673  v_F1: 0.482946  v_AUC: 0.785879
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.378931    reg_loss: 0.000000    l2_loss: 0.012932    loss: 0.391863
steps 1600    v_Prec: 0.542008  v_Recall: 0.500477  v_F1: 0.520415  v_AUC: 0.811411
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.349471    reg_loss: 0.000000    l2_loss: 0.013105    loss: 0.362577
steps 1800    v_Prec: 0.569988  v_Recall: 0.544319  v_F1: 0.556858  v_AUC: 0.830879
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.338033    reg_loss: 0.000000    l2_loss: 0.013263    loss: 0.351296
steps 2000    v_Prec: 0.591138  v_Recall: 0.560471  v_F1: 0.575396  v_AUC: 0.843449
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.327146    reg_loss: 0.000000    l2_loss: 0.013491    loss: 0.340636
steps 2200    v_Prec: 0.599676  v_Recall: 0.588558  v_F1: 0.594065  v_AUC: 0.854639
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.311942    reg_loss: 0.000000    l2_loss: 0.013762    loss: 0.325704
steps 2400    v_Prec: 0.637837  v_Recall: 0.576225  v_F1: 0.605468  v_AUC: 0.862089
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.305250    reg_loss: 0.000000    l2_loss: 0.013989    loss: 0.319239
steps 2600    v_Prec: 0.660730  v_Recall: 0.596276  v_F1: 0.626851  v_AUC: 0.868804
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.299117    reg_loss: 0.000000    l2_loss: 0.014267    loss: 0.313384
steps 2800    v_Prec: 0.673907  v_Recall: 0.597390  v_F1: 0.633346  v_AUC: 0.874409
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.292082    reg_loss: 0.000000    l2_loss: 0.014536    loss: 0.306619
steps 3000    v_Prec: 0.672421  v_Recall: 0.604313  v_F1: 0.636550  v_AUC: 0.876563
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.296793    reg_loss: 0.000000    l2_loss: 0.014913    loss: 0.311706
steps 3200    v_Prec: 0.656616  v_Recall: 0.628978  v_F1: 0.642500  v_AUC: 0.880541
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.292287    reg_loss: 0.000000    l2_loss: 0.015227    loss: 0.307514
steps 3400    v_Prec: 0.683580  v_Recall: 0.621738  v_F1: 0.651194  v_AUC: 0.884461
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.290424    reg_loss: 0.000000    l2_loss: 0.015641    loss: 0.306065
steps 3600    v_Prec: 0.687703  v_Recall: 0.624284  v_F1: 0.654461  v_AUC: 0.886676
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.289095    reg_loss: 0.000000    l2_loss: 0.015967    loss: 0.305062
steps 3800    v_Prec: 0.676099  v_Recall: 0.646404  v_F1: 0.660918  v_AUC: 0.891421
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.279625    reg_loss: 0.000000    l2_loss: 0.016410    loss: 0.296035
steps 4000    v_Prec: 0.673909  v_Recall: 0.653962  v_F1: 0.663786  v_AUC: 0.892390
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.270817    reg_loss: 0.000000    l2_loss: 0.016871    loss: 0.287688
steps 4200    v_Prec: 0.679207  v_Recall: 0.646404  v_F1: 0.662400  v_AUC: 0.894615
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.270305    reg_loss: 0.000000    l2_loss: 0.017351    loss: 0.287657
steps 4400    v_Prec: 0.680431  v_Recall: 0.652928  v_F1: 0.666396  v_AUC: 0.896620
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.268008    reg_loss: 0.000000    l2_loss: 0.017948    loss: 0.285955
steps 4600    v_Prec: 0.692027  v_Recall: 0.649905  v_F1: 0.670305  v_AUC: 0.898742
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.265536    reg_loss: 0.000000    l2_loss: 0.018457    loss: 0.283993
steps 4800    v_Prec: 0.700956  v_Recall: 0.641948  v_F1: 0.670155  v_AUC: 0.898863
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.263754    reg_loss: 0.000000    l2_loss: 0.019079    loss: 0.282833
steps 5000    v_Prec: 0.679485  v_Recall: 0.659373  v_F1: 0.669278  v_AUC: 0.899787
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.268592    reg_loss: 0.000000    l2_loss: 0.019616    loss: 0.288208
steps 5200    v_Prec: 0.713360  v_Recall: 0.639402  v_F1: 0.674359  v_AUC: 0.901790
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.265133    reg_loss: 0.000000    l2_loss: 0.020313    loss: 0.285446
steps 5400    v_Prec: 0.714047  v_Recall: 0.645130  v_F1: 0.677841  v_AUC: 0.901824
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.171655    reg_loss: 0.000000    l2_loss: 0.021085    loss: 0.192740
steps 5600    v_Prec: 0.683409  v_Recall: 0.657145  v_F1: 0.670020  v_AUC: 0.897979
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.187991    reg_loss: 0.000000    l2_loss: 0.021939    loss: 0.209930
steps 5800    v_Prec: 0.690724  v_Recall: 0.643460  v_F1: 0.666255  v_AUC: 0.895264
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.185670    reg_loss: 0.000000    l2_loss: 0.022573    loss: 0.208243
steps 6000    v_Prec: 0.690103  v_Recall: 0.638049  v_F1: 0.663056  v_AUC: 0.894483
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.165102    reg_loss: 0.000000    l2_loss: 0.023243    loss: 0.188345
steps 6200    v_Prec: 0.683889  v_Recall: 0.641391  v_F1: 0.661959  v_AUC: 0.892241
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.183127    reg_loss: 0.000000    l2_loss: 0.023892    loss: 0.207019
steps 6400    v_Prec: 0.693079  v_Recall: 0.643062  v_F1: 0.667134  v_AUC: 0.893461
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.187220    reg_loss: 0.000000    l2_loss: 0.024349    loss: 0.211569
steps 6600    v_Prec: 0.684879  v_Recall: 0.656270  v_F1: 0.670269  v_AUC: 0.894183
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.184669    reg_loss: 0.000000    l2_loss: 0.024955    loss: 0.209624
steps 6800    v_Prec: 0.698112  v_Recall: 0.644176  v_F1: 0.670060  v_AUC: 0.894362
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.184461    reg_loss: 0.000000    l2_loss: 0.025426    loss: 0.209887
steps 7000    v_Prec: 0.683694  v_Recall: 0.660248  v_F1: 0.671767  v_AUC: 0.895788
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.181079    reg_loss: 0.000000    l2_loss: 0.025818    loss: 0.206897
steps 7200    v_Prec: 0.687757  v_Recall: 0.665977  v_F1: 0.676692  v_AUC: 0.897760
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.187574    reg_loss: 0.000000    l2_loss: 0.026188    loss: 0.213762
steps 7400    v_Prec: 0.684465  v_Recall: 0.675207  v_F1: 0.679805  v_AUC: 0.899903
steps 7400    running time 274 seconds

steps 7600    base_loss: 0.175698    reg_loss: 0.000000    l2_loss: 0.026598    loss: 0.202296
steps 7600    v_Prec: 0.717283  v_Recall: 0.650223  v_F1: 0.682108  v_AUC: 0.899859
steps 7600    running time 281 seconds

steps 7800    base_loss: 0.185730    reg_loss: 0.000000    l2_loss: 0.026985    loss: 0.212715
steps 7800    v_Prec: 0.701713  v_Recall: 0.664863  v_F1: 0.682791  v_AUC: 0.900499
steps 7800    running time 288 seconds

steps 8000    base_loss: 0.192017    reg_loss: 0.000000    l2_loss: 0.027374    loss: 0.219391
steps 8000    v_Prec: 0.717687  v_Recall: 0.654758  v_F1: 0.684780  v_AUC: 0.901854
steps 8000    running time 294 seconds

steps 8200    base_loss: 0.181411    reg_loss: 0.000000    l2_loss: 0.027661    loss: 0.209072
steps 8200    v_Prec: 0.707350  v_Recall: 0.674650  v_F1: 0.690613  v_AUC: 0.904065
steps 8200    running time 301 seconds

steps 8400    base_loss: 0.195447    reg_loss: 0.000000    l2_loss: 0.028030    loss: 0.223477
steps 8400    v_Prec: 0.738308  v_Recall: 0.649427  v_F1: 0.691021  v_AUC: 0.904677
steps 8400    running time 308 seconds

steps 8600    base_loss: 0.190896    reg_loss: 0.000000    l2_loss: 0.028320    loss: 0.219215
steps 8600    v_Prec: 0.734129  v_Recall: 0.660646  v_F1: 0.695452  v_AUC: 0.906500
steps 8600    running time 314 seconds

steps 8800    base_loss: 0.187922    reg_loss: 0.000000    l2_loss: 0.028463    loss: 0.216385
steps 8800    v_Prec: 0.748742  v_Recall: 0.651337  v_F1: 0.696651  v_AUC: 0.906386
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.187273    reg_loss: 0.000000    l2_loss: 0.028736    loss: 0.216009
steps 9000    v_Prec: 0.740721  v_Recall: 0.660567  v_F1: 0.698351  v_AUC: 0.908552
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.181106    reg_loss: 0.000000    l2_loss: 0.028977    loss: 0.210083
steps 9200    v_Prec: 0.736088  v_Recall: 0.674650  v_F1: 0.704031  v_AUC: 0.910871
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.177792    reg_loss: 0.000000    l2_loss: 0.029331    loss: 0.207123
steps 9400    v_Prec: 0.722031  v_Recall: 0.683482  v_F1: 0.702228  v_AUC: 0.909871
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.187247    reg_loss: 0.000000    l2_loss: 0.029530    loss: 0.216778
steps 9600    v_Prec: 0.739945  v_Recall: 0.682129  v_F1: 0.709862  v_AUC: 0.912498
steps 9600    running time 347 seconds

steps 9800    base_loss: 0.191823    reg_loss: 0.000000    l2_loss: 0.029615    loss: 0.221438
steps 9800    v_Prec: 0.743676  v_Recall: 0.683084  v_F1: 0.712094  v_AUC: 0.913127
steps 9800    running time 354 seconds

steps 10000    base_loss: 0.182991    reg_loss: 0.000000    l2_loss: 0.029912    loss: 0.212903
steps 10000    v_Prec: 0.750176  v_Recall: 0.679504  v_F1: 0.713093  v_AUC: 0.913396
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.188446    reg_loss: 0.000000    l2_loss: 0.030077    loss: 0.218522
steps 10200    v_Prec: 0.749827  v_Recall: 0.690165  v_F1: 0.718760  v_AUC: 0.917113
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.179926    reg_loss: 0.000000    l2_loss: 0.030216    loss: 0.210142
steps 10400    v_Prec: 0.780891  v_Recall: 0.665261  v_F1: 0.718453  v_AUC: 0.915765
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.189176    reg_loss: 0.000000    l2_loss: 0.030406    loss: 0.219582
steps 10600    v_Prec: 0.769426  v_Recall: 0.676798  v_F1: 0.720146  v_AUC: 0.918724
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.168838    reg_loss: 0.000000    l2_loss: 0.030530    loss: 0.199369
steps 10800    v_Prec: 0.766150  v_Recall: 0.680379  v_F1: 0.720721  v_AUC: 0.917621
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.075771    reg_loss: 0.000000    l2_loss: 0.030685    loss: 0.106456
steps 11000    v_Prec: 0.734922  v_Recall: 0.684516  v_F1: 0.708824  v_AUC: 0.912468
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.070863    reg_loss: 0.000000    l2_loss: 0.030725    loss: 0.101588
steps 11200    v_Prec: 0.712239  v_Recall: 0.680220  v_F1: 0.695861  v_AUC: 0.905789
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.071433    reg_loss: 0.000000    l2_loss: 0.030839    loss: 0.102271
steps 11400    v_Prec: 0.711522  v_Recall: 0.679026  v_F1: 0.694895  v_AUC: 0.904358
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.076673    reg_loss: 0.000000    l2_loss: 0.030949    loss: 0.107622
steps 11600    v_Prec: 0.699885  v_Recall: 0.678947  v_F1: 0.689257  v_AUC: 0.901788
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.074773    reg_loss: 0.000000    l2_loss: 0.030984    loss: 0.105757
steps 11800    v_Prec: 0.700294  v_Recall: 0.662794  v_F1: 0.681028  v_AUC: 0.897656
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.078449    reg_loss: 0.000000    l2_loss: 0.031155    loss: 0.109603
steps 12000    v_Prec: 0.704793  v_Recall: 0.669239  v_F1: 0.686556  v_AUC: 0.900430
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.075374    reg_loss: 0.000000    l2_loss: 0.031203    loss: 0.106577
steps 12200    v_Prec: 0.692555  v_Recall: 0.668364  v_F1: 0.680245  v_AUC: 0.897702
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.082628    reg_loss: 0.000000    l2_loss: 0.031242    loss: 0.113870
steps 12400    v_Prec: 0.708934  v_Recall: 0.653485  v_F1: 0.680081  v_AUC: 0.895305
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.081363    reg_loss: 0.000000    l2_loss: 0.031269    loss: 0.112632
steps 12600    v_Prec: 0.692097  v_Recall: 0.661919  v_F1: 0.676672  v_AUC: 0.894548
steps 12600    running time 443 seconds

steps 12800    base_loss: 0.087213    reg_loss: 0.000000    l2_loss: 0.031406    loss: 0.118620
steps 12800    v_Prec: 0.701281  v_Recall: 0.657702  v_F1: 0.678793  v_AUC: 0.894964
steps 12800    running time 449 seconds

Early stop model F1: 0.720721
testing thre: 0.5638569
testing Prec: 0.5498805150337055
testing Recall: 0.7493074119076549
testing F1: 0.6342878301653913
testing AUC: 0.8997794892731497
overall running time 452 seconds
(0.7262466889323966, 0.6129769137302552, 0.6648216968451016, 0.8997794892731497, 0.8358727)

2019-02-24 15:32:07.682970: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:32:08.037172: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:32:08.045524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:32:08.045568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.170000 seconds
loading data in 31.540000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.687231    reg_loss: 0.006480    l2_loss: 0.013369    loss: 0.707079
steps 200    v_Prec: 0.162334  v_Recall: 0.990011  v_F1: 0.278931  v_AUC: 0.510404
steps 200    running time 41 seconds

steps 400    base_loss: 0.568810    reg_loss: 0.006481    l2_loss: 0.013471    loss: 0.588762
steps 400    v_Prec: 0.164995  v_Recall: 0.947720  v_F1: 0.281059  v_AUC: 0.531039
steps 400    running time 48 seconds

steps 600    base_loss: 0.526186    reg_loss: 0.006473    l2_loss: 0.013417    loss: 0.546076
steps 600    v_Prec: 0.182038  v_Recall: 0.708958  v_F1: 0.289692  v_AUC: 0.574097
steps 600    running time 55 seconds

steps 800    base_loss: 0.491821    reg_loss: 0.006469    l2_loss: 0.013254    loss: 0.511544
steps 800    v_Prec: 0.196378  v_Recall: 0.629773  v_F1: 0.299397  v_AUC: 0.599243
steps 800    running time 61 seconds

steps 1000    base_loss: 0.450932    reg_loss: 0.006459    l2_loss: 0.013136    loss: 0.470528
steps 1000    v_Prec: 0.220092  v_Recall: 0.534397  v_F1: 0.311777  v_AUC: 0.613858
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.435611    reg_loss: 0.006465    l2_loss: 0.013151    loss: 0.455227
steps 1200    v_Prec: 0.272374  v_Recall: 0.452070  v_F1: 0.339936  v_AUC: 0.651919
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.420459    reg_loss: 0.006472    l2_loss: 0.013265    loss: 0.440196
steps 1400    v_Prec: 0.344613  v_Recall: 0.441357  v_F1: 0.387031  v_AUC: 0.695627
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.403306    reg_loss: 0.006457    l2_loss: 0.013285    loss: 0.423048
steps 1600    v_Prec: 0.408020  v_Recall: 0.467214  v_F1: 0.435615  v_AUC: 0.734979
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.385967    reg_loss: 0.006448    l2_loss: 0.013393    loss: 0.405807
steps 1800    v_Prec: 0.482557  v_Recall: 0.472450  v_F1: 0.477450  v_AUC: 0.763339
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.369959    reg_loss: 0.006441    l2_loss: 0.013535    loss: 0.389934
steps 2000    v_Prec: 0.530775  v_Recall: 0.477928  v_F1: 0.502967  v_AUC: 0.781410
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.365598    reg_loss: 0.006449    l2_loss: 0.013649    loss: 0.385697
steps 2200    v_Prec: 0.534948  v_Recall: 0.512325  v_F1: 0.523392  v_AUC: 0.796651
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.357444    reg_loss: 0.006457    l2_loss: 0.013780    loss: 0.377682
steps 2400    v_Prec: 0.554032  v_Recall: 0.540197  v_F1: 0.547027  v_AUC: 0.811520
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.351039    reg_loss: 0.006477    l2_loss: 0.013923    loss: 0.371439
steps 2600    v_Prec: 0.549076  v_Recall: 0.571854  v_F1: 0.560234  v_AUC: 0.823524
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.337143    reg_loss: 0.006488    l2_loss: 0.014018    loss: 0.357648
steps 2800    v_Prec: 0.587533  v_Recall: 0.551232  v_F1: 0.568804  v_AUC: 0.829700
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.327395    reg_loss: 0.006517    l2_loss: 0.014274    loss: 0.348186
steps 3000    v_Prec: 0.585645  v_Recall: 0.584985  v_F1: 0.585315  v_AUC: 0.841038
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.321265    reg_loss: 0.006538    l2_loss: 0.014541    loss: 0.342344
steps 3200    v_Prec: 0.620945  v_Recall: 0.573627  v_F1: 0.596349  v_AUC: 0.846753
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.325565    reg_loss: 0.006583    l2_loss: 0.014864    loss: 0.347012
steps 3400    v_Prec: 0.622463  v_Recall: 0.587965  v_F1: 0.604722  v_AUC: 0.852107
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.312766    reg_loss: 0.006592    l2_loss: 0.015256    loss: 0.334614
steps 3600    v_Prec: 0.641030  v_Recall: 0.587482  v_F1: 0.613089  v_AUC: 0.856469
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.298554    reg_loss: 0.006598    l2_loss: 0.015630    loss: 0.320782
steps 3800    v_Prec: 0.685227  v_Recall: 0.566054  v_F1: 0.619966  v_AUC: 0.859216
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.294722    reg_loss: 0.006613    l2_loss: 0.016106    loss: 0.317441
steps 4000    v_Prec: 0.705671  v_Recall: 0.569357  v_F1: 0.630227  v_AUC: 0.864108
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.290650    reg_loss: 0.006636    l2_loss: 0.016572    loss: 0.313857
steps 4200    v_Prec: 0.689765  v_Recall: 0.594973  v_F1: 0.638872  v_AUC: 0.867697
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.289785    reg_loss: 0.006648    l2_loss: 0.017049    loss: 0.313483
steps 4400    v_Prec: 0.724544  v_Recall: 0.585226  v_F1: 0.647476  v_AUC: 0.870876
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.288590    reg_loss: 0.006680    l2_loss: 0.017539    loss: 0.312809
steps 4600    v_Prec: 0.703986  v_Recall: 0.610359  v_F1: 0.653838  v_AUC: 0.874115
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.283198    reg_loss: 0.006686    l2_loss: 0.017958    loss: 0.307842
steps 4800    v_Prec: 0.706664  v_Recall: 0.616723  v_F1: 0.658637  v_AUC: 0.875946
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.286878    reg_loss: 0.006716    l2_loss: 0.018448    loss: 0.312042
steps 5000    v_Prec: 0.714152  v_Recall: 0.615031  v_F1: 0.660896  v_AUC: 0.879583
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.277851    reg_loss: 0.006716    l2_loss: 0.018995    loss: 0.303561
steps 5200    v_Prec: 0.723552  v_Recall: 0.611004  v_F1: 0.662532  v_AUC: 0.879723
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.269200    reg_loss: 0.006719    l2_loss: 0.019472    loss: 0.295391
steps 5400    v_Prec: 0.730251  v_Recall: 0.615837  v_F1: 0.668182  v_AUC: 0.882742
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.168215    reg_loss: 0.006387    l2_loss: 0.019866    loss: 0.194467
steps 5600    v_Prec: 0.726714  v_Recall: 0.619059  v_F1: 0.668581  v_AUC: 0.881265
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.176611    reg_loss: 0.006364    l2_loss: 0.019918    loss: 0.202894
steps 5800    v_Prec: 0.712184  v_Recall: 0.631867  v_F1: 0.669626  v_AUC: 0.881265
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.177946    reg_loss: 0.006379    l2_loss: 0.020188    loss: 0.204513
steps 6000    v_Prec: 0.724148  v_Recall: 0.626148  v_F1: 0.671591  v_AUC: 0.881127
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.179216    reg_loss: 0.006364    l2_loss: 0.020418    loss: 0.205999
steps 6200    v_Prec: 0.714041  v_Recall: 0.639037  v_F1: 0.674460  v_AUC: 0.880452
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.182592    reg_loss: 0.006420    l2_loss: 0.020593    loss: 0.209604
steps 6400    v_Prec: 0.715898  v_Recall: 0.638795  v_F1: 0.675152  v_AUC: 0.881458
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.188540    reg_loss: 0.006392    l2_loss: 0.020803    loss: 0.215735
steps 6600    v_Prec: 0.684951  v_Recall: 0.666908  v_F1: 0.675809  v_AUC: 0.882575
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.175935    reg_loss: 0.006361    l2_loss: 0.020987    loss: 0.203283
steps 6800    v_Prec: 0.747059  v_Recall: 0.619059  v_F1: 0.677063  v_AUC: 0.882589
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.193953    reg_loss: 0.006438    l2_loss: 0.021127    loss: 0.221518
steps 7000    v_Prec: 0.744527  v_Recall: 0.630095  v_F1: 0.682548  v_AUC: 0.884439
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.195395    reg_loss: 0.006445    l2_loss: 0.021371    loss: 0.223211
steps 7200    v_Prec: 0.736397  v_Recall: 0.637748  v_F1: 0.683531  v_AUC: 0.886359
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.182364    reg_loss: 0.006427    l2_loss: 0.021452    loss: 0.210243
steps 7400    v_Prec: 0.735142  v_Recall: 0.641695  v_F1: 0.685247  v_AUC: 0.886126
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.196176    reg_loss: 0.006466    l2_loss: 0.021559    loss: 0.224201
steps 7600    v_Prec: 0.730658  v_Recall: 0.649670  v_F1: 0.687788  v_AUC: 0.887655
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.189856    reg_loss: 0.006445    l2_loss: 0.021602    loss: 0.217904
steps 7800    v_Prec: 0.762626  v_Recall: 0.628887  v_F1: 0.689329  v_AUC: 0.888973
steps 7800    running time 294 seconds

steps 8000    base_loss: 0.191413    reg_loss: 0.006466    l2_loss: 0.021653    loss: 0.219532
steps 8000    v_Prec: 0.738045  v_Recall: 0.652731  v_F1: 0.692771  v_AUC: 0.890565
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.193363    reg_loss: 0.006472    l2_loss: 0.021711    loss: 0.221546
steps 8200    v_Prec: 0.733559  v_Recall: 0.662236  v_F1: 0.696076  v_AUC: 0.893257
steps 8200    running time 307 seconds

steps 8400    base_loss: 0.181988    reg_loss: 0.006476    l2_loss: 0.021864    loss: 0.210328
steps 8400    v_Prec: 0.726562  v_Recall: 0.674239  v_F1: 0.699423  v_AUC: 0.895430
steps 8400    running time 314 seconds

steps 8600    base_loss: 0.184589    reg_loss: 0.006473    l2_loss: 0.021899    loss: 0.212961
steps 8600    v_Prec: 0.755254  v_Recall: 0.654261  v_F1: 0.701140  v_AUC: 0.896340
steps 8600    running time 320 seconds

steps 8800    base_loss: 0.190789    reg_loss: 0.006494    l2_loss: 0.022059    loss: 0.219342
steps 8800    v_Prec: 0.744771  v_Recall: 0.668278  v_F1: 0.704454  v_AUC: 0.899496
steps 8800    running time 327 seconds

steps 9000    base_loss: 0.189030    reg_loss: 0.006511    l2_loss: 0.022213    loss: 0.217754
steps 9000    v_Prec: 0.762873  v_Recall: 0.658772  v_F1: 0.707011  v_AUC: 0.899683
steps 9000    running time 334 seconds

steps 9200    base_loss: 0.188838    reg_loss: 0.006503    l2_loss: 0.022186    loss: 0.217527
steps 9200    v_Prec: 0.783387  v_Recall: 0.652570  v_F1: 0.712019  v_AUC: 0.900798
steps 9200    running time 340 seconds

steps 9400    base_loss: 0.189065    reg_loss: 0.006497    l2_loss: 0.022268    loss: 0.217830
steps 9400    v_Prec: 0.779983  v_Recall: 0.655389  v_F1: 0.712278  v_AUC: 0.901895
steps 9400    running time 347 seconds

steps 9600    base_loss: 0.184523    reg_loss: 0.006530    l2_loss: 0.022414    loss: 0.213467
steps 9600    v_Prec: 0.741311  v_Recall: 0.690672  v_F1: 0.715096  v_AUC: 0.904732
steps 9600    running time 353 seconds

steps 9800    base_loss: 0.181290    reg_loss: 0.006508    l2_loss: 0.022443    loss: 0.210241
steps 9800    v_Prec: 0.756115  v_Recall: 0.682294  v_F1: 0.717310  v_AUC: 0.905509
steps 9800    running time 360 seconds

steps 10000    base_loss: 0.178556    reg_loss: 0.006507    l2_loss: 0.022425    loss: 0.207488
steps 10000    v_Prec: 0.774981  v_Recall: 0.667231  v_F1: 0.717081  v_AUC: 0.904202
steps 10000    running time 367 seconds

steps 10200    base_loss: 0.181510    reg_loss: 0.006515    l2_loss: 0.022408    loss: 0.210432
steps 10200    v_Prec: 0.772883  v_Recall: 0.674078  v_F1: 0.720107  v_AUC: 0.905177
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.187147    reg_loss: 0.006537    l2_loss: 0.022426    loss: 0.216110
steps 10400    v_Prec: 0.769336  v_Recall: 0.682697  v_F1: 0.723431  v_AUC: 0.905444
steps 10400    running time 379 seconds

steps 10600    base_loss: 0.185862    reg_loss: 0.006529    l2_loss: 0.022392    loss: 0.214784
steps 10600    v_Prec: 0.775190  v_Recall: 0.681086  v_F1: 0.725098  v_AUC: 0.908051
steps 10600    running time 386 seconds

steps 10800    base_loss: 0.182773    reg_loss: 0.006531    l2_loss: 0.022551    loss: 0.211854
steps 10800    v_Prec: 0.778854  v_Recall: 0.680039  v_F1: 0.726100  v_AUC: 0.909660
steps 10800    running time 393 seconds

steps 11000    base_loss: 0.054505    reg_loss: 0.006223    l2_loss: 0.022327    loss: 0.083055
steps 11000    v_Prec: 0.761045  v_Recall: 0.689625  v_F1: 0.723577  v_AUC: 0.907185
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.048582    reg_loss: 0.006207    l2_loss: 0.021851    loss: 0.076639
steps 11200    v_Prec: 0.788013  v_Recall: 0.660867  v_F1: 0.718861  v_AUC: 0.904727
steps 11200    running time 406 seconds

steps 11400    base_loss: 0.049721    reg_loss: 0.006179    l2_loss: 0.021334    loss: 0.077235
steps 11400    v_Prec: 0.788818  v_Recall: 0.658047  v_F1: 0.717523  v_AUC: 0.901904
steps 11400    running time 412 seconds

steps 11600    base_loss: 0.054917    reg_loss: 0.006188    l2_loss: 0.020897    loss: 0.082003
steps 11600    v_Prec: 0.792462  v_Recall: 0.648703  v_F1: 0.713412  v_AUC: 0.901346
steps 11600    running time 418 seconds

steps 11800    base_loss: 0.053992    reg_loss: 0.006159    l2_loss: 0.020656    loss: 0.080807
steps 11800    v_Prec: 0.769245  v_Recall: 0.664894  v_F1: 0.713273  v_AUC: 0.900367
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.052067    reg_loss: 0.006150    l2_loss: 0.020410    loss: 0.078627
steps 12000    v_Prec: 0.776266  v_Recall: 0.657081  v_F1: 0.711718  v_AUC: 0.900330
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.049151    reg_loss: 0.006136    l2_loss: 0.020112    loss: 0.075399
steps 12200    v_Prec: 0.777264  v_Recall: 0.650475  v_F1: 0.708240  v_AUC: 0.898833
steps 12200    running time 437 seconds

steps 12400    base_loss: 0.054653    reg_loss: 0.006152    l2_loss: 0.019912    loss: 0.080717
steps 12400    v_Prec: 0.768214  v_Recall: 0.659981  v_F1: 0.709996  v_AUC: 0.898890
steps 12400    running time 443 seconds

steps 12600    base_loss: 0.057809    reg_loss: 0.006160    l2_loss: 0.019638    loss: 0.083607
steps 12600    v_Prec: 0.771639  v_Recall: 0.659256  v_F1: 0.711034  v_AUC: 0.899381
steps 12600    running time 449 seconds

steps 12800    base_loss: 0.053965    reg_loss: 0.006155    l2_loss: 0.019460    loss: 0.079581
steps 12800    v_Prec: 0.758219  v_Recall: 0.665136  v_F1: 0.708634  v_AUC: 0.898330
steps 12800    running time 455 seconds

Early stop model F1: 0.726100
testing thre: 0.5897189
testing Prec: 0.6192362471069967
testing Recall: 0.6762089914945322
testing F1: 0.646469809260507
testing AUC: 0.8839572732583316
overall running time 458 seconds
(0.7121942915508143, 0.6100121506682867, 0.6571548248599404, 0.8839572732583316, 0.75140464)

2019-02-24 15:37:05.563587: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:37:06.423259: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:37:06.425346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:37:06.425384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.300000 seconds
loading data in 31.590000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.637894    reg_loss: 0.006472    l2_loss: 0.013406    loss: 0.657772
steps 200    v_Prec: 0.163851  v_Recall: 0.999761  v_F1: 0.281557  v_AUC: 0.533783
steps 200    running time 42 seconds

steps 400    base_loss: 0.530810    reg_loss: 0.006423    l2_loss: 0.013326    loss: 0.550560
steps 400    v_Prec: 0.172736  v_Recall: 0.833971  v_F1: 0.286195  v_AUC: 0.553666
steps 400    running time 49 seconds

steps 600    base_loss: 0.487359    reg_loss: 0.006379    l2_loss: 0.013197    loss: 0.506935
steps 600    v_Prec: 0.188400  v_Recall: 0.727693  v_F1: 0.299309  v_AUC: 0.585350
steps 600    running time 55 seconds

steps 800    base_loss: 0.479670    reg_loss: 0.006350    l2_loss: 0.013044    loss: 0.499065
steps 800    v_Prec: 0.219991  v_Recall: 0.616316  v_F1: 0.324245  v_AUC: 0.633502
steps 800    running time 62 seconds

steps 1000    base_loss: 0.450978    reg_loss: 0.006285    l2_loss: 0.012889    loss: 0.470153
steps 1000    v_Prec: 0.278489  v_Recall: 0.514978  v_F1: 0.361491  v_AUC: 0.685319
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.438566    reg_loss: 0.006213    l2_loss: 0.012877    loss: 0.457656
steps 1200    v_Prec: 0.338223  v_Recall: 0.508843  v_F1: 0.406349  v_AUC: 0.731948
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.414348    reg_loss: 0.006118    l2_loss: 0.012977    loss: 0.433443
steps 1400    v_Prec: 0.405851  v_Recall: 0.521670  v_F1: 0.456529  v_AUC: 0.768566
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.388391    reg_loss: 0.006030    l2_loss: 0.013135    loss: 0.407556
steps 1600    v_Prec: 0.496740  v_Recall: 0.503824  v_F1: 0.500257  v_AUC: 0.797203
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.357729    reg_loss: 0.005948    l2_loss: 0.013411    loss: 0.377088
steps 1800    v_Prec: 0.526800  v_Recall: 0.542623  v_F1: 0.534594  v_AUC: 0.819991
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.341972    reg_loss: 0.005888    l2_loss: 0.013714    loss: 0.361574
steps 2000    v_Prec: 0.595303  v_Recall: 0.541189  v_F1: 0.566957  v_AUC: 0.836670
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.320996    reg_loss: 0.005815    l2_loss: 0.014029    loss: 0.340841
steps 2200    v_Prec: 0.633681  v_Recall: 0.556087  v_F1: 0.592354  v_AUC: 0.849990
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.316318    reg_loss: 0.005756    l2_loss: 0.014387    loss: 0.336461
steps 2400    v_Prec: 0.672959  v_Recall: 0.559512  v_F1: 0.611014  v_AUC: 0.858620
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.303338    reg_loss: 0.005699    l2_loss: 0.014670    loss: 0.323707
steps 2600    v_Prec: 0.683279  v_Recall: 0.581103  v_F1: 0.628062  v_AUC: 0.866299
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.291593    reg_loss: 0.005648    l2_loss: 0.015018    loss: 0.312259
steps 2800    v_Prec: 0.716856  v_Recall: 0.587157  v_F1: 0.645557  v_AUC: 0.872962
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.294373    reg_loss: 0.005614    l2_loss: 0.015369    loss: 0.315355
steps 3000    v_Prec: 0.739130  v_Recall: 0.598630  v_F1: 0.661502  v_AUC: 0.880272
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.281723    reg_loss: 0.005579    l2_loss: 0.015630    loss: 0.302932
steps 3200    v_Prec: 0.730372  v_Recall: 0.614404  v_F1: 0.667388  v_AUC: 0.883419
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.277032    reg_loss: 0.005535    l2_loss: 0.016018    loss: 0.298585
steps 3400    v_Prec: 0.704982  v_Recall: 0.645953  v_F1: 0.674178  v_AUC: 0.886800
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.267719    reg_loss: 0.005505    l2_loss: 0.016271    loss: 0.289495
steps 3600    v_Prec: 0.716418  v_Recall: 0.638623  v_F1: 0.675287  v_AUC: 0.888773
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.272049    reg_loss: 0.005526    l2_loss: 0.016656    loss: 0.294231
steps 3800    v_Prec: 0.763852  v_Recall: 0.620539  v_F1: 0.684777  v_AUC: 0.893788
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.267276    reg_loss: 0.005499    l2_loss: 0.016900    loss: 0.289676
steps 4000    v_Prec: 0.726813  v_Recall: 0.653043  v_F1: 0.687956  v_AUC: 0.896367
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.265837    reg_loss: 0.005509    l2_loss: 0.017242    loss: 0.288588
steps 4200    v_Prec: 0.723425  v_Recall: 0.665790  v_F1: 0.693412  v_AUC: 0.897580
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.259440    reg_loss: 0.005518    l2_loss: 0.017534    loss: 0.282491
steps 4400    v_Prec: 0.754655  v_Recall: 0.645714  v_F1: 0.695947  v_AUC: 0.899453
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.259343    reg_loss: 0.005539    l2_loss: 0.017929    loss: 0.282812
steps 4600    v_Prec: 0.750343  v_Recall: 0.653681  v_F1: 0.698684  v_AUC: 0.901123
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.259306    reg_loss: 0.005542    l2_loss: 0.018159    loss: 0.283008
steps 4800    v_Prec: 0.745023  v_Recall: 0.664834  v_F1: 0.702648  v_AUC: 0.902823
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.260440    reg_loss: 0.005574    l2_loss: 0.018531    loss: 0.284545
steps 5000    v_Prec: 0.717473  v_Recall: 0.686663  v_F1: 0.701730  v_AUC: 0.902771
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.259092    reg_loss: 0.005600    l2_loss: 0.018885    loss: 0.283578
steps 5200    v_Prec: 0.765383  v_Recall: 0.661966  v_F1: 0.709928  v_AUC: 0.905842
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.253627    reg_loss: 0.005603    l2_loss: 0.019314    loss: 0.278544
steps 5400    v_Prec: 0.735571  v_Recall: 0.691444  v_F1: 0.712825  v_AUC: 0.909152
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.169014    reg_loss: 0.005454    l2_loss: 0.019810    loss: 0.194278
steps 5600    v_Prec: 0.775989  v_Recall: 0.648821  v_F1: 0.706730  v_AUC: 0.899692
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.169708    reg_loss: 0.005425    l2_loss: 0.020593    loss: 0.195725
steps 5800    v_Prec: 0.752325  v_Recall: 0.657266  v_F1: 0.701590  v_AUC: 0.894020
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.173153    reg_loss: 0.005402    l2_loss: 0.021285    loss: 0.199840
steps 6000    v_Prec: 0.772398  v_Recall: 0.645634  v_F1: 0.703350  v_AUC: 0.899508
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.177705    reg_loss: 0.005412    l2_loss: 0.021847    loss: 0.204964
steps 6200    v_Prec: 0.748698  v_Recall: 0.652964  v_F1: 0.697562  v_AUC: 0.896181
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.171073    reg_loss: 0.005357    l2_loss: 0.022362    loss: 0.198791
steps 6400    v_Prec: 0.764543  v_Recall: 0.658620  v_F1: 0.707640  v_AUC: 0.901208
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.171820    reg_loss: 0.005377    l2_loss: 0.022848    loss: 0.200044
steps 6600    v_Prec: 0.735536  v_Recall: 0.670491  v_F1: 0.701509  v_AUC: 0.895457
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.174691    reg_loss: 0.005371    l2_loss: 0.023255    loss: 0.203318
steps 6800    v_Prec: 0.754784  v_Recall: 0.672403  v_F1: 0.711216  v_AUC: 0.900674
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.174455    reg_loss: 0.005345    l2_loss: 0.023734    loss: 0.203534
steps 7000    v_Prec: 0.764493  v_Recall: 0.673438  v_F1: 0.716083  v_AUC: 0.901931
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.180001    reg_loss: 0.005347    l2_loss: 0.023920    loss: 0.209269
steps 7200    v_Prec: 0.755944  v_Recall: 0.681326  v_F1: 0.716698  v_AUC: 0.902096
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.174069    reg_loss: 0.005310    l2_loss: 0.024202    loss: 0.203581
steps 7400    v_Prec: 0.770328  v_Recall: 0.680051  v_F1: 0.722380  v_AUC: 0.905743
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.183943    reg_loss: 0.005321    l2_loss: 0.024528    loss: 0.213791
steps 7600    v_Prec: 0.769819  v_Recall: 0.673837  v_F1: 0.718637  v_AUC: 0.903848
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.186788    reg_loss: 0.005320    l2_loss: 0.024772    loss: 0.216880
steps 7800    v_Prec: 0.788672  v_Recall: 0.676705  v_F1: 0.728411  v_AUC: 0.907287
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.177232    reg_loss: 0.005282    l2_loss: 0.024873    loss: 0.207388
steps 8000    v_Prec: 0.800364  v_Recall: 0.664994  v_F1: 0.726426  v_AUC: 0.904326
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.180755    reg_loss: 0.005287    l2_loss: 0.025010    loss: 0.211051
steps 8200    v_Prec: 0.790377  v_Recall: 0.675271  v_F1: 0.728304  v_AUC: 0.909684
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.190921    reg_loss: 0.005285    l2_loss: 0.025275    loss: 0.221482
steps 8400    v_Prec: 0.795420  v_Recall: 0.669694  v_F1: 0.727163  v_AUC: 0.908691
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.186121    reg_loss: 0.005284    l2_loss: 0.025431    loss: 0.216835
steps 8600    v_Prec: 0.769055  v_Recall: 0.697737  v_F1: 0.731662  v_AUC: 0.910153
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.180377    reg_loss: 0.005243    l2_loss: 0.025669    loss: 0.211289
steps 8800    v_Prec: 0.789459  v_Recall: 0.681405  v_F1: 0.731463  v_AUC: 0.910830
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.189220    reg_loss: 0.005294    l2_loss: 0.025764    loss: 0.220278
steps 9000    v_Prec: 0.773802  v_Recall: 0.696064  v_F1: 0.732878  v_AUC: 0.913230
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.184110    reg_loss: 0.005260    l2_loss: 0.025853    loss: 0.215223
steps 9200    v_Prec: 0.766163  v_Recall: 0.702438  v_F1: 0.732918  v_AUC: 0.913039
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.182173    reg_loss: 0.005238    l2_loss: 0.025935    loss: 0.213347
steps 9400    v_Prec: 0.795679  v_Recall: 0.686584  v_F1: 0.737117  v_AUC: 0.914355
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.180224    reg_loss: 0.005221    l2_loss: 0.026041    loss: 0.211486
steps 9600    v_Prec: 0.794209  v_Recall: 0.692718  v_F1: 0.740000  v_AUC: 0.917209
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.176919    reg_loss: 0.005234    l2_loss: 0.026078    loss: 0.208230
steps 9800    v_Prec: 0.791482  v_Recall: 0.697339  v_F1: 0.741434  v_AUC: 0.917416
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.182711    reg_loss: 0.005240    l2_loss: 0.026121    loss: 0.214071
steps 10000    v_Prec: 0.768043  v_Recall: 0.721479  v_F1: 0.744033  v_AUC: 0.918913
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.179775    reg_loss: 0.005233    l2_loss: 0.026225    loss: 0.211234
steps 10200    v_Prec: 0.772396  v_Recall: 0.717814  v_F1: 0.744105  v_AUC: 0.918343
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.185850    reg_loss: 0.005245    l2_loss: 0.026339    loss: 0.217434
steps 10400    v_Prec: 0.796328  v_Recall: 0.704908  v_F1: 0.747834  v_AUC: 0.922005
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.178581    reg_loss: 0.005239    l2_loss: 0.026297    loss: 0.210117
steps 10600    v_Prec: 0.791667  v_Recall: 0.712954  v_F1: 0.750252  v_AUC: 0.922185
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.173181    reg_loss: 0.005191    l2_loss: 0.026203    loss: 0.204574
steps 10800    v_Prec: 0.781570  v_Recall: 0.716938  v_F1: 0.747860  v_AUC: 0.922705
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.065732    reg_loss: 0.004947    l2_loss: 0.026172    loss: 0.096851
steps 11000    v_Prec: 0.780351  v_Recall: 0.708732  v_F1: 0.742819  v_AUC: 0.915896
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.063676    reg_loss: 0.004964    l2_loss: 0.026179    loss: 0.094818
steps 11200    v_Prec: 0.783520  v_Recall: 0.690886  v_F1: 0.734293  v_AUC: 0.911193
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.067407    reg_loss: 0.004948    l2_loss: 0.026082    loss: 0.098437
steps 11400    v_Prec: 0.782315  v_Recall: 0.702040  v_F1: 0.740007  v_AUC: 0.913481
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.066510    reg_loss: 0.004980    l2_loss: 0.026102    loss: 0.097593
steps 11600    v_Prec: 0.766693  v_Recall: 0.694312  v_F1: 0.728709  v_AUC: 0.907464
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.071535    reg_loss: 0.004985    l2_loss: 0.026101    loss: 0.102621
steps 11800    v_Prec: 0.777837  v_Recall: 0.696224  v_F1: 0.734771  v_AUC: 0.909889
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.072294    reg_loss: 0.004987    l2_loss: 0.026083    loss: 0.103363
steps 12000    v_Prec: 0.771820  v_Recall: 0.699570  v_F1: 0.733921  v_AUC: 0.907904
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.074283    reg_loss: 0.004986    l2_loss: 0.025995    loss: 0.105263
steps 12200    v_Prec: 0.770663  v_Recall: 0.712396  v_F1: 0.740385  v_AUC: 0.910745
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.079617    reg_loss: 0.004981    l2_loss: 0.026061    loss: 0.110659
steps 12400    v_Prec: 0.771429  v_Recall: 0.699092  v_F1: 0.733481  v_AUC: 0.908562
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.079245    reg_loss: 0.005009    l2_loss: 0.025962    loss: 0.110216
steps 12600    v_Prec: 0.785182  v_Recall: 0.688098  v_F1: 0.733441  v_AUC: 0.908266
steps 12600    running time 443 seconds

Early stop model F1: 0.750252
testing thre: 0.44731694
testing Prec: 0.6045856638502122
testing Recall: 0.7407533414337789
testing F1: 0.6657784378822297
testing AUC: 0.9036960252436973
overall running time 446 seconds
(0.7453433572710951, 0.6456865127582017, 0.6919451027370505, 0.9036960252436973, 0.73977697)

2019-02-24 15:41:53.532385: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:41:53.807024: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:41:53.808822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:41:53.808862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.080000 seconds
loading data in 31.130000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.054188    reg_loss: 0.006499    l2_loss: 0.013335    loss: 1.074023
steps 200    v_Prec: 0.163328  v_Recall: 0.999441  v_F1: 0.280773  v_AUC: 0.499939
steps 200    running time 41 seconds

steps 400    base_loss: 0.762465    reg_loss: 0.006493    l2_loss: 0.013169    loss: 0.782128
steps 400    v_Prec: 0.166376  v_Recall: 0.930883  v_F1: 0.282298  v_AUC: 0.537761
steps 400    running time 48 seconds

steps 600    base_loss: 0.491351    reg_loss: 0.006445    l2_loss: 0.012782    loss: 0.510578
steps 600    v_Prec: 0.179137  v_Recall: 0.778586  v_F1: 0.291261  v_AUC: 0.566143
steps 600    running time 54 seconds

steps 800    base_loss: 0.478988    reg_loss: 0.006413    l2_loss: 0.012624    loss: 0.498025
steps 800    v_Prec: 0.213657  v_Recall: 0.613024  v_F1: 0.316874  v_AUC: 0.622268
steps 800    running time 61 seconds

steps 1000    base_loss: 0.444533    reg_loss: 0.006344    l2_loss: 0.012498    loss: 0.463374
steps 1000    v_Prec: 0.286460  v_Recall: 0.499720  v_F1: 0.364166  v_AUC: 0.695670
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.437146    reg_loss: 0.006291    l2_loss: 0.012391    loss: 0.455828
steps 1200    v_Prec: 0.347183  v_Recall: 0.494766  v_F1: 0.408040  v_AUC: 0.735196
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.423300    reg_loss: 0.006210    l2_loss: 0.012499    loss: 0.442009
steps 1400    v_Prec: 0.395470  v_Recall: 0.486856  v_F1: 0.436430  v_AUC: 0.760223
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.408046    reg_loss: 0.006150    l2_loss: 0.012642    loss: 0.426838
steps 1600    v_Prec: 0.408284  v_Recall: 0.569477  v_F1: 0.475593  v_AUC: 0.789318
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.379505    reg_loss: 0.006078    l2_loss: 0.012875    loss: 0.398457
steps 1800    v_Prec: 0.426349  v_Recall: 0.565002  v_F1: 0.485979  v_AUC: 0.802611
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.369321    reg_loss: 0.006052    l2_loss: 0.013150    loss: 0.388523
steps 2000    v_Prec: 0.479192  v_Recall: 0.572273  v_F1: 0.521612  v_AUC: 0.825181
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.356653    reg_loss: 0.006042    l2_loss: 0.013553    loss: 0.376248
steps 2200    v_Prec: 0.513560  v_Recall: 0.571954  v_F1: 0.541186  v_AUC: 0.836267
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.335263    reg_loss: 0.005979    l2_loss: 0.013914    loss: 0.355156
steps 2400    v_Prec: 0.524024  v_Recall: 0.612625  v_F1: 0.564871  v_AUC: 0.851861
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.328016    reg_loss: 0.005955    l2_loss: 0.014446    loss: 0.348418
steps 2600    v_Prec: 0.557306  v_Recall: 0.607671  v_F1: 0.581400  v_AUC: 0.860944
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.318842    reg_loss: 0.005893    l2_loss: 0.014919    loss: 0.339653
steps 2800    v_Prec: 0.581135  v_Recall: 0.614383  v_F1: 0.597297  v_AUC: 0.866971
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.309210    reg_loss: 0.005841    l2_loss: 0.015464    loss: 0.330515
steps 3000    v_Prec: 0.595873  v_Recall: 0.616061  v_F1: 0.605799  v_AUC: 0.872746
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.304889    reg_loss: 0.005794    l2_loss: 0.016017    loss: 0.326700
steps 3200    v_Prec: 0.617413  v_Recall: 0.607990  v_F1: 0.612666  v_AUC: 0.875366
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.302881    reg_loss: 0.005747    l2_loss: 0.016623    loss: 0.325251
steps 3400    v_Prec: 0.640344  v_Recall: 0.600639  v_F1: 0.619857  v_AUC: 0.879980
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.296831    reg_loss: 0.005701    l2_loss: 0.017219    loss: 0.319752
steps 3600    v_Prec: 0.633460  v_Recall: 0.625969  v_F1: 0.629692  v_AUC: 0.882386
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.291901    reg_loss: 0.005655    l2_loss: 0.017794    loss: 0.315350
steps 3800    v_Prec: 0.639480  v_Recall: 0.629005  v_F1: 0.634199  v_AUC: 0.884670
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.289475    reg_loss: 0.005607    l2_loss: 0.018369    loss: 0.313451
steps 4000    v_Prec: 0.647882  v_Recall: 0.632920  v_F1: 0.640314  v_AUC: 0.887072
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.292796    reg_loss: 0.005584    l2_loss: 0.019081    loss: 0.317461
steps 4200    v_Prec: 0.653833  v_Recall: 0.635078  v_F1: 0.644319  v_AUC: 0.888803
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.289493    reg_loss: 0.005532    l2_loss: 0.019755    loss: 0.314780
steps 4400    v_Prec: 0.665230  v_Recall: 0.628765  v_F1: 0.646484  v_AUC: 0.888151
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.285598    reg_loss: 0.005490    l2_loss: 0.020372    loss: 0.311460
steps 4600    v_Prec: 0.672060  v_Recall: 0.633879  v_F1: 0.652412  v_AUC: 0.891031
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.283870    reg_loss: 0.005450    l2_loss: 0.021099    loss: 0.310419
steps 4800    v_Prec: 0.678111  v_Recall: 0.626528  v_F1: 0.651300  v_AUC: 0.891238
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.279080    reg_loss: 0.005405    l2_loss: 0.021809    loss: 0.306294
steps 5000    v_Prec: 0.663727  v_Recall: 0.643468  v_F1: 0.653440  v_AUC: 0.891817
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.278993    reg_loss: 0.005366    l2_loss: 0.022633    loss: 0.306992
steps 5200    v_Prec: 0.667851  v_Recall: 0.645705  v_F1: 0.656592  v_AUC: 0.892400
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.278606    reg_loss: 0.005357    l2_loss: 0.023270    loss: 0.307233
steps 5400    v_Prec: 0.701414  v_Recall: 0.626368  v_F1: 0.661770  v_AUC: 0.895812
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.172368    reg_loss: 0.005602    l2_loss: 0.023943    loss: 0.201913
steps 5600    v_Prec: 0.660901  v_Recall: 0.650340  v_F1: 0.655578  v_AUC: 0.891119
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.165806    reg_loss: 0.005656    l2_loss: 0.024407    loss: 0.195869
steps 5800    v_Prec: 0.656766  v_Recall: 0.641390  v_F1: 0.648987  v_AUC: 0.887196
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.172592    reg_loss: 0.005693    l2_loss: 0.025030    loss: 0.203315
steps 6000    v_Prec: 0.657542  v_Recall: 0.635318  v_F1: 0.646239  v_AUC: 0.885510
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.174269    reg_loss: 0.005733    l2_loss: 0.025612    loss: 0.205613
steps 6200    v_Prec: 0.653133  v_Recall: 0.641390  v_F1: 0.647208  v_AUC: 0.886659
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.170692    reg_loss: 0.005723    l2_loss: 0.026297    loss: 0.202712
steps 6400    v_Prec: 0.658100  v_Recall: 0.626129  v_F1: 0.641716  v_AUC: 0.883101
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.193256    reg_loss: 0.005734    l2_loss: 0.026761    loss: 0.225751
steps 6600    v_Prec: 0.625225  v_Recall: 0.665841  v_F1: 0.644894  v_AUC: 0.886722
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.178283    reg_loss: 0.005717    l2_loss: 0.027186    loss: 0.211186
steps 6800    v_Prec: 0.653267  v_Recall: 0.637555  v_F1: 0.645315  v_AUC: 0.886339
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.180635    reg_loss: 0.005720    l2_loss: 0.027722    loss: 0.214077
steps 7000    v_Prec: 0.688657  v_Recall: 0.612225  v_F1: 0.648196  v_AUC: 0.887285
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.186282    reg_loss: 0.005713    l2_loss: 0.028102    loss: 0.220097
steps 7200    v_Prec: 0.659522  v_Recall: 0.641710  v_F1: 0.650494  v_AUC: 0.889951
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.179243    reg_loss: 0.005674    l2_loss: 0.028494    loss: 0.213411
steps 7400    v_Prec: 0.673998  v_Recall: 0.631722  v_F1: 0.652176  v_AUC: 0.889488
steps 7400    running time 275 seconds

Early stop model F1: 0.661770
testing thre: 0.39721003
testing Prec: 0.5284076525261292
testing Recall: 0.7101336573511543
testing F1: 0.6059387052627213
testing AUC: 0.8783780017856757
overall running time 278 seconds
(0.6665944892545878, 0.5984933171324422, 0.6307109198934645, 0.8783780017856757, 0.592381)

2019-02-24 15:44:58.982415: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:44:59.787243: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:44:59.789100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:44:59.789142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.330000 seconds
loading data in 31.560000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.109362    reg_loss: 0.006465    l2_loss: 0.013254    loss: 1.129081
steps 200    v_Prec: 0.169082  v_Recall: 0.899818  v_F1: 0.284672  v_AUC: 0.533881
steps 200    running time 41 seconds

steps 400    base_loss: 0.709659    reg_loss: 0.006431    l2_loss: 0.013212    loss: 0.729302
steps 400    v_Prec: 0.175924  v_Recall: 0.786995  v_F1: 0.287566  v_AUC: 0.555341
steps 400    running time 48 seconds

steps 600    base_loss: 0.491795    reg_loss: 0.006380    l2_loss: 0.013031    loss: 0.511206
steps 600    v_Prec: 0.193799  v_Recall: 0.681994  v_F1: 0.301829  v_AUC: 0.597852
steps 600    running time 55 seconds

steps 800    base_loss: 0.474700    reg_loss: 0.006352    l2_loss: 0.012932    loss: 0.493984
steps 800    v_Prec: 0.248759  v_Recall: 0.514893  v_F1: 0.335452  v_AUC: 0.649573
steps 800    running time 61 seconds

steps 1000    base_loss: 0.460802    reg_loss: 0.006317    l2_loss: 0.012832    loss: 0.479951
steps 1000    v_Prec: 0.278292  v_Recall: 0.523031  v_F1: 0.363287  v_AUC: 0.682409
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.437329    reg_loss: 0.006230    l2_loss: 0.012792    loss: 0.456351
steps 1200    v_Prec: 0.338760  v_Recall: 0.481710  v_F1: 0.397782  v_AUC: 0.717955
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.430109    reg_loss: 0.006172    l2_loss: 0.012836    loss: 0.449117
steps 1400    v_Prec: 0.400411  v_Recall: 0.493166  v_F1: 0.441974  v_AUC: 0.752570
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.412743    reg_loss: 0.006095    l2_loss: 0.012858    loss: 0.431696
steps 1600    v_Prec: 0.480110  v_Recall: 0.495852  v_F1: 0.487854  v_AUC: 0.782376
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.394799    reg_loss: 0.006026    l2_loss: 0.013021    loss: 0.413845
steps 1800    v_Prec: 0.554315  v_Recall: 0.490243  v_F1: 0.520314  v_AUC: 0.804912
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.377110    reg_loss: 0.005960    l2_loss: 0.013250    loss: 0.396319
steps 2000    v_Prec: 0.599650  v_Recall: 0.513708  v_F1: 0.553362  v_AUC: 0.826604
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.343501    reg_loss: 0.005873    l2_loss: 0.013523    loss: 0.362897
steps 2200    v_Prec: 0.631070  v_Recall: 0.530852  v_F1: 0.576639  v_AUC: 0.840892
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.333477    reg_loss: 0.005810    l2_loss: 0.013852    loss: 0.353140
steps 2400    v_Prec: 0.648771  v_Recall: 0.552817  v_F1: 0.596963  v_AUC: 0.852393
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.322656    reg_loss: 0.005763    l2_loss: 0.014294    loss: 0.342713
steps 2600    v_Prec: 0.687803  v_Recall: 0.549340  v_F1: 0.610823  v_AUC: 0.860182
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.309546    reg_loss: 0.005709    l2_loss: 0.014643    loss: 0.329897
steps 2800    v_Prec: 0.691200  v_Recall: 0.569092  v_F1: 0.624231  v_AUC: 0.866592
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.307587    reg_loss: 0.005679    l2_loss: 0.015091    loss: 0.328358
steps 3000    v_Prec: 0.694863  v_Recall: 0.589950  v_F1: 0.638123  v_AUC: 0.873312
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.303223    reg_loss: 0.005633    l2_loss: 0.015611    loss: 0.324467
steps 3200    v_Prec: 0.681989  v_Recall: 0.617761  v_F1: 0.648288  v_AUC: 0.876934
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.294158    reg_loss: 0.005583    l2_loss: 0.016015    loss: 0.315755
steps 3400    v_Prec: 0.687115  v_Recall: 0.617682  v_F1: 0.650551  v_AUC: 0.878531
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.290558    reg_loss: 0.005543    l2_loss: 0.016552    loss: 0.312652
steps 3600    v_Prec: 0.721630  v_Recall: 0.598878  v_F1: 0.654549  v_AUC: 0.880219
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.282566    reg_loss: 0.005506    l2_loss: 0.017023    loss: 0.305095
steps 3800    v_Prec: 0.692445  v_Recall: 0.641621  v_F1: 0.666065  v_AUC: 0.884217
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.277629    reg_loss: 0.005469    l2_loss: 0.017568    loss: 0.300667
steps 4000    v_Prec: 0.753380  v_Recall: 0.607490  v_F1: 0.672615  v_AUC: 0.885618
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.278193    reg_loss: 0.005436    l2_loss: 0.018060    loss: 0.301690
steps 4200    v_Prec: 0.751415  v_Recall: 0.619025  v_F1: 0.678825  v_AUC: 0.887252
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.275826    reg_loss: 0.005401    l2_loss: 0.018572    loss: 0.299799
steps 4400    v_Prec: 0.745061  v_Recall: 0.631745  v_F1: 0.683740  v_AUC: 0.888290
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.280716    reg_loss: 0.005400    l2_loss: 0.018984    loss: 0.305100
steps 4600    v_Prec: 0.751628  v_Recall: 0.629059  v_F1: 0.684903  v_AUC: 0.888206
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.266519    reg_loss: 0.005368    l2_loss: 0.019521    loss: 0.291408
steps 4800    v_Prec: 0.761299  v_Recall: 0.633483  v_F1: 0.691535  v_AUC: 0.890870
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.272297    reg_loss: 0.005349    l2_loss: 0.020036    loss: 0.297682
steps 5000    v_Prec: 0.741039  v_Recall: 0.661531  v_F1: 0.699032  v_AUC: 0.894421
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.271951    reg_loss: 0.005343    l2_loss: 0.020496    loss: 0.297789
steps 5200    v_Prec: 0.766398  v_Recall: 0.652682  v_F1: 0.704984  v_AUC: 0.897939
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.259841    reg_loss: 0.005359    l2_loss: 0.021050    loss: 0.286250
steps 5400    v_Prec: 0.735087  v_Recall: 0.677649  v_F1: 0.705200  v_AUC: 0.898726
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.191336    reg_loss: 0.005352    l2_loss: 0.021471    loss: 0.218160
steps 5600    v_Prec: 0.760561  v_Recall: 0.642964  v_F1: 0.696836  v_AUC: 0.894124
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.177226    reg_loss: 0.005346    l2_loss: 0.022053    loss: 0.204625
steps 5800    v_Prec: 0.748557  v_Recall: 0.645414  v_F1: 0.693169  v_AUC: 0.891198
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.176282    reg_loss: 0.005331    l2_loss: 0.022733    loss: 0.204346
steps 6000    v_Prec: 0.756769  v_Recall: 0.644782  v_F1: 0.696301  v_AUC: 0.890601
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.177805    reg_loss: 0.005341    l2_loss: 0.023396    loss: 0.206542
steps 6200    v_Prec: 0.745362  v_Recall: 0.647547  v_F1: 0.693020  v_AUC: 0.889523
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.186333    reg_loss: 0.005331    l2_loss: 0.023969    loss: 0.215633
steps 6400    v_Prec: 0.754675  v_Recall: 0.647231  v_F1: 0.696836  v_AUC: 0.891306
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.177040    reg_loss: 0.005308    l2_loss: 0.024410    loss: 0.206759
steps 6600    v_Prec: 0.758528  v_Recall: 0.648258  v_F1: 0.699071  v_AUC: 0.889349
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.178079    reg_loss: 0.005309    l2_loss: 0.024892    loss: 0.208279
steps 6800    v_Prec: 0.749574  v_Recall: 0.659793  v_F1: 0.701824  v_AUC: 0.890306
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.184018    reg_loss: 0.005311    l2_loss: 0.025212    loss: 0.214540
steps 7000    v_Prec: 0.755061  v_Recall: 0.657107  v_F1: 0.702687  v_AUC: 0.893809
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.183300    reg_loss: 0.005265    l2_loss: 0.025558    loss: 0.214123
steps 7200    v_Prec: 0.772885  v_Recall: 0.650391  v_F1: 0.706367  v_AUC: 0.895483
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.194053    reg_loss: 0.005282    l2_loss: 0.025870    loss: 0.225205
steps 7400    v_Prec: 0.758925  v_Recall: 0.671802  v_F1: 0.712711  v_AUC: 0.897863
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.188011    reg_loss: 0.005272    l2_loss: 0.026137    loss: 0.219421
steps 7600    v_Prec: 0.774385  v_Recall: 0.661136  v_F1: 0.713293  v_AUC: 0.898936
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.186771    reg_loss: 0.005232    l2_loss: 0.026395    loss: 0.218398
steps 7800    v_Prec: 0.789398  v_Recall: 0.654183  v_F1: 0.715458  v_AUC: 0.901403
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.192250    reg_loss: 0.005251    l2_loss: 0.026588    loss: 0.224088
steps 8000    v_Prec: 0.784517  v_Recall: 0.662163  v_F1: 0.718166  v_AUC: 0.898367
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.188314    reg_loss: 0.005240    l2_loss: 0.026822    loss: 0.220377
steps 8200    v_Prec: 0.785420  v_Recall: 0.663111  v_F1: 0.719102  v_AUC: 0.900394
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.194599    reg_loss: 0.005243    l2_loss: 0.026990    loss: 0.226831
steps 8400    v_Prec: 0.752159  v_Recall: 0.694872  v_F1: 0.722382  v_AUC: 0.903903
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.204401    reg_loss: 0.005232    l2_loss: 0.027231    loss: 0.236864
steps 8600    v_Prec: 0.776835  v_Recall: 0.679861  v_F1: 0.725120  v_AUC: 0.905834
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.194455    reg_loss: 0.005211    l2_loss: 0.027359    loss: 0.227024
steps 8800    v_Prec: 0.793158  v_Recall: 0.668642  v_F1: 0.725597  v_AUC: 0.905229
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.194192    reg_loss: 0.005212    l2_loss: 0.027410    loss: 0.226814
steps 9000    v_Prec: 0.795771  v_Recall: 0.677886  v_F1: 0.732113  v_AUC: 0.908313
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.186517    reg_loss: 0.005210    l2_loss: 0.027519    loss: 0.219246
steps 9200    v_Prec: 0.788652  v_Recall: 0.686340  v_F1: 0.733947  v_AUC: 0.908476
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.200041    reg_loss: 0.005209    l2_loss: 0.027501    loss: 0.232751
steps 9400    v_Prec: 0.780246  v_Recall: 0.696532  v_F1: 0.736016  v_AUC: 0.910926
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.188702    reg_loss: 0.005191    l2_loss: 0.027570    loss: 0.221463
steps 9600    v_Prec: 0.784534  v_Recall: 0.690132  v_F1: 0.734311  v_AUC: 0.913302
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.189372    reg_loss: 0.005184    l2_loss: 0.027718    loss: 0.222274
steps 9800    v_Prec: 0.789607  v_Recall: 0.691475  v_F1: 0.737290  v_AUC: 0.912833
steps 9800    running time 354 seconds

steps 10000    base_loss: 0.187092    reg_loss: 0.005175    l2_loss: 0.027690    loss: 0.219957
steps 10000    v_Prec: 0.798187  v_Recall: 0.695583  v_F1: 0.743361  v_AUC: 0.914350
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.189739    reg_loss: 0.005178    l2_loss: 0.027622    loss: 0.222539
steps 10200    v_Prec: 0.795813  v_Recall: 0.696848  v_F1: 0.743050  v_AUC: 0.914804
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.188758    reg_loss: 0.005188    l2_loss: 0.027832    loss: 0.221778
steps 10400    v_Prec: 0.792188  v_Recall: 0.705064  v_F1: 0.746091  v_AUC: 0.916157
steps 10400    running time 373 seconds

steps 10600    base_loss: 0.186140    reg_loss: 0.005185    l2_loss: 0.027819    loss: 0.219144
steps 10600    v_Prec: 0.777400  v_Recall: 0.722367  v_F1: 0.748874  v_AUC: 0.916916
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.180451    reg_loss: 0.005166    l2_loss: 0.027837    loss: 0.213455
steps 10800    v_Prec: 0.799678  v_Recall: 0.705538  v_F1: 0.749664  v_AUC: 0.917281
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.077468    reg_loss: 0.004987    l2_loss: 0.027806    loss: 0.110261
steps 11000    v_Prec: 0.803553  v_Recall: 0.682547  v_F1: 0.738124  v_AUC: 0.909231
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.070933    reg_loss: 0.005023    l2_loss: 0.027855    loss: 0.103812
steps 11200    v_Prec: 0.786659  v_Recall: 0.681125  v_F1: 0.730098  v_AUC: 0.904601
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.074528    reg_loss: 0.005042    l2_loss: 0.027797    loss: 0.107366
steps 11400    v_Prec: 0.772890  v_Recall: 0.681599  v_F1: 0.724380  v_AUC: 0.900117
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.080377    reg_loss: 0.005037    l2_loss: 0.027898    loss: 0.113312
steps 11600    v_Prec: 0.785589  v_Recall: 0.673619  v_F1: 0.725308  v_AUC: 0.898174
steps 11600    running time 411 seconds

steps 11800    base_loss: 0.077821    reg_loss: 0.005046    l2_loss: 0.027798    loss: 0.110664
steps 11800    v_Prec: 0.795022  v_Recall: 0.666193  v_F1: 0.724928  v_AUC: 0.899603
steps 11800    running time 417 seconds

steps 12000    base_loss: 0.080229    reg_loss: 0.005059    l2_loss: 0.027822    loss: 0.113110
steps 12000    v_Prec: 0.778212  v_Recall: 0.676148  v_F1: 0.723599  v_AUC: 0.897863
steps 12000    running time 423 seconds

steps 12200    base_loss: 0.082181    reg_loss: 0.005048    l2_loss: 0.027880    loss: 0.115108
steps 12200    v_Prec: 0.787495  v_Recall: 0.668721  v_F1: 0.723264  v_AUC: 0.896152
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.081024    reg_loss: 0.005035    l2_loss: 0.027916    loss: 0.113975
steps 12400    v_Prec: 0.782189  v_Recall: 0.672434  v_F1: 0.723171  v_AUC: 0.898366
steps 12400    running time 436 seconds

steps 12600    base_loss: 0.076899    reg_loss: 0.005046    l2_loss: 0.027708    loss: 0.109653
steps 12600    v_Prec: 0.768758  v_Recall: 0.682389  v_F1: 0.723004  v_AUC: 0.899931
steps 12600    running time 442 seconds

steps 12800    base_loss: 0.084132    reg_loss: 0.005040    l2_loss: 0.027834    loss: 0.117006
steps 12800    v_Prec: 0.778339  v_Recall: 0.681362  v_F1: 0.726629  v_AUC: 0.899693
steps 12800    running time 449 seconds

Early stop model F1: 0.749664
testing thre: 0.5287438
testing Prec: 0.606719213360387
testing Recall: 0.755722964763062
testing F1: 0.6730731770664242
testing AUC: 0.9068273278885802
overall running time 451 seconds
(0.7468779226495021, 0.6598298906439855, 0.7006606110652354, 0.9068273278885802, 0.8032407)

2019-02-24 15:49:52.837211: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:49:53.068480: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:49:53.069402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:49:53.069436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.260000 seconds
loading data in 31.420000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.001703    reg_loss: 0.006462    l2_loss: 0.013342    loss: 1.021506
steps 200    v_Prec: 0.164736  v_Recall: 0.914083  v_F1: 0.279162  v_AUC: 0.542433
steps 200    running time 41 seconds

steps 400    base_loss: 0.689421    reg_loss: 0.006404    l2_loss: 0.013224    loss: 0.709049
steps 400    v_Prec: 0.168112  v_Recall: 0.862807  v_F1: 0.281395  v_AUC: 0.553576
steps 400    running time 48 seconds

steps 600    base_loss: 0.494927    reg_loss: 0.006388    l2_loss: 0.013029    loss: 0.514344
steps 600    v_Prec: 0.190317  v_Recall: 0.646883  v_F1: 0.294106  v_AUC: 0.586769
steps 600    running time 55 seconds

steps 800    base_loss: 0.468503    reg_loss: 0.006366    l2_loss: 0.012848    loss: 0.487718
steps 800    v_Prec: 0.222846  v_Recall: 0.560643  v_F1: 0.318925  v_AUC: 0.632218
steps 800    running time 61 seconds

steps 1000    base_loss: 0.448151    reg_loss: 0.006305    l2_loss: 0.012652    loss: 0.467108
steps 1000    v_Prec: 0.252283  v_Recall: 0.599968  v_F1: 0.355205  v_AUC: 0.683722
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.442151    reg_loss: 0.006267    l2_loss: 0.012601    loss: 0.461018
steps 1200    v_Prec: 0.333973  v_Recall: 0.477713  v_F1: 0.393116  v_AUC: 0.721820
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.425072    reg_loss: 0.006177    l2_loss: 0.012614    loss: 0.443863
steps 1400    v_Prec: 0.357840  v_Recall: 0.541586  v_F1: 0.430944  v_AUC: 0.756072
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.402975    reg_loss: 0.006100    l2_loss: 0.012689    loss: 0.421764
steps 1600    v_Prec: 0.426813  v_Recall: 0.518007  v_F1: 0.468009  v_AUC: 0.783694
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.384618    reg_loss: 0.006032    l2_loss: 0.012990    loss: 0.403640
steps 1800    v_Prec: 0.485256  v_Recall: 0.527536  v_F1: 0.505513  v_AUC: 0.809909
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.363322    reg_loss: 0.005961    l2_loss: 0.013287    loss: 0.382569
steps 2000    v_Prec: 0.512190  v_Recall: 0.556444  v_F1: 0.533400  v_AUC: 0.829594
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.346424    reg_loss: 0.005895    l2_loss: 0.013690    loss: 0.366009
steps 2200    v_Prec: 0.554029  v_Recall: 0.569687  v_F1: 0.561749  v_AUC: 0.842671
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.327523    reg_loss: 0.005819    l2_loss: 0.014067    loss: 0.347409
steps 2400    v_Prec: 0.574695  v_Recall: 0.578408  v_F1: 0.576545  v_AUC: 0.851833
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.323232    reg_loss: 0.005771    l2_loss: 0.014503    loss: 0.343505
steps 2600    v_Prec: 0.595672  v_Recall: 0.593508  v_F1: 0.594588  v_AUC: 0.858727
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.319289    reg_loss: 0.005727    l2_loss: 0.015009    loss: 0.340025
steps 2800    v_Prec: 0.635951  v_Recall: 0.577358  v_F1: 0.605240  v_AUC: 0.865360
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.308061    reg_loss: 0.005659    l2_loss: 0.015547    loss: 0.329267
steps 3000    v_Prec: 0.635769  v_Recall: 0.596495  v_F1: 0.615506  v_AUC: 0.868757
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.306533    reg_loss: 0.005602    l2_loss: 0.016095    loss: 0.328230
steps 3200    v_Prec: 0.638267  v_Recall: 0.610384  v_F1: 0.624015  v_AUC: 0.875409
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.294463    reg_loss: 0.005547    l2_loss: 0.016541    loss: 0.316551
steps 3400    v_Prec: 0.672686  v_Recall: 0.598595  v_F1: 0.633481  v_AUC: 0.880083
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.295249    reg_loss: 0.005507    l2_loss: 0.017127    loss: 0.317883
steps 3600    v_Prec: 0.656921  v_Recall: 0.627745  v_F1: 0.642002  v_AUC: 0.882785
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.292308    reg_loss: 0.005451    l2_loss: 0.017581    loss: 0.315340
steps 3800    v_Prec: 0.681574  v_Recall: 0.605459  v_F1: 0.641266  v_AUC: 0.884745
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.288660    reg_loss: 0.005391    l2_loss: 0.018193    loss: 0.312243
steps 4000    v_Prec: 0.691568  v_Recall: 0.609981  v_F1: 0.648217  v_AUC: 0.886734
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.289708    reg_loss: 0.005356    l2_loss: 0.018794    loss: 0.313858
steps 4200    v_Prec: 0.662976  v_Recall: 0.647933  v_F1: 0.655368  v_AUC: 0.891263
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.281086    reg_loss: 0.005300    l2_loss: 0.019258    loss: 0.305644
steps 4400    v_Prec: 0.697542  v_Recall: 0.620882  v_F1: 0.656983  v_AUC: 0.891101
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.277504    reg_loss: 0.005264    l2_loss: 0.019926    loss: 0.302694
steps 4600    v_Prec: 0.707708  v_Recall: 0.620559  v_F1: 0.661274  v_AUC: 0.892904
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.291656    reg_loss: 0.005246    l2_loss: 0.020499    loss: 0.317400
steps 4800    v_Prec: 0.694142  v_Recall: 0.632429  v_F1: 0.661850  v_AUC: 0.892220
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.280627    reg_loss: 0.005183    l2_loss: 0.021120    loss: 0.306930
steps 5000    v_Prec: 0.696236  v_Recall: 0.640746  v_F1: 0.667339  v_AUC: 0.895842
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.280866    reg_loss: 0.005151    l2_loss: 0.021741    loss: 0.307758
steps 5200    v_Prec: 0.693126  v_Recall: 0.652213  v_F1: 0.672047  v_AUC: 0.897541
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.266342    reg_loss: 0.005104    l2_loss: 0.022265    loss: 0.293711
steps 5400    v_Prec: 0.715524  v_Recall: 0.626373  v_F1: 0.667987  v_AUC: 0.896725
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.162699    reg_loss: 0.005265    l2_loss: 0.022956    loss: 0.190920
steps 5600    v_Prec: 0.698630  v_Recall: 0.621851  v_F1: 0.658008  v_AUC: 0.889677
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.164594    reg_loss: 0.005312    l2_loss: 0.023600    loss: 0.193506
steps 5800    v_Prec: 0.685485  v_Recall: 0.628472  v_F1: 0.655742  v_AUC: 0.888695
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.169878    reg_loss: 0.005374    l2_loss: 0.024335    loss: 0.199586
steps 6000    v_Prec: 0.678244  v_Recall: 0.614987  v_F1: 0.645068  v_AUC: 0.884949
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.180628    reg_loss: 0.005402    l2_loss: 0.025039    loss: 0.211068
steps 6200    v_Prec: 0.671438  v_Recall: 0.632510  v_F1: 0.651393  v_AUC: 0.884507
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.176267    reg_loss: 0.005365    l2_loss: 0.025670    loss: 0.207301
steps 6400    v_Prec: 0.654588  v_Recall: 0.652051  v_F1: 0.653317  v_AUC: 0.885798
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.183439    reg_loss: 0.005385    l2_loss: 0.026167    loss: 0.214990
steps 6600    v_Prec: 0.682912  v_Recall: 0.623466  v_F1: 0.651836  v_AUC: 0.887235
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.183626    reg_loss: 0.005353    l2_loss: 0.026688    loss: 0.215668
steps 6800    v_Prec: 0.696895  v_Recall: 0.618056  v_F1: 0.655112  v_AUC: 0.885935
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.190254    reg_loss: 0.005349    l2_loss: 0.027099    loss: 0.222701
steps 7000    v_Prec: 0.653301  v_Recall: 0.651244  v_F1: 0.652271  v_AUC: 0.886602
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.179649    reg_loss: 0.005332    l2_loss: 0.027423    loss: 0.212404
steps 7200    v_Prec: 0.666416  v_Recall: 0.644622  v_F1: 0.655338  v_AUC: 0.887140
steps 7200    running time 268 seconds

Early stop model F1: 0.672047
testing thre: 0.42592606
testing Prec: 0.5456617592108213
testing Recall: 0.7097448359659781
testing F1: 0.6169803747597017
testing AUC: 0.8801471111409824
overall running time 271 seconds
(0.6550561797752809, 0.6233778857837181, 0.6388245548499564, 0.8801471111409824, 0.58167994)

2019-02-24 15:52:53.381938: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:52:54.132420: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:52:54.137431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:52:54.137477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.430000 seconds
loading data in 31.650000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.553002    reg_loss: 0.006477    l2_loss: 0.013348    loss: 0.572827
steps 200    v_Prec: 0.163787  v_Recall: 0.999920  v_F1: 0.281469  v_AUC: 0.492127
steps 200    running time 41 seconds

steps 400    base_loss: 0.499175    reg_loss: 0.006471    l2_loss: 0.013385    loss: 0.519032
steps 400    v_Prec: 0.163750  v_Recall: 1.000000  v_F1: 0.281419  v_AUC: 0.505623
steps 400    running time 48 seconds

steps 600    base_loss: 0.484801    reg_loss: 0.006472    l2_loss: 0.013261    loss: 0.504534
steps 600    v_Prec: 0.163780  v_Recall: 0.999920  v_F1: 0.281459  v_AUC: 0.519316
steps 600    running time 54 seconds

steps 800    base_loss: 0.464420    reg_loss: 0.006476    l2_loss: 0.013086    loss: 0.483982
steps 800    v_Prec: 0.163748  v_Recall: 1.000000  v_F1: 0.281415  v_AUC: 0.511208
steps 800    running time 61 seconds

steps 1000    base_loss: 0.455014    reg_loss: 0.006482    l2_loss: 0.012890    loss: 0.474386
steps 1000    v_Prec: 0.163871  v_Recall: 0.998884  v_F1: 0.281553  v_AUC: 0.543283
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.449668    reg_loss: 0.006503    l2_loss: 0.012742    loss: 0.468913
steps 1200    v_Prec: 0.230550  v_Recall: 0.533865  v_F1: 0.322030  v_AUC: 0.628766
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.431357    reg_loss: 0.006546    l2_loss: 0.012663    loss: 0.450567
steps 1400    v_Prec: 0.417329  v_Recall: 0.397610  v_F1: 0.407231  v_AUC: 0.722445
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.411804    reg_loss: 0.006617    l2_loss: 0.012664    loss: 0.431086
steps 1600    v_Prec: 0.491382  v_Recall: 0.477052  v_F1: 0.484111  v_AUC: 0.776533
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.379271    reg_loss: 0.006668    l2_loss: 0.012830    loss: 0.398770
steps 1800    v_Prec: 0.519322  v_Recall: 0.539681  v_F1: 0.529306  v_AUC: 0.810503
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.347765    reg_loss: 0.006724    l2_loss: 0.013023    loss: 0.367512
steps 2000    v_Prec: 0.584268  v_Recall: 0.539761  v_F1: 0.561133  v_AUC: 0.830767
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.328201    reg_loss: 0.006782    l2_loss: 0.013324    loss: 0.348306
steps 2200    v_Prec: 0.635084  v_Recall: 0.550120  v_F1: 0.589556  v_AUC: 0.844827
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.315205    reg_loss: 0.006801    l2_loss: 0.013710    loss: 0.335717
steps 2400    v_Prec: 0.643982  v_Recall: 0.576813  v_F1: 0.608549  v_AUC: 0.855868
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.306692    reg_loss: 0.006825    l2_loss: 0.014049    loss: 0.327566
steps 2600    v_Prec: 0.664110  v_Recall: 0.586375  v_F1: 0.622826  v_AUC: 0.865367
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.301488    reg_loss: 0.006853    l2_loss: 0.014422    loss: 0.322762
steps 2800    v_Prec: 0.679389  v_Recall: 0.591474  v_F1: 0.632391  v_AUC: 0.870518
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.287058    reg_loss: 0.006863    l2_loss: 0.014712    loss: 0.308633
steps 3000    v_Prec: 0.693019  v_Recall: 0.597211  v_F1: 0.641558  v_AUC: 0.876572
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.288983    reg_loss: 0.006898    l2_loss: 0.015082    loss: 0.310963
steps 3200    v_Prec: 0.701080  v_Recall: 0.600080  v_F1: 0.646660  v_AUC: 0.879982
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.285846    reg_loss: 0.006904    l2_loss: 0.015431    loss: 0.308182
steps 3400    v_Prec: 0.694510  v_Recall: 0.610837  v_F1: 0.649992  v_AUC: 0.884242
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.275440    reg_loss: 0.006895    l2_loss: 0.015846    loss: 0.298181
steps 3600    v_Prec: 0.696048  v_Recall: 0.616016  v_F1: 0.653591  v_AUC: 0.886968
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.278747    reg_loss: 0.006918    l2_loss: 0.016268    loss: 0.301934
steps 3800    v_Prec: 0.694032  v_Recall: 0.626454  v_F1: 0.658514  v_AUC: 0.891154
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.273593    reg_loss: 0.006918    l2_loss: 0.016651    loss: 0.297162
steps 4000    v_Prec: 0.691150  v_Recall: 0.632829  v_F1: 0.660705  v_AUC: 0.892174
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.271926    reg_loss: 0.006930    l2_loss: 0.017151    loss: 0.296007
steps 4200    v_Prec: 0.709182  v_Recall: 0.629562  v_F1: 0.667004  v_AUC: 0.894008
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.273633    reg_loss: 0.006961    l2_loss: 0.017592    loss: 0.298186
steps 4400    v_Prec: 0.674504  v_Recall: 0.656016  v_F1: 0.665132  v_AUC: 0.896232
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.264214    reg_loss: 0.006940    l2_loss: 0.018174    loss: 0.289328
steps 4600    v_Prec: 0.706033  v_Recall: 0.637849  v_F1: 0.670211  v_AUC: 0.898196
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.268018    reg_loss: 0.006974    l2_loss: 0.018720    loss: 0.293712
steps 4800    v_Prec: 0.688765  v_Recall: 0.648207  v_F1: 0.667871  v_AUC: 0.898999
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.267399    reg_loss: 0.006972    l2_loss: 0.019400    loss: 0.293772
steps 5000    v_Prec: 0.688981  v_Recall: 0.648685  v_F1: 0.668226  v_AUC: 0.900593
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.267772    reg_loss: 0.006996    l2_loss: 0.020009    loss: 0.294777
steps 5200    v_Prec: 0.685882  v_Recall: 0.660797  v_F1: 0.673106  v_AUC: 0.902602
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.257914    reg_loss: 0.006982    l2_loss: 0.020676    loss: 0.285572
steps 5400    v_Prec: 0.699520  v_Recall: 0.650359  v_F1: 0.674044  v_AUC: 0.903560
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.177428    reg_loss: 0.007149    l2_loss: 0.021391    loss: 0.205968
steps 5600    v_Prec: 0.705960  v_Recall: 0.639920  v_F1: 0.671320  v_AUC: 0.898258
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.178094    reg_loss: 0.007117    l2_loss: 0.022272    loss: 0.207483
steps 5800    v_Prec: 0.707616  v_Recall: 0.629243  v_F1: 0.666132  v_AUC: 0.896762
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.175261    reg_loss: 0.007132    l2_loss: 0.023009    loss: 0.205402
steps 6000    v_Prec: 0.695731  v_Recall: 0.638964  v_F1: 0.666141  v_AUC: 0.894724
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.173634    reg_loss: 0.007112    l2_loss: 0.023723    loss: 0.204469
steps 6200    v_Prec: 0.685434  v_Recall: 0.650916  v_F1: 0.667729  v_AUC: 0.895043
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.183836    reg_loss: 0.007109    l2_loss: 0.024209    loss: 0.215153
steps 6400    v_Prec: 0.707098  v_Recall: 0.632669  v_F1: 0.667816  v_AUC: 0.895639
steps 6400    running time 242 seconds

steps 6600    base_loss: 0.179205    reg_loss: 0.007156    l2_loss: 0.024785    loss: 0.211146
steps 6600    v_Prec: 0.704574  v_Recall: 0.635857  v_F1: 0.668454  v_AUC: 0.896976
steps 6600    running time 248 seconds

steps 6800    base_loss: 0.190001    reg_loss: 0.007121    l2_loss: 0.025291    loss: 0.222413
steps 6800    v_Prec: 0.708326  v_Recall: 0.639920  v_F1: 0.672388  v_AUC: 0.897699
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.181299    reg_loss: 0.007125    l2_loss: 0.025643    loss: 0.214067
steps 7000    v_Prec: 0.706170  v_Recall: 0.643825  v_F1: 0.673558  v_AUC: 0.899489
steps 7000    running time 261 seconds

steps 7200    base_loss: 0.193584    reg_loss: 0.007136    l2_loss: 0.026039    loss: 0.226759
steps 7200    v_Prec: 0.702098  v_Recall: 0.645259  v_F1: 0.672480  v_AUC: 0.900022
steps 7200    running time 267 seconds

steps 7400    base_loss: 0.191618    reg_loss: 0.007113    l2_loss: 0.026520    loss: 0.225252
steps 7400    v_Prec: 0.718369  v_Recall: 0.638805  v_F1: 0.676255  v_AUC: 0.901769
steps 7400    running time 273 seconds

steps 7600    base_loss: 0.196318    reg_loss: 0.007152    l2_loss: 0.026848    loss: 0.230319
steps 7600    v_Prec: 0.722848  v_Recall: 0.639044  v_F1: 0.678368  v_AUC: 0.902530
steps 7600    running time 280 seconds

steps 7800    base_loss: 0.182200    reg_loss: 0.007125    l2_loss: 0.027229    loss: 0.216555
steps 7800    v_Prec: 0.720930  v_Recall: 0.644701  v_F1: 0.680688  v_AUC: 0.903523
steps 7800    running time 286 seconds

steps 8000    base_loss: 0.191608    reg_loss: 0.007157    l2_loss: 0.027637    loss: 0.226402
steps 8000    v_Prec: 0.713198  v_Recall: 0.663984  v_F1: 0.687711  v_AUC: 0.906531
steps 8000    running time 293 seconds

steps 8200    base_loss: 0.181168    reg_loss: 0.007139    l2_loss: 0.027899    loss: 0.216207
steps 8200    v_Prec: 0.746745  v_Recall: 0.639761  v_F1: 0.689125  v_AUC: 0.905423
steps 8200    running time 300 seconds

steps 8400    base_loss: 0.178954    reg_loss: 0.007172    l2_loss: 0.028184    loss: 0.214311
steps 8400    v_Prec: 0.715221  v_Recall: 0.661594  v_F1: 0.687363  v_AUC: 0.906891
steps 8400    running time 307 seconds

steps 8600    base_loss: 0.179606    reg_loss: 0.007159    l2_loss: 0.028568    loss: 0.215334
steps 8600    v_Prec: 0.728109  v_Recall: 0.661912  v_F1: 0.693435  v_AUC: 0.908822
steps 8600    running time 312 seconds

steps 8800    base_loss: 0.186487    reg_loss: 0.007155    l2_loss: 0.028782    loss: 0.222423
steps 8800    v_Prec: 0.724262  v_Recall: 0.672669  v_F1: 0.697513  v_AUC: 0.910720
steps 8800    running time 319 seconds

steps 9000    base_loss: 0.178600    reg_loss: 0.007168    l2_loss: 0.028917    loss: 0.214686
steps 9000    v_Prec: 0.738614  v_Recall: 0.653865  v_F1: 0.693660  v_AUC: 0.909585
steps 9000    running time 326 seconds

steps 9200    base_loss: 0.188249    reg_loss: 0.007149    l2_loss: 0.029166    loss: 0.224564
steps 9200    v_Prec: 0.727406  v_Recall: 0.670837  v_F1: 0.697977  v_AUC: 0.911737
steps 9200    running time 332 seconds

steps 9400    base_loss: 0.190774    reg_loss: 0.007144    l2_loss: 0.029375    loss: 0.227294
steps 9400    v_Prec: 0.769041  v_Recall: 0.645259  v_F1: 0.701733  v_AUC: 0.912956
steps 9400    running time 338 seconds

steps 9600    base_loss: 0.182079    reg_loss: 0.007156    l2_loss: 0.029607    loss: 0.218841
steps 9600    v_Prec: 0.762616  v_Recall: 0.658645  v_F1: 0.706828  v_AUC: 0.913498
steps 9600    running time 345 seconds

steps 9800    base_loss: 0.183548    reg_loss: 0.007144    l2_loss: 0.029753    loss: 0.220445
steps 9800    v_Prec: 0.738923  v_Recall: 0.677689  v_F1: 0.706983  v_AUC: 0.913990
steps 9800    running time 351 seconds

steps 10000    base_loss: 0.181470    reg_loss: 0.007160    l2_loss: 0.030053    loss: 0.218683
steps 10000    v_Prec: 0.756938  v_Recall: 0.675936  v_F1: 0.714147  v_AUC: 0.917621
steps 10000    running time 358 seconds

steps 10200    base_loss: 0.184720    reg_loss: 0.007172    l2_loss: 0.030265    loss: 0.222157
steps 10200    v_Prec: 0.749456  v_Recall: 0.685737  v_F1: 0.716182  v_AUC: 0.917770
steps 10200    running time 365 seconds

steps 10400    base_loss: 0.185075    reg_loss: 0.007166    l2_loss: 0.030434    loss: 0.222675
steps 10400    v_Prec: 0.758206  v_Recall: 0.682869  v_F1: 0.718568  v_AUC: 0.920061
steps 10400    running time 371 seconds

steps 10600    base_loss: 0.178126    reg_loss: 0.007179    l2_loss: 0.030718    loss: 0.216023
steps 10600    v_Prec: 0.787329  v_Recall: 0.663426  v_F1: 0.720086  v_AUC: 0.919907
steps 10600    running time 378 seconds

steps 10800    base_loss: 0.172018    reg_loss: 0.007187    l2_loss: 0.030833    loss: 0.210038
steps 10800    v_Prec: 0.780324  v_Recall: 0.675618  v_F1: 0.724206  v_AUC: 0.921644
steps 10800    running time 384 seconds

steps 11000    base_loss: 0.078750    reg_loss: 0.007268    l2_loss: 0.031003    loss: 0.117022
steps 11000    v_Prec: 0.733663  v_Recall: 0.686135  v_F1: 0.709104  v_AUC: 0.914222
steps 11000    running time 391 seconds

steps 11200    base_loss: 0.076313    reg_loss: 0.007238    l2_loss: 0.031102    loss: 0.114653
steps 11200    v_Prec: 0.729019  v_Recall: 0.674183  v_F1: 0.700530  v_AUC: 0.909161
steps 11200    running time 397 seconds

steps 11400    base_loss: 0.076684    reg_loss: 0.007240    l2_loss: 0.031083    loss: 0.115007
steps 11400    v_Prec: 0.744577  v_Recall: 0.653625  v_F1: 0.696143  v_AUC: 0.906913
steps 11400    running time 404 seconds

steps 11600    base_loss: 0.075889    reg_loss: 0.007247    l2_loss: 0.031147    loss: 0.114283
steps 11600    v_Prec: 0.725963  v_Recall: 0.654582  v_F1: 0.688427  v_AUC: 0.903890
steps 11600    running time 410 seconds

steps 11800    base_loss: 0.079658    reg_loss: 0.007221    l2_loss: 0.031300    loss: 0.118179
steps 11800    v_Prec: 0.717755  v_Recall: 0.652271  v_F1: 0.683448  v_AUC: 0.901308
steps 11800    running time 416 seconds

steps 12000    base_loss: 0.079310    reg_loss: 0.007213    l2_loss: 0.031372    loss: 0.117895
steps 12000    v_Prec: 0.722946  v_Recall: 0.645179  v_F1: 0.681853  v_AUC: 0.899551
steps 12000    running time 422 seconds

steps 12200    base_loss: 0.083778    reg_loss: 0.007221    l2_loss: 0.031549    loss: 0.122547
steps 12200    v_Prec: 0.726511  v_Recall: 0.642629  v_F1: 0.682001  v_AUC: 0.899097
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.083567    reg_loss: 0.007211    l2_loss: 0.031460    loss: 0.122238
steps 12400    v_Prec: 0.694495  v_Recall: 0.665498  v_F1: 0.679688  v_AUC: 0.897541
steps 12400    running time 434 seconds

steps 12600    base_loss: 0.087793    reg_loss: 0.007198    l2_loss: 0.031676    loss: 0.126666
steps 12600    v_Prec: 0.677463  v_Recall: 0.681673  v_F1: 0.679562  v_AUC: 0.899294
steps 12600    running time 440 seconds

steps 12800    base_loss: 0.088899    reg_loss: 0.007210    l2_loss: 0.031715    loss: 0.127825
steps 12800    v_Prec: 0.732166  v_Recall: 0.639522  v_F1: 0.682715  v_AUC: 0.898998
steps 12800    running time 446 seconds

Early stop model F1: 0.724206
testing thre: 0.47166526
testing Prec: 0.5651262821219808
testing Recall: 0.7471202916160389
testing F1: 0.6435030140656396
testing AUC: 0.9016080900496446
overall running time 449 seconds
(0.6942101126539166, 0.6439368165249089, 0.6681290973272819, 0.9016080900496446, 0.72219944)

2019-02-24 15:57:45.293083: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:57:46.967395: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:57:46.978286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:57:46.978331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.670000 seconds
loading data in 30.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.161839    reg_loss: 0.006503    l2_loss: 0.013324    loss: 1.181666
steps 200    v_Prec: 0.165762  v_Recall: 0.991236  v_F1: 0.284027  v_AUC: 0.511730
steps 200    running time 41 seconds

steps 400    base_loss: 0.713252    reg_loss: 0.006496    l2_loss: 0.013246    loss: 0.732994
steps 400    v_Prec: 0.165307  v_Recall: 0.999921  v_F1: 0.283711  v_AUC: 0.499907
steps 400    running time 48 seconds

steps 600    base_loss: 0.493257    reg_loss: 0.006525    l2_loss: 0.013247    loss: 0.513029
steps 600    v_Prec: 0.169725  v_Recall: 0.911258  v_F1: 0.286153  v_AUC: 0.538762
steps 600    running time 54 seconds

steps 800    base_loss: 0.480887    reg_loss: 0.006526    l2_loss: 0.013011    loss: 0.500424
steps 800    v_Prec: 0.180861  v_Recall: 0.747592  v_F1: 0.291260  v_AUC: 0.561163
steps 800    running time 61 seconds

steps 1000    base_loss: 0.468424    reg_loss: 0.006513    l2_loss: 0.012822    loss: 0.487759
steps 1000    v_Prec: 0.169825  v_Recall: 0.928391  v_F1: 0.287127  v_AUC: 0.563574
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.451605    reg_loss: 0.006476    l2_loss: 0.012650    loss: 0.470732
steps 1200    v_Prec: 0.207278  v_Recall: 0.575636  v_F1: 0.304801  v_AUC: 0.601872
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.446658    reg_loss: 0.006448    l2_loss: 0.012625    loss: 0.465731
steps 1400    v_Prec: 0.297954  v_Recall: 0.425312  v_F1: 0.350420  v_AUC: 0.657519
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.432599    reg_loss: 0.006408    l2_loss: 0.012680    loss: 0.451687
steps 1600    v_Prec: 0.418180  v_Recall: 0.405337  v_F1: 0.411659  v_AUC: 0.709384
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.407624    reg_loss: 0.006338    l2_loss: 0.012837    loss: 0.426800
steps 1800    v_Prec: 0.513891  v_Recall: 0.446866  v_F1: 0.478041  v_AUC: 0.755906
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.378672    reg_loss: 0.006269    l2_loss: 0.013119    loss: 0.398061
steps 2000    v_Prec: 0.578347  v_Recall: 0.488394  v_F1: 0.529578  v_AUC: 0.795772
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.350792    reg_loss: 0.006188    l2_loss: 0.013514    loss: 0.370494
steps 2200    v_Prec: 0.643756  v_Recall: 0.505053  v_F1: 0.566031  v_AUC: 0.821840
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.326328    reg_loss: 0.006115    l2_loss: 0.013904    loss: 0.346347
steps 2400    v_Prec: 0.639026  v_Recall: 0.553055  v_F1: 0.592941  v_AUC: 0.838504
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.318324    reg_loss: 0.006054    l2_loss: 0.014312    loss: 0.338690
steps 2600    v_Prec: 0.626088  v_Recall: 0.601769  v_F1: 0.613688  v_AUC: 0.852260
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.308260    reg_loss: 0.006012    l2_loss: 0.014732    loss: 0.329005
steps 2800    v_Prec: 0.680431  v_Recall: 0.582820  v_F1: 0.627855  v_AUC: 0.860086
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.304931    reg_loss: 0.005976    l2_loss: 0.015170    loss: 0.326077
steps 3000    v_Prec: 0.674661  v_Recall: 0.608558  v_F1: 0.639907  v_AUC: 0.868556
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.293337    reg_loss: 0.005944    l2_loss: 0.015541    loss: 0.314822
steps 3200    v_Prec: 0.716689  v_Recall: 0.598768  v_F1: 0.652443  v_AUC: 0.874230
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.292644    reg_loss: 0.005912    l2_loss: 0.015984    loss: 0.314541
steps 3400    v_Prec: 0.683857  v_Recall: 0.634454  v_F1: 0.658230  v_AUC: 0.879102
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.282258    reg_loss: 0.005886    l2_loss: 0.016475    loss: 0.304618
steps 3600    v_Prec: 0.705583  v_Recall: 0.634612  v_F1: 0.668218  v_AUC: 0.881956
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.285288    reg_loss: 0.005868    l2_loss: 0.016766    loss: 0.307921
steps 3800    v_Prec: 0.748952  v_Recall: 0.620401  v_F1: 0.678642  v_AUC: 0.885776
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.266794    reg_loss: 0.005827    l2_loss: 0.017163    loss: 0.289784
steps 4000    v_Prec: 0.735946  v_Recall: 0.631533  v_F1: 0.679754  v_AUC: 0.888083
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.278995    reg_loss: 0.005822    l2_loss: 0.017566    loss: 0.302384
steps 4200    v_Prec: 0.723965  v_Recall: 0.648745  v_F1: 0.684294  v_AUC: 0.890140
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.267597    reg_loss: 0.005792    l2_loss: 0.017876    loss: 0.291266
steps 4400    v_Prec: 0.723301  v_Recall: 0.661456  v_F1: 0.690998  v_AUC: 0.893819
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.272109    reg_loss: 0.005766    l2_loss: 0.018255    loss: 0.296129
steps 4600    v_Prec: 0.722615  v_Recall: 0.669272  v_F1: 0.694922  v_AUC: 0.894872
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.268148    reg_loss: 0.005751    l2_loss: 0.018611    loss: 0.292511
steps 4800    v_Prec: 0.723682  v_Recall: 0.674088  v_F1: 0.698005  v_AUC: 0.896586
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.269683    reg_loss: 0.005736    l2_loss: 0.019027    loss: 0.294446
steps 5000    v_Prec: 0.727149  v_Recall: 0.675825  v_F1: 0.700548  v_AUC: 0.899542
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.260899    reg_loss: 0.005714    l2_loss: 0.019417    loss: 0.286030
steps 5200    v_Prec: 0.742396  v_Recall: 0.668719  v_F1: 0.703634  v_AUC: 0.901285
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.258953    reg_loss: 0.005697    l2_loss: 0.019664    loss: 0.284314
steps 5400    v_Prec: 0.734308  v_Recall: 0.677957  v_F1: 0.705008  v_AUC: 0.903214
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.177653    reg_loss: 0.005430    l2_loss: 0.020152    loss: 0.203234
steps 5600    v_Prec: 0.740259  v_Recall: 0.673456  v_F1: 0.705279  v_AUC: 0.900065
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.172110    reg_loss: 0.005415    l2_loss: 0.020601    loss: 0.198126
steps 5800    v_Prec: 0.751867  v_Recall: 0.659798  v_F1: 0.702830  v_AUC: 0.895459
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.183185    reg_loss: 0.005427    l2_loss: 0.021304    loss: 0.209916
steps 6000    v_Prec: 0.766555  v_Recall: 0.650718  v_F1: 0.703903  v_AUC: 0.896976
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.181705    reg_loss: 0.005414    l2_loss: 0.021903    loss: 0.209022
steps 6200    v_Prec: 0.757324  v_Recall: 0.661298  v_F1: 0.706061  v_AUC: 0.896246
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.195219    reg_loss: 0.005460    l2_loss: 0.022413    loss: 0.223092
steps 6400    v_Prec: 0.755496  v_Recall: 0.664772  v_F1: 0.707236  v_AUC: 0.897311
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.185310    reg_loss: 0.005411    l2_loss: 0.022891    loss: 0.213612
steps 6600    v_Prec: 0.756713  v_Recall: 0.671877  v_F1: 0.711777  v_AUC: 0.900110
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.181985    reg_loss: 0.005401    l2_loss: 0.023244    loss: 0.210630
steps 6800    v_Prec: 0.770010  v_Recall: 0.660035  v_F1: 0.710794  v_AUC: 0.898646
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.192729    reg_loss: 0.005393    l2_loss: 0.023609    loss: 0.221731
steps 7000    v_Prec: 0.751859  v_Recall: 0.678667  v_F1: 0.713391  v_AUC: 0.901252
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.183918    reg_loss: 0.005392    l2_loss: 0.023842    loss: 0.213152
steps 7200    v_Prec: 0.762359  v_Recall: 0.675746  v_F1: 0.716444  v_AUC: 0.902204
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.179965    reg_loss: 0.005381    l2_loss: 0.024081    loss: 0.209426
steps 7400    v_Prec: 0.759657  v_Recall: 0.684747  v_F1: 0.720259  v_AUC: 0.902623
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.186460    reg_loss: 0.005389    l2_loss: 0.024395    loss: 0.216244
steps 7600    v_Prec: 0.781886  v_Recall: 0.664535  v_F1: 0.718450  v_AUC: 0.902732
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.195263    reg_loss: 0.005371    l2_loss: 0.024633    loss: 0.225267
steps 7800    v_Prec: 0.756493  v_Recall: 0.692168  v_F1: 0.722902  v_AUC: 0.906966
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.183486    reg_loss: 0.005365    l2_loss: 0.024826    loss: 0.213676
steps 8000    v_Prec: 0.758826  v_Recall: 0.694063  v_F1: 0.725001  v_AUC: 0.907395
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.194794    reg_loss: 0.005351    l2_loss: 0.025009    loss: 0.225154
steps 8200    v_Prec: 0.779621  v_Recall: 0.678983  v_F1: 0.725830  v_AUC: 0.909182
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.189061    reg_loss: 0.005343    l2_loss: 0.025160    loss: 0.219564
steps 8400    v_Prec: 0.761999  v_Recall: 0.699432  v_F1: 0.729376  v_AUC: 0.909708
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.190775    reg_loss: 0.005338    l2_loss: 0.025186    loss: 0.221300
steps 8600    v_Prec: 0.771449  v_Recall: 0.692879  v_F1: 0.730056  v_AUC: 0.908948
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.184736    reg_loss: 0.005303    l2_loss: 0.025308    loss: 0.215347
steps 8800    v_Prec: 0.771002  v_Recall: 0.697774  v_F1: 0.732562  v_AUC: 0.912263
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.188891    reg_loss: 0.005309    l2_loss: 0.025375    loss: 0.219575
steps 9000    v_Prec: 0.783555  v_Recall: 0.687668  v_F1: 0.732487  v_AUC: 0.912375
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.198369    reg_loss: 0.005318    l2_loss: 0.025563    loss: 0.229249
steps 9200    v_Prec: 0.756865  v_Recall: 0.713722  v_F1: 0.734661  v_AUC: 0.915797
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.197255    reg_loss: 0.005310    l2_loss: 0.025557    loss: 0.228121
steps 9400    v_Prec: 0.761708  v_Recall: 0.713959  v_F1: 0.737061  v_AUC: 0.916444
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.187237    reg_loss: 0.005286    l2_loss: 0.025569    loss: 0.218092
steps 9600    v_Prec: 0.793786  v_Recall: 0.693826  v_F1: 0.740447  v_AUC: 0.917274
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.185521    reg_loss: 0.005273    l2_loss: 0.025570    loss: 0.216364
steps 9800    v_Prec: 0.772712  v_Recall: 0.711827  v_F1: 0.741021  v_AUC: 0.917835
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.185430    reg_loss: 0.005265    l2_loss: 0.025697    loss: 0.216392
steps 10000    v_Prec: 0.769891  v_Recall: 0.715064  v_F1: 0.741465  v_AUC: 0.919045
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.182540    reg_loss: 0.005259    l2_loss: 0.025625    loss: 0.213423
steps 10200    v_Prec: 0.760304  v_Recall: 0.726749  v_F1: 0.743148  v_AUC: 0.919411
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.184649    reg_loss: 0.005251    l2_loss: 0.025754    loss: 0.215654
steps 10400    v_Prec: 0.786523  v_Recall: 0.707721  v_F1: 0.745044  v_AUC: 0.920102
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.194109    reg_loss: 0.005252    l2_loss: 0.025745    loss: 0.225106
steps 10600    v_Prec: 0.788130  v_Recall: 0.711906  v_F1: 0.748081  v_AUC: 0.920695
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.187843    reg_loss: 0.005229    l2_loss: 0.025859    loss: 0.218931
steps 10800    v_Prec: 0.784304  v_Recall: 0.714827  v_F1: 0.747955  v_AUC: 0.922115
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.081200    reg_loss: 0.004897    l2_loss: 0.025682    loss: 0.111779
steps 11000    v_Prec: 0.789775  v_Recall: 0.707406  v_F1: 0.746325  v_AUC: 0.919559
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.072878    reg_loss: 0.004919    l2_loss: 0.025584    loss: 0.103381
steps 11200    v_Prec: 0.786457  v_Recall: 0.704248  v_F1: 0.743086  v_AUC: 0.916365
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.068197    reg_loss: 0.004915    l2_loss: 0.025543    loss: 0.098655
steps 11400    v_Prec: 0.787198  v_Recall: 0.691300  v_F1: 0.736139  v_AUC: 0.914230
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.074352    reg_loss: 0.004925    l2_loss: 0.025572    loss: 0.104848
steps 11600    v_Prec: 0.778659  v_Recall: 0.697695  v_F1: 0.735957  v_AUC: 0.912017
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.079786    reg_loss: 0.004958    l2_loss: 0.025723    loss: 0.110467
steps 11800    v_Prec: 0.788923  v_Recall: 0.690510  v_F1: 0.736443  v_AUC: 0.910268
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.078041    reg_loss: 0.004946    l2_loss: 0.025774    loss: 0.108761
steps 12000    v_Prec: 0.757274  v_Recall: 0.708906  v_F1: 0.732292  v_AUC: 0.910681
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.084777    reg_loss: 0.004953    l2_loss: 0.025609    loss: 0.115338
steps 12200    v_Prec: 0.767498  v_Recall: 0.704721  v_F1: 0.734771  v_AUC: 0.910849
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.083082    reg_loss: 0.004974    l2_loss: 0.025650    loss: 0.113706
steps 12400    v_Prec: 0.766127  v_Recall: 0.706063  v_F1: 0.734870  v_AUC: 0.910849
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.083110    reg_loss: 0.004975    l2_loss: 0.025773    loss: 0.113858
steps 12600    v_Prec: 0.775701  v_Recall: 0.694616  v_F1: 0.732922  v_AUC: 0.910802
steps 12600    running time 446 seconds

Early stop model F1: 0.748081
testing thre: 0.38664192
testing Prec: 0.58549795933936
testing Recall: 0.7460510328068044
testing F1: 0.6560950589844418
testing AUC: 0.902721489025501
overall running time 449 seconds
(0.7101670795340748, 0.6548724179829891, 0.6813998179427532, 0.902721489025501, 0.6434655)

2019-02-24 16:02:38.354794: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:02:38.619125: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:02:38.620047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:02:38.620082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.100000 seconds
loading data in 31.210000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.764924    reg_loss: 0.006469    l2_loss: 0.013295    loss: 0.784688
steps 200    v_Prec: 0.164385  v_Recall: 0.974539  v_F1: 0.281317  v_AUC: 0.535974
steps 200    running time 41 seconds

steps 400    base_loss: 0.563229    reg_loss: 0.006460    l2_loss: 0.013228    loss: 0.582917
steps 400    v_Prec: 0.164213  v_Recall: 0.986431  v_F1: 0.281555  v_AUC: 0.527050
steps 400    running time 48 seconds

steps 600    base_loss: 0.491655    reg_loss: 0.006453    l2_loss: 0.012977    loss: 0.511084
steps 600    v_Prec: 0.177723  v_Recall: 0.752015  v_F1: 0.287502  v_AUC: 0.560582
steps 600    running time 55 seconds

steps 800    base_loss: 0.476142    reg_loss: 0.006437    l2_loss: 0.012660    loss: 0.495240
steps 800    v_Prec: 0.166697  v_Recall: 0.940777  v_F1: 0.283212  v_AUC: 0.506820
steps 800    running time 62 seconds

steps 1000    base_loss: 0.466311    reg_loss: 0.006434    l2_loss: 0.012389    loss: 0.485135
steps 1000    v_Prec: 0.172723  v_Recall: 0.877165  v_F1: 0.288614  v_AUC: 0.563978
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.441004    reg_loss: 0.006426    l2_loss: 0.012211    loss: 0.459641
steps 1200    v_Prec: 0.252467  v_Recall: 0.485913  v_F1: 0.332287  v_AUC: 0.648643
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.445915    reg_loss: 0.006459    l2_loss: 0.012044    loss: 0.464418
steps 1400    v_Prec: 0.354359  v_Recall: 0.412962  v_F1: 0.381423  v_AUC: 0.689008
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.430123    reg_loss: 0.006471    l2_loss: 0.012003    loss: 0.448597
steps 1600    v_Prec: 0.403997  v_Recall: 0.448559  v_F1: 0.425113  v_AUC: 0.733709
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.405912    reg_loss: 0.006482    l2_loss: 0.012056    loss: 0.424450
steps 1800    v_Prec: 0.423810  v_Recall: 0.514566  v_F1: 0.464799  v_AUC: 0.770863
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.374623    reg_loss: 0.006525    l2_loss: 0.012279    loss: 0.393427
steps 2000    v_Prec: 0.515318  v_Recall: 0.508820  v_F1: 0.512048  v_AUC: 0.801695
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.355513    reg_loss: 0.006586    l2_loss: 0.012625    loss: 0.374724
steps 2200    v_Prec: 0.536191  v_Recall: 0.564051  v_F1: 0.549769  v_AUC: 0.827085
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.342209    reg_loss: 0.006675    l2_loss: 0.012962    loss: 0.361846
steps 2400    v_Prec: 0.560417  v_Recall: 0.575625  v_F1: 0.567919  v_AUC: 0.840957
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.329552    reg_loss: 0.006723    l2_loss: 0.013377    loss: 0.349653
steps 2600    v_Prec: 0.602775  v_Recall: 0.575545  v_F1: 0.588845  v_AUC: 0.851339
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.310264    reg_loss: 0.006759    l2_loss: 0.013761    loss: 0.330785
steps 2800    v_Prec: 0.625106  v_Recall: 0.589832  v_F1: 0.606957  v_AUC: 0.860783
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.306639    reg_loss: 0.006796    l2_loss: 0.014185    loss: 0.327619
steps 3000    v_Prec: 0.638549  v_Recall: 0.595738  v_F1: 0.616401  v_AUC: 0.866398
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.299622    reg_loss: 0.006834    l2_loss: 0.014621    loss: 0.321077
steps 3200    v_Prec: 0.612329  v_Recall: 0.637401  v_F1: 0.624614  v_AUC: 0.871927
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.300001    reg_loss: 0.006853    l2_loss: 0.015057    loss: 0.321911
steps 3400    v_Prec: 0.620172  v_Recall: 0.639476  v_F1: 0.629676  v_AUC: 0.875804
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.294123    reg_loss: 0.006869    l2_loss: 0.015569    loss: 0.316561
steps 3600    v_Prec: 0.630424  v_Recall: 0.637720  v_F1: 0.634052  v_AUC: 0.878252
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.283569    reg_loss: 0.006890    l2_loss: 0.016071    loss: 0.306530
steps 3800    v_Prec: 0.664062  v_Recall: 0.617208  v_F1: 0.639778  v_AUC: 0.881154
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.285689    reg_loss: 0.006915    l2_loss: 0.016610    loss: 0.309215
steps 4000    v_Prec: 0.652092  v_Recall: 0.639237  v_F1: 0.645601  v_AUC: 0.884718
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.290159    reg_loss: 0.006928    l2_loss: 0.017122    loss: 0.314208
steps 4200    v_Prec: 0.661466  v_Recall: 0.642988  v_F1: 0.652096  v_AUC: 0.886764
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.284578    reg_loss: 0.006933    l2_loss: 0.017706    loss: 0.309217
steps 4400    v_Prec: 0.668577  v_Recall: 0.633091  v_F1: 0.650351  v_AUC: 0.887170
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.279612    reg_loss: 0.006950    l2_loss: 0.018188    loss: 0.304750
steps 4600    v_Prec: 0.683665  v_Recall: 0.625988  v_F1: 0.653556  v_AUC: 0.889615
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.273563    reg_loss: 0.006944    l2_loss: 0.018892    loss: 0.299400
steps 4800    v_Prec: 0.694779  v_Recall: 0.629899  v_F1: 0.660750  v_AUC: 0.892916
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.268881    reg_loss: 0.006953    l2_loss: 0.019520    loss: 0.295354
steps 5000    v_Prec: 0.689550  v_Recall: 0.629340  v_F1: 0.658070  v_AUC: 0.894168
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.278332    reg_loss: 0.006975    l2_loss: 0.020207    loss: 0.305515
steps 5200    v_Prec: 0.707511  v_Recall: 0.623992  v_F1: 0.663132  v_AUC: 0.896931
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.265407    reg_loss: 0.006993    l2_loss: 0.020906    loss: 0.293306
steps 5400    v_Prec: 0.660613  v_Recall: 0.659031  v_F1: 0.659821  v_AUC: 0.895415
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.173289    reg_loss: 0.007165    l2_loss: 0.021771    loss: 0.202225
steps 5600    v_Prec: 0.682739  v_Recall: 0.635166  v_F1: 0.658094  v_AUC: 0.894173
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.194053    reg_loss: 0.007155    l2_loss: 0.022600    loss: 0.223807
steps 5800    v_Prec: 0.676344  v_Recall: 0.641472  v_F1: 0.658447  v_AUC: 0.892446
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.184078    reg_loss: 0.007160    l2_loss: 0.023293    loss: 0.214531
steps 6000    v_Prec: 0.676699  v_Recall: 0.638838  v_F1: 0.657224  v_AUC: 0.891198
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.179513    reg_loss: 0.007141    l2_loss: 0.023968    loss: 0.210622
steps 6200    v_Prec: 0.653920  v_Recall: 0.656477  v_F1: 0.655196  v_AUC: 0.890837
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.196161    reg_loss: 0.007178    l2_loss: 0.024524    loss: 0.227863
steps 6400    v_Prec: 0.678203  v_Recall: 0.639716  v_F1: 0.658397  v_AUC: 0.890588
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.192856    reg_loss: 0.007159    l2_loss: 0.025066    loss: 0.225080
steps 6600    v_Prec: 0.665743  v_Recall: 0.651768  v_F1: 0.658681  v_AUC: 0.891938
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.191361    reg_loss: 0.007179    l2_loss: 0.025466    loss: 0.224006
steps 6800    v_Prec: 0.678065  v_Recall: 0.648895  v_F1: 0.663159  v_AUC: 0.893597
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.198790    reg_loss: 0.007174    l2_loss: 0.025889    loss: 0.231854
steps 7000    v_Prec: 0.686376  v_Recall: 0.648575  v_F1: 0.666940  v_AUC: 0.895490
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.179267    reg_loss: 0.007171    l2_loss: 0.026421    loss: 0.212859
steps 7200    v_Prec: 0.696238  v_Recall: 0.647059  v_F1: 0.670748  v_AUC: 0.895314
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.190449    reg_loss: 0.007182    l2_loss: 0.026727    loss: 0.224358
steps 7400    v_Prec: 0.688415  v_Recall: 0.656876  v_F1: 0.672276  v_AUC: 0.896073
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.203538    reg_loss: 0.007180    l2_loss: 0.027151    loss: 0.237869
steps 7600    v_Prec: 0.707176  v_Recall: 0.641871  v_F1: 0.672943  v_AUC: 0.897367
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.191981    reg_loss: 0.007180    l2_loss: 0.027475    loss: 0.226636
steps 7800    v_Prec: 0.698296  v_Recall: 0.657275  v_F1: 0.677165  v_AUC: 0.899999
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.176780    reg_loss: 0.007197    l2_loss: 0.027817    loss: 0.211794
steps 8000    v_Prec: 0.692295  v_Recall: 0.660468  v_F1: 0.676007  v_AUC: 0.898598
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.195640    reg_loss: 0.007186    l2_loss: 0.028247    loss: 0.231074
steps 8200    v_Prec: 0.673389  v_Recall: 0.684891  v_F1: 0.679091  v_AUC: 0.901906
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.198746    reg_loss: 0.007223    l2_loss: 0.028432    loss: 0.234402
steps 8400    v_Prec: 0.703782  v_Recall: 0.660867  v_F1: 0.681650  v_AUC: 0.903463
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.194021    reg_loss: 0.007184    l2_loss: 0.028654    loss: 0.229859
steps 8600    v_Prec: 0.701855  v_Recall: 0.673398  v_F1: 0.687332  v_AUC: 0.904963
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.188248    reg_loss: 0.007164    l2_loss: 0.028844    loss: 0.224256
steps 8800    v_Prec: 0.704330  v_Recall: 0.675154  v_F1: 0.689433  v_AUC: 0.906369
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.196861    reg_loss: 0.007195    l2_loss: 0.029168    loss: 0.233223
steps 9000    v_Prec: 0.715039  v_Recall: 0.671323  v_F1: 0.692491  v_AUC: 0.908407
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.193312    reg_loss: 0.007216    l2_loss: 0.029384    loss: 0.229911
steps 9200    v_Prec: 0.711260  v_Recall: 0.678107  v_F1: 0.694288  v_AUC: 0.908434
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.183539    reg_loss: 0.007196    l2_loss: 0.029682    loss: 0.220417
steps 9400    v_Prec: 0.732911  v_Recall: 0.664059  v_F1: 0.696788  v_AUC: 0.910095
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.187570    reg_loss: 0.007194    l2_loss: 0.029943    loss: 0.224707
steps 9600    v_Prec: 0.739400  v_Recall: 0.665336  v_F1: 0.700416  v_AUC: 0.911163
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.183383    reg_loss: 0.007178    l2_loss: 0.030145    loss: 0.220706
steps 9800    v_Prec: 0.738468  v_Recall: 0.669567  v_F1: 0.702332  v_AUC: 0.912718
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.190990    reg_loss: 0.007175    l2_loss: 0.030294    loss: 0.228459
steps 10000    v_Prec: 0.731165  v_Recall: 0.687046  v_F1: 0.708419  v_AUC: 0.915012
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.185859    reg_loss: 0.007211    l2_loss: 0.030486    loss: 0.223556
steps 10200    v_Prec: 0.755694  v_Recall: 0.667332  v_F1: 0.708770  v_AUC: 0.916087
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.196605    reg_loss: 0.007193    l2_loss: 0.030566    loss: 0.234363
steps 10400    v_Prec: 0.772023  v_Recall: 0.660308  v_F1: 0.711809  v_AUC: 0.917785
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.196834    reg_loss: 0.007196    l2_loss: 0.030817    loss: 0.234847
steps 10600    v_Prec: 0.749978  v_Recall: 0.687844  v_F1: 0.717569  v_AUC: 0.919323
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.179729    reg_loss: 0.007224    l2_loss: 0.030964    loss: 0.217918
steps 10800    v_Prec: 0.747672  v_Recall: 0.679224  v_F1: 0.711806  v_AUC: 0.918022
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.085199    reg_loss: 0.007331    l2_loss: 0.031086    loss: 0.123616
steps 11000    v_Prec: 0.730837  v_Recall: 0.666613  v_F1: 0.697249  v_AUC: 0.909717
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.077626    reg_loss: 0.007339    l2_loss: 0.031344    loss: 0.116309
steps 11200    v_Prec: 0.724141  v_Recall: 0.662703  v_F1: 0.692061  v_AUC: 0.906742
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.077654    reg_loss: 0.007322    l2_loss: 0.031392    loss: 0.116368
steps 11400    v_Prec: 0.719362  v_Recall: 0.659191  v_F1: 0.687963  v_AUC: 0.904700
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.079951    reg_loss: 0.007327    l2_loss: 0.031521    loss: 0.118799
steps 11600    v_Prec: 0.717579  v_Recall: 0.655838  v_F1: 0.685321  v_AUC: 0.903090
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.085087    reg_loss: 0.007295    l2_loss: 0.031550    loss: 0.123933
steps 11800    v_Prec: 0.691140  v_Recall: 0.664937  v_F1: 0.677785  v_AUC: 0.899445
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.075683    reg_loss: 0.007286    l2_loss: 0.031696    loss: 0.114665
steps 12000    v_Prec: 0.717062  v_Recall: 0.638998  v_F1: 0.675783  v_AUC: 0.898733
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.086668    reg_loss: 0.007307    l2_loss: 0.031685    loss: 0.125659
steps 12200    v_Prec: 0.682572  v_Recall: 0.666773  v_F1: 0.674580  v_AUC: 0.898154
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.086110    reg_loss: 0.007295    l2_loss: 0.031778    loss: 0.125183
steps 12400    v_Prec: 0.670920  v_Recall: 0.671402  v_F1: 0.671161  v_AUC: 0.895103
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.089499    reg_loss: 0.007310    l2_loss: 0.031923    loss: 0.128733
steps 12600    v_Prec: 0.701427  v_Recall: 0.647458  v_F1: 0.673363  v_AUC: 0.895924
steps 12600    running time 445 seconds

Early stop model F1: 0.717569
testing thre: 0.35060573
testing Prec: 0.5297142462727775
testing Recall: 0.7460024301336573
testing F1: 0.6195233194082864
testing AUC: 0.8986460221327093
overall running time 448 seconds
(0.7054505005561735, 0.6164763061968408, 0.6579691350019453, 0.8986460221327093, 0.6643807)

2019-02-24 16:07:27.397619: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:07:28.615390: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:07:28.617080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:07:28.617116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.250000 seconds
loading data in 31.430000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.510782    reg_loss: 0.006478    l2_loss: 0.013317    loss: 0.530577
steps 200    v_Prec: 0.163689  v_Recall: 0.964849  v_F1: 0.279894  v_AUC: 0.538410
steps 200    running time 41 seconds

steps 400    base_loss: 0.492184    reg_loss: 0.006465    l2_loss: 0.013275    loss: 0.511924
steps 400    v_Prec: 0.166977  v_Recall: 0.895431  v_F1: 0.281466  v_AUC: 0.552031
steps 400    running time 48 seconds

steps 600    base_loss: 0.473607    reg_loss: 0.006440    l2_loss: 0.013152    loss: 0.493199
steps 600    v_Prec: 0.169634  v_Recall: 0.886744  v_F1: 0.284788  v_AUC: 0.551441
steps 600    running time 55 seconds

steps 800    base_loss: 0.459147    reg_loss: 0.006429    l2_loss: 0.013090    loss: 0.478666
steps 800    v_Prec: 0.192543  v_Recall: 0.666264  v_F1: 0.298750  v_AUC: 0.593532
steps 800    running time 62 seconds

steps 1000    base_loss: 0.453113    reg_loss: 0.006413    l2_loss: 0.013070    loss: 0.472596
steps 1000    v_Prec: 0.246205  v_Recall: 0.528394  v_F1: 0.335899  v_AUC: 0.650691
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.429779    reg_loss: 0.006345    l2_loss: 0.013024    loss: 0.449148
steps 1200    v_Prec: 0.375572  v_Recall: 0.429376  v_F1: 0.400676  v_AUC: 0.706994
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.411546    reg_loss: 0.006294    l2_loss: 0.013082    loss: 0.430922
steps 1400    v_Prec: 0.502599  v_Recall: 0.451174  v_F1: 0.475500  v_AUC: 0.760953
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.380702    reg_loss: 0.006224    l2_loss: 0.013268    loss: 0.400194
steps 1600    v_Prec: 0.577709  v_Recall: 0.481982  v_F1: 0.525522  v_AUC: 0.797128
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.356565    reg_loss: 0.006165    l2_loss: 0.013471    loss: 0.376201
steps 1800    v_Prec: 0.601983  v_Recall: 0.527510  v_F1: 0.562291  v_AUC: 0.820672
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.340622    reg_loss: 0.006116    l2_loss: 0.013745    loss: 0.360482
steps 2000    v_Prec: 0.633869  v_Recall: 0.561213  v_F1: 0.595333  v_AUC: 0.842972
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.320751    reg_loss: 0.006072    l2_loss: 0.013991    loss: 0.340814
steps 2200    v_Prec: 0.684221  v_Recall: 0.568533  v_F1: 0.621035  v_AUC: 0.855792
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.312282    reg_loss: 0.006043    l2_loss: 0.014252    loss: 0.332577
steps 2400    v_Prec: 0.714041  v_Recall: 0.570624  v_F1: 0.634327  v_AUC: 0.864945
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.301621    reg_loss: 0.006002    l2_loss: 0.014516    loss: 0.322138
steps 2600    v_Prec: 0.721736  v_Recall: 0.583333  v_F1: 0.645196  v_AUC: 0.869291
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.297432    reg_loss: 0.005963    l2_loss: 0.014772    loss: 0.318167
steps 2800    v_Prec: 0.738076  v_Recall: 0.587516  v_F1: 0.654246  v_AUC: 0.875271
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.297019    reg_loss: 0.005950    l2_loss: 0.014961    loss: 0.317929
steps 3000    v_Prec: 0.726813  v_Recall: 0.613337  v_F1: 0.665271  v_AUC: 0.879707
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.283465    reg_loss: 0.005909    l2_loss: 0.015257    loss: 0.304631
steps 3200    v_Prec: 0.738088  v_Recall: 0.621782  v_F1: 0.674962  v_AUC: 0.884049
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.287142    reg_loss: 0.005902    l2_loss: 0.015484    loss: 0.308529
steps 3400    v_Prec: 0.716805  v_Recall: 0.647442  v_F1: 0.680360  v_AUC: 0.887166
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.281169    reg_loss: 0.005890    l2_loss: 0.015729    loss: 0.302788
steps 3600    v_Prec: 0.717855  v_Recall: 0.649373  v_F1: 0.681899  v_AUC: 0.889481
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.272143    reg_loss: 0.005868    l2_loss: 0.016000    loss: 0.294012
steps 3800    v_Prec: 0.718573  v_Recall: 0.654762  v_F1: 0.685185  v_AUC: 0.891928
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.263968    reg_loss: 0.005851    l2_loss: 0.016228    loss: 0.286047
steps 4000    v_Prec: 0.756210  v_Recall: 0.634250  v_F1: 0.689881  v_AUC: 0.894079
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.272775    reg_loss: 0.005838    l2_loss: 0.016550    loss: 0.295164
steps 4200    v_Prec: 0.740980  v_Recall: 0.654199  v_F1: 0.694891  v_AUC: 0.896833
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.258997    reg_loss: 0.005817    l2_loss: 0.016733    loss: 0.281548
steps 4400    v_Prec: 0.756009  v_Recall: 0.652751  v_F1: 0.700596  v_AUC: 0.899152
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.257120    reg_loss: 0.005803    l2_loss: 0.017148    loss: 0.280071
steps 4600    v_Prec: 0.743364  v_Recall: 0.664495  v_F1: 0.701720  v_AUC: 0.900839
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.267889    reg_loss: 0.005799    l2_loss: 0.017460    loss: 0.291148
steps 4800    v_Prec: 0.751942  v_Recall: 0.662001  v_F1: 0.704111  v_AUC: 0.903336
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.262322    reg_loss: 0.005779    l2_loss: 0.017753    loss: 0.285854
steps 5000    v_Prec: 0.743992  v_Recall: 0.667391  v_F1: 0.703613  v_AUC: 0.904055
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.259597    reg_loss: 0.005750    l2_loss: 0.018098    loss: 0.283445
steps 5200    v_Prec: 0.746826  v_Recall: 0.671976  v_F1: 0.707427  v_AUC: 0.906351
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.254860    reg_loss: 0.005706    l2_loss: 0.018455    loss: 0.279022
steps 5400    v_Prec: 0.753067  v_Recall: 0.661599  v_F1: 0.704376  v_AUC: 0.907802
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.159238    reg_loss: 0.005423    l2_loss: 0.018954    loss: 0.183616
steps 5600    v_Prec: 0.760853  v_Recall: 0.656934  v_F1: 0.705085  v_AUC: 0.903261
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.178563    reg_loss: 0.005447    l2_loss: 0.019717    loss: 0.203728
steps 5800    v_Prec: 0.751290  v_Recall: 0.667712  v_F1: 0.707040  v_AUC: 0.901541
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.179009    reg_loss: 0.005472    l2_loss: 0.020444    loss: 0.204924
steps 6000    v_Prec: 0.755113  v_Recall: 0.662243  v_F1: 0.705635  v_AUC: 0.898895
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.184714    reg_loss: 0.005447    l2_loss: 0.021054    loss: 0.211215
steps 6200    v_Prec: 0.773736  v_Recall: 0.658784  v_F1: 0.711648  v_AUC: 0.901059
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.175288    reg_loss: 0.005403    l2_loss: 0.021526    loss: 0.202217
steps 6400    v_Prec: 0.769890  v_Recall: 0.664736  v_F1: 0.713459  v_AUC: 0.901584
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.185014    reg_loss: 0.005397    l2_loss: 0.022038    loss: 0.212449
steps 6600    v_Prec: 0.764064  v_Recall: 0.664254  v_F1: 0.710671  v_AUC: 0.902811
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.174055    reg_loss: 0.005406    l2_loss: 0.022303    loss: 0.201764
steps 6800    v_Prec: 0.766943  v_Recall: 0.669965  v_F1: 0.715181  v_AUC: 0.903304
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.185844    reg_loss: 0.005410    l2_loss: 0.022756    loss: 0.214010
steps 7000    v_Prec: 0.778238  v_Recall: 0.665621  v_F1: 0.717537  v_AUC: 0.904732
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.189050    reg_loss: 0.005383    l2_loss: 0.023067    loss: 0.217500
steps 7200    v_Prec: 0.764032  v_Recall: 0.675595  v_F1: 0.717097  v_AUC: 0.904455
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.168585    reg_loss: 0.005333    l2_loss: 0.023323    loss: 0.197241
steps 7400    v_Prec: 0.784319  v_Recall: 0.662243  v_F1: 0.718130  v_AUC: 0.905909
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.184255    reg_loss: 0.005372    l2_loss: 0.023680    loss: 0.213307
steps 7600    v_Prec: 0.758728  v_Recall: 0.685248  v_F1: 0.720118  v_AUC: 0.908383
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.191216    reg_loss: 0.005362    l2_loss: 0.023877    loss: 0.220455
steps 7800    v_Prec: 0.761692  v_Recall: 0.685167  v_F1: 0.721406  v_AUC: 0.909073
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.178116    reg_loss: 0.005324    l2_loss: 0.024066    loss: 0.207506
steps 8000    v_Prec: 0.778355  v_Recall: 0.674550  v_F1: 0.722744  v_AUC: 0.908961
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.192682    reg_loss: 0.005361    l2_loss: 0.024218    loss: 0.222261
steps 8200    v_Prec: 0.774294  v_Recall: 0.681306  v_F1: 0.724830  v_AUC: 0.910210
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.188971    reg_loss: 0.005352    l2_loss: 0.024399    loss: 0.218722
steps 8400    v_Prec: 0.760577  v_Recall: 0.699887  v_F1: 0.728971  v_AUC: 0.913596
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.182256    reg_loss: 0.005305    l2_loss: 0.024515    loss: 0.212076
steps 8600    v_Prec: 0.779001  v_Recall: 0.682754  v_F1: 0.727709  v_AUC: 0.909879
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.184994    reg_loss: 0.005330    l2_loss: 0.024710    loss: 0.215035
steps 8800    v_Prec: 0.774378  v_Recall: 0.696268  v_F1: 0.733249  v_AUC: 0.913071
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.187394    reg_loss: 0.005304    l2_loss: 0.024789    loss: 0.217488
steps 9000    v_Prec: 0.772864  v_Recall: 0.701496  v_F1: 0.735453  v_AUC: 0.916075
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.180466    reg_loss: 0.005298    l2_loss: 0.024868    loss: 0.210631
steps 9200    v_Prec: 0.777888  v_Recall: 0.691602  v_F1: 0.732212  v_AUC: 0.914655
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.189404    reg_loss: 0.005304    l2_loss: 0.024951    loss: 0.219659
steps 9400    v_Prec: 0.770114  v_Recall: 0.701416  v_F1: 0.734161  v_AUC: 0.916378
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.186653    reg_loss: 0.005319    l2_loss: 0.025099    loss: 0.217071
steps 9600    v_Prec: 0.780409  v_Recall: 0.697233  v_F1: 0.736480  v_AUC: 0.916035
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.187517    reg_loss: 0.005292    l2_loss: 0.025201    loss: 0.218010
steps 9800    v_Prec: 0.794485  v_Recall: 0.695302  v_F1: 0.741592  v_AUC: 0.919326
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.182132    reg_loss: 0.005286    l2_loss: 0.025250    loss: 0.212669
steps 10000    v_Prec: 0.774845  v_Recall: 0.713079  v_F1: 0.742680  v_AUC: 0.920575
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.178951    reg_loss: 0.005257    l2_loss: 0.025221    loss: 0.209429
steps 10200    v_Prec: 0.808391  v_Recall: 0.683478  v_F1: 0.740705  v_AUC: 0.919516
steps 10200    running time 372 seconds

steps 10400    base_loss: 0.189543    reg_loss: 0.005278    l2_loss: 0.025188    loss: 0.220009
steps 10400    v_Prec: 0.778647  v_Recall: 0.712194  v_F1: 0.743940  v_AUC: 0.919413
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.184369    reg_loss: 0.005273    l2_loss: 0.025238    loss: 0.214879
steps 10600    v_Prec: 0.779035  v_Recall: 0.714366  v_F1: 0.745300  v_AUC: 0.920971
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.181401    reg_loss: 0.005252    l2_loss: 0.025300    loss: 0.211954
steps 10800    v_Prec: 0.775453  v_Recall: 0.715573  v_F1: 0.744311  v_AUC: 0.921449
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.075951    reg_loss: 0.004909    l2_loss: 0.025230    loss: 0.106090
steps 11000    v_Prec: 0.779060  v_Recall: 0.711631  v_F1: 0.743820  v_AUC: 0.919519
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.067102    reg_loss: 0.004900    l2_loss: 0.025214    loss: 0.097216
steps 11200    v_Prec: 0.795997  v_Recall: 0.694257  v_F1: 0.741654  v_AUC: 0.917206
steps 11200    running time 404 seconds

steps 11400    base_loss: 0.073372    reg_loss: 0.004934    l2_loss: 0.025102    loss: 0.103408
steps 11400    v_Prec: 0.800318  v_Recall: 0.689270  v_F1: 0.740654  v_AUC: 0.913540
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.076188    reg_loss: 0.004951    l2_loss: 0.025360    loss: 0.106498
steps 11600    v_Prec: 0.809447  v_Recall: 0.682352  v_F1: 0.740485  v_AUC: 0.912889
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.074845    reg_loss: 0.004947    l2_loss: 0.025208    loss: 0.105000
steps 11800    v_Prec: 0.801496  v_Recall: 0.681065  v_F1: 0.736389  v_AUC: 0.913601
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.074091    reg_loss: 0.004963    l2_loss: 0.025364    loss: 0.104418
steps 12000    v_Prec: 0.787604  v_Recall: 0.692005  v_F1: 0.736716  v_AUC: 0.910545
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.073303    reg_loss: 0.004970    l2_loss: 0.025280    loss: 0.103553
steps 12200    v_Prec: 0.773097  v_Recall: 0.704070  v_F1: 0.736971  v_AUC: 0.914467
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.076585    reg_loss: 0.004969    l2_loss: 0.025381    loss: 0.106936
steps 12400    v_Prec: 0.794819  v_Recall: 0.688626  v_F1: 0.737922  v_AUC: 0.912874
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.079145    reg_loss: 0.004960    l2_loss: 0.025238    loss: 0.109344
steps 12600    v_Prec: 0.785623  v_Recall: 0.689189  v_F1: 0.734253  v_AUC: 0.912455
steps 12600    running time 447 seconds

Early stop model F1: 0.745300
testing thre: 0.34590468
testing Prec: 0.5873689847754571
testing Recall: 0.7462940461725395
testing F1: 0.6573624162510434
testing AUC: 0.9011737244041157
overall running time 450 seconds
(0.7022331238182841, 0.6678979343863912, 0.6846353128736549, 0.9011737244041157, 0.5875944)

2019-02-24 16:12:18.889607: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:12:20.071516: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:12:20.135484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:12:20.135578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.530000 seconds
loading data in 31.700000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.086318    reg_loss: 0.006496    l2_loss: 0.013366    loss: 1.106180
steps 200    v_Prec: 0.164279  v_Recall: 1.000000  v_F1: 0.282198  v_AUC: 0.477877
steps 200    running time 41 seconds

steps 400    base_loss: 0.713318    reg_loss: 0.006553    l2_loss: 0.013349    loss: 0.733220
steps 400    v_Prec: 0.164279  v_Recall: 1.000000  v_F1: 0.282198  v_AUC: 0.500201
steps 400    running time 48 seconds

steps 600    base_loss: 0.516132    reg_loss: 0.006571    l2_loss: 0.013354    loss: 0.536057
steps 600    v_Prec: 0.165344  v_Recall: 0.981652  v_F1: 0.283019  v_AUC: 0.540296
steps 600    running time 55 seconds

steps 800    base_loss: 0.504973    reg_loss: 0.006595    l2_loss: 0.013256    loss: 0.524824
steps 800    v_Prec: 0.197286  v_Recall: 0.567037  v_F1: 0.292726  v_AUC: 0.582504
steps 800    running time 61 seconds

steps 1000    base_loss: 0.471666    reg_loss: 0.006592    l2_loss: 0.013119    loss: 0.491377
steps 1000    v_Prec: 0.235628  v_Recall: 0.461954  v_F1: 0.312076  v_AUC: 0.615137
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.446473    reg_loss: 0.006627    l2_loss: 0.013101    loss: 0.466202
steps 1200    v_Prec: 0.325581  v_Recall: 0.421446  v_F1: 0.367362  v_AUC: 0.669533
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.416338    reg_loss: 0.006614    l2_loss: 0.013162    loss: 0.436114
steps 1400    v_Prec: 0.410961  v_Recall: 0.425258  v_F1: 0.417987  v_AUC: 0.714999
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.398386    reg_loss: 0.006637    l2_loss: 0.013283    loss: 0.418306
steps 1600    v_Prec: 0.491938  v_Recall: 0.436219  v_F1: 0.462406  v_AUC: 0.750255
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.380990    reg_loss: 0.006691    l2_loss: 0.013368    loss: 0.401048
steps 1800    v_Prec: 0.559841  v_Recall: 0.457744  v_F1: 0.503671  v_AUC: 0.779829
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.361478    reg_loss: 0.006701    l2_loss: 0.013601    loss: 0.381780
steps 2000    v_Prec: 0.609529  v_Recall: 0.487768  v_F1: 0.541893  v_AUC: 0.806954
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.342628    reg_loss: 0.006725    l2_loss: 0.013866    loss: 0.363219
steps 2200    v_Prec: 0.642622  v_Recall: 0.510882  v_F1: 0.569229  v_AUC: 0.823040
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.327684    reg_loss: 0.006728    l2_loss: 0.014155    loss: 0.348568
steps 2400    v_Prec: 0.678258  v_Recall: 0.522081  v_F1: 0.590009  v_AUC: 0.835353
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.317776    reg_loss: 0.006742    l2_loss: 0.014349    loss: 0.338867
steps 2600    v_Prec: 0.686095  v_Recall: 0.540429  v_F1: 0.604612  v_AUC: 0.847309
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.309805    reg_loss: 0.006768    l2_loss: 0.014682    loss: 0.331255
steps 2800    v_Prec: 0.672335  v_Recall: 0.571565  v_F1: 0.617868  v_AUC: 0.853708
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.298483    reg_loss: 0.006776    l2_loss: 0.014953    loss: 0.320212
steps 3000    v_Prec: 0.701141  v_Recall: 0.576172  v_F1: 0.632543  v_AUC: 0.857663
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.301096    reg_loss: 0.006781    l2_loss: 0.015289    loss: 0.323166
steps 3200    v_Prec: 0.726725  v_Recall: 0.584035  v_F1: 0.647613  v_AUC: 0.865142
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.291664    reg_loss: 0.006791    l2_loss: 0.015573    loss: 0.314027
steps 3400    v_Prec: 0.723278  v_Recall: 0.601430  v_F1: 0.656750  v_AUC: 0.869044
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.286641    reg_loss: 0.006794    l2_loss: 0.015901    loss: 0.309336
steps 3600    v_Prec: 0.758463  v_Recall: 0.592613  v_F1: 0.665359  v_AUC: 0.874245
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.277452    reg_loss: 0.006801    l2_loss: 0.016246    loss: 0.300499
steps 3800    v_Prec: 0.748677  v_Recall: 0.606672  v_F1: 0.670235  v_AUC: 0.876868
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.284151    reg_loss: 0.006793    l2_loss: 0.016491    loss: 0.307435
steps 4000    v_Prec: 0.728464  v_Recall: 0.631374  v_F1: 0.676453  v_AUC: 0.881026
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.272985    reg_loss: 0.006791    l2_loss: 0.016849    loss: 0.296626
steps 4200    v_Prec: 0.734651  v_Recall: 0.632010  v_F1: 0.679476  v_AUC: 0.882999
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.262779    reg_loss: 0.006804    l2_loss: 0.017244    loss: 0.286827
steps 4400    v_Prec: 0.763998  v_Recall: 0.619936  v_F1: 0.684469  v_AUC: 0.885084
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.267979    reg_loss: 0.006807    l2_loss: 0.017686    loss: 0.292472
steps 4600    v_Prec: 0.762609  v_Recall: 0.626926  v_F1: 0.688143  v_AUC: 0.886195
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.262947    reg_loss: 0.006815    l2_loss: 0.018070    loss: 0.287831
steps 4800    v_Prec: 0.773007  v_Recall: 0.627800  v_F1: 0.692877  v_AUC: 0.888178
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.260578    reg_loss: 0.006794    l2_loss: 0.018522    loss: 0.285895
steps 5000    v_Prec: 0.749795  v_Recall: 0.653376  v_F1: 0.698273  v_AUC: 0.889203
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.264897    reg_loss: 0.006802    l2_loss: 0.018963    loss: 0.290663
steps 5200    v_Prec: 0.782943  v_Recall: 0.630024  v_F1: 0.698209  v_AUC: 0.890384
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.249245    reg_loss: 0.006765    l2_loss: 0.019447    loss: 0.275457
steps 5400    v_Prec: 0.762900  v_Recall: 0.655282  v_F1: 0.705008  v_AUC: 0.893767
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.160159    reg_loss: 0.006520    l2_loss: 0.019749    loss: 0.186428
steps 5600    v_Prec: 0.772849  v_Recall: 0.639396  v_F1: 0.699817  v_AUC: 0.890866
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.151257    reg_loss: 0.006499    l2_loss: 0.019938    loss: 0.177694
steps 5800    v_Prec: 0.761657  v_Recall: 0.651311  v_F1: 0.702175  v_AUC: 0.889359
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.159003    reg_loss: 0.006490    l2_loss: 0.020375    loss: 0.185868
steps 6000    v_Prec: 0.797370  v_Recall: 0.621366  v_F1: 0.698451  v_AUC: 0.887819
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.169522    reg_loss: 0.006516    l2_loss: 0.020699    loss: 0.196737
steps 6200    v_Prec: 0.759786  v_Recall: 0.644400  v_F1: 0.697353  v_AUC: 0.887536
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.163081    reg_loss: 0.006494    l2_loss: 0.020993    loss: 0.190569
steps 6400    v_Prec: 0.774103  v_Recall: 0.637728  v_F1: 0.699329  v_AUC: 0.888064
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.172566    reg_loss: 0.006526    l2_loss: 0.021267    loss: 0.200359
steps 6600    v_Prec: 0.770662  v_Recall: 0.641382  v_F1: 0.700104  v_AUC: 0.889658
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.171913    reg_loss: 0.006539    l2_loss: 0.021576    loss: 0.200028
steps 6800    v_Prec: 0.784266  v_Recall: 0.638999  v_F1: 0.704219  v_AUC: 0.890977
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.161846    reg_loss: 0.006481    l2_loss: 0.021713    loss: 0.190040
steps 7000    v_Prec: 0.778382  v_Recall: 0.648054  v_F1: 0.707264  v_AUC: 0.892333
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.169235    reg_loss: 0.006516    l2_loss: 0.021882    loss: 0.197633
steps 7200    v_Prec: 0.784531  v_Recall: 0.646942  v_F1: 0.709124  v_AUC: 0.891795
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.171928    reg_loss: 0.006529    l2_loss: 0.021955    loss: 0.200412
steps 7400    v_Prec: 0.766159  v_Recall: 0.662828  v_F1: 0.710757  v_AUC: 0.894573
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.169457    reg_loss: 0.006518    l2_loss: 0.022140    loss: 0.198115
steps 7600    v_Prec: 0.771012  v_Recall: 0.663781  v_F1: 0.713389  v_AUC: 0.895856
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.173957    reg_loss: 0.006534    l2_loss: 0.022150    loss: 0.202641
steps 7800    v_Prec: 0.776016  v_Recall: 0.664575  v_F1: 0.715985  v_AUC: 0.897703
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.172209    reg_loss: 0.006533    l2_loss: 0.022321    loss: 0.201062
steps 8000    v_Prec: 0.783227  v_Recall: 0.660921  v_F1: 0.716895  v_AUC: 0.898408
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.174981    reg_loss: 0.006553    l2_loss: 0.022483    loss: 0.204017
steps 8200    v_Prec: 0.776445  v_Recall: 0.668149  v_F1: 0.718238  v_AUC: 0.899665
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.166029    reg_loss: 0.006546    l2_loss: 0.022537    loss: 0.195113
steps 8400    v_Prec: 0.801646  v_Recall: 0.657427  v_F1: 0.722409  v_AUC: 0.898264
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.176186    reg_loss: 0.006551    l2_loss: 0.022616    loss: 0.205353
steps 8600    v_Prec: 0.809225  v_Recall: 0.654964  v_F1: 0.723968  v_AUC: 0.900748
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.172935    reg_loss: 0.006542    l2_loss: 0.022521    loss: 0.201998
steps 8800    v_Prec: 0.795429  v_Recall: 0.663384  v_F1: 0.723430  v_AUC: 0.902855
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.167855    reg_loss: 0.006540    l2_loss: 0.022666    loss: 0.197061
steps 9000    v_Prec: 0.779868  v_Recall: 0.678157  v_F1: 0.725465  v_AUC: 0.902969
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.164946    reg_loss: 0.006578    l2_loss: 0.022737    loss: 0.194261
steps 9200    v_Prec: 0.816191  v_Recall: 0.654249  v_F1: 0.726303  v_AUC: 0.904520
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.170952    reg_loss: 0.006565    l2_loss: 0.022837    loss: 0.200354
steps 9400    v_Prec: 0.801429  v_Recall: 0.668070  v_F1: 0.728698  v_AUC: 0.904988
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.173893    reg_loss: 0.006596    l2_loss: 0.022809    loss: 0.203299
steps 9600    v_Prec: 0.791963  v_Recall: 0.680937  v_F1: 0.732266  v_AUC: 0.905712
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.180624    reg_loss: 0.006600    l2_loss: 0.022882    loss: 0.210106
steps 9800    v_Prec: 0.806421  v_Recall: 0.680302  v_F1: 0.738012  v_AUC: 0.908047
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.167203    reg_loss: 0.006557    l2_loss: 0.022979    loss: 0.196739
steps 10000    v_Prec: 0.813289  v_Recall: 0.675695  v_F1: 0.738134  v_AUC: 0.908809
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.171922    reg_loss: 0.006601    l2_loss: 0.023001    loss: 0.201524
steps 10200    v_Prec: 0.814434  v_Recall: 0.679428  v_F1: 0.740831  v_AUC: 0.909505
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.176357    reg_loss: 0.006619    l2_loss: 0.023016    loss: 0.205992
steps 10400    v_Prec: 0.808558  v_Recall: 0.687371  v_F1: 0.743056  v_AUC: 0.911174
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.176653    reg_loss: 0.006603    l2_loss: 0.023020    loss: 0.206276
steps 10600    v_Prec: 0.810235  v_Recall: 0.689118  v_F1: 0.744785  v_AUC: 0.912424
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.167752    reg_loss: 0.006555    l2_loss: 0.023026    loss: 0.197333
steps 10800    v_Prec: 0.816981  v_Recall: 0.687847  v_F1: 0.746874  v_AUC: 0.912792
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.048795    reg_loss: 0.006285    l2_loss: 0.022953    loss: 0.078033
steps 11000    v_Prec: 0.791386  v_Recall: 0.699047  v_F1: 0.742356  v_AUC: 0.909597
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.045249    reg_loss: 0.006256    l2_loss: 0.022360    loss: 0.073865
steps 11200    v_Prec: 0.813190  v_Recall: 0.678713  v_F1: 0.739891  v_AUC: 0.907935
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.045956    reg_loss: 0.006230    l2_loss: 0.021990    loss: 0.074176
steps 11400    v_Prec: 0.799476  v_Recall: 0.678634  v_F1: 0.734115  v_AUC: 0.903903
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.043272    reg_loss: 0.006213    l2_loss: 0.021650    loss: 0.071135
steps 11600    v_Prec: 0.802249  v_Recall: 0.674424  v_F1: 0.732804  v_AUC: 0.902365
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.049025    reg_loss: 0.006216    l2_loss: 0.021305    loss: 0.076545
steps 11800    v_Prec: 0.773444  v_Recall: 0.693090  v_F1: 0.731066  v_AUC: 0.902745
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.044926    reg_loss: 0.006195    l2_loss: 0.021039    loss: 0.072160
steps 12000    v_Prec: 0.802136  v_Recall: 0.668149  v_F1: 0.729038  v_AUC: 0.902423
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.047181    reg_loss: 0.006191    l2_loss: 0.020817    loss: 0.074189
steps 12200    v_Prec: 0.806740  v_Recall: 0.667434  v_F1: 0.730505  v_AUC: 0.902277
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.054400    reg_loss: 0.006177    l2_loss: 0.020614    loss: 0.081191
steps 12400    v_Prec: 0.796001  v_Recall: 0.673471  v_F1: 0.729627  v_AUC: 0.902695
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.050093    reg_loss: 0.006207    l2_loss: 0.020477    loss: 0.076777
steps 12600    v_Prec: 0.801843  v_Recall: 0.670453  v_F1: 0.730285  v_AUC: 0.901542
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.049785    reg_loss: 0.006194    l2_loss: 0.020155    loss: 0.076134
steps 12800    v_Prec: 0.799620  v_Recall: 0.668785  v_F1: 0.728374  v_AUC: 0.901589
steps 12800    running time 451 seconds

Early stop model F1: 0.746874
testing thre: 0.53167075
testing Prec: 0.6549696599087446
testing Recall: 0.6767436208991494
testing F1: 0.6656786346034327
testing AUC: 0.8877208939279143
overall running time 454 seconds
(0.7234292753947811, 0.6278979343863913, 0.6722868368329301, 0.8877208939279143, 0.68462414)

2019-02-24 16:17:14.148290: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:17:15.010927: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:17:15.014898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:17:15.014944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.170000 seconds
loading data in 31.250000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.810185    reg_loss: 0.021617    l2_loss: 0.013335    loss: 0.845137
steps 200    v_Prec: 0.165484  v_Recall: 0.967252  v_F1: 0.282616  v_AUC: 0.529931
steps 200    running time 41 seconds

steps 400    base_loss: 0.584651    reg_loss: 0.021478    l2_loss: 0.013303    loss: 0.619432
steps 400    v_Prec: 0.170741  v_Recall: 0.884429  v_F1: 0.286225  v_AUC: 0.563836
steps 400    running time 48 seconds

steps 600    base_loss: 0.485916    reg_loss: 0.021317    l2_loss: 0.013077    loss: 0.520310
steps 600    v_Prec: 0.197934  v_Recall: 0.650425  v_F1: 0.303507  v_AUC: 0.604008
steps 600    running time 54 seconds

steps 800    base_loss: 0.481733    reg_loss: 0.021254    l2_loss: 0.012914    loss: 0.515901
steps 800    v_Prec: 0.257847  v_Recall: 0.477307  v_F1: 0.334820  v_AUC: 0.647789
steps 800    running time 61 seconds

steps 1000    base_loss: 0.461147    reg_loss: 0.021140    l2_loss: 0.012706    loss: 0.494993
steps 1000    v_Prec: 0.303250  v_Recall: 0.499165  v_F1: 0.377290  v_AUC: 0.690365
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.435068    reg_loss: 0.020887    l2_loss: 0.012700    loss: 0.468655
steps 1200    v_Prec: 0.371819  v_Recall: 0.469200  v_F1: 0.414872  v_AUC: 0.724662
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.408428    reg_loss: 0.020594    l2_loss: 0.012791    loss: 0.441813
steps 1400    v_Prec: 0.471125  v_Recall: 0.479851  v_F1: 0.475448  v_AUC: 0.772048
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.385551    reg_loss: 0.020338    l2_loss: 0.012984    loss: 0.418872
steps 1600    v_Prec: 0.532207  v_Recall: 0.518162  v_F1: 0.525091  v_AUC: 0.803536
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.350982    reg_loss: 0.020066    l2_loss: 0.013247    loss: 0.384294
steps 1800    v_Prec: 0.580575  v_Recall: 0.547810  v_F1: 0.563717  v_AUC: 0.827009
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.327886    reg_loss: 0.019851    l2_loss: 0.013561    loss: 0.361298
steps 2000    v_Prec: 0.617102  v_Recall: 0.558143  v_F1: 0.586144  v_AUC: 0.841556
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.318878    reg_loss: 0.019791    l2_loss: 0.013905    loss: 0.352574
steps 2200    v_Prec: 0.640857  v_Recall: 0.580240  v_F1: 0.609044  v_AUC: 0.853002
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.303175    reg_loss: 0.019597    l2_loss: 0.014230    loss: 0.337002
steps 2400    v_Prec: 0.662264  v_Recall: 0.585883  v_F1: 0.621737  v_AUC: 0.860719
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.300649    reg_loss: 0.019490    l2_loss: 0.014615    loss: 0.334755
steps 2600    v_Prec: 0.672800  v_Recall: 0.604562  v_F1: 0.636858  v_AUC: 0.869453
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.295424    reg_loss: 0.019447    l2_loss: 0.014939    loss: 0.329809
steps 2800    v_Prec: 0.698519  v_Recall: 0.614737  v_F1: 0.653955  v_AUC: 0.874784
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.286842    reg_loss: 0.019328    l2_loss: 0.015334    loss: 0.321504
steps 3000    v_Prec: 0.711388  v_Recall: 0.613226  v_F1: 0.658670  v_AUC: 0.876866
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.281164    reg_loss: 0.019265    l2_loss: 0.015630    loss: 0.316060
steps 3200    v_Prec: 0.747630  v_Recall: 0.601860  v_F1: 0.666872  v_AUC: 0.880231
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.279950    reg_loss: 0.019246    l2_loss: 0.016009    loss: 0.315205
steps 3400    v_Prec: 0.728372  v_Recall: 0.622367  v_F1: 0.671210  v_AUC: 0.883619
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.274873    reg_loss: 0.019183    l2_loss: 0.016346    loss: 0.310402
steps 3600    v_Prec: 0.729142  v_Recall: 0.639774  v_F1: 0.681541  v_AUC: 0.888373
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.267121    reg_loss: 0.019064    l2_loss: 0.016645    loss: 0.302829
steps 3800    v_Prec: 0.746908  v_Recall: 0.638503  v_F1: 0.688464  v_AUC: 0.890491
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.268997    reg_loss: 0.019005    l2_loss: 0.016903    loss: 0.304905
steps 4000    v_Prec: 0.729452  v_Recall: 0.660281  v_F1: 0.693145  v_AUC: 0.894030
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.271981    reg_loss: 0.019012    l2_loss: 0.017205    loss: 0.308198
steps 4200    v_Prec: 0.752087  v_Recall: 0.644543  v_F1: 0.694175  v_AUC: 0.895764
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.260375    reg_loss: 0.018957    l2_loss: 0.017515    loss: 0.296848
steps 4400    v_Prec: 0.737684  v_Recall: 0.652253  v_F1: 0.692343  v_AUC: 0.897592
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.258848    reg_loss: 0.018987    l2_loss: 0.017816    loss: 0.295651
steps 4600    v_Prec: 0.729495  v_Recall: 0.666640  v_F1: 0.696653  v_AUC: 0.900555
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.256185    reg_loss: 0.018931    l2_loss: 0.018133    loss: 0.293250
steps 4800    v_Prec: 0.752983  v_Recall: 0.662189  v_F1: 0.704673  v_AUC: 0.902521
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.264411    reg_loss: 0.018963    l2_loss: 0.018517    loss: 0.301891
steps 5000    v_Prec: 0.760398  v_Recall: 0.655353  v_F1: 0.703979  v_AUC: 0.904304
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.255551    reg_loss: 0.018809    l2_loss: 0.018738    loss: 0.293099
steps 5200    v_Prec: 0.758671  v_Recall: 0.662427  v_F1: 0.707290  v_AUC: 0.906992
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.246322    reg_loss: 0.018744    l2_loss: 0.019205    loss: 0.284271
steps 5400    v_Prec: 0.744429  v_Recall: 0.679755  v_F1: 0.710624  v_AUC: 0.908142
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.168883    reg_loss: 0.017837    l2_loss: 0.019706    loss: 0.206426
steps 5600    v_Prec: 0.773719  v_Recall: 0.656625  v_F1: 0.710379  v_AUC: 0.903467
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.165814    reg_loss: 0.017852    l2_loss: 0.020451    loss: 0.204117
steps 5800    v_Prec: 0.745353  v_Recall: 0.666084  v_F1: 0.703492  v_AUC: 0.898993
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.171125    reg_loss: 0.017747    l2_loss: 0.021159    loss: 0.210032
steps 6000    v_Prec: 0.759602  v_Recall: 0.661792  v_F1: 0.707332  v_AUC: 0.899340
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.166112    reg_loss: 0.017726    l2_loss: 0.021847    loss: 0.205684
steps 6200    v_Prec: 0.753644  v_Recall: 0.669899  v_F1: 0.709308  v_AUC: 0.900119
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.181013    reg_loss: 0.017740    l2_loss: 0.022328    loss: 0.221081
steps 6400    v_Prec: 0.752787  v_Recall: 0.670932  v_F1: 0.709507  v_AUC: 0.900250
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.175146    reg_loss: 0.017616    l2_loss: 0.022806    loss: 0.215568
steps 6600    v_Prec: 0.753343  v_Recall: 0.671727  v_F1: 0.710198  v_AUC: 0.902031
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.174939    reg_loss: 0.017586    l2_loss: 0.023273    loss: 0.215798
steps 6800    v_Prec: 0.763963  v_Recall: 0.668627  v_F1: 0.713123  v_AUC: 0.902233
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.169581    reg_loss: 0.017560    l2_loss: 0.023573    loss: 0.210713
steps 7000    v_Prec: 0.749805  v_Recall: 0.688657  v_F1: 0.717932  v_AUC: 0.906063
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.167331    reg_loss: 0.017369    l2_loss: 0.023883    loss: 0.208583
steps 7200    v_Prec: 0.762293  v_Recall: 0.683888  v_F1: 0.720965  v_AUC: 0.906556
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.181899    reg_loss: 0.017476    l2_loss: 0.024085    loss: 0.223461
steps 7400    v_Prec: 0.757053  v_Recall: 0.686829  v_F1: 0.720233  v_AUC: 0.906041
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.180482    reg_loss: 0.017416    l2_loss: 0.024304    loss: 0.222202
steps 7600    v_Prec: 0.757898  v_Recall: 0.686511  v_F1: 0.720440  v_AUC: 0.906871
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.178610    reg_loss: 0.017392    l2_loss: 0.024513    loss: 0.220515
steps 7800    v_Prec: 0.747868  v_Recall: 0.703998  v_F1: 0.725270  v_AUC: 0.909680
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.169296    reg_loss: 0.017317    l2_loss: 0.024631    loss: 0.211244
steps 8000    v_Prec: 0.750830  v_Recall: 0.701296  v_F1: 0.725218  v_AUC: 0.909496
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.183374    reg_loss: 0.017416    l2_loss: 0.024894    loss: 0.225683
steps 8200    v_Prec: 0.774248  v_Recall: 0.689691  v_F1: 0.729527  v_AUC: 0.912064
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.186187    reg_loss: 0.017359    l2_loss: 0.024999    loss: 0.228545
steps 8400    v_Prec: 0.792351  v_Recall: 0.675145  v_F1: 0.729067  v_AUC: 0.912124
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.179376    reg_loss: 0.017298    l2_loss: 0.025020    loss: 0.221694
steps 8600    v_Prec: 0.778125  v_Recall: 0.692155  v_F1: 0.732627  v_AUC: 0.913796
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.178081    reg_loss: 0.017149    l2_loss: 0.025210    loss: 0.220440
steps 8800    v_Prec: 0.771256  v_Recall: 0.700819  v_F1: 0.734352  v_AUC: 0.915338
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.176530    reg_loss: 0.017196    l2_loss: 0.025309    loss: 0.219035
steps 9000    v_Prec: 0.773249  v_Recall: 0.701216  v_F1: 0.735473  v_AUC: 0.916775
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.188350    reg_loss: 0.017194    l2_loss: 0.025380    loss: 0.230925
steps 9200    v_Prec: 0.780029  v_Recall: 0.694778  v_F1: 0.734939  v_AUC: 0.918726
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.180752    reg_loss: 0.017031    l2_loss: 0.025529    loss: 0.223312
steps 9400    v_Prec: 0.776132  v_Recall: 0.704078  v_F1: 0.738351  v_AUC: 0.918030
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.177224    reg_loss: 0.017055    l2_loss: 0.025505    loss: 0.219785
steps 9600    v_Prec: 0.782605  v_Recall: 0.700183  v_F1: 0.739103  v_AUC: 0.917673
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.176936    reg_loss: 0.017041    l2_loss: 0.025604    loss: 0.219581
steps 9800    v_Prec: 0.787695  v_Recall: 0.702170  v_F1: 0.742478  v_AUC: 0.920648
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.179046    reg_loss: 0.016985    l2_loss: 0.025642    loss: 0.221673
steps 10000    v_Prec: 0.778774  v_Recall: 0.710993  v_F1: 0.743342  v_AUC: 0.920770
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.178131    reg_loss: 0.016963    l2_loss: 0.025691    loss: 0.220784
steps 10200    v_Prec: 0.784029  v_Recall: 0.707813  v_F1: 0.743974  v_AUC: 0.920634
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.174130    reg_loss: 0.016990    l2_loss: 0.025667    loss: 0.216787
steps 10400    v_Prec: 0.761110  v_Recall: 0.732374  v_F1: 0.746466  v_AUC: 0.922831
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.171954    reg_loss: 0.016916    l2_loss: 0.025636    loss: 0.214506
steps 10600    v_Prec: 0.794750  v_Recall: 0.705111  v_F1: 0.747252  v_AUC: 0.922149
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.172049    reg_loss: 0.016806    l2_loss: 0.025758    loss: 0.214613
steps 10800    v_Prec: 0.781079  v_Recall: 0.716636  v_F1: 0.747471  v_AUC: 0.921938
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.070170    reg_loss: 0.015637    l2_loss: 0.025776    loss: 0.111583
steps 11000    v_Prec: 0.780927  v_Recall: 0.709483  v_F1: 0.743493  v_AUC: 0.918118
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.064729    reg_loss: 0.015631    l2_loss: 0.025639    loss: 0.105999
steps 11200    v_Prec: 0.785338  v_Recall: 0.698196  v_F1: 0.739207  v_AUC: 0.916264
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.065117    reg_loss: 0.015690    l2_loss: 0.025644    loss: 0.106452
steps 11400    v_Prec: 0.781464  v_Recall: 0.698355  v_F1: 0.737576  v_AUC: 0.914701
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.072243    reg_loss: 0.015782    l2_loss: 0.025578    loss: 0.113603
steps 11600    v_Prec: 0.769191  v_Recall: 0.708052  v_F1: 0.737356  v_AUC: 0.912183
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.065210    reg_loss: 0.015792    l2_loss: 0.025532    loss: 0.106534
steps 11800    v_Prec: 0.777249  v_Recall: 0.701137  v_F1: 0.737234  v_AUC: 0.911285
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.072973    reg_loss: 0.015713    l2_loss: 0.025590    loss: 0.114276
steps 12000    v_Prec: 0.789142  v_Recall: 0.687465  v_F1: 0.734803  v_AUC: 0.912320
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.067681    reg_loss: 0.015735    l2_loss: 0.025552    loss: 0.108968
steps 12200    v_Prec: 0.778312  v_Recall: 0.694857  v_F1: 0.734221  v_AUC: 0.911211
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.071149    reg_loss: 0.015789    l2_loss: 0.025533    loss: 0.112471
steps 12400    v_Prec: 0.786193  v_Recall: 0.689770  v_F1: 0.734832  v_AUC: 0.912830
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.074360    reg_loss: 0.015796    l2_loss: 0.025470    loss: 0.115626
steps 12600    v_Prec: 0.793441  v_Recall: 0.688499  v_F1: 0.737254  v_AUC: 0.912010
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.076740    reg_loss: 0.015837    l2_loss: 0.025597    loss: 0.118175
steps 12800    v_Prec: 0.764363  v_Recall: 0.708529  v_F1: 0.735388  v_AUC: 0.913052
steps 12800    running time 451 seconds

Early stop model F1: 0.747471
testing thre: 0.5124562
testing Prec: 0.5767156406918356
testing Recall: 0.7535844471445929
testing F1: 0.6533923303834807
testing AUC: 0.9014475424117723
overall running time 454 seconds
(0.7281800922158936, 0.6524422843256379, 0.6882337862086644, 0.9014475424117723, 0.8145563)

2019-02-24 16:22:07.857434: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:22:08.130434: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:22:08.134812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:22:08.134852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.210000 seconds
loading data in 31.370000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.706192    reg_loss: 0.021639    l2_loss: 0.013322    loss: 1.741153
steps 200    v_Prec: 0.164278  v_Recall: 1.000000  v_F1: 0.282198  v_AUC: 0.519059
steps 200    running time 42 seconds

steps 400    base_loss: 1.061850    reg_loss: 0.021509    l2_loss: 0.012990    loss: 1.096349
steps 400    v_Prec: 0.164847  v_Recall: 0.993327  v_F1: 0.282768  v_AUC: 0.527140
steps 400    running time 48 seconds

steps 600    base_loss: 0.537456    reg_loss: 0.021383    l2_loss: 0.012637    loss: 0.571476
steps 600    v_Prec: 0.172997  v_Recall: 0.859390  v_F1: 0.288015  v_AUC: 0.557043
steps 600    running time 55 seconds

steps 800    base_loss: 0.475649    reg_loss: 0.021312    l2_loss: 0.012394    loss: 0.509355
steps 800    v_Prec: 0.206666  v_Recall: 0.588100  v_F1: 0.305852  v_AUC: 0.601952
steps 800    running time 62 seconds

steps 1000    base_loss: 0.463507    reg_loss: 0.021155    l2_loss: 0.012248    loss: 0.496910
steps 1000    v_Prec: 0.263258  v_Recall: 0.483079  v_F1: 0.340796  v_AUC: 0.656388
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.452991    reg_loss: 0.021050    l2_loss: 0.012137    loss: 0.486179
steps 1200    v_Prec: 0.327867  v_Recall: 0.446298  v_F1: 0.378024  v_AUC: 0.699100
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.429808    reg_loss: 0.020871    l2_loss: 0.012012    loss: 0.462691
steps 1400    v_Prec: 0.377832  v_Recall: 0.471719  v_F1: 0.419587  v_AUC: 0.734323
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.412441    reg_loss: 0.020747    l2_loss: 0.012080    loss: 0.445268
steps 1600    v_Prec: 0.451286  v_Recall: 0.473943  v_F1: 0.462337  v_AUC: 0.761198
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.377773    reg_loss: 0.020616    l2_loss: 0.012193    loss: 0.410582
steps 1800    v_Prec: 0.506875  v_Recall: 0.489037  v_F1: 0.497796  v_AUC: 0.785746
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.366483    reg_loss: 0.020623    l2_loss: 0.012313    loss: 0.399418
steps 2000    v_Prec: 0.508027  v_Recall: 0.522879  v_F1: 0.515346  v_AUC: 0.803572
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.353478    reg_loss: 0.020549    l2_loss: 0.012505    loss: 0.386532
steps 2200    v_Prec: 0.526401  v_Recall: 0.543295  v_F1: 0.534715  v_AUC: 0.817164
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.348483    reg_loss: 0.020564    l2_loss: 0.012756    loss: 0.381802
steps 2400    v_Prec: 0.539494  v_Recall: 0.558866  v_F1: 0.549009  v_AUC: 0.827653
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.334377    reg_loss: 0.020452    l2_loss: 0.013176    loss: 0.368005
steps 2600    v_Prec: 0.531268  v_Recall: 0.589847  v_F1: 0.559027  v_AUC: 0.835351
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.335574    reg_loss: 0.020410    l2_loss: 0.013583    loss: 0.369568
steps 2800    v_Prec: 0.558388  v_Recall: 0.572450  v_F1: 0.565332  v_AUC: 0.843927
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.332272    reg_loss: 0.020283    l2_loss: 0.014078    loss: 0.366633
steps 3000    v_Prec: 0.538172  v_Recall: 0.614315  v_F1: 0.573729  v_AUC: 0.850547
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.323040    reg_loss: 0.020272    l2_loss: 0.014709    loss: 0.358021
steps 3200    v_Prec: 0.558036  v_Recall: 0.605736  v_F1: 0.580908  v_AUC: 0.853355
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.321696    reg_loss: 0.020167    l2_loss: 0.015256    loss: 0.357119
steps 3400    v_Prec: 0.561333  v_Recall: 0.611455  v_F1: 0.585323  v_AUC: 0.856966
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.324825    reg_loss: 0.020093    l2_loss: 0.015880    loss: 0.360799
steps 3600    v_Prec: 0.565607  v_Recall: 0.621862  v_F1: 0.592402  v_AUC: 0.861029
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.318673    reg_loss: 0.020028    l2_loss: 0.016577    loss: 0.355278
steps 3800    v_Prec: 0.565286  v_Recall: 0.624563  v_F1: 0.593448  v_AUC: 0.865002
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.315997    reg_loss: 0.019908    l2_loss: 0.017347    loss: 0.353252
steps 4000    v_Prec: 0.582920  v_Recall: 0.606768  v_F1: 0.594605  v_AUC: 0.864903
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.315733    reg_loss: 0.019812    l2_loss: 0.018034    loss: 0.353580
steps 4200    v_Prec: 0.589874  v_Recall: 0.600651  v_F1: 0.595214  v_AUC: 0.866715
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.319220    reg_loss: 0.019720    l2_loss: 0.018890    loss: 0.357830
steps 4400    v_Prec: 0.563140  v_Recall: 0.633063  v_F1: 0.596058  v_AUC: 0.869553
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.310842    reg_loss: 0.019582    l2_loss: 0.019699    loss: 0.350124
steps 4600    v_Prec: 0.586225  v_Recall: 0.620035  v_F1: 0.602656  v_AUC: 0.872399
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.313658    reg_loss: 0.019488    l2_loss: 0.020583    loss: 0.353730
steps 4800    v_Prec: 0.592404  v_Recall: 0.626946  v_F1: 0.609186  v_AUC: 0.873326
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.304314    reg_loss: 0.019334    l2_loss: 0.021322    loss: 0.344971
steps 5000    v_Prec: 0.602976  v_Recall: 0.624484  v_F1: 0.613541  v_AUC: 0.875934
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.310318    reg_loss: 0.019203    l2_loss: 0.022327    loss: 0.351848
steps 5200    v_Prec: 0.617577  v_Recall: 0.617969  v_F1: 0.617773  v_AUC: 0.876010
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.298981    reg_loss: 0.019131    l2_loss: 0.023172    loss: 0.341284
steps 5400    v_Prec: 0.591558  v_Recall: 0.647998  v_F1: 0.618493  v_AUC: 0.878710
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.172697    reg_loss: 0.020104    l2_loss: 0.023929    loss: 0.216730
steps 5600    v_Prec: 0.572773  v_Recall: 0.643073  v_F1: 0.605890  v_AUC: 0.870844
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.183234    reg_loss: 0.020270    l2_loss: 0.024346    loss: 0.227851
steps 5800    v_Prec: 0.568326  v_Recall: 0.634017  v_F1: 0.599377  v_AUC: 0.866775
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.178705    reg_loss: 0.020507    l2_loss: 0.024768    loss: 0.223980
steps 6000    v_Prec: 0.560722  v_Recall: 0.638942  v_F1: 0.597282  v_AUC: 0.865507
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.179952    reg_loss: 0.020561    l2_loss: 0.025337    loss: 0.225850
steps 6200    v_Prec: 0.592645  v_Recall: 0.600413  v_F1: 0.596504  v_AUC: 0.863911
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.180457    reg_loss: 0.020615    l2_loss: 0.025833    loss: 0.226905
steps 6400    v_Prec: 0.582092  v_Recall: 0.611455  v_F1: 0.596412  v_AUC: 0.863114
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.192178    reg_loss: 0.020474    l2_loss: 0.026369    loss: 0.239020
steps 6600    v_Prec: 0.583631  v_Recall: 0.622577  v_F1: 0.602475  v_AUC: 0.864833
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.168549    reg_loss: 0.020585    l2_loss: 0.026796    loss: 0.215930
steps 6800    v_Prec: 0.569395  v_Recall: 0.632269  v_F1: 0.599187  v_AUC: 0.864343
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.186027    reg_loss: 0.020439    l2_loss: 0.027236    loss: 0.233702
steps 7000    v_Prec: 0.577323  v_Recall: 0.634652  v_F1: 0.604632  v_AUC: 0.867888
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.187488    reg_loss: 0.020487    l2_loss: 0.027709    loss: 0.235684
steps 7200    v_Prec: 0.601041  v_Recall: 0.605577  v_F1: 0.603300  v_AUC: 0.865837
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.181614    reg_loss: 0.020448    l2_loss: 0.028115    loss: 0.230176
steps 7400    v_Prec: 0.602666  v_Recall: 0.610661  v_F1: 0.606637  v_AUC: 0.867968
steps 7400    running time 279 seconds

Early stop model F1: 0.618493
testing thre: 0.29322448
testing Prec: 0.41709428699244755
testing Recall: 0.7703523693803159
testing F1: 0.541177273968861
testing AUC: 0.8638827448730239
overall running time 281 seconds
(0.5744612856099343, 0.6115674362089915, 0.5924339085195037, 0.8638827448730239, 0.54733884)

2019-02-24 16:25:14.565746: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:25:16.993080: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:25:16.997407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:25:16.997448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.470000 seconds
loading data in 30.550000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.710701    reg_loss: 0.021651    l2_loss: 0.013285    loss: 0.745637
steps 200    v_Prec: 0.163782  v_Recall: 0.995451  v_F1: 0.281284  v_AUC: 0.517759
steps 200    running time 41 seconds

steps 400    base_loss: 0.533044    reg_loss: 0.021578    l2_loss: 0.013124    loss: 0.567746
steps 400    v_Prec: 0.166338  v_Recall: 0.950116  v_F1: 0.283112  v_AUC: 0.535150
steps 400    running time 47 seconds

steps 600    base_loss: 0.481717    reg_loss: 0.021487    l2_loss: 0.012972    loss: 0.516175
steps 600    v_Prec: 0.176621  v_Recall: 0.802059  v_F1: 0.289492  v_AUC: 0.568669
steps 600    running time 54 seconds

steps 800    base_loss: 0.448547    reg_loss: 0.021419    l2_loss: 0.012913    loss: 0.482879
steps 800    v_Prec: 0.232271  v_Recall: 0.490143  v_F1: 0.315182  v_AUC: 0.622588
steps 800    running time 61 seconds

steps 1000    base_loss: 0.439341    reg_loss: 0.021484    l2_loss: 0.012779    loss: 0.473604
steps 1000    v_Prec: 0.289902  v_Recall: 0.460132  v_F1: 0.355700  v_AUC: 0.666890
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.431199    reg_loss: 0.021466    l2_loss: 0.012780    loss: 0.465445
steps 1200    v_Prec: 0.330692  v_Recall: 0.466358  v_F1: 0.386979  v_AUC: 0.694316
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.417025    reg_loss: 0.021464    l2_loss: 0.012772    loss: 0.451260
steps 1400    v_Prec: 0.384307  v_Recall: 0.473781  v_F1: 0.424379  v_AUC: 0.727190
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.403764    reg_loss: 0.021505    l2_loss: 0.012786    loss: 0.438054
steps 1600    v_Prec: 0.442185  v_Recall: 0.458137  v_F1: 0.450020  v_AUC: 0.750202
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.385515    reg_loss: 0.021513    l2_loss: 0.012926    loss: 0.419954
steps 1800    v_Prec: 0.444452  v_Recall: 0.512491  v_F1: 0.476053  v_AUC: 0.771913
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.375684    reg_loss: 0.021613    l2_loss: 0.013052    loss: 0.410349
steps 2000    v_Prec: 0.481298  v_Recall: 0.527895  v_F1: 0.503521  v_AUC: 0.791130
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.364117    reg_loss: 0.021753    l2_loss: 0.013268    loss: 0.399139
steps 2200    v_Prec: 0.513639  v_Recall: 0.536515  v_F1: 0.524828  v_AUC: 0.808401
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.359935    reg_loss: 0.021913    l2_loss: 0.013481    loss: 0.395329
steps 2400    v_Prec: 0.540301  v_Recall: 0.568202  v_F1: 0.553900  v_AUC: 0.829107
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.341348    reg_loss: 0.022142    l2_loss: 0.013726    loss: 0.377216
steps 2600    v_Prec: 0.547257  v_Recall: 0.603560  v_F1: 0.574031  v_AUC: 0.845275
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.335426    reg_loss: 0.022349    l2_loss: 0.013998    loss: 0.371773
steps 2800    v_Prec: 0.592548  v_Recall: 0.590231  v_F1: 0.591387  v_AUC: 0.855740
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.328163    reg_loss: 0.022532    l2_loss: 0.014263    loss: 0.364957
steps 3000    v_Prec: 0.596274  v_Recall: 0.608029  v_F1: 0.602094  v_AUC: 0.863781
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.309927    reg_loss: 0.022632    l2_loss: 0.014580    loss: 0.347139
steps 3200    v_Prec: 0.617207  v_Recall: 0.605236  v_F1: 0.611163  v_AUC: 0.869495
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.311647    reg_loss: 0.022721    l2_loss: 0.014974    loss: 0.349342
steps 3400    v_Prec: 0.633115  v_Recall: 0.602442  v_F1: 0.617398  v_AUC: 0.876177
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.301393    reg_loss: 0.022842    l2_loss: 0.015390    loss: 0.339626
steps 3600    v_Prec: 0.630894  v_Recall: 0.619363  v_F1: 0.625076  v_AUC: 0.879867
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.292010    reg_loss: 0.022839    l2_loss: 0.015894    loss: 0.330743
steps 3800    v_Prec: 0.650537  v_Recall: 0.619124  v_F1: 0.634442  v_AUC: 0.883797
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.289555    reg_loss: 0.022842    l2_loss: 0.016373    loss: 0.328770
steps 4000    v_Prec: 0.638549  v_Recall: 0.644664  v_F1: 0.641592  v_AUC: 0.886838
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.288839    reg_loss: 0.022948    l2_loss: 0.016887    loss: 0.328675
steps 4200    v_Prec: 0.638323  v_Recall: 0.652486  v_F1: 0.645327  v_AUC: 0.889581
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.287119    reg_loss: 0.022956    l2_loss: 0.017491    loss: 0.327566
steps 4400    v_Prec: 0.643787  v_Recall: 0.655040  v_F1: 0.649365  v_AUC: 0.892965
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.275369    reg_loss: 0.022974    l2_loss: 0.018065    loss: 0.316409
steps 4600    v_Prec: 0.659643  v_Recall: 0.654641  v_F1: 0.657133  v_AUC: 0.894695
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.283055    reg_loss: 0.023011    l2_loss: 0.018651    loss: 0.324717
steps 4800    v_Prec: 0.677164  v_Recall: 0.635007  v_F1: 0.655408  v_AUC: 0.895025
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.283788    reg_loss: 0.023071    l2_loss: 0.019208    loss: 0.326067
steps 5000    v_Prec: 0.685724  v_Recall: 0.643308  v_F1: 0.663839  v_AUC: 0.897928
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.285848    reg_loss: 0.023059    l2_loss: 0.019967    loss: 0.328875
steps 5200    v_Prec: 0.688858  v_Recall: 0.640035  v_F1: 0.663550  v_AUC: 0.899074
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.272004    reg_loss: 0.023171    l2_loss: 0.020570    loss: 0.315744
steps 5400    v_Prec: 0.680110  v_Recall: 0.650092  v_F1: 0.664762  v_AUC: 0.900591
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.172431    reg_loss: 0.023749    l2_loss: 0.021520    loss: 0.217700
steps 5600    v_Prec: 0.661712  v_Recall: 0.646660  v_F1: 0.654099  v_AUC: 0.894200
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.189477    reg_loss: 0.023722    l2_loss: 0.022301    loss: 0.235501
steps 5800    v_Prec: 0.670001  v_Recall: 0.636204  v_F1: 0.652665  v_AUC: 0.892570
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.190926    reg_loss: 0.023742    l2_loss: 0.023020    loss: 0.237688
steps 6000    v_Prec: 0.642846  v_Recall: 0.664139  v_F1: 0.653319  v_AUC: 0.893594
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.188400    reg_loss: 0.023701    l2_loss: 0.023615    loss: 0.235715
steps 6200    v_Prec: 0.661572  v_Recall: 0.652965  v_F1: 0.657240  v_AUC: 0.893693
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.195123    reg_loss: 0.023680    l2_loss: 0.024240    loss: 0.243044
steps 6400    v_Prec: 0.700869  v_Recall: 0.617687  v_F1: 0.656654  v_AUC: 0.893405
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.194182    reg_loss: 0.023731    l2_loss: 0.024743    loss: 0.242656
steps 6600    v_Prec: 0.684928  v_Recall: 0.637641  v_F1: 0.660439  v_AUC: 0.894874
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.200657    reg_loss: 0.023703    l2_loss: 0.025260    loss: 0.249619
steps 6800    v_Prec: 0.688062  v_Recall: 0.635725  v_F1: 0.660859  v_AUC: 0.895647
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.204818    reg_loss: 0.023596    l2_loss: 0.025719    loss: 0.254133
steps 7000    v_Prec: 0.682980  v_Recall: 0.646021  v_F1: 0.663987  v_AUC: 0.897260
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.196667    reg_loss: 0.023682    l2_loss: 0.026143    loss: 0.246492
steps 7200    v_Prec: 0.686291  v_Recall: 0.648495  v_F1: 0.666858  v_AUC: 0.898037
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.206828    reg_loss: 0.023670    l2_loss: 0.026554    loss: 0.257051
steps 7400    v_Prec: 0.692543  v_Recall: 0.651528  v_F1: 0.671410  v_AUC: 0.899685
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.199149    reg_loss: 0.023676    l2_loss: 0.026954    loss: 0.249780
steps 7600    v_Prec: 0.690976  v_Recall: 0.656397  v_F1: 0.673243  v_AUC: 0.901350
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.199462    reg_loss: 0.023628    l2_loss: 0.027231    loss: 0.250321
steps 7800    v_Prec: 0.696072  v_Recall: 0.661904  v_F1: 0.678558  v_AUC: 0.904089
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.200125    reg_loss: 0.023653    l2_loss: 0.027526    loss: 0.251303
steps 8000    v_Prec: 0.686530  v_Recall: 0.667571  v_F1: 0.676918  v_AUC: 0.905212
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.197923    reg_loss: 0.023649    l2_loss: 0.027771    loss: 0.249342
steps 8200    v_Prec: 0.706474  v_Recall: 0.655838  v_F1: 0.680215  v_AUC: 0.905906
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.201796    reg_loss: 0.023590    l2_loss: 0.028141    loss: 0.253527
steps 8400    v_Prec: 0.705667  v_Recall: 0.660947  v_F1: 0.682575  v_AUC: 0.905921
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.201694    reg_loss: 0.023690    l2_loss: 0.028403    loss: 0.253787
steps 8600    v_Prec: 0.744884  v_Recall: 0.636204  v_F1: 0.686268  v_AUC: 0.907989
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.202631    reg_loss: 0.023755    l2_loss: 0.028598    loss: 0.254985
steps 8800    v_Prec: 0.706070  v_Recall: 0.671243  v_F1: 0.688216  v_AUC: 0.908736
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.196781    reg_loss: 0.023649    l2_loss: 0.028800    loss: 0.249231
steps 9000    v_Prec: 0.714225  v_Recall: 0.670445  v_F1: 0.691643  v_AUC: 0.910023
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.199842    reg_loss: 0.023707    l2_loss: 0.029165    loss: 0.252714
steps 9200    v_Prec: 0.704142  v_Recall: 0.689361  v_F1: 0.696673  v_AUC: 0.912132
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.196169    reg_loss: 0.023707    l2_loss: 0.029396    loss: 0.249273
steps 9400    v_Prec: 0.707230  v_Recall: 0.692553  v_F1: 0.699815  v_AUC: 0.914521
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.194172    reg_loss: 0.023678    l2_loss: 0.029554    loss: 0.247404
steps 9600    v_Prec: 0.724109  v_Recall: 0.682497  v_F1: 0.702687  v_AUC: 0.914815
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.186221    reg_loss: 0.023690    l2_loss: 0.029902    loss: 0.239814
steps 9800    v_Prec: 0.719666  v_Recall: 0.687844  v_F1: 0.703395  v_AUC: 0.916346
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.202090    reg_loss: 0.023696    l2_loss: 0.029977    loss: 0.255763
steps 10000    v_Prec: 0.731765  v_Recall: 0.687844  v_F1: 0.709125  v_AUC: 0.918990
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.191239    reg_loss: 0.023639    l2_loss: 0.030238    loss: 0.245116
steps 10200    v_Prec: 0.717460  v_Recall: 0.703488  v_F1: 0.710405  v_AUC: 0.920260
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.193206    reg_loss: 0.023700    l2_loss: 0.030377    loss: 0.247283
steps 10400    v_Prec: 0.717012  v_Recall: 0.698699  v_F1: 0.707737  v_AUC: 0.920482
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.190180    reg_loss: 0.023616    l2_loss: 0.030598    loss: 0.244394
steps 10600    v_Prec: 0.723104  v_Recall: 0.698460  v_F1: 0.710568  v_AUC: 0.921097
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.186091    reg_loss: 0.023764    l2_loss: 0.030810    loss: 0.240666
steps 10800    v_Prec: 0.737143  v_Recall: 0.689840  v_F1: 0.712707  v_AUC: 0.921413
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.084469    reg_loss: 0.024057    l2_loss: 0.030941    loss: 0.139467
steps 11000    v_Prec: 0.721089  v_Recall: 0.674355  v_F1: 0.696940  v_AUC: 0.913305
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.071615    reg_loss: 0.023999    l2_loss: 0.030960    loss: 0.126574
steps 11200    v_Prec: 0.723057  v_Recall: 0.657036  v_F1: 0.688467  v_AUC: 0.908665
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.082483    reg_loss: 0.023907    l2_loss: 0.031128    loss: 0.137518
steps 11400    v_Prec: 0.698727  v_Recall: 0.674914  v_F1: 0.686614  v_AUC: 0.906167
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.075236    reg_loss: 0.023941    l2_loss: 0.031199    loss: 0.130376
steps 11600    v_Prec: 0.721752  v_Recall: 0.646979  v_F1: 0.682323  v_AUC: 0.904191
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.086702    reg_loss: 0.023908    l2_loss: 0.031327    loss: 0.141938
steps 11800    v_Prec: 0.686599  v_Recall: 0.665336  v_F1: 0.675801  v_AUC: 0.900922
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.083734    reg_loss: 0.023918    l2_loss: 0.031476    loss: 0.139128
steps 12000    v_Prec: 0.670701  v_Recall: 0.676750  v_F1: 0.673712  v_AUC: 0.901520
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.091055    reg_loss: 0.023828    l2_loss: 0.031565    loss: 0.146448
steps 12200    v_Prec: 0.667273  v_Recall: 0.672919  v_F1: 0.670084  v_AUC: 0.899581
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.091145    reg_loss: 0.023862    l2_loss: 0.031641    loss: 0.146647
steps 12400    v_Prec: 0.665417  v_Recall: 0.680022  v_F1: 0.672640  v_AUC: 0.899694
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.092368    reg_loss: 0.023937    l2_loss: 0.031774    loss: 0.148079
steps 12600    v_Prec: 0.683497  v_Recall: 0.655838  v_F1: 0.669382  v_AUC: 0.897075
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.095820    reg_loss: 0.023829    l2_loss: 0.031930    loss: 0.151579
steps 12800    v_Prec: 0.671973  v_Recall: 0.667092  v_F1: 0.669524  v_AUC: 0.898138
steps 12800    running time 452 seconds

Early stop model F1: 0.712707
testing thre: 0.39373276
testing Prec: 0.5217260612537992
testing Recall: 0.7592223572296476
testing F1: 0.6184575184100087
testing AUC: 0.8970753941579975
overall running time 455 seconds
(0.6759317751105496, 0.6240583232077764, 0.6489600970407622, 0.8970753941579975, 0.7096919)

2019-02-24 16:30:14.409975: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:30:16.772056: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:30:16.799933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:30:16.800008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.960000 seconds
loading data in 30.130000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.175660    reg_loss: 0.021607    l2_loss: 0.013312    loss: 1.210578
steps 200    v_Prec: 0.163761  v_Recall: 1.000000  v_F1: 0.281435  v_AUC: 0.487790
steps 200    running time 40 seconds

steps 400    base_loss: 0.711498    reg_loss: 0.021705    l2_loss: 0.013260    loss: 0.746463
steps 400    v_Prec: 0.163766  v_Recall: 1.000000  v_F1: 0.281441  v_AUC: 0.513369
steps 400    running time 47 seconds

steps 600    base_loss: 0.505077    reg_loss: 0.021748    l2_loss: 0.013151    loss: 0.539976
steps 600    v_Prec: 0.174048  v_Recall: 0.796909  v_F1: 0.285698  v_AUC: 0.552224
steps 600    running time 54 seconds

steps 800    base_loss: 0.483859    reg_loss: 0.021738    l2_loss: 0.013010    loss: 0.518607
steps 800    v_Prec: 0.196899  v_Recall: 0.652617  v_F1: 0.302524  v_AUC: 0.595175
steps 800    running time 61 seconds

steps 1000    base_loss: 0.462465    reg_loss: 0.021692    l2_loss: 0.012848    loss: 0.497005
steps 1000    v_Prec: 0.230521  v_Recall: 0.558203  v_F1: 0.326293  v_AUC: 0.635628
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.443257    reg_loss: 0.021693    l2_loss: 0.012684    loss: 0.477634
steps 1200    v_Prec: 0.329818  v_Recall: 0.448490  v_F1: 0.380107  v_AUC: 0.695657
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.435707    reg_loss: 0.021762    l2_loss: 0.012578    loss: 0.470047
steps 1400    v_Prec: 0.375554  v_Recall: 0.492789  v_F1: 0.426258  v_AUC: 0.740336
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.420138    reg_loss: 0.021861    l2_loss: 0.012570    loss: 0.454569
steps 1600    v_Prec: 0.460237  v_Recall: 0.468011  v_F1: 0.464091  v_AUC: 0.772260
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.393927    reg_loss: 0.021965    l2_loss: 0.012648    loss: 0.428541
steps 1800    v_Prec: 0.491017  v_Recall: 0.507370  v_F1: 0.499060  v_AUC: 0.799521
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.374110    reg_loss: 0.022083    l2_loss: 0.012828    loss: 0.409021
steps 2000    v_Prec: 0.566284  v_Recall: 0.503705  v_F1: 0.533165  v_AUC: 0.820923
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.353234    reg_loss: 0.022258    l2_loss: 0.013058    loss: 0.388550
steps 2200    v_Prec: 0.587040  v_Recall: 0.545694  v_F1: 0.565612  v_AUC: 0.840746
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.335200    reg_loss: 0.022408    l2_loss: 0.013369    loss: 0.370977
steps 2400    v_Prec: 0.621256  v_Recall: 0.542108  v_F1: 0.578990  v_AUC: 0.849311
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.322217    reg_loss: 0.022537    l2_loss: 0.013757    loss: 0.358511
steps 2600    v_Prec: 0.640944  v_Recall: 0.564497  v_F1: 0.600297  v_AUC: 0.858831
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.317471    reg_loss: 0.022688    l2_loss: 0.014104    loss: 0.354263
steps 2800    v_Prec: 0.641951  v_Recall: 0.580830  v_F1: 0.609863  v_AUC: 0.866257
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.307882    reg_loss: 0.022699    l2_loss: 0.014559    loss: 0.345140
steps 3000    v_Prec: 0.655692  v_Recall: 0.596606  v_F1: 0.624755  v_AUC: 0.872141
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.298512    reg_loss: 0.022751    l2_loss: 0.014924    loss: 0.336187
steps 3200    v_Prec: 0.644144  v_Recall: 0.615250  v_F1: 0.629365  v_AUC: 0.875088
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.299189    reg_loss: 0.022844    l2_loss: 0.015332    loss: 0.337365
steps 3400    v_Prec: 0.664539  v_Recall: 0.613816  v_F1: 0.638171  v_AUC: 0.880350
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.289212    reg_loss: 0.022873    l2_loss: 0.015800    loss: 0.327885
steps 3600    v_Prec: 0.675090  v_Recall: 0.615170  v_F1: 0.643739  v_AUC: 0.882401
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.291656    reg_loss: 0.022970    l2_loss: 0.016238    loss: 0.330864
steps 3800    v_Prec: 0.661810  v_Recall: 0.640507  v_F1: 0.650984  v_AUC: 0.886493
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.275675    reg_loss: 0.022908    l2_loss: 0.016709    loss: 0.315292
steps 4000    v_Prec: 0.668360  v_Recall: 0.639551  v_F1: 0.653638  v_AUC: 0.888374
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.279877    reg_loss: 0.022940    l2_loss: 0.017240    loss: 0.320056
steps 4200    v_Prec: 0.680450  v_Recall: 0.635886  v_F1: 0.657414  v_AUC: 0.891733
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.274983    reg_loss: 0.022937    l2_loss: 0.017815    loss: 0.315735
steps 4400    v_Prec: 0.684219  v_Recall: 0.641861  v_F1: 0.662364  v_AUC: 0.893965
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.277300    reg_loss: 0.023000    l2_loss: 0.018321    loss: 0.318622
steps 4600    v_Prec: 0.703926  v_Recall: 0.625687  v_F1: 0.662505  v_AUC: 0.895482
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.272227    reg_loss: 0.022925    l2_loss: 0.018945    loss: 0.314097
steps 4800    v_Prec: 0.692123  v_Recall: 0.643375  v_F1: 0.666859  v_AUC: 0.897350
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.270474    reg_loss: 0.022991    l2_loss: 0.019581    loss: 0.313046
steps 5000    v_Prec: 0.672277  v_Recall: 0.668313  v_F1: 0.670289  v_AUC: 0.901029
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.266664    reg_loss: 0.022972    l2_loss: 0.020189    loss: 0.309825
steps 5200    v_Prec: 0.697092  v_Recall: 0.647438  v_F1: 0.671348  v_AUC: 0.901895
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.269016    reg_loss: 0.023077    l2_loss: 0.020889    loss: 0.312982
steps 5400    v_Prec: 0.676320  v_Recall: 0.662417  v_F1: 0.669296  v_AUC: 0.901893
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.181497    reg_loss: 0.023418    l2_loss: 0.021739    loss: 0.226655
steps 5600    v_Prec: 0.682615  v_Recall: 0.645686  v_F1: 0.663637  v_AUC: 0.897592
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.185654    reg_loss: 0.023384    l2_loss: 0.022637    loss: 0.231674
steps 5800    v_Prec: 0.687713  v_Recall: 0.643933  v_F1: 0.665103  v_AUC: 0.896129
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.186811    reg_loss: 0.023349    l2_loss: 0.023323    loss: 0.233483
steps 6000    v_Prec: 0.698474  v_Recall: 0.631025  v_F1: 0.663039  v_AUC: 0.894986
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.191986    reg_loss: 0.023309    l2_loss: 0.023900    loss: 0.239195
steps 6200    v_Prec: 0.693097  v_Recall: 0.645606  v_F1: 0.668509  v_AUC: 0.896753
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.183382    reg_loss: 0.023361    l2_loss: 0.024539    loss: 0.231283
steps 6400    v_Prec: 0.722258  v_Recall: 0.623855  v_F1: 0.669460  v_AUC: 0.897605
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.193824    reg_loss: 0.023340    l2_loss: 0.025040    loss: 0.242204
steps 6600    v_Prec: 0.682147  v_Recall: 0.653016  v_F1: 0.667264  v_AUC: 0.896652
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.197205    reg_loss: 0.023335    l2_loss: 0.025531    loss: 0.246072
steps 6800    v_Prec: 0.698997  v_Recall: 0.649430  v_F1: 0.673302  v_AUC: 0.898181
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.188045    reg_loss: 0.023325    l2_loss: 0.025964    loss: 0.237335
steps 7000    v_Prec: 0.684150  v_Recall: 0.668234  v_F1: 0.676098  v_AUC: 0.897588
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.185291    reg_loss: 0.023317    l2_loss: 0.026454    loss: 0.235062
steps 7200    v_Prec: 0.718716  v_Recall: 0.640666  v_F1: 0.677451  v_AUC: 0.898310
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.188176    reg_loss: 0.023356    l2_loss: 0.026926    loss: 0.238457
steps 7400    v_Prec: 0.689847  v_Recall: 0.673412  v_F1: 0.681530  v_AUC: 0.899942
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.184491    reg_loss: 0.023308    l2_loss: 0.027220    loss: 0.235020
steps 7600    v_Prec: 0.703459  v_Recall: 0.662656  v_F1: 0.682449  v_AUC: 0.900803
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.189288    reg_loss: 0.023410    l2_loss: 0.027583    loss: 0.240280
steps 7800    v_Prec: 0.720906  v_Recall: 0.649510  v_F1: 0.683348  v_AUC: 0.903804
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.183655    reg_loss: 0.023363    l2_loss: 0.027937    loss: 0.234955
steps 8000    v_Prec: 0.720875  v_Recall: 0.648793  v_F1: 0.682937  v_AUC: 0.904023
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.188343    reg_loss: 0.023357    l2_loss: 0.028352    loss: 0.240052
steps 8200    v_Prec: 0.700491  v_Recall: 0.670465  v_F1: 0.685149  v_AUC: 0.905883
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.196596    reg_loss: 0.023383    l2_loss: 0.028630    loss: 0.248609
steps 8400    v_Prec: 0.699893  v_Recall: 0.679149  v_F1: 0.689365  v_AUC: 0.905676
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.184264    reg_loss: 0.023255    l2_loss: 0.028935    loss: 0.236455
steps 8600    v_Prec: 0.730474  v_Recall: 0.659469  v_F1: 0.693158  v_AUC: 0.907432
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.185549    reg_loss: 0.023259    l2_loss: 0.029053    loss: 0.237861
steps 8800    v_Prec: 0.720557  v_Recall: 0.668313  v_F1: 0.693452  v_AUC: 0.907460
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.192422    reg_loss: 0.023326    l2_loss: 0.029219    loss: 0.244967
steps 9000    v_Prec: 0.725226  v_Recall: 0.669986  v_F1: 0.696513  v_AUC: 0.909649
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.196490    reg_loss: 0.023303    l2_loss: 0.029591    loss: 0.249385
steps 9200    v_Prec: 0.729100  v_Recall: 0.676121  v_F1: 0.701612  v_AUC: 0.911301
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.185191    reg_loss: 0.023249    l2_loss: 0.029734    loss: 0.238174
steps 9400    v_Prec: 0.734342  v_Recall: 0.668871  v_F1: 0.700079  v_AUC: 0.909984
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.195868    reg_loss: 0.023253    l2_loss: 0.029969    loss: 0.249090
steps 9600    v_Prec: 0.745689  v_Recall: 0.671899  v_F1: 0.706873  v_AUC: 0.915523
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.183470    reg_loss: 0.023311    l2_loss: 0.030190    loss: 0.236972
steps 9800    v_Prec: 0.730684  v_Recall: 0.682655  v_F1: 0.705853  v_AUC: 0.914132
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.181273    reg_loss: 0.023227    l2_loss: 0.030316    loss: 0.234815
steps 10000    v_Prec: 0.736084  v_Recall: 0.683770  v_F1: 0.708963  v_AUC: 0.915558
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.195426    reg_loss: 0.023298    l2_loss: 0.030466    loss: 0.249190
steps 10200    v_Prec: 0.741908  v_Recall: 0.686639  v_F1: 0.713204  v_AUC: 0.919179
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.193638    reg_loss: 0.023258    l2_loss: 0.030610    loss: 0.247506
steps 10400    v_Prec: 0.740180  v_Recall: 0.693650  v_F1: 0.716160  v_AUC: 0.920291
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.184797    reg_loss: 0.023307    l2_loss: 0.030871    loss: 0.238976
steps 10600    v_Prec: 0.738992  v_Recall: 0.700661  v_F1: 0.719316  v_AUC: 0.922745
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.176415    reg_loss: 0.023279    l2_loss: 0.031121    loss: 0.230816
steps 10800    v_Prec: 0.743794  v_Recall: 0.699466  v_F1: 0.720949  v_AUC: 0.921488
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.082695    reg_loss: 0.023387    l2_loss: 0.031315    loss: 0.137397
steps 11000    v_Prec: 0.754214  v_Recall: 0.663055  v_F1: 0.705703  v_AUC: 0.913276
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.081165    reg_loss: 0.023338    l2_loss: 0.031368    loss: 0.135872
steps 11200    v_Prec: 0.721029  v_Recall: 0.676679  v_F1: 0.698150  v_AUC: 0.909550
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.071496    reg_loss: 0.023289    l2_loss: 0.031423    loss: 0.126208
steps 11400    v_Prec: 0.745414  v_Recall: 0.644331  v_F1: 0.691197  v_AUC: 0.905732
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.080672    reg_loss: 0.023326    l2_loss: 0.031598    loss: 0.135596
steps 11600    v_Prec: 0.714151  v_Recall: 0.663453  v_F1: 0.687869  v_AUC: 0.903420
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.085301    reg_loss: 0.023243    l2_loss: 0.031589    loss: 0.140132
steps 11800    v_Prec: 0.747535  v_Recall: 0.640268  v_F1: 0.689756  v_AUC: 0.903788
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.085557    reg_loss: 0.023210    l2_loss: 0.031746    loss: 0.140513
steps 12000    v_Prec: 0.708747  v_Recall: 0.671421  v_F1: 0.689579  v_AUC: 0.902023
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.086182    reg_loss: 0.023228    l2_loss: 0.031706    loss: 0.141116
steps 12200    v_Prec: 0.720627  v_Recall: 0.647996  v_F1: 0.682385  v_AUC: 0.899893
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.089377    reg_loss: 0.023306    l2_loss: 0.031864    loss: 0.144546
steps 12400    v_Prec: 0.722456  v_Recall: 0.643136  v_F1: 0.680492  v_AUC: 0.898408
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.089274    reg_loss: 0.023242    l2_loss: 0.031983    loss: 0.144499
steps 12600    v_Prec: 0.711662  v_Recall: 0.654450  v_F1: 0.681858  v_AUC: 0.899023
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.088282    reg_loss: 0.023229    l2_loss: 0.032246    loss: 0.143757
steps 12800    v_Prec: 0.716540  v_Recall: 0.651343  v_F1: 0.682387  v_AUC: 0.900036
steps 12800    running time 454 seconds

Early stop model F1: 0.720949
testing thre: 0.31798312
testing Prec: 0.5298736310025274
testing Recall: 0.764228432563791
testing F1: 0.6258308457711442
testing AUC: 0.9002668578901972
overall running time 456 seconds
(0.6820002053598933, 0.6456379100850547, 0.6633210995431054, 0.9002668578901972, 0.6420976)

2019-02-24 16:35:14.170319: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:35:15.166901: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:35:15.171979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:35:15.172029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.130000 seconds
loading data in 30.250000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.660893    reg_loss: 0.021612    l2_loss: 0.013280    loss: 0.695784
steps 200    v_Prec: 0.163035  v_Recall: 0.977006  v_F1: 0.279440  v_AUC: 0.541455
steps 200    running time 40 seconds

steps 400    base_loss: 0.545016    reg_loss: 0.021519    l2_loss: 0.013192    loss: 0.579727
steps 400    v_Prec: 0.175202  v_Recall: 0.750925  v_F1: 0.284115  v_AUC: 0.560646
steps 400    running time 47 seconds

steps 600    base_loss: 0.500107    reg_loss: 0.021488    l2_loss: 0.012994    loss: 0.534589
steps 600    v_Prec: 0.189021  v_Recall: 0.685480  v_F1: 0.296330  v_AUC: 0.586796
steps 600    running time 54 seconds

steps 800    base_loss: 0.484095    reg_loss: 0.021426    l2_loss: 0.012845    loss: 0.518366
steps 800    v_Prec: 0.199412  v_Recall: 0.632497  v_F1: 0.303224  v_AUC: 0.596909
steps 800    running time 60 seconds

steps 1000    base_loss: 0.457591    reg_loss: 0.021314    l2_loss: 0.012711    loss: 0.491617
steps 1000    v_Prec: 0.242318  v_Recall: 0.500241  v_F1: 0.326486  v_AUC: 0.640964
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.445104    reg_loss: 0.021249    l2_loss: 0.012671    loss: 0.479024
steps 1200    v_Prec: 0.362537  v_Recall: 0.404888  v_F1: 0.382544  v_AUC: 0.696630
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.419042    reg_loss: 0.021082    l2_loss: 0.012757    loss: 0.452881
steps 1400    v_Prec: 0.451131  v_Recall: 0.453851  v_F1: 0.452487  v_AUC: 0.750815
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.388662    reg_loss: 0.020950    l2_loss: 0.012924    loss: 0.422535
steps 1600    v_Prec: 0.547348  v_Recall: 0.483759  v_F1: 0.513593  v_AUC: 0.792219
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.360363    reg_loss: 0.020762    l2_loss: 0.013140    loss: 0.394265
steps 1800    v_Prec: 0.582226  v_Recall: 0.528300  v_F1: 0.553954  v_AUC: 0.817813
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.335194    reg_loss: 0.020625    l2_loss: 0.013329    loss: 0.369148
steps 2000    v_Prec: 0.616118  v_Recall: 0.556279  v_F1: 0.584671  v_AUC: 0.838196
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.334130    reg_loss: 0.020490    l2_loss: 0.013526    loss: 0.368146
steps 2200    v_Prec: 0.649632  v_Recall: 0.567213  v_F1: 0.605631  v_AUC: 0.852790
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.299586    reg_loss: 0.020321    l2_loss: 0.013708    loss: 0.333615
steps 2400    v_Prec: 0.662361  v_Recall: 0.589564  v_F1: 0.623846  v_AUC: 0.861276
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.302519    reg_loss: 0.020234    l2_loss: 0.014029    loss: 0.336782
steps 2600    v_Prec: 0.672326  v_Recall: 0.608056  v_F1: 0.638578  v_AUC: 0.868418
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.291235    reg_loss: 0.020143    l2_loss: 0.014320    loss: 0.325698
steps 2800    v_Prec: 0.684570  v_Recall: 0.612799  v_F1: 0.646699  v_AUC: 0.872974
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.286542    reg_loss: 0.020036    l2_loss: 0.014588    loss: 0.321166
steps 3000    v_Prec: 0.718383  v_Recall: 0.604197  v_F1: 0.656361  v_AUC: 0.876631
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.280997    reg_loss: 0.019955    l2_loss: 0.014737    loss: 0.315689
steps 3200    v_Prec: 0.711166  v_Recall: 0.623171  v_F1: 0.664267  v_AUC: 0.879971
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.279807    reg_loss: 0.019830    l2_loss: 0.015096    loss: 0.314733
steps 3400    v_Prec: 0.709037  v_Recall: 0.637723  v_F1: 0.671492  v_AUC: 0.882689
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.276854    reg_loss: 0.019775    l2_loss: 0.015306    loss: 0.311936
steps 3600    v_Prec: 0.728144  v_Recall: 0.629442  v_F1: 0.675205  v_AUC: 0.885759
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.278383    reg_loss: 0.019712    l2_loss: 0.015567    loss: 0.313662
steps 3800    v_Prec: 0.690307  v_Recall: 0.669883  v_F1: 0.679941  v_AUC: 0.889598
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.276153    reg_loss: 0.019621    l2_loss: 0.015884    loss: 0.311657
steps 4000    v_Prec: 0.722004  v_Recall: 0.648979  v_F1: 0.683546  v_AUC: 0.891153
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.266510    reg_loss: 0.019520    l2_loss: 0.016265    loss: 0.302295
steps 4200    v_Prec: 0.732601  v_Recall: 0.649140  v_F1: 0.688350  v_AUC: 0.892236
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.271074    reg_loss: 0.019452    l2_loss: 0.016631    loss: 0.307156
steps 4400    v_Prec: 0.722067  v_Recall: 0.662968  v_F1: 0.691257  v_AUC: 0.895495
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.263657    reg_loss: 0.019311    l2_loss: 0.016995    loss: 0.299963
steps 4600    v_Prec: 0.734544  v_Recall: 0.653401  v_F1: 0.691601  v_AUC: 0.898236
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.270687    reg_loss: 0.019284    l2_loss: 0.017336    loss: 0.307308
steps 4800    v_Prec: 0.750721  v_Recall: 0.648899  v_F1: 0.696106  v_AUC: 0.900292
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.262550    reg_loss: 0.019200    l2_loss: 0.017794    loss: 0.299543
steps 5000    v_Prec: 0.719549  v_Recall: 0.672053  v_F1: 0.694991  v_AUC: 0.901251
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.258734    reg_loss: 0.019119    l2_loss: 0.018207    loss: 0.296060
steps 5200    v_Prec: 0.718480  v_Recall: 0.680817  v_F1: 0.699141  v_AUC: 0.903323
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.250092    reg_loss: 0.018984    l2_loss: 0.018666    loss: 0.287742
steps 5400    v_Prec: 0.728708  v_Recall: 0.678968  v_F1: 0.702959  v_AUC: 0.904343
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.166175    reg_loss: 0.017850    l2_loss: 0.019054    loss: 0.203079
steps 5600    v_Prec: 0.767245  v_Recall: 0.640296  v_F1: 0.698045  v_AUC: 0.897157
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.174275    reg_loss: 0.017915    l2_loss: 0.019898    loss: 0.212088
steps 5800    v_Prec: 0.766527  v_Recall: 0.645120  v_F1: 0.700602  v_AUC: 0.896694
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.167370    reg_loss: 0.017900    l2_loss: 0.020417    loss: 0.205687
steps 6000    v_Prec: 0.760587  v_Recall: 0.645441  v_F1: 0.698299  v_AUC: 0.896014
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.172920    reg_loss: 0.017863    l2_loss: 0.021234    loss: 0.212016
steps 6200    v_Prec: 0.765773  v_Recall: 0.651873  v_F1: 0.704247  v_AUC: 0.896027
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.183890    reg_loss: 0.017974    l2_loss: 0.021701    loss: 0.223565
steps 6400    v_Prec: 0.757620  v_Recall: 0.663451  v_F1: 0.707415  v_AUC: 0.897766
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.177928    reg_loss: 0.017901    l2_loss: 0.022165    loss: 0.217994
steps 6600    v_Prec: 0.751308  v_Recall: 0.669400  v_F1: 0.707993  v_AUC: 0.897683
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.183779    reg_loss: 0.017862    l2_loss: 0.022568    loss: 0.224209
steps 6800    v_Prec: 0.761765  v_Recall: 0.667631  v_F1: 0.711599  v_AUC: 0.900344
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.171243    reg_loss: 0.017728    l2_loss: 0.022945    loss: 0.211915
steps 7000    v_Prec: 0.752730  v_Recall: 0.681621  v_F1: 0.715413  v_AUC: 0.902633
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.181184    reg_loss: 0.017684    l2_loss: 0.023231    loss: 0.222099
steps 7200    v_Prec: 0.756408  v_Recall: 0.673822  v_F1: 0.712731  v_AUC: 0.902798
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.178416    reg_loss: 0.017684    l2_loss: 0.023459    loss: 0.219560
steps 7400    v_Prec: 0.744047  v_Recall: 0.688294  v_F1: 0.715085  v_AUC: 0.903754
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.185709    reg_loss: 0.017627    l2_loss: 0.023597    loss: 0.226933
steps 7600    v_Prec: 0.743228  v_Recall: 0.694887  v_F1: 0.718245  v_AUC: 0.905417
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.187091    reg_loss: 0.017588    l2_loss: 0.023773    loss: 0.228451
steps 7800    v_Prec: 0.761390  v_Recall: 0.679852  v_F1: 0.718315  v_AUC: 0.906928
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.182017    reg_loss: 0.017615    l2_loss: 0.024132    loss: 0.223764
steps 8000    v_Prec: 0.775327  v_Recall: 0.672536  v_F1: 0.720282  v_AUC: 0.908020
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.177202    reg_loss: 0.017558    l2_loss: 0.024303    loss: 0.219063
steps 8200    v_Prec: 0.778291  v_Recall: 0.677360  v_F1: 0.724326  v_AUC: 0.909330
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.193187    reg_loss: 0.017637    l2_loss: 0.024468    loss: 0.235292
steps 8400    v_Prec: 0.783016  v_Recall: 0.678324  v_F1: 0.726920  v_AUC: 0.911964
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.190436    reg_loss: 0.017609    l2_loss: 0.024549    loss: 0.232594
steps 8600    v_Prec: 0.765554  v_Recall: 0.691510  v_F1: 0.726651  v_AUC: 0.913807
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.179972    reg_loss: 0.017493    l2_loss: 0.024549    loss: 0.222015
steps 8800    v_Prec: 0.768275  v_Recall: 0.696253  v_F1: 0.730493  v_AUC: 0.915556
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.182119    reg_loss: 0.017483    l2_loss: 0.024604    loss: 0.224206
steps 9000    v_Prec: 0.767430  v_Recall: 0.700917  v_F1: 0.732667  v_AUC: 0.915064
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.178954    reg_loss: 0.017349    l2_loss: 0.024746    loss: 0.221049
steps 9200    v_Prec: 0.771132  v_Recall: 0.699711  v_F1: 0.733687  v_AUC: 0.916786
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.193524    reg_loss: 0.017451    l2_loss: 0.024768    loss: 0.235743
steps 9400    v_Prec: 0.760408  v_Recall: 0.707831  v_F1: 0.733178  v_AUC: 0.917507
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.182385    reg_loss: 0.017325    l2_loss: 0.024880    loss: 0.224591
steps 9600    v_Prec: 0.782652  v_Recall: 0.695691  v_F1: 0.736614  v_AUC: 0.917473
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.180836    reg_loss: 0.017316    l2_loss: 0.024894    loss: 0.223047
steps 9800    v_Prec: 0.774319  v_Recall: 0.703972  v_F1: 0.737472  v_AUC: 0.917748
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.183283    reg_loss: 0.017340    l2_loss: 0.025025    loss: 0.225648
steps 10000    v_Prec: 0.782714  v_Recall: 0.699711  v_F1: 0.738889  v_AUC: 0.918823
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.186038    reg_loss: 0.017292    l2_loss: 0.024939    loss: 0.228269
steps 10200    v_Prec: 0.770712  v_Recall: 0.711288  v_F1: 0.739809  v_AUC: 0.919865
steps 10200    running time 372 seconds

steps 10400    base_loss: 0.191816    reg_loss: 0.017371    l2_loss: 0.025018    loss: 0.234206
steps 10400    v_Prec: 0.777552  v_Recall: 0.708474  v_F1: 0.741408  v_AUC: 0.922251
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.187881    reg_loss: 0.017272    l2_loss: 0.025047    loss: 0.230200
steps 10600    v_Prec: 0.788294  v_Recall: 0.703811  v_F1: 0.743661  v_AUC: 0.922758
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.160888    reg_loss: 0.016972    l2_loss: 0.025098    loss: 0.202959
steps 10800    v_Prec: 0.782914  v_Recall: 0.708072  v_F1: 0.743615  v_AUC: 0.923253
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.066638    reg_loss: 0.015791    l2_loss: 0.024998    loss: 0.107427
steps 11000    v_Prec: 0.790778  v_Recall: 0.697701  v_F1: 0.741329  v_AUC: 0.920998
steps 11000    running time 398 seconds

steps 11200    base_loss: 0.067308    reg_loss: 0.015836    l2_loss: 0.024887    loss: 0.108031
steps 11200    v_Prec: 0.775635  v_Recall: 0.704856  v_F1: 0.738554  v_AUC: 0.918205
steps 11200    running time 404 seconds

steps 11400    base_loss: 0.065152    reg_loss: 0.015774    l2_loss: 0.025007    loss: 0.105933
steps 11400    v_Prec: 0.777348  v_Recall: 0.694163  v_F1: 0.733404  v_AUC: 0.915308
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.065698    reg_loss: 0.015897    l2_loss: 0.024947    loss: 0.106542
steps 11600    v_Prec: 0.796012  v_Recall: 0.683631  v_F1: 0.735554  v_AUC: 0.915993
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.071712    reg_loss: 0.015870    l2_loss: 0.024951    loss: 0.112534
steps 11800    v_Prec: 0.771682  v_Recall: 0.698907  v_F1: 0.733494  v_AUC: 0.914668
steps 11800    running time 423 seconds

steps 12000    base_loss: 0.068397    reg_loss: 0.015889    l2_loss: 0.024882    loss: 0.109167
steps 12000    v_Prec: 0.786417  v_Recall: 0.687972  v_F1: 0.733908  v_AUC: 0.915123
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.064923    reg_loss: 0.015866    l2_loss: 0.024980    loss: 0.105769
steps 12200    v_Prec: 0.766568  v_Recall: 0.706786  v_F1: 0.735464  v_AUC: 0.914388
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.073645    reg_loss: 0.015965    l2_loss: 0.024933    loss: 0.114544
steps 12400    v_Prec: 0.762442  v_Recall: 0.711931  v_F1: 0.736321  v_AUC: 0.916012
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.074183    reg_loss: 0.015939    l2_loss: 0.024799    loss: 0.114922
steps 12600    v_Prec: 0.774231  v_Recall: 0.698103  v_F1: 0.734199  v_AUC: 0.914512
steps 12600    running time 448 seconds

Early stop model F1: 0.743661
testing thre: 0.4186285
testing Prec: 0.5960544856740254
testing Recall: 0.7401215066828676
testing F1: 0.6603213147453548
testing AUC: 0.9017149067877556
overall running time 451 seconds
(0.7092717322668912, 0.6551154313487242, 0.6811187751080118, 0.9017149067877556, 0.6534728)

2019-02-24 16:40:07.903151: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:40:08.578237: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:40:08.579975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:40:08.580011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.260000 seconds
loading data in 30.270000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.034095    reg_loss: 0.021599    l2_loss: 0.013416    loss: 1.069110
steps 200    v_Prec: 0.162445  v_Recall: 0.999920  v_F1: 0.279485  v_AUC: 0.493121
steps 200    running time 40 seconds

steps 400    base_loss: 0.688749    reg_loss: 0.021749    l2_loss: 0.013636    loss: 0.724134
steps 400    v_Prec: 0.162913  v_Recall: 0.993654  v_F1: 0.279931  v_AUC: 0.499063
steps 400    running time 47 seconds

steps 600    base_loss: 0.518964    reg_loss: 0.021721    l2_loss: 0.013760    loss: 0.554445
steps 600    v_Prec: 0.162830  v_Recall: 0.995020  v_F1: 0.279863  v_AUC: 0.485658
steps 600    running time 54 seconds

steps 800    base_loss: 0.477806    reg_loss: 0.021582    l2_loss: 0.013348    loss: 0.512736
steps 800    v_Prec: 0.163187  v_Recall: 0.989477  v_F1: 0.280168  v_AUC: 0.521949
steps 800    running time 60 seconds

steps 1000    base_loss: 0.468524    reg_loss: 0.021435    l2_loss: 0.012825    loss: 0.502784
steps 1000    v_Prec: 0.171518  v_Recall: 0.817013  v_F1: 0.283516  v_AUC: 0.560311
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.461940    reg_loss: 0.021270    l2_loss: 0.012300    loss: 0.495510
steps 1200    v_Prec: 0.278118  v_Recall: 0.441160  v_F1: 0.341160  v_AUC: 0.656137
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.439313    reg_loss: 0.021153    l2_loss: 0.011980    loss: 0.472446
steps 1400    v_Prec: 0.339383  v_Recall: 0.462688  v_F1: 0.391557  v_AUC: 0.702405
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.426293    reg_loss: 0.021114    l2_loss: 0.011799    loss: 0.459206
steps 1600    v_Prec: 0.376785  v_Recall: 0.493855  v_F1: 0.427449  v_AUC: 0.738957
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.398776    reg_loss: 0.021168    l2_loss: 0.011834    loss: 0.431778
steps 1800    v_Prec: 0.437138  v_Recall: 0.508876  v_F1: 0.470287  v_AUC: 0.774740
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.382491    reg_loss: 0.021398    l2_loss: 0.012006    loss: 0.415895
steps 2000    v_Prec: 0.481692  v_Recall: 0.524138  v_F1: 0.502020  v_AUC: 0.796375
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.362623    reg_loss: 0.021630    l2_loss: 0.012297    loss: 0.396550
steps 2200    v_Prec: 0.525165  v_Recall: 0.561571  v_F1: 0.542758  v_AUC: 0.822282
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.344093    reg_loss: 0.021939    l2_loss: 0.012664    loss: 0.378696
steps 2400    v_Prec: 0.537308  v_Recall: 0.584224  v_F1: 0.559784  v_AUC: 0.837155
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.326670    reg_loss: 0.022139    l2_loss: 0.013028    loss: 0.361837
steps 2600    v_Prec: 0.571305  v_Recall: 0.583099  v_F1: 0.577142  v_AUC: 0.846671
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.326618    reg_loss: 0.022338    l2_loss: 0.013444    loss: 0.362401
steps 2800    v_Prec: 0.584726  v_Recall: 0.595951  v_F1: 0.590285  v_AUC: 0.856528
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.319722    reg_loss: 0.022508    l2_loss: 0.013901    loss: 0.356131
steps 3000    v_Prec: 0.590280  v_Recall: 0.623424  v_F1: 0.606399  v_AUC: 0.864819
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.308711    reg_loss: 0.022631    l2_loss: 0.014385    loss: 0.345727
steps 3200    v_Prec: 0.622900  v_Recall: 0.595630  v_F1: 0.608960  v_AUC: 0.868862
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.299897    reg_loss: 0.022705    l2_loss: 0.014839    loss: 0.337441
steps 3400    v_Prec: 0.622779  v_Recall: 0.616676  v_F1: 0.619713  v_AUC: 0.874472
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.293463    reg_loss: 0.022770    l2_loss: 0.015372    loss: 0.331605
steps 3600    v_Prec: 0.635268  v_Recall: 0.626797  v_F1: 0.631004  v_AUC: 0.877248
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.295674    reg_loss: 0.022756    l2_loss: 0.015883    loss: 0.334312
steps 3800    v_Prec: 0.640530  v_Recall: 0.628645  v_F1: 0.634532  v_AUC: 0.880687
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.293812    reg_loss: 0.022892    l2_loss: 0.016397    loss: 0.333100
steps 4000    v_Prec: 0.624739  v_Recall: 0.649128  v_F1: 0.636700  v_AUC: 0.883747
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.281337    reg_loss: 0.022895    l2_loss: 0.017035    loss: 0.321267
steps 4200    v_Prec: 0.676160  v_Recall: 0.612178  v_F1: 0.642580  v_AUC: 0.886092
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.281837    reg_loss: 0.022950    l2_loss: 0.017629    loss: 0.322415
steps 4400    v_Prec: 0.661901  v_Recall: 0.632179  v_F1: 0.646699  v_AUC: 0.887754
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.276887    reg_loss: 0.022931    l2_loss: 0.018228    loss: 0.318046
steps 4600    v_Prec: 0.676086  v_Recall: 0.622701  v_F1: 0.648296  v_AUC: 0.890458
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.276273    reg_loss: 0.022961    l2_loss: 0.018886    loss: 0.318121
steps 4800    v_Prec: 0.681449  v_Recall: 0.633224  v_F1: 0.656452  v_AUC: 0.893220
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.279358    reg_loss: 0.023042    l2_loss: 0.019549    loss: 0.321948
steps 5000    v_Prec: 0.652451  v_Recall: 0.657483  v_F1: 0.654957  v_AUC: 0.893758
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.274287    reg_loss: 0.022997    l2_loss: 0.020290    loss: 0.317574
steps 5200    v_Prec: 0.664122  v_Recall: 0.642783  v_F1: 0.653278  v_AUC: 0.894776
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.271792    reg_loss: 0.023033    l2_loss: 0.020982    loss: 0.315808
steps 5400    v_Prec: 0.686558  v_Recall: 0.633063  v_F1: 0.658726  v_AUC: 0.896606
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.176915    reg_loss: 0.023647    l2_loss: 0.021905    loss: 0.222467
steps 5600    v_Prec: 0.646564  v_Recall: 0.654510  v_F1: 0.650513  v_AUC: 0.891494
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.171415    reg_loss: 0.023649    l2_loss: 0.022710    loss: 0.217773
steps 5800    v_Prec: 0.655127  v_Recall: 0.641497  v_F1: 0.648241  v_AUC: 0.888334
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.191814    reg_loss: 0.023562    l2_loss: 0.023415    loss: 0.238791
steps 6000    v_Prec: 0.660195  v_Recall: 0.641899  v_F1: 0.650918  v_AUC: 0.890048
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.178427    reg_loss: 0.023520    l2_loss: 0.024151    loss: 0.226098
steps 6200    v_Prec: 0.662866  v_Recall: 0.639810  v_F1: 0.651134  v_AUC: 0.890301
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.193089    reg_loss: 0.023487    l2_loss: 0.024611    loss: 0.241186
steps 6400    v_Prec: 0.677364  v_Recall: 0.634107  v_F1: 0.655022  v_AUC: 0.891452
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.200793    reg_loss: 0.023521    l2_loss: 0.025208    loss: 0.249522
steps 6600    v_Prec: 0.635434  v_Recall: 0.678769  v_F1: 0.656387  v_AUC: 0.893252
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.196267    reg_loss: 0.023578    l2_loss: 0.025656    loss: 0.245500
steps 6800    v_Prec: 0.661339  v_Recall: 0.651458  v_F1: 0.656361  v_AUC: 0.892242
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.196354    reg_loss: 0.023523    l2_loss: 0.026088    loss: 0.245965
steps 7000    v_Prec: 0.685392  v_Recall: 0.635071  v_F1: 0.659273  v_AUC: 0.893970
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.200849    reg_loss: 0.023558    l2_loss: 0.026570    loss: 0.250977
steps 7200    v_Prec: 0.667261  v_Recall: 0.661579  v_F1: 0.664408  v_AUC: 0.895732
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.195584    reg_loss: 0.023547    l2_loss: 0.026916    loss: 0.246048
steps 7400    v_Prec: 0.659997  v_Recall: 0.672986  v_F1: 0.666428  v_AUC: 0.896159
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.199845    reg_loss: 0.023581    l2_loss: 0.027348    loss: 0.250774
steps 7600    v_Prec: 0.680312  v_Recall: 0.651458  v_F1: 0.665572  v_AUC: 0.895405
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.195149    reg_loss: 0.023540    l2_loss: 0.027689    loss: 0.246377
steps 7800    v_Prec: 0.671519  v_Recall: 0.670656  v_F1: 0.671088  v_AUC: 0.898681
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.191533    reg_loss: 0.023569    l2_loss: 0.027926    loss: 0.243028
steps 8000    v_Prec: 0.683747  v_Recall: 0.661338  v_F1: 0.672356  v_AUC: 0.899525
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.191374    reg_loss: 0.023578    l2_loss: 0.028230    loss: 0.243183
steps 8200    v_Prec: 0.689588  v_Recall: 0.658125  v_F1: 0.673490  v_AUC: 0.900883
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.199888    reg_loss: 0.023611    l2_loss: 0.028569    loss: 0.252069
steps 8400    v_Prec: 0.694747  v_Recall: 0.665114  v_F1: 0.679608  v_AUC: 0.902670
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.198217    reg_loss: 0.023577    l2_loss: 0.028881    loss: 0.250676
steps 8600    v_Prec: 0.691901  v_Recall: 0.673227  v_F1: 0.682436  v_AUC: 0.903403
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.199195    reg_loss: 0.023574    l2_loss: 0.029009    loss: 0.251778
steps 8800    v_Prec: 0.702030  v_Recall: 0.672423  v_F1: 0.686908  v_AUC: 0.905222
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.201658    reg_loss: 0.023611    l2_loss: 0.029315    loss: 0.254583
steps 9000    v_Prec: 0.699506  v_Recall: 0.682705  v_F1: 0.691004  v_AUC: 0.905568
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.195186    reg_loss: 0.023556    l2_loss: 0.029640    loss: 0.248382
steps 9200    v_Prec: 0.695793  v_Recall: 0.690819  v_F1: 0.693297  v_AUC: 0.907855
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.193696    reg_loss: 0.023547    l2_loss: 0.029779    loss: 0.247021
steps 9400    v_Prec: 0.721438  v_Recall: 0.677163  v_F1: 0.698599  v_AUC: 0.911095
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.192788    reg_loss: 0.023577    l2_loss: 0.029935    loss: 0.246300
steps 9600    v_Prec: 0.713003  v_Recall: 0.688891  v_F1: 0.700739  v_AUC: 0.911358
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.201316    reg_loss: 0.023518    l2_loss: 0.030151    loss: 0.254985
steps 9800    v_Prec: 0.730686  v_Recall: 0.681501  v_F1: 0.705237  v_AUC: 0.913979
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.193168    reg_loss: 0.023574    l2_loss: 0.030311    loss: 0.247053
steps 10000    v_Prec: 0.716475  v_Recall: 0.690979  v_F1: 0.703496  v_AUC: 0.913756
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.192953    reg_loss: 0.023496    l2_loss: 0.030522    loss: 0.246971
steps 10200    v_Prec: 0.703366  v_Recall: 0.711784  v_F1: 0.707550  v_AUC: 0.916386
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.184742    reg_loss: 0.023513    l2_loss: 0.030883    loss: 0.239138
steps 10400    v_Prec: 0.711109  v_Recall: 0.701341  v_F1: 0.706192  v_AUC: 0.914858
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.193193    reg_loss: 0.023515    l2_loss: 0.030950    loss: 0.247657
steps 10600    v_Prec: 0.752433  v_Recall: 0.677002  v_F1: 0.712727  v_AUC: 0.918114
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.180529    reg_loss: 0.023604    l2_loss: 0.030978    loss: 0.235111
steps 10800    v_Prec: 0.739555  v_Recall: 0.688168  v_F1: 0.712936  v_AUC: 0.918794
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.080274    reg_loss: 0.023811    l2_loss: 0.031438    loss: 0.135523
steps 11000    v_Prec: 0.692449  v_Recall: 0.697566  v_F1: 0.694998  v_AUC: 0.910069
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.086814    reg_loss: 0.023807    l2_loss: 0.031414    loss: 0.142036
steps 11200    v_Prec: 0.715789  v_Recall: 0.671861  v_F1: 0.693130  v_AUC: 0.906532
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.081231    reg_loss: 0.023749    l2_loss: 0.031659    loss: 0.136639
steps 11400    v_Prec: 0.707303  v_Recall: 0.670656  v_F1: 0.688492  v_AUC: 0.903986
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.083986    reg_loss: 0.023707    l2_loss: 0.031666    loss: 0.139359
steps 11600    v_Prec: 0.701307  v_Recall: 0.667845  v_F1: 0.684167  v_AUC: 0.901355
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.084023    reg_loss: 0.023668    l2_loss: 0.031694    loss: 0.139385
steps 11800    v_Prec: 0.700661  v_Recall: 0.672183  v_F1: 0.686127  v_AUC: 0.902452
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.082669    reg_loss: 0.023595    l2_loss: 0.031827    loss: 0.138091
steps 12000    v_Prec: 0.692405  v_Recall: 0.662704  v_F1: 0.677229  v_AUC: 0.898250
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.085256    reg_loss: 0.023748    l2_loss: 0.031964    loss: 0.140968
steps 12200    v_Prec: 0.696125  v_Recall: 0.652342  v_F1: 0.673523  v_AUC: 0.896431
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.089053    reg_loss: 0.023636    l2_loss: 0.031977    loss: 0.144667
steps 12400    v_Prec: 0.699054  v_Recall: 0.640935  v_F1: 0.668734  v_AUC: 0.894198
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.089648    reg_loss: 0.023627    l2_loss: 0.032059    loss: 0.145334
steps 12600    v_Prec: 0.671133  v_Recall: 0.667845  v_F1: 0.669485  v_AUC: 0.894536
steps 12600    running time 444 seconds

steps 12800    base_loss: 0.097092    reg_loss: 0.023653    l2_loss: 0.032227    loss: 0.152973
steps 12800    v_Prec: 0.679844  v_Recall: 0.658928  v_F1: 0.669223  v_AUC: 0.894728
steps 12800    running time 450 seconds

Early stop model F1: 0.712936
testing thre: 0.3710098
testing Prec: 0.5307924861578178
testing Recall: 0.7594653705953828
testing F1: 0.6248650377894189
testing AUC: 0.9001642469339186
overall running time 453 seconds
(0.6808554709750919, 0.6390279465370595, 0.6592789449932307, 0.9001642469339186, 0.6883549)

2019-02-24 16:45:04.229924: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:45:05.243925: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:45:05.255285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:45:05.255363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.770000 seconds
loading data in 31.010000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.717003    reg_loss: 0.021580    l2_loss: 0.013314    loss: 0.751897
steps 200    v_Prec: 0.164216  v_Recall: 0.994910  v_F1: 0.281903  v_AUC: 0.499542
steps 200    running time 41 seconds

steps 400    base_loss: 0.537432    reg_loss: 0.021614    l2_loss: 0.013415    loss: 0.572461
steps 400    v_Prec: 0.164350  v_Recall: 0.990138  v_F1: 0.281907  v_AUC: 0.504665
steps 400    running time 48 seconds

steps 600    base_loss: 0.494973    reg_loss: 0.021568    l2_loss: 0.013397    loss: 0.529938
steps 600    v_Prec: 0.164152  v_Recall: 0.999284  v_F1: 0.281983  v_AUC: 0.517679
steps 600    running time 54 seconds

steps 800    base_loss: 0.484079    reg_loss: 0.021583    l2_loss: 0.013210    loss: 0.518872
steps 800    v_Prec: 0.164824  v_Recall: 0.981947  v_F1: 0.282269  v_AUC: 0.537662
steps 800    running time 61 seconds

steps 1000    base_loss: 0.460226    reg_loss: 0.021516    l2_loss: 0.013019    loss: 0.494762
steps 1000    v_Prec: 0.169170  v_Recall: 0.893829  v_F1: 0.284496  v_AUC: 0.551839
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.452150    reg_loss: 0.021488    l2_loss: 0.012936    loss: 0.486574
steps 1200    v_Prec: 0.198880  v_Recall: 0.578972  v_F1: 0.296061  v_AUC: 0.586435
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.448248    reg_loss: 0.021463    l2_loss: 0.012918    loss: 0.482629
steps 1400    v_Prec: 0.262510  v_Recall: 0.468109  v_F1: 0.336381  v_AUC: 0.636634
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.424058    reg_loss: 0.021305    l2_loss: 0.012952    loss: 0.458314
steps 1600    v_Prec: 0.364537  v_Recall: 0.397964  v_F1: 0.380518  v_AUC: 0.680421
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.406593    reg_loss: 0.021217    l2_loss: 0.013014    loss: 0.440823
steps 1800    v_Prec: 0.417003  v_Recall: 0.452521  v_F1: 0.434036  v_AUC: 0.722601
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.392284    reg_loss: 0.021098    l2_loss: 0.013203    loss: 0.426586
steps 2000    v_Prec: 0.472297  v_Recall: 0.477255  v_F1: 0.474763  v_AUC: 0.758665
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.371886    reg_loss: 0.020979    l2_loss: 0.013412    loss: 0.406278
steps 2200    v_Prec: 0.528354  v_Recall: 0.514236  v_F1: 0.521199  v_AUC: 0.788010
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.355363    reg_loss: 0.020785    l2_loss: 0.013594    loss: 0.389742
steps 2400    v_Prec: 0.559058  v_Recall: 0.528869  v_F1: 0.543545  v_AUC: 0.804038
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.350624    reg_loss: 0.020657    l2_loss: 0.013782    loss: 0.385063
steps 2600    v_Prec: 0.599072  v_Recall: 0.544377  v_F1: 0.570417  v_AUC: 0.823603
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.332850    reg_loss: 0.020418    l2_loss: 0.013986    loss: 0.367254
steps 2800    v_Prec: 0.623989  v_Recall: 0.570542  v_F1: 0.596070  v_AUC: 0.841615
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.327712    reg_loss: 0.020295    l2_loss: 0.014220    loss: 0.362227
steps 3000    v_Prec: 0.621206  v_Recall: 0.607126  v_F1: 0.614085  v_AUC: 0.851810
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.311136    reg_loss: 0.020101    l2_loss: 0.014485    loss: 0.345722
steps 3200    v_Prec: 0.636149  v_Recall: 0.622793  v_F1: 0.629400  v_AUC: 0.860545
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.287796    reg_loss: 0.019954    l2_loss: 0.014798    loss: 0.322547
steps 3400    v_Prec: 0.671292  v_Recall: 0.615556  v_F1: 0.642217  v_AUC: 0.866365
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.290252    reg_loss: 0.019917    l2_loss: 0.015127    loss: 0.325296
steps 3600    v_Prec: 0.687173  v_Recall: 0.627167  v_F1: 0.655800  v_AUC: 0.873269
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.294648    reg_loss: 0.019831    l2_loss: 0.015449    loss: 0.329928
steps 3800    v_Prec: 0.728042  v_Recall: 0.609114  v_F1: 0.663289  v_AUC: 0.879559
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.285177    reg_loss: 0.019757    l2_loss: 0.015807    loss: 0.320740
steps 4000    v_Prec: 0.717024  v_Recall: 0.624702  v_F1: 0.667687  v_AUC: 0.883967
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.280125    reg_loss: 0.019617    l2_loss: 0.016180    loss: 0.315923
steps 4200    v_Prec: 0.702248  v_Recall: 0.650867  v_F1: 0.675582  v_AUC: 0.887729
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.275032    reg_loss: 0.019547    l2_loss: 0.016504    loss: 0.311083
steps 4400    v_Prec: 0.720287  v_Recall: 0.639574  v_F1: 0.677535  v_AUC: 0.889711
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.271497    reg_loss: 0.019479    l2_loss: 0.017021    loss: 0.307997
steps 4600    v_Prec: 0.722717  v_Recall: 0.645697  v_F1: 0.682040  v_AUC: 0.890024
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.269678    reg_loss: 0.019411    l2_loss: 0.017554    loss: 0.306643
steps 4800    v_Prec: 0.746764  v_Recall: 0.633211  v_F1: 0.685316  v_AUC: 0.893239
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.270072    reg_loss: 0.019374    l2_loss: 0.018022    loss: 0.307468
steps 5000    v_Prec: 0.722679  v_Recall: 0.657388  v_F1: 0.688489  v_AUC: 0.895375
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.267112    reg_loss: 0.019238    l2_loss: 0.018473    loss: 0.304822
steps 5200    v_Prec: 0.741398  v_Recall: 0.644345  v_F1: 0.689473  v_AUC: 0.896896
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.264217    reg_loss: 0.019110    l2_loss: 0.018925    loss: 0.302252
steps 5400    v_Prec: 0.712819  v_Recall: 0.673533  v_F1: 0.692619  v_AUC: 0.897652
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.180063    reg_loss: 0.018020    l2_loss: 0.019375    loss: 0.217458
steps 5600    v_Prec: 0.729207  v_Recall: 0.662399  v_F1: 0.694199  v_AUC: 0.896750
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.180876    reg_loss: 0.017940    l2_loss: 0.020010    loss: 0.218826
steps 5800    v_Prec: 0.744671  v_Recall: 0.650151  v_F1: 0.694209  v_AUC: 0.894898
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.182166    reg_loss: 0.018019    l2_loss: 0.020642    loss: 0.220828
steps 6000    v_Prec: 0.725827  v_Recall: 0.668045  v_F1: 0.695739  v_AUC: 0.892895
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.190462    reg_loss: 0.018082    l2_loss: 0.021192    loss: 0.229736
steps 6200    v_Prec: 0.749038  v_Recall: 0.649913  v_F1: 0.695963  v_AUC: 0.896101
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.192097    reg_loss: 0.018017    l2_loss: 0.021636    loss: 0.231750
steps 6400    v_Prec: 0.736602  v_Recall: 0.667886  v_F1: 0.700563  v_AUC: 0.896117
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.186764    reg_loss: 0.017913    l2_loss: 0.021943    loss: 0.226620
steps 6600    v_Prec: 0.735731  v_Recall: 0.673533  v_F1: 0.703259  v_AUC: 0.895592
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.197454    reg_loss: 0.017885    l2_loss: 0.022399    loss: 0.237739
steps 6800    v_Prec: 0.755590  v_Recall: 0.663830  v_F1: 0.706744  v_AUC: 0.899150
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.188206    reg_loss: 0.017726    l2_loss: 0.022699    loss: 0.228631
steps 7000    v_Prec: 0.738479  v_Recall: 0.677986  v_F1: 0.706941  v_AUC: 0.899122
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.192343    reg_loss: 0.017756    l2_loss: 0.022933    loss: 0.233032
steps 7200    v_Prec: 0.733652  v_Recall: 0.684349  v_F1: 0.708143  v_AUC: 0.899258
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.194168    reg_loss: 0.017727    l2_loss: 0.023215    loss: 0.235110
steps 7400    v_Prec: 0.739832  v_Recall: 0.685701  v_F1: 0.711738  v_AUC: 0.901910
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.189227    reg_loss: 0.017622    l2_loss: 0.023489    loss: 0.230339
steps 7600    v_Prec: 0.760362  v_Recall: 0.674010  v_F1: 0.714587  v_AUC: 0.903191
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.195224    reg_loss: 0.017618    l2_loss: 0.023614    loss: 0.236457
steps 7800    v_Prec: 0.743268  v_Recall: 0.691427  v_F1: 0.716411  v_AUC: 0.903883
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.184489    reg_loss: 0.017596    l2_loss: 0.023860    loss: 0.225946
steps 8000    v_Prec: 0.743800  v_Recall: 0.694051  v_F1: 0.718065  v_AUC: 0.905376
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.194930    reg_loss: 0.017649    l2_loss: 0.024077    loss: 0.236656
steps 8200    v_Prec: 0.771506  v_Recall: 0.676157  v_F1: 0.720692  v_AUC: 0.907273
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.196433    reg_loss: 0.017653    l2_loss: 0.024336    loss: 0.238421
steps 8400    v_Prec: 0.760039  v_Recall: 0.684905  v_F1: 0.720519  v_AUC: 0.907946
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.185299    reg_loss: 0.017496    l2_loss: 0.024321    loss: 0.227115
steps 8600    v_Prec: 0.782177  v_Recall: 0.677111  v_F1: 0.725862  v_AUC: 0.911222
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.188615    reg_loss: 0.017539    l2_loss: 0.024454    loss: 0.230608
steps 8800    v_Prec: 0.769476  v_Recall: 0.692063  v_F1: 0.728719  v_AUC: 0.912344
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.195709    reg_loss: 0.017445    l2_loss: 0.024586    loss: 0.237740
steps 9000    v_Prec: 0.778209  v_Recall: 0.686178  v_F1: 0.729301  v_AUC: 0.912738
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.191509    reg_loss: 0.017498    l2_loss: 0.024660    loss: 0.233667
steps 9200    v_Prec: 0.750189  v_Recall: 0.710752  v_F1: 0.729938  v_AUC: 0.912553
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.185592    reg_loss: 0.017370    l2_loss: 0.024741    loss: 0.227703
steps 9400    v_Prec: 0.779393  v_Recall: 0.690631  v_F1: 0.732333  v_AUC: 0.915447
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.186144    reg_loss: 0.017383    l2_loss: 0.024856    loss: 0.228383
steps 9600    v_Prec: 0.768334  v_Recall: 0.702402  v_F1: 0.733890  v_AUC: 0.915736
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.186265    reg_loss: 0.017343    l2_loss: 0.024842    loss: 0.228450
steps 9800    v_Prec: 0.767036  v_Recall: 0.709878  v_F1: 0.737351  v_AUC: 0.918257
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.191331    reg_loss: 0.017341    l2_loss: 0.024920    loss: 0.233592
steps 10000    v_Prec: 0.754101  v_Recall: 0.716558  v_F1: 0.734850  v_AUC: 0.917124
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.188316    reg_loss: 0.017239    l2_loss: 0.024924    loss: 0.230478
steps 10200    v_Prec: 0.781324  v_Recall: 0.704708  v_F1: 0.741041  v_AUC: 0.919568
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.192877    reg_loss: 0.017259    l2_loss: 0.025059    loss: 0.235195
steps 10400    v_Prec: 0.778834  v_Recall: 0.703515  v_F1: 0.739261  v_AUC: 0.919437
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.189121    reg_loss: 0.017180    l2_loss: 0.025025    loss: 0.231326
steps 10600    v_Prec: 0.773569  v_Recall: 0.711309  v_F1: 0.741134  v_AUC: 0.920931
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.176931    reg_loss: 0.017064    l2_loss: 0.025169    loss: 0.219164
steps 10800    v_Prec: 0.772941  v_Recall: 0.707412  v_F1: 0.738726  v_AUC: 0.921512
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.072484    reg_loss: 0.015740    l2_loss: 0.025063    loss: 0.113287
steps 11000    v_Prec: 0.763156  v_Recall: 0.711627  v_F1: 0.736491  v_AUC: 0.919358
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.071995    reg_loss: 0.015777    l2_loss: 0.025078    loss: 0.112851
steps 11200    v_Prec: 0.762795  v_Recall: 0.707651  v_F1: 0.734189  v_AUC: 0.916281
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.071907    reg_loss: 0.015797    l2_loss: 0.024939    loss: 0.112643
steps 11400    v_Prec: 0.774304  v_Recall: 0.701209  v_F1: 0.735946  v_AUC: 0.914003
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.072810    reg_loss: 0.015880    l2_loss: 0.024929    loss: 0.113619
steps 11600    v_Prec: 0.790903  v_Recall: 0.690075  v_F1: 0.737057  v_AUC: 0.914910
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.073039    reg_loss: 0.015886    l2_loss: 0.025037    loss: 0.113962
steps 11800    v_Prec: 0.781841  v_Recall: 0.690313  v_F1: 0.733232  v_AUC: 0.912451
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.073496    reg_loss: 0.015844    l2_loss: 0.025097    loss: 0.114437
steps 12000    v_Prec: 0.787614  v_Recall: 0.680690  v_F1: 0.730259  v_AUC: 0.912342
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.074841    reg_loss: 0.015928    l2_loss: 0.025103    loss: 0.115873
steps 12200    v_Prec: 0.786384  v_Recall: 0.687132  v_F1: 0.733415  v_AUC: 0.912290
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.075684    reg_loss: 0.015932    l2_loss: 0.025101    loss: 0.116718
steps 12400    v_Prec: 0.769708  v_Recall: 0.701209  v_F1: 0.733863  v_AUC: 0.912279
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.077501    reg_loss: 0.015886    l2_loss: 0.025099    loss: 0.118486
steps 12600    v_Prec: 0.782671  v_Recall: 0.689677  v_F1: 0.733238  v_AUC: 0.912863
steps 12600    running time 445 seconds

Early stop model F1: 0.741134
testing thre: 0.48532715
testing Prec: 0.5787422430755259
testing Recall: 0.7433778857837181
testing F1: 0.6508095227964171
testing AUC: 0.8992924463204278
overall running time 447 seconds
(0.6922919543757352, 0.6578371810449575, 0.6746249314658824, 0.8992924463204278, 0.7141015)

2019-02-24 16:50:00.360027: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:50:00.960602: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:50:00.968761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:50:00.968830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.460000 seconds
loading data in 30.510000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.635983    reg_loss: 0.021558    l2_loss: 0.013318    loss: 0.670859
steps 200    v_Prec: 0.165207  v_Recall: 0.992797  v_F1: 0.283275  v_AUC: 0.535296
steps 200    running time 41 seconds

steps 400    base_loss: 0.498490    reg_loss: 0.021478    l2_loss: 0.013337    loss: 0.533305
steps 400    v_Prec: 0.168409  v_Recall: 0.930742  v_F1: 0.285212  v_AUC: 0.549392
steps 400    running time 47 seconds

steps 600    base_loss: 0.464841    reg_loss: 0.021383    l2_loss: 0.013293    loss: 0.499518
steps 600    v_Prec: 0.184748  v_Recall: 0.697404  v_F1: 0.292113  v_AUC: 0.568549
steps 600    running time 54 seconds

steps 800    base_loss: 0.464507    reg_loss: 0.021341    l2_loss: 0.013151    loss: 0.498999
steps 800    v_Prec: 0.199491  v_Recall: 0.657907  v_F1: 0.306151  v_AUC: 0.606026
steps 800    running time 60 seconds

steps 1000    base_loss: 0.446245    reg_loss: 0.021140    l2_loss: 0.013017    loss: 0.480402
steps 1000    v_Prec: 0.259000  v_Recall: 0.463511  v_F1: 0.332312  v_AUC: 0.645918
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.438250    reg_loss: 0.020970    l2_loss: 0.012913    loss: 0.472132
steps 1200    v_Prec: 0.346156  v_Recall: 0.457258  v_F1: 0.394025  v_AUC: 0.703734
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.424410    reg_loss: 0.020725    l2_loss: 0.012971    loss: 0.458106
steps 1400    v_Prec: 0.448694  v_Recall: 0.471743  v_F1: 0.459930  v_AUC: 0.753395
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.398714    reg_loss: 0.020425    l2_loss: 0.013132    loss: 0.432271
steps 1600    v_Prec: 0.536825  v_Recall: 0.489235  v_F1: 0.511926  v_AUC: 0.792928
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.372916    reg_loss: 0.020207    l2_loss: 0.013390    loss: 0.406513
steps 1800    v_Prec: 0.618767  v_Recall: 0.506807  v_F1: 0.557219  v_AUC: 0.821737
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.340786    reg_loss: 0.019955    l2_loss: 0.013706    loss: 0.374447
steps 2000    v_Prec: 0.652140  v_Recall: 0.525883  v_F1: 0.582245  v_AUC: 0.837652
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.334847    reg_loss: 0.019834    l2_loss: 0.013992    loss: 0.368673
steps 2200    v_Prec: 0.653544  v_Recall: 0.559759  v_F1: 0.603027  v_AUC: 0.851186
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.322363    reg_loss: 0.019661    l2_loss: 0.014424    loss: 0.356448
steps 2400    v_Prec: 0.675513  v_Recall: 0.570128  v_F1: 0.618363  v_AUC: 0.859924
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.320915    reg_loss: 0.019580    l2_loss: 0.014784    loss: 0.355279
steps 2600    v_Prec: 0.684485  v_Recall: 0.592924  v_F1: 0.635423  v_AUC: 0.867174
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.298085    reg_loss: 0.019363    l2_loss: 0.015133    loss: 0.332581
steps 2800    v_Prec: 0.704750  v_Recall: 0.602501  v_F1: 0.649627  v_AUC: 0.873409
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.297241    reg_loss: 0.019304    l2_loss: 0.015427    loss: 0.331973
steps 3000    v_Prec: 0.703971  v_Recall: 0.617382  v_F1: 0.657839  v_AUC: 0.877736
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.295379    reg_loss: 0.019250    l2_loss: 0.015763    loss: 0.330391
steps 3200    v_Prec: 0.716509  v_Recall: 0.623160  v_F1: 0.666582  v_AUC: 0.882489
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.284057    reg_loss: 0.019114    l2_loss: 0.016131    loss: 0.319302
steps 3400    v_Prec: 0.700992  v_Recall: 0.643343  v_F1: 0.670932  v_AUC: 0.883365
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.279907    reg_loss: 0.019037    l2_loss: 0.016485    loss: 0.315430
steps 3600    v_Prec: 0.722555  v_Recall: 0.640256  v_F1: 0.678921  v_AUC: 0.886890
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.281120    reg_loss: 0.019024    l2_loss: 0.016836    loss: 0.316980
steps 3800    v_Prec: 0.726565  v_Recall: 0.642948  v_F1: 0.682204  v_AUC: 0.889001
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.275153    reg_loss: 0.018932    l2_loss: 0.017143    loss: 0.311227
steps 4000    v_Prec: 0.734306  v_Recall: 0.649042  v_F1: 0.689047  v_AUC: 0.891008
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.273392    reg_loss: 0.018934    l2_loss: 0.017427    loss: 0.309754
steps 4200    v_Prec: 0.759720  v_Recall: 0.635666  v_F1: 0.692178  v_AUC: 0.893646
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.267034    reg_loss: 0.018891    l2_loss: 0.017704    loss: 0.303629
steps 4400    v_Prec: 0.717460  v_Recall: 0.669701  v_F1: 0.692758  v_AUC: 0.895378
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.272168    reg_loss: 0.018862    l2_loss: 0.018067    loss: 0.309097
steps 4600    v_Prec: 0.746269  v_Recall: 0.660915  v_F1: 0.701003  v_AUC: 0.897440
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.268791    reg_loss: 0.018864    l2_loss: 0.018539    loss: 0.306195
steps 4800    v_Prec: 0.760133  v_Recall: 0.650150  v_F1: 0.700853  v_AUC: 0.899889
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.267280    reg_loss: 0.018828    l2_loss: 0.018856    loss: 0.304964
steps 5000    v_Prec: 0.758826  v_Recall: 0.654979  v_F1: 0.703088  v_AUC: 0.901409
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.265852    reg_loss: 0.018790    l2_loss: 0.019179    loss: 0.303821
steps 5200    v_Prec: 0.776005  v_Recall: 0.650704  v_F1: 0.707853  v_AUC: 0.903099
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.261743    reg_loss: 0.018683    l2_loss: 0.019599    loss: 0.300025
steps 5400    v_Prec: 0.773844  v_Recall: 0.660836  v_F1: 0.712889  v_AUC: 0.905783
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.177595    reg_loss: 0.017728    l2_loss: 0.020074    loss: 0.215396
steps 5600    v_Prec: 0.758221  v_Recall: 0.667959  v_F1: 0.710234  v_AUC: 0.900908
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.173554    reg_loss: 0.017582    l2_loss: 0.020708    loss: 0.211844
steps 5800    v_Prec: 0.752240  v_Recall: 0.664477  v_F1: 0.705640  v_AUC: 0.897058
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.170339    reg_loss: 0.017641    l2_loss: 0.021331    loss: 0.209311
steps 6000    v_Prec: 0.767081  v_Recall: 0.649596  v_F1: 0.703467  v_AUC: 0.896492
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.181432    reg_loss: 0.017714    l2_loss: 0.021960    loss: 0.221106
steps 6200    v_Prec: 0.752173  v_Recall: 0.664477  v_F1: 0.705610  v_AUC: 0.898034
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.188174    reg_loss: 0.017781    l2_loss: 0.022612    loss: 0.228567
steps 6400    v_Prec: 0.768760  v_Recall: 0.656799  v_F1: 0.708383  v_AUC: 0.898919
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.187136    reg_loss: 0.017658    l2_loss: 0.023111    loss: 0.227906
steps 6600    v_Prec: 0.751893  v_Recall: 0.668039  v_F1: 0.707490  v_AUC: 0.897921
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.187311    reg_loss: 0.017572    l2_loss: 0.023463    loss: 0.228345
steps 6800    v_Prec: 0.749498  v_Recall: 0.680149  v_F1: 0.713142  v_AUC: 0.900459
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.189278    reg_loss: 0.017585    l2_loss: 0.023832    loss: 0.230696
steps 7000    v_Prec: 0.747794  v_Recall: 0.684344  v_F1: 0.714664  v_AUC: 0.901047
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.187852    reg_loss: 0.017554    l2_loss: 0.024265    loss: 0.229671
steps 7200    v_Prec: 0.767587  v_Recall: 0.673658  v_F1: 0.717562  v_AUC: 0.902756
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.193008    reg_loss: 0.017415    l2_loss: 0.024384    loss: 0.234807
steps 7400    v_Prec: 0.770664  v_Recall: 0.674529  v_F1: 0.719399  v_AUC: 0.904837
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.186000    reg_loss: 0.017319    l2_loss: 0.024640    loss: 0.227959
steps 7600    v_Prec: 0.777200  v_Recall: 0.674529  v_F1: 0.722234  v_AUC: 0.905205
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.190094    reg_loss: 0.017298    l2_loss: 0.024872    loss: 0.232265
steps 7800    v_Prec: 0.778975  v_Recall: 0.680940  v_F1: 0.726666  v_AUC: 0.908410
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.182919    reg_loss: 0.017286    l2_loss: 0.024904    loss: 0.225108
steps 8000    v_Prec: 0.774998  v_Recall: 0.684027  v_F1: 0.726676  v_AUC: 0.910128
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.186294    reg_loss: 0.017234    l2_loss: 0.025153    loss: 0.228682
steps 8200    v_Prec: 0.786479  v_Recall: 0.680465  v_F1: 0.729641  v_AUC: 0.909328
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.197807    reg_loss: 0.017358    l2_loss: 0.025349    loss: 0.240514
steps 8400    v_Prec: 0.765403  v_Recall: 0.700095  v_F1: 0.731294  v_AUC: 0.911723
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.191968    reg_loss: 0.017184    l2_loss: 0.025366    loss: 0.234519
steps 8600    v_Prec: 0.770356  v_Recall: 0.691942  v_F1: 0.729047  v_AUC: 0.911200
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.182636    reg_loss: 0.017170    l2_loss: 0.025565    loss: 0.225371
steps 8800    v_Prec: 0.793635  v_Recall: 0.680940  v_F1: 0.732981  v_AUC: 0.913021
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.187885    reg_loss: 0.017128    l2_loss: 0.025703    loss: 0.230715
steps 9000    v_Prec: 0.772084  v_Recall: 0.695267  v_F1: 0.731665  v_AUC: 0.911153
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.190981    reg_loss: 0.017171    l2_loss: 0.025702    loss: 0.233853
steps 9200    v_Prec: 0.786299  v_Recall: 0.692259  v_F1: 0.736288  v_AUC: 0.915179
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.190365    reg_loss: 0.017040    l2_loss: 0.025960    loss: 0.233366
steps 9400    v_Prec: 0.762229  v_Recall: 0.709197  v_F1: 0.734757  v_AUC: 0.917640
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.191917    reg_loss: 0.017098    l2_loss: 0.025884    loss: 0.234898
steps 9600    v_Prec: 0.793216  v_Recall: 0.692259  v_F1: 0.739307  v_AUC: 0.920128
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.195977    reg_loss: 0.017085    l2_loss: 0.026018    loss: 0.239080
steps 9800    v_Prec: 0.772006  v_Recall: 0.708089  v_F1: 0.738667  v_AUC: 0.919749
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.187172    reg_loss: 0.017034    l2_loss: 0.025964    loss: 0.230169
steps 10000    v_Prec: 0.761417  v_Recall: 0.723207  v_F1: 0.741820  v_AUC: 0.921947
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.190022    reg_loss: 0.016956    l2_loss: 0.025886    loss: 0.232864
steps 10200    v_Prec: 0.788732  v_Recall: 0.704765  v_F1: 0.744388  v_AUC: 0.923367
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.190173    reg_loss: 0.016995    l2_loss: 0.025941    loss: 0.233109
steps 10400    v_Prec: 0.796228  v_Recall: 0.701757  v_F1: 0.746014  v_AUC: 0.922142
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.187202    reg_loss: 0.016862    l2_loss: 0.025922    loss: 0.229986
steps 10600    v_Prec: 0.792214  v_Recall: 0.707060  v_F1: 0.747219  v_AUC: 0.923147
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.176931    reg_loss: 0.016760    l2_loss: 0.025965    loss: 0.219656
steps 10800    v_Prec: 0.793628  v_Recall: 0.705873  v_F1: 0.747183  v_AUC: 0.922919
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.078207    reg_loss: 0.015639    l2_loss: 0.025826    loss: 0.119672
steps 11000    v_Prec: 0.799675  v_Recall: 0.702074  v_F1: 0.747703  v_AUC: 0.919845
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.077390    reg_loss: 0.015641    l2_loss: 0.025827    loss: 0.118858
steps 11200    v_Prec: 0.790210  v_Recall: 0.697641  v_F1: 0.741046  v_AUC: 0.918627
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.076387    reg_loss: 0.015664    l2_loss: 0.025814    loss: 0.117865
steps 11400    v_Prec: 0.775411  v_Recall: 0.708881  v_F1: 0.740655  v_AUC: 0.914759
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.079900    reg_loss: 0.015756    l2_loss: 0.025847    loss: 0.121502
steps 11600    v_Prec: 0.786284  v_Recall: 0.686956  v_F1: 0.733271  v_AUC: 0.913756
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.073183    reg_loss: 0.015793    l2_loss: 0.025816    loss: 0.114792
steps 11800    v_Prec: 0.781103  v_Recall: 0.694238  v_F1: 0.735113  v_AUC: 0.915098
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.079815    reg_loss: 0.015780    l2_loss: 0.025829    loss: 0.121424
steps 12000    v_Prec: 0.790324  v_Recall: 0.685294  v_F1: 0.734071  v_AUC: 0.913859
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.075171    reg_loss: 0.015800    l2_loss: 0.025764    loss: 0.116734
steps 12200    v_Prec: 0.784361  v_Recall: 0.688381  v_F1: 0.733243  v_AUC: 0.912134
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.073004    reg_loss: 0.015673    l2_loss: 0.025769    loss: 0.114446
steps 12400    v_Prec: 0.784644  v_Recall: 0.692417  v_F1: 0.735652  v_AUC: 0.913213
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.074116    reg_loss: 0.015792    l2_loss: 0.025795    loss: 0.115702
steps 12600    v_Prec: 0.790175  v_Recall: 0.690043  v_F1: 0.736722  v_AUC: 0.913070
steps 12600    running time 444 seconds

steps 12800    base_loss: 0.080495    reg_loss: 0.015822    l2_loss: 0.025709    loss: 0.122026
steps 12800    v_Prec: 0.764691  v_Recall: 0.700412  v_F1: 0.731141  v_AUC: 0.913859
steps 12800    running time 450 seconds

steps 13000    base_loss: 0.078026    reg_loss: 0.015796    l2_loss: 0.025675    loss: 0.119497
steps 13000    v_Prec: 0.780554  v_Recall: 0.684977  v_F1: 0.729649  v_AUC: 0.909790
steps 13000    running time 456 seconds

Early stop model F1: 0.747703
testing thre: 0.47830278
testing Prec: 0.600463435708114
testing Recall: 0.7430862697448359
testing F1: 0.6642048786845363
testing AUC: 0.9035208993107766
overall running time 459 seconds
(0.7245979237265343, 0.654726609963548, 0.6878925598733595, 0.9035208993107766, 0.8051142)

2019-02-24 16:55:01.190978: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:55:02.177747: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:55:02.178627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:55:02.178657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.430000 seconds
loading data in 30.410000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.637692    reg_loss: 0.021643    l2_loss: 0.013274    loss: 0.672609
steps 200    v_Prec: 0.163880  v_Recall: 0.999283  v_F1: 0.281581  v_AUC: 0.518759
steps 200    running time 40 seconds

steps 400    base_loss: 0.505818    reg_loss: 0.021530    l2_loss: 0.013158    loss: 0.540507
steps 400    v_Prec: 0.166416  v_Recall: 0.925283  v_F1: 0.282096  v_AUC: 0.537478
steps 400    running time 47 seconds

steps 600    base_loss: 0.482939    reg_loss: 0.021516    l2_loss: 0.012998    loss: 0.517454
steps 600    v_Prec: 0.179325  v_Recall: 0.763183  v_F1: 0.290413  v_AUC: 0.566301
steps 600    running time 54 seconds

steps 800    base_loss: 0.457604    reg_loss: 0.021420    l2_loss: 0.012868    loss: 0.491892
steps 800    v_Prec: 0.215826  v_Recall: 0.579417  v_F1: 0.314504  v_AUC: 0.621391
steps 800    running time 60 seconds

steps 1000    base_loss: 0.441519    reg_loss: 0.021397    l2_loss: 0.012765    loss: 0.475681
steps 1000    v_Prec: 0.293949  v_Recall: 0.423690  v_F1: 0.347091  v_AUC: 0.658636
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.431987    reg_loss: 0.021339    l2_loss: 0.012720    loss: 0.466046
steps 1200    v_Prec: 0.354906  v_Recall: 0.419787  v_F1: 0.384629  v_AUC: 0.693588
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.418438    reg_loss: 0.021263    l2_loss: 0.012703    loss: 0.452405
steps 1400    v_Prec: 0.406912  v_Recall: 0.422017  v_F1: 0.414327  v_AUC: 0.723291
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.409949    reg_loss: 0.021250    l2_loss: 0.012768    loss: 0.443967
steps 1600    v_Prec: 0.421212  v_Recall: 0.486538  v_F1: 0.451525  v_AUC: 0.753051
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.389276    reg_loss: 0.021117    l2_loss: 0.012858    loss: 0.423251
steps 1800    v_Prec: 0.471041  v_Recall: 0.482635  v_F1: 0.476768  v_AUC: 0.779486
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.371947    reg_loss: 0.020991    l2_loss: 0.013080    loss: 0.406018
steps 2000    v_Prec: 0.502074  v_Recall: 0.501434  v_F1: 0.501754  v_AUC: 0.799597
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.359224    reg_loss: 0.020906    l2_loss: 0.013310    loss: 0.393440
steps 2200    v_Prec: 0.517143  v_Recall: 0.550263  v_F1: 0.533189  v_AUC: 0.824184
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.349424    reg_loss: 0.020751    l2_loss: 0.013674    loss: 0.383849
steps 2400    v_Prec: 0.512042  v_Recall: 0.599490  v_F1: 0.552326  v_AUC: 0.838374
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.336356    reg_loss: 0.020642    l2_loss: 0.014073    loss: 0.371071
steps 2600    v_Prec: 0.550267  v_Recall: 0.582922  v_F1: 0.566124  v_AUC: 0.847231
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.328767    reg_loss: 0.020554    l2_loss: 0.014492    loss: 0.363814
steps 2800    v_Prec: 0.579806  v_Recall: 0.574956  v_F1: 0.577371  v_AUC: 0.853704
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.322120    reg_loss: 0.020470    l2_loss: 0.015075    loss: 0.357665
steps 3000    v_Prec: 0.581269  v_Recall: 0.586825  v_F1: 0.584034  v_AUC: 0.856607
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.313058    reg_loss: 0.020352    l2_loss: 0.015513    loss: 0.348924
steps 3200    v_Prec: 0.582317  v_Recall: 0.600685  v_F1: 0.591358  v_AUC: 0.860269
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.314086    reg_loss: 0.020309    l2_loss: 0.016170    loss: 0.350565
steps 3400    v_Prec: 0.571460  v_Recall: 0.619484  v_F1: 0.594504  v_AUC: 0.863302
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.305559    reg_loss: 0.020133    l2_loss: 0.016769    loss: 0.342460
steps 3600    v_Prec: 0.594865  v_Recall: 0.605385  v_F1: 0.600079  v_AUC: 0.865995
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.309711    reg_loss: 0.020054    l2_loss: 0.017401    loss: 0.347166
steps 3800    v_Prec: 0.586858  v_Recall: 0.616776  v_F1: 0.601445  v_AUC: 0.866882
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.309614    reg_loss: 0.019946    l2_loss: 0.018125    loss: 0.347686
steps 4000    v_Prec: 0.606164  v_Recall: 0.606261  v_F1: 0.606213  v_AUC: 0.870072
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.309395    reg_loss: 0.019859    l2_loss: 0.018807    loss: 0.348060
steps 4200    v_Prec: 0.584085  v_Recall: 0.634379  v_F1: 0.608194  v_AUC: 0.870725
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.307294    reg_loss: 0.019736    l2_loss: 0.019439    loss: 0.346469
steps 4400    v_Prec: 0.585783  v_Recall: 0.649195  v_F1: 0.615861  v_AUC: 0.872342
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.315442    reg_loss: 0.019657    l2_loss: 0.020179    loss: 0.355277
steps 4600    v_Prec: 0.608760  v_Recall: 0.617731  v_F1: 0.613213  v_AUC: 0.872422
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.300769    reg_loss: 0.019521    l2_loss: 0.021080    loss: 0.341370
steps 4800    v_Prec: 0.595770  v_Recall: 0.635017  v_F1: 0.614768  v_AUC: 0.873233
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.301528    reg_loss: 0.019404    l2_loss: 0.021847    loss: 0.342779
steps 5000    v_Prec: 0.595653  v_Recall: 0.639637  v_F1: 0.616862  v_AUC: 0.875686
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.301790    reg_loss: 0.019299    l2_loss: 0.022679    loss: 0.343768
steps 5200    v_Prec: 0.620956  v_Recall: 0.620758  v_F1: 0.620857  v_AUC: 0.877998
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.293235    reg_loss: 0.019252    l2_loss: 0.023698    loss: 0.336185
steps 5400    v_Prec: 0.600952  v_Recall: 0.653895  v_F1: 0.626307  v_AUC: 0.880754
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.184136    reg_loss: 0.020117    l2_loss: 0.024355    loss: 0.228608
steps 5600    v_Prec: 0.606604  v_Recall: 0.630715  v_F1: 0.618425  v_AUC: 0.874611
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.170345    reg_loss: 0.020368    l2_loss: 0.024895    loss: 0.215608
steps 5800    v_Prec: 0.593330  v_Recall: 0.636291  v_F1: 0.614060  v_AUC: 0.869851
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.165529    reg_loss: 0.020529    l2_loss: 0.025398    loss: 0.211455
steps 6000    v_Prec: 0.605582  v_Recall: 0.617014  v_F1: 0.611245  v_AUC: 0.868016
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.175152    reg_loss: 0.020504    l2_loss: 0.025874    loss: 0.221530
steps 6200    v_Prec: 0.604737  v_Recall: 0.612155  v_F1: 0.608424  v_AUC: 0.868694
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.176128    reg_loss: 0.020559    l2_loss: 0.026368    loss: 0.223055
steps 6400    v_Prec: 0.576981  v_Recall: 0.638522  v_F1: 0.606194  v_AUC: 0.868377
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.178240    reg_loss: 0.020561    l2_loss: 0.026828    loss: 0.225629
steps 6600    v_Prec: 0.622047  v_Recall: 0.585232  v_F1: 0.603078  v_AUC: 0.867436
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.181313    reg_loss: 0.020534    l2_loss: 0.027146    loss: 0.228993
steps 6800    v_Prec: 0.580790  v_Recall: 0.638203  v_F1: 0.608145  v_AUC: 0.868399
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.180125    reg_loss: 0.020470    l2_loss: 0.027528    loss: 0.228123
steps 7000    v_Prec: 0.583134  v_Recall: 0.641150  v_F1: 0.610768  v_AUC: 0.867283
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.176877    reg_loss: 0.020505    l2_loss: 0.028038    loss: 0.225420
steps 7200    v_Prec: 0.587513  v_Recall: 0.640115  v_F1: 0.612687  v_AUC: 0.868348
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.186667    reg_loss: 0.020404    l2_loss: 0.028296    loss: 0.235366
steps 7400    v_Prec: 0.609444  v_Recall: 0.617891  v_F1: 0.613638  v_AUC: 0.868805
steps 7400    running time 275 seconds

Early stop model F1: 0.626307
testing thre: 0.32627785
testing Prec: 0.43500866551126516
testing Recall: 0.768554070473876
testing F1: 0.5555633629624426
testing AUC: 0.8690720009353506
overall running time 277 seconds
(0.6210375377682184, 0.589404617253949, 0.6048077402623311, 0.8690720009353506, 0.6064222)

2019-02-24 16:58:08.703540: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:58:09.549796: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:58:09.554074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:58:09.554134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.610000 seconds
loading data in 30.740000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.570447    reg_loss: 0.021549    l2_loss: 0.013268    loss: 0.605264
steps 200    v_Prec: 0.162850  v_Recall: 0.998235  v_F1: 0.280018  v_AUC: 0.515272
steps 200    running time 40 seconds

steps 400    base_loss: 0.504897    reg_loss: 0.021467    l2_loss: 0.013090    loss: 0.539455
steps 400    v_Prec: 0.168445  v_Recall: 0.865073  v_F1: 0.281983  v_AUC: 0.547179
steps 400    running time 47 seconds

steps 600    base_loss: 0.470529    reg_loss: 0.021275    l2_loss: 0.012827    loss: 0.504631
steps 600    v_Prec: 0.188899  v_Recall: 0.680892  v_F1: 0.295749  v_AUC: 0.586828
steps 600    running time 54 seconds

steps 800    base_loss: 0.454046    reg_loss: 0.021188    l2_loss: 0.012628    loss: 0.487861
steps 800    v_Prec: 0.214221  v_Recall: 0.572758  v_F1: 0.311818  v_AUC: 0.619290
steps 800    running time 61 seconds

steps 1000    base_loss: 0.446934    reg_loss: 0.021113    l2_loss: 0.012542    loss: 0.480589
steps 1000    v_Prec: 0.246793  v_Recall: 0.540109  v_F1: 0.338784  v_AUC: 0.657969
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.441233    reg_loss: 0.020951    l2_loss: 0.012462    loss: 0.474646
steps 1200    v_Prec: 0.307003  v_Recall: 0.506016  v_F1: 0.382152  v_AUC: 0.707115
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.419515    reg_loss: 0.020808    l2_loss: 0.012501    loss: 0.452824
steps 1400    v_Prec: 0.345028  v_Recall: 0.499358  v_F1: 0.408090  v_AUC: 0.739205
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.400928    reg_loss: 0.020671    l2_loss: 0.012637    loss: 0.434236
steps 1600    v_Prec: 0.413396  v_Recall: 0.509466  v_F1: 0.456430  v_AUC: 0.776193
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.378318    reg_loss: 0.020554    l2_loss: 0.012879    loss: 0.411751
steps 1800    v_Prec: 0.482501  v_Recall: 0.513156  v_F1: 0.497357  v_AUC: 0.806519
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.361325    reg_loss: 0.020433    l2_loss: 0.013212    loss: 0.394970
steps 2000    v_Prec: 0.489686  v_Recall: 0.577009  v_F1: 0.529774  v_AUC: 0.826176
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.345410    reg_loss: 0.020242    l2_loss: 0.013584    loss: 0.379236
steps 2200    v_Prec: 0.540979  v_Recall: 0.570271  v_F1: 0.555239  v_AUC: 0.841675
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.329559    reg_loss: 0.020071    l2_loss: 0.014042    loss: 0.363672
steps 2400    v_Prec: 0.576024  v_Recall: 0.573159  v_F1: 0.574588  v_AUC: 0.852211
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.323068    reg_loss: 0.019977    l2_loss: 0.014430    loss: 0.357475
steps 2600    v_Prec: 0.586237  v_Recall: 0.587037  v_F1: 0.586637  v_AUC: 0.858988
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.315343    reg_loss: 0.019878    l2_loss: 0.014904    loss: 0.350125
steps 2800    v_Prec: 0.575608  v_Recall: 0.618643  v_F1: 0.596350  v_AUC: 0.865135
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.319876    reg_loss: 0.019779    l2_loss: 0.015404    loss: 0.355058
steps 3000    v_Prec: 0.577422  v_Recall: 0.624900  v_F1: 0.600223  v_AUC: 0.868068
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.305635    reg_loss: 0.019598    l2_loss: 0.015931    loss: 0.341164
steps 3200    v_Prec: 0.605897  v_Recall: 0.621450  v_F1: 0.613575  v_AUC: 0.872527
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.310062    reg_loss: 0.019508    l2_loss: 0.016434    loss: 0.346004
steps 3400    v_Prec: 0.632142  v_Recall: 0.601717  v_F1: 0.616554  v_AUC: 0.874837
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.305878    reg_loss: 0.019346    l2_loss: 0.016999    loss: 0.342224
steps 3600    v_Prec: 0.631439  v_Recall: 0.607733  v_F1: 0.619359  v_AUC: 0.876830
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.301532    reg_loss: 0.019261    l2_loss: 0.017591    loss: 0.338384
steps 3800    v_Prec: 0.629084  v_Recall: 0.619445  v_F1: 0.624227  v_AUC: 0.878512
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.300752    reg_loss: 0.019105    l2_loss: 0.018264    loss: 0.338121
steps 4000    v_Prec: 0.643031  v_Recall: 0.613990  v_F1: 0.628175  v_AUC: 0.879937
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.300768    reg_loss: 0.018974    l2_loss: 0.018910    loss: 0.338652
steps 4200    v_Prec: 0.622815  v_Recall: 0.637253  v_F1: 0.629951  v_AUC: 0.882860
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.296708    reg_loss: 0.018822    l2_loss: 0.019626    loss: 0.335156
steps 4400    v_Prec: 0.636231  v_Recall: 0.631638  v_F1: 0.633926  v_AUC: 0.884131
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.298166    reg_loss: 0.018672    l2_loss: 0.020320    loss: 0.337157
steps 4600    v_Prec: 0.640058  v_Recall: 0.639339  v_F1: 0.639698  v_AUC: 0.885054
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.283947    reg_loss: 0.018448    l2_loss: 0.021059    loss: 0.323454
steps 4800    v_Prec: 0.629248  v_Recall: 0.646158  v_F1: 0.637591  v_AUC: 0.885657
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.291622    reg_loss: 0.018363    l2_loss: 0.021814    loss: 0.331799
steps 5000    v_Prec: 0.658883  v_Recall: 0.624739  v_F1: 0.641357  v_AUC: 0.887695
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.297207    reg_loss: 0.018292    l2_loss: 0.022643    loss: 0.338142
steps 5200    v_Prec: 0.634302  v_Recall: 0.661880  v_F1: 0.647798  v_AUC: 0.888317
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.275032    reg_loss: 0.018148    l2_loss: 0.023467    loss: 0.316647
steps 5400    v_Prec: 0.646429  v_Recall: 0.653377  v_F1: 0.649884  v_AUC: 0.890345
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.175323    reg_loss: 0.018859    l2_loss: 0.024211    loss: 0.218393
steps 5600    v_Prec: 0.627824  v_Recall: 0.653056  v_F1: 0.640192  v_AUC: 0.885610
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.155218    reg_loss: 0.019304    l2_loss: 0.024798    loss: 0.199320
steps 5800    v_Prec: 0.632004  v_Recall: 0.640622  v_F1: 0.636284  v_AUC: 0.881966
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.167686    reg_loss: 0.019402    l2_loss: 0.025346    loss: 0.212434
steps 6000    v_Prec: 0.630550  v_Recall: 0.631157  v_F1: 0.630853  v_AUC: 0.879027
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.174073    reg_loss: 0.019482    l2_loss: 0.025921    loss: 0.219476
steps 6200    v_Prec: 0.622406  v_Recall: 0.627948  v_F1: 0.625165  v_AUC: 0.879508
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.168503    reg_loss: 0.019411    l2_loss: 0.026313    loss: 0.214226
steps 6400    v_Prec: 0.615869  v_Recall: 0.643189  v_F1: 0.629233  v_AUC: 0.879774
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.190721    reg_loss: 0.019462    l2_loss: 0.026780    loss: 0.236963
steps 6600    v_Prec: 0.604436  v_Recall: 0.649286  v_F1: 0.626059  v_AUC: 0.877505
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.176362    reg_loss: 0.019350    l2_loss: 0.027283    loss: 0.222996
steps 6800    v_Prec: 0.636552  v_Recall: 0.617199  v_F1: 0.626726  v_AUC: 0.879254
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.173640    reg_loss: 0.019422    l2_loss: 0.027750    loss: 0.220812
steps 7000    v_Prec: 0.612694  v_Recall: 0.643510  v_F1: 0.627724  v_AUC: 0.878853
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.195573    reg_loss: 0.019316    l2_loss: 0.028119    loss: 0.243007
steps 7200    v_Prec: 0.612701  v_Recall: 0.649366  v_F1: 0.630501  v_AUC: 0.880572
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.196764    reg_loss: 0.019334    l2_loss: 0.028574    loss: 0.244673
steps 7400    v_Prec: 0.621282  v_Recall: 0.650088  v_F1: 0.635359  v_AUC: 0.881567
steps 7400    running time 278 seconds

Early stop model F1: 0.649884
testing thre: 0.37711608
testing Prec: 0.473666253101737
testing Recall: 0.7422114216281895
testing F1: 0.578282684843321
testing AUC: 0.8736575879166882
overall running time 281 seconds
(0.6563005281879918, 0.5918347509113001, 0.622402821436786, 0.8736575879166882, 0.6839621)

2019-02-24 17:01:15.860459: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:01:17.587459: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:01:17.589846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:01:17.589889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.800000 seconds
loading data in 30.880000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.726174    reg_loss: 0.064449    l2_loss: 0.013374    loss: 0.803997
steps 200    v_Prec: 0.164063  v_Recall: 0.998647  v_F1: 0.281826  v_AUC: 0.528712
steps 200    running time 41 seconds

steps 400    base_loss: 0.555283    reg_loss: 0.063957    l2_loss: 0.013283    loss: 0.632523
steps 400    v_Prec: 0.172993  v_Recall: 0.826914  v_F1: 0.286127  v_AUC: 0.544207
steps 400    running time 48 seconds

steps 600    base_loss: 0.474343    reg_loss: 0.063258    l2_loss: 0.013157    loss: 0.550758
steps 600    v_Prec: 0.182339  v_Recall: 0.777734  v_F1: 0.295417  v_AUC: 0.570267
steps 600    running time 55 seconds

steps 800    base_loss: 0.473237    reg_loss: 0.062932    l2_loss: 0.013022    loss: 0.549191
steps 800    v_Prec: 0.210372  v_Recall: 0.623349  v_F1: 0.314578  v_AUC: 0.619199
steps 800    running time 62 seconds

steps 1000    base_loss: 0.452834    reg_loss: 0.062089    l2_loss: 0.012891    loss: 0.527814
steps 1000    v_Prec: 0.287825  v_Recall: 0.458857  v_F1: 0.353753  v_AUC: 0.673925
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.437032    reg_loss: 0.061163    l2_loss: 0.012808    loss: 0.511003
steps 1200    v_Prec: 0.375099  v_Recall: 0.450263  v_F1: 0.409259  v_AUC: 0.724462
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.423395    reg_loss: 0.060169    l2_loss: 0.012856    loss: 0.496420
steps 1400    v_Prec: 0.472990  v_Recall: 0.450820  v_F1: 0.461639  v_AUC: 0.760708
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.399525    reg_loss: 0.059144    l2_loss: 0.012902    loss: 0.471572
steps 1600    v_Prec: 0.518378  v_Recall: 0.499443  v_F1: 0.508734  v_AUC: 0.794079
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.374183    reg_loss: 0.058162    l2_loss: 0.013027    loss: 0.445372
steps 1800    v_Prec: 0.590905  v_Recall: 0.505650  v_F1: 0.544963  v_AUC: 0.819033
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.348368    reg_loss: 0.057341    l2_loss: 0.013258    loss: 0.418967
steps 2000    v_Prec: 0.593871  v_Recall: 0.547509  v_F1: 0.569749  v_AUC: 0.834912
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.337029    reg_loss: 0.056797    l2_loss: 0.013572    loss: 0.407398
steps 2200    v_Prec: 0.641665  v_Recall: 0.556900  v_F1: 0.596285  v_AUC: 0.848663
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.324273    reg_loss: 0.056063    l2_loss: 0.013923    loss: 0.394258
steps 2400    v_Prec: 0.642063  v_Recall: 0.583559  v_F1: 0.611415  v_AUC: 0.855237
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.311601    reg_loss: 0.055410    l2_loss: 0.014296    loss: 0.381307
steps 2600    v_Prec: 0.693491  v_Recall: 0.570587  v_F1: 0.626064  v_AUC: 0.862932
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.309765    reg_loss: 0.054950    l2_loss: 0.014703    loss: 0.379419
steps 2800    v_Prec: 0.683669  v_Recall: 0.591994  v_F1: 0.634537  v_AUC: 0.869407
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.298392    reg_loss: 0.054464    l2_loss: 0.015082    loss: 0.367938
steps 3000    v_Prec: 0.702594  v_Recall: 0.597087  v_F1: 0.645558  v_AUC: 0.874125
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.298678    reg_loss: 0.054216    l2_loss: 0.015529    loss: 0.368424
steps 3200    v_Prec: 0.718693  v_Recall: 0.600589  v_F1: 0.654355  v_AUC: 0.877332
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.286376    reg_loss: 0.053432    l2_loss: 0.015900    loss: 0.355709
steps 3400    v_Prec: 0.673969  v_Recall: 0.641413  v_F1: 0.657288  v_AUC: 0.879569
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.287828    reg_loss: 0.053157    l2_loss: 0.016331    loss: 0.357316
steps 3600    v_Prec: 0.724902  v_Recall: 0.619449  v_F1: 0.668040  v_AUC: 0.884289
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.287530    reg_loss: 0.052822    l2_loss: 0.016763    loss: 0.357115
steps 3800    v_Prec: 0.743066  v_Recall: 0.616107  v_F1: 0.673657  v_AUC: 0.887113
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.276191    reg_loss: 0.052340    l2_loss: 0.017149    loss: 0.345680
steps 4000    v_Prec: 0.722062  v_Recall: 0.638628  v_F1: 0.677787  v_AUC: 0.890100
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.272454    reg_loss: 0.051951    l2_loss: 0.017574    loss: 0.341979
steps 4200    v_Prec: 0.732393  v_Recall: 0.648814  v_F1: 0.688075  v_AUC: 0.892468
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.272606    reg_loss: 0.051533    l2_loss: 0.017923    loss: 0.342062
steps 4400    v_Prec: 0.731299  v_Recall: 0.646506  v_F1: 0.686294  v_AUC: 0.894880
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.278025    reg_loss: 0.051424    l2_loss: 0.018313    loss: 0.347762
steps 4600    v_Prec: 0.746084  v_Recall: 0.636718  v_F1: 0.687076  v_AUC: 0.895319
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.270620    reg_loss: 0.051259    l2_loss: 0.018740    loss: 0.340619
steps 4800    v_Prec: 0.746116  v_Recall: 0.649690  v_F1: 0.694572  v_AUC: 0.897623
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.267591    reg_loss: 0.051302    l2_loss: 0.019116    loss: 0.338009
steps 5000    v_Prec: 0.747529  v_Recall: 0.662104  v_F1: 0.702228  v_AUC: 0.900751
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.263422    reg_loss: 0.051142    l2_loss: 0.019613    loss: 0.334178
steps 5200    v_Prec: 0.735281  v_Recall: 0.674837  v_F1: 0.703764  v_AUC: 0.903925
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.261497    reg_loss: 0.050725    l2_loss: 0.020091    loss: 0.332313
steps 5400    v_Prec: 0.732312  v_Recall: 0.677065  v_F1: 0.703606  v_AUC: 0.904505
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.169091    reg_loss: 0.048221    l2_loss: 0.020598    loss: 0.237909
steps 5600    v_Prec: 0.743226  v_Recall: 0.663616  v_F1: 0.701169  v_AUC: 0.898680
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.178940    reg_loss: 0.048599    l2_loss: 0.021323    loss: 0.248862
steps 5800    v_Prec: 0.746984  v_Recall: 0.655260  v_F1: 0.698122  v_AUC: 0.895852
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.177987    reg_loss: 0.048303    l2_loss: 0.021961    loss: 0.248251
steps 6000    v_Prec: 0.728921  v_Recall: 0.665287  v_F1: 0.695652  v_AUC: 0.894934
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.178006    reg_loss: 0.048411    l2_loss: 0.022631    loss: 0.249047
steps 6200    v_Prec: 0.743986  v_Recall: 0.659558  v_F1: 0.699232  v_AUC: 0.896482
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.169133    reg_loss: 0.047751    l2_loss: 0.023230    loss: 0.240115
steps 6400    v_Prec: 0.741825  v_Recall: 0.669744  v_F1: 0.703944  v_AUC: 0.897324
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.176897    reg_loss: 0.047928    l2_loss: 0.023644    loss: 0.248469
steps 6600    v_Prec: 0.756742  v_Recall: 0.663218  v_F1: 0.706900  v_AUC: 0.898840
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.183986    reg_loss: 0.047861    l2_loss: 0.024061    loss: 0.255908
steps 6800    v_Prec: 0.745606  v_Recall: 0.678498  v_F1: 0.710470  v_AUC: 0.901519
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.177271    reg_loss: 0.047270    l2_loss: 0.024407    loss: 0.248948
steps 7000    v_Prec: 0.744893  v_Recall: 0.676190  v_F1: 0.708881  v_AUC: 0.899154
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.199075    reg_loss: 0.047531    l2_loss: 0.024840    loss: 0.271446
steps 7200    v_Prec: 0.738560  v_Recall: 0.685898  v_F1: 0.711256  v_AUC: 0.901970
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.183693    reg_loss: 0.046879    l2_loss: 0.025106    loss: 0.255678
steps 7400    v_Prec: 0.758228  v_Recall: 0.672847  v_F1: 0.712991  v_AUC: 0.901931
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.183228    reg_loss: 0.046839    l2_loss: 0.025336    loss: 0.255404
steps 7600    v_Prec: 0.757185  v_Recall: 0.681442  v_F1: 0.717319  v_AUC: 0.905211
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.185180    reg_loss: 0.046775    l2_loss: 0.025729    loss: 0.257683
steps 7800    v_Prec: 0.763800  v_Recall: 0.674996  v_F1: 0.716658  v_AUC: 0.906279
steps 7800    running time 294 seconds

steps 8000    base_loss: 0.194698    reg_loss: 0.046824    l2_loss: 0.025981    loss: 0.267502
steps 8000    v_Prec: 0.770959  v_Recall: 0.671813  v_F1: 0.717979  v_AUC: 0.906271
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.180814    reg_loss: 0.046264    l2_loss: 0.026159    loss: 0.253236
steps 8200    v_Prec: 0.782629  v_Recall: 0.669028  v_F1: 0.721383  v_AUC: 0.907383
steps 8200    running time 307 seconds

steps 8400    base_loss: 0.189534    reg_loss: 0.046265    l2_loss: 0.026293    loss: 0.262092
steps 8400    v_Prec: 0.750939  v_Recall: 0.700143  v_F1: 0.724652  v_AUC: 0.908095
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.194240    reg_loss: 0.046250    l2_loss: 0.026523    loss: 0.267013
steps 8600    v_Prec: 0.786104  v_Recall: 0.676190  v_F1: 0.727016  v_AUC: 0.910577
steps 8600    running time 320 seconds

steps 8800    base_loss: 0.187357    reg_loss: 0.046112    l2_loss: 0.026774    loss: 0.260244
steps 8800    v_Prec: 0.768500  v_Recall: 0.689241  v_F1: 0.726716  v_AUC: 0.910153
steps 8800    running time 327 seconds

steps 9000    base_loss: 0.180186    reg_loss: 0.045566    l2_loss: 0.026793    loss: 0.252545
steps 9000    v_Prec: 0.778768  v_Recall: 0.681283  v_F1: 0.726771  v_AUC: 0.910511
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.195498    reg_loss: 0.045906    l2_loss: 0.026942    loss: 0.268346
steps 9200    v_Prec: 0.771111  v_Recall: 0.690355  v_F1: 0.728502  v_AUC: 0.910793
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.187608    reg_loss: 0.045686    l2_loss: 0.027031    loss: 0.260325
steps 9400    v_Prec: 0.776637  v_Recall: 0.686217  v_F1: 0.728632  v_AUC: 0.911765
steps 9400    running time 346 seconds

steps 9600    base_loss: 0.190444    reg_loss: 0.045550    l2_loss: 0.027044    loss: 0.263038
steps 9600    v_Prec: 0.769244  v_Recall: 0.695050  v_F1: 0.730268  v_AUC: 0.914758
steps 9600    running time 353 seconds

steps 9800    base_loss: 0.188776    reg_loss: 0.045417    l2_loss: 0.027061    loss: 0.261255
steps 9800    v_Prec: 0.768859  v_Recall: 0.696721  v_F1: 0.731015  v_AUC: 0.915514
steps 9800    running time 360 seconds

steps 10000    base_loss: 0.188257    reg_loss: 0.045221    l2_loss: 0.027164    loss: 0.260642
steps 10000    v_Prec: 0.800093  v_Recall: 0.685103  v_F1: 0.738146  v_AUC: 0.919202
steps 10000    running time 367 seconds

steps 10200    base_loss: 0.189682    reg_loss: 0.045016    l2_loss: 0.027210    loss: 0.261909
steps 10200    v_Prec: 0.792315  v_Recall: 0.692504  v_F1: 0.739055  v_AUC: 0.917923
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.190984    reg_loss: 0.045088    l2_loss: 0.027274    loss: 0.263346
steps 10400    v_Prec: 0.775604  v_Recall: 0.709932  v_F1: 0.741316  v_AUC: 0.919618
steps 10400    running time 380 seconds

steps 10600    base_loss: 0.189925    reg_loss: 0.044976    l2_loss: 0.027359    loss: 0.262260
steps 10600    v_Prec: 0.772194  v_Recall: 0.712956  v_F1: 0.741394  v_AUC: 0.920411
steps 10600    running time 387 seconds

steps 10800    base_loss: 0.175519    reg_loss: 0.044292    l2_loss: 0.027363    loss: 0.247174
steps 10800    v_Prec: 0.779988  v_Recall: 0.708420  v_F1: 0.742483  v_AUC: 0.919386
steps 10800    running time 393 seconds

steps 11000    base_loss: 0.075533    reg_loss: 0.040819    l2_loss: 0.027369    loss: 0.143721
steps 11000    v_Prec: 0.780849  v_Recall: 0.701496  v_F1: 0.739048  v_AUC: 0.917315
steps 11000    running time 400 seconds

steps 11200    base_loss: 0.072059    reg_loss: 0.040797    l2_loss: 0.027303    loss: 0.140159
steps 11200    v_Prec: 0.781342  v_Recall: 0.697835  v_F1: 0.737231  v_AUC: 0.914748
steps 11200    running time 406 seconds

steps 11400    base_loss: 0.075739    reg_loss: 0.041036    l2_loss: 0.027356    loss: 0.144131
steps 11400    v_Prec: 0.784788  v_Recall: 0.693856  v_F1: 0.736526  v_AUC: 0.914353
steps 11400    running time 413 seconds

steps 11600    base_loss: 0.075950    reg_loss: 0.040939    l2_loss: 0.027256    loss: 0.144145
steps 11600    v_Prec: 0.781902  v_Recall: 0.692424  v_F1: 0.734448  v_AUC: 0.912471
steps 11600    running time 419 seconds

steps 11800    base_loss: 0.077865    reg_loss: 0.041331    l2_loss: 0.027460    loss: 0.146656
steps 11800    v_Prec: 0.765872  v_Recall: 0.697915  v_F1: 0.730316  v_AUC: 0.909969
steps 11800    running time 425 seconds

steps 12000    base_loss: 0.078692    reg_loss: 0.041301    l2_loss: 0.027397    loss: 0.147389
steps 12000    v_Prec: 0.782387  v_Recall: 0.684386  v_F1: 0.730113  v_AUC: 0.910563
steps 12000    running time 431 seconds

steps 12200    base_loss: 0.081934    reg_loss: 0.041161    l2_loss: 0.027359    loss: 0.150454
steps 12200    v_Prec: 0.777134  v_Recall: 0.683193  v_F1: 0.727142  v_AUC: 0.910004
steps 12200    running time 438 seconds

steps 12400    base_loss: 0.083708    reg_loss: 0.041264    l2_loss: 0.027426    loss: 0.152398
steps 12400    v_Prec: 0.771660  v_Recall: 0.690355  v_F1: 0.728747  v_AUC: 0.909309
steps 12400    running time 444 seconds

steps 12600    base_loss: 0.080549    reg_loss: 0.041308    l2_loss: 0.027410    loss: 0.149267
steps 12600    v_Prec: 0.755615  v_Recall: 0.701496  v_F1: 0.727550  v_AUC: 0.909959
steps 12600    running time 450 seconds

steps 12800    base_loss: 0.086273    reg_loss: 0.041268    l2_loss: 0.027427    loss: 0.154968
steps 12800    v_Prec: 0.782960  v_Recall: 0.678657  v_F1: 0.727087  v_AUC: 0.909806
steps 12800    running time 457 seconds

Early stop model F1: 0.742483
testing thre: 0.40643618
testing Prec: 0.5673909139881487
testing Recall: 0.7678736330498177
testing F1: 0.6525815778603882
testing AUC: 0.9027861748274962
overall running time 459 seconds
(0.7183179422966557, 0.6691616038882139, 0.6928690050827839, 0.9027861748274962, 0.72859126)

2019-02-24 17:06:14.205120: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:06:15.345371: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:06:15.347222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:06:15.347261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.650000 seconds
loading data in 30.720000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.808776    reg_loss: 0.064983    l2_loss: 0.013402    loss: 0.887161
steps 200    v_Prec: 0.166282  v_Recall: 0.993304  v_F1: 0.284875  v_AUC: 0.485455
steps 200    running time 41 seconds

steps 400    base_loss: 0.568094    reg_loss: 0.065101    l2_loss: 0.013484    loss: 0.646679
steps 400    v_Prec: 0.166517  v_Recall: 0.993620  v_F1: 0.285233  v_AUC: 0.527118
steps 400    running time 47 seconds

steps 600    base_loss: 0.481982    reg_loss: 0.064709    l2_loss: 0.013407    loss: 0.560098
steps 600    v_Prec: 0.179351  v_Recall: 0.738243  v_F1: 0.288591  v_AUC: 0.548514
steps 600    running time 54 seconds

steps 800    base_loss: 0.479114    reg_loss: 0.064377    l2_loss: 0.013235    loss: 0.556725
steps 800    v_Prec: 0.181411  v_Recall: 0.740291  v_F1: 0.291411  v_AUC: 0.565104
steps 800    running time 61 seconds

steps 1000    base_loss: 0.461393    reg_loss: 0.063901    l2_loss: 0.013091    loss: 0.538385
steps 1000    v_Prec: 0.168216  v_Recall: 0.947853  v_F1: 0.285724  v_AUC: 0.538879
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.449513    reg_loss: 0.063689    l2_loss: 0.013017    loss: 0.526219
steps 1200    v_Prec: 0.197165  v_Recall: 0.619141  v_F1: 0.299087  v_AUC: 0.581915
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.453983    reg_loss: 0.063603    l2_loss: 0.012987    loss: 0.530572
steps 1400    v_Prec: 0.236498  v_Recall: 0.490823  v_F1: 0.319195  v_AUC: 0.622531
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.436678    reg_loss: 0.063145    l2_loss: 0.013016    loss: 0.512839
steps 1600    v_Prec: 0.315921  v_Recall: 0.426861  v_F1: 0.363106  v_AUC: 0.663822
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.425776    reg_loss: 0.062757    l2_loss: 0.013115    loss: 0.501648
steps 1800    v_Prec: 0.375857  v_Recall: 0.453486  v_F1: 0.411038  v_AUC: 0.714016
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.399287    reg_loss: 0.062210    l2_loss: 0.013291    loss: 0.474789
steps 2000    v_Prec: 0.486786  v_Recall: 0.422213  v_F1: 0.452206  v_AUC: 0.742192
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.387869    reg_loss: 0.062009    l2_loss: 0.013546    loss: 0.463424
steps 2200    v_Prec: 0.493231  v_Recall: 0.490744  v_F1: 0.491985  v_AUC: 0.765679
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.370396    reg_loss: 0.061867    l2_loss: 0.013717    loss: 0.445980
steps 2400    v_Prec: 0.531165  v_Recall: 0.508153  v_F1: 0.519404  v_AUC: 0.789176
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.358048    reg_loss: 0.061861    l2_loss: 0.013991    loss: 0.433900
steps 2600    v_Prec: 0.579406  v_Recall: 0.519023  v_F1: 0.547555  v_AUC: 0.807380
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.343869    reg_loss: 0.061845    l2_loss: 0.014235    loss: 0.419949
steps 2800    v_Prec: 0.583067  v_Recall: 0.545727  v_F1: 0.563779  v_AUC: 0.819322
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.329166    reg_loss: 0.061989    l2_loss: 0.014540    loss: 0.405694
steps 3000    v_Prec: 0.608673  v_Recall: 0.556124  v_F1: 0.581213  v_AUC: 0.830384
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.326621    reg_loss: 0.062353    l2_loss: 0.014882    loss: 0.403855
steps 3200    v_Prec: 0.640792  v_Recall: 0.560536  v_F1: 0.597983  v_AUC: 0.839866
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.314114    reg_loss: 0.062594    l2_loss: 0.015191    loss: 0.391900
steps 3400    v_Prec: 0.650359  v_Recall: 0.585349  v_F1: 0.616144  v_AUC: 0.849481
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.305907    reg_loss: 0.063281    l2_loss: 0.015620    loss: 0.384808
steps 3600    v_Prec: 0.683106  v_Recall: 0.571721  v_F1: 0.622470  v_AUC: 0.853629
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.298187    reg_loss: 0.063515    l2_loss: 0.016108    loss: 0.377810
steps 3800    v_Prec: 0.708297  v_Recall: 0.576290  v_F1: 0.635511  v_AUC: 0.860908
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.297716    reg_loss: 0.064010    l2_loss: 0.016584    loss: 0.378310
steps 4000    v_Prec: 0.691893  v_Recall: 0.606380  v_F1: 0.646320  v_AUC: 0.867441
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.297124    reg_loss: 0.064399    l2_loss: 0.017080    loss: 0.378604
steps 4200    v_Prec: 0.702312  v_Recall: 0.612525  v_F1: 0.654353  v_AUC: 0.870729
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.288085    reg_loss: 0.064072    l2_loss: 0.017516    loss: 0.369673
steps 4400    v_Prec: 0.702836  v_Recall: 0.626546  v_F1: 0.662502  v_AUC: 0.872367
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.282126    reg_loss: 0.063934    l2_loss: 0.017922    loss: 0.363982
steps 4600    v_Prec: 0.709908  v_Recall: 0.625916  v_F1: 0.665271  v_AUC: 0.878124
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.279798    reg_loss: 0.064187    l2_loss: 0.018400    loss: 0.362384
steps 4800    v_Prec: 0.740797  v_Recall: 0.619772  v_F1: 0.674901  v_AUC: 0.882470
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.275121    reg_loss: 0.063902    l2_loss: 0.018855    loss: 0.357877
steps 5000    v_Prec: 0.747567  v_Recall: 0.617251  v_F1: 0.676188  v_AUC: 0.884571
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.270601    reg_loss: 0.064247    l2_loss: 0.019382    loss: 0.354230
steps 5200    v_Prec: 0.738056  v_Recall: 0.630327  v_F1: 0.679951  v_AUC: 0.886993
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.265900    reg_loss: 0.064064    l2_loss: 0.019965    loss: 0.349929
steps 5400    v_Prec: 0.768072  v_Recall: 0.622686  v_F1: 0.687780  v_AUC: 0.888840
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.181281    reg_loss: 0.060467    l2_loss: 0.020244    loss: 0.261991
steps 5600    v_Prec: 0.737027  v_Recall: 0.644427  v_F1: 0.687623  v_AUC: 0.887478
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.194582    reg_loss: 0.061178    l2_loss: 0.020601    loss: 0.276361
steps 5800    v_Prec: 0.756111  v_Recall: 0.633478  v_F1: 0.689383  v_AUC: 0.884642
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.181887    reg_loss: 0.060968    l2_loss: 0.020789    loss: 0.263644
steps 6000    v_Prec: 0.754426  v_Recall: 0.631115  v_F1: 0.687283  v_AUC: 0.885471
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.182611    reg_loss: 0.061152    l2_loss: 0.021035    loss: 0.264798
steps 6200    v_Prec: 0.776591  v_Recall: 0.613076  v_F1: 0.685214  v_AUC: 0.886700
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.183722    reg_loss: 0.061203    l2_loss: 0.021376    loss: 0.266301
steps 6400    v_Prec: 0.745627  v_Recall: 0.637968  v_F1: 0.687609  v_AUC: 0.887867
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.194487    reg_loss: 0.061500    l2_loss: 0.021636    loss: 0.277623
steps 6600    v_Prec: 0.756034  v_Recall: 0.641512  v_F1: 0.694081  v_AUC: 0.889453
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.188237    reg_loss: 0.061494    l2_loss: 0.021757    loss: 0.271488
steps 6800    v_Prec: 0.758019  v_Recall: 0.640331  v_F1: 0.694223  v_AUC: 0.890284
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.191968    reg_loss: 0.061418    l2_loss: 0.021923    loss: 0.275309
steps 7000    v_Prec: 0.738300  v_Recall: 0.661126  v_F1: 0.697586  v_AUC: 0.889605
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.187471    reg_loss: 0.061606    l2_loss: 0.022035    loss: 0.271112
steps 7200    v_Prec: 0.749286  v_Recall: 0.661757  v_F1: 0.702807  v_AUC: 0.891379
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.194057    reg_loss: 0.061804    l2_loss: 0.022223    loss: 0.278084
steps 7400    v_Prec: 0.760357  v_Recall: 0.657818  v_F1: 0.705381  v_AUC: 0.893201
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.193436    reg_loss: 0.061791    l2_loss: 0.022414    loss: 0.277641
steps 7600    v_Prec: 0.754526  v_Recall: 0.663174  v_F1: 0.705907  v_AUC: 0.892605
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.184495    reg_loss: 0.061463    l2_loss: 0.022381    loss: 0.268339
steps 7800    v_Prec: 0.767700  v_Recall: 0.659393  v_F1: 0.709437  v_AUC: 0.894722
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.191474    reg_loss: 0.061633    l2_loss: 0.022522    loss: 0.275629
steps 8000    v_Prec: 0.771563  v_Recall: 0.659551  v_F1: 0.711173  v_AUC: 0.894458
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.183417    reg_loss: 0.061830    l2_loss: 0.022625    loss: 0.267871
steps 8200    v_Prec: 0.754084  v_Recall: 0.676329  v_F1: 0.713093  v_AUC: 0.894960
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.186054    reg_loss: 0.061651    l2_loss: 0.022662    loss: 0.270367
steps 8400    v_Prec: 0.749247  v_Recall: 0.685388  v_F1: 0.715896  v_AUC: 0.896123
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.191044    reg_loss: 0.061767    l2_loss: 0.022744    loss: 0.275554
steps 8600    v_Prec: 0.772488  v_Recall: 0.671052  v_F1: 0.718206  v_AUC: 0.897568
steps 8600    running time 320 seconds

steps 8800    base_loss: 0.188254    reg_loss: 0.061459    l2_loss: 0.022862    loss: 0.272574
steps 8800    v_Prec: 0.791103  v_Recall: 0.658369  v_F1: 0.718659  v_AUC: 0.897360
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.189366    reg_loss: 0.061633    l2_loss: 0.022744    loss: 0.273744
steps 9000    v_Prec: 0.763446  v_Recall: 0.682080  v_F1: 0.720473  v_AUC: 0.899099
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.195838    reg_loss: 0.061741    l2_loss: 0.022812    loss: 0.280391
steps 9200    v_Prec: 0.775472  v_Recall: 0.676881  v_F1: 0.722830  v_AUC: 0.901131
steps 9200    running time 340 seconds

steps 9400    base_loss: 0.193502    reg_loss: 0.061793    l2_loss: 0.022984    loss: 0.278279
steps 9400    v_Prec: 0.793275  v_Recall: 0.667113  v_F1: 0.724744  v_AUC: 0.903133
steps 9400    running time 346 seconds

steps 9600    base_loss: 0.190172    reg_loss: 0.062068    l2_loss: 0.022997    loss: 0.275237
steps 9600    v_Prec: 0.778150  v_Recall: 0.677747  v_F1: 0.724486  v_AUC: 0.904169
steps 9600    running time 353 seconds

steps 9800    base_loss: 0.186446    reg_loss: 0.061737    l2_loss: 0.023082    loss: 0.271265
steps 9800    v_Prec: 0.791001  v_Recall: 0.678535  v_F1: 0.730464  v_AUC: 0.904821
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.198802    reg_loss: 0.061910    l2_loss: 0.023163    loss: 0.283875
steps 10000    v_Prec: 0.794153  v_Recall: 0.678299  v_F1: 0.731668  v_AUC: 0.906033
steps 10000    running time 366 seconds

steps 10200    base_loss: 0.180537    reg_loss: 0.061573    l2_loss: 0.023143    loss: 0.265253
steps 10200    v_Prec: 0.790446  v_Recall: 0.684285  v_F1: 0.733544  v_AUC: 0.907019
steps 10200    running time 372 seconds

steps 10400    base_loss: 0.189809    reg_loss: 0.061959    l2_loss: 0.023154    loss: 0.274922
steps 10400    v_Prec: 0.789251  v_Recall: 0.689405  v_F1: 0.735957  v_AUC: 0.908097
steps 10400    running time 379 seconds

steps 10600    base_loss: 0.188700    reg_loss: 0.061870    l2_loss: 0.023222    loss: 0.273792
steps 10600    v_Prec: 0.783745  v_Recall: 0.694289  v_F1: 0.736310  v_AUC: 0.908747
steps 10600    running time 386 seconds

steps 10800    base_loss: 0.168956    reg_loss: 0.061017    l2_loss: 0.023171    loss: 0.253144
steps 10800    v_Prec: 0.798242  v_Recall: 0.686570  v_F1: 0.738206  v_AUC: 0.908580
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.056317    reg_loss: 0.056517    l2_loss: 0.022998    loss: 0.135831
steps 11000    v_Prec: 0.778229  v_Recall: 0.694919  v_F1: 0.734218  v_AUC: 0.905806
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.055861    reg_loss: 0.056593    l2_loss: 0.022505    loss: 0.134959
steps 11200    v_Prec: 0.781331  v_Recall: 0.685073  v_F1: 0.730043  v_AUC: 0.902842
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.053533    reg_loss: 0.057042    l2_loss: 0.022142    loss: 0.132717
steps 11400    v_Prec: 0.785498  v_Recall: 0.674124  v_F1: 0.725562  v_AUC: 0.900095
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.060560    reg_loss: 0.057130    l2_loss: 0.021827    loss: 0.139517
steps 11600    v_Prec: 0.798712  v_Recall: 0.664199  v_F1: 0.725271  v_AUC: 0.899516
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.058914    reg_loss: 0.056806    l2_loss: 0.021558    loss: 0.137279
steps 11800    v_Prec: 0.769636  v_Recall: 0.679244  v_F1: 0.721620  v_AUC: 0.897358
steps 11800    running time 423 seconds

steps 12000    base_loss: 0.061713    reg_loss: 0.057199    l2_loss: 0.021417    loss: 0.140329
steps 12000    v_Prec: 0.764349  v_Recall: 0.683970  v_F1: 0.721929  v_AUC: 0.896751
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.061629    reg_loss: 0.056668    l2_loss: 0.021151    loss: 0.139448
steps 12200    v_Prec: 0.778435  v_Recall: 0.673887  v_F1: 0.722398  v_AUC: 0.896796
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.064041    reg_loss: 0.056666    l2_loss: 0.020988    loss: 0.141695
steps 12400    v_Prec: 0.770318  v_Recall: 0.682395  v_F1: 0.723696  v_AUC: 0.895889
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.060745    reg_loss: 0.056661    l2_loss: 0.020861    loss: 0.138267
steps 12600    v_Prec: 0.774553  v_Recall: 0.672785  v_F1: 0.720091  v_AUC: 0.895663
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.062454    reg_loss: 0.056468    l2_loss: 0.020562    loss: 0.139483
steps 12800    v_Prec: 0.762102  v_Recall: 0.680819  v_F1: 0.719171  v_AUC: 0.896176
steps 12800    running time 454 seconds

Early stop model F1: 0.738206
testing thre: 0.45558444
testing Prec: 0.6441891128272744
testing Recall: 0.6648845686512758
testing F1: 0.6543732510583339
testing AUC: 0.8839310223460857
overall running time 457 seconds
(0.7232802400738689, 0.6091373025516403, 0.6613196844576946, 0.8839310223460857, 0.6404256)

2019-02-24 17:11:14.024279: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:11:15.642004: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:11:15.646828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:11:15.646879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.730000 seconds
loading data in 30.830000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.739359    reg_loss: 0.065008    l2_loss: 0.013304    loss: 1.817671
steps 200    v_Prec: 0.163302  v_Recall: 1.000000  v_F1: 0.280756  v_AUC: 0.470867
steps 200    running time 41 seconds

steps 400    base_loss: 1.132332    reg_loss: 0.065798    l2_loss: 0.013252    loss: 1.211383
steps 400    v_Prec: 0.163308  v_Recall: 0.999920  v_F1: 0.280762  v_AUC: 0.488170
steps 400    running time 48 seconds

steps 600    base_loss: 0.536348    reg_loss: 0.066295    l2_loss: 0.013179    loss: 0.615822
steps 600    v_Prec: 0.163337  v_Recall: 0.999600  v_F1: 0.280792  v_AUC: 0.530857
steps 600    running time 54 seconds

steps 800    base_loss: 0.477477    reg_loss: 0.066242    l2_loss: 0.012997    loss: 0.556716
steps 800    v_Prec: 0.189130  v_Recall: 0.692609  v_F1: 0.297124  v_AUC: 0.589227
steps 800    running time 61 seconds

steps 1000    base_loss: 0.461544    reg_loss: 0.066015    l2_loss: 0.012787    loss: 0.540346
steps 1000    v_Prec: 0.300629  v_Recall: 0.435557  v_F1: 0.355728  v_AUC: 0.677479
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.427657    reg_loss: 0.065961    l2_loss: 0.012719    loss: 0.506337
steps 1200    v_Prec: 0.399339  v_Recall: 0.454095  v_F1: 0.424961  v_AUC: 0.742735
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.403729    reg_loss: 0.066000    l2_loss: 0.012662    loss: 0.482391
steps 1400    v_Prec: 0.465109  v_Recall: 0.496364  v_F1: 0.480229  v_AUC: 0.780347
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.383715    reg_loss: 0.066115    l2_loss: 0.012748    loss: 0.462577
steps 1600    v_Prec: 0.518145  v_Recall: 0.513384  v_F1: 0.515754  v_AUC: 0.806505
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.357534    reg_loss: 0.066496    l2_loss: 0.012866    loss: 0.436896
steps 1800    v_Prec: 0.577585  v_Recall: 0.517219  v_F1: 0.545738  v_AUC: 0.827407
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.338966    reg_loss: 0.066422    l2_loss: 0.013050    loss: 0.418437
steps 2000    v_Prec: 0.581604  v_Recall: 0.564363  v_F1: 0.572854  v_AUC: 0.842234
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.320108    reg_loss: 0.067096    l2_loss: 0.013258    loss: 0.400462
steps 2200    v_Prec: 0.593895  v_Recall: 0.584499  v_F1: 0.589159  v_AUC: 0.850027
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.318298    reg_loss: 0.067085    l2_loss: 0.013530    loss: 0.398913
steps 2400    v_Prec: 0.642336  v_Recall: 0.569557  v_F1: 0.603761  v_AUC: 0.858688
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.307135    reg_loss: 0.067413    l2_loss: 0.013841    loss: 0.388389
steps 2600    v_Prec: 0.628619  v_Recall: 0.607271  v_F1: 0.617761  v_AUC: 0.865130
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.306762    reg_loss: 0.067857    l2_loss: 0.014172    loss: 0.388791
steps 2800    v_Prec: 0.644623  v_Recall: 0.608310  v_F1: 0.625940  v_AUC: 0.869053
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.289708    reg_loss: 0.067620    l2_loss: 0.014519    loss: 0.371847
steps 3000    v_Prec: 0.679794  v_Recall: 0.590332  v_F1: 0.631912  v_AUC: 0.871382
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.290973    reg_loss: 0.067665    l2_loss: 0.014895    loss: 0.373533
steps 3200    v_Prec: 0.680949  v_Recall: 0.603196  v_F1: 0.639719  v_AUC: 0.875673
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.286493    reg_loss: 0.067837    l2_loss: 0.015294    loss: 0.369625
steps 3400    v_Prec: 0.682777  v_Recall: 0.612944  v_F1: 0.645979  v_AUC: 0.880473
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.283696    reg_loss: 0.067790    l2_loss: 0.015730    loss: 0.367216
steps 3600    v_Prec: 0.689819  v_Recall: 0.616620  v_F1: 0.651169  v_AUC: 0.883593
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.273931    reg_loss: 0.067754    l2_loss: 0.016132    loss: 0.357817
steps 3800    v_Prec: 0.678608  v_Recall: 0.631163  v_F1: 0.654026  v_AUC: 0.885708
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.281280    reg_loss: 0.067731    l2_loss: 0.016590    loss: 0.365601
steps 4000    v_Prec: 0.687804  v_Recall: 0.633560  v_F1: 0.659568  v_AUC: 0.888734
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.276919    reg_loss: 0.067895    l2_loss: 0.017086    loss: 0.361899
steps 4200    v_Prec: 0.696390  v_Recall: 0.622773  v_F1: 0.657527  v_AUC: 0.890902
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.279825    reg_loss: 0.067599    l2_loss: 0.017620    loss: 0.365044
steps 4400    v_Prec: 0.688467  v_Recall: 0.636756  v_F1: 0.661602  v_AUC: 0.893288
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.271678    reg_loss: 0.067680    l2_loss: 0.018058    loss: 0.357415
steps 4600    v_Prec: 0.690123  v_Recall: 0.642589  v_F1: 0.665508  v_AUC: 0.896058
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.267544    reg_loss: 0.067567    l2_loss: 0.018676    loss: 0.353786
steps 4800    v_Prec: 0.702981  v_Recall: 0.633160  v_F1: 0.666246  v_AUC: 0.898193
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.272849    reg_loss: 0.067620    l2_loss: 0.019233    loss: 0.359701
steps 5000    v_Prec: 0.691478  v_Recall: 0.640591  v_F1: 0.665063  v_AUC: 0.899929
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.275105    reg_loss: 0.067609    l2_loss: 0.019886    loss: 0.362600
steps 5200    v_Prec: 0.705888  v_Recall: 0.635158  v_F1: 0.668657  v_AUC: 0.899996
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.268053    reg_loss: 0.067415    l2_loss: 0.020570    loss: 0.356039
steps 5400    v_Prec: 0.706443  v_Recall: 0.639553  v_F1: 0.671336  v_AUC: 0.901141
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.178031    reg_loss: 0.067867    l2_loss: 0.021371    loss: 0.267269
steps 5600    v_Prec: 0.681792  v_Recall: 0.659129  v_F1: 0.670269  v_AUC: 0.898885
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.180570    reg_loss: 0.067685    l2_loss: 0.022235    loss: 0.270491
steps 5800    v_Prec: 0.708494  v_Recall: 0.629804  v_F1: 0.666836  v_AUC: 0.896116
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.175386    reg_loss: 0.067920    l2_loss: 0.022968    loss: 0.266274
steps 6000    v_Prec: 0.699388  v_Recall: 0.638753  v_F1: 0.667697  v_AUC: 0.895812
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.188072    reg_loss: 0.068031    l2_loss: 0.023676    loss: 0.279779
steps 6200    v_Prec: 0.672171  v_Recall: 0.647303  v_F1: 0.659503  v_AUC: 0.893108
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.188425    reg_loss: 0.068036    l2_loss: 0.024206    loss: 0.280668
steps 6400    v_Prec: 0.686714  v_Recall: 0.645945  v_F1: 0.665706  v_AUC: 0.894917
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.191394    reg_loss: 0.067935    l2_loss: 0.024699    loss: 0.284028
steps 6600    v_Prec: 0.697957  v_Recall: 0.638674  v_F1: 0.667000  v_AUC: 0.894569
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.187001    reg_loss: 0.067943    l2_loss: 0.025276    loss: 0.280220
steps 6800    v_Prec: 0.687917  v_Recall: 0.650100  v_F1: 0.668474  v_AUC: 0.894155
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.184644    reg_loss: 0.067968    l2_loss: 0.025709    loss: 0.278321
steps 7000    v_Prec: 0.692282  v_Recall: 0.651458  v_F1: 0.671250  v_AUC: 0.895923
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.184357    reg_loss: 0.067850    l2_loss: 0.026249    loss: 0.278456
steps 7200    v_Prec: 0.698705  v_Recall: 0.646504  v_F1: 0.671592  v_AUC: 0.895777
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.185298    reg_loss: 0.067532    l2_loss: 0.026685    loss: 0.279516
steps 7400    v_Prec: 0.695604  v_Recall: 0.646025  v_F1: 0.669898  v_AUC: 0.896621
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.189489    reg_loss: 0.067856    l2_loss: 0.027027    loss: 0.284371
steps 7600    v_Prec: 0.703217  v_Recall: 0.641071  v_F1: 0.670707  v_AUC: 0.895895
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.192646    reg_loss: 0.067522    l2_loss: 0.027431    loss: 0.287599
steps 7800    v_Prec: 0.703081  v_Recall: 0.654654  v_F1: 0.678004  v_AUC: 0.898489
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.190276    reg_loss: 0.067633    l2_loss: 0.027755    loss: 0.285664
steps 8000    v_Prec: 0.710851  v_Recall: 0.654335  v_F1: 0.681423  v_AUC: 0.900511
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.192236    reg_loss: 0.067369    l2_loss: 0.028101    loss: 0.287706
steps 8200    v_Prec: 0.717922  v_Recall: 0.651378  v_F1: 0.683033  v_AUC: 0.900340
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.190772    reg_loss: 0.067346    l2_loss: 0.028439    loss: 0.286557
steps 8400    v_Prec: 0.716793  v_Recall: 0.659289  v_F1: 0.686839  v_AUC: 0.903598
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.193179    reg_loss: 0.067558    l2_loss: 0.028787    loss: 0.289524
steps 8600    v_Prec: 0.721374  v_Recall: 0.664483  v_F1: 0.691761  v_AUC: 0.906049
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.178214    reg_loss: 0.067272    l2_loss: 0.028984    loss: 0.274471
steps 8800    v_Prec: 0.715715  v_Recall: 0.668877  v_F1: 0.691504  v_AUC: 0.905714
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.179097    reg_loss: 0.067160    l2_loss: 0.029309    loss: 0.275565
steps 9000    v_Prec: 0.746834  v_Recall: 0.659768  v_F1: 0.700607  v_AUC: 0.908243
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.191665    reg_loss: 0.067314    l2_loss: 0.029506    loss: 0.288485
steps 9200    v_Prec: 0.736381  v_Recall: 0.665362  v_F1: 0.699072  v_AUC: 0.907952
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.191795    reg_loss: 0.067255    l2_loss: 0.029724    loss: 0.288775
steps 9400    v_Prec: 0.736805  v_Recall: 0.675989  v_F1: 0.705088  v_AUC: 0.909150
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.188822    reg_loss: 0.067116    l2_loss: 0.029910    loss: 0.285848
steps 9600    v_Prec: 0.740049  v_Recall: 0.674471  v_F1: 0.705740  v_AUC: 0.910871
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.186228    reg_loss: 0.067375    l2_loss: 0.030185    loss: 0.283788
steps 9800    v_Prec: 0.741955  v_Recall: 0.670635  v_F1: 0.704495  v_AUC: 0.911315
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.189637    reg_loss: 0.067039    l2_loss: 0.030385    loss: 0.287061
steps 10000    v_Prec: 0.731670  v_Recall: 0.693728  v_F1: 0.712194  v_AUC: 0.914649
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.187141    reg_loss: 0.066902    l2_loss: 0.030532    loss: 0.284575
steps 10200    v_Prec: 0.735873  v_Recall: 0.686776  v_F1: 0.710477  v_AUC: 0.914862
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.179528    reg_loss: 0.067059    l2_loss: 0.030858    loss: 0.277446
steps 10400    v_Prec: 0.745610  v_Recall: 0.688773  v_F1: 0.716066  v_AUC: 0.917314
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.187180    reg_loss: 0.066735    l2_loss: 0.030960    loss: 0.284876
steps 10600    v_Prec: 0.755561  v_Recall: 0.678466  v_F1: 0.714941  v_AUC: 0.916983
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.171760    reg_loss: 0.066665    l2_loss: 0.031087    loss: 0.269512
steps 10800    v_Prec: 0.766808  v_Recall: 0.678945  v_F1: 0.720207  v_AUC: 0.918853
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.077564    reg_loss: 0.065852    l2_loss: 0.031230    loss: 0.174646
steps 11000    v_Prec: 0.733872  v_Recall: 0.675350  v_F1: 0.703395  v_AUC: 0.910969
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.079935    reg_loss: 0.065849    l2_loss: 0.031340    loss: 0.177124
steps 11200    v_Prec: 0.722576  v_Recall: 0.680543  v_F1: 0.700930  v_AUC: 0.909527
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.080229    reg_loss: 0.065665    l2_loss: 0.031623    loss: 0.177517
steps 11400    v_Prec: 0.699210  v_Recall: 0.679265  v_F1: 0.689093  v_AUC: 0.904710
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.075711    reg_loss: 0.065570    l2_loss: 0.031650    loss: 0.172931
steps 11600    v_Prec: 0.715822  v_Recall: 0.659369  v_F1: 0.686437  v_AUC: 0.901449
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.089005    reg_loss: 0.065643    l2_loss: 0.031729    loss: 0.186377
steps 11800    v_Prec: 0.726599  v_Recall: 0.650659  v_F1: 0.686536  v_AUC: 0.901505
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.081764    reg_loss: 0.065825    l2_loss: 0.031954    loss: 0.179544
steps 12000    v_Prec: 0.729550  v_Recall: 0.647064  v_F1: 0.685835  v_AUC: 0.898738
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.090088    reg_loss: 0.065634    l2_loss: 0.032040    loss: 0.187762
steps 12200    v_Prec: 0.723226  v_Recall: 0.649141  v_F1: 0.684184  v_AUC: 0.898824
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.090341    reg_loss: 0.065524    l2_loss: 0.032147    loss: 0.188011
steps 12400    v_Prec: 0.707184  v_Recall: 0.663843  v_F1: 0.684829  v_AUC: 0.898425
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.087750    reg_loss: 0.065554    l2_loss: 0.032258    loss: 0.185562
steps 12600    v_Prec: 0.711793  v_Recall: 0.665042  v_F1: 0.687624  v_AUC: 0.898941
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.089934    reg_loss: 0.065637    l2_loss: 0.032283    loss: 0.187855
steps 12800    v_Prec: 0.707146  v_Recall: 0.660248  v_F1: 0.682893  v_AUC: 0.898008
steps 12800    running time 453 seconds

Early stop model F1: 0.720207
testing thre: 0.37328
testing Prec: 0.5485598029767641
testing Recall: 0.7469744835965978
testing F1: 0.6325732630885742
testing AUC: 0.9002720241844874
overall running time 456 seconds
(0.7002034696937246, 0.6355771567436209, 0.6663269725612087, 0.9002720241844874, 0.6778498)

2019-02-24 17:16:12.881651: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:16:14.096913: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:16:14.103332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:16:14.103481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.140000 seconds
loading data in 30.310000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.268068    reg_loss: 0.065065    l2_loss: 0.013348    loss: 1.346481
steps 200    v_Prec: 0.165077  v_Recall: 0.991601  v_F1: 0.283036  v_AUC: 0.519561
steps 200    running time 40 seconds

steps 400    base_loss: 0.771652    reg_loss: 0.064656    l2_loss: 0.013490    loss: 0.849798
steps 400    v_Prec: 0.164662  v_Recall: 1.000000  v_F1: 0.282763  v_AUC: 0.495830
steps 400    running time 47 seconds

steps 600    base_loss: 0.497569    reg_loss: 0.064659    l2_loss: 0.013451    loss: 0.575679
steps 600    v_Prec: 0.178342  v_Recall: 0.756498  v_F1: 0.288638  v_AUC: 0.559003
steps 600    running time 53 seconds

steps 800    base_loss: 0.475865    reg_loss: 0.064406    l2_loss: 0.013273    loss: 0.553544
steps 800    v_Prec: 0.189287  v_Recall: 0.652456  v_F1: 0.293443  v_AUC: 0.584321
steps 800    running time 60 seconds

steps 1000    base_loss: 0.463090    reg_loss: 0.063934    l2_loss: 0.013097    loss: 0.540121
steps 1000    v_Prec: 0.212145  v_Recall: 0.606815  v_F1: 0.314381  v_AUC: 0.618603
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.448217    reg_loss: 0.063307    l2_loss: 0.012972    loss: 0.524496
steps 1200    v_Prec: 0.277530  v_Recall: 0.438748  v_F1: 0.339996  v_AUC: 0.651711
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.428859    reg_loss: 0.062528    l2_loss: 0.012978    loss: 0.504365
steps 1400    v_Prec: 0.378444  v_Recall: 0.454913  v_F1: 0.413170  v_AUC: 0.717079
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.416667    reg_loss: 0.061636    l2_loss: 0.013061    loss: 0.491363
steps 1600    v_Prec: 0.489834  v_Recall: 0.458162  v_F1: 0.473469  v_AUC: 0.763114
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.388119    reg_loss: 0.060612    l2_loss: 0.013219    loss: 0.461949
steps 1800    v_Prec: 0.531463  v_Recall: 0.505943  v_F1: 0.518389  v_AUC: 0.796955
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.358324    reg_loss: 0.059519    l2_loss: 0.013469    loss: 0.431311
steps 2000    v_Prec: 0.590849  v_Recall: 0.527971  v_F1: 0.557643  v_AUC: 0.821012
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.339189    reg_loss: 0.058967    l2_loss: 0.013751    loss: 0.411908
steps 2200    v_Prec: 0.634419  v_Recall: 0.545087  v_F1: 0.586370  v_AUC: 0.838070
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.329204    reg_loss: 0.058428    l2_loss: 0.014073    loss: 0.401704
steps 2400    v_Prec: 0.662190  v_Recall: 0.562599  v_F1: 0.608345  v_AUC: 0.851122
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.318064    reg_loss: 0.057511    l2_loss: 0.014450    loss: 0.390025
steps 2600    v_Prec: 0.684345  v_Recall: 0.572583  v_F1: 0.623495  v_AUC: 0.859981
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.305977    reg_loss: 0.056890    l2_loss: 0.014825    loss: 0.377691
steps 2800    v_Prec: 0.698135  v_Recall: 0.584231  v_F1: 0.636124  v_AUC: 0.868083
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.301008    reg_loss: 0.056400    l2_loss: 0.015306    loss: 0.372715
steps 3000    v_Prec: 0.698139  v_Recall: 0.600555  v_F1: 0.645681  v_AUC: 0.872025
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.296435    reg_loss: 0.056035    l2_loss: 0.015666    loss: 0.368136
steps 3200    v_Prec: 0.714447  v_Recall: 0.599921  v_F1: 0.652195  v_AUC: 0.875215
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.293623    reg_loss: 0.055348    l2_loss: 0.016135    loss: 0.365105
steps 3400    v_Prec: 0.717467  v_Recall: 0.605071  v_F1: 0.656493  v_AUC: 0.876894
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.285716    reg_loss: 0.054995    l2_loss: 0.016493    loss: 0.357203
steps 3600    v_Prec: 0.714544  v_Recall: 0.625990  v_F1: 0.667342  v_AUC: 0.880871
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.286076    reg_loss: 0.054651    l2_loss: 0.016881    loss: 0.357608
steps 3800    v_Prec: 0.730787  v_Recall: 0.618621  v_F1: 0.670042  v_AUC: 0.881640
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.283110    reg_loss: 0.054194    l2_loss: 0.017272    loss: 0.354576
steps 4000    v_Prec: 0.769852  v_Recall: 0.604596  v_F1: 0.677289  v_AUC: 0.884289
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.286743    reg_loss: 0.053983    l2_loss: 0.017773    loss: 0.358500
steps 4200    v_Prec: 0.735960  v_Recall: 0.633439  v_F1: 0.680862  v_AUC: 0.885161
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.275355    reg_loss: 0.053679    l2_loss: 0.018167    loss: 0.347200
steps 4400    v_Prec: 0.717839  v_Recall: 0.653962  v_F1: 0.684413  v_AUC: 0.888395
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.274351    reg_loss: 0.053527    l2_loss: 0.018688    loss: 0.346566
steps 4600    v_Prec: 0.701432  v_Recall: 0.675198  v_F1: 0.688065  v_AUC: 0.892744
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.270305    reg_loss: 0.053129    l2_loss: 0.019054    loss: 0.342489
steps 4800    v_Prec: 0.734832  v_Recall: 0.652615  v_F1: 0.691288  v_AUC: 0.895028
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.266871    reg_loss: 0.052869    l2_loss: 0.019498    loss: 0.339238
steps 5000    v_Prec: 0.746220  v_Recall: 0.653090  v_F1: 0.696556  v_AUC: 0.897586
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.264825    reg_loss: 0.052742    l2_loss: 0.020044    loss: 0.337611
steps 5200    v_Prec: 0.757704  v_Recall: 0.652694  v_F1: 0.701290  v_AUC: 0.898725
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.258132    reg_loss: 0.052272    l2_loss: 0.020554    loss: 0.330958
steps 5400    v_Prec: 0.757434  v_Recall: 0.655943  v_F1: 0.703045  v_AUC: 0.900022
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.179950    reg_loss: 0.049880    l2_loss: 0.020994    loss: 0.250824
steps 5600    v_Prec: 0.740464  v_Recall: 0.667591  v_F1: 0.702142  v_AUC: 0.898801
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.172973    reg_loss: 0.049706    l2_loss: 0.021666    loss: 0.244345
steps 5800    v_Prec: 0.722222  v_Recall: 0.675753  v_F1: 0.698215  v_AUC: 0.896957
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.182107    reg_loss: 0.049674    l2_loss: 0.022278    loss: 0.254060
steps 6000    v_Prec: 0.745570  v_Recall: 0.660143  v_F1: 0.700261  v_AUC: 0.895382
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.185643    reg_loss: 0.049676    l2_loss: 0.022850    loss: 0.258170
steps 6200    v_Prec: 0.759618  v_Recall: 0.649287  v_F1: 0.700132  v_AUC: 0.895499
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.181419    reg_loss: 0.049245    l2_loss: 0.023286    loss: 0.253950
steps 6400    v_Prec: 0.733690  v_Recall: 0.662995  v_F1: 0.696553  v_AUC: 0.893669
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.190858    reg_loss: 0.049210    l2_loss: 0.023762    loss: 0.263830
steps 6600    v_Prec: 0.741569  v_Recall: 0.662124  v_F1: 0.699598  v_AUC: 0.896183
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.181755    reg_loss: 0.048836    l2_loss: 0.024180    loss: 0.254771
steps 6800    v_Prec: 0.741859  v_Recall: 0.666086  v_F1: 0.701933  v_AUC: 0.897058
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.187773    reg_loss: 0.048703    l2_loss: 0.024560    loss: 0.261035
steps 7000    v_Prec: 0.739409  v_Recall: 0.676307  v_F1: 0.706452  v_AUC: 0.899266
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.173114    reg_loss: 0.048351    l2_loss: 0.024925    loss: 0.246389
steps 7200    v_Prec: 0.744321  v_Recall: 0.669889  v_F1: 0.705146  v_AUC: 0.899200
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.182237    reg_loss: 0.048444    l2_loss: 0.025122    loss: 0.255803
steps 7400    v_Prec: 0.747761  v_Recall: 0.674881  v_F1: 0.709454  v_AUC: 0.900336
steps 7400    running time 275 seconds

steps 7600    base_loss: 0.186985    reg_loss: 0.048400    l2_loss: 0.025386    loss: 0.260771
steps 7600    v_Prec: 0.755817  v_Recall: 0.676941  v_F1: 0.714208  v_AUC: 0.901592
steps 7600    running time 281 seconds

steps 7800    base_loss: 0.185035    reg_loss: 0.048153    l2_loss: 0.025690    loss: 0.258878
steps 7800    v_Prec: 0.777139  v_Recall: 0.663708  v_F1: 0.715959  v_AUC: 0.901432
steps 7800    running time 288 seconds

steps 8000    base_loss: 0.183479    reg_loss: 0.047829    l2_loss: 0.025884    loss: 0.257192
steps 8000    v_Prec: 0.764077  v_Recall: 0.674168  v_F1: 0.716312  v_AUC: 0.903309
steps 8000    running time 294 seconds

steps 8200    base_loss: 0.192858    reg_loss: 0.047747    l2_loss: 0.026048    loss: 0.266653
steps 8200    v_Prec: 0.774776  v_Recall: 0.670285  v_F1: 0.718753  v_AUC: 0.905933
steps 8200    running time 301 seconds

steps 8400    base_loss: 0.182681    reg_loss: 0.047782    l2_loss: 0.026209    loss: 0.256672
steps 8400    v_Prec: 0.764503  v_Recall: 0.683994  v_F1: 0.722011  v_AUC: 0.907312
steps 8400    running time 308 seconds

steps 8600    base_loss: 0.193450    reg_loss: 0.047607    l2_loss: 0.026346    loss: 0.267403
steps 8600    v_Prec: 0.776568  v_Recall: 0.678051  v_F1: 0.723973  v_AUC: 0.909592
steps 8600    running time 314 seconds

steps 8800    base_loss: 0.183225    reg_loss: 0.047069    l2_loss: 0.026366    loss: 0.256660
steps 8800    v_Prec: 0.763424  v_Recall: 0.688352  v_F1: 0.723947  v_AUC: 0.907989
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.186894    reg_loss: 0.047151    l2_loss: 0.026485    loss: 0.260530
steps 9000    v_Prec: 0.761028  v_Recall: 0.701268  v_F1: 0.729927  v_AUC: 0.909460
steps 9000    running time 327 seconds

steps 9200    base_loss: 0.194173    reg_loss: 0.047116    l2_loss: 0.026576    loss: 0.267865
steps 9200    v_Prec: 0.794905  v_Recall: 0.677496  v_F1: 0.731520  v_AUC: 0.910886
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.182565    reg_loss: 0.046742    l2_loss: 0.026631    loss: 0.255937
steps 9400    v_Prec: 0.783068  v_Recall: 0.686767  v_F1: 0.731763  v_AUC: 0.910698
steps 9400    running time 340 seconds

steps 9600    base_loss: 0.193575    reg_loss: 0.046839    l2_loss: 0.026809    loss: 0.267222
steps 9600    v_Prec: 0.780162  v_Recall: 0.688669  v_F1: 0.731566  v_AUC: 0.912098
steps 9600    running time 347 seconds

steps 9800    base_loss: 0.193287    reg_loss: 0.046732    l2_loss: 0.026876    loss: 0.266895
steps 9800    v_Prec: 0.757099  v_Recall: 0.716244  v_F1: 0.736105  v_AUC: 0.915880
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.195390    reg_loss: 0.046456    l2_loss: 0.026972    loss: 0.268818
steps 10000    v_Prec: 0.785529  v_Recall: 0.696830  v_F1: 0.738526  v_AUC: 0.914630
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.191327    reg_loss: 0.046220    l2_loss: 0.027092    loss: 0.264639
steps 10200    v_Prec: 0.790446  v_Recall: 0.694929  v_F1: 0.739616  v_AUC: 0.917580
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.190189    reg_loss: 0.046323    l2_loss: 0.026985    loss: 0.263498
steps 10400    v_Prec: 0.768109  v_Recall: 0.713391  v_F1: 0.739740  v_AUC: 0.919140
steps 10400    running time 373 seconds

steps 10600    base_loss: 0.184973    reg_loss: 0.045981    l2_loss: 0.027049    loss: 0.258003
steps 10600    v_Prec: 0.759300  v_Recall: 0.718146  v_F1: 0.738150  v_AUC: 0.917690
steps 10600    running time 379 seconds

steps 10800    base_loss: 0.175660    reg_loss: 0.045327    l2_loss: 0.027047    loss: 0.248034
steps 10800    v_Prec: 0.767320  v_Recall: 0.717036  v_F1: 0.741326  v_AUC: 0.919190
steps 10800    running time 385 seconds

steps 11000    base_loss: 0.076684    reg_loss: 0.041524    l2_loss: 0.027025    loss: 0.145233
steps 11000    v_Prec: 0.786484  v_Recall: 0.694374  v_F1: 0.737564  v_AUC: 0.915008
steps 11000    running time 392 seconds

steps 11200    base_loss: 0.074963    reg_loss: 0.041778    l2_loss: 0.027097    loss: 0.143838
steps 11200    v_Prec: 0.762470  v_Recall: 0.702536  v_F1: 0.731277  v_AUC: 0.912244
steps 11200    running time 398 seconds

steps 11400    base_loss: 0.068981    reg_loss: 0.041576    l2_loss: 0.027028    loss: 0.137585
steps 11400    v_Prec: 0.799589  v_Recall: 0.678447  v_F1: 0.734053  v_AUC: 0.911887
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.080307    reg_loss: 0.042030    l2_loss: 0.027086    loss: 0.149423
steps 11600    v_Prec: 0.780104  v_Recall: 0.687876  v_F1: 0.731093  v_AUC: 0.911006
steps 11600    running time 411 seconds

steps 11800    base_loss: 0.076545    reg_loss: 0.041988    l2_loss: 0.027106    loss: 0.145639
steps 11800    v_Prec: 0.763841  v_Recall: 0.704041  v_F1: 0.732723  v_AUC: 0.910887
steps 11800    running time 417 seconds

steps 12000    base_loss: 0.085728    reg_loss: 0.042404    l2_loss: 0.027082    loss: 0.155214
steps 12000    v_Prec: 0.781863  v_Recall: 0.685895  v_F1: 0.730742  v_AUC: 0.909227
steps 12000    running time 423 seconds

steps 12200    base_loss: 0.082079    reg_loss: 0.042151    l2_loss: 0.027204    loss: 0.151434
steps 12200    v_Prec: 0.771074  v_Recall: 0.693661  v_F1: 0.730322  v_AUC: 0.910581
steps 12200    running time 429 seconds

steps 12400    base_loss: 0.079875    reg_loss: 0.041957    l2_loss: 0.027061    loss: 0.148894
steps 12400    v_Prec: 0.778306  v_Recall: 0.687956  v_F1: 0.730347  v_AUC: 0.910639
steps 12400    running time 435 seconds

steps 12600    base_loss: 0.082815    reg_loss: 0.042080    l2_loss: 0.027074    loss: 0.151968
steps 12600    v_Prec: 0.767615  v_Recall: 0.694929  v_F1: 0.729466  v_AUC: 0.910555
steps 12600    running time 441 seconds

steps 12800    base_loss: 0.083327    reg_loss: 0.042138    l2_loss: 0.027050    loss: 0.152515
steps 12800    v_Prec: 0.762746  v_Recall: 0.698257  v_F1: 0.729078  v_AUC: 0.911565
steps 12800    running time 447 seconds

Early stop model F1: 0.741326
testing thre: 0.41373867
testing Prec: 0.5438310031635881
testing Recall: 0.7770109356014581
testing F1: 0.6398383094532938
testing AUC: 0.9023987909613271
overall running time 450 seconds
(0.7408812046848857, 0.6456379100850547, 0.6899883132060771, 0.9023987909613271, 0.8108611)

2019-02-24 17:21:09.122870: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:21:10.063666: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:21:10.074887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:21:10.074937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.060000 seconds
loading data in 31.260000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.778440    reg_loss: 0.064709    l2_loss: 0.013366    loss: 0.856515
steps 200    v_Prec: 0.163518  v_Recall: 0.990324  v_F1: 0.280689  v_AUC: 0.509388
steps 200    running time 41 seconds

steps 400    base_loss: 0.595315    reg_loss: 0.064325    l2_loss: 0.013478    loss: 0.673118
steps 400    v_Prec: 0.172698  v_Recall: 0.839984  v_F1: 0.286494  v_AUC: 0.545975
steps 400    running time 48 seconds

steps 600    base_loss: 0.491311    reg_loss: 0.063979    l2_loss: 0.013512    loss: 0.568802
steps 600    v_Prec: 0.181486  v_Recall: 0.770892  v_F1: 0.293804  v_AUC: 0.573732
steps 600    running time 54 seconds

steps 800    base_loss: 0.477162    reg_loss: 0.063796    l2_loss: 0.013287    loss: 0.554244
steps 800    v_Prec: 0.211822  v_Recall: 0.609516  v_F1: 0.314387  v_AUC: 0.619946
steps 800    running time 61 seconds

steps 1000    base_loss: 0.452790    reg_loss: 0.063414    l2_loss: 0.013123    loss: 0.529328
steps 1000    v_Prec: 0.231061  v_Recall: 0.526829  v_F1: 0.321233  v_AUC: 0.631437
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.443201    reg_loss: 0.063017    l2_loss: 0.013029    loss: 0.519247
steps 1200    v_Prec: 0.272623  v_Recall: 0.493403  v_F1: 0.351197  v_AUC: 0.667000
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.425081    reg_loss: 0.062514    l2_loss: 0.013013    loss: 0.500608
steps 1400    v_Prec: 0.369209  v_Recall: 0.414234  v_F1: 0.390428  v_AUC: 0.699350
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.401344    reg_loss: 0.061805    l2_loss: 0.013096    loss: 0.476245
steps 1600    v_Prec: 0.464289  v_Recall: 0.441343  v_F1: 0.452525  v_AUC: 0.745327
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.379648    reg_loss: 0.061194    l2_loss: 0.013167    loss: 0.454009
steps 1800    v_Prec: 0.530207  v_Recall: 0.473731  v_F1: 0.500380  v_AUC: 0.781177
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.362500    reg_loss: 0.060695    l2_loss: 0.013373    loss: 0.436567
steps 2000    v_Prec: 0.548499  v_Recall: 0.533147  v_F1: 0.540714  v_AUC: 0.809080
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.347784    reg_loss: 0.060206    l2_loss: 0.013616    loss: 0.421606
steps 2200    v_Prec: 0.569226  v_Recall: 0.569772  v_F1: 0.569499  v_AUC: 0.828092
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.331833    reg_loss: 0.059477    l2_loss: 0.013847    loss: 0.405157
steps 2400    v_Prec: 0.649855  v_Recall: 0.555378  v_F1: 0.598913  v_AUC: 0.843365
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.315052    reg_loss: 0.058924    l2_loss: 0.014058    loss: 0.388034
steps 2600    v_Prec: 0.653760  v_Recall: 0.581927  v_F1: 0.615756  v_AUC: 0.853482
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.302714    reg_loss: 0.058455    l2_loss: 0.014291    loss: 0.375460
steps 2800    v_Prec: 0.683975  v_Recall: 0.587765  v_F1: 0.632231  v_AUC: 0.860885
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.301214    reg_loss: 0.058482    l2_loss: 0.014609    loss: 0.374305
steps 3000    v_Prec: 0.684578  v_Recall: 0.603119  v_F1: 0.641272  v_AUC: 0.869713
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.299885    reg_loss: 0.058172    l2_loss: 0.014914    loss: 0.372972
steps 3200    v_Prec: 0.703049  v_Recall: 0.604718  v_F1: 0.650187  v_AUC: 0.875180
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.288620    reg_loss: 0.057695    l2_loss: 0.015300    loss: 0.361614
steps 3400    v_Prec: 0.711015  v_Recall: 0.618393  v_F1: 0.661477  v_AUC: 0.880736
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.281696    reg_loss: 0.057627    l2_loss: 0.015737    loss: 0.355059
steps 3600    v_Prec: 0.730780  v_Recall: 0.621032  v_F1: 0.671451  v_AUC: 0.883800
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.275063    reg_loss: 0.057124    l2_loss: 0.015918    loss: 0.348104
steps 3800    v_Prec: 0.739403  v_Recall: 0.622151  v_F1: 0.675728  v_AUC: 0.887465
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.270051    reg_loss: 0.056966    l2_loss: 0.016320    loss: 0.343337
steps 4000    v_Prec: 0.719210  v_Recall: 0.649100  v_F1: 0.682359  v_AUC: 0.890359
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.270234    reg_loss: 0.056797    l2_loss: 0.016724    loss: 0.343755
steps 4200    v_Prec: 0.741110  v_Recall: 0.641663  v_F1: 0.687811  v_AUC: 0.893137
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.274125    reg_loss: 0.056544    l2_loss: 0.017010    loss: 0.347680
steps 4400    v_Prec: 0.724705  v_Recall: 0.648381  v_F1: 0.684422  v_AUC: 0.895444
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.267650    reg_loss: 0.056158    l2_loss: 0.017429    loss: 0.341236
steps 4600    v_Prec: 0.700363  v_Recall: 0.679248  v_F1: 0.689644  v_AUC: 0.897211
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.270071    reg_loss: 0.056093    l2_loss: 0.017887    loss: 0.344051
steps 4800    v_Prec: 0.749112  v_Recall: 0.640864  v_F1: 0.690773  v_AUC: 0.898586
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.262706    reg_loss: 0.055828    l2_loss: 0.018309    loss: 0.336843
steps 5000    v_Prec: 0.747366  v_Recall: 0.652459  v_F1: 0.696695  v_AUC: 0.900584
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.264738    reg_loss: 0.055427    l2_loss: 0.018771    loss: 0.338936
steps 5200    v_Prec: 0.759394  v_Recall: 0.652939  v_F1: 0.702154  v_AUC: 0.902882
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.259297    reg_loss: 0.055283    l2_loss: 0.019251    loss: 0.333831
steps 5400    v_Prec: 0.741680  v_Recall: 0.673651  v_F1: 0.706030  v_AUC: 0.904826
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.184237    reg_loss: 0.051551    l2_loss: 0.019707    loss: 0.255495
steps 5600    v_Prec: 0.729718  v_Recall: 0.674690  v_F1: 0.701126  v_AUC: 0.902554
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.183084    reg_loss: 0.051317    l2_loss: 0.020403    loss: 0.254804
steps 5800    v_Prec: 0.763596  v_Recall: 0.656857  v_F1: 0.706216  v_AUC: 0.903355
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.183659    reg_loss: 0.051013    l2_loss: 0.021123    loss: 0.255795
steps 6000    v_Prec: 0.742004  v_Recall: 0.669732  v_F1: 0.704018  v_AUC: 0.901638
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.172301    reg_loss: 0.050370    l2_loss: 0.021676    loss: 0.244347
steps 6200    v_Prec: 0.744903  v_Recall: 0.672051  v_F1: 0.706604  v_AUC: 0.902060
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.173072    reg_loss: 0.050452    l2_loss: 0.022164    loss: 0.245689
steps 6400    v_Prec: 0.758678  v_Recall: 0.660696  v_F1: 0.706305  v_AUC: 0.902172
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.177122    reg_loss: 0.050380    l2_loss: 0.022679    loss: 0.250181
steps 6600    v_Prec: 0.759652  v_Recall: 0.662455  v_F1: 0.707732  v_AUC: 0.903136
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.170192    reg_loss: 0.049871    l2_loss: 0.023183    loss: 0.243246
steps 6800    v_Prec: 0.758939  v_Recall: 0.663655  v_F1: 0.708106  v_AUC: 0.904010
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.187523    reg_loss: 0.050264    l2_loss: 0.023457    loss: 0.261245
steps 7000    v_Prec: 0.749910  v_Recall: 0.669492  v_F1: 0.707423  v_AUC: 0.904491
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.183929    reg_loss: 0.049892    l2_loss: 0.023762    loss: 0.257583
steps 7200    v_Prec: 0.742000  v_Recall: 0.680528  v_F1: 0.709936  v_AUC: 0.905592
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.182783    reg_loss: 0.049659    l2_loss: 0.024023    loss: 0.256465
steps 7400    v_Prec: 0.745081  v_Recall: 0.690444  v_F1: 0.716723  v_AUC: 0.909573
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.179330    reg_loss: 0.049493    l2_loss: 0.024212    loss: 0.253036
steps 7600    v_Prec: 0.768522  v_Recall: 0.673571  v_F1: 0.717920  v_AUC: 0.909551
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.190137    reg_loss: 0.049652    l2_loss: 0.024416    loss: 0.264205
steps 7800    v_Prec: 0.774357  v_Recall: 0.671811  v_F1: 0.719448  v_AUC: 0.911449
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.188172    reg_loss: 0.049353    l2_loss: 0.024631    loss: 0.262157
steps 8000    v_Prec: 0.766321  v_Recall: 0.680528  v_F1: 0.720881  v_AUC: 0.912121
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.190689    reg_loss: 0.049235    l2_loss: 0.024747    loss: 0.264672
steps 8200    v_Prec: 0.758590  v_Recall: 0.692043  v_F1: 0.723790  v_AUC: 0.913016
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.185399    reg_loss: 0.049033    l2_loss: 0.024783    loss: 0.259214
steps 8400    v_Prec: 0.772443  v_Recall: 0.680528  v_F1: 0.723578  v_AUC: 0.913724
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.185905    reg_loss: 0.048893    l2_loss: 0.025134    loss: 0.259932
steps 8600    v_Prec: 0.788565  v_Recall: 0.668373  v_F1: 0.723511  v_AUC: 0.914888
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.184923    reg_loss: 0.048825    l2_loss: 0.025192    loss: 0.258939
steps 8800    v_Prec: 0.794814  v_Recall: 0.674050  v_F1: 0.729468  v_AUC: 0.914673
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.175879    reg_loss: 0.048522    l2_loss: 0.025247    loss: 0.249647
steps 9000    v_Prec: 0.774746  v_Recall: 0.687885  v_F1: 0.728736  v_AUC: 0.915811
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.181736    reg_loss: 0.048458    l2_loss: 0.025301    loss: 0.255495
steps 9200    v_Prec: 0.786908  v_Recall: 0.685406  v_F1: 0.732658  v_AUC: 0.918760
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.189010    reg_loss: 0.048663    l2_loss: 0.025360    loss: 0.263032
steps 9400    v_Prec: 0.796061  v_Recall: 0.685166  v_F1: 0.736462  v_AUC: 0.919522
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.192773    reg_loss: 0.048376    l2_loss: 0.025416    loss: 0.266564
steps 9600    v_Prec: 0.792451  v_Recall: 0.690044  v_F1: 0.737711  v_AUC: 0.919258
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.189341    reg_loss: 0.048457    l2_loss: 0.025488    loss: 0.263285
steps 9800    v_Prec: 0.787251  v_Recall: 0.693323  v_F1: 0.737308  v_AUC: 0.920646
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.188166    reg_loss: 0.048330    l2_loss: 0.025607    loss: 0.262104
steps 10000    v_Prec: 0.784759  v_Recall: 0.699160  v_F1: 0.739491  v_AUC: 0.921000
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.180603    reg_loss: 0.048050    l2_loss: 0.025664    loss: 0.254317
steps 10200    v_Prec: 0.776365  v_Recall: 0.708197  v_F1: 0.740716  v_AUC: 0.920124
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.195111    reg_loss: 0.048100    l2_loss: 0.025659    loss: 0.268870
steps 10400    v_Prec: 0.776274  v_Recall: 0.711156  v_F1: 0.742290  v_AUC: 0.921769
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.183994    reg_loss: 0.047701    l2_loss: 0.025715    loss: 0.257411
steps 10600    v_Prec: 0.790178  v_Recall: 0.703798  v_F1: 0.744491  v_AUC: 0.922686
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.171100    reg_loss: 0.046986    l2_loss: 0.025707    loss: 0.243793
steps 10800    v_Prec: 0.794561  v_Recall: 0.703319  v_F1: 0.746161  v_AUC: 0.923045
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.072458    reg_loss: 0.042598    l2_loss: 0.025678    loss: 0.140734
steps 11000    v_Prec: 0.783962  v_Recall: 0.702839  v_F1: 0.741187  v_AUC: 0.920684
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.068498    reg_loss: 0.042575    l2_loss: 0.025684    loss: 0.136756
steps 11200    v_Prec: 0.775105  v_Recall: 0.706118  v_F1: 0.739005  v_AUC: 0.919244
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.069802    reg_loss: 0.042630    l2_loss: 0.025631    loss: 0.138063
steps 11400    v_Prec: 0.790738  v_Recall: 0.695002  v_F1: 0.739785  v_AUC: 0.918228
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.069658    reg_loss: 0.042624    l2_loss: 0.025647    loss: 0.137929
steps 11600    v_Prec: 0.787022  v_Recall: 0.701240  v_F1: 0.741659  v_AUC: 0.918180
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.071367    reg_loss: 0.042968    l2_loss: 0.025717    loss: 0.140052
steps 11800    v_Prec: 0.795230  v_Recall: 0.687885  v_F1: 0.737673  v_AUC: 0.917483
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.071140    reg_loss: 0.042817    l2_loss: 0.025770    loss: 0.139727
steps 12000    v_Prec: 0.801817  v_Recall: 0.684606  v_F1: 0.738590  v_AUC: 0.917418
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.081169    reg_loss: 0.043318    l2_loss: 0.025707    loss: 0.150195
steps 12200    v_Prec: 0.779529  v_Recall: 0.696122  v_F1: 0.735468  v_AUC: 0.916184
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.067410    reg_loss: 0.042952    l2_loss: 0.025652    loss: 0.136015
steps 12400    v_Prec: 0.810826  v_Recall: 0.675570  v_F1: 0.737044  v_AUC: 0.917439
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.077134    reg_loss: 0.042895    l2_loss: 0.025802    loss: 0.145830
steps 12600    v_Prec: 0.760118  v_Recall: 0.719392  v_F1: 0.739195  v_AUC: 0.918851
steps 12600    running time 444 seconds

steps 12800    base_loss: 0.075866    reg_loss: 0.042727    l2_loss: 0.025614    loss: 0.144208
steps 12800    v_Prec: 0.781860  v_Recall: 0.701080  v_F1: 0.739270  v_AUC: 0.917616
steps 12800    running time 450 seconds

Early stop model F1: 0.746161
testing thre: 0.54930353
testing Prec: 0.5902457757296466
testing Recall: 0.7470230862697448
testing F1: 0.6594443848546605
testing AUC: 0.9021739224140608
overall running time 453 seconds
(0.7125032903395631, 0.6577885783718105, 0.6840535759413698, 0.9021739224140608, 0.78820914)

2019-02-24 17:26:05.812872: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:26:06.984592: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:26:06.986905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:26:06.986942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.960000 seconds
loading data in 30.000000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.062584    reg_loss: 0.064785    l2_loss: 0.013249    loss: 1.140618
steps 200    v_Prec: 0.163193  v_Recall: 0.983230  v_F1: 0.279925  v_AUC: 0.509271
steps 200    running time 40 seconds

steps 400    base_loss: 0.706604    reg_loss: 0.064609    l2_loss: 0.013015    loss: 0.784227
steps 400    v_Prec: 0.163160  v_Recall: 0.997513  v_F1: 0.280448  v_AUC: 0.528806
steps 400    running time 47 seconds

steps 600    base_loss: 0.487855    reg_loss: 0.064292    l2_loss: 0.012757    loss: 0.564904
steps 600    v_Prec: 0.173734  v_Recall: 0.788975  v_F1: 0.284763  v_AUC: 0.556714
steps 600    running time 53 seconds

steps 800    base_loss: 0.481965    reg_loss: 0.063663    l2_loss: 0.012592    loss: 0.558220
steps 800    v_Prec: 0.194175  v_Recall: 0.642943  v_F1: 0.298269  v_AUC: 0.591780
steps 800    running time 60 seconds

steps 1000    base_loss: 0.460764    reg_loss: 0.063054    l2_loss: 0.012436    loss: 0.536254
steps 1000    v_Prec: 0.249989  v_Recall: 0.475889  v_F1: 0.327788  v_AUC: 0.634072
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.438958    reg_loss: 0.062400    l2_loss: 0.012302    loss: 0.513659
steps 1200    v_Prec: 0.302712  v_Recall: 0.474605  v_F1: 0.369653  v_AUC: 0.683572
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.426300    reg_loss: 0.062138    l2_loss: 0.012265    loss: 0.500703
steps 1400    v_Prec: 0.378703  v_Recall: 0.447164  v_F1: 0.410096  v_AUC: 0.722116
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.420819    reg_loss: 0.062520    l2_loss: 0.012298    loss: 0.495636
steps 1600    v_Prec: 0.414267  v_Recall: 0.503250  v_F1: 0.454443  v_AUC: 0.759500
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.391791    reg_loss: 0.062637    l2_loss: 0.012414    loss: 0.466841
steps 1800    v_Prec: 0.437998  v_Recall: 0.533660  v_F1: 0.481120  v_AUC: 0.784278
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.373091    reg_loss: 0.063031    l2_loss: 0.012624    loss: 0.448745
steps 2000    v_Prec: 0.507851  v_Recall: 0.534622  v_F1: 0.520893  v_AUC: 0.807581
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.356254    reg_loss: 0.063627    l2_loss: 0.012932    loss: 0.432813
steps 2200    v_Prec: 0.525887  v_Recall: 0.563989  v_F1: 0.544272  v_AUC: 0.827824
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.339185    reg_loss: 0.064501    l2_loss: 0.013293    loss: 0.416979
steps 2400    v_Prec: 0.550520  v_Recall: 0.586697  v_F1: 0.568033  v_AUC: 0.842113
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.333274    reg_loss: 0.065267    l2_loss: 0.013696    loss: 0.412238
steps 2600    v_Prec: 0.577504  v_Recall: 0.589505  v_F1: 0.583443  v_AUC: 0.853374
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.319468    reg_loss: 0.065707    l2_loss: 0.014075    loss: 0.399250
steps 2800    v_Prec: 0.605528  v_Recall: 0.594159  v_F1: 0.599789  v_AUC: 0.861607
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.321045    reg_loss: 0.066372    l2_loss: 0.014486    loss: 0.401903
steps 3000    v_Prec: 0.624116  v_Recall: 0.602182  v_F1: 0.612953  v_AUC: 0.868108
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.312180    reg_loss: 0.067021    l2_loss: 0.014955    loss: 0.394157
steps 3200    v_Prec: 0.646634  v_Recall: 0.603466  v_F1: 0.624305  v_AUC: 0.872815
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.295271    reg_loss: 0.066878    l2_loss: 0.015397    loss: 0.377546
steps 3400    v_Prec: 0.650240  v_Recall: 0.607719  v_F1: 0.628261  v_AUC: 0.877534
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.292423    reg_loss: 0.067168    l2_loss: 0.015797    loss: 0.375388
steps 3600    v_Prec: 0.652989  v_Recall: 0.620557  v_F1: 0.636360  v_AUC: 0.881498
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.294199    reg_loss: 0.067723    l2_loss: 0.016259    loss: 0.378181
steps 3800    v_Prec: 0.661292  v_Recall: 0.628500  v_F1: 0.644479  v_AUC: 0.883362
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.288599    reg_loss: 0.067533    l2_loss: 0.016778    loss: 0.372909
steps 4000    v_Prec: 0.657814  v_Recall: 0.633957  v_F1: 0.645665  v_AUC: 0.886503
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.291120    reg_loss: 0.067944    l2_loss: 0.017284    loss: 0.376349
steps 4200    v_Prec: 0.693309  v_Recall: 0.619434  v_F1: 0.654293  v_AUC: 0.889693
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.285129    reg_loss: 0.067761    l2_loss: 0.017797    loss: 0.370687
steps 4400    v_Prec: 0.701218  v_Recall: 0.618792  v_F1: 0.657431  v_AUC: 0.892023
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.280416    reg_loss: 0.067762    l2_loss: 0.018360    loss: 0.366538
steps 4600    v_Prec: 0.672173  v_Recall: 0.652973  v_F1: 0.662434  v_AUC: 0.894527
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.281530    reg_loss: 0.067852    l2_loss: 0.019046    loss: 0.368429
steps 4800    v_Prec: 0.683701  v_Recall: 0.646233  v_F1: 0.664439  v_AUC: 0.895638
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.274113    reg_loss: 0.067601    l2_loss: 0.019661    loss: 0.361375
steps 5000    v_Prec: 0.683157  v_Recall: 0.657065  v_F1: 0.669857  v_AUC: 0.896685
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.278382    reg_loss: 0.067736    l2_loss: 0.020419    loss: 0.366537
steps 5200    v_Prec: 0.706568  v_Recall: 0.642221  v_F1: 0.672859  v_AUC: 0.898008
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.265784    reg_loss: 0.067717    l2_loss: 0.021003    loss: 0.354505
steps 5400    v_Prec: 0.689524  v_Recall: 0.652732  v_F1: 0.670624  v_AUC: 0.899334
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.181339    reg_loss: 0.068407    l2_loss: 0.021932    loss: 0.271678
steps 5600    v_Prec: 0.662355  v_Recall: 0.665650  v_F1: 0.663999  v_AUC: 0.894135
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.184573    reg_loss: 0.068085    l2_loss: 0.022754    loss: 0.275412
steps 5800    v_Prec: 0.662371  v_Recall: 0.655781  v_F1: 0.659060  v_AUC: 0.892436
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.187692    reg_loss: 0.068125    l2_loss: 0.023564    loss: 0.279381
steps 6000    v_Prec: 0.660844  v_Recall: 0.649603  v_F1: 0.655175  v_AUC: 0.892619
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.189163    reg_loss: 0.068194    l2_loss: 0.024365    loss: 0.281721
steps 6200    v_Prec: 0.676237  v_Recall: 0.650084  v_F1: 0.662903  v_AUC: 0.892473
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.195156    reg_loss: 0.068266    l2_loss: 0.024971    loss: 0.288393
steps 6400    v_Prec: 0.675180  v_Recall: 0.653294  v_F1: 0.664057  v_AUC: 0.893348
steps 6400    running time 242 seconds

steps 6600    base_loss: 0.195128    reg_loss: 0.067940    l2_loss: 0.025565    loss: 0.288633
steps 6600    v_Prec: 0.688979  v_Recall: 0.640055  v_F1: 0.663616  v_AUC: 0.894305
steps 6600    running time 248 seconds

steps 6800    base_loss: 0.201329    reg_loss: 0.068099    l2_loss: 0.026036    loss: 0.295465
steps 6800    v_Prec: 0.707174  v_Recall: 0.628019  v_F1: 0.665250  v_AUC: 0.895052
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.196189    reg_loss: 0.067793    l2_loss: 0.026470    loss: 0.290453
steps 7000    v_Prec: 0.705341  v_Recall: 0.639011  v_F1: 0.670540  v_AUC: 0.896263
steps 7000    running time 261 seconds

steps 7200    base_loss: 0.190679    reg_loss: 0.067833    l2_loss: 0.026815    loss: 0.285327
steps 7200    v_Prec: 0.691907  v_Recall: 0.660595  v_F1: 0.675889  v_AUC: 0.898332
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.194341    reg_loss: 0.067873    l2_loss: 0.027306    loss: 0.289519
steps 7400    v_Prec: 0.675378  v_Recall: 0.678087  v_F1: 0.676730  v_AUC: 0.898908
steps 7400    running time 274 seconds

steps 7600    base_loss: 0.189430    reg_loss: 0.068004    l2_loss: 0.027626    loss: 0.285060
steps 7600    v_Prec: 0.684479  v_Recall: 0.668057  v_F1: 0.676168  v_AUC: 0.898831
steps 7600    running time 281 seconds

steps 7800    base_loss: 0.194118    reg_loss: 0.067732    l2_loss: 0.028022    loss: 0.289872
steps 7800    v_Prec: 0.698836  v_Recall: 0.669341  v_F1: 0.683770  v_AUC: 0.903093
steps 7800    running time 287 seconds

steps 8000    base_loss: 0.195583    reg_loss: 0.067672    l2_loss: 0.028425    loss: 0.291680
steps 8000    v_Prec: 0.718198  v_Recall: 0.652331  v_F1: 0.683682  v_AUC: 0.904967
steps 8000    running time 293 seconds

steps 8200    base_loss: 0.198621    reg_loss: 0.067694    l2_loss: 0.028666    loss: 0.294981
steps 8200    v_Prec: 0.708554  v_Recall: 0.665971  v_F1: 0.686603  v_AUC: 0.905489
steps 8200    running time 299 seconds

steps 8400    base_loss: 0.201017    reg_loss: 0.067540    l2_loss: 0.028927    loss: 0.297484
steps 8400    v_Prec: 0.693978  v_Recall: 0.687074  v_F1: 0.690509  v_AUC: 0.908267
steps 8400    running time 306 seconds

steps 8600    base_loss: 0.201870    reg_loss: 0.067229    l2_loss: 0.029133    loss: 0.298232
steps 8600    v_Prec: 0.704201  v_Recall: 0.681939  v_F1: 0.692891  v_AUC: 0.908055
steps 8600    running time 312 seconds

steps 8800    base_loss: 0.209855    reg_loss: 0.067606    l2_loss: 0.029412    loss: 0.306873
steps 8800    v_Prec: 0.734727  v_Recall: 0.662922  v_F1: 0.696980  v_AUC: 0.909170
steps 8800    running time 319 seconds

steps 9000    base_loss: 0.200061    reg_loss: 0.067557    l2_loss: 0.029696    loss: 0.297314
steps 9000    v_Prec: 0.734861  v_Recall: 0.664046  v_F1: 0.697661  v_AUC: 0.911276
steps 9000    running time 326 seconds

steps 9200    base_loss: 0.192664    reg_loss: 0.067583    l2_loss: 0.029938    loss: 0.290185
steps 9200    v_Prec: 0.720386  v_Recall: 0.682179  v_F1: 0.700762  v_AUC: 0.912787
steps 9200    running time 333 seconds

steps 9400    base_loss: 0.198450    reg_loss: 0.067424    l2_loss: 0.030191    loss: 0.296065
steps 9400    v_Prec: 0.737076  v_Recall: 0.677285  v_F1: 0.705917  v_AUC: 0.913349
steps 9400    running time 339 seconds

steps 9600    base_loss: 0.187562    reg_loss: 0.067247    l2_loss: 0.030434    loss: 0.285244
steps 9600    v_Prec: 0.720695  v_Recall: 0.692129  v_F1: 0.706123  v_AUC: 0.914575
steps 9600    running time 346 seconds

steps 9800    base_loss: 0.197208    reg_loss: 0.067216    l2_loss: 0.030569    loss: 0.294994
steps 9800    v_Prec: 0.749487  v_Recall: 0.674316  v_F1: 0.709917  v_AUC: 0.917073
steps 9800    running time 352 seconds

steps 10000    base_loss: 0.191729    reg_loss: 0.067098    l2_loss: 0.030595    loss: 0.289422
steps 10000    v_Prec: 0.753353  v_Recall: 0.680575  v_F1: 0.715117  v_AUC: 0.917290
steps 10000    running time 359 seconds

steps 10200    base_loss: 0.188617    reg_loss: 0.066970    l2_loss: 0.030841    loss: 0.286427
steps 10200    v_Prec: 0.748261  v_Recall: 0.681858  v_F1: 0.713518  v_AUC: 0.918444
steps 10200    running time 365 seconds

steps 10400    base_loss: 0.192899    reg_loss: 0.067177    l2_loss: 0.031129    loss: 0.291206
steps 10400    v_Prec: 0.754226  v_Recall: 0.683784  v_F1: 0.717280  v_AUC: 0.919824
steps 10400    running time 372 seconds

steps 10600    base_loss: 0.197377    reg_loss: 0.067150    l2_loss: 0.031338    loss: 0.295865
steps 10600    v_Prec: 0.749308  v_Recall: 0.695258  v_F1: 0.721272  v_AUC: 0.920566
steps 10600    running time 378 seconds

steps 10800    base_loss: 0.177700    reg_loss: 0.066884    l2_loss: 0.031419    loss: 0.276004
steps 10800    v_Prec: 0.773815  v_Recall: 0.682420  v_F1: 0.725249  v_AUC: 0.922213
steps 10800    running time 385 seconds

steps 11000    base_loss: 0.085954    reg_loss: 0.066341    l2_loss: 0.031615    loss: 0.183910
steps 11000    v_Prec: 0.744517  v_Recall: 0.680895  v_F1: 0.711286  v_AUC: 0.915786
steps 11000    running time 391 seconds

steps 11200    base_loss: 0.078612    reg_loss: 0.066162    l2_loss: 0.031848    loss: 0.176621
steps 11200    v_Prec: 0.740296  v_Recall: 0.667175  v_F1: 0.701836  v_AUC: 0.910517
steps 11200    running time 397 seconds

steps 11400    base_loss: 0.087727    reg_loss: 0.066112    l2_loss: 0.031959    loss: 0.185798
steps 11400    v_Prec: 0.711760  v_Recall: 0.678408  v_F1: 0.694684  v_AUC: 0.907224
steps 11400    running time 403 seconds

steps 11600    base_loss: 0.090593    reg_loss: 0.066004    l2_loss: 0.032066    loss: 0.188663
steps 11600    v_Prec: 0.730964  v_Recall: 0.661638  v_F1: 0.694575  v_AUC: 0.906654
steps 11600    running time 409 seconds

steps 11800    base_loss: 0.092847    reg_loss: 0.065742    l2_loss: 0.032236    loss: 0.190825
steps 11800    v_Prec: 0.734138  v_Recall: 0.653615  v_F1: 0.691540  v_AUC: 0.905901
steps 11800    running time 415 seconds

steps 12000    base_loss: 0.092447    reg_loss: 0.066031    l2_loss: 0.032317    loss: 0.190794
steps 12000    v_Prec: 0.722556  v_Recall: 0.655942  v_F1: 0.687639  v_AUC: 0.904010
steps 12000    running time 421 seconds

steps 12200    base_loss: 0.095813    reg_loss: 0.065945    l2_loss: 0.032535    loss: 0.194293
steps 12200    v_Prec: 0.688928  v_Recall: 0.684506  v_F1: 0.686710  v_AUC: 0.903186
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.094088    reg_loss: 0.066074    l2_loss: 0.032721    loss: 0.192883
steps 12400    v_Prec: 0.704324  v_Recall: 0.661317  v_F1: 0.682144  v_AUC: 0.900394
steps 12400    running time 434 seconds

steps 12600    base_loss: 0.096356    reg_loss: 0.066056    l2_loss: 0.032852    loss: 0.195263
steps 12600    v_Prec: 0.702027  v_Recall: 0.666934  v_F1: 0.684031  v_AUC: 0.901420
steps 12600    running time 440 seconds

steps 12800    base_loss: 0.097689    reg_loss: 0.065858    l2_loss: 0.032931    loss: 0.196478
steps 12800    v_Prec: 0.699455  v_Recall: 0.669823  v_F1: 0.684318  v_AUC: 0.900735
steps 12800    running time 446 seconds

Early stop model F1: 0.725249
testing thre: 0.48623225
testing Prec: 0.5558138676703938
testing Recall: 0.7320534629404617
testing F1: 0.6318748164618031
testing AUC: 0.8966372667761491
overall running time 449 seconds
(0.6672241650195124, 0.6398541919805589, 0.6532526174763063, 0.8966372667761491, 0.709818)

2019-02-24 17:30:58.326077: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:30:59.254670: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:30:59.256412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:30:59.256450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.480000 seconds
loading data in 30.740000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.498457    reg_loss: 0.064709    l2_loss: 0.013338    loss: 0.576504
steps 200    v_Prec: 0.164000  v_Recall: 0.999841  v_F1: 0.281780  v_AUC: 0.496115
steps 200    running time 41 seconds

steps 400    base_loss: 0.495591    reg_loss: 0.064861    l2_loss: 0.013284    loss: 0.573735
steps 400    v_Prec: 0.164424  v_Recall: 0.991884  v_F1: 0.282087  v_AUC: 0.537922
steps 400    running time 47 seconds

steps 600    base_loss: 0.473215    reg_loss: 0.064784    l2_loss: 0.013180    loss: 0.551179
steps 600    v_Prec: 0.216627  v_Recall: 0.531190  v_F1: 0.307749  v_AUC: 0.607782
steps 600    running time 54 seconds

steps 800    base_loss: 0.441955    reg_loss: 0.064652    l2_loss: 0.013125    loss: 0.519732
steps 800    v_Prec: 0.299119  v_Recall: 0.464433  v_F1: 0.363880  v_AUC: 0.683298
steps 800    running time 61 seconds

steps 1000    base_loss: 0.419518    reg_loss: 0.064889    l2_loss: 0.013017    loss: 0.497424
steps 1000    v_Prec: 0.428072  v_Recall: 0.438017  v_F1: 0.432987  v_AUC: 0.745783
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.393244    reg_loss: 0.064919    l2_loss: 0.013025    loss: 0.471188
steps 1200    v_Prec: 0.504658  v_Recall: 0.465547  v_F1: 0.484314  v_AUC: 0.781689
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.369200    reg_loss: 0.065285    l2_loss: 0.013053    loss: 0.447538
steps 1400    v_Prec: 0.524024  v_Recall: 0.528485  v_F1: 0.526245  v_AUC: 0.810952
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.350270    reg_loss: 0.065456    l2_loss: 0.013136    loss: 0.428861
steps 1600    v_Prec: 0.574144  v_Recall: 0.540659  v_F1: 0.556899  v_AUC: 0.828839
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.337547    reg_loss: 0.066056    l2_loss: 0.013273    loss: 0.416876
steps 1800    v_Prec: 0.603014  v_Recall: 0.554026  v_F1: 0.577483  v_AUC: 0.842540
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.322889    reg_loss: 0.066134    l2_loss: 0.013471    loss: 0.402494
steps 2000    v_Prec: 0.620658  v_Recall: 0.584262  v_F1: 0.601910  v_AUC: 0.853601
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.312733    reg_loss: 0.066384    l2_loss: 0.013613    loss: 0.392729
steps 2200    v_Prec: 0.639952  v_Recall: 0.593412  v_F1: 0.615804  v_AUC: 0.861355
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.304634    reg_loss: 0.066656    l2_loss: 0.013807    loss: 0.385096
steps 2400    v_Prec: 0.663720  v_Recall: 0.591423  v_F1: 0.625489  v_AUC: 0.868498
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.296362    reg_loss: 0.066840    l2_loss: 0.014053    loss: 0.377255
steps 2600    v_Prec: 0.646428  v_Recall: 0.628581  v_F1: 0.637379  v_AUC: 0.874900
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.283018    reg_loss: 0.066703    l2_loss: 0.014319    loss: 0.364040
steps 2800    v_Prec: 0.676823  v_Recall: 0.611553  v_F1: 0.642535  v_AUC: 0.878802
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.286092    reg_loss: 0.067117    l2_loss: 0.014599    loss: 0.367808
steps 3000    v_Prec: 0.646088  v_Recall: 0.647836  v_F1: 0.646961  v_AUC: 0.881448
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.279048    reg_loss: 0.066964    l2_loss: 0.014934    loss: 0.360946
steps 3200    v_Prec: 0.698794  v_Recall: 0.603994  v_F1: 0.647945  v_AUC: 0.885784
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.283155    reg_loss: 0.067298    l2_loss: 0.015202    loss: 0.365655
steps 3400    v_Prec: 0.698773  v_Recall: 0.616486  v_F1: 0.655056  v_AUC: 0.888485
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.282388    reg_loss: 0.067317    l2_loss: 0.015578    loss: 0.365282
steps 3600    v_Prec: 0.654457  v_Recall: 0.655395  v_F1: 0.654926  v_AUC: 0.890637
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.272289    reg_loss: 0.067299    l2_loss: 0.015927    loss: 0.355515
steps 3800    v_Prec: 0.664929  v_Recall: 0.649427  v_F1: 0.657087  v_AUC: 0.891478
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.281799    reg_loss: 0.067481    l2_loss: 0.016394    loss: 0.365675
steps 4000    v_Prec: 0.696945  v_Recall: 0.619032  v_F1: 0.655682  v_AUC: 0.893032
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.282693    reg_loss: 0.067085    l2_loss: 0.016786    loss: 0.366565
steps 4200    v_Prec: 0.681423  v_Recall: 0.642982  v_F1: 0.661645  v_AUC: 0.895117
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.275807    reg_loss: 0.067348    l2_loss: 0.017207    loss: 0.360362
steps 4400    v_Prec: 0.666346  v_Recall: 0.661840  v_F1: 0.664085  v_AUC: 0.896551
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.274649    reg_loss: 0.067459    l2_loss: 0.017720    loss: 0.359828
steps 4600    v_Prec: 0.680772  v_Recall: 0.656668  v_F1: 0.668503  v_AUC: 0.896789
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.276111    reg_loss: 0.067382    l2_loss: 0.018235    loss: 0.361728
steps 4800    v_Prec: 0.674868  v_Recall: 0.659134  v_F1: 0.666908  v_AUC: 0.897730
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.269253    reg_loss: 0.067284    l2_loss: 0.018840    loss: 0.355376
steps 5000    v_Prec: 0.706369  v_Recall: 0.638924  v_F1: 0.670956  v_AUC: 0.898897
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.271250    reg_loss: 0.067273    l2_loss: 0.019419    loss: 0.357942
steps 5200    v_Prec: 0.680531  v_Recall: 0.656111  v_F1: 0.668098  v_AUC: 0.900837
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.257160    reg_loss: 0.067310    l2_loss: 0.020046    loss: 0.344517
steps 5400    v_Prec: 0.693258  v_Recall: 0.656190  v_F1: 0.674215  v_AUC: 0.901141
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.163686    reg_loss: 0.068213    l2_loss: 0.020873    loss: 0.252772
steps 5600    v_Prec: 0.677186  v_Recall: 0.647120  v_F1: 0.661811  v_AUC: 0.895763
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.174704    reg_loss: 0.068089    l2_loss: 0.021753    loss: 0.264546
steps 5800    v_Prec: 0.662843  v_Recall: 0.652928  v_F1: 0.657848  v_AUC: 0.894533
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.179384    reg_loss: 0.067982    l2_loss: 0.022559    loss: 0.269925
steps 6000    v_Prec: 0.671026  v_Recall: 0.653246  v_F1: 0.662017  v_AUC: 0.894402
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.175716    reg_loss: 0.068195    l2_loss: 0.023205    loss: 0.267116
steps 6200    v_Prec: 0.673184  v_Recall: 0.654758  v_F1: 0.663843  v_AUC: 0.894002
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.179542    reg_loss: 0.068052    l2_loss: 0.023859    loss: 0.271453
steps 6400    v_Prec: 0.688395  v_Recall: 0.642823  v_F1: 0.664829  v_AUC: 0.895222
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.186299    reg_loss: 0.068011    l2_loss: 0.024404    loss: 0.278714
steps 6600    v_Prec: 0.646805  v_Recall: 0.679742  v_F1: 0.662865  v_AUC: 0.894845
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.186888    reg_loss: 0.068025    l2_loss: 0.024839    loss: 0.279752
steps 6800    v_Prec: 0.674086  v_Recall: 0.660248  v_F1: 0.667095  v_AUC: 0.896207
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.186917    reg_loss: 0.068103    l2_loss: 0.025256    loss: 0.280276
steps 7000    v_Prec: 0.679485  v_Recall: 0.655156  v_F1: 0.667099  v_AUC: 0.896456
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.185880    reg_loss: 0.068103    l2_loss: 0.025809    loss: 0.279793
steps 7200    v_Prec: 0.656546  v_Recall: 0.677912  v_F1: 0.667058  v_AUC: 0.898282
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.185683    reg_loss: 0.067784    l2_loss: 0.026235    loss: 0.279702
steps 7400    v_Prec: 0.689397  v_Recall: 0.652371  v_F1: 0.670373  v_AUC: 0.898508
steps 7400    running time 275 seconds

Early stop model F1: 0.674215
testing thre: 0.41729257
testing Prec: 0.5317542052866461
testing Recall: 0.6775698663426488
testing F1: 0.5958710890750555
testing AUC: 0.8693727406819817
overall running time 277 seconds
(0.6542617046818727, 0.5827460510328069, 0.6164365954602711, 0.8693727406819817, 0.6029707)

2019-02-24 17:34:04.009980: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:34:05.292324: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:34:05.294493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:34:05.294531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.520000 seconds
loading data in 30.530000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.582200    reg_loss: 0.064865    l2_loss: 0.013298    loss: 0.660362
steps 200    v_Prec: 0.166460  v_Recall: 0.994731  v_F1: 0.285196  v_AUC: 0.532347
steps 200    running time 41 seconds

steps 400    base_loss: 0.523815    reg_loss: 0.064628    l2_loss: 0.013114    loss: 0.601557
steps 400    v_Prec: 0.173071  v_Recall: 0.879522  v_F1: 0.289228  v_AUC: 0.551891
steps 400    running time 47 seconds

steps 600    base_loss: 0.482910    reg_loss: 0.063864    l2_loss: 0.012817    loss: 0.559591
steps 600    v_Prec: 0.193309  v_Recall: 0.718858  v_F1: 0.304685  v_AUC: 0.590820
steps 600    running time 54 seconds

steps 800    base_loss: 0.463116    reg_loss: 0.063144    l2_loss: 0.012541    loss: 0.538801
steps 800    v_Prec: 0.207791  v_Recall: 0.636364  v_F1: 0.313285  v_AUC: 0.612663
steps 800    running time 61 seconds

steps 1000    base_loss: 0.444992    reg_loss: 0.062435    l2_loss: 0.012382    loss: 0.519809
steps 1000    v_Prec: 0.308536  v_Recall: 0.431504  v_F1: 0.359803  v_AUC: 0.678623
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.427123    reg_loss: 0.061688    l2_loss: 0.012309    loss: 0.501120
steps 1200    v_Prec: 0.398949  v_Recall: 0.435750  v_F1: 0.416538  v_AUC: 0.732878
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.400994    reg_loss: 0.061107    l2_loss: 0.012402    loss: 0.474504
steps 1400    v_Prec: 0.449521  v_Recall: 0.501416  v_F1: 0.474052  v_AUC: 0.778051
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.375439    reg_loss: 0.060660    l2_loss: 0.012678    loss: 0.448777
steps 1600    v_Prec: 0.532575  v_Recall: 0.500786  v_F1: 0.516192  v_AUC: 0.807277
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.355219    reg_loss: 0.060110    l2_loss: 0.013022    loss: 0.428350
steps 1800    v_Prec: 0.522779  v_Recall: 0.560396  v_F1: 0.540934  v_AUC: 0.824012
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.338458    reg_loss: 0.059759    l2_loss: 0.013393    loss: 0.411611
steps 2000    v_Prec: 0.530230  v_Recall: 0.587606  v_F1: 0.557446  v_AUC: 0.836115
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.332492    reg_loss: 0.059485    l2_loss: 0.013736    loss: 0.405712
steps 2200    v_Prec: 0.547555  v_Recall: 0.609390  v_F1: 0.576820  v_AUC: 0.847773
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.324556    reg_loss: 0.059115    l2_loss: 0.014104    loss: 0.397775
steps 2400    v_Prec: 0.562924  v_Recall: 0.612771  v_F1: 0.586791  v_AUC: 0.854020
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.319408    reg_loss: 0.058781    l2_loss: 0.014462    loss: 0.392652
steps 2600    v_Prec: 0.574533  v_Recall: 0.617411  v_F1: 0.595201  v_AUC: 0.860387
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.314680    reg_loss: 0.058429    l2_loss: 0.014955    loss: 0.388063
steps 2800    v_Prec: 0.599219  v_Recall: 0.603177  v_F1: 0.601191  v_AUC: 0.863111
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.319447    reg_loss: 0.058044    l2_loss: 0.015443    loss: 0.392935
steps 3000    v_Prec: 0.610721  v_Recall: 0.602076  v_F1: 0.606368  v_AUC: 0.868179
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.309765    reg_loss: 0.057399    l2_loss: 0.015958    loss: 0.383121
steps 3200    v_Prec: 0.603500  v_Recall: 0.615602  v_F1: 0.609491  v_AUC: 0.871672
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.307360    reg_loss: 0.056940    l2_loss: 0.016416    loss: 0.380716
steps 3400    v_Prec: 0.614802  v_Recall: 0.619299  v_F1: 0.617042  v_AUC: 0.875005
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.303205    reg_loss: 0.056445    l2_loss: 0.016962    loss: 0.376613
steps 3600    v_Prec: 0.626522  v_Recall: 0.618984  v_F1: 0.622730  v_AUC: 0.877804
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.302001    reg_loss: 0.055981    l2_loss: 0.017609    loss: 0.375591
steps 3800    v_Prec: 0.626725  v_Recall: 0.621500  v_F1: 0.624102  v_AUC: 0.879195
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.301141    reg_loss: 0.055560    l2_loss: 0.018204    loss: 0.374904
steps 4000    v_Prec: 0.608194  v_Recall: 0.651384  v_F1: 0.629049  v_AUC: 0.882120
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.303934    reg_loss: 0.055171    l2_loss: 0.018918    loss: 0.378023
steps 4200    v_Prec: 0.606982  v_Recall: 0.659012  v_F1: 0.631928  v_AUC: 0.883048
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.295138    reg_loss: 0.054483    l2_loss: 0.019565    loss: 0.369186
steps 4400    v_Prec: 0.647102  v_Recall: 0.617332  v_F1: 0.631867  v_AUC: 0.884344
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.300006    reg_loss: 0.054062    l2_loss: 0.020292    loss: 0.374361
steps 4600    v_Prec: 0.636004  v_Recall: 0.632353  v_F1: 0.634173  v_AUC: 0.884880
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.290820    reg_loss: 0.053413    l2_loss: 0.021057    loss: 0.365290
steps 4800    v_Prec: 0.671944  v_Recall: 0.620793  v_F1: 0.645356  v_AUC: 0.888964
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.296609    reg_loss: 0.053002    l2_loss: 0.021778    loss: 0.371390
steps 5000    v_Prec: 0.649035  v_Recall: 0.656181  v_F1: 0.652589  v_AUC: 0.890753
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.283576    reg_loss: 0.052228    l2_loss: 0.022581    loss: 0.358385
steps 5200    v_Prec: 0.658294  v_Recall: 0.651305  v_F1: 0.654781  v_AUC: 0.890786
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.285219    reg_loss: 0.052045    l2_loss: 0.023391    loss: 0.360655
steps 5400    v_Prec: 0.650949  v_Recall: 0.661136  v_F1: 0.656002  v_AUC: 0.894491
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.173975    reg_loss: 0.053976    l2_loss: 0.024035    loss: 0.251986
steps 5600    v_Prec: 0.616783  v_Recall: 0.680324  v_F1: 0.646997  v_AUC: 0.888737
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.174116    reg_loss: 0.054370    l2_loss: 0.024464    loss: 0.252950
steps 5800    v_Prec: 0.629373  v_Recall: 0.656496  v_F1: 0.642648  v_AUC: 0.887259
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.180855    reg_loss: 0.055108    l2_loss: 0.025032    loss: 0.260994
steps 6000    v_Prec: 0.605033  v_Recall: 0.674976  v_F1: 0.638094  v_AUC: 0.884333
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.165556    reg_loss: 0.055161    l2_loss: 0.025614    loss: 0.246331
steps 6200    v_Prec: 0.602902  v_Recall: 0.663259  v_F1: 0.631642  v_AUC: 0.881768
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.189375    reg_loss: 0.054918    l2_loss: 0.026123    loss: 0.270416
steps 6400    v_Prec: 0.630636  v_Recall: 0.636835  v_F1: 0.633721  v_AUC: 0.883876
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.176925    reg_loss: 0.054634    l2_loss: 0.026563    loss: 0.258122
steps 6600    v_Prec: 0.638100  v_Recall: 0.638251  v_F1: 0.638176  v_AUC: 0.881961
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.178939    reg_loss: 0.054748    l2_loss: 0.026938    loss: 0.260626
steps 6800    v_Prec: 0.652149  v_Recall: 0.617018  v_F1: 0.634097  v_AUC: 0.882382
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.179777    reg_loss: 0.054559    l2_loss: 0.027425    loss: 0.261761
steps 7000    v_Prec: 0.611047  v_Recall: 0.669000  v_F1: 0.638712  v_AUC: 0.883206
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.189075    reg_loss: 0.054074    l2_loss: 0.027817    loss: 0.270966
steps 7200    v_Prec: 0.628800  v_Recall: 0.649025  v_F1: 0.638752  v_AUC: 0.884658
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.187434    reg_loss: 0.054099    l2_loss: 0.028267    loss: 0.269799
steps 7400    v_Prec: 0.638911  v_Recall: 0.643835  v_F1: 0.641363  v_AUC: 0.886879
steps 7400    running time 277 seconds

Early stop model F1: 0.656002
testing thre: 0.36014932
testing Prec: 0.46639789020582617
testing Recall: 0.7478007290400972
testing F1: 0.5744903293256666
testing AUC: 0.8724436802951694
overall running time 280 seconds
(0.6615223502177148, 0.5833292831105711, 0.6199700397747817, 0.8724436802951694, 0.6575274)

2019-02-24 17:37:10.586707: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:37:11.733812: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:37:11.737938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:37:11.737982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.780000 seconds
loading data in 29.770000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.588757    reg_loss: 0.064647    l2_loss: 0.013282    loss: 0.666687
steps 200    v_Prec: 0.168370  v_Recall: 0.898853  v_F1: 0.283614  v_AUC: 0.537931
steps 200    running time 40 seconds

steps 400    base_loss: 0.527471    reg_loss: 0.064512    l2_loss: 0.013199    loss: 0.605181
steps 400    v_Prec: 0.173894  v_Recall: 0.835218  v_F1: 0.287855  v_AUC: 0.551386
steps 400    running time 47 seconds

steps 600    base_loss: 0.494242    reg_loss: 0.064061    l2_loss: 0.012935    loss: 0.571239
steps 600    v_Prec: 0.175632  v_Recall: 0.797786  v_F1: 0.287886  v_AUC: 0.560884
steps 600    running time 54 seconds

steps 800    base_loss: 0.473154    reg_loss: 0.063803    l2_loss: 0.012603    loss: 0.549559
steps 800    v_Prec: 0.168839  v_Recall: 0.881969  v_F1: 0.283422  v_AUC: 0.548622
steps 800    running time 60 seconds

steps 1000    base_loss: 0.452500    reg_loss: 0.062803    l2_loss: 0.012448    loss: 0.527751
steps 1000    v_Prec: 0.206310  v_Recall: 0.597881  v_F1: 0.306765  v_AUC: 0.604095
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.446408    reg_loss: 0.061846    l2_loss: 0.012338    loss: 0.520592
steps 1200    v_Prec: 0.280463  v_Recall: 0.507407  v_F1: 0.361250  v_AUC: 0.686176
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.428537    reg_loss: 0.060590    l2_loss: 0.012339    loss: 0.501466
steps 1400    v_Prec: 0.393381  v_Recall: 0.455320  v_F1: 0.422090  v_AUC: 0.740536
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.397355    reg_loss: 0.059506    l2_loss: 0.012560    loss: 0.469421
steps 1600    v_Prec: 0.437366  v_Recall: 0.519990  v_F1: 0.475113  v_AUC: 0.783830
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.369217    reg_loss: 0.058830    l2_loss: 0.012869    loss: 0.440917
steps 1800    v_Prec: 0.503093  v_Recall: 0.518238  v_F1: 0.510553  v_AUC: 0.808026
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.351757    reg_loss: 0.058250    l2_loss: 0.013231    loss: 0.423237
steps 2000    v_Prec: 0.522520  v_Recall: 0.565467  v_F1: 0.543146  v_AUC: 0.827819
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.340035    reg_loss: 0.057748    l2_loss: 0.013639    loss: 0.411422
steps 2200    v_Prec: 0.602075  v_Recall: 0.536238  v_F1: 0.567252  v_AUC: 0.841218
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.325600    reg_loss: 0.057290    l2_loss: 0.014059    loss: 0.396950
steps 2400    v_Prec: 0.574856  v_Recall: 0.587767  v_F1: 0.581240  v_AUC: 0.849274
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.312382    reg_loss: 0.056574    l2_loss: 0.014461    loss: 0.383418
steps 2600    v_Prec: 0.597633  v_Recall: 0.591112  v_F1: 0.594354  v_AUC: 0.857646
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.321895    reg_loss: 0.056322    l2_loss: 0.014917    loss: 0.393134
steps 2800    v_Prec: 0.627392  v_Recall: 0.582271  v_F1: 0.603990  v_AUC: 0.865163
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.310066    reg_loss: 0.055433    l2_loss: 0.015394    loss: 0.380893
steps 3000    v_Prec: 0.621225  v_Recall: 0.599554  v_F1: 0.610197  v_AUC: 0.869273
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.310295    reg_loss: 0.054882    l2_loss: 0.015843    loss: 0.381020
steps 3200    v_Prec: 0.605864  v_Recall: 0.625358  v_F1: 0.615457  v_AUC: 0.872232
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.303679    reg_loss: 0.054206    l2_loss: 0.016418    loss: 0.374303
steps 3400    v_Prec: 0.625517  v_Recall: 0.626314  v_F1: 0.625915  v_AUC: 0.876710
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.291084    reg_loss: 0.053591    l2_loss: 0.016959    loss: 0.361634
steps 3600    v_Prec: 0.620846  v_Recall: 0.644234  v_F1: 0.632324  v_AUC: 0.879874
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.291298    reg_loss: 0.052978    l2_loss: 0.017474    loss: 0.361750
steps 3800    v_Prec: 0.659591  v_Recall: 0.616199  v_F1: 0.637157  v_AUC: 0.883123
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.290806    reg_loss: 0.052250    l2_loss: 0.018102    loss: 0.361159
steps 4000    v_Prec: 0.647825  v_Recall: 0.645349  v_F1: 0.646585  v_AUC: 0.885932
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.282606    reg_loss: 0.051541    l2_loss: 0.018630    loss: 0.352777
steps 4200    v_Prec: 0.655713  v_Recall: 0.635712  v_F1: 0.645558  v_AUC: 0.885973
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.289171    reg_loss: 0.051222    l2_loss: 0.019287    loss: 0.359680
steps 4400    v_Prec: 0.664885  v_Recall: 0.634119  v_F1: 0.649138  v_AUC: 0.887346
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.288312    reg_loss: 0.050448    l2_loss: 0.019855    loss: 0.358615
steps 4600    v_Prec: 0.650566  v_Recall: 0.650048  v_F1: 0.650307  v_AUC: 0.889713
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.288365    reg_loss: 0.049947    l2_loss: 0.020456    loss: 0.358767
steps 4800    v_Prec: 0.688170  v_Recall: 0.618509  v_F1: 0.651483  v_AUC: 0.891976
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.281876    reg_loss: 0.049183    l2_loss: 0.021005    loss: 0.352063
steps 5000    v_Prec: 0.686372  v_Recall: 0.617713  v_F1: 0.650235  v_AUC: 0.890895
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.282787    reg_loss: 0.048723    l2_loss: 0.021667    loss: 0.353177
steps 5200    v_Prec: 0.666803  v_Recall: 0.648057  v_F1: 0.657296  v_AUC: 0.890812
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.278126    reg_loss: 0.048350    l2_loss: 0.022391    loss: 0.348866
steps 5400    v_Prec: 0.678559  v_Recall: 0.643756  v_F1: 0.660700  v_AUC: 0.894645
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.177057    reg_loss: 0.049429    l2_loss: 0.023027    loss: 0.249514
steps 5600    v_Prec: 0.662243  v_Recall: 0.643836  v_F1: 0.652910  v_AUC: 0.888593
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.176374    reg_loss: 0.049791    l2_loss: 0.023511    loss: 0.249676
steps 5800    v_Prec: 0.646082  v_Recall: 0.654110  v_F1: 0.650071  v_AUC: 0.885866
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.169965    reg_loss: 0.050034    l2_loss: 0.024139    loss: 0.244138
steps 6000    v_Prec: 0.647972  v_Recall: 0.645030  v_F1: 0.646498  v_AUC: 0.885907
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.173741    reg_loss: 0.050049    l2_loss: 0.024856    loss: 0.248646
steps 6200    v_Prec: 0.665290  v_Recall: 0.628783  v_F1: 0.646522  v_AUC: 0.885643
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.173468    reg_loss: 0.050017    l2_loss: 0.025372    loss: 0.248857
steps 6400    v_Prec: 0.663796  v_Recall: 0.632287  v_F1: 0.647659  v_AUC: 0.885402
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.184532    reg_loss: 0.049986    l2_loss: 0.025883    loss: 0.260402
steps 6600    v_Prec: 0.677133  v_Recall: 0.620022  v_F1: 0.647321  v_AUC: 0.886084
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.170477    reg_loss: 0.049550    l2_loss: 0.026385    loss: 0.246412
steps 6800    v_Prec: 0.650004  v_Recall: 0.643119  v_F1: 0.646543  v_AUC: 0.884523
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.187179    reg_loss: 0.049791    l2_loss: 0.026793    loss: 0.263762
steps 7000    v_Prec: 0.643701  v_Recall: 0.646623  v_F1: 0.645159  v_AUC: 0.885421
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.186700    reg_loss: 0.049583    l2_loss: 0.027237    loss: 0.263520
steps 7200    v_Prec: 0.645414  v_Recall: 0.641765  v_F1: 0.643585  v_AUC: 0.886519
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.193589    reg_loss: 0.049074    l2_loss: 0.027641    loss: 0.270305
steps 7400    v_Prec: 0.663583  v_Recall: 0.634040  v_F1: 0.648475  v_AUC: 0.890908
steps 7400    running time 276 seconds

Early stop model F1: 0.660700
testing thre: 0.35952738
testing Prec: 0.5082494694324639
testing Recall: 0.7216524908869988
testing F1: 0.5964369639880296
testing AUC: 0.874327489647188
overall running time 279 seconds
(0.6644580909286791, 0.5995139732685297, 0.6303175860395003, 0.874327489647188, 0.59798235)

2019-02-24 17:40:17.718360: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:40:18.082096: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:40:18.083008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:40:18.083044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.410000 seconds
loading data in 30.580000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.699926    reg_loss: 0.064932    l2_loss: 0.013345    loss: 0.778203
steps 200    v_Prec: 0.164333  v_Recall: 0.998491  v_F1: 0.282218  v_AUC: 0.509658
steps 200    running time 41 seconds

steps 400    base_loss: 0.593384    reg_loss: 0.064658    l2_loss: 0.013371    loss: 0.671413
steps 400    v_Prec: 0.164842  v_Recall: 0.990547  v_F1: 0.282648  v_AUC: 0.517553
steps 400    running time 47 seconds

steps 600    base_loss: 0.530822    reg_loss: 0.064494    l2_loss: 0.013277    loss: 0.608592
steps 600    v_Prec: 0.177919  v_Recall: 0.801795  v_F1: 0.291217  v_AUC: 0.577743
steps 600    running time 54 seconds

steps 800    base_loss: 0.498734    reg_loss: 0.064221    l2_loss: 0.012929    loss: 0.575884
steps 800    v_Prec: 0.187249  v_Recall: 0.712345  v_F1: 0.296547  v_AUC: 0.586172
steps 800    running time 61 seconds

steps 1000    base_loss: 0.461437    reg_loss: 0.063769    l2_loss: 0.012743    loss: 0.537948
steps 1000    v_Prec: 0.193782  v_Recall: 0.681363  v_F1: 0.301747  v_AUC: 0.591983
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.453343    reg_loss: 0.063384    l2_loss: 0.012657    loss: 0.529385
steps 1200    v_Prec: 0.267107  v_Recall: 0.434144  v_F1: 0.330731  v_AUC: 0.638637
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.432127    reg_loss: 0.062777    l2_loss: 0.012669    loss: 0.507573
steps 1400    v_Prec: 0.375222  v_Recall: 0.403241  v_F1: 0.388727  v_AUC: 0.695445
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.409333    reg_loss: 0.061963    l2_loss: 0.012749    loss: 0.484045
steps 1600    v_Prec: 0.456788  v_Recall: 0.458929  v_F1: 0.457856  v_AUC: 0.749123
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.383063    reg_loss: 0.061246    l2_loss: 0.012974    loss: 0.457284
steps 1800    v_Prec: 0.532968  v_Recall: 0.479028  v_F1: 0.504560  v_AUC: 0.781069
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.362235    reg_loss: 0.060364    l2_loss: 0.013199    loss: 0.435799
steps 2000    v_Prec: 0.593141  v_Recall: 0.522085  v_F1: 0.555349  v_AUC: 0.813860
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.336549    reg_loss: 0.059666    l2_loss: 0.013469    loss: 0.409684
steps 2200    v_Prec: 0.640909  v_Recall: 0.535669  v_F1: 0.583582  v_AUC: 0.833475
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.322299    reg_loss: 0.059045    l2_loss: 0.013761    loss: 0.395104
steps 2400    v_Prec: 0.667332  v_Recall: 0.558071  v_F1: 0.607830  v_AUC: 0.848436
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.310646    reg_loss: 0.058460    l2_loss: 0.014077    loss: 0.383183
steps 2600    v_Prec: 0.684477  v_Recall: 0.580076  v_F1: 0.627967  v_AUC: 0.858612
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.311067    reg_loss: 0.058116    l2_loss: 0.014431    loss: 0.383614
steps 2800    v_Prec: 0.687083  v_Recall: 0.605100  v_F1: 0.643491  v_AUC: 0.867383
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.299350    reg_loss: 0.057862    l2_loss: 0.014747    loss: 0.371959
steps 3000    v_Prec: 0.684289  v_Recall: 0.622100  v_F1: 0.651714  v_AUC: 0.871222
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.291674    reg_loss: 0.057460    l2_loss: 0.015078    loss: 0.364211
steps 3200    v_Prec: 0.688508  v_Recall: 0.631077  v_F1: 0.658543  v_AUC: 0.875169
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.284327    reg_loss: 0.057271    l2_loss: 0.015417    loss: 0.357015
steps 3400    v_Prec: 0.696665  v_Recall: 0.632189  v_F1: 0.662863  v_AUC: 0.878687
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.287828    reg_loss: 0.057172    l2_loss: 0.015795    loss: 0.360794
steps 3600    v_Prec: 0.722998  v_Recall: 0.625357  v_F1: 0.670642  v_AUC: 0.883133
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.276045    reg_loss: 0.056637    l2_loss: 0.016126    loss: 0.348808
steps 3800    v_Prec: 0.695884  v_Recall: 0.654036  v_F1: 0.674311  v_AUC: 0.886783
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.278610    reg_loss: 0.056724    l2_loss: 0.016510    loss: 0.351844
steps 4000    v_Prec: 0.720387  v_Recall: 0.644503  v_F1: 0.680335  v_AUC: 0.889275
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.270538    reg_loss: 0.056375    l2_loss: 0.016855    loss: 0.343767
steps 4200    v_Prec: 0.733704  v_Recall: 0.639339  v_F1: 0.683279  v_AUC: 0.891625
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.267342    reg_loss: 0.056163    l2_loss: 0.017307    loss: 0.340811
steps 4400    v_Prec: 0.726288  v_Recall: 0.649666  v_F1: 0.685844  v_AUC: 0.893567
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.268407    reg_loss: 0.055854    l2_loss: 0.017707    loss: 0.341968
steps 4600    v_Prec: 0.715480  v_Recall: 0.666428  v_F1: 0.690083  v_AUC: 0.895539
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.260202    reg_loss: 0.055621    l2_loss: 0.018117    loss: 0.333941
steps 4800    v_Prec: 0.745690  v_Recall: 0.645933  v_F1: 0.692236  v_AUC: 0.895197
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.266922    reg_loss: 0.055444    l2_loss: 0.018587    loss: 0.340952
steps 5000    v_Prec: 0.755340  v_Recall: 0.643311  v_F1: 0.694839  v_AUC: 0.898206
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.258930    reg_loss: 0.055303    l2_loss: 0.019047    loss: 0.333281
steps 5200    v_Prec: 0.736782  v_Recall: 0.661980  v_F1: 0.697381  v_AUC: 0.899539
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.254254    reg_loss: 0.054835    l2_loss: 0.019453    loss: 0.328542
steps 5400    v_Prec: 0.749685  v_Recall: 0.662139  v_F1: 0.703198  v_AUC: 0.900865
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.168585    reg_loss: 0.050765    l2_loss: 0.020000    loss: 0.239350
steps 5600    v_Prec: 0.735992  v_Recall: 0.665713  v_F1: 0.699091  v_AUC: 0.898175
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.176113    reg_loss: 0.050850    l2_loss: 0.020592    loss: 0.247554
steps 5800    v_Prec: 0.764259  v_Recall: 0.647204  v_F1: 0.700877  v_AUC: 0.896624
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.178957    reg_loss: 0.050704    l2_loss: 0.021190    loss: 0.250851
steps 6000    v_Prec: 0.736545  v_Recall: 0.664283  v_F1: 0.698551  v_AUC: 0.896682
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.177276    reg_loss: 0.050618    l2_loss: 0.021805    loss: 0.249699
steps 6200    v_Prec: 0.726427  v_Recall: 0.676279  v_F1: 0.700457  v_AUC: 0.896810
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.193139    reg_loss: 0.050963    l2_loss: 0.022393    loss: 0.266494
steps 6400    v_Prec: 0.745625  v_Recall: 0.663410  v_F1: 0.702119  v_AUC: 0.899416
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.182056    reg_loss: 0.050112    l2_loss: 0.022797    loss: 0.254965
steps 6600    v_Prec: 0.757670  v_Recall: 0.659199  v_F1: 0.705013  v_AUC: 0.898880
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.184796    reg_loss: 0.050001    l2_loss: 0.023134    loss: 0.257931
steps 6800    v_Prec: 0.746569  v_Recall: 0.669765  v_F1: 0.706084  v_AUC: 0.899210
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.175997    reg_loss: 0.049844    l2_loss: 0.023467    loss: 0.249308
steps 7000    v_Prec: 0.770342  v_Recall: 0.656578  v_F1: 0.708925  v_AUC: 0.901207
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.192443    reg_loss: 0.049822    l2_loss: 0.023788    loss: 0.266053
steps 7200    v_Prec: 0.755673  v_Recall: 0.671989  v_F1: 0.711378  v_AUC: 0.901243
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.186548    reg_loss: 0.049556    l2_loss: 0.023923    loss: 0.260027
steps 7400    v_Prec: 0.761529  v_Recall: 0.666428  v_F1: 0.710812  v_AUC: 0.902035
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.187705    reg_loss: 0.049269    l2_loss: 0.024241    loss: 0.261216
steps 7600    v_Prec: 0.766694  v_Recall: 0.663092  v_F1: 0.711140  v_AUC: 0.904371
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.189892    reg_loss: 0.049230    l2_loss: 0.024406    loss: 0.263527
steps 7800    v_Prec: 0.761310  v_Recall: 0.677788  v_F1: 0.717125  v_AUC: 0.905184
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.186475    reg_loss: 0.049150    l2_loss: 0.024575    loss: 0.260200
steps 8000    v_Prec: 0.757554  v_Recall: 0.683111  v_F1: 0.718409  v_AUC: 0.906825
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.191098    reg_loss: 0.048776    l2_loss: 0.024864    loss: 0.264737
steps 8200    v_Prec: 0.771671  v_Recall: 0.672545  v_F1: 0.718706  v_AUC: 0.907595
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.186389    reg_loss: 0.048522    l2_loss: 0.024959    loss: 0.259870
steps 8400    v_Prec: 0.770874  v_Recall: 0.685017  v_F1: 0.725414  v_AUC: 0.910213
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.185371    reg_loss: 0.048497    l2_loss: 0.025092    loss: 0.258960
steps 8600    v_Prec: 0.760646  v_Recall: 0.692485  v_F1: 0.724967  v_AUC: 0.909631
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.183755    reg_loss: 0.048612    l2_loss: 0.025257    loss: 0.257624
steps 8800    v_Prec: 0.779553  v_Recall: 0.682078  v_F1: 0.727565  v_AUC: 0.909697
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.182935    reg_loss: 0.048469    l2_loss: 0.025424    loss: 0.256828
steps 9000    v_Prec: 0.779468  v_Recall: 0.683985  v_F1: 0.728611  v_AUC: 0.911386
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.186236    reg_loss: 0.048199    l2_loss: 0.025555    loss: 0.259991
steps 9200    v_Prec: 0.785180  v_Recall: 0.683508  v_F1: 0.730825  v_AUC: 0.912261
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.185947    reg_loss: 0.048109    l2_loss: 0.025632    loss: 0.259689
steps 9400    v_Prec: 0.776236  v_Recall: 0.693359  v_F1: 0.732461  v_AUC: 0.913708
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.184997    reg_loss: 0.047909    l2_loss: 0.025900    loss: 0.258806
steps 9600    v_Prec: 0.775323  v_Recall: 0.696854  v_F1: 0.733997  v_AUC: 0.914508
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.187126    reg_loss: 0.048051    l2_loss: 0.025897    loss: 0.261074
steps 9800    v_Prec: 0.787136  v_Recall: 0.694153  v_F1: 0.737726  v_AUC: 0.915791
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.184267    reg_loss: 0.047751    l2_loss: 0.025880    loss: 0.257898
steps 10000    v_Prec: 0.776817  v_Recall: 0.706466  v_F1: 0.739973  v_AUC: 0.914900
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.174812    reg_loss: 0.047590    l2_loss: 0.026037    loss: 0.248438
steps 10200    v_Prec: 0.787140  v_Recall: 0.705037  v_F1: 0.743829  v_AUC: 0.917751
steps 10200    running time 372 seconds

steps 10400    base_loss: 0.188867    reg_loss: 0.047883    l2_loss: 0.026095    loss: 0.262845
steps 10400    v_Prec: 0.801632  v_Recall: 0.694391  v_F1: 0.744168  v_AUC: 0.917409
steps 10400    running time 379 seconds

steps 10600    base_loss: 0.177884    reg_loss: 0.047416    l2_loss: 0.026090    loss: 0.251389
steps 10600    v_Prec: 0.803613  v_Recall: 0.692723  v_F1: 0.744059  v_AUC: 0.918939
steps 10600    running time 386 seconds

steps 10800    base_loss: 0.174014    reg_loss: 0.046794    l2_loss: 0.026147    loss: 0.246954
steps 10800    v_Prec: 0.771679  v_Recall: 0.720369  v_F1: 0.745142  v_AUC: 0.920046
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.070356    reg_loss: 0.042315    l2_loss: 0.026083    loss: 0.138754
steps 11000    v_Prec: 0.801035  v_Recall: 0.688592  v_F1: 0.740570  v_AUC: 0.917972
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.070854    reg_loss: 0.042265    l2_loss: 0.025820    loss: 0.138938
steps 11200    v_Prec: 0.772097  v_Recall: 0.707817  v_F1: 0.738561  v_AUC: 0.916917
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.067866    reg_loss: 0.042124    l2_loss: 0.025950    loss: 0.135939
steps 11400    v_Prec: 0.790043  v_Recall: 0.690817  v_F1: 0.737105  v_AUC: 0.915443
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.071853    reg_loss: 0.042611    l2_loss: 0.026004    loss: 0.140468
steps 11600    v_Prec: 0.770632  v_Recall: 0.695821  v_F1: 0.731318  v_AUC: 0.913562
steps 11600    running time 418 seconds

steps 11800    base_loss: 0.076032    reg_loss: 0.042584    l2_loss: 0.025938    loss: 0.144555
steps 11800    v_Prec: 0.783786  v_Recall: 0.692008  v_F1: 0.735043  v_AUC: 0.914472
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.065089    reg_loss: 0.042408    l2_loss: 0.026012    loss: 0.133509
steps 12000    v_Prec: 0.790766  v_Recall: 0.683031  v_F1: 0.732961  v_AUC: 0.913401
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.083195    reg_loss: 0.042589    l2_loss: 0.026058    loss: 0.151842
steps 12200    v_Prec: 0.775828  v_Recall: 0.695583  v_F1: 0.733518  v_AUC: 0.913854
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.077745    reg_loss: 0.042592    l2_loss: 0.026025    loss: 0.146362
steps 12400    v_Prec: 0.776379  v_Recall: 0.695583  v_F1: 0.733764  v_AUC: 0.914586
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.078352    reg_loss: 0.042722    l2_loss: 0.026015    loss: 0.147090
steps 12600    v_Prec: 0.779988  v_Recall: 0.697887  v_F1: 0.736657  v_AUC: 0.914209
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.083605    reg_loss: 0.042896    l2_loss: 0.026019    loss: 0.152519
steps 12800    v_Prec: 0.759659  v_Recall: 0.707579  v_F1: 0.732694  v_AUC: 0.912993
steps 12800    running time 455 seconds

Early stop model F1: 0.745142
testing thre: 0.42423296
testing Prec: 0.5539858728557013
testing Recall: 0.7738031591737545
testing F1: 0.6456989901447865
testing AUC: 0.9025449213954138
overall running time 458 seconds
(0.7494426341965358, 0.6371810449574726, 0.6887674687401493, 0.9025449213954138, 0.8003285)

2019-02-24 17:45:17.644269: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:45:18.687613: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:45:18.688573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:45:18.688609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.230000 seconds
loading data in 30.500000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.419435    reg_loss: 0.215461    l2_loss: 0.013289    loss: 1.648186
steps 200    v_Prec: 0.162944  v_Recall: 0.995830  v_F1: 0.280063  v_AUC: 0.534899
steps 200    running time 40 seconds

steps 400    base_loss: 1.001396    reg_loss: 0.213750    l2_loss: 0.012857    loss: 1.228004
steps 400    v_Prec: 0.165188  v_Recall: 0.970487  v_F1: 0.282321  v_AUC: 0.543951
steps 400    running time 47 seconds

steps 600    base_loss: 0.518886    reg_loss: 0.209962    l2_loss: 0.012271    loss: 0.741119
steps 600    v_Prec: 0.197556  v_Recall: 0.653461  v_F1: 0.303390  v_AUC: 0.601207
steps 600    running time 53 seconds

steps 800    base_loss: 0.474773    reg_loss: 0.206864    l2_loss: 0.012152    loss: 0.693789
steps 800    v_Prec: 0.251728  v_Recall: 0.505333  v_F1: 0.336053  v_AUC: 0.653590
steps 800    running time 60 seconds

steps 1000    base_loss: 0.459110    reg_loss: 0.201349    l2_loss: 0.012124    loss: 0.672583
steps 1000    v_Prec: 0.301787  v_Recall: 0.506616  v_F1: 0.378252  v_AUC: 0.703568
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.447146    reg_loss: 0.196507    l2_loss: 0.012089    loss: 0.655742
steps 1200    v_Prec: 0.385342  v_Recall: 0.500521  v_F1: 0.435444  v_AUC: 0.750396
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.424190    reg_loss: 0.190396    l2_loss: 0.012086    loss: 0.626672
steps 1400    v_Prec: 0.459077  v_Recall: 0.501564  v_F1: 0.479381  v_AUC: 0.778825
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.403471    reg_loss: 0.186058    l2_loss: 0.012180    loss: 0.601709
steps 1600    v_Prec: 0.496324  v_Recall: 0.525223  v_F1: 0.510365  v_AUC: 0.798429
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.387158    reg_loss: 0.181162    l2_loss: 0.012248    loss: 0.580568
steps 1800    v_Prec: 0.555247  v_Recall: 0.528350  v_F1: 0.541465  v_AUC: 0.818076
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.358483    reg_loss: 0.176251    l2_loss: 0.012354    loss: 0.547088
steps 2000    v_Prec: 0.603062  v_Recall: 0.524421  v_F1: 0.560999  v_AUC: 0.830345
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.353528    reg_loss: 0.173856    l2_loss: 0.012640    loss: 0.540024
steps 2200    v_Prec: 0.632959  v_Recall: 0.542145  v_F1: 0.584043  v_AUC: 0.844456
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.329541    reg_loss: 0.169582    l2_loss: 0.012883    loss: 0.512006
steps 2400    v_Prec: 0.634395  v_Recall: 0.554415  v_F1: 0.591714  v_AUC: 0.853164
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.320351    reg_loss: 0.166252    l2_loss: 0.013241    loss: 0.499843
steps 2600    v_Prec: 0.631747  v_Recall: 0.588580  v_F1: 0.609400  v_AUC: 0.863579
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.309970    reg_loss: 0.164228    l2_loss: 0.013577    loss: 0.487774
steps 2800    v_Prec: 0.659341  v_Recall: 0.591868  v_F1: 0.623785  v_AUC: 0.866972
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.300911    reg_loss: 0.161699    l2_loss: 0.013930    loss: 0.476539
steps 3000    v_Prec: 0.664851  v_Recall: 0.606785  v_F1: 0.634492  v_AUC: 0.871174
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.302070    reg_loss: 0.159096    l2_loss: 0.014394    loss: 0.475560
steps 3200    v_Prec: 0.675383  v_Recall: 0.604860  v_F1: 0.638179  v_AUC: 0.875965
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.296044    reg_loss: 0.156695    l2_loss: 0.014790    loss: 0.467528
steps 3400    v_Prec: 0.682881  v_Recall: 0.615847  v_F1: 0.647634  v_AUC: 0.879685
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.291882    reg_loss: 0.154637    l2_loss: 0.015238    loss: 0.461757
steps 3600    v_Prec: 0.693899  v_Recall: 0.623947  v_F1: 0.657067  v_AUC: 0.885348
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.289709    reg_loss: 0.151829    l2_loss: 0.015645    loss: 0.457183
steps 3800    v_Prec: 0.691076  v_Recall: 0.622905  v_F1: 0.655222  v_AUC: 0.885311
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.281702    reg_loss: 0.149806    l2_loss: 0.016165    loss: 0.447673
steps 4000    v_Prec: 0.691607  v_Recall: 0.627155  v_F1: 0.657806  v_AUC: 0.887055
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.284467    reg_loss: 0.147200    l2_loss: 0.016618    loss: 0.448286
steps 4200    v_Prec: 0.683520  v_Recall: 0.647285  v_F1: 0.664909  v_AUC: 0.889317
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.287480    reg_loss: 0.145408    l2_loss: 0.017109    loss: 0.449997
steps 4400    v_Prec: 0.682230  v_Recall: 0.652739  v_F1: 0.667158  v_AUC: 0.891047
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.287861    reg_loss: 0.143702    l2_loss: 0.017571    loss: 0.449134
steps 4600    v_Prec: 0.689203  v_Recall: 0.653220  v_F1: 0.670729  v_AUC: 0.894926
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.280593    reg_loss: 0.140787    l2_loss: 0.018258    loss: 0.439638
steps 4800    v_Prec: 0.678466  v_Recall: 0.664047  v_F1: 0.671179  v_AUC: 0.893963
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.269696    reg_loss: 0.137390    l2_loss: 0.018742    loss: 0.425828
steps 5000    v_Prec: 0.690520  v_Recall: 0.657791  v_F1: 0.673759  v_AUC: 0.895863
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.275421    reg_loss: 0.135256    l2_loss: 0.019206    loss: 0.429883
steps 5200    v_Prec: 0.715454  v_Recall: 0.645280  v_F1: 0.678558  v_AUC: 0.896691
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.266288    reg_loss: 0.133347    l2_loss: 0.019852    loss: 0.419487
steps 5400    v_Prec: 0.717304  v_Recall: 0.645280  v_F1: 0.679389  v_AUC: 0.897388
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.198520    reg_loss: 0.122186    l2_loss: 0.020412    loss: 0.341119
steps 5600    v_Prec: 0.712168  v_Recall: 0.647285  v_F1: 0.678178  v_AUC: 0.893169
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.203459    reg_loss: 0.122932    l2_loss: 0.021138    loss: 0.347529
steps 5800    v_Prec: 0.708682  v_Recall: 0.646162  v_F1: 0.675980  v_AUC: 0.892869
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.193994    reg_loss: 0.120334    l2_loss: 0.021695    loss: 0.336023
steps 6000    v_Prec: 0.685211  v_Recall: 0.667736  v_F1: 0.676361  v_AUC: 0.894163
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.188255    reg_loss: 0.120496    l2_loss: 0.022209    loss: 0.330961
steps 6200    v_Prec: 0.697270  v_Recall: 0.659636  v_F1: 0.677931  v_AUC: 0.893528
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.200221    reg_loss: 0.120881    l2_loss: 0.022824    loss: 0.343926
steps 6400    v_Prec: 0.693268  v_Recall: 0.668137  v_F1: 0.680470  v_AUC: 0.895581
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.204123    reg_loss: 0.121142    l2_loss: 0.023419    loss: 0.348683
steps 6600    v_Prec: 0.712612  v_Recall: 0.658433  v_F1: 0.684452  v_AUC: 0.897507
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.200112    reg_loss: 0.119222    l2_loss: 0.023837    loss: 0.343171
steps 6800    v_Prec: 0.736389  v_Recall: 0.644318  v_F1: 0.687283  v_AUC: 0.898930
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.206145    reg_loss: 0.119038    l2_loss: 0.024369    loss: 0.349552
steps 7000    v_Prec: 0.726335  v_Recall: 0.660919  v_F1: 0.692085  v_AUC: 0.901870
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.201609    reg_loss: 0.117827    l2_loss: 0.024808    loss: 0.344244
steps 7200    v_Prec: 0.713472  v_Recall: 0.673190  v_F1: 0.692746  v_AUC: 0.899962
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.210454    reg_loss: 0.117776    l2_loss: 0.025118    loss: 0.353349
steps 7400    v_Prec: 0.728006  v_Recall: 0.658994  v_F1: 0.691783  v_AUC: 0.901313
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.204825    reg_loss: 0.116057    l2_loss: 0.025488    loss: 0.346370
steps 7600    v_Prec: 0.737318  v_Recall: 0.653942  v_F1: 0.693132  v_AUC: 0.902164
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.210696    reg_loss: 0.115542    l2_loss: 0.025716    loss: 0.351954
steps 7800    v_Prec: 0.731313  v_Recall: 0.663806  v_F1: 0.695926  v_AUC: 0.903637
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.212345    reg_loss: 0.115265    l2_loss: 0.026108    loss: 0.353718
steps 8000    v_Prec: 0.718602  v_Recall: 0.680969  v_F1: 0.699279  v_AUC: 0.904504
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.210738    reg_loss: 0.113961    l2_loss: 0.026252    loss: 0.350952
steps 8200    v_Prec: 0.754174  v_Recall: 0.644879  v_F1: 0.695257  v_AUC: 0.903659
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.200439    reg_loss: 0.112392    l2_loss: 0.026584    loss: 0.339416
steps 8400    v_Prec: 0.723780  v_Recall: 0.681290  v_F1: 0.701892  v_AUC: 0.906936
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.205911    reg_loss: 0.111631    l2_loss: 0.026961    loss: 0.344504
steps 8600    v_Prec: 0.745962  v_Recall: 0.670463  v_F1: 0.706200  v_AUC: 0.908704
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.208629    reg_loss: 0.110693    l2_loss: 0.027039    loss: 0.346361
steps 8800    v_Prec: 0.738892  v_Recall: 0.680167  v_F1: 0.708314  v_AUC: 0.909147
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.208148    reg_loss: 0.110757    l2_loss: 0.027309    loss: 0.346215
steps 9000    v_Prec: 0.730124  v_Recall: 0.687144  v_F1: 0.707982  v_AUC: 0.909615
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.209244    reg_loss: 0.109458    l2_loss: 0.027557    loss: 0.346259
steps 9200    v_Prec: 0.737623  v_Recall: 0.685861  v_F1: 0.710801  v_AUC: 0.911618
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.203124    reg_loss: 0.107149    l2_loss: 0.027708    loss: 0.337981
steps 9400    v_Prec: 0.734918  v_Recall: 0.686823  v_F1: 0.710057  v_AUC: 0.911527
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.215742    reg_loss: 0.108571    l2_loss: 0.027878    loss: 0.352192
steps 9600    v_Prec: 0.739849  v_Recall: 0.689710  v_F1: 0.713900  v_AUC: 0.914332
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.207542    reg_loss: 0.106542    l2_loss: 0.028102    loss: 0.342187
steps 9800    v_Prec: 0.743702  v_Recall: 0.693720  v_F1: 0.717842  v_AUC: 0.913639
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.209953    reg_loss: 0.106065    l2_loss: 0.028173    loss: 0.344191
steps 10000    v_Prec: 0.745110  v_Recall: 0.693480  v_F1: 0.718368  v_AUC: 0.916003
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.203158    reg_loss: 0.105227    l2_loss: 0.028446    loss: 0.336830
steps 10200    v_Prec: 0.748086  v_Recall: 0.697570  v_F1: 0.721946  v_AUC: 0.915494
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.201854    reg_loss: 0.104176    l2_loss: 0.028590    loss: 0.334620
steps 10400    v_Prec: 0.729752  v_Recall: 0.708156  v_F1: 0.718792  v_AUC: 0.914126
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.210587    reg_loss: 0.105040    l2_loss: 0.028727    loss: 0.344354
steps 10600    v_Prec: 0.751234  v_Recall: 0.695806  v_F1: 0.722458  v_AUC: 0.916850
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.192413    reg_loss: 0.101490    l2_loss: 0.028818    loss: 0.322721
steps 10800    v_Prec: 0.758548  v_Recall: 0.692116  v_F1: 0.723811  v_AUC: 0.916374
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.100531    reg_loss: 0.093806    l2_loss: 0.028953    loss: 0.223290
steps 11000    v_Prec: 0.756123  v_Recall: 0.690753  v_F1: 0.721961  v_AUC: 0.915491
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.098117    reg_loss: 0.094086    l2_loss: 0.029006    loss: 0.221210
steps 11200    v_Prec: 0.755794  v_Recall: 0.687786  v_F1: 0.720188  v_AUC: 0.914725
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.106460    reg_loss: 0.095369    l2_loss: 0.029048    loss: 0.230877
steps 11400    v_Prec: 0.739145  v_Recall: 0.700377  v_F1: 0.719239  v_AUC: 0.913519
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.096356    reg_loss: 0.095200    l2_loss: 0.029201    loss: 0.220757
steps 11600    v_Prec: 0.737245  v_Recall: 0.703424  v_F1: 0.719938  v_AUC: 0.913546
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.102281    reg_loss: 0.095962    l2_loss: 0.029158    loss: 0.227401
steps 11800    v_Prec: 0.763398  v_Recall: 0.671746  v_F1: 0.714645  v_AUC: 0.910772
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.108834    reg_loss: 0.096648    l2_loss: 0.029228    loss: 0.234710
steps 12000    v_Prec: 0.740994  v_Recall: 0.686262  v_F1: 0.712579  v_AUC: 0.908771
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.104406    reg_loss: 0.096989    l2_loss: 0.029294    loss: 0.230689
steps 12200    v_Prec: 0.748357  v_Recall: 0.684738  v_F1: 0.715135  v_AUC: 0.909051
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.106424    reg_loss: 0.097726    l2_loss: 0.029416    loss: 0.233566
steps 12400    v_Prec: 0.767390  v_Recall: 0.666212  v_F1: 0.713231  v_AUC: 0.909669
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.106195    reg_loss: 0.097617    l2_loss: 0.029382    loss: 0.233194
steps 12600    v_Prec: 0.745161  v_Recall: 0.685460  v_F1: 0.714065  v_AUC: 0.907966
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.107728    reg_loss: 0.097206    l2_loss: 0.029408    loss: 0.234342
steps 12800    v_Prec: 0.738511  v_Recall: 0.694683  v_F1: 0.715927  v_AUC: 0.909953
steps 12800    running time 452 seconds

Early stop model F1: 0.723811
testing thre: 0.39346611
testing Prec: 0.5186717998075072
testing Recall: 0.7857594167679223
testing F1: 0.6248719683061166
testing AUC: 0.8976256436121122
overall running time 455 seconds
(0.7011834319526628, 0.6565735115431349, 0.6781456288747773, 0.8976256436121122, 0.77284706)

2019-02-24 17:50:15.823690: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:50:17.610611: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:50:17.644830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:50:17.644909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.490000 seconds
loading data in 30.660000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.702330    reg_loss: 0.215208    l2_loss: 0.013402    loss: 0.930940
steps 200    v_Prec: 0.165662  v_Recall: 0.975214  v_F1: 0.283214  v_AUC: 0.523502
steps 200    running time 41 seconds

steps 400    base_loss: 0.538456    reg_loss: 0.214841    l2_loss: 0.013435    loss: 0.766732
steps 400    v_Prec: 0.176499  v_Recall: 0.782072  v_F1: 0.288001  v_AUC: 0.551805
steps 400    running time 47 seconds

steps 600    base_loss: 0.482510    reg_loss: 0.212152    l2_loss: 0.013355    loss: 0.708017
steps 600    v_Prec: 0.194075  v_Recall: 0.654736  v_F1: 0.299402  v_AUC: 0.585412
steps 600    running time 54 seconds

steps 800    base_loss: 0.468241    reg_loss: 0.210296    l2_loss: 0.013221    loss: 0.691757
steps 800    v_Prec: 0.219603  v_Recall: 0.584257  v_F1: 0.319221  v_AUC: 0.626045
steps 800    running time 61 seconds

steps 1000    base_loss: 0.450188    reg_loss: 0.207538    l2_loss: 0.013114    loss: 0.670840
steps 1000    v_Prec: 0.272109  v_Recall: 0.510215  v_F1: 0.354928  v_AUC: 0.672282
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.422039    reg_loss: 0.203306    l2_loss: 0.013166    loss: 0.638511
steps 1200    v_Prec: 0.406006  v_Recall: 0.449636  v_F1: 0.426709  v_AUC: 0.729786
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.388392    reg_loss: 0.198862    l2_loss: 0.013255    loss: 0.600509
steps 1400    v_Prec: 0.488612  v_Recall: 0.472284  v_F1: 0.480309  v_AUC: 0.773337
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.375033    reg_loss: 0.196055    l2_loss: 0.013410    loss: 0.584498
steps 1600    v_Prec: 0.548229  v_Recall: 0.495090  v_F1: 0.520306  v_AUC: 0.800094
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.352122    reg_loss: 0.192270    l2_loss: 0.013640    loss: 0.558033
steps 1800    v_Prec: 0.585425  v_Recall: 0.533735  v_F1: 0.558386  v_AUC: 0.826825
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.334402    reg_loss: 0.189310    l2_loss: 0.013874    loss: 0.537585
steps 2000    v_Prec: 0.628708  v_Recall: 0.550443  v_F1: 0.586979  v_AUC: 0.842612
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.326019    reg_loss: 0.186308    l2_loss: 0.014173    loss: 0.526499
steps 2200    v_Prec: 0.647282  v_Recall: 0.566756  v_F1: 0.604349  v_AUC: 0.853973
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.309108    reg_loss: 0.183640    l2_loss: 0.014452    loss: 0.507200
steps 2400    v_Prec: 0.642329  v_Recall: 0.591463  v_F1: 0.615848  v_AUC: 0.859561
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.313178    reg_loss: 0.181153    l2_loss: 0.014727    loss: 0.509058
steps 2600    v_Prec: 0.664146  v_Recall: 0.598194  v_F1: 0.629448  v_AUC: 0.866580
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.300136    reg_loss: 0.177384    l2_loss: 0.014996    loss: 0.492515
steps 2800    v_Prec: 0.679021  v_Recall: 0.597719  v_F1: 0.635782  v_AUC: 0.869802
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.294890    reg_loss: 0.174576    l2_loss: 0.015254    loss: 0.484720
steps 3000    v_Prec: 0.699113  v_Recall: 0.598907  v_F1: 0.645142  v_AUC: 0.874373
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.298099    reg_loss: 0.172681    l2_loss: 0.015524    loss: 0.486304
steps 3200    v_Prec: 0.682912  v_Recall: 0.624723  v_F1: 0.652523  v_AUC: 0.878004
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.296498    reg_loss: 0.169938    l2_loss: 0.015838    loss: 0.482274
steps 3400    v_Prec: 0.682910  v_Recall: 0.630345  v_F1: 0.655576  v_AUC: 0.881155
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.289119    reg_loss: 0.167588    l2_loss: 0.016156    loss: 0.472863
steps 3600    v_Prec: 0.698651  v_Recall: 0.619259  v_F1: 0.656564  v_AUC: 0.882827
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.279484    reg_loss: 0.164668    l2_loss: 0.016483    loss: 0.460635
steps 3800    v_Prec: 0.707364  v_Recall: 0.616170  v_F1: 0.658625  v_AUC: 0.883478
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.282021    reg_loss: 0.161768    l2_loss: 0.016803    loss: 0.460592
steps 4000    v_Prec: 0.701022  v_Recall: 0.630187  v_F1: 0.663720  v_AUC: 0.884668
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.281791    reg_loss: 0.159554    l2_loss: 0.017158    loss: 0.458503
steps 4200    v_Prec: 0.711976  v_Recall: 0.631296  v_F1: 0.669213  v_AUC: 0.887124
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.277548    reg_loss: 0.157160    l2_loss: 0.017445    loss: 0.452153
steps 4400    v_Prec: 0.721526  v_Recall: 0.629078  v_F1: 0.672138  v_AUC: 0.889357
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.277165    reg_loss: 0.154580    l2_loss: 0.017848    loss: 0.449593
steps 4600    v_Prec: 0.709282  v_Recall: 0.641432  v_F1: 0.673653  v_AUC: 0.890269
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.276856    reg_loss: 0.152394    l2_loss: 0.018274    loss: 0.447525
steps 4800    v_Prec: 0.712544  v_Recall: 0.643253  v_F1: 0.676128  v_AUC: 0.892080
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.272416    reg_loss: 0.149558    l2_loss: 0.018686    loss: 0.440660
steps 5000    v_Prec: 0.720442  v_Recall: 0.635493  v_F1: 0.675306  v_AUC: 0.895220
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.272477    reg_loss: 0.147705    l2_loss: 0.019224    loss: 0.439407
steps 5200    v_Prec: 0.703411  v_Recall: 0.654894  v_F1: 0.678286  v_AUC: 0.894538
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.268223    reg_loss: 0.145317    l2_loss: 0.019726    loss: 0.433266
steps 5400    v_Prec: 0.716444  v_Recall: 0.653468  v_F1: 0.683509  v_AUC: 0.893543
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.175254    reg_loss: 0.131011    l2_loss: 0.020312    loss: 0.326577
steps 5600    v_Prec: 0.710847  v_Recall: 0.659566  v_F1: 0.684247  v_AUC: 0.892294
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.172628    reg_loss: 0.131220    l2_loss: 0.021008    loss: 0.324856
steps 5800    v_Prec: 0.712876  v_Recall: 0.657666  v_F1: 0.684158  v_AUC: 0.891623
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.190926    reg_loss: 0.132440    l2_loss: 0.021553    loss: 0.344920
steps 6000    v_Prec: 0.724609  v_Recall: 0.646341  v_F1: 0.683241  v_AUC: 0.890010
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.199815    reg_loss: 0.132890    l2_loss: 0.022158    loss: 0.354864
steps 6200    v_Prec: 0.723951  v_Recall: 0.654181  v_F1: 0.687300  v_AUC: 0.894618
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.191686    reg_loss: 0.131033    l2_loss: 0.022741    loss: 0.345459
steps 6400    v_Prec: 0.735084  v_Recall: 0.651726  v_F1: 0.690900  v_AUC: 0.894048
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.182820    reg_loss: 0.129045    l2_loss: 0.023177    loss: 0.335041
steps 6600    v_Prec: 0.733982  v_Recall: 0.651330  v_F1: 0.690190  v_AUC: 0.894910
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.200609    reg_loss: 0.130091    l2_loss: 0.023646    loss: 0.354345
steps 6800    v_Prec: 0.719904  v_Recall: 0.663921  v_F1: 0.690780  v_AUC: 0.895273
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.191193    reg_loss: 0.128454    l2_loss: 0.024038    loss: 0.343685
steps 7000    v_Prec: 0.746883  v_Recall: 0.649826  v_F1: 0.694982  v_AUC: 0.895988
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.195146    reg_loss: 0.127468    l2_loss: 0.024509    loss: 0.347123
steps 7200    v_Prec: 0.733327  v_Recall: 0.659170  v_F1: 0.694274  v_AUC: 0.897790
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.192468    reg_loss: 0.127394    l2_loss: 0.024786    loss: 0.344648
steps 7400    v_Prec: 0.736641  v_Recall: 0.657190  v_F1: 0.694651  v_AUC: 0.899239
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.199477    reg_loss: 0.125964    l2_loss: 0.025227    loss: 0.350668
steps 7600    v_Prec: 0.727155  v_Recall: 0.668594  v_F1: 0.696646  v_AUC: 0.900673
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.196541    reg_loss: 0.124071    l2_loss: 0.025329    loss: 0.345941
steps 7800    v_Prec: 0.735067  v_Recall: 0.662654  v_F1: 0.696985  v_AUC: 0.901598
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.197884    reg_loss: 0.123460    l2_loss: 0.025592    loss: 0.346936
steps 8000    v_Prec: 0.736585  v_Recall: 0.667406  v_F1: 0.700291  v_AUC: 0.903649
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.193859    reg_loss: 0.122194    l2_loss: 0.025916    loss: 0.341969
steps 8200    v_Prec: 0.750045  v_Recall: 0.663209  v_F1: 0.703959  v_AUC: 0.904047
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.195488    reg_loss: 0.121175    l2_loss: 0.026064    loss: 0.342727
steps 8400    v_Prec: 0.724572  v_Recall: 0.683719  v_F1: 0.703553  v_AUC: 0.904331
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.204530    reg_loss: 0.121542    l2_loss: 0.026330    loss: 0.352402
steps 8600    v_Prec: 0.733430  v_Recall: 0.683481  v_F1: 0.707575  v_AUC: 0.905541
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.195328    reg_loss: 0.119619    l2_loss: 0.026522    loss: 0.341469
steps 8800    v_Prec: 0.735063  v_Recall: 0.688787  v_F1: 0.711173  v_AUC: 0.906216
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.198332    reg_loss: 0.119048    l2_loss: 0.026807    loss: 0.344187
steps 9000    v_Prec: 0.783149  v_Recall: 0.654340  v_F1: 0.712973  v_AUC: 0.906819
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.202593    reg_loss: 0.118050    l2_loss: 0.027020    loss: 0.347663
steps 9200    v_Prec: 0.759878  v_Recall: 0.671603  v_F1: 0.713019  v_AUC: 0.908146
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.200560    reg_loss: 0.117955    l2_loss: 0.027175    loss: 0.345689
steps 9400    v_Prec: 0.746766  v_Recall: 0.681185  v_F1: 0.712469  v_AUC: 0.909089
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.210306    reg_loss: 0.116909    l2_loss: 0.027344    loss: 0.354559
steps 9600    v_Prec: 0.748175  v_Recall: 0.690054  v_F1: 0.717940  v_AUC: 0.909981
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.201837    reg_loss: 0.115726    l2_loss: 0.027511    loss: 0.345073
steps 9800    v_Prec: 0.749079  v_Recall: 0.692430  v_F1: 0.719641  v_AUC: 0.911562
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.196058    reg_loss: 0.114020    l2_loss: 0.027620    loss: 0.337698
steps 10000    v_Prec: 0.763359  v_Recall: 0.681026  v_F1: 0.719846  v_AUC: 0.910391
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.201735    reg_loss: 0.114013    l2_loss: 0.027742    loss: 0.343490
steps 10200    v_Prec: 0.754797  v_Recall: 0.694726  v_F1: 0.723517  v_AUC: 0.911875
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.202154    reg_loss: 0.113760    l2_loss: 0.027823    loss: 0.343737
steps 10400    v_Prec: 0.766418  v_Recall: 0.683877  v_F1: 0.722799  v_AUC: 0.912873
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.197741    reg_loss: 0.111738    l2_loss: 0.027988    loss: 0.337467
steps 10600    v_Prec: 0.752401  v_Recall: 0.700982  v_F1: 0.725782  v_AUC: 0.913757
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.193563    reg_loss: 0.110093    l2_loss: 0.028222    loss: 0.331878
steps 10800    v_Prec: 0.754363  v_Recall: 0.698210  v_F1: 0.725202  v_AUC: 0.914767
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.089896    reg_loss: 0.098012    l2_loss: 0.028304    loss: 0.216212
steps 11000    v_Prec: 0.771301  v_Recall: 0.683164  v_F1: 0.724562  v_AUC: 0.912833
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.093946    reg_loss: 0.099547    l2_loss: 0.028294    loss: 0.221787
steps 11200    v_Prec: 0.773309  v_Recall: 0.669940  v_F1: 0.717923  v_AUC: 0.911194
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.095764    reg_loss: 0.100647    l2_loss: 0.028440    loss: 0.224850
steps 11400    v_Prec: 0.764236  v_Recall: 0.673820  v_F1: 0.716186  v_AUC: 0.909550
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.092000    reg_loss: 0.100105    l2_loss: 0.028425    loss: 0.220530
steps 11600    v_Prec: 0.764480  v_Recall: 0.679363  v_F1: 0.719413  v_AUC: 0.909918
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.100980    reg_loss: 0.101995    l2_loss: 0.028675    loss: 0.231651
steps 11800    v_Prec: 0.761055  v_Recall: 0.678730  v_F1: 0.717539  v_AUC: 0.909023
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.096497    reg_loss: 0.101449    l2_loss: 0.028728    loss: 0.226674
steps 12000    v_Prec: 0.767252  v_Recall: 0.668277  v_F1: 0.714352  v_AUC: 0.907467
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.099436    reg_loss: 0.101133    l2_loss: 0.028789    loss: 0.229357
steps 12200    v_Prec: 0.749503  v_Recall: 0.686411  v_F1: 0.716571  v_AUC: 0.909445
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.097968    reg_loss: 0.101919    l2_loss: 0.028946    loss: 0.228833
steps 12400    v_Prec: 0.736597  v_Recall: 0.701774  v_F1: 0.718764  v_AUC: 0.909674
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.097963    reg_loss: 0.101379    l2_loss: 0.028933    loss: 0.228275
steps 12600    v_Prec: 0.756923  v_Recall: 0.684035  v_F1: 0.718636  v_AUC: 0.911321
steps 12600    running time 446 seconds

Early stop model F1: 0.725782
testing thre: 0.46651506
testing Prec: 0.48775982878419183
testing Recall: 0.808602673147023
testing F1: 0.6084777997220393
testing AUC: 0.8992038489112975
overall running time 449 seconds
(0.716317003809626, 0.6488456865127582, 0.6809140059165562, 0.8992038489112975, 0.8541746)

2019-02-24 17:55:11.792228: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:55:12.604986: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:55:12.613106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:55:12.613144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.360000 seconds
loading data in 30.330000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.844941    reg_loss: 0.215411    l2_loss: 0.013289    loss: 1.073641
steps 200    v_Prec: 0.165987  v_Recall: 0.999135  v_F1: 0.284680  v_AUC: 0.527986
steps 200    running time 40 seconds

steps 400    base_loss: 0.571427    reg_loss: 0.214744    l2_loss: 0.013169    loss: 0.799341
steps 400    v_Prec: 0.173720  v_Recall: 0.819926  v_F1: 0.286696  v_AUC: 0.548890
steps 400    running time 47 seconds

steps 600    base_loss: 0.486321    reg_loss: 0.213444    l2_loss: 0.013093    loss: 0.712857
steps 600    v_Prec: 0.192937  v_Recall: 0.652591  v_F1: 0.297823  v_AUC: 0.581113
steps 600    running time 54 seconds

steps 800    base_loss: 0.460520    reg_loss: 0.210963    l2_loss: 0.013015    loss: 0.684498
steps 800    v_Prec: 0.224664  v_Recall: 0.561139  v_F1: 0.320863  v_AUC: 0.621255
steps 800    running time 60 seconds

steps 1000    base_loss: 0.439445    reg_loss: 0.208066    l2_loss: 0.012999    loss: 0.660511
steps 1000    v_Prec: 0.270046  v_Recall: 0.525674  v_F1: 0.356800  v_AUC: 0.671127
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.420110    reg_loss: 0.204643    l2_loss: 0.012974    loss: 0.637728
steps 1200    v_Prec: 0.309476  v_Recall: 0.513093  v_F1: 0.386083  v_AUC: 0.706228
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.411108    reg_loss: 0.201929    l2_loss: 0.013043    loss: 0.626081
steps 1400    v_Prec: 0.382640  v_Recall: 0.499174  v_F1: 0.433207  v_AUC: 0.748358
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.387458    reg_loss: 0.198735    l2_loss: 0.013150    loss: 0.599343
steps 1600    v_Prec: 0.435399  v_Recall: 0.507195  v_F1: 0.468563  v_AUC: 0.777933
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.366717    reg_loss: 0.194879    l2_loss: 0.013324    loss: 0.574920
steps 1800    v_Prec: 0.486786  v_Recall: 0.524338  v_F1: 0.504865  v_AUC: 0.801203
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.364692    reg_loss: 0.193442    l2_loss: 0.013523    loss: 0.571657
steps 2000    v_Prec: 0.487605  v_Recall: 0.584650  v_F1: 0.531736  v_AUC: 0.823510
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.335678    reg_loss: 0.189346    l2_loss: 0.013748    loss: 0.538772
steps 2200    v_Prec: 0.533650  v_Recall: 0.582370  v_F1: 0.556947  v_AUC: 0.838281
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.326301    reg_loss: 0.186425    l2_loss: 0.014049    loss: 0.526775
steps 2400    v_Prec: 0.557035  v_Recall: 0.592121  v_F1: 0.574042  v_AUC: 0.849675
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.312629    reg_loss: 0.182981    l2_loss: 0.014357    loss: 0.509966
steps 2600    v_Prec: 0.576357  v_Recall: 0.603051  v_F1: 0.589402  v_AUC: 0.856735
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.317706    reg_loss: 0.180979    l2_loss: 0.014713    loss: 0.513398
steps 2800    v_Prec: 0.599186  v_Recall: 0.601636  v_F1: 0.600408  v_AUC: 0.863982
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.310597    reg_loss: 0.178067    l2_loss: 0.015013    loss: 0.503677
steps 3000    v_Prec: 0.619587  v_Recall: 0.606432  v_F1: 0.612939  v_AUC: 0.869120
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.307092    reg_loss: 0.175109    l2_loss: 0.015446    loss: 0.497647
steps 3200    v_Prec: 0.624692  v_Recall: 0.618699  v_F1: 0.621681  v_AUC: 0.876122
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.296776    reg_loss: 0.171737    l2_loss: 0.015921    loss: 0.484434
steps 3400    v_Prec: 0.628201  v_Recall: 0.624990  v_F1: 0.626592  v_AUC: 0.879494
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.302974    reg_loss: 0.168978    l2_loss: 0.016317    loss: 0.488269
steps 3600    v_Prec: 0.626683  v_Recall: 0.640481  v_F1: 0.633507  v_AUC: 0.881541
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.302941    reg_loss: 0.165506    l2_loss: 0.016798    loss: 0.485244
steps 3800    v_Prec: 0.637851  v_Recall: 0.637650  v_F1: 0.637751  v_AUC: 0.885181
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.297642    reg_loss: 0.162326    l2_loss: 0.017229    loss: 0.477197
steps 4000    v_Prec: 0.651510  v_Recall: 0.627585  v_F1: 0.639324  v_AUC: 0.885485
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.291374    reg_loss: 0.159659    l2_loss: 0.017703    loss: 0.468735
steps 4200    v_Prec: 0.648232  v_Recall: 0.634112  v_F1: 0.641094  v_AUC: 0.886004
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.291324    reg_loss: 0.155912    l2_loss: 0.018275    loss: 0.465511
steps 4400    v_Prec: 0.654780  v_Recall: 0.633876  v_F1: 0.644159  v_AUC: 0.884081
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.283436    reg_loss: 0.153191    l2_loss: 0.018787    loss: 0.455413
steps 4600    v_Prec: 0.641786  v_Recall: 0.649760  v_F1: 0.645749  v_AUC: 0.885814
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.291196    reg_loss: 0.150708    l2_loss: 0.019431    loss: 0.461336
steps 4800    v_Prec: 0.653013  v_Recall: 0.646851  v_F1: 0.649917  v_AUC: 0.888492
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.284387    reg_loss: 0.147059    l2_loss: 0.020079    loss: 0.451525
steps 5000    v_Prec: 0.667769  v_Recall: 0.635055  v_F1: 0.651002  v_AUC: 0.889279
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.285897    reg_loss: 0.144859    l2_loss: 0.020646    loss: 0.451402
steps 5200    v_Prec: 0.649895  v_Recall: 0.654085  v_F1: 0.651983  v_AUC: 0.888754
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.279703    reg_loss: 0.141838    l2_loss: 0.021234    loss: 0.442775
steps 5400    v_Prec: 0.655678  v_Recall: 0.653771  v_F1: 0.654723  v_AUC: 0.891107
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.198548    reg_loss: 0.139592    l2_loss: 0.021818    loss: 0.359958
steps 5600    v_Prec: 0.664050  v_Recall: 0.645199  v_F1: 0.654489  v_AUC: 0.890781
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.193891    reg_loss: 0.139054    l2_loss: 0.022349    loss: 0.355294
steps 5800    v_Prec: 0.652296  v_Recall: 0.656759  v_F1: 0.654520  v_AUC: 0.891350
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.199085    reg_loss: 0.140197    l2_loss: 0.022858    loss: 0.362140
steps 6000    v_Prec: 0.678409  v_Recall: 0.634505  v_F1: 0.655723  v_AUC: 0.890150
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.186010    reg_loss: 0.138507    l2_loss: 0.023465    loss: 0.347982
steps 6200    v_Prec: 0.658972  v_Recall: 0.655501  v_F1: 0.657232  v_AUC: 0.891628
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.190974    reg_loss: 0.137394    l2_loss: 0.023987    loss: 0.352355
steps 6400    v_Prec: 0.645715  v_Recall: 0.668868  v_F1: 0.657088  v_AUC: 0.891685
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.198628    reg_loss: 0.136969    l2_loss: 0.024461    loss: 0.360058
steps 6600    v_Prec: 0.685115  v_Recall: 0.636628  v_F1: 0.659982  v_AUC: 0.893462
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.192376    reg_loss: 0.135139    l2_loss: 0.024811    loss: 0.352326
steps 6800    v_Prec: 0.660542  v_Recall: 0.661477  v_F1: 0.661009  v_AUC: 0.894470
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.200030    reg_loss: 0.135104    l2_loss: 0.025277    loss: 0.360411
steps 7000    v_Prec: 0.659668  v_Recall: 0.672014  v_F1: 0.665784  v_AUC: 0.897284
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.195440    reg_loss: 0.133163    l2_loss: 0.025705    loss: 0.354309
steps 7200    v_Prec: 0.658991  v_Recall: 0.670598  v_F1: 0.664744  v_AUC: 0.898076
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.195068    reg_loss: 0.131830    l2_loss: 0.025979    loss: 0.352877
steps 7400    v_Prec: 0.662567  v_Recall: 0.660848  v_F1: 0.661706  v_AUC: 0.896425
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.200459    reg_loss: 0.130938    l2_loss: 0.026336    loss: 0.357732
steps 7600    v_Prec: 0.667141  v_Recall: 0.663679  v_F1: 0.665405  v_AUC: 0.898829
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.205232    reg_loss: 0.129626    l2_loss: 0.026780    loss: 0.361638
steps 7800    v_Prec: 0.639039  v_Recall: 0.698435  v_F1: 0.667418  v_AUC: 0.899282
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.205965    reg_loss: 0.128807    l2_loss: 0.027092    loss: 0.361863
steps 8000    v_Prec: 0.673646  v_Recall: 0.662892  v_F1: 0.668226  v_AUC: 0.900123
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.199219    reg_loss: 0.126252    l2_loss: 0.027391    loss: 0.352862
steps 8200    v_Prec: 0.673927  v_Recall: 0.673980  v_F1: 0.673953  v_AUC: 0.901277
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.194837    reg_loss: 0.125121    l2_loss: 0.027656    loss: 0.347613
steps 8400    v_Prec: 0.672019  v_Recall: 0.677990  v_F1: 0.674991  v_AUC: 0.902762
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.202519    reg_loss: 0.123512    l2_loss: 0.027964    loss: 0.353995
steps 8600    v_Prec: 0.667156  v_Recall: 0.678855  v_F1: 0.672955  v_AUC: 0.902524
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.204743    reg_loss: 0.122650    l2_loss: 0.028160    loss: 0.355553
steps 8800    v_Prec: 0.689019  v_Recall: 0.673036  v_F1: 0.680934  v_AUC: 0.905629
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.203500    reg_loss: 0.122757    l2_loss: 0.028448    loss: 0.354706
steps 9000    v_Prec: 0.676086  v_Recall: 0.690493  v_F1: 0.683213  v_AUC: 0.906943
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.189539    reg_loss: 0.119557    l2_loss: 0.028568    loss: 0.337664
steps 9200    v_Prec: 0.687475  v_Recall: 0.681529  v_F1: 0.684489  v_AUC: 0.907013
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.209422    reg_loss: 0.119662    l2_loss: 0.028797    loss: 0.357880
steps 9400    v_Prec: 0.698067  v_Recall: 0.675946  v_F1: 0.686828  v_AUC: 0.908782
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.203732    reg_loss: 0.118375    l2_loss: 0.028914    loss: 0.351022
steps 9600    v_Prec: 0.671686  v_Recall: 0.701581  v_F1: 0.686308  v_AUC: 0.910605
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.213797    reg_loss: 0.118329    l2_loss: 0.029173    loss: 0.361299
steps 9800    v_Prec: 0.700609  v_Recall: 0.679012  v_F1: 0.689641  v_AUC: 0.910998
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.207157    reg_loss: 0.117229    l2_loss: 0.029433    loss: 0.353818
steps 10000    v_Prec: 0.689447  v_Recall: 0.692538  v_F1: 0.690989  v_AUC: 0.910197
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.195888    reg_loss: 0.115138    l2_loss: 0.029610    loss: 0.340636
steps 10200    v_Prec: 0.713771  v_Recall: 0.670048  v_F1: 0.691219  v_AUC: 0.909679
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.204644    reg_loss: 0.114978    l2_loss: 0.029798    loss: 0.349420
steps 10400    v_Prec: 0.705868  v_Recall: 0.681057  v_F1: 0.693240  v_AUC: 0.911933
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.203017    reg_loss: 0.113040    l2_loss: 0.030005    loss: 0.346062
steps 10600    v_Prec: 0.710658  v_Recall: 0.682158  v_F1: 0.696116  v_AUC: 0.914042
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.187799    reg_loss: 0.112085    l2_loss: 0.030202    loss: 0.330086
steps 10800    v_Prec: 0.714309  v_Recall: 0.679877  v_F1: 0.696668  v_AUC: 0.912925
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.087573    reg_loss: 0.106987    l2_loss: 0.030195    loss: 0.224755
steps 11000    v_Prec: 0.715767  v_Recall: 0.672879  v_F1: 0.693661  v_AUC: 0.912821
steps 11000    running time 398 seconds

steps 11200    base_loss: 0.084418    reg_loss: 0.108141    l2_loss: 0.030031    loss: 0.222591
steps 11200    v_Prec: 0.697333  v_Recall: 0.686640  v_F1: 0.691945  v_AUC: 0.911941
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.090870    reg_loss: 0.110611    l2_loss: 0.029948    loss: 0.231428
steps 11400    v_Prec: 0.704245  v_Recall: 0.674452  v_F1: 0.689026  v_AUC: 0.909770
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.094272    reg_loss: 0.109467    l2_loss: 0.029847    loss: 0.233586
steps 11600    v_Prec: 0.698074  v_Recall: 0.681057  v_F1: 0.689460  v_AUC: 0.908289
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.081349    reg_loss: 0.108428    l2_loss: 0.029666    loss: 0.219443
steps 11800    v_Prec: 0.707819  v_Recall: 0.667689  v_F1: 0.687169  v_AUC: 0.907520
steps 11800    running time 423 seconds

steps 12000    base_loss: 0.090977    reg_loss: 0.108756    l2_loss: 0.029621    loss: 0.229355
steps 12000    v_Prec: 0.707660  v_Recall: 0.661084  v_F1: 0.683579  v_AUC: 0.903583
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.093886    reg_loss: 0.109524    l2_loss: 0.029576    loss: 0.232986
steps 12200    v_Prec: 0.685892  v_Recall: 0.675159  v_F1: 0.680483  v_AUC: 0.903366
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.087849    reg_loss: 0.109563    l2_loss: 0.029546    loss: 0.226957
steps 12400    v_Prec: 0.686737  v_Recall: 0.677125  v_F1: 0.681897  v_AUC: 0.904811
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.091854    reg_loss: 0.109598    l2_loss: 0.029532    loss: 0.230983
steps 12600    v_Prec: 0.691864  v_Recall: 0.670048  v_F1: 0.680781  v_AUC: 0.903388
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.094070    reg_loss: 0.109025    l2_loss: 0.029544    loss: 0.232639
steps 12800    v_Prec: 0.694215  v_Recall: 0.667138  v_F1: 0.680407  v_AUC: 0.903615
steps 12800    running time 454 seconds

Early stop model F1: 0.696668
testing thre: 0.44440866
testing Prec: 0.4869772287542789
testing Recall: 0.7951397326852977
testing F1: 0.6040243677312165
testing AUC: 0.8950905910295679
overall running time 457 seconds
(0.6849597689292346, 0.6454434993924666, 0.6646147686610114, 0.8950905910295679, 0.8602798)

2019-02-24 18:00:10.888554: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:00:12.257178: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:00:12.261806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:00:12.261846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.790000 seconds
loading data in 30.010000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.508905    reg_loss: 0.216018    l2_loss: 0.013278    loss: 0.738202
steps 200    v_Prec: 0.164749  v_Recall: 0.999287  v_F1: 0.282863  v_AUC: 0.529063
steps 200    running time 40 seconds

steps 400    base_loss: 0.483298    reg_loss: 0.214804    l2_loss: 0.013249    loss: 0.711352
steps 400    v_Prec: 0.169505  v_Recall: 0.888546  v_F1: 0.284699  v_AUC: 0.548303
steps 400    running time 47 seconds

steps 600    base_loss: 0.474638    reg_loss: 0.213065    l2_loss: 0.013185    loss: 0.700887
steps 600    v_Prec: 0.200031  v_Recall: 0.615336  v_F1: 0.301916  v_AUC: 0.596618
steps 600    running time 54 seconds

steps 800    base_loss: 0.453034    reg_loss: 0.209402    l2_loss: 0.013078    loss: 0.675514
steps 800    v_Prec: 0.218859  v_Recall: 0.643298  v_F1: 0.326604  v_AUC: 0.643176
steps 800    running time 61 seconds

steps 1000    base_loss: 0.446044    reg_loss: 0.205908    l2_loss: 0.013027    loss: 0.664980
steps 1000    v_Prec: 0.304759  v_Recall: 0.453977  v_F1: 0.364695  v_AUC: 0.690990
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.423216    reg_loss: 0.201319    l2_loss: 0.013030    loss: 0.637564
steps 1200    v_Prec: 0.359661  v_Recall: 0.497069  v_F1: 0.417346  v_AUC: 0.739424
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.398552    reg_loss: 0.197415    l2_loss: 0.013055    loss: 0.609022
steps 1400    v_Prec: 0.441048  v_Recall: 0.486850  v_F1: 0.462819  v_AUC: 0.772968
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.375841    reg_loss: 0.193357    l2_loss: 0.013243    loss: 0.582441
steps 1600    v_Prec: 0.484255  v_Recall: 0.515288  v_F1: 0.499290  v_AUC: 0.802989
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.351733    reg_loss: 0.189333    l2_loss: 0.013413    loss: 0.554479
steps 1800    v_Prec: 0.556250  v_Recall: 0.514655  v_F1: 0.534645  v_AUC: 0.824637
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.338249    reg_loss: 0.185947    l2_loss: 0.013644    loss: 0.537840
steps 2000    v_Prec: 0.584775  v_Recall: 0.535488  v_F1: 0.559047  v_AUC: 0.839195
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.330445    reg_loss: 0.182911    l2_loss: 0.013890    loss: 0.527246
steps 2200    v_Prec: 0.619818  v_Recall: 0.546023  v_F1: 0.580585  v_AUC: 0.851333
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.329404    reg_loss: 0.180364    l2_loss: 0.014170    loss: 0.523937
steps 2400    v_Prec: 0.594375  v_Recall: 0.590938  v_F1: 0.592651  v_AUC: 0.860200
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.314321    reg_loss: 0.176358    l2_loss: 0.014491    loss: 0.505171
steps 2600    v_Prec: 0.612710  v_Recall: 0.600285  v_F1: 0.606434  v_AUC: 0.866965
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.309459    reg_loss: 0.172767    l2_loss: 0.014829    loss: 0.497055
steps 2800    v_Prec: 0.622340  v_Recall: 0.611692  v_F1: 0.616970  v_AUC: 0.872976
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.306268    reg_loss: 0.170167    l2_loss: 0.015154    loss: 0.491590
steps 3000    v_Prec: 0.650912  v_Recall: 0.607652  v_F1: 0.628539  v_AUC: 0.876495
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.294663    reg_loss: 0.166775    l2_loss: 0.015569    loss: 0.477007
steps 3200    v_Prec: 0.649771  v_Recall: 0.619455  v_F1: 0.634251  v_AUC: 0.880768
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.298343    reg_loss: 0.164441    l2_loss: 0.015903    loss: 0.478688
steps 3400    v_Prec: 0.666347  v_Recall: 0.606226  v_F1: 0.634867  v_AUC: 0.883035
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.298761    reg_loss: 0.161717    l2_loss: 0.016340    loss: 0.476817
steps 3600    v_Prec: 0.656374  v_Recall: 0.643219  v_F1: 0.649730  v_AUC: 0.886538
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.297447    reg_loss: 0.158115    l2_loss: 0.016732    loss: 0.472294
steps 3800    v_Prec: 0.692844  v_Recall: 0.614306  v_F1: 0.651216  v_AUC: 0.889298
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.291137    reg_loss: 0.155329    l2_loss: 0.017206    loss: 0.463672
steps 4000    v_Prec: 0.663358  v_Recall: 0.651061  v_F1: 0.657152  v_AUC: 0.889742
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.292263    reg_loss: 0.152671    l2_loss: 0.017705    loss: 0.462639
steps 4200    v_Prec: 0.670412  v_Recall: 0.642744  v_F1: 0.656287  v_AUC: 0.889376
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.289326    reg_loss: 0.149944    l2_loss: 0.018243    loss: 0.457513
steps 4400    v_Prec: 0.655455  v_Recall: 0.651458  v_F1: 0.653450  v_AUC: 0.890005
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.287936    reg_loss: 0.147060    l2_loss: 0.018674    loss: 0.453670
steps 4600    v_Prec: 0.659554  v_Recall: 0.656210  v_F1: 0.657878  v_AUC: 0.890672
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.286573    reg_loss: 0.143254    l2_loss: 0.019194    loss: 0.449021
steps 4800    v_Prec: 0.680882  v_Recall: 0.638704  v_F1: 0.659119  v_AUC: 0.891224
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.287310    reg_loss: 0.142020    l2_loss: 0.019843    loss: 0.449173
steps 5000    v_Prec: 0.668437  v_Recall: 0.658112  v_F1: 0.663234  v_AUC: 0.892557
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.289828    reg_loss: 0.139184    l2_loss: 0.020416    loss: 0.449427
steps 5200    v_Prec: 0.665332  v_Recall: 0.658270  v_F1: 0.661782  v_AUC: 0.892639
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.277161    reg_loss: 0.135614    l2_loss: 0.021059    loss: 0.433834
steps 5400    v_Prec: 0.678566  v_Recall: 0.661042  v_F1: 0.669689  v_AUC: 0.894589
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.191489    reg_loss: 0.131317    l2_loss: 0.021582    loss: 0.344388
steps 5600    v_Prec: 0.669681  v_Recall: 0.657003  v_F1: 0.663281  v_AUC: 0.891383
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.193623    reg_loss: 0.132042    l2_loss: 0.022205    loss: 0.347870
steps 5800    v_Prec: 0.681063  v_Recall: 0.655814  v_F1: 0.668200  v_AUC: 0.893535
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.197871    reg_loss: 0.131880    l2_loss: 0.022734    loss: 0.352485
steps 6000    v_Prec: 0.677253  v_Recall: 0.655418  v_F1: 0.666157  v_AUC: 0.892927
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.194461    reg_loss: 0.130389    l2_loss: 0.023317    loss: 0.348167
steps 6200    v_Prec: 0.676240  v_Recall: 0.663973  v_F1: 0.670051  v_AUC: 0.892990
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.197226    reg_loss: 0.130212    l2_loss: 0.023974    loss: 0.351412
steps 6400    v_Prec: 0.703858  v_Recall: 0.641635  v_F1: 0.671308  v_AUC: 0.893811
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.198533    reg_loss: 0.128480    l2_loss: 0.024443    loss: 0.351456
steps 6600    v_Prec: 0.686856  v_Recall: 0.660250  v_F1: 0.673291  v_AUC: 0.895151
steps 6600    running time 255 seconds

steps 6800    base_loss: 0.189431    reg_loss: 0.127327    l2_loss: 0.024883    loss: 0.341640
steps 6800    v_Prec: 0.679024  v_Recall: 0.665954  v_F1: 0.672426  v_AUC: 0.895549
steps 6800    running time 262 seconds

steps 7000    base_loss: 0.192985    reg_loss: 0.127544    l2_loss: 0.025351    loss: 0.345880
steps 7000    v_Prec: 0.686181  v_Recall: 0.659221  v_F1: 0.672431  v_AUC: 0.893914
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.195795    reg_loss: 0.126246    l2_loss: 0.025789    loss: 0.347830
steps 7200    v_Prec: 0.687204  v_Recall: 0.667063  v_F1: 0.676984  v_AUC: 0.898267
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.203960    reg_loss: 0.124965    l2_loss: 0.026144    loss: 0.355069
steps 7400    v_Prec: 0.699013  v_Recall: 0.656210  v_F1: 0.676936  v_AUC: 0.899338
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.199853    reg_loss: 0.123754    l2_loss: 0.026482    loss: 0.350089
steps 7600    v_Prec: 0.723511  v_Recall: 0.637199  v_F1: 0.677618  v_AUC: 0.900649
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.202888    reg_loss: 0.122925    l2_loss: 0.026794    loss: 0.352607
steps 7800    v_Prec: 0.691987  v_Recall: 0.670390  v_F1: 0.681017  v_AUC: 0.901050
steps 7800    running time 294 seconds

steps 8000    base_loss: 0.210450    reg_loss: 0.122179    l2_loss: 0.027157    loss: 0.359786
steps 8000    v_Prec: 0.697542  v_Recall: 0.667538  v_F1: 0.682210  v_AUC: 0.901968
steps 8000    running time 301 seconds

steps 8200    base_loss: 0.197832    reg_loss: 0.119483    l2_loss: 0.027516    loss: 0.344831
steps 8200    v_Prec: 0.712876  v_Recall: 0.652567  v_F1: 0.681390  v_AUC: 0.901693
steps 8200    running time 308 seconds

steps 8400    base_loss: 0.206263    reg_loss: 0.119369    l2_loss: 0.027894    loss: 0.353527
steps 8400    v_Prec: 0.675445  v_Recall: 0.694867  v_F1: 0.685018  v_AUC: 0.903246
steps 8400    running time 314 seconds

steps 8600    base_loss: 0.193298    reg_loss: 0.117667    l2_loss: 0.028062    loss: 0.339027
steps 8600    v_Prec: 0.685103  v_Recall: 0.681955  v_F1: 0.683525  v_AUC: 0.903910
steps 8600    running time 321 seconds

steps 8800    base_loss: 0.206129    reg_loss: 0.117106    l2_loss: 0.028348    loss: 0.351582
steps 8800    v_Prec: 0.694998  v_Recall: 0.676885  v_F1: 0.685822  v_AUC: 0.903658
steps 8800    running time 327 seconds

steps 9000    base_loss: 0.201699    reg_loss: 0.115452    l2_loss: 0.028554    loss: 0.345705
steps 9000    v_Prec: 0.708399  v_Recall: 0.674113  v_F1: 0.690831  v_AUC: 0.905891
steps 9000    running time 334 seconds

steps 9200    base_loss: 0.209580    reg_loss: 0.115928    l2_loss: 0.028776    loss: 0.354284
steps 9200    v_Prec: 0.708900  v_Recall: 0.680767  v_F1: 0.694549  v_AUC: 0.906639
steps 9200    running time 341 seconds

steps 9400    base_loss: 0.203326    reg_loss: 0.114397    l2_loss: 0.029116    loss: 0.346839
steps 9400    v_Prec: 0.713220  v_Recall: 0.673954  v_F1: 0.693031  v_AUC: 0.905996
steps 9400    running time 347 seconds

steps 9600    base_loss: 0.199521    reg_loss: 0.112952    l2_loss: 0.029298    loss: 0.341772
steps 9600    v_Prec: 0.711362  v_Recall: 0.682906  v_F1: 0.696844  v_AUC: 0.908459
steps 9600    running time 354 seconds

steps 9800    base_loss: 0.198948    reg_loss: 0.112050    l2_loss: 0.029536    loss: 0.340534
steps 9800    v_Prec: 0.717848  v_Recall: 0.679579  v_F1: 0.698189  v_AUC: 0.907956
steps 9800    running time 361 seconds

steps 10000    base_loss: 0.204324    reg_loss: 0.110743    l2_loss: 0.029793    loss: 0.344860
steps 10000    v_Prec: 0.726339  v_Recall: 0.672370  v_F1: 0.698313  v_AUC: 0.909603
steps 10000    running time 367 seconds

steps 10200    base_loss: 0.212021    reg_loss: 0.110093    l2_loss: 0.029862    loss: 0.351976
steps 10200    v_Prec: 0.704258  v_Recall: 0.700966  v_F1: 0.702608  v_AUC: 0.912348
steps 10200    running time 374 seconds

steps 10400    base_loss: 0.206692    reg_loss: 0.108946    l2_loss: 0.029984    loss: 0.345622
steps 10400    v_Prec: 0.714763  v_Recall: 0.694550  v_F1: 0.704512  v_AUC: 0.914033
steps 10400    running time 381 seconds

steps 10600    base_loss: 0.204518    reg_loss: 0.108443    l2_loss: 0.030215    loss: 0.343177
steps 10600    v_Prec: 0.701553  v_Recall: 0.708333  v_F1: 0.704927  v_AUC: 0.914197
steps 10600    running time 388 seconds

steps 10800    base_loss: 0.192213    reg_loss: 0.106444    l2_loss: 0.030405    loss: 0.329062
steps 10800    v_Prec: 0.718216  v_Recall: 0.703026  v_F1: 0.710540  v_AUC: 0.914364
steps 10800    running time 395 seconds

steps 11000    base_loss: 0.090837    reg_loss: 0.100789    l2_loss: 0.030405    loss: 0.222032
steps 11000    v_Prec: 0.733237  v_Recall: 0.682589  v_F1: 0.707007  v_AUC: 0.912914
steps 11000    running time 401 seconds

steps 11200    base_loss: 0.095920    reg_loss: 0.103504    l2_loss: 0.030198    loss: 0.229622
steps 11200    v_Prec: 0.708596  v_Recall: 0.694788  v_F1: 0.701624  v_AUC: 0.909731
steps 11200    running time 408 seconds

steps 11400    base_loss: 0.089390    reg_loss: 0.102640    l2_loss: 0.030089    loss: 0.222119
steps 11400    v_Prec: 0.715054  v_Recall: 0.684411  v_F1: 0.699397  v_AUC: 0.909985
steps 11400    running time 414 seconds

steps 11600    base_loss: 0.097874    reg_loss: 0.103444    l2_loss: 0.030001    loss: 0.231318
steps 11600    v_Prec: 0.711362  v_Recall: 0.682906  v_F1: 0.696844  v_AUC: 0.906666
steps 11600    running time 420 seconds

steps 11800    base_loss: 0.098389    reg_loss: 0.103352    l2_loss: 0.030005    loss: 0.231746
steps 11800    v_Prec: 0.717610  v_Recall: 0.676568  v_F1: 0.696485  v_AUC: 0.907292
steps 11800    running time 427 seconds

steps 12000    base_loss: 0.099738    reg_loss: 0.103934    l2_loss: 0.029969    loss: 0.233642
steps 12000    v_Prec: 0.718856  v_Recall: 0.672845  v_F1: 0.695090  v_AUC: 0.907449
steps 12000    running time 433 seconds

steps 12200    base_loss: 0.093762    reg_loss: 0.103147    l2_loss: 0.030021    loss: 0.226930
steps 12200    v_Prec: 0.720260  v_Recall: 0.667142  v_F1: 0.692684  v_AUC: 0.907532
steps 12200    running time 439 seconds

steps 12400    base_loss: 0.095243    reg_loss: 0.104722    l2_loss: 0.029960    loss: 0.229925
steps 12400    v_Prec: 0.697023  v_Recall: 0.689956  v_F1: 0.693471  v_AUC: 0.908230
steps 12400    running time 445 seconds

steps 12600    base_loss: 0.093454    reg_loss: 0.103322    l2_loss: 0.030048    loss: 0.226824
steps 12600    v_Prec: 0.723351  v_Recall: 0.665478  v_F1: 0.693209  v_AUC: 0.908254
steps 12600    running time 452 seconds

steps 12800    base_loss: 0.099919    reg_loss: 0.103810    l2_loss: 0.030043    loss: 0.233772
steps 12800    v_Prec: 0.722780  v_Recall: 0.667300  v_F1: 0.693933  v_AUC: 0.906765
steps 12800    running time 458 seconds

Early stop model F1: 0.710540
testing thre: 0.35392097
testing Prec: 0.48259793213921653
testing Recall: 0.8053462940461725
testing F1: 0.6035330540885084
testing AUC: 0.8979568667466189
overall running time 461 seconds
(0.7240540693399694, 0.6222114216281895, 0.6692806357172731, 0.8979568667466189, 0.85420716)

2019-02-24 18:05:11.839167: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:05:12.788911: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:05:12.790383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:05:12.790423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.700000 seconds
loading data in 30.830000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.617266    reg_loss: 0.216134    l2_loss: 0.013367    loss: 0.846767
steps 200    v_Prec: 0.162287  v_Recall: 1.000000  v_F1: 0.279255  v_AUC: 0.477062
steps 200    running time 41 seconds

steps 400    base_loss: 0.543356    reg_loss: 0.215340    l2_loss: 0.013354    loss: 0.772051
steps 400    v_Prec: 0.162287  v_Recall: 1.000000  v_F1: 0.279255  v_AUC: 0.484767
steps 400    running time 48 seconds

steps 600    base_loss: 0.515587    reg_loss: 0.213196    l2_loss: 0.013290    loss: 0.742073
steps 600    v_Prec: 0.162291  v_Recall: 1.000000  v_F1: 0.279261  v_AUC: 0.512406
steps 600    running time 54 seconds

steps 800    base_loss: 0.470922    reg_loss: 0.209422    l2_loss: 0.012979    loss: 0.693323
steps 800    v_Prec: 0.178604  v_Recall: 0.760814  v_F1: 0.289295  v_AUC: 0.561255
steps 800    running time 61 seconds

steps 1000    base_loss: 0.460666    reg_loss: 0.203915    l2_loss: 0.012791    loss: 0.677371
steps 1000    v_Prec: 0.215510  v_Recall: 0.533767  v_F1: 0.307048  v_AUC: 0.612177
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.445873    reg_loss: 0.196765    l2_loss: 0.012705    loss: 0.655343
steps 1200    v_Prec: 0.294425  v_Recall: 0.416546  v_F1: 0.344998  v_AUC: 0.656285
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.431631    reg_loss: 0.190536    l2_loss: 0.012618    loss: 0.634785
steps 1400    v_Prec: 0.367711  v_Recall: 0.422817  v_F1: 0.393343  v_AUC: 0.698759
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.412590    reg_loss: 0.185744    l2_loss: 0.012708    loss: 0.611042
steps 1600    v_Prec: 0.417272  v_Recall: 0.471217  v_F1: 0.442607  v_AUC: 0.751969
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.389750    reg_loss: 0.182168    l2_loss: 0.012810    loss: 0.584728
steps 1800    v_Prec: 0.457236  v_Recall: 0.544139  v_F1: 0.496916  v_AUC: 0.795768
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.361698    reg_loss: 0.178290    l2_loss: 0.013057    loss: 0.553045
steps 2000    v_Prec: 0.526509  v_Recall: 0.529346  v_F1: 0.527924  v_AUC: 0.820056
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.345007    reg_loss: 0.175232    l2_loss: 0.013379    loss: 0.533618
steps 2200    v_Prec: 0.556338  v_Recall: 0.565284  v_F1: 0.560775  v_AUC: 0.841383
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.337775    reg_loss: 0.172518    l2_loss: 0.013710    loss: 0.524002
steps 2400    v_Prec: 0.573141  v_Recall: 0.595675  v_F1: 0.584191  v_AUC: 0.853894
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.321343    reg_loss: 0.168703    l2_loss: 0.014038    loss: 0.504083
steps 2600    v_Prec: 0.608822  v_Recall: 0.591494  v_F1: 0.600033  v_AUC: 0.862888
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.303279    reg_loss: 0.164866    l2_loss: 0.014397    loss: 0.482543
steps 2800    v_Prec: 0.610424  v_Recall: 0.595112  v_F1: 0.602671  v_AUC: 0.867512
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.304726    reg_loss: 0.162520    l2_loss: 0.014784    loss: 0.482029
steps 3000    v_Prec: 0.638278  v_Recall: 0.599534  v_F1: 0.618299  v_AUC: 0.874519
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.299519    reg_loss: 0.160006    l2_loss: 0.015192    loss: 0.474718
steps 3200    v_Prec: 0.645180  v_Recall: 0.610790  v_F1: 0.627514  v_AUC: 0.878981
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.307000    reg_loss: 0.157958    l2_loss: 0.015669    loss: 0.480627
steps 3400    v_Prec: 0.632359  v_Recall: 0.624377  v_F1: 0.628343  v_AUC: 0.881319
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.298555    reg_loss: 0.155119    l2_loss: 0.016108    loss: 0.469783
steps 3600    v_Prec: 0.651768  v_Recall: 0.623734  v_F1: 0.637443  v_AUC: 0.885717
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.291088    reg_loss: 0.151657    l2_loss: 0.016587    loss: 0.459332
steps 3800    v_Prec: 0.626744  v_Recall: 0.650024  v_F1: 0.638172  v_AUC: 0.888817
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.284599    reg_loss: 0.148609    l2_loss: 0.017006    loss: 0.450213
steps 4000    v_Prec: 0.636623  v_Recall: 0.646808  v_F1: 0.641675  v_AUC: 0.890099
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.286521    reg_loss: 0.146186    l2_loss: 0.017550    loss: 0.450257
steps 4200    v_Prec: 0.637453  v_Recall: 0.658466  v_F1: 0.647789  v_AUC: 0.891428
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.286461    reg_loss: 0.143784    l2_loss: 0.018055    loss: 0.448299
steps 4400    v_Prec: 0.641377  v_Recall: 0.651793  v_F1: 0.646543  v_AUC: 0.892399
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.288985    reg_loss: 0.140826    l2_loss: 0.018586    loss: 0.448397
steps 4600    v_Prec: 0.635840  v_Recall: 0.674385  v_F1: 0.654545  v_AUC: 0.894633
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.285520    reg_loss: 0.138163    l2_loss: 0.019143    loss: 0.442826
steps 4800    v_Prec: 0.650278  v_Recall: 0.657180  v_F1: 0.653711  v_AUC: 0.894981
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.289086    reg_loss: 0.136050    l2_loss: 0.019778    loss: 0.444914
steps 5000    v_Prec: 0.681995  v_Recall: 0.634346  v_F1: 0.657308  v_AUC: 0.897968
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.286520    reg_loss: 0.133765    l2_loss: 0.020390    loss: 0.440675
steps 5200    v_Prec: 0.650250  v_Recall: 0.669802  v_F1: 0.659881  v_AUC: 0.898695
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.279674    reg_loss: 0.130998    l2_loss: 0.021050    loss: 0.431722
steps 5400    v_Prec: 0.680737  v_Recall: 0.641823  v_F1: 0.660708  v_AUC: 0.900253
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.204241    reg_loss: 0.125868    l2_loss: 0.021577    loss: 0.351687
steps 5600    v_Prec: 0.640417  v_Recall: 0.681299  v_F1: 0.660226  v_AUC: 0.898889
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.201000    reg_loss: 0.125565    l2_loss: 0.022318    loss: 0.348884
steps 5800    v_Prec: 0.660823  v_Recall: 0.663692  v_F1: 0.662254  v_AUC: 0.896272
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.194462    reg_loss: 0.124228    l2_loss: 0.022870    loss: 0.341561
steps 6000    v_Prec: 0.661869  v_Recall: 0.665541  v_F1: 0.663700  v_AUC: 0.897576
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.207209    reg_loss: 0.124692    l2_loss: 0.023451    loss: 0.355353
steps 6200    v_Prec: 0.674611  v_Recall: 0.662245  v_F1: 0.668371  v_AUC: 0.898460
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.200777    reg_loss: 0.123054    l2_loss: 0.023899    loss: 0.347730
steps 6400    v_Prec: 0.675037  v_Recall: 0.663531  v_F1: 0.669235  v_AUC: 0.899662
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.205513    reg_loss: 0.122473    l2_loss: 0.024411    loss: 0.352397
steps 6600    v_Prec: 0.683969  v_Recall: 0.657903  v_F1: 0.670683  v_AUC: 0.898301
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.202609    reg_loss: 0.121494    l2_loss: 0.024899    loss: 0.349001
steps 6800    v_Prec: 0.672914  v_Recall: 0.675511  v_F1: 0.674210  v_AUC: 0.901875
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.200683    reg_loss: 0.120534    l2_loss: 0.025332    loss: 0.346549
steps 7000    v_Prec: 0.682529  v_Recall: 0.663049  v_F1: 0.672648  v_AUC: 0.900506
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.201026    reg_loss: 0.119929    l2_loss: 0.025723    loss: 0.346678
steps 7200    v_Prec: 0.669279  v_Recall: 0.672777  v_F1: 0.671024  v_AUC: 0.901476
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.203000    reg_loss: 0.119855    l2_loss: 0.025955    loss: 0.348810
steps 7400    v_Prec: 0.686210  v_Recall: 0.670928  v_F1: 0.678483  v_AUC: 0.903352
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.213345    reg_loss: 0.117167    l2_loss: 0.026443    loss: 0.356955
steps 7600    v_Prec: 0.672078  v_Recall: 0.679048  v_F1: 0.675545  v_AUC: 0.905218
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.206653    reg_loss: 0.115436    l2_loss: 0.026740    loss: 0.348829
steps 7800    v_Prec: 0.680459  v_Recall: 0.676958  v_F1: 0.678704  v_AUC: 0.905824
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.210506    reg_loss: 0.114949    l2_loss: 0.027066    loss: 0.352521
steps 8000    v_Prec: 0.681720  v_Recall: 0.683309  v_F1: 0.682514  v_AUC: 0.906607
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.207283    reg_loss: 0.114049    l2_loss: 0.027336    loss: 0.348668
steps 8200    v_Prec: 0.684617  v_Recall: 0.684837  v_F1: 0.684727  v_AUC: 0.908081
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.202677    reg_loss: 0.112663    l2_loss: 0.027541    loss: 0.342881
steps 8400    v_Prec: 0.674495  v_Recall: 0.695047  v_F1: 0.684617  v_AUC: 0.906908
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.205853    reg_loss: 0.111997    l2_loss: 0.027879    loss: 0.345729
steps 8600    v_Prec: 0.697313  v_Recall: 0.682344  v_F1: 0.689748  v_AUC: 0.909332
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.207673    reg_loss: 0.111189    l2_loss: 0.028127    loss: 0.346989
steps 8800    v_Prec: 0.686771  v_Recall: 0.695771  v_F1: 0.691242  v_AUC: 0.910891
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.206565    reg_loss: 0.110005    l2_loss: 0.028373    loss: 0.344943
steps 9000    v_Prec: 0.683280  v_Recall: 0.705419  v_F1: 0.694173  v_AUC: 0.911253
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.209813    reg_loss: 0.108709    l2_loss: 0.028513    loss: 0.347036
steps 9200    v_Prec: 0.704445  v_Recall: 0.679128  v_F1: 0.691555  v_AUC: 0.911808
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.210415    reg_loss: 0.109570    l2_loss: 0.028779    loss: 0.348764
steps 9400    v_Prec: 0.694707  v_Recall: 0.698505  v_F1: 0.696600  v_AUC: 0.913620
steps 9400    running time 346 seconds

steps 9600    base_loss: 0.207841    reg_loss: 0.107735    l2_loss: 0.028945    loss: 0.344520
steps 9600    v_Prec: 0.714093  v_Recall: 0.681138  v_F1: 0.697227  v_AUC: 0.914594
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.204276    reg_loss: 0.106938    l2_loss: 0.029246    loss: 0.340461
steps 9800    v_Prec: 0.705505  v_Recall: 0.698585  v_F1: 0.702028  v_AUC: 0.916258
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.213775    reg_loss: 0.106066    l2_loss: 0.029492    loss: 0.349333
steps 10000    v_Prec: 0.715553  v_Recall: 0.693922  v_F1: 0.704571  v_AUC: 0.917409
steps 10000    running time 366 seconds

steps 10200    base_loss: 0.199030    reg_loss: 0.105109    l2_loss: 0.029620    loss: 0.333759
steps 10200    v_Prec: 0.692678  v_Recall: 0.716514  v_F1: 0.704395  v_AUC: 0.916941
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.204969    reg_loss: 0.104718    l2_loss: 0.029708    loss: 0.339395
steps 10400    v_Prec: 0.703983  v_Recall: 0.706303  v_F1: 0.705141  v_AUC: 0.917796
steps 10400    running time 379 seconds

steps 10600    base_loss: 0.206236    reg_loss: 0.103935    l2_loss: 0.029977    loss: 0.340148
steps 10600    v_Prec: 0.723916  v_Recall: 0.687249  v_F1: 0.705106  v_AUC: 0.918145
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.188578    reg_loss: 0.101391    l2_loss: 0.030131    loss: 0.320100
steps 10800    v_Prec: 0.704344  v_Recall: 0.710404  v_F1: 0.707361  v_AUC: 0.917654
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.099782    reg_loss: 0.097637    l2_loss: 0.030112    loss: 0.227532
steps 11000    v_Prec: 0.727327  v_Recall: 0.688616  v_F1: 0.707442  v_AUC: 0.914323
steps 11000    running time 398 seconds

steps 11200    base_loss: 0.093080    reg_loss: 0.098278    l2_loss: 0.029912    loss: 0.221270
steps 11200    v_Prec: 0.706074  v_Recall: 0.695289  v_F1: 0.700640  v_AUC: 0.913566
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.096334    reg_loss: 0.098831    l2_loss: 0.029860    loss: 0.225025
steps 11400    v_Prec: 0.704581  v_Recall: 0.688776  v_F1: 0.696589  v_AUC: 0.911570
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.097764    reg_loss: 0.100602    l2_loss: 0.029771    loss: 0.228137
steps 11600    v_Prec: 0.720515  v_Recall: 0.678807  v_F1: 0.699040  v_AUC: 0.911921
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.088609    reg_loss: 0.101057    l2_loss: 0.029816    loss: 0.219482
steps 11800    v_Prec: 0.712498  v_Recall: 0.677440  v_F1: 0.694527  v_AUC: 0.911462
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.093753    reg_loss: 0.099800    l2_loss: 0.029729    loss: 0.223282
steps 12000    v_Prec: 0.713890  v_Recall: 0.683872  v_F1: 0.698559  v_AUC: 0.912463
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.100318    reg_loss: 0.101476    l2_loss: 0.029791    loss: 0.231584
steps 12200    v_Prec: 0.684549  v_Recall: 0.702766  v_F1: 0.693538  v_AUC: 0.911287
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.099706    reg_loss: 0.100720    l2_loss: 0.029674    loss: 0.230100
steps 12400    v_Prec: 0.713324  v_Recall: 0.672777  v_F1: 0.692457  v_AUC: 0.908464
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.099469    reg_loss: 0.101396    l2_loss: 0.029781    loss: 0.230646
steps 12600    v_Prec: 0.718790  v_Recall: 0.670767  v_F1: 0.693949  v_AUC: 0.908891
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.104010    reg_loss: 0.101086    l2_loss: 0.029680    loss: 0.234776
steps 12800    v_Prec: 0.700758  v_Recall: 0.683631  v_F1: 0.692089  v_AUC: 0.909346
steps 12800    running time 455 seconds

steps 13000    base_loss: 0.102843    reg_loss: 0.100566    l2_loss: 0.029724    loss: 0.233133
steps 13000    v_Prec: 0.692357  v_Recall: 0.690465  v_F1: 0.691410  v_AUC: 0.908861
steps 13000    running time 461 seconds

Early stop model F1: 0.707442
testing thre: 0.46628764
testing Prec: 0.49421106867915376
testing Recall: 0.7925151883353584
testing F1: 0.6087849315835652
testing AUC: 0.8975405922998447
overall running time 464 seconds
(0.7032002568768062, 0.6386391251518834, 0.6693665469549935, 0.8975405922998447, 0.91533613)

2019-02-24 18:10:12.279012: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:10:12.864178: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:10:12.873039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:10:12.873097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.080000 seconds
loading data in 30.130000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.567292    reg_loss: 0.216195    l2_loss: 0.013290    loss: 0.796777
steps 200    v_Prec: 0.162733  v_Recall: 1.000000  v_F1: 0.279914  v_AUC: 0.480806
steps 200    running time 40 seconds

steps 400    base_loss: 0.508201    reg_loss: 0.216011    l2_loss: 0.013254    loss: 0.737466
steps 400    v_Prec: 0.162781  v_Recall: 0.998637  v_F1: 0.279932  v_AUC: 0.514656
steps 400    running time 47 seconds

steps 600    base_loss: 0.488883    reg_loss: 0.215967    l2_loss: 0.013115    loss: 0.717964
steps 600    v_Prec: 0.183904  v_Recall: 0.720414  v_F1: 0.293010  v_AUC: 0.581656
steps 600    running time 53 seconds

steps 800    base_loss: 0.451230    reg_loss: 0.214524    l2_loss: 0.013011    loss: 0.678765
steps 800    v_Prec: 0.276885  v_Recall: 0.480997  v_F1: 0.351456  v_AUC: 0.667398
steps 800    running time 60 seconds

steps 1000    base_loss: 0.422306    reg_loss: 0.214138    l2_loss: 0.012996    loss: 0.649440
steps 1000    v_Prec: 0.365666  v_Recall: 0.472739  v_F1: 0.412365  v_AUC: 0.729812
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.402685    reg_loss: 0.213650    l2_loss: 0.012954    loss: 0.629289
steps 1200    v_Prec: 0.447732  v_Recall: 0.480436  v_F1: 0.463508  v_AUC: 0.772010
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.380051    reg_loss: 0.214341    l2_loss: 0.012998    loss: 0.607389
steps 1400    v_Prec: 0.516980  v_Recall: 0.507777  v_F1: 0.512337  v_AUC: 0.803711
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.358957    reg_loss: 0.213491    l2_loss: 0.013085    loss: 0.585534
steps 1600    v_Prec: 0.540936  v_Recall: 0.541934  v_F1: 0.541435  v_AUC: 0.822782
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.343144    reg_loss: 0.213748    l2_loss: 0.013189    loss: 0.570082
steps 1800    v_Prec: 0.589971  v_Recall: 0.549952  v_F1: 0.569259  v_AUC: 0.838314
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.330403    reg_loss: 0.213235    l2_loss: 0.013419    loss: 0.557057
steps 2000    v_Prec: 0.615547  v_Recall: 0.559974  v_F1: 0.586447  v_AUC: 0.848104
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.318851    reg_loss: 0.213347    l2_loss: 0.013539    loss: 0.545738
steps 2200    v_Prec: 0.626647  v_Recall: 0.575850  v_F1: 0.600175  v_AUC: 0.855526
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.312119    reg_loss: 0.213509    l2_loss: 0.013768    loss: 0.539395
steps 2400    v_Prec: 0.642055  v_Recall: 0.587075  v_F1: 0.613336  v_AUC: 0.861672
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.310699    reg_loss: 0.213313    l2_loss: 0.013971    loss: 0.537983
steps 2600    v_Prec: 0.650121  v_Recall: 0.601748  v_F1: 0.625000  v_AUC: 0.868424
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.301084    reg_loss: 0.213089    l2_loss: 0.014198    loss: 0.528371
steps 2800    v_Prec: 0.656374  v_Recall: 0.610167  v_F1: 0.632427  v_AUC: 0.874911
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.301587    reg_loss: 0.213146    l2_loss: 0.014458    loss: 0.529191
steps 3000    v_Prec: 0.663300  v_Recall: 0.616020  v_F1: 0.638786  v_AUC: 0.879089
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.293733    reg_loss: 0.211900    l2_loss: 0.014801    loss: 0.520433
steps 3200    v_Prec: 0.654949  v_Recall: 0.639352  v_F1: 0.647056  v_AUC: 0.884601
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.288932    reg_loss: 0.210849    l2_loss: 0.015110    loss: 0.514891
steps 3400    v_Prec: 0.685943  v_Recall: 0.611530  v_F1: 0.646603  v_AUC: 0.888004
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.280627    reg_loss: 0.210768    l2_loss: 0.015407    loss: 0.506802
steps 3600    v_Prec: 0.676138  v_Recall: 0.627726  v_F1: 0.651033  v_AUC: 0.889242
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.282432    reg_loss: 0.209454    l2_loss: 0.015834    loss: 0.507719
steps 3800    v_Prec: 0.640735  v_Recall: 0.662364  v_F1: 0.651370  v_AUC: 0.891751
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.286918    reg_loss: 0.209045    l2_loss: 0.016268    loss: 0.512231
steps 4000    v_Prec: 0.660423  v_Recall: 0.650257  v_F1: 0.655301  v_AUC: 0.894345
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.280920    reg_loss: 0.207091    l2_loss: 0.016663    loss: 0.504674
steps 4200    v_Prec: 0.682834  v_Recall: 0.629891  v_F1: 0.655295  v_AUC: 0.895744
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.279422    reg_loss: 0.206065    l2_loss: 0.017193    loss: 0.502680
steps 4400    v_Prec: 0.637658  v_Recall: 0.667976  v_F1: 0.652465  v_AUC: 0.894747
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.270654    reg_loss: 0.203815    l2_loss: 0.017668    loss: 0.492137
steps 4600    v_Prec: 0.683273  v_Recall: 0.636706  v_F1: 0.659168  v_AUC: 0.894867
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.270369    reg_loss: 0.202670    l2_loss: 0.018264    loss: 0.491303
steps 4800    v_Prec: 0.680655  v_Recall: 0.639833  v_F1: 0.659613  v_AUC: 0.897725
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.267457    reg_loss: 0.201499    l2_loss: 0.018799    loss: 0.487755
steps 5000    v_Prec: 0.677966  v_Recall: 0.644644  v_F1: 0.660885  v_AUC: 0.898299
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.273692    reg_loss: 0.200812    l2_loss: 0.019432    loss: 0.493937
steps 5200    v_Prec: 0.652249  v_Recall: 0.669820  v_F1: 0.660918  v_AUC: 0.899574
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.270984    reg_loss: 0.199583    l2_loss: 0.020070    loss: 0.490637
steps 5400    v_Prec: 0.658951  v_Recall: 0.668778  v_F1: 0.663828  v_AUC: 0.899285
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.193548    reg_loss: 0.195698    l2_loss: 0.020969    loss: 0.410215
steps 5600    v_Prec: 0.660622  v_Recall: 0.648493  v_F1: 0.654501  v_AUC: 0.893032
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.191694    reg_loss: 0.193131    l2_loss: 0.021807    loss: 0.406632
steps 5800    v_Prec: 0.658809  v_Recall: 0.643121  v_F1: 0.650870  v_AUC: 0.891712
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.198047    reg_loss: 0.192753    l2_loss: 0.022464    loss: 0.413263
steps 6000    v_Prec: 0.675279  v_Recall: 0.626604  v_F1: 0.650031  v_AUC: 0.892709
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.202262    reg_loss: 0.192846    l2_loss: 0.023189    loss: 0.418297
steps 6200    v_Prec: 0.662536  v_Recall: 0.638791  v_F1: 0.650447  v_AUC: 0.892812
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.200069    reg_loss: 0.192768    l2_loss: 0.023794    loss: 0.416630
steps 6400    v_Prec: 0.651190  v_Recall: 0.660119  v_F1: 0.655624  v_AUC: 0.894978
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.203503    reg_loss: 0.192080    l2_loss: 0.024328    loss: 0.419911
steps 6600    v_Prec: 0.672207  v_Recall: 0.642078  v_F1: 0.656797  v_AUC: 0.893973
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.206480    reg_loss: 0.191283    l2_loss: 0.024869    loss: 0.422633
steps 6800    v_Prec: 0.667863  v_Recall: 0.656350  v_F1: 0.662057  v_AUC: 0.896557
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.200248    reg_loss: 0.189828    l2_loss: 0.025299    loss: 0.415374
steps 7000    v_Prec: 0.680549  v_Recall: 0.644644  v_F1: 0.662110  v_AUC: 0.895957
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.206359    reg_loss: 0.188051    l2_loss: 0.025867    loss: 0.420277
steps 7200    v_Prec: 0.664546  v_Recall: 0.661722  v_F1: 0.663131  v_AUC: 0.899186
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.203485    reg_loss: 0.188707    l2_loss: 0.026480    loss: 0.418671
steps 7400    v_Prec: 0.669234  v_Recall: 0.668698  v_F1: 0.668966  v_AUC: 0.899258
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.205745    reg_loss: 0.186869    l2_loss: 0.026786    loss: 0.419400
steps 7600    v_Prec: 0.662280  v_Recall: 0.686017  v_F1: 0.673940  v_AUC: 0.902321
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.204891    reg_loss: 0.187166    l2_loss: 0.027093    loss: 0.419150
steps 7800    v_Prec: 0.693474  v_Recall: 0.674792  v_F1: 0.684005  v_AUC: 0.904340
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.207047    reg_loss: 0.186771    l2_loss: 0.027531    loss: 0.421349
steps 8000    v_Prec: 0.709060  v_Recall: 0.665170  v_F1: 0.686414  v_AUC: 0.907835
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.199391    reg_loss: 0.186357    l2_loss: 0.027999    loss: 0.413748
steps 8200    v_Prec: 0.713782  v_Recall: 0.665651  v_F1: 0.688877  v_AUC: 0.907357
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.200253    reg_loss: 0.184818    l2_loss: 0.028294    loss: 0.413365
steps 8400    v_Prec: 0.725991  v_Recall: 0.656430  v_F1: 0.689461  v_AUC: 0.910506
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.209161    reg_loss: 0.183717    l2_loss: 0.028634    loss: 0.421512
steps 8600    v_Prec: 0.693568  v_Recall: 0.692511  v_F1: 0.693039  v_AUC: 0.912207
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.195438    reg_loss: 0.182096    l2_loss: 0.028893    loss: 0.406427
steps 8800    v_Prec: 0.713889  v_Recall: 0.680404  v_F1: 0.696745  v_AUC: 0.912601
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.209644    reg_loss: 0.183205    l2_loss: 0.029340    loss: 0.422189
steps 9000    v_Prec: 0.721944  v_Recall: 0.682409  v_F1: 0.701620  v_AUC: 0.914474
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.196551    reg_loss: 0.180270    l2_loss: 0.029740    loss: 0.406562
steps 9200    v_Prec: 0.729258  v_Recall: 0.677277  v_F1: 0.702307  v_AUC: 0.916041
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.196959    reg_loss: 0.179569    l2_loss: 0.029900    loss: 0.406427
steps 9400    v_Prec: 0.709753  v_Recall: 0.703095  v_F1: 0.706408  v_AUC: 0.917940
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.193471    reg_loss: 0.178097    l2_loss: 0.030023    loss: 0.401591
steps 9600    v_Prec: 0.735582  v_Recall: 0.687219  v_F1: 0.710579  v_AUC: 0.918591
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.196343    reg_loss: 0.178343    l2_loss: 0.030369    loss: 0.405055
steps 9800    v_Prec: 0.734729  v_Recall: 0.689545  v_F1: 0.711420  v_AUC: 0.918071
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.196038    reg_loss: 0.177191    l2_loss: 0.030735    loss: 0.403964
steps 10000    v_Prec: 0.744532  v_Recall: 0.690507  v_F1: 0.716502  v_AUC: 0.921986
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.193600    reg_loss: 0.175507    l2_loss: 0.030827    loss: 0.399934
steps 10200    v_Prec: 0.758768  v_Recall: 0.681687  v_F1: 0.718165  v_AUC: 0.922296
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.189303    reg_loss: 0.174825    l2_loss: 0.031235    loss: 0.395363
steps 10400    v_Prec: 0.747714  v_Recall: 0.695077  v_F1: 0.720435  v_AUC: 0.925241
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.194197    reg_loss: 0.174097    l2_loss: 0.031448    loss: 0.399742
steps 10600    v_Prec: 0.748174  v_Recall: 0.697963  v_F1: 0.722197  v_AUC: 0.925155
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.181740    reg_loss: 0.173569    l2_loss: 0.031538    loss: 0.386847
steps 10800    v_Prec: 0.759781  v_Recall: 0.689785  v_F1: 0.723093  v_AUC: 0.924792
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.098137    reg_loss: 0.165358    l2_loss: 0.031933    loss: 0.295427
steps 11000    v_Prec: 0.745718  v_Recall: 0.673669  v_F1: 0.707865  v_AUC: 0.916970
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.102269    reg_loss: 0.164388    l2_loss: 0.032000    loss: 0.298657
steps 11200    v_Prec: 0.709426  v_Recall: 0.685536  v_F1: 0.697276  v_AUC: 0.912493
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.106378    reg_loss: 0.164273    l2_loss: 0.032449    loss: 0.303100
steps 11400    v_Prec: 0.707709  v_Recall: 0.688983  v_F1: 0.698221  v_AUC: 0.911000
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.104842    reg_loss: 0.164725    l2_loss: 0.032658    loss: 0.302225
steps 11600    v_Prec: 0.707851  v_Recall: 0.676636  v_F1: 0.691891  v_AUC: 0.908410
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.096736    reg_loss: 0.162427    l2_loss: 0.032901    loss: 0.292064
steps 11800    v_Prec: 0.710883  v_Recall: 0.672466  v_F1: 0.691141  v_AUC: 0.906539
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.107384    reg_loss: 0.161625    l2_loss: 0.033198    loss: 0.302207
steps 12000    v_Prec: 0.736674  v_Recall: 0.646007  v_F1: 0.688368  v_AUC: 0.905387
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.112367    reg_loss: 0.162426    l2_loss: 0.033331    loss: 0.308124
steps 12200    v_Prec: 0.692951  v_Recall: 0.684173  v_F1: 0.688534  v_AUC: 0.906004
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.114125    reg_loss: 0.161798    l2_loss: 0.033572    loss: 0.309494
steps 12400    v_Prec: 0.701817  v_Recall: 0.681446  v_F1: 0.691482  v_AUC: 0.907112
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.107451    reg_loss: 0.160899    l2_loss: 0.033831    loss: 0.302181
steps 12600    v_Prec: 0.707783  v_Recall: 0.670783  v_F1: 0.688786  v_AUC: 0.906373
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.110095    reg_loss: 0.159322    l2_loss: 0.034034    loss: 0.303452
steps 12800    v_Prec: 0.741463  v_Recall: 0.652822  v_F1: 0.694325  v_AUC: 0.908647
steps 12800    running time 451 seconds

Early stop model F1: 0.723093
testing thre: 0.44504297
testing Prec: 0.6237511866552145
testing Recall: 0.6706196840826245
testing F1: 0.6463368933857973
testing AUC: 0.8935938619307909
overall running time 454 seconds
(0.6666155497623064, 0.6338274605103281, 0.6498081618416464, 0.8935938619307909, 0.537503)

2019-02-24 18:15:10.130089: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:15:11.143567: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:15:11.148516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:15:11.148576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.010000 seconds
loading data in 30.220000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.582481    reg_loss: 0.216716    l2_loss: 0.013309    loss: 0.812505
steps 200    v_Prec: 0.162281  v_Recall: 0.999678  v_F1: 0.279233  v_AUC: 0.480675
steps 200    running time 40 seconds

steps 400    base_loss: 0.510825    reg_loss: 0.215428    l2_loss: 0.013208    loss: 0.739462
steps 400    v_Prec: 0.162281  v_Recall: 0.999678  v_F1: 0.279233  v_AUC: 0.511865
steps 400    running time 47 seconds

steps 600    base_loss: 0.496338    reg_loss: 0.214278    l2_loss: 0.013028    loss: 0.723645
steps 600    v_Prec: 0.170214  v_Recall: 0.798729  v_F1: 0.280625  v_AUC: 0.550461
steps 600    running time 53 seconds

steps 800    base_loss: 0.459227    reg_loss: 0.211813    l2_loss: 0.012873    loss: 0.683913
steps 800    v_Prec: 0.246736  v_Recall: 0.472660  v_F1: 0.324223  v_AUC: 0.638217
steps 800    running time 59 seconds

steps 1000    base_loss: 0.437699    reg_loss: 0.209053    l2_loss: 0.012753    loss: 0.659505
steps 1000    v_Prec: 0.350552  v_Recall: 0.428916  v_F1: 0.385795  v_AUC: 0.711481
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.421664    reg_loss: 0.206070    l2_loss: 0.012659    loss: 0.640394
steps 1200    v_Prec: 0.431419  v_Recall: 0.456015  v_F1: 0.443376  v_AUC: 0.756322
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.400453    reg_loss: 0.204983    l2_loss: 0.012651    loss: 0.618087
steps 1400    v_Prec: 0.504222  v_Recall: 0.460920  v_F1: 0.481600  v_AUC: 0.784776
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.368858    reg_loss: 0.203606    l2_loss: 0.012746    loss: 0.585210
steps 1600    v_Prec: 0.528116  v_Recall: 0.505227  v_F1: 0.516418  v_AUC: 0.808767
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.357491    reg_loss: 0.203878    l2_loss: 0.012918    loss: 0.574287
steps 1800    v_Prec: 0.545455  v_Recall: 0.562078  v_F1: 0.553641  v_AUC: 0.828564
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.339065    reg_loss: 0.203525    l2_loss: 0.013136    loss: 0.555726
steps 2000    v_Prec: 0.596458  v_Recall: 0.539000  v_F1: 0.566275  v_AUC: 0.838726
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.329501    reg_loss: 0.205178    l2_loss: 0.013371    loss: 0.548050
steps 2200    v_Prec: 0.609939  v_Recall: 0.562560  v_F1: 0.585292  v_AUC: 0.847961
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.318058    reg_loss: 0.204665    l2_loss: 0.013572    loss: 0.536295
steps 2400    v_Prec: 0.588778  v_Recall: 0.605018  v_F1: 0.596788  v_AUC: 0.856880
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.317009    reg_loss: 0.204644    l2_loss: 0.013913    loss: 0.535567
steps 2600    v_Prec: 0.636404  v_Recall: 0.581698  v_F1: 0.607823  v_AUC: 0.863767
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.298916    reg_loss: 0.204213    l2_loss: 0.014194    loss: 0.517323
steps 2800    v_Prec: 0.620174  v_Recall: 0.617482  v_F1: 0.618825  v_AUC: 0.868518
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.303383    reg_loss: 0.204286    l2_loss: 0.014503    loss: 0.522171
steps 3000    v_Prec: 0.648257  v_Recall: 0.601238  v_F1: 0.623863  v_AUC: 0.872618
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.301355    reg_loss: 0.205584    l2_loss: 0.014840    loss: 0.521779
steps 3200    v_Prec: 0.637581  v_Recall: 0.620457  v_F1: 0.628902  v_AUC: 0.876257
steps 3200    running time 138 seconds

steps 3400    base_loss: 0.295723    reg_loss: 0.203413    l2_loss: 0.015221    loss: 0.514357
steps 3400    v_Prec: 0.651648  v_Recall: 0.628015  v_F1: 0.639613  v_AUC: 0.883677
steps 3400    running time 145 seconds

steps 3600    base_loss: 0.290366    reg_loss: 0.203657    l2_loss: 0.015657    loss: 0.509679
steps 3600    v_Prec: 0.651071  v_Recall: 0.637826  v_F1: 0.644380  v_AUC: 0.887249
steps 3600    running time 151 seconds

steps 3800    base_loss: 0.290869    reg_loss: 0.203329    l2_loss: 0.016083    loss: 0.510280
steps 3800    v_Prec: 0.643187  v_Recall: 0.649807  v_F1: 0.646480  v_AUC: 0.889792
steps 3800    running time 158 seconds

steps 4000    base_loss: 0.288310    reg_loss: 0.202420    l2_loss: 0.016629    loss: 0.507358
steps 4000    v_Prec: 0.640056  v_Recall: 0.661467  v_F1: 0.650585  v_AUC: 0.890840
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.286804    reg_loss: 0.201021    l2_loss: 0.017147    loss: 0.504973
steps 4200    v_Prec: 0.638061  v_Recall: 0.659456  v_F1: 0.648582  v_AUC: 0.891985
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.280181    reg_loss: 0.201174    l2_loss: 0.017667    loss: 0.499022
steps 4400    v_Prec: 0.631038  v_Recall: 0.676504  v_F1: 0.652980  v_AUC: 0.893331
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.279098    reg_loss: 0.199464    l2_loss: 0.018198    loss: 0.496760
steps 4600    v_Prec: 0.634238  v_Recall: 0.678353  v_F1: 0.655554  v_AUC: 0.895577
steps 4600    running time 184 seconds

steps 4800    base_loss: 0.279596    reg_loss: 0.197971    l2_loss: 0.018787    loss: 0.496354
steps 4800    v_Prec: 0.654241  v_Recall: 0.656240  v_F1: 0.655239  v_AUC: 0.896177
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.273624    reg_loss: 0.196497    l2_loss: 0.019486    loss: 0.489607
steps 5000    v_Prec: 0.649909  v_Recall: 0.663236  v_F1: 0.656505  v_AUC: 0.896718
steps 5000    running time 197 seconds

steps 5200    base_loss: 0.276231    reg_loss: 0.195916    l2_loss: 0.020127    loss: 0.492273
steps 5200    v_Prec: 0.652195  v_Recall: 0.649887  v_F1: 0.651039  v_AUC: 0.896841
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.268350    reg_loss: 0.194510    l2_loss: 0.020901    loss: 0.483760
steps 5400    v_Prec: 0.691982  v_Recall: 0.631554  v_F1: 0.660388  v_AUC: 0.899773
steps 5400    running time 210 seconds

steps 5600    base_loss: 0.193988    reg_loss: 0.191294    l2_loss: 0.021775    loss: 0.407058
steps 5600    v_Prec: 0.648566  v_Recall: 0.645384  v_F1: 0.646971  v_AUC: 0.891637
steps 5600    running time 216 seconds

steps 5800    base_loss: 0.191039    reg_loss: 0.189807    l2_loss: 0.022644    loss: 0.403491
steps 5800    v_Prec: 0.637578  v_Recall: 0.656240  v_F1: 0.646774  v_AUC: 0.891391
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.194833    reg_loss: 0.188238    l2_loss: 0.023362    loss: 0.406433
steps 6000    v_Prec: 0.644346  v_Recall: 0.656160  v_F1: 0.650199  v_AUC: 0.892206
steps 6000    running time 229 seconds

steps 6200    base_loss: 0.199213    reg_loss: 0.188343    l2_loss: 0.024088    loss: 0.411645
steps 6200    v_Prec: 0.654934  v_Recall: 0.647877  v_F1: 0.651387  v_AUC: 0.891658
steps 6200    running time 235 seconds

steps 6400    base_loss: 0.204895    reg_loss: 0.186655    l2_loss: 0.024683    loss: 0.416234
steps 6400    v_Prec: 0.675542  v_Recall: 0.636539  v_F1: 0.655461  v_AUC: 0.893706
steps 6400    running time 241 seconds

steps 6600    base_loss: 0.205483    reg_loss: 0.186597    l2_loss: 0.025266    loss: 0.417347
steps 6600    v_Prec: 0.672720  v_Recall: 0.646430  v_F1: 0.659313  v_AUC: 0.896164
steps 6600    running time 247 seconds

steps 6800    base_loss: 0.208527    reg_loss: 0.186520    l2_loss: 0.025772    loss: 0.420819
steps 6800    v_Prec: 0.684197  v_Recall: 0.642329  v_F1: 0.662602  v_AUC: 0.897111
steps 6800    running time 253 seconds

steps 7000    base_loss: 0.204892    reg_loss: 0.185983    l2_loss: 0.026241    loss: 0.417115
steps 7000    v_Prec: 0.657690  v_Recall: 0.673609  v_F1: 0.665554  v_AUC: 0.899157
steps 7000    running time 260 seconds

steps 7200    base_loss: 0.207657    reg_loss: 0.184851    l2_loss: 0.026794    loss: 0.419302
steps 7200    v_Prec: 0.663441  v_Recall: 0.667015  v_F1: 0.665223  v_AUC: 0.899020
steps 7200    running time 266 seconds

steps 7400    base_loss: 0.203867    reg_loss: 0.183297    l2_loss: 0.027291    loss: 0.414455
steps 7400    v_Prec: 0.675147  v_Recall: 0.657285  v_F1: 0.666096  v_AUC: 0.898444
steps 7400    running time 272 seconds

steps 7600    base_loss: 0.197593    reg_loss: 0.182665    l2_loss: 0.027720    loss: 0.407977
steps 7600    v_Prec: 0.671556  v_Recall: 0.666372  v_F1: 0.668954  v_AUC: 0.902108
steps 7600    running time 279 seconds

steps 7800    base_loss: 0.212692    reg_loss: 0.182808    l2_loss: 0.028113    loss: 0.423612
steps 7800    v_Prec: 0.681531  v_Recall: 0.667337  v_F1: 0.674359  v_AUC: 0.905077
steps 7800    running time 286 seconds

steps 8000    base_loss: 0.200534    reg_loss: 0.182063    l2_loss: 0.028403    loss: 0.411000
steps 8000    v_Prec: 0.704184  v_Recall: 0.655034  v_F1: 0.678720  v_AUC: 0.904693
steps 8000    running time 293 seconds

steps 8200    base_loss: 0.205120    reg_loss: 0.180025    l2_loss: 0.028749    loss: 0.413894
steps 8200    v_Prec: 0.735991  v_Recall: 0.636861  v_F1: 0.682847  v_AUC: 0.907167
steps 8200    running time 299 seconds

steps 8400    base_loss: 0.205810    reg_loss: 0.179972    l2_loss: 0.029255    loss: 0.415036
steps 8400    v_Prec: 0.714760  v_Recall: 0.657687  v_F1: 0.685037  v_AUC: 0.906907
steps 8400    running time 306 seconds

steps 8600    base_loss: 0.199521    reg_loss: 0.178430    l2_loss: 0.029524    loss: 0.407475
steps 8600    v_Prec: 0.734052  v_Recall: 0.651415  v_F1: 0.690269  v_AUC: 0.910369
steps 8600    running time 312 seconds

steps 8800    base_loss: 0.203870    reg_loss: 0.177943    l2_loss: 0.029859    loss: 0.411671
steps 8800    v_Prec: 0.739933  v_Recall: 0.657527  v_F1: 0.696300  v_AUC: 0.912142
steps 8800    running time 319 seconds

steps 9000    base_loss: 0.206459    reg_loss: 0.176573    l2_loss: 0.030129    loss: 0.413161
steps 9000    v_Prec: 0.751932  v_Recall: 0.649325  v_F1: 0.696872  v_AUC: 0.912860
steps 9000    running time 326 seconds

steps 9200    base_loss: 0.195653    reg_loss: 0.176282    l2_loss: 0.030440    loss: 0.402375
steps 9200    v_Prec: 0.713502  v_Recall: 0.690495  v_F1: 0.701810  v_AUC: 0.913174
steps 9200    running time 332 seconds

steps 9400    base_loss: 0.201939    reg_loss: 0.174167    l2_loss: 0.030692    loss: 0.406797
steps 9400    v_Prec: 0.737398  v_Recall: 0.674011  v_F1: 0.704281  v_AUC: 0.914624
steps 9400    running time 339 seconds

steps 9600    base_loss: 0.200470    reg_loss: 0.174140    l2_loss: 0.030947    loss: 0.405557
steps 9600    v_Prec: 0.722385  v_Recall: 0.692586  v_F1: 0.707172  v_AUC: 0.916164
steps 9600    running time 345 seconds

steps 9800    base_loss: 0.199154    reg_loss: 0.173486    l2_loss: 0.031257    loss: 0.403897
steps 9800    v_Prec: 0.747531  v_Recall: 0.675700  v_F1: 0.709803  v_AUC: 0.916650
steps 9800    running time 352 seconds

steps 10000    base_loss: 0.196638    reg_loss: 0.171945    l2_loss: 0.031398    loss: 0.399981
steps 10000    v_Prec: 0.727257  v_Recall: 0.698134  v_F1: 0.712398  v_AUC: 0.919183
steps 10000    running time 359 seconds

steps 10200    base_loss: 0.202092    reg_loss: 0.172203    l2_loss: 0.031683    loss: 0.405979
steps 10200    v_Prec: 0.744184  v_Recall: 0.691943  v_F1: 0.717113  v_AUC: 0.920428
steps 10200    running time 365 seconds

steps 10400    base_loss: 0.198048    reg_loss: 0.171304    l2_loss: 0.031876    loss: 0.401228
steps 10400    v_Prec: 0.747894  v_Recall: 0.692506  v_F1: 0.719135  v_AUC: 0.921736
steps 10400    running time 372 seconds

steps 10600    base_loss: 0.201439    reg_loss: 0.171279    l2_loss: 0.032100    loss: 0.404818
steps 10600    v_Prec: 0.748302  v_Recall: 0.699743  v_F1: 0.723208  v_AUC: 0.922892
steps 10600    running time 379 seconds

steps 10800    base_loss: 0.181290    reg_loss: 0.168014    l2_loss: 0.032304    loss: 0.381607
steps 10800    v_Prec: 0.767342  v_Recall: 0.688485  v_F1: 0.725778  v_AUC: 0.923736
steps 10800    running time 385 seconds

steps 11000    base_loss: 0.104235    reg_loss: 0.163184    l2_loss: 0.032679    loss: 0.300098
steps 11000    v_Prec: 0.764110  v_Recall: 0.660823  v_F1: 0.708723  v_AUC: 0.915325
steps 11000    running time 392 seconds

steps 11200    base_loss: 0.102017    reg_loss: 0.161172    l2_loss: 0.032947    loss: 0.296137
steps 11200    v_Prec: 0.741594  v_Recall: 0.659778  v_F1: 0.698298  v_AUC: 0.910340
steps 11200    running time 398 seconds

steps 11400    base_loss: 0.102270    reg_loss: 0.159900    l2_loss: 0.033366    loss: 0.295536
steps 11400    v_Prec: 0.725931  v_Recall: 0.672403  v_F1: 0.698142  v_AUC: 0.909437
steps 11400    running time 404 seconds

steps 11600    base_loss: 0.108733    reg_loss: 0.158760    l2_loss: 0.033631    loss: 0.301124
steps 11600    v_Prec: 0.725471  v_Recall: 0.662351  v_F1: 0.692476  v_AUC: 0.907506
steps 11600    running time 410 seconds

steps 11800    base_loss: 0.104422    reg_loss: 0.159693    l2_loss: 0.033724    loss: 0.297838
steps 11800    v_Prec: 0.725407  v_Recall: 0.662351  v_F1: 0.692447  v_AUC: 0.905364
steps 11800    running time 417 seconds

steps 12000    base_loss: 0.110111    reg_loss: 0.157722    l2_loss: 0.033954    loss: 0.301787
steps 12000    v_Prec: 0.734326  v_Recall: 0.658331  v_F1: 0.694255  v_AUC: 0.906508
steps 12000    running time 423 seconds

steps 12200    base_loss: 0.106567    reg_loss: 0.158415    l2_loss: 0.034300    loss: 0.299283
steps 12200    v_Prec: 0.741278  v_Recall: 0.649244  v_F1: 0.692215  v_AUC: 0.905075
steps 12200    running time 429 seconds

steps 12400    base_loss: 0.113043    reg_loss: 0.157443    l2_loss: 0.034306    loss: 0.304792
steps 12400    v_Prec: 0.716487  v_Recall: 0.680363  v_F1: 0.697958  v_AUC: 0.907643
steps 12400    running time 435 seconds

steps 12600    base_loss: 0.112616    reg_loss: 0.156992    l2_loss: 0.034497    loss: 0.304106
steps 12600    v_Prec: 0.719563  v_Recall: 0.682937  v_F1: 0.700771  v_AUC: 0.909127
steps 12600    running time 441 seconds

steps 12800    base_loss: 0.112775    reg_loss: 0.156951    l2_loss: 0.034698    loss: 0.304424
steps 12800    v_Prec: 0.743543  v_Recall: 0.662110  v_F1: 0.700468  v_AUC: 0.908474
steps 12800    running time 448 seconds

Early stop model F1: 0.725778
testing thre: 0.47567788
testing Prec: 0.6184688523119702
testing Recall: 0.6702308626974484
testing F1: 0.6433103190893823
testing AUC: 0.8937838275258521
overall running time 450 seconds
(0.7100399315459213, 0.6049574726609963, 0.653300091851463, 0.8937838275258521, 0.64501655)

2019-02-24 18:20:06.444923: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:20:07.361803: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:20:07.364385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:20:07.364423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.350000 seconds
loading data in 30.440000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.870381    reg_loss: 0.216119    l2_loss: 0.013387    loss: 1.099887
steps 200    v_Prec: 0.164044  v_Recall: 1.000000  v_F1: 0.281852  v_AUC: 0.505876
steps 200    running time 40 seconds

steps 400    base_loss: 0.621022    reg_loss: 0.215472    l2_loss: 0.013493    loss: 0.849987
steps 400    v_Prec: 0.165559  v_Recall: 0.966828  v_F1: 0.282707  v_AUC: 0.526850
steps 400    running time 47 seconds

steps 600    base_loss: 0.503531    reg_loss: 0.213356    l2_loss: 0.013486    loss: 0.730372
steps 600    v_Prec: 0.166022  v_Recall: 0.959351  v_F1: 0.283059  v_AUC: 0.541796
steps 600    running time 53 seconds

steps 800    base_loss: 0.484394    reg_loss: 0.210542    l2_loss: 0.013341    loss: 0.708277
steps 800    v_Prec: 0.179512  v_Recall: 0.749105  v_F1: 0.289620  v_AUC: 0.568216
steps 800    running time 60 seconds

steps 1000    base_loss: 0.472258    reg_loss: 0.207362    l2_loss: 0.013068    loss: 0.692689
steps 1000    v_Prec: 0.210981  v_Recall: 0.608305  v_F1: 0.313299  v_AUC: 0.617475
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.458304    reg_loss: 0.203289    l2_loss: 0.012849    loss: 0.674443
steps 1200    v_Prec: 0.257822  v_Recall: 0.507358  v_F1: 0.341901  v_AUC: 0.654489
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.439243    reg_loss: 0.198032    l2_loss: 0.012742    loss: 0.650017
steps 1400    v_Prec: 0.412517  v_Recall: 0.392729  v_F1: 0.402380  v_AUC: 0.709830
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.410133    reg_loss: 0.192463    l2_loss: 0.012846    loss: 0.615441
steps 1600    v_Prec: 0.464504  v_Recall: 0.477289  v_F1: 0.470810  v_AUC: 0.759715
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.379305    reg_loss: 0.187202    l2_loss: 0.013000    loss: 0.579507
steps 1800    v_Prec: 0.560247  v_Recall: 0.490812  v_F1: 0.523236  v_AUC: 0.794346
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.353357    reg_loss: 0.184304    l2_loss: 0.013204    loss: 0.550865
steps 2000    v_Prec: 0.623878  v_Recall: 0.502983  v_F1: 0.556945  v_AUC: 0.815842
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.334918    reg_loss: 0.180519    l2_loss: 0.013443    loss: 0.528880
steps 2200    v_Prec: 0.606762  v_Recall: 0.552462  v_F1: 0.578340  v_AUC: 0.832924
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.318481    reg_loss: 0.176631    l2_loss: 0.013709    loss: 0.508821
steps 2400    v_Prec: 0.641460  v_Recall: 0.560735  v_F1: 0.598387  v_AUC: 0.843970
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.311921    reg_loss: 0.174085    l2_loss: 0.013982    loss: 0.499988
steps 2600    v_Prec: 0.650032  v_Recall: 0.572985  v_F1: 0.609082  v_AUC: 0.853919
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.304159    reg_loss: 0.171269    l2_loss: 0.014271    loss: 0.489699
steps 2800    v_Prec: 0.667308  v_Recall: 0.579031  v_F1: 0.620043  v_AUC: 0.862505
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.297977    reg_loss: 0.168808    l2_loss: 0.014518    loss: 0.481303
steps 3000    v_Prec: 0.685375  v_Recall: 0.583804  v_F1: 0.630525  v_AUC: 0.869835
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.294499    reg_loss: 0.166997    l2_loss: 0.014885    loss: 0.476381
steps 3200    v_Prec: 0.694375  v_Recall: 0.598043  v_F1: 0.642619  v_AUC: 0.875098
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.291668    reg_loss: 0.164895    l2_loss: 0.015273    loss: 0.471836
steps 3400    v_Prec: 0.684151  v_Recall: 0.620476  v_F1: 0.650759  v_AUC: 0.877550
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.289924    reg_loss: 0.161902    l2_loss: 0.015665    loss: 0.467491
steps 3600    v_Prec: 0.685415  v_Recall: 0.629146  v_F1: 0.656076  v_AUC: 0.882552
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.283188    reg_loss: 0.160609    l2_loss: 0.016114    loss: 0.459911
steps 3800    v_Prec: 0.703687  v_Recall: 0.617930  v_F1: 0.658026  v_AUC: 0.883827
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.276717    reg_loss: 0.157611    l2_loss: 0.016485    loss: 0.450813
steps 4000    v_Prec: 0.717710  v_Recall: 0.619282  v_F1: 0.664873  v_AUC: 0.885887
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.283389    reg_loss: 0.155624    l2_loss: 0.016862    loss: 0.455875
steps 4200    v_Prec: 0.700837  v_Recall: 0.639567  v_F1: 0.668802  v_AUC: 0.889585
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.281642    reg_loss: 0.153344    l2_loss: 0.017311    loss: 0.452297
steps 4400    v_Prec: 0.713523  v_Recall: 0.627078  v_F1: 0.667513  v_AUC: 0.887728
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.270806    reg_loss: 0.150739    l2_loss: 0.017656    loss: 0.439201
steps 4600    v_Prec: 0.732611  v_Recall: 0.624214  v_F1: 0.674083  v_AUC: 0.891191
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.273359    reg_loss: 0.148272    l2_loss: 0.018152    loss: 0.439783
steps 4800    v_Prec: 0.718733  v_Recall: 0.635431  v_F1: 0.674520  v_AUC: 0.891655
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.277892    reg_loss: 0.146872    l2_loss: 0.018608    loss: 0.443372
steps 5000    v_Prec: 0.721954  v_Recall: 0.641954  v_F1: 0.679608  v_AUC: 0.894675
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.279115    reg_loss: 0.144809    l2_loss: 0.019242    loss: 0.443166
steps 5200    v_Prec: 0.724973  v_Recall: 0.640601  v_F1: 0.680181  v_AUC: 0.894614
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.274287    reg_loss: 0.141873    l2_loss: 0.019779    loss: 0.435939
steps 5400    v_Prec: 0.721197  v_Recall: 0.649829  v_F1: 0.683656  v_AUC: 0.895941
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.183411    reg_loss: 0.128323    l2_loss: 0.020324    loss: 0.332058
steps 5600    v_Prec: 0.705366  v_Recall: 0.658738  v_F1: 0.681255  v_AUC: 0.891695
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.196244    reg_loss: 0.129542    l2_loss: 0.020909    loss: 0.346695
steps 5800    v_Prec: 0.696815  v_Recall: 0.671705  v_F1: 0.684029  v_AUC: 0.892656
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.184467    reg_loss: 0.128099    l2_loss: 0.021646    loss: 0.334212
steps 6000    v_Prec: 0.713628  v_Recall: 0.653568  v_F1: 0.682279  v_AUC: 0.894131
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.188680    reg_loss: 0.127269    l2_loss: 0.022108    loss: 0.338057
steps 6200    v_Prec: 0.721493  v_Recall: 0.651818  v_F1: 0.684888  v_AUC: 0.892480
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.193174    reg_loss: 0.126826    l2_loss: 0.022615    loss: 0.342614
steps 6400    v_Prec: 0.725402  v_Recall: 0.656272  v_F1: 0.689108  v_AUC: 0.893874
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.191186    reg_loss: 0.125842    l2_loss: 0.023151    loss: 0.340180
steps 6600    v_Prec: 0.749292  v_Recall: 0.631692  v_F1: 0.685485  v_AUC: 0.896329
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.193013    reg_loss: 0.124759    l2_loss: 0.023527    loss: 0.341300
steps 6800    v_Prec: 0.747140  v_Recall: 0.644261  v_F1: 0.691897  v_AUC: 0.896027
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.197308    reg_loss: 0.125031    l2_loss: 0.024007    loss: 0.346346
steps 7000    v_Prec: 0.746386  v_Recall: 0.648954  v_F1: 0.694268  v_AUC: 0.897384
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.199865    reg_loss: 0.124279    l2_loss: 0.024418    loss: 0.348562
steps 7200    v_Prec: 0.747513  v_Recall: 0.651659  v_F1: 0.696303  v_AUC: 0.898491
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.193620    reg_loss: 0.122663    l2_loss: 0.024696    loss: 0.340979
steps 7400    v_Prec: 0.725670  v_Recall: 0.674409  v_F1: 0.699101  v_AUC: 0.900173
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.201122    reg_loss: 0.122423    l2_loss: 0.025076    loss: 0.348621
steps 7600    v_Prec: 0.742411  v_Recall: 0.665341  v_F1: 0.701766  v_AUC: 0.902482
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.207302    reg_loss: 0.121447    l2_loss: 0.025367    loss: 0.354115
steps 7800    v_Prec: 0.719674  v_Recall: 0.689046  v_F1: 0.704027  v_AUC: 0.903212
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.198777    reg_loss: 0.120829    l2_loss: 0.025720    loss: 0.345327
steps 8000    v_Prec: 0.735421  v_Recall: 0.678148  v_F1: 0.705624  v_AUC: 0.905347
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.204142    reg_loss: 0.120080    l2_loss: 0.025830    loss: 0.350052
steps 8200    v_Prec: 0.747713  v_Recall: 0.669796  v_F1: 0.706613  v_AUC: 0.905531
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.205079    reg_loss: 0.119037    l2_loss: 0.026221    loss: 0.350337
steps 8400    v_Prec: 0.759253  v_Recall: 0.669080  v_F1: 0.711320  v_AUC: 0.907254
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.202484    reg_loss: 0.118355    l2_loss: 0.026392    loss: 0.347232
steps 8600    v_Prec: 0.769095  v_Recall: 0.660807  v_F1: 0.710851  v_AUC: 0.908711
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.203025    reg_loss: 0.117092    l2_loss: 0.026515    loss: 0.346632
steps 8800    v_Prec: 0.754951  v_Recall: 0.673216  v_F1: 0.711745  v_AUC: 0.908277
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.202824    reg_loss: 0.116398    l2_loss: 0.026810    loss: 0.346032
steps 9000    v_Prec: 0.743255  v_Recall: 0.692467  v_F1: 0.716962  v_AUC: 0.909260
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.206313    reg_loss: 0.116373    l2_loss: 0.027016    loss: 0.349703
steps 9200    v_Prec: 0.763898  v_Recall: 0.676637  v_F1: 0.717624  v_AUC: 0.910476
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.198787    reg_loss: 0.115044    l2_loss: 0.027146    loss: 0.340977
steps 9400    v_Prec: 0.747706  v_Recall: 0.693580  v_F1: 0.719627  v_AUC: 0.910193
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.199193    reg_loss: 0.113442    l2_loss: 0.027427    loss: 0.340062
steps 9600    v_Prec: 0.732423  v_Recall: 0.708536  v_F1: 0.720281  v_AUC: 0.912440
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.198286    reg_loss: 0.112636    l2_loss: 0.027465    loss: 0.338388
steps 9800    v_Prec: 0.744406  v_Recall: 0.695967  v_F1: 0.719372  v_AUC: 0.912529
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.205839    reg_loss: 0.112294    l2_loss: 0.027700    loss: 0.345833
steps 10000    v_Prec: 0.755113  v_Recall: 0.690239  v_F1: 0.721220  v_AUC: 0.912138
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.200820    reg_loss: 0.111752    l2_loss: 0.027858    loss: 0.340430
steps 10200    v_Prec: 0.750301  v_Recall: 0.693183  v_F1: 0.720612  v_AUC: 0.914037
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.198432    reg_loss: 0.110495    l2_loss: 0.028052    loss: 0.336979
steps 10400    v_Prec: 0.757941  v_Recall: 0.694694  v_F1: 0.724941  v_AUC: 0.914896
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.203072    reg_loss: 0.109778    l2_loss: 0.028251    loss: 0.341101
steps 10600    v_Prec: 0.741986  v_Recall: 0.712592  v_F1: 0.726992  v_AUC: 0.916999
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.195167    reg_loss: 0.108665    l2_loss: 0.028407    loss: 0.332239
steps 10800    v_Prec: 0.763681  v_Recall: 0.697160  v_F1: 0.728906  v_AUC: 0.915240
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.093793    reg_loss: 0.097523    l2_loss: 0.028520    loss: 0.219836
steps 11000    v_Prec: 0.779512  v_Recall: 0.675523  v_F1: 0.723801  v_AUC: 0.912767
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.097480    reg_loss: 0.097863    l2_loss: 0.028419    loss: 0.223762
steps 11200    v_Prec: 0.780899  v_Recall: 0.681012  v_F1: 0.727543  v_AUC: 0.912008
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.093443    reg_loss: 0.098567    l2_loss: 0.028616    loss: 0.220626
steps 11400    v_Prec: 0.770341  v_Recall: 0.679341  v_F1: 0.721985  v_AUC: 0.910027
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.094416    reg_loss: 0.098438    l2_loss: 0.028707    loss: 0.221561
steps 11600    v_Prec: 0.781326  v_Recall: 0.667648  v_F1: 0.720027  v_AUC: 0.908965
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.094485    reg_loss: 0.099677    l2_loss: 0.028903    loss: 0.223065
steps 11800    v_Prec: 0.775409  v_Recall: 0.682762  v_F1: 0.726142  v_AUC: 0.911058
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.101346    reg_loss: 0.099916    l2_loss: 0.028864    loss: 0.230126
steps 12000    v_Prec: 0.775175  v_Recall: 0.687058  v_F1: 0.728461  v_AUC: 0.909943
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.100348    reg_loss: 0.100379    l2_loss: 0.028949    loss: 0.229677
steps 12200    v_Prec: 0.753320  v_Recall: 0.695012  v_F1: 0.722992  v_AUC: 0.909338
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.102189    reg_loss: 0.099602    l2_loss: 0.029014    loss: 0.230805
steps 12400    v_Prec: 0.766001  v_Recall: 0.683557  v_F1: 0.722435  v_AUC: 0.911037
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.101547    reg_loss: 0.099127    l2_loss: 0.029116    loss: 0.229790
steps 12600    v_Prec: 0.747480  v_Recall: 0.701933  v_F1: 0.723991  v_AUC: 0.910639
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.101496    reg_loss: 0.099281    l2_loss: 0.029045    loss: 0.229823
steps 12800    v_Prec: 0.741694  v_Recall: 0.710365  v_F1: 0.725692  v_AUC: 0.911001
steps 12800    running time 452 seconds

Early stop model F1: 0.728906
testing thre: 0.3978166
testing Prec: 0.4958618207988485
testing Recall: 0.8036938031591737
testing F1: 0.6133189918958515
testing AUC: 0.9016116800171825
overall running time 454 seconds
(0.7301930758988016, 0.6396597812879709, 0.6819347651493561, 0.9016116800171825, 0.831662)

2019-02-24 18:25:07.434907: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:25:08.328617: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:25:08.439955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:25:08.440020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.550000 seconds
loading data in 30.700000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.909692    reg_loss: 0.215373    l2_loss: 0.013356    loss: 1.138420
steps 200    v_Prec: 0.166063  v_Recall: 0.993621  v_F1: 0.284567  v_AUC: 0.500853
steps 200    running time 41 seconds

steps 400    base_loss: 0.619348    reg_loss: 0.214296    l2_loss: 0.013281    loss: 0.846924
steps 400    v_Prec: 0.165790  v_Recall: 0.998425  v_F1: 0.284362  v_AUC: 0.530944
steps 400    running time 47 seconds

steps 600    base_loss: 0.490712    reg_loss: 0.211798    l2_loss: 0.013068    loss: 0.715577
steps 600    v_Prec: 0.175919  v_Recall: 0.786643  v_F1: 0.287536  v_AUC: 0.559234
steps 600    running time 54 seconds

steps 800    base_loss: 0.484915    reg_loss: 0.208389    l2_loss: 0.012887    loss: 0.706191
steps 800    v_Prec: 0.205805  v_Recall: 0.576357  v_F1: 0.303305  v_AUC: 0.592108
steps 800    running time 60 seconds

steps 1000    base_loss: 0.464365    reg_loss: 0.203270    l2_loss: 0.012667    loss: 0.680302
steps 1000    v_Prec: 0.222725  v_Recall: 0.589116  v_F1: 0.323243  v_AUC: 0.636125
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.448170    reg_loss: 0.196867    l2_loss: 0.012510    loss: 0.657547
steps 1200    v_Prec: 0.276994  v_Recall: 0.488934  v_F1: 0.353642  v_AUC: 0.675996
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.433907    reg_loss: 0.190378    l2_loss: 0.012469    loss: 0.636754
steps 1400    v_Prec: 0.393576  v_Recall: 0.426557  v_F1: 0.409404  v_AUC: 0.726602
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.406942    reg_loss: 0.184992    l2_loss: 0.012550    loss: 0.604484
steps 1600    v_Prec: 0.479194  v_Recall: 0.460739  v_F1: 0.469785  v_AUC: 0.765440
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.384375    reg_loss: 0.180068    l2_loss: 0.012738    loss: 0.577181
steps 1800    v_Prec: 0.514652  v_Recall: 0.511774  v_F1: 0.513209  v_AUC: 0.798267
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.358344    reg_loss: 0.175023    l2_loss: 0.012984    loss: 0.546351
steps 2000    v_Prec: 0.534889  v_Recall: 0.548791  v_F1: 0.541751  v_AUC: 0.823802
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.341926    reg_loss: 0.172045    l2_loss: 0.013286    loss: 0.527257
steps 2200    v_Prec: 0.553247  v_Recall: 0.566275  v_F1: 0.559686  v_AUC: 0.839084
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.331701    reg_loss: 0.168467    l2_loss: 0.013560    loss: 0.513728
steps 2400    v_Prec: 0.587350  v_Recall: 0.577774  v_F1: 0.582523  v_AUC: 0.852649
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.318728    reg_loss: 0.165243    l2_loss: 0.013911    loss: 0.497882
steps 2600    v_Prec: 0.603385  v_Recall: 0.592502  v_F1: 0.597894  v_AUC: 0.861590
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.316341    reg_loss: 0.163152    l2_loss: 0.014235    loss: 0.493728
steps 2800    v_Prec: 0.591984  v_Recall: 0.624714  v_F1: 0.607909  v_AUC: 0.868046
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.301688    reg_loss: 0.159209    l2_loss: 0.014668    loss: 0.475565
steps 3000    v_Prec: 0.609212  v_Recall: 0.626053  v_F1: 0.617518  v_AUC: 0.873750
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.302927    reg_loss: 0.156681    l2_loss: 0.015077    loss: 0.474686
steps 3200    v_Prec: 0.622625  v_Recall: 0.632433  v_F1: 0.627491  v_AUC: 0.878696
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.299543    reg_loss: 0.153958    l2_loss: 0.015456    loss: 0.468958
steps 3400    v_Prec: 0.645997  v_Recall: 0.616996  v_F1: 0.631163  v_AUC: 0.879557
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.294486    reg_loss: 0.150705    l2_loss: 0.015939    loss: 0.461129
steps 3600    v_Prec: 0.674229  v_Recall: 0.610932  v_F1: 0.641021  v_AUC: 0.884818
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.292587    reg_loss: 0.147959    l2_loss: 0.016398    loss: 0.456943
steps 3800    v_Prec: 0.648302  v_Recall: 0.637631  v_F1: 0.642922  v_AUC: 0.886035
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.292151    reg_loss: 0.145568    l2_loss: 0.016919    loss: 0.454637
steps 4000    v_Prec: 0.660336  v_Recall: 0.638025  v_F1: 0.648989  v_AUC: 0.887625
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.289811    reg_loss: 0.142320    l2_loss: 0.017411    loss: 0.449542
steps 4200    v_Prec: 0.664332  v_Recall: 0.642356  v_F1: 0.653159  v_AUC: 0.888304
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.286413    reg_loss: 0.140065    l2_loss: 0.017914    loss: 0.444392
steps 4400    v_Prec: 0.683447  v_Recall: 0.623376  v_F1: 0.652031  v_AUC: 0.891951
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.283383    reg_loss: 0.137516    l2_loss: 0.018463    loss: 0.439361
steps 4600    v_Prec: 0.671311  v_Recall: 0.645034  v_F1: 0.657911  v_AUC: 0.893644
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.284558    reg_loss: 0.135788    l2_loss: 0.019000    loss: 0.439347
steps 4800    v_Prec: 0.688170  v_Recall: 0.636843  v_F1: 0.661513  v_AUC: 0.896134
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.278441    reg_loss: 0.133047    l2_loss: 0.019705    loss: 0.431193
steps 5000    v_Prec: 0.663154  v_Recall: 0.659132  v_F1: 0.661137  v_AUC: 0.896324
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.279857    reg_loss: 0.129797    l2_loss: 0.020241    loss: 0.429895
steps 5200    v_Prec: 0.690731  v_Recall: 0.634481  v_F1: 0.661412  v_AUC: 0.896642
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.280072    reg_loss: 0.127938    l2_loss: 0.020925    loss: 0.428935
steps 5400    v_Prec: 0.669103  v_Recall: 0.663306  v_F1: 0.666192  v_AUC: 0.897614
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.194603    reg_loss: 0.119696    l2_loss: 0.021512    loss: 0.335811
steps 5600    v_Prec: 0.661605  v_Recall: 0.662282  v_F1: 0.661944  v_AUC: 0.894780
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.197058    reg_loss: 0.119494    l2_loss: 0.022103    loss: 0.338656
steps 5800    v_Prec: 0.670197  v_Recall: 0.657951  v_F1: 0.664017  v_AUC: 0.893415
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.207691    reg_loss: 0.120735    l2_loss: 0.022630    loss: 0.351056
steps 6000    v_Prec: 0.662399  v_Recall: 0.672364  v_F1: 0.667344  v_AUC: 0.895098
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.204121    reg_loss: 0.119837    l2_loss: 0.023232    loss: 0.347189
steps 6200    v_Prec: 0.650164  v_Recall: 0.685753  v_F1: 0.667484  v_AUC: 0.895574
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.211965    reg_loss: 0.119293    l2_loss: 0.023865    loss: 0.355123
steps 6400    v_Prec: 0.681116  v_Recall: 0.655903  v_F1: 0.668272  v_AUC: 0.896047
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.213223    reg_loss: 0.118631    l2_loss: 0.024233    loss: 0.356087
steps 6600    v_Prec: 0.685721  v_Recall: 0.662282  v_F1: 0.673798  v_AUC: 0.900581
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.203178    reg_loss: 0.117116    l2_loss: 0.024666    loss: 0.344960
steps 6800    v_Prec: 0.714048  v_Recall: 0.642908  v_F1: 0.676613  v_AUC: 0.900744
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.208383    reg_loss: 0.116654    l2_loss: 0.025078    loss: 0.350115
steps 7000    v_Prec: 0.703797  v_Recall: 0.661337  v_F1: 0.681907  v_AUC: 0.902925
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.206488    reg_loss: 0.115294    l2_loss: 0.025527    loss: 0.347310
steps 7200    v_Prec: 0.698452  v_Recall: 0.668032  v_F1: 0.682903  v_AUC: 0.902876
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.201625    reg_loss: 0.113753    l2_loss: 0.025924    loss: 0.341302
steps 7400    v_Prec: 0.698935  v_Recall: 0.666457  v_F1: 0.682309  v_AUC: 0.902681
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.196358    reg_loss: 0.113070    l2_loss: 0.026287    loss: 0.335715
steps 7600    v_Prec: 0.720459  v_Recall: 0.652595  v_F1: 0.684850  v_AUC: 0.902751
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.204844    reg_loss: 0.112362    l2_loss: 0.026485    loss: 0.343692
steps 7800    v_Prec: 0.677202  v_Recall: 0.695282  v_F1: 0.686123  v_AUC: 0.902828
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.190123    reg_loss: 0.110914    l2_loss: 0.026812    loss: 0.327849
steps 8000    v_Prec: 0.709752  v_Recall: 0.676380  v_F1: 0.692664  v_AUC: 0.905137
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.209028    reg_loss: 0.110827    l2_loss: 0.027133    loss: 0.346988
steps 8200    v_Prec: 0.705567  v_Recall: 0.673781  v_F1: 0.689308  v_AUC: 0.906477
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.204549    reg_loss: 0.109176    l2_loss: 0.027323    loss: 0.341048
steps 8400    v_Prec: 0.727739  v_Recall: 0.659762  v_F1: 0.692085  v_AUC: 0.907333
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.207916    reg_loss: 0.108823    l2_loss: 0.027642    loss: 0.344381
steps 8600    v_Prec: 0.715520  v_Recall: 0.671733  v_F1: 0.692936  v_AUC: 0.907743
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.203884    reg_loss: 0.107336    l2_loss: 0.027829    loss: 0.339049
steps 8800    v_Prec: 0.719192  v_Recall: 0.676144  v_F1: 0.697004  v_AUC: 0.908564
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.211830    reg_loss: 0.108253    l2_loss: 0.028124    loss: 0.348207
steps 9000    v_Prec: 0.693707  v_Recall: 0.693707  v_F1: 0.693707  v_AUC: 0.909028
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.207112    reg_loss: 0.106317    l2_loss: 0.028298    loss: 0.341728
steps 9200    v_Prec: 0.732651  v_Recall: 0.659368  v_F1: 0.694081  v_AUC: 0.912019
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.216186    reg_loss: 0.106013    l2_loss: 0.028675    loss: 0.350874
steps 9400    v_Prec: 0.724350  v_Recall: 0.677798  v_F1: 0.700301  v_AUC: 0.912301
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.199775    reg_loss: 0.103715    l2_loss: 0.028779    loss: 0.332269
steps 9600    v_Prec: 0.696835  v_Recall: 0.702213  v_F1: 0.699514  v_AUC: 0.912482
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.208960    reg_loss: 0.104063    l2_loss: 0.028900    loss: 0.341923
steps 9800    v_Prec: 0.722245  v_Recall: 0.679924  v_F1: 0.700446  v_AUC: 0.912277
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.205463    reg_loss: 0.103108    l2_loss: 0.029114    loss: 0.337685
steps 10000    v_Prec: 0.734551  v_Recall: 0.671261  v_F1: 0.701481  v_AUC: 0.913545
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.213109    reg_loss: 0.102744    l2_loss: 0.029217    loss: 0.345070
steps 10200    v_Prec: 0.706172  v_Recall: 0.700165  v_F1: 0.703156  v_AUC: 0.912617
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.208660    reg_loss: 0.102072    l2_loss: 0.029485    loss: 0.340217
steps 10400    v_Prec: 0.709313  v_Recall: 0.703001  v_F1: 0.706143  v_AUC: 0.912444
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.209519    reg_loss: 0.101086    l2_loss: 0.029568    loss: 0.340172
steps 10600    v_Prec: 0.719997  v_Recall: 0.699299  v_F1: 0.709497  v_AUC: 0.915254
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.199371    reg_loss: 0.100480    l2_loss: 0.029770    loss: 0.329621
steps 10800    v_Prec: 0.719962  v_Recall: 0.713554  v_F1: 0.716744  v_AUC: 0.916591
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.101114    reg_loss: 0.094073    l2_loss: 0.029729    loss: 0.224917
steps 11000    v_Prec: 0.733266  v_Recall: 0.685910  v_F1: 0.708798  v_AUC: 0.913022
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.094386    reg_loss: 0.095266    l2_loss: 0.029625    loss: 0.219276
steps 11200    v_Prec: 0.715509  v_Recall: 0.697645  v_F1: 0.706464  v_AUC: 0.912664
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.102135    reg_loss: 0.096952    l2_loss: 0.029645    loss: 0.228733
steps 11400    v_Prec: 0.736450  v_Recall: 0.677404  v_F1: 0.705694  v_AUC: 0.911101
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.101298    reg_loss: 0.098462    l2_loss: 0.029656    loss: 0.229416
steps 11600    v_Prec: 0.718944  v_Recall: 0.675514  v_F1: 0.696553  v_AUC: 0.907828
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.102529    reg_loss: 0.097790    l2_loss: 0.029444    loss: 0.229762
steps 11800    v_Prec: 0.713353  v_Recall: 0.688745  v_F1: 0.700833  v_AUC: 0.908643
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.098450    reg_loss: 0.098279    l2_loss: 0.029547    loss: 0.226276
steps 12000    v_Prec: 0.716978  v_Recall: 0.683154  v_F1: 0.699657  v_AUC: 0.907076
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.097241    reg_loss: 0.097897    l2_loss: 0.029529    loss: 0.224667
steps 12200    v_Prec: 0.707679  v_Recall: 0.688115  v_F1: 0.697760  v_AUC: 0.907911
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.101717    reg_loss: 0.097846    l2_loss: 0.029408    loss: 0.228971
steps 12400    v_Prec: 0.707147  v_Recall: 0.694337  v_F1: 0.700684  v_AUC: 0.910070
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.099286    reg_loss: 0.098868    l2_loss: 0.029461    loss: 0.227614
steps 12600    v_Prec: 0.746547  v_Recall: 0.659762  v_F1: 0.700477  v_AUC: 0.908985
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.105809    reg_loss: 0.099194    l2_loss: 0.029569    loss: 0.234572
steps 12800    v_Prec: 0.719550  v_Recall: 0.675120  v_F1: 0.696627  v_AUC: 0.907995
steps 12800    running time 453 seconds

Early stop model F1: 0.716744
testing thre: 0.4205374
testing Prec: 0.4806030733545955
testing Recall: 0.8056379100850547
testing F1: 0.6020521202215564
testing AUC: 0.8967907686442913
overall running time 456 seconds
(0.6816086065573771, 0.6466585662211422, 0.6636737747848859, 0.8967907686442913, 0.8328103)

2019-02-24 18:30:05.085062: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:30:05.737412: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:30:05.738303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:30:05.738337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.100000 seconds
loading data in 30.200000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.573280    reg_loss: 0.216526    l2_loss: 0.013331    loss: 0.803137
steps 200    v_Prec: 0.163631  v_Recall: 0.997285  v_F1: 0.281135  v_AUC: 0.508281
steps 200    running time 40 seconds

steps 400    base_loss: 0.534738    reg_loss: 0.214153    l2_loss: 0.013225    loss: 0.762117
steps 400    v_Prec: 0.173944  v_Recall: 0.827358  v_F1: 0.287454  v_AUC: 0.558711
steps 400    running time 47 seconds

steps 600    base_loss: 0.504784    reg_loss: 0.209452    l2_loss: 0.012976    loss: 0.727211
steps 600    v_Prec: 0.187760  v_Recall: 0.666134  v_F1: 0.292948  v_AUC: 0.575574
steps 600    running time 54 seconds

steps 800    base_loss: 0.461957    reg_loss: 0.203544    l2_loss: 0.012594    loss: 0.678095
steps 800    v_Prec: 0.234043  v_Recall: 0.515052  v_F1: 0.321840  v_AUC: 0.638665
steps 800    running time 61 seconds

steps 1000    base_loss: 0.440761    reg_loss: 0.196470    l2_loss: 0.012405    loss: 0.649637
steps 1000    v_Prec: 0.292734  v_Recall: 0.478080  v_F1: 0.363124  v_AUC: 0.690015
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.427981    reg_loss: 0.190776    l2_loss: 0.012339    loss: 0.631096
steps 1200    v_Prec: 0.367785  v_Recall: 0.456919  v_F1: 0.407535  v_AUC: 0.731780
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.410996    reg_loss: 0.186478    l2_loss: 0.012373    loss: 0.609847
steps 1400    v_Prec: 0.443098  v_Recall: 0.478799  v_F1: 0.460257  v_AUC: 0.769185
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.380636    reg_loss: 0.182069    l2_loss: 0.012494    loss: 0.575198
steps 1600    v_Prec: 0.466217  v_Recall: 0.535016  v_F1: 0.498252  v_AUC: 0.802429
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.357946    reg_loss: 0.178663    l2_loss: 0.012702    loss: 0.549311
steps 1800    v_Prec: 0.525491  v_Recall: 0.548990  v_F1: 0.536984  v_AUC: 0.828033
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.340976    reg_loss: 0.175699    l2_loss: 0.012998    loss: 0.529673
steps 2000    v_Prec: 0.565040  v_Recall: 0.574064  v_F1: 0.569516  v_AUC: 0.847241
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.331122    reg_loss: 0.173101    l2_loss: 0.013227    loss: 0.517450
steps 2200    v_Prec: 0.556304  v_Recall: 0.613431  v_F1: 0.583473  v_AUC: 0.859455
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.318275    reg_loss: 0.169469    l2_loss: 0.013577    loss: 0.501321
steps 2400    v_Prec: 0.602760  v_Recall: 0.600016  v_F1: 0.601385  v_AUC: 0.866862
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.311675    reg_loss: 0.166440    l2_loss: 0.013917    loss: 0.492031
steps 2600    v_Prec: 0.624116  v_Recall: 0.605925  v_F1: 0.614886  v_AUC: 0.871827
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.299161    reg_loss: 0.163198    l2_loss: 0.014319    loss: 0.476678
steps 2800    v_Prec: 0.624447  v_Recall: 0.631478  v_F1: 0.627943  v_AUC: 0.878043
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.297359    reg_loss: 0.160701    l2_loss: 0.014688    loss: 0.472748
steps 3000    v_Prec: 0.654644  v_Recall: 0.607283  v_F1: 0.630075  v_AUC: 0.881117
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.293456    reg_loss: 0.157601    l2_loss: 0.015107    loss: 0.466164
steps 3200    v_Prec: 0.625124  v_Recall: 0.652879  v_F1: 0.638700  v_AUC: 0.886035
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.290061    reg_loss: 0.154763    l2_loss: 0.015490    loss: 0.460314
steps 3400    v_Prec: 0.675123  v_Recall: 0.622614  v_F1: 0.647807  v_AUC: 0.888290
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.286858    reg_loss: 0.152615    l2_loss: 0.015982    loss: 0.455454
steps 3600    v_Prec: 0.679866  v_Recall: 0.630680  v_F1: 0.654350  v_AUC: 0.893487
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.286470    reg_loss: 0.149281    l2_loss: 0.016483    loss: 0.452234
steps 3800    v_Prec: 0.657963  v_Recall: 0.649924  v_F1: 0.653919  v_AUC: 0.893764
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.282064    reg_loss: 0.146311    l2_loss: 0.016875    loss: 0.445250
steps 4000    v_Prec: 0.692369  v_Recall: 0.628124  v_F1: 0.658684  v_AUC: 0.894150
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.281830    reg_loss: 0.143532    l2_loss: 0.017349    loss: 0.442711
steps 4200    v_Prec: 0.676781  v_Recall: 0.644734  v_F1: 0.660369  v_AUC: 0.896078
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.289438    reg_loss: 0.142021    l2_loss: 0.017835    loss: 0.449293
steps 4400    v_Prec: 0.679742  v_Recall: 0.648966  v_F1: 0.663998  v_AUC: 0.897969
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.280879    reg_loss: 0.138778    l2_loss: 0.018502    loss: 0.438159
steps 4600    v_Prec: 0.650809  v_Recall: 0.677314  v_F1: 0.663797  v_AUC: 0.899368
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.281310    reg_loss: 0.135956    l2_loss: 0.018951    loss: 0.436217
steps 4800    v_Prec: 0.692321  v_Recall: 0.644334  v_F1: 0.667466  v_AUC: 0.898241
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.278289    reg_loss: 0.133339    l2_loss: 0.019507    loss: 0.431134
steps 5000    v_Prec: 0.672528  v_Recall: 0.665815  v_F1: 0.669155  v_AUC: 0.900128
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.278959    reg_loss: 0.131502    l2_loss: 0.020199    loss: 0.430660
steps 5200    v_Prec: 0.660489  v_Recall: 0.680109  v_F1: 0.670155  v_AUC: 0.899268
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.273535    reg_loss: 0.127781    l2_loss: 0.020769    loss: 0.422085
steps 5400    v_Prec: 0.669344  v_Recall: 0.672123  v_F1: 0.670731  v_AUC: 0.899639
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.195455    reg_loss: 0.122877    l2_loss: 0.021419    loss: 0.339751
steps 5600    v_Prec: 0.670010  v_Recall: 0.666693  v_F1: 0.668348  v_AUC: 0.900179
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.191044    reg_loss: 0.122373    l2_loss: 0.021941    loss: 0.335358
steps 5800    v_Prec: 0.684669  v_Recall: 0.665096  v_F1: 0.674741  v_AUC: 0.899644
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.199882    reg_loss: 0.123459    l2_loss: 0.022711    loss: 0.346051
steps 6000    v_Prec: 0.697338  v_Recall: 0.650563  v_F1: 0.673139  v_AUC: 0.899348
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.184697    reg_loss: 0.121708    l2_loss: 0.023259    loss: 0.329664
steps 6200    v_Prec: 0.665578  v_Recall: 0.683542  v_F1: 0.674441  v_AUC: 0.898765
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.201581    reg_loss: 0.121686    l2_loss: 0.023733    loss: 0.347000
steps 6400    v_Prec: 0.682596  v_Recall: 0.666134  v_F1: 0.674264  v_AUC: 0.900944
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.207994    reg_loss: 0.121041    l2_loss: 0.024259    loss: 0.353293
steps 6600    v_Prec: 0.702777  v_Recall: 0.654795  v_F1: 0.677938  v_AUC: 0.900634
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.192034    reg_loss: 0.119085    l2_loss: 0.024766    loss: 0.335884
steps 6800    v_Prec: 0.700781  v_Recall: 0.666534  v_F1: 0.683228  v_AUC: 0.902765
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.194286    reg_loss: 0.118643    l2_loss: 0.025223    loss: 0.338153
steps 7000    v_Prec: 0.694376  v_Recall: 0.672363  v_F1: 0.683192  v_AUC: 0.904837
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.204428    reg_loss: 0.117842    l2_loss: 0.025551    loss: 0.347821
steps 7200    v_Prec: 0.692740  v_Recall: 0.669009  v_F1: 0.680668  v_AUC: 0.903612
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.189697    reg_loss: 0.115777    l2_loss: 0.026002    loss: 0.331476
steps 7400    v_Prec: 0.690939  v_Recall: 0.678911  v_F1: 0.684872  v_AUC: 0.903933
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.202303    reg_loss: 0.116789    l2_loss: 0.026274    loss: 0.345366
steps 7600    v_Prec: 0.697153  v_Recall: 0.670766  v_F1: 0.683705  v_AUC: 0.904323
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.196016    reg_loss: 0.115044    l2_loss: 0.026584    loss: 0.337643
steps 7800    v_Prec: 0.704403  v_Recall: 0.673241  v_F1: 0.688470  v_AUC: 0.907442
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.205632    reg_loss: 0.113385    l2_loss: 0.027009    loss: 0.346026
steps 8000    v_Prec: 0.693581  v_Recall: 0.689372  v_F1: 0.691470  v_AUC: 0.909165
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.200295    reg_loss: 0.111534    l2_loss: 0.027199    loss: 0.339028
steps 8200    v_Prec: 0.687202  v_Recall: 0.702787  v_F1: 0.694907  v_AUC: 0.909698
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.193805    reg_loss: 0.112086    l2_loss: 0.027391    loss: 0.333282
steps 8400    v_Prec: 0.695239  v_Recall: 0.689132  v_F1: 0.692172  v_AUC: 0.909962
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.202000    reg_loss: 0.110879    l2_loss: 0.027771    loss: 0.340650
steps 8600    v_Prec: 0.711042  v_Recall: 0.677713  v_F1: 0.693978  v_AUC: 0.910748
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.200627    reg_loss: 0.109243    l2_loss: 0.028070    loss: 0.337939
steps 8800    v_Prec: 0.711457  v_Recall: 0.682824  v_F1: 0.696846  v_AUC: 0.910484
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.208442    reg_loss: 0.108828    l2_loss: 0.028190    loss: 0.345459
steps 9000    v_Prec: 0.707506  v_Recall: 0.691687  v_F1: 0.699507  v_AUC: 0.912774
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.206388    reg_loss: 0.108221    l2_loss: 0.028537    loss: 0.343146
steps 9200    v_Prec: 0.702536  v_Recall: 0.692326  v_F1: 0.697394  v_AUC: 0.912117
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.203919    reg_loss: 0.107680    l2_loss: 0.028720    loss: 0.340319
steps 9400    v_Prec: 0.715570  v_Recall: 0.692885  v_F1: 0.704045  v_AUC: 0.913905
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.206249    reg_loss: 0.107231    l2_loss: 0.028919    loss: 0.342399
steps 9600    v_Prec: 0.706638  v_Recall: 0.698794  v_F1: 0.702694  v_AUC: 0.913478
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.212289    reg_loss: 0.105619    l2_loss: 0.029161    loss: 0.347069
steps 9800    v_Prec: 0.693710  v_Recall: 0.716921  v_F1: 0.705125  v_AUC: 0.916957
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.199109    reg_loss: 0.104823    l2_loss: 0.029368    loss: 0.333301
steps 10000    v_Prec: 0.720373  v_Recall: 0.697996  v_F1: 0.709008  v_AUC: 0.917023
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.201296    reg_loss: 0.103272    l2_loss: 0.029537    loss: 0.334105
steps 10200    v_Prec: 0.714251  v_Recall: 0.703186  v_F1: 0.708675  v_AUC: 0.917796
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.212614    reg_loss: 0.103644    l2_loss: 0.029855    loss: 0.346114
steps 10400    v_Prec: 0.724342  v_Recall: 0.692646  v_F1: 0.708139  v_AUC: 0.919301
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.203192    reg_loss: 0.102858    l2_loss: 0.029987    loss: 0.336037
steps 10600    v_Prec: 0.718182  v_Recall: 0.706540  v_F1: 0.712313  v_AUC: 0.919254
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.197702    reg_loss: 0.101706    l2_loss: 0.030212    loss: 0.329620
steps 10800    v_Prec: 0.730041  v_Recall: 0.692965  v_F1: 0.711020  v_AUC: 0.919873
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.095232    reg_loss: 0.095470    l2_loss: 0.030371    loss: 0.221072
steps 11000    v_Prec: 0.733126  v_Recall: 0.678272  v_F1: 0.704633  v_AUC: 0.916941
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.093725    reg_loss: 0.097679    l2_loss: 0.030186    loss: 0.221590
steps 11200    v_Prec: 0.726163  v_Recall: 0.689052  v_F1: 0.707121  v_AUC: 0.915807
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.093412    reg_loss: 0.098513    l2_loss: 0.029891    loss: 0.221816
steps 11400    v_Prec: 0.734244  v_Recall: 0.669808  v_F1: 0.700547  v_AUC: 0.913650
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.093124    reg_loss: 0.099509    l2_loss: 0.029993    loss: 0.222627
steps 11600    v_Prec: 0.725622  v_Recall: 0.673241  v_F1: 0.698451  v_AUC: 0.912467
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.093847    reg_loss: 0.099050    l2_loss: 0.029941    loss: 0.222838
steps 11800    v_Prec: 0.720589  v_Recall: 0.675477  v_F1: 0.697304  v_AUC: 0.912486
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.093663    reg_loss: 0.099521    l2_loss: 0.029946    loss: 0.223130
steps 12000    v_Prec: 0.711597  v_Recall: 0.676196  v_F1: 0.693445  v_AUC: 0.912415
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.097768    reg_loss: 0.099024    l2_loss: 0.029839    loss: 0.226632
steps 12200    v_Prec: 0.722638  v_Recall: 0.670127  v_F1: 0.695393  v_AUC: 0.910991
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.092990    reg_loss: 0.099250    l2_loss: 0.029778    loss: 0.222018
steps 12400    v_Prec: 0.712079  v_Recall: 0.673641  v_F1: 0.692327  v_AUC: 0.910261
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.098321    reg_loss: 0.100135    l2_loss: 0.029802    loss: 0.228258
steps 12600    v_Prec: 0.730920  v_Recall: 0.669169  v_F1: 0.698683  v_AUC: 0.913238
steps 12600    running time 444 seconds

Early stop model F1: 0.712313
testing thre: 0.46558666
testing Prec: 0.48218311714929873
testing Recall: 0.8003888213851762
testing F1: 0.6018126004970034
testing AUC: 0.8969593722380261
overall running time 446 seconds
(0.6996396986570587, 0.6228918590522479, 0.6590389016018308, 0.8969593722380261, 0.8557066)

2019-02-24 18:34:55.864136: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:34:56.708587: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:34:56.716958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:34:56.717079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.300000 seconds
loading data in 30.190000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.668320    reg_loss: 0.645077    l2_loss: 0.013358    loss: 1.326755
steps 200    v_Prec: 0.162548  v_Recall: 1.000000  v_F1: 0.279641  v_AUC: 0.470879
steps 200    running time 40 seconds

steps 400    base_loss: 0.542289    reg_loss: 0.642468    l2_loss: 0.013302    loss: 1.198059
steps 400    v_Prec: 0.162548  v_Recall: 1.000000  v_F1: 0.279641  v_AUC: 0.487858
steps 400    running time 47 seconds

steps 600    base_loss: 0.508301    reg_loss: 0.632231    l2_loss: 0.013168    loss: 1.153699
steps 600    v_Prec: 0.163675  v_Recall: 0.970541  v_F1: 0.280111  v_AUC: 0.520199
steps 600    running time 53 seconds

steps 800    base_loss: 0.476573    reg_loss: 0.616423    l2_loss: 0.012993    loss: 1.105989
steps 800    v_Prec: 0.180419  v_Recall: 0.704527  v_F1: 0.287271  v_AUC: 0.575876
steps 800    running time 59 seconds

steps 1000    base_loss: 0.446258    reg_loss: 0.599364    l2_loss: 0.012877    loss: 1.058499
steps 1000    v_Prec: 0.274364  v_Recall: 0.449029  v_F1: 0.340609  v_AUC: 0.657409
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.429250    reg_loss: 0.582115    l2_loss: 0.012802    loss: 1.024168
steps 1200    v_Prec: 0.349368  v_Recall: 0.464039  v_F1: 0.398621  v_AUC: 0.716885
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.415062    reg_loss: 0.562254    l2_loss: 0.012759    loss: 0.990075
steps 1400    v_Prec: 0.399275  v_Recall: 0.468534  v_F1: 0.431141  v_AUC: 0.748583
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.400685    reg_loss: 0.546975    l2_loss: 0.012872    loss: 0.960532
steps 1600    v_Prec: 0.426452  v_Recall: 0.521512  v_F1: 0.469216  v_AUC: 0.773660
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.390721    reg_loss: 0.534610    l2_loss: 0.013032    loss: 0.938363
steps 1800    v_Prec: 0.480375  v_Recall: 0.521673  v_F1: 0.500173  v_AUC: 0.796588
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.377467    reg_loss: 0.524687    l2_loss: 0.013193    loss: 0.915347
steps 2000    v_Prec: 0.495937  v_Recall: 0.538931  v_F1: 0.516541  v_AUC: 0.808205
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.359900    reg_loss: 0.514902    l2_loss: 0.013447    loss: 0.888249
steps 2200    v_Prec: 0.499825  v_Recall: 0.573045  v_F1: 0.533937  v_AUC: 0.817281
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.351618    reg_loss: 0.512125    l2_loss: 0.013791    loss: 0.877534
steps 2400    v_Prec: 0.524179  v_Recall: 0.579467  v_F1: 0.550438  v_AUC: 0.829636
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.343581    reg_loss: 0.506654    l2_loss: 0.014126    loss: 0.864361
steps 2600    v_Prec: 0.552652  v_Recall: 0.573768  v_F1: 0.563012  v_AUC: 0.839554
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.340239    reg_loss: 0.503699    l2_loss: 0.014531    loss: 0.858468
steps 2800    v_Prec: 0.579292  v_Recall: 0.574410  v_F1: 0.576841  v_AUC: 0.848839
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.326138    reg_loss: 0.493721    l2_loss: 0.014980    loss: 0.834840
steps 3000    v_Prec: 0.552686  v_Recall: 0.616792  v_F1: 0.582982  v_AUC: 0.853431
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.322997    reg_loss: 0.493026    l2_loss: 0.015459    loss: 0.831482
steps 3200    v_Prec: 0.585579  v_Recall: 0.586049  v_F1: 0.585814  v_AUC: 0.857212
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.324313    reg_loss: 0.487558    l2_loss: 0.015974    loss: 0.827845
steps 3400    v_Prec: 0.584807  v_Recall: 0.621047  v_F1: 0.602382  v_AUC: 0.866494
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.316409    reg_loss: 0.482089    l2_loss: 0.016510    loss: 0.815008
steps 3600    v_Prec: 0.585040  v_Recall: 0.625943  v_F1: 0.604801  v_AUC: 0.869654
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.311205    reg_loss: 0.475903    l2_loss: 0.017148    loss: 0.804256
steps 3800    v_Prec: 0.599953  v_Recall: 0.619843  v_F1: 0.609736  v_AUC: 0.871026
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.313197    reg_loss: 0.467195    l2_loss: 0.017861    loss: 0.798254
steps 4000    v_Prec: 0.611129  v_Recall: 0.606518  v_F1: 0.608815  v_AUC: 0.872828
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.308053    reg_loss: 0.458160    l2_loss: 0.018521    loss: 0.784733
steps 4200    v_Prec: 0.584794  v_Recall: 0.658773  v_F1: 0.619583  v_AUC: 0.878677
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.302488    reg_loss: 0.450180    l2_loss: 0.019238    loss: 0.771906
steps 4400    v_Prec: 0.617473  v_Recall: 0.635415  v_F1: 0.626315  v_AUC: 0.881270
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.299432    reg_loss: 0.439908    l2_loss: 0.019993    loss: 0.759333
steps 4600    v_Prec: 0.635353  v_Recall: 0.614545  v_F1: 0.624776  v_AUC: 0.880634
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.293103    reg_loss: 0.433048    l2_loss: 0.020851    loss: 0.747003
steps 4800    v_Prec: 0.623577  v_Recall: 0.637341  v_F1: 0.630384  v_AUC: 0.883492
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.294535    reg_loss: 0.425935    l2_loss: 0.021768    loss: 0.742237
steps 5000    v_Prec: 0.614652  v_Recall: 0.637101  v_F1: 0.625675  v_AUC: 0.882257
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.295345    reg_loss: 0.417477    l2_loss: 0.022810    loss: 0.735632
steps 5200    v_Prec: 0.653882  v_Recall: 0.619923  v_F1: 0.636450  v_AUC: 0.887596
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.293883    reg_loss: 0.410678    l2_loss: 0.023599    loss: 0.728161
steps 5400    v_Prec: 0.636502  v_Recall: 0.636298  v_F1: 0.636400  v_AUC: 0.888327
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.238347    reg_loss: 0.385137    l2_loss: 0.024599    loss: 0.648082
steps 5600    v_Prec: 0.644720  v_Recall: 0.620966  v_F1: 0.632621  v_AUC: 0.884812
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.249177    reg_loss: 0.380485    l2_loss: 0.025681    loss: 0.655343
steps 5800    v_Prec: 0.639679  v_Recall: 0.626585  v_F1: 0.633064  v_AUC: 0.885342
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.237612    reg_loss: 0.373427    l2_loss: 0.026671    loss: 0.637710
steps 6000    v_Prec: 0.657279  v_Recall: 0.621930  v_F1: 0.639116  v_AUC: 0.885570
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.241928    reg_loss: 0.373034    l2_loss: 0.027487    loss: 0.642448
steps 6200    v_Prec: 0.628131  v_Recall: 0.660299  v_F1: 0.643813  v_AUC: 0.889805
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.240174    reg_loss: 0.367724    l2_loss: 0.028299    loss: 0.636197
steps 6400    v_Prec: 0.641453  v_Recall: 0.657569  v_F1: 0.649411  v_AUC: 0.892836
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.247111    reg_loss: 0.362978    l2_loss: 0.028905    loss: 0.638995
steps 6600    v_Prec: 0.669527  v_Recall: 0.645128  v_F1: 0.657101  v_AUC: 0.897623
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.232621    reg_loss: 0.353417    l2_loss: 0.029686    loss: 0.615725
steps 6800    v_Prec: 0.685123  v_Recall: 0.640633  v_F1: 0.662131  v_AUC: 0.897899
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.242412    reg_loss: 0.351923    l2_loss: 0.030222    loss: 0.624557
steps 7000    v_Prec: 0.679578  v_Recall: 0.656285  v_F1: 0.667728  v_AUC: 0.898876
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.241188    reg_loss: 0.348553    l2_loss: 0.030836    loss: 0.620577
steps 7200    v_Prec: 0.709102  v_Recall: 0.632204  v_F1: 0.668449  v_AUC: 0.903388
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.238977    reg_loss: 0.344548    l2_loss: 0.031528    loss: 0.615053
steps 7400    v_Prec: 0.678712  v_Recall: 0.652834  v_F1: 0.665521  v_AUC: 0.902087
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.232496    reg_loss: 0.336624    l2_loss: 0.032043    loss: 0.601163
steps 7600    v_Prec: 0.691280  v_Recall: 0.664312  v_F1: 0.677528  v_AUC: 0.905533
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.233895    reg_loss: 0.338579    l2_loss: 0.032712    loss: 0.605187
steps 7800    v_Prec: 0.701112  v_Recall: 0.668245  v_F1: 0.684284  v_AUC: 0.907037
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.226182    reg_loss: 0.326622    l2_loss: 0.033174    loss: 0.585978
steps 8000    v_Prec: 0.706948  v_Recall: 0.667282  v_F1: 0.686543  v_AUC: 0.907940
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.224878    reg_loss: 0.324266    l2_loss: 0.033613    loss: 0.582757
steps 8200    v_Prec: 0.710926  v_Recall: 0.669610  v_F1: 0.689649  v_AUC: 0.910582
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.232972    reg_loss: 0.322712    l2_loss: 0.034167    loss: 0.589852
steps 8400    v_Prec: 0.734417  v_Recall: 0.663911  v_F1: 0.697386  v_AUC: 0.914918
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.223442    reg_loss: 0.322531    l2_loss: 0.034552    loss: 0.580525
steps 8600    v_Prec: 0.703554  v_Recall: 0.686386  v_F1: 0.694864  v_AUC: 0.912331
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.227427    reg_loss: 0.317212    l2_loss: 0.035085    loss: 0.579725
steps 8800    v_Prec: 0.721366  v_Recall: 0.683497  v_F1: 0.701921  v_AUC: 0.914410
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.221756    reg_loss: 0.315023    l2_loss: 0.035639    loss: 0.572417
steps 9000    v_Prec: 0.737343  v_Recall: 0.665195  v_F1: 0.699413  v_AUC: 0.915870
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.220586    reg_loss: 0.309450    l2_loss: 0.035936    loss: 0.565972
steps 9200    v_Prec: 0.726363  v_Recall: 0.681410  v_F1: 0.703168  v_AUC: 0.917676
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.217294    reg_loss: 0.305345    l2_loss: 0.036398    loss: 0.559038
steps 9400    v_Prec: 0.733039  v_Recall: 0.679965  v_F1: 0.705505  v_AUC: 0.917625
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.224168    reg_loss: 0.307968    l2_loss: 0.036801    loss: 0.568937
steps 9600    v_Prec: 0.767333  v_Recall: 0.668968  v_F1: 0.714782  v_AUC: 0.921552
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.220129    reg_loss: 0.301795    l2_loss: 0.037110    loss: 0.559034
steps 9800    v_Prec: 0.746407  v_Recall: 0.692005  v_F1: 0.718177  v_AUC: 0.921946
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.224381    reg_loss: 0.298960    l2_loss: 0.037519    loss: 0.560860
steps 10000    v_Prec: 0.747667  v_Recall: 0.694493  v_F1: 0.720100  v_AUC: 0.922030
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.226321    reg_loss: 0.301826    l2_loss: 0.037852    loss: 0.565999
steps 10200    v_Prec: 0.767362  v_Recall: 0.682052  v_F1: 0.722196  v_AUC: 0.923783
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.213063    reg_loss: 0.294381    l2_loss: 0.038277    loss: 0.545720
steps 10400    v_Prec: 0.758102  v_Recall: 0.704126  v_F1: 0.730118  v_AUC: 0.925801
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.214469    reg_loss: 0.288139    l2_loss: 0.038616    loss: 0.541224
steps 10600    v_Prec: 0.751635  v_Recall: 0.701316  v_F1: 0.725604  v_AUC: 0.926229
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.209274    reg_loss: 0.285624    l2_loss: 0.039146    loss: 0.534045
steps 10800    v_Prec: 0.750872  v_Recall: 0.708139  v_F1: 0.728880  v_AUC: 0.927778
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.147129    reg_loss: 0.279097    l2_loss: 0.039287    loss: 0.465512
steps 11000    v_Prec: 0.740508  v_Recall: 0.701397  v_F1: 0.720422  v_AUC: 0.921880
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.147629    reg_loss: 0.275347    l2_loss: 0.039633    loss: 0.462610
steps 11200    v_Prec: 0.738111  v_Recall: 0.700193  v_F1: 0.718652  v_AUC: 0.920478
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.149057    reg_loss: 0.273478    l2_loss: 0.039933    loss: 0.462468
steps 11400    v_Prec: 0.760596  v_Recall: 0.675550  v_F1: 0.715555  v_AUC: 0.917868
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.150154    reg_loss: 0.272202    l2_loss: 0.040222    loss: 0.462579
steps 11600    v_Prec: 0.747065  v_Recall: 0.689677  v_F1: 0.717225  v_AUC: 0.919313
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.144709    reg_loss: 0.275893    l2_loss: 0.040461    loss: 0.461063
steps 11800    v_Prec: 0.748074  v_Recall: 0.685985  v_F1: 0.715685  v_AUC: 0.919399
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.154857    reg_loss: 0.275366    l2_loss: 0.040910    loss: 0.471133
steps 12000    v_Prec: 0.740671  v_Recall: 0.696259  v_F1: 0.717779  v_AUC: 0.918430
steps 12000    running time 424 seconds

steps 12200    base_loss: 0.154383    reg_loss: 0.272901    l2_loss: 0.041157    loss: 0.468441
steps 12200    v_Prec: 0.742823  v_Recall: 0.689517  v_F1: 0.715178  v_AUC: 0.917786
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.147304    reg_loss: 0.268708    l2_loss: 0.041324    loss: 0.457337
steps 12400    v_Prec: 0.745105  v_Recall: 0.693370  v_F1: 0.718307  v_AUC: 0.918650
steps 12400    running time 437 seconds

Early stop model F1: 0.730118
testing thre: 0.28422642
testing Prec: 0.6795710329385423
testing Recall: 0.5605346294046173
testing F1: 0.6143397432482821
testing AUC: 0.8771655509491217
overall running time 439 seconds
(0.6568047337278107, 0.5826488456865128, 0.617508434852036, 0.8771655509491217, 0.24904285)

2019-02-24 18:39:44.702680: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:39:44.984872: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:39:45.042740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:39:45.042796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.370000 seconds
loading data in 30.360000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.836573    reg_loss: 0.648002    l2_loss: 0.013393    loss: 1.497968
steps 200    v_Prec: 0.164596  v_Recall: 1.000000  v_F1: 0.282667  v_AUC: 0.469922
steps 200    running time 40 seconds

steps 400    base_loss: 0.575975    reg_loss: 0.645304    l2_loss: 0.013556    loss: 1.234834
steps 400    v_Prec: 0.164596  v_Recall: 1.000000  v_F1: 0.282667  v_AUC: 0.471989
steps 400    running time 47 seconds

steps 600    base_loss: 0.483064    reg_loss: 0.633434    l2_loss: 0.013499    loss: 1.129997
steps 600    v_Prec: 0.165669  v_Recall: 0.982481  v_F1: 0.283528  v_AUC: 0.527348
steps 600    running time 53 seconds

steps 800    base_loss: 0.466975    reg_loss: 0.613865    l2_loss: 0.013267    loss: 1.094106
steps 800    v_Prec: 0.174017  v_Recall: 0.832660  v_F1: 0.287872  v_AUC: 0.550861
steps 800    running time 60 seconds

steps 1000    base_loss: 0.459490    reg_loss: 0.584894    l2_loss: 0.013018    loss: 1.057401
steps 1000    v_Prec: 0.189766  v_Recall: 0.751962  v_F1: 0.303053  v_AUC: 0.602380
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.453242    reg_loss: 0.555257    l2_loss: 0.012878    loss: 1.021378
steps 1200    v_Prec: 0.255357  v_Recall: 0.491241  v_F1: 0.336036  v_AUC: 0.653608
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.435925    reg_loss: 0.526644    l2_loss: 0.012830    loss: 0.975399
steps 1400    v_Prec: 0.278991  v_Recall: 0.554974  v_F1: 0.371317  v_AUC: 0.697487
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.423499    reg_loss: 0.504313    l2_loss: 0.012846    loss: 0.940658
steps 1600    v_Prec: 0.338514  v_Recall: 0.556005  v_F1: 0.420819  v_AUC: 0.746118
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.397775    reg_loss: 0.482761    l2_loss: 0.013041    loss: 0.893577
steps 1800    v_Prec: 0.385078  v_Recall: 0.599366  v_F1: 0.468899  v_AUC: 0.780123
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.380137    reg_loss: 0.465317    l2_loss: 0.013277    loss: 0.858731
steps 2000    v_Prec: 0.426294  v_Recall: 0.606342  v_F1: 0.500622  v_AUC: 0.803250
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.373564    reg_loss: 0.453859    l2_loss: 0.013417    loss: 0.840839
steps 2200    v_Prec: 0.426731  v_Recall: 0.672216  v_F1: 0.522055  v_AUC: 0.818815
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.362845    reg_loss: 0.440135    l2_loss: 0.013640    loss: 0.816620
steps 2400    v_Prec: 0.467424  v_Recall: 0.646056  v_F1: 0.542411  v_AUC: 0.827717
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.356266    reg_loss: 0.426950    l2_loss: 0.013848    loss: 0.797063
steps 2600    v_Prec: 0.463669  v_Recall: 0.626239  v_F1: 0.532830  v_AUC: 0.833829
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.343848    reg_loss: 0.412142    l2_loss: 0.014001    loss: 0.769991
steps 2800    v_Prec: 0.487727  v_Recall: 0.617440  v_F1: 0.544971  v_AUC: 0.840617
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.344477    reg_loss: 0.401503    l2_loss: 0.014287    loss: 0.760267
steps 3000    v_Prec: 0.533042  v_Recall: 0.600396  v_F1: 0.564718  v_AUC: 0.844519
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.336810    reg_loss: 0.387693    l2_loss: 0.014518    loss: 0.739021
steps 3200    v_Prec: 0.541633  v_Recall: 0.586286  v_F1: 0.563076  v_AUC: 0.849417
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.331602    reg_loss: 0.376138    l2_loss: 0.014866    loss: 0.722606
steps 3400    v_Prec: 0.542773  v_Recall: 0.615616  v_F1: 0.576905  v_AUC: 0.852212
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.328133    reg_loss: 0.362257    l2_loss: 0.015138    loss: 0.705528
steps 3600    v_Prec: 0.552815  v_Recall: 0.614824  v_F1: 0.582173  v_AUC: 0.856368
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.333700    reg_loss: 0.353005    l2_loss: 0.015426    loss: 0.702132
steps 3800    v_Prec: 0.552314  v_Recall: 0.619738  v_F1: 0.584087  v_AUC: 0.856897
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.323457    reg_loss: 0.340201    l2_loss: 0.015683    loss: 0.679341
steps 4000    v_Prec: 0.566279  v_Recall: 0.606500  v_F1: 0.585700  v_AUC: 0.857700
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.322011    reg_loss: 0.328366    l2_loss: 0.016127    loss: 0.666504
steps 4200    v_Prec: 0.559134  v_Recall: 0.624732  v_F1: 0.590116  v_AUC: 0.860379
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.327781    reg_loss: 0.321505    l2_loss: 0.016430    loss: 0.665716
steps 4400    v_Prec: 0.563724  v_Recall: 0.623068  v_F1: 0.591912  v_AUC: 0.861591
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.324488    reg_loss: 0.308212    l2_loss: 0.016883    loss: 0.649583
steps 4600    v_Prec: 0.567568  v_Recall: 0.627586  v_F1: 0.596070  v_AUC: 0.864221
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.321018    reg_loss: 0.299421    l2_loss: 0.017250    loss: 0.637689
steps 4800    v_Prec: 0.573248  v_Recall: 0.631550  v_F1: 0.600988  v_AUC: 0.864196
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.320048    reg_loss: 0.288937    l2_loss: 0.017606    loss: 0.626592
steps 5000    v_Prec: 0.582306  v_Recall: 0.636544  v_F1: 0.608218  v_AUC: 0.867801
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.321394    reg_loss: 0.279446    l2_loss: 0.018014    loss: 0.618855
steps 5200    v_Prec: 0.557107  v_Recall: 0.667380  v_F1: 0.607278  v_AUC: 0.867984
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.314621    reg_loss: 0.267266    l2_loss: 0.018431    loss: 0.600318
steps 5400    v_Prec: 0.576274  v_Recall: 0.630361  v_F1: 0.602105  v_AUC: 0.865902
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.285622    reg_loss: 0.239109    l2_loss: 0.018675    loss: 0.543406
steps 5600    v_Prec: 0.547526  v_Recall: 0.657075  v_F1: 0.597319  v_AUC: 0.860338
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.287745    reg_loss: 0.237690    l2_loss: 0.018874    loss: 0.544308
steps 5800    v_Prec: 0.572639  v_Recall: 0.637733  v_F1: 0.603435  v_AUC: 0.863059
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.282801    reg_loss: 0.229482    l2_loss: 0.019102    loss: 0.531384
steps 6000    v_Prec: 0.565316  v_Recall: 0.653508  v_F1: 0.606221  v_AUC: 0.864065
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.281325    reg_loss: 0.227405    l2_loss: 0.019061    loss: 0.527791
steps 6200    v_Prec: 0.578177  v_Recall: 0.645184  v_F1: 0.609846  v_AUC: 0.863217
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.282344    reg_loss: 0.226130    l2_loss: 0.019282    loss: 0.527757
steps 6400    v_Prec: 0.584328  v_Recall: 0.644312  v_F1: 0.612856  v_AUC: 0.867278
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.281547    reg_loss: 0.220544    l2_loss: 0.019519    loss: 0.521610
steps 6600    v_Prec: 0.583525  v_Recall: 0.642965  v_F1: 0.611805  v_AUC: 0.866559
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.280459    reg_loss: 0.217671    l2_loss: 0.019590    loss: 0.517721
steps 6800    v_Prec: 0.586389  v_Recall: 0.644075  v_F1: 0.613879  v_AUC: 0.869270
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.284961    reg_loss: 0.217679    l2_loss: 0.019821    loss: 0.522460
steps 7000    v_Prec: 0.589723  v_Recall: 0.654142  v_F1: 0.620265  v_AUC: 0.870480
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.286833    reg_loss: 0.211496    l2_loss: 0.019928    loss: 0.518257
steps 7200    v_Prec: 0.582199  v_Recall: 0.658026  v_F1: 0.617795  v_AUC: 0.869119
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.287416    reg_loss: 0.210043    l2_loss: 0.020094    loss: 0.517553
steps 7400    v_Prec: 0.581490  v_Recall: 0.658423  v_F1: 0.617569  v_AUC: 0.870970
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.281002    reg_loss: 0.208215    l2_loss: 0.020157    loss: 0.509375
steps 7600    v_Prec: 0.589649  v_Recall: 0.655648  v_F1: 0.620899  v_AUC: 0.872920
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.285556    reg_loss: 0.204130    l2_loss: 0.020256    loss: 0.509942
steps 7800    v_Prec: 0.592889  v_Recall: 0.658264  v_F1: 0.623868  v_AUC: 0.874482
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.285520    reg_loss: 0.204834    l2_loss: 0.020321    loss: 0.510674
steps 8000    v_Prec: 0.607561  v_Recall: 0.645898  v_F1: 0.626143  v_AUC: 0.873952
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.288548    reg_loss: 0.199721    l2_loss: 0.020384    loss: 0.508653
steps 8200    v_Prec: 0.582871  v_Recall: 0.674356  v_F1: 0.625285  v_AUC: 0.876387
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.290566    reg_loss: 0.200294    l2_loss: 0.020425    loss: 0.511284
steps 8400    v_Prec: 0.577228  v_Recall: 0.686405  v_F1: 0.627100  v_AUC: 0.878829
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.289950    reg_loss: 0.198617    l2_loss: 0.020522    loss: 0.509088
steps 8600    v_Prec: 0.584356  v_Recall: 0.675704  v_F1: 0.626719  v_AUC: 0.875986
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.285522    reg_loss: 0.194587    l2_loss: 0.020739    loss: 0.500848
steps 8800    v_Prec: 0.591751  v_Recall: 0.668728  v_F1: 0.627889  v_AUC: 0.873889
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.282641    reg_loss: 0.193841    l2_loss: 0.020799    loss: 0.497281
steps 9000    v_Prec: 0.603703  v_Recall: 0.648831  v_F1: 0.625454  v_AUC: 0.875820
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.288518    reg_loss: 0.193999    l2_loss: 0.020687    loss: 0.503204
steps 9200    v_Prec: 0.605865  v_Recall: 0.646928  v_F1: 0.625724  v_AUC: 0.879585
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.276582    reg_loss: 0.187569    l2_loss: 0.020705    loss: 0.484855
steps 9400    v_Prec: 0.604822  v_Recall: 0.660246  v_F1: 0.631320  v_AUC: 0.878119
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.286877    reg_loss: 0.188946    l2_loss: 0.020951    loss: 0.496774
steps 9600    v_Prec: 0.625868  v_Recall: 0.642885  v_F1: 0.634263  v_AUC: 0.879343
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.279838    reg_loss: 0.186084    l2_loss: 0.020885    loss: 0.486807
steps 9800    v_Prec: 0.591074  v_Recall: 0.682442  v_F1: 0.633481  v_AUC: 0.880114
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.282656    reg_loss: 0.185464    l2_loss: 0.020949    loss: 0.489069
steps 10000    v_Prec: 0.586851  v_Recall: 0.692033  v_F1: 0.635117  v_AUC: 0.880680
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.278878    reg_loss: 0.180255    l2_loss: 0.021050    loss: 0.480183
steps 10200    v_Prec: 0.609799  v_Recall: 0.661038  v_F1: 0.634386  v_AUC: 0.880733
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.288686    reg_loss: 0.185497    l2_loss: 0.021043    loss: 0.495226
steps 10400    v_Prec: 0.621304  v_Recall: 0.644550  v_F1: 0.632713  v_AUC: 0.882056
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.287824    reg_loss: 0.184527    l2_loss: 0.021018    loss: 0.493368
steps 10600    v_Prec: 0.585966  v_Recall: 0.691082  v_F1: 0.634198  v_AUC: 0.883256
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.281627    reg_loss: 0.178801    l2_loss: 0.020992    loss: 0.481420
steps 10800    v_Prec: 0.624169  v_Recall: 0.654697  v_F1: 0.639068  v_AUC: 0.881698
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.241766    reg_loss: 0.166497    l2_loss: 0.020965    loss: 0.429228
steps 11000    v_Prec: 0.630603  v_Recall: 0.646849  v_F1: 0.638623  v_AUC: 0.881819
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.238315    reg_loss: 0.165389    l2_loss: 0.021045    loss: 0.424749
steps 11200    v_Prec: 0.625643  v_Recall: 0.636306  v_F1: 0.630929  v_AUC: 0.878899
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.240837    reg_loss: 0.166658    l2_loss: 0.021013    loss: 0.428508
steps 11400    v_Prec: 0.609802  v_Recall: 0.662782  v_F1: 0.635190  v_AUC: 0.879307
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.241115    reg_loss: 0.168668    l2_loss: 0.021096    loss: 0.430879
steps 11600    v_Prec: 0.593539  v_Recall: 0.683076  v_F1: 0.635168  v_AUC: 0.878804
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.241429    reg_loss: 0.170037    l2_loss: 0.021100    loss: 0.432565
steps 11800    v_Prec: 0.602545  v_Recall: 0.671899  v_F1: 0.635335  v_AUC: 0.879906
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.250560    reg_loss: 0.171539    l2_loss: 0.020988    loss: 0.443087
steps 12000    v_Prec: 0.620465  v_Recall: 0.656124  v_F1: 0.637796  v_AUC: 0.879461
steps 12000    running time 424 seconds

steps 12200    base_loss: 0.243168    reg_loss: 0.168245    l2_loss: 0.021077    loss: 0.432489
steps 12200    v_Prec: 0.642312  v_Recall: 0.634166  v_F1: 0.638213  v_AUC: 0.881285
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.245262    reg_loss: 0.168989    l2_loss: 0.020852    loss: 0.435103
steps 12400    v_Prec: 0.626835  v_Recall: 0.643282  v_F1: 0.634952  v_AUC: 0.880827
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.244699    reg_loss: 0.168443    l2_loss: 0.020825    loss: 0.433967
steps 12600    v_Prec: 0.623922  v_Recall: 0.653746  v_F1: 0.638486  v_AUC: 0.880531
steps 12600    running time 443 seconds

steps 12800    base_loss: 0.245617    reg_loss: 0.168726    l2_loss: 0.020939    loss: 0.435281
steps 12800    v_Prec: 0.589129  v_Recall: 0.691637  v_F1: 0.636281  v_AUC: 0.880454
steps 12800    running time 449 seconds

Early stop model F1: 0.639068
testing thre: 0.3953624
testing Prec: 0.3934537929642154
testing Recall: 0.757764277035237
testing F1: 0.5179648178601685
testing AUC: 0.83100841772645
overall running time 452 seconds
(0.49413932337606337, 0.612636695018226, 0.5470445273847756, 0.83100841772645, 0.67285746)

2019-02-24 18:44:39.381871: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:44:39.634369: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:44:39.635306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:44:39.635341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.780000 seconds
loading data in 30.990000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.744088    reg_loss: 0.645764    l2_loss: 0.013356    loss: 1.403208
steps 200    v_Prec: 0.162183  v_Recall: 1.000000  v_F1: 0.279100  v_AUC: 0.457260
steps 200    running time 41 seconds

steps 400    base_loss: 0.536104    reg_loss: 0.640126    l2_loss: 0.013347    loss: 1.189578
steps 400    v_Prec: 0.162183  v_Recall: 1.000000  v_F1: 0.279100  v_AUC: 0.457396
steps 400    running time 48 seconds

steps 600    base_loss: 0.485463    reg_loss: 0.625424    l2_loss: 0.013296    loss: 1.124184
steps 600    v_Prec: 0.162187  v_Recall: 1.000000  v_F1: 0.279106  v_AUC: 0.466157
steps 600    running time 54 seconds

steps 800    base_loss: 0.472421    reg_loss: 0.602909    l2_loss: 0.013074    loss: 1.088404
steps 800    v_Prec: 0.162207  v_Recall: 0.999839  v_F1: 0.279130  v_AUC: 0.497015
steps 800    running time 61 seconds

steps 1000    base_loss: 0.467659    reg_loss: 0.575330    l2_loss: 0.012855    loss: 1.055843
steps 1000    v_Prec: 0.171969  v_Recall: 0.791874  v_F1: 0.282573  v_AUC: 0.563401
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.456620    reg_loss: 0.544974    l2_loss: 0.012706    loss: 1.014300
steps 1200    v_Prec: 0.271325  v_Recall: 0.496702  v_F1: 0.350945  v_AUC: 0.662649
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.443052    reg_loss: 0.521146    l2_loss: 0.012618    loss: 0.976816
steps 1400    v_Prec: 0.295521  v_Recall: 0.543041  v_F1: 0.382751  v_AUC: 0.710161
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.424547    reg_loss: 0.499798    l2_loss: 0.012711    loss: 0.937057
steps 1600    v_Prec: 0.345382  v_Recall: 0.509654  v_F1: 0.411738  v_AUC: 0.741168
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.410950    reg_loss: 0.483800    l2_loss: 0.012744    loss: 0.907494
steps 1800    v_Prec: 0.323295  v_Recall: 0.565728  v_F1: 0.411457  v_AUC: 0.751695
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.402271    reg_loss: 0.471992    l2_loss: 0.012963    loss: 0.887226
steps 2000    v_Prec: 0.384054  v_Recall: 0.592920  v_F1: 0.466161  v_AUC: 0.784241
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.389333    reg_loss: 0.458617    l2_loss: 0.013208    loss: 0.861157
steps 2200    v_Prec: 0.445025  v_Recall: 0.582542  v_F1: 0.504582  v_AUC: 0.804149
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.377293    reg_loss: 0.447843    l2_loss: 0.013511    loss: 0.838646
steps 2400    v_Prec: 0.470955  v_Recall: 0.589622  v_F1: 0.523650  v_AUC: 0.814946
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.370781    reg_loss: 0.434501    l2_loss: 0.013811    loss: 0.819094
steps 2600    v_Prec: 0.554613  v_Recall: 0.546983  v_F1: 0.550772  v_AUC: 0.827349
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.362517    reg_loss: 0.423102    l2_loss: 0.014038    loss: 0.799658
steps 2800    v_Prec: 0.539180  v_Recall: 0.575704  v_F1: 0.556844  v_AUC: 0.833210
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.352956    reg_loss: 0.408881    l2_loss: 0.014307    loss: 0.776144
steps 3000    v_Prec: 0.555347  v_Recall: 0.569912  v_F1: 0.562535  v_AUC: 0.836723
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.357191    reg_loss: 0.396824    l2_loss: 0.014553    loss: 0.768568
steps 3200    v_Prec: 0.513757  v_Recall: 0.632422  v_F1: 0.566947  v_AUC: 0.841222
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.351129    reg_loss: 0.384292    l2_loss: 0.014796    loss: 0.750217
steps 3400    v_Prec: 0.547237  v_Recall: 0.601609  v_F1: 0.573137  v_AUC: 0.844876
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.344992    reg_loss: 0.370907    l2_loss: 0.015007    loss: 0.730906
steps 3600    v_Prec: 0.492713  v_Recall: 0.671842  v_F1: 0.568501  v_AUC: 0.848071
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.347288    reg_loss: 0.362998    l2_loss: 0.015335    loss: 0.725621
steps 3800    v_Prec: 0.505590  v_Recall: 0.654867  v_F1: 0.570627  v_AUC: 0.849327
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.343681    reg_loss: 0.348450    l2_loss: 0.015714    loss: 0.707845
steps 4000    v_Prec: 0.489245  v_Recall: 0.660579  v_F1: 0.562147  v_AUC: 0.851574
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.343536    reg_loss: 0.337165    l2_loss: 0.015989    loss: 0.696690
steps 4200    v_Prec: 0.514232  v_Recall: 0.636605  v_F1: 0.568912  v_AUC: 0.854560
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.331107    reg_loss: 0.323441    l2_loss: 0.016451    loss: 0.670999
steps 4400    v_Prec: 0.544597  v_Recall: 0.603701  v_F1: 0.572628  v_AUC: 0.856636
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.335433    reg_loss: 0.313009    l2_loss: 0.016874    loss: 0.665316
steps 4600    v_Prec: 0.547751  v_Recall: 0.614159  v_F1: 0.579057  v_AUC: 0.859441
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.335774    reg_loss: 0.304152    l2_loss: 0.017280    loss: 0.657206
steps 4800    v_Prec: 0.526374  v_Recall: 0.655109  v_F1: 0.583728  v_AUC: 0.860907
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.332116    reg_loss: 0.294468    l2_loss: 0.017724    loss: 0.644308
steps 5000    v_Prec: 0.535377  v_Recall: 0.642237  v_F1: 0.583958  v_AUC: 0.863060
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.338612    reg_loss: 0.289509    l2_loss: 0.018133    loss: 0.646254
steps 5200    v_Prec: 0.517042  v_Recall: 0.662671  v_F1: 0.580868  v_AUC: 0.861770
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.332658    reg_loss: 0.277450    l2_loss: 0.018576    loss: 0.628684
steps 5400    v_Prec: 0.534487  v_Recall: 0.655833  v_F1: 0.588975  v_AUC: 0.865494
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.294454    reg_loss: 0.245755    l2_loss: 0.019099    loss: 0.559308
steps 5600    v_Prec: 0.538863  v_Recall: 0.648673  v_F1: 0.588691  v_AUC: 0.863586
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.305673    reg_loss: 0.242233    l2_loss: 0.019105    loss: 0.567011
steps 5800    v_Prec: 0.544779  v_Recall: 0.648431  v_F1: 0.592103  v_AUC: 0.858816
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.300181    reg_loss: 0.235255    l2_loss: 0.019222    loss: 0.554658
steps 6000    v_Prec: 0.521774  v_Recall: 0.676669  v_F1: 0.589212  v_AUC: 0.859371
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.306671    reg_loss: 0.234250    l2_loss: 0.019486    loss: 0.560407
steps 6200    v_Prec: 0.529660  v_Recall: 0.676669  v_F1: 0.594207  v_AUC: 0.863248
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.303654    reg_loss: 0.231340    l2_loss: 0.019531    loss: 0.554525
steps 6400    v_Prec: 0.537593  v_Recall: 0.674175  v_F1: 0.598187  v_AUC: 0.865733
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.302328    reg_loss: 0.225187    l2_loss: 0.019772    loss: 0.547287
steps 6600    v_Prec: 0.546787  v_Recall: 0.657200  v_F1: 0.596931  v_AUC: 0.867851
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.302143    reg_loss: 0.222570    l2_loss: 0.019832    loss: 0.544546
steps 6800    v_Prec: 0.537375  v_Recall: 0.673210  v_F1: 0.597672  v_AUC: 0.868665
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.295318    reg_loss: 0.215742    l2_loss: 0.020032    loss: 0.531092
steps 7000    v_Prec: 0.555945  v_Recall: 0.663154  v_F1: 0.604835  v_AUC: 0.870784
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.306391    reg_loss: 0.216026    l2_loss: 0.020287    loss: 0.542705
steps 7200    v_Prec: 0.552018  v_Recall: 0.662510  v_F1: 0.602238  v_AUC: 0.868998
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.300851    reg_loss: 0.212638    l2_loss: 0.020357    loss: 0.533845
steps 7400    v_Prec: 0.547631  v_Recall: 0.686323  v_F1: 0.609183  v_AUC: 0.870991
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.303258    reg_loss: 0.209115    l2_loss: 0.020394    loss: 0.532767
steps 7600    v_Prec: 0.559488  v_Recall: 0.667739  v_F1: 0.608839  v_AUC: 0.868825
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.303697    reg_loss: 0.207144    l2_loss: 0.020394    loss: 0.531236
steps 7800    v_Prec: 0.559079  v_Recall: 0.663878  v_F1: 0.606988  v_AUC: 0.870390
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.299573    reg_loss: 0.201270    l2_loss: 0.020365    loss: 0.521208
steps 8000    v_Prec: 0.551001  v_Recall: 0.682301  v_F1: 0.609661  v_AUC: 0.875507
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.297084    reg_loss: 0.198897    l2_loss: 0.020481    loss: 0.516462
steps 8200    v_Prec: 0.573124  v_Recall: 0.664280  v_F1: 0.615344  v_AUC: 0.874978
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.298840    reg_loss: 0.198961    l2_loss: 0.020580    loss: 0.518381
steps 8400    v_Prec: 0.578760  v_Recall: 0.653258  v_F1: 0.613757  v_AUC: 0.874444
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.298136    reg_loss: 0.194291    l2_loss: 0.020697    loss: 0.513125
steps 8600    v_Prec: 0.572160  v_Recall: 0.665004  v_F1: 0.615098  v_AUC: 0.873664
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.298864    reg_loss: 0.192724    l2_loss: 0.020540    loss: 0.512128
steps 8800    v_Prec: 0.564725  v_Recall: 0.669992  v_F1: 0.612871  v_AUC: 0.875287
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.302822    reg_loss: 0.192889    l2_loss: 0.020483    loss: 0.516194
steps 9000    v_Prec: 0.582909  v_Recall: 0.662912  v_F1: 0.620342  v_AUC: 0.875719
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.297505    reg_loss: 0.189160    l2_loss: 0.020472    loss: 0.507136
steps 9200    v_Prec: 0.585049  v_Recall: 0.662993  v_F1: 0.621587  v_AUC: 0.877792
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.298353    reg_loss: 0.185927    l2_loss: 0.020590    loss: 0.504869
steps 9400    v_Prec: 0.577037  v_Recall: 0.671601  v_F1: 0.620738  v_AUC: 0.878902
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.299477    reg_loss: 0.185037    l2_loss: 0.020689    loss: 0.505203
steps 9600    v_Prec: 0.570801  v_Recall: 0.679405  v_F1: 0.620386  v_AUC: 0.880214
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.307959    reg_loss: 0.188742    l2_loss: 0.020568    loss: 0.517269
steps 9800    v_Prec: 0.556930  v_Recall: 0.702816  v_F1: 0.621426  v_AUC: 0.879779
steps 9800    running time 354 seconds

steps 10000    base_loss: 0.300524    reg_loss: 0.182928    l2_loss: 0.020557    loss: 0.504009
steps 10000    v_Prec: 0.568927  v_Recall: 0.695253  v_F1: 0.625778  v_AUC: 0.880492
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.289344    reg_loss: 0.179096    l2_loss: 0.020543    loss: 0.488983
steps 10200    v_Prec: 0.573340  v_Recall: 0.696219  v_F1: 0.628833  v_AUC: 0.880450
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.300277    reg_loss: 0.180007    l2_loss: 0.020556    loss: 0.500841
steps 10400    v_Prec: 0.572407  v_Recall: 0.692599  v_F1: 0.626793  v_AUC: 0.881322
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.292231    reg_loss: 0.177161    l2_loss: 0.020617    loss: 0.490009
steps 10600    v_Prec: 0.590542  v_Recall: 0.677152  v_F1: 0.630889  v_AUC: 0.881345
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.288189    reg_loss: 0.173234    l2_loss: 0.020500    loss: 0.481924
steps 10800    v_Prec: 0.585712  v_Recall: 0.676750  v_F1: 0.627949  v_AUC: 0.874789
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.252150    reg_loss: 0.160838    l2_loss: 0.020609    loss: 0.433596
steps 11000    v_Prec: 0.579183  v_Recall: 0.675543  v_F1: 0.623663  v_AUC: 0.877222
steps 11000    running time 392 seconds

steps 11200    base_loss: 0.252523    reg_loss: 0.163755    l2_loss: 0.020455    loss: 0.436734
steps 11200    v_Prec: 0.545776  v_Recall: 0.719389  v_F1: 0.620671  v_AUC: 0.877983
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.257148    reg_loss: 0.166588    l2_loss: 0.020461    loss: 0.444197
steps 11400    v_Prec: 0.580019  v_Recall: 0.673532  v_F1: 0.623288  v_AUC: 0.875356
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.248077    reg_loss: 0.160360    l2_loss: 0.020304    loss: 0.428742
steps 11600    v_Prec: 0.573486  v_Recall: 0.682462  v_F1: 0.623246  v_AUC: 0.877026
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.252601    reg_loss: 0.164431    l2_loss: 0.020163    loss: 0.437195
steps 11800    v_Prec: 0.569531  v_Recall: 0.686323  v_F1: 0.622496  v_AUC: 0.873570
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.259768    reg_loss: 0.166088    l2_loss: 0.020110    loss: 0.445965
steps 12000    v_Prec: 0.570777  v_Recall: 0.684795  v_F1: 0.622609  v_AUC: 0.876393
steps 12000    running time 424 seconds

steps 12200    base_loss: 0.256316    reg_loss: 0.164276    l2_loss: 0.020037    loss: 0.440629
steps 12200    v_Prec: 0.563814  v_Recall: 0.701207  v_F1: 0.625049  v_AUC: 0.876705
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.259359    reg_loss: 0.168439    l2_loss: 0.020095    loss: 0.447893
steps 12400    v_Prec: 0.566632  v_Recall: 0.699195  v_F1: 0.625972  v_AUC: 0.877955
steps 12400    running time 436 seconds

steps 12600    base_loss: 0.263790    reg_loss: 0.165481    l2_loss: 0.019954    loss: 0.449226
steps 12600    v_Prec: 0.557544  v_Recall: 0.701931  v_F1: 0.621461  v_AUC: 0.880439
steps 12600    running time 442 seconds

Early stop model F1: 0.630889
testing thre: 0.31924427
testing Prec: 0.38881470829909615
testing Recall: 0.7359416767922236
testing F1: 0.5088123120348124
testing AUC: 0.8161201327183099
overall running time 445 seconds
(0.47645892461412853, 0.5956257594167679, 0.529419388284085, 0.8161201327183099, 0.5291039)

2019-02-24 18:49:29.402054: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:49:30.565639: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:49:30.685100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:49:30.685181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.490000 seconds
loading data in 30.670000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.087421    reg_loss: 0.647743    l2_loss: 0.013322    loss: 1.748486
steps 200    v_Prec: 0.165314  v_Recall: 0.998658  v_F1: 0.283670  v_AUC: 0.515638
steps 200    running time 41 seconds

steps 400    base_loss: 0.731485    reg_loss: 0.642987    l2_loss: 0.013077    loss: 1.387548
steps 400    v_Prec: 0.168546  v_Recall: 0.933286  v_F1: 0.285528  v_AUC: 0.535852
steps 400    running time 48 seconds

steps 600    base_loss: 0.509802    reg_loss: 0.631125    l2_loss: 0.012818    loss: 1.153745
steps 600    v_Prec: 0.190805  v_Recall: 0.653719  v_F1: 0.295393  v_AUC: 0.571991
steps 600    running time 54 seconds

steps 800    base_loss: 0.467323    reg_loss: 0.612307    l2_loss: 0.012632    loss: 1.092261
steps 800    v_Prec: 0.222439  v_Recall: 0.548476  v_F1: 0.316514  v_AUC: 0.610181
steps 800    running time 61 seconds

steps 1000    base_loss: 0.459256    reg_loss: 0.591359    l2_loss: 0.012550    loss: 1.063164
steps 1000    v_Prec: 0.291154  v_Recall: 0.421996  v_F1: 0.344572  v_AUC: 0.648530
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.432486    reg_loss: 0.565268    l2_loss: 0.012392    loss: 1.010146
steps 1200    v_Prec: 0.352446  v_Recall: 0.429970  v_F1: 0.387368  v_AUC: 0.685944
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.418824    reg_loss: 0.544243    l2_loss: 0.012345    loss: 0.975412
steps 1400    v_Prec: 0.399877  v_Recall: 0.463209  v_F1: 0.429219  v_AUC: 0.724240
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.393728    reg_loss: 0.522304    l2_loss: 0.012306    loss: 0.928338
steps 1600    v_Prec: 0.437933  v_Recall: 0.494394  v_F1: 0.464454  v_AUC: 0.753670
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.381245    reg_loss: 0.509519    l2_loss: 0.012396    loss: 0.903160
steps 1800    v_Prec: 0.482415  v_Recall: 0.497079  v_F1: 0.489637  v_AUC: 0.778334
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.369213    reg_loss: 0.496109    l2_loss: 0.012439    loss: 0.877761
steps 2000    v_Prec: 0.478735  v_Recall: 0.551003  v_F1: 0.512333  v_AUC: 0.796769
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.354690    reg_loss: 0.482727    l2_loss: 0.012485    loss: 0.849903
steps 2200    v_Prec: 0.526437  v_Recall: 0.522738  v_F1: 0.524581  v_AUC: 0.808028
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.349773    reg_loss: 0.470889    l2_loss: 0.012604    loss: 0.833267
steps 2400    v_Prec: 0.535095  v_Recall: 0.548318  v_F1: 0.541626  v_AUC: 0.815414
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.346584    reg_loss: 0.463452    l2_loss: 0.012643    loss: 0.822679
steps 2600    v_Prec: 0.545005  v_Recall: 0.557398  v_F1: 0.551132  v_AUC: 0.820843
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.339088    reg_loss: 0.447950    l2_loss: 0.012735    loss: 0.799774
steps 2800    v_Prec: 0.532842  v_Recall: 0.570662  v_F1: 0.551104  v_AUC: 0.825688
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.338680    reg_loss: 0.434596    l2_loss: 0.012820    loss: 0.786097
steps 3000    v_Prec: 0.540857  v_Recall: 0.573267  v_F1: 0.556590  v_AUC: 0.830701
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.338481    reg_loss: 0.424905    l2_loss: 0.012921    loss: 0.776306
steps 3200    v_Prec: 0.522755  v_Recall: 0.607611  v_F1: 0.561998  v_AUC: 0.835129
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.339323    reg_loss: 0.415890    l2_loss: 0.013116    loss: 0.768330
steps 3400    v_Prec: 0.536701  v_Recall: 0.599795  v_F1: 0.566496  v_AUC: 0.838296
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.322928    reg_loss: 0.400109    l2_loss: 0.013332    loss: 0.736369
steps 3600    v_Prec: 0.558857  v_Recall: 0.574609  v_F1: 0.566624  v_AUC: 0.840823
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.335956    reg_loss: 0.392617    l2_loss: 0.013615    loss: 0.742188
steps 3800    v_Prec: 0.534398  v_Recall: 0.615743  v_F1: 0.572194  v_AUC: 0.846857
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.331847    reg_loss: 0.380843    l2_loss: 0.013942    loss: 0.726631
steps 4000    v_Prec: 0.553245  v_Recall: 0.611164  v_F1: 0.580764  v_AUC: 0.850507
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.332677    reg_loss: 0.367532    l2_loss: 0.014167    loss: 0.714375
steps 4200    v_Prec: 0.566058  v_Recall: 0.614638  v_F1: 0.589349  v_AUC: 0.854098
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.324769    reg_loss: 0.353558    l2_loss: 0.014493    loss: 0.692820
steps 4400    v_Prec: 0.574707  v_Recall: 0.604927  v_F1: 0.589430  v_AUC: 0.856532
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.316338    reg_loss: 0.340521    l2_loss: 0.014915    loss: 0.671773
steps 4600    v_Prec: 0.559705  v_Recall: 0.628375  v_F1: 0.592055  v_AUC: 0.858714
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.323611    reg_loss: 0.330772    l2_loss: 0.015287    loss: 0.669671
steps 4800    v_Prec: 0.547697  v_Recall: 0.659087  v_F1: 0.598251  v_AUC: 0.862630
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.314601    reg_loss: 0.319640    l2_loss: 0.015685    loss: 0.649926
steps 5000    v_Prec: 0.554253  v_Recall: 0.660587  v_F1: 0.602766  v_AUC: 0.863614
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.316136    reg_loss: 0.308861    l2_loss: 0.016191    loss: 0.641188
steps 5200    v_Prec: 0.577360  v_Recall: 0.630191  v_F1: 0.602620  v_AUC: 0.864284
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.315318    reg_loss: 0.297485    l2_loss: 0.016593    loss: 0.629396
steps 5400    v_Prec: 0.576082  v_Recall: 0.632481  v_F1: 0.602966  v_AUC: 0.865606
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.272494    reg_loss: 0.273247    l2_loss: 0.016837    loss: 0.562578
steps 5600    v_Prec: 0.571817  v_Recall: 0.630823  v_F1: 0.599872  v_AUC: 0.864938
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.274899    reg_loss: 0.272388    l2_loss: 0.016971    loss: 0.564258
steps 5800    v_Prec: 0.564597  v_Recall: 0.649692  v_F1: 0.604163  v_AUC: 0.865599
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.277674    reg_loss: 0.266300    l2_loss: 0.017291    loss: 0.561266
steps 6000    v_Prec: 0.579467  v_Recall: 0.639902  v_F1: 0.608187  v_AUC: 0.868402
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.269487    reg_loss: 0.256140    l2_loss: 0.017559    loss: 0.543187
steps 6200    v_Prec: 0.577923  v_Recall: 0.640297  v_F1: 0.607513  v_AUC: 0.865812
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.273504    reg_loss: 0.254254    l2_loss: 0.017837    loss: 0.545595
steps 6400    v_Prec: 0.564130  v_Recall: 0.657350  v_F1: 0.607183  v_AUC: 0.868879
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.272800    reg_loss: 0.244557    l2_loss: 0.017940    loss: 0.535298
steps 6600    v_Prec: 0.570671  v_Recall: 0.654429  v_F1: 0.609687  v_AUC: 0.869319
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.275354    reg_loss: 0.243050    l2_loss: 0.018067    loss: 0.536470
steps 6800    v_Prec: 0.566001  v_Recall: 0.666904  v_F1: 0.612323  v_AUC: 0.871657
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.279126    reg_loss: 0.239446    l2_loss: 0.018197    loss: 0.536770
steps 7000    v_Prec: 0.578771  v_Recall: 0.653482  v_F1: 0.613861  v_AUC: 0.873219
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.279147    reg_loss: 0.237328    l2_loss: 0.018380    loss: 0.534855
steps 7200    v_Prec: 0.577006  v_Recall: 0.652219  v_F1: 0.612311  v_AUC: 0.872274
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.275115    reg_loss: 0.229071    l2_loss: 0.018596    loss: 0.522782
steps 7400    v_Prec: 0.567151  v_Recall: 0.674483  v_F1: 0.616178  v_AUC: 0.873899
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.273834    reg_loss: 0.223284    l2_loss: 0.018834    loss: 0.515952
steps 7600    v_Prec: 0.557095  v_Recall: 0.688694  v_F1: 0.615944  v_AUC: 0.875249
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.274533    reg_loss: 0.219337    l2_loss: 0.018972    loss: 0.512841
steps 7800    v_Prec: 0.570951  v_Recall: 0.674088  v_F1: 0.618248  v_AUC: 0.876110
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.276953    reg_loss: 0.220474    l2_loss: 0.019243    loss: 0.516670
steps 8000    v_Prec: 0.591531  v_Recall: 0.655140  v_F1: 0.621713  v_AUC: 0.878386
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.283366    reg_loss: 0.218782    l2_loss: 0.019356    loss: 0.521504
steps 8200    v_Prec: 0.585868  v_Recall: 0.663114  v_F1: 0.622102  v_AUC: 0.878324
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.282100    reg_loss: 0.215151    l2_loss: 0.019520    loss: 0.516771
steps 8400    v_Prec: 0.569628  v_Recall: 0.681431  v_F1: 0.620533  v_AUC: 0.879942
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.270887    reg_loss: 0.209544    l2_loss: 0.019752    loss: 0.500183
steps 8600    v_Prec: 0.588338  v_Recall: 0.665956  v_F1: 0.624745  v_AUC: 0.881254
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.283852    reg_loss: 0.209583    l2_loss: 0.019952    loss: 0.513387
steps 8800    v_Prec: 0.567923  v_Recall: 0.696116  v_F1: 0.625519  v_AUC: 0.882321
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.279279    reg_loss: 0.206957    l2_loss: 0.020111    loss: 0.506347
steps 9000    v_Prec: 0.599527  v_Recall: 0.660587  v_F1: 0.628578  v_AUC: 0.882224
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.280545    reg_loss: 0.202754    l2_loss: 0.020321    loss: 0.503621
steps 9200    v_Prec: 0.594277  v_Recall: 0.667377  v_F1: 0.628710  v_AUC: 0.885099
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.277656    reg_loss: 0.198626    l2_loss: 0.020550    loss: 0.496832
steps 9400    v_Prec: 0.588892  v_Recall: 0.670535  v_F1: 0.627067  v_AUC: 0.884806
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.276878    reg_loss: 0.198495    l2_loss: 0.020630    loss: 0.496002
steps 9600    v_Prec: 0.600458  v_Recall: 0.663035  v_F1: 0.630197  v_AUC: 0.886408
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.279254    reg_loss: 0.198090    l2_loss: 0.020659    loss: 0.498003
steps 9800    v_Prec: 0.588456  v_Recall: 0.682536  v_F1: 0.632014  v_AUC: 0.885946
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.276893    reg_loss: 0.192368    l2_loss: 0.020796    loss: 0.490057
steps 10000    v_Prec: 0.597011  v_Recall: 0.671720  v_F1: 0.632166  v_AUC: 0.887963
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.275889    reg_loss: 0.192630    l2_loss: 0.021087    loss: 0.489606
steps 10200    v_Prec: 0.613462  v_Recall: 0.654824  v_F1: 0.633468  v_AUC: 0.889019
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.275020    reg_loss: 0.191374    l2_loss: 0.021163    loss: 0.487556
steps 10400    v_Prec: 0.576906  v_Recall: 0.702116  v_F1: 0.633382  v_AUC: 0.890095
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.273350    reg_loss: 0.190497    l2_loss: 0.021208    loss: 0.485056
steps 10600    v_Prec: 0.589300  v_Recall: 0.683562  v_F1: 0.632941  v_AUC: 0.889416
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.273874    reg_loss: 0.189412    l2_loss: 0.021411    loss: 0.484697
steps 10800    v_Prec: 0.578556  v_Recall: 0.700379  v_F1: 0.633665  v_AUC: 0.891753
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.207802    reg_loss: 0.174954    l2_loss: 0.021352    loss: 0.404108
steps 11000    v_Prec: 0.568270  v_Recall: 0.695958  v_F1: 0.625665  v_AUC: 0.885410
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.216630    reg_loss: 0.181120    l2_loss: 0.021045    loss: 0.418795
steps 11200    v_Prec: 0.545997  v_Recall: 0.708037  v_F1: 0.616548  v_AUC: 0.882317
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.208307    reg_loss: 0.177941    l2_loss: 0.020876    loss: 0.407124
steps 11400    v_Prec: 0.559918  v_Recall: 0.691300  v_F1: 0.618711  v_AUC: 0.881478
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.207486    reg_loss: 0.178834    l2_loss: 0.020830    loss: 0.407150
steps 11600    v_Prec: 0.560212  v_Recall: 0.675430  v_F1: 0.612449  v_AUC: 0.879767
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.212083    reg_loss: 0.180865    l2_loss: 0.020711    loss: 0.413659
steps 11800    v_Prec: 0.566939  v_Recall: 0.675036  v_F1: 0.616283  v_AUC: 0.882561
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.219858    reg_loss: 0.184782    l2_loss: 0.020713    loss: 0.425354
steps 12000    v_Prec: 0.548369  v_Recall: 0.678036  v_F1: 0.606347  v_AUC: 0.878510
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.216662    reg_loss: 0.182376    l2_loss: 0.020769    loss: 0.419806
steps 12200    v_Prec: 0.536832  v_Recall: 0.688141  v_F1: 0.603142  v_AUC: 0.876500
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.222238    reg_loss: 0.183437    l2_loss: 0.020794    loss: 0.426469
steps 12400    v_Prec: 0.549442  v_Recall: 0.680404  v_F1: 0.607950  v_AUC: 0.878867
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.219276    reg_loss: 0.180742    l2_loss: 0.020900    loss: 0.420919
steps 12600    v_Prec: 0.533962  v_Recall: 0.711274  v_F1: 0.609994  v_AUC: 0.881131
steps 12600    running time 443 seconds

steps 12800    base_loss: 0.210804    reg_loss: 0.176973    l2_loss: 0.021019    loss: 0.408797
steps 12800    v_Prec: 0.554531  v_Recall: 0.697695  v_F1: 0.617929  v_AUC: 0.884976
steps 12800    running time 449 seconds

Early stop model F1: 0.633665
testing thre: 0.27008754
testing Prec: 0.38318484125988206
testing Recall: 0.7420656136087485
testing F1: 0.5053955643826546
testing AUC: 0.8342378620896074
overall running time 452 seconds
(0.4983324995831249, 0.580996354799514, 0.5364988892130242, 0.8342378620896074, 0.6260523)

2019-02-24 18:54:27.881375: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:54:28.727094: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:54:28.727994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:54:28.728032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.290000 seconds
loading data in 30.470000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.836861    reg_loss: 0.647615    l2_loss: 0.013280    loss: 1.497756
steps 200    v_Prec: 0.164362  v_Recall: 1.000000  v_F1: 0.282321  v_AUC: 0.490608
steps 200    running time 40 seconds

steps 400    base_loss: 0.604224    reg_loss: 0.643752    l2_loss: 0.013030    loss: 1.261006
steps 400    v_Prec: 0.164372  v_Recall: 0.999921  v_F1: 0.282333  v_AUC: 0.468294
steps 400    running time 47 seconds

steps 600    base_loss: 0.491228    reg_loss: 0.634864    l2_loss: 0.012897    loss: 1.138989
steps 600    v_Prec: 0.164368  v_Recall: 1.000000  v_F1: 0.282330  v_AUC: 0.478308
steps 600    running time 54 seconds

steps 800    base_loss: 0.484765    reg_loss: 0.616117    l2_loss: 0.012766    loss: 1.113648
steps 800    v_Prec: 0.164379  v_Recall: 1.000000  v_F1: 0.282346  v_AUC: 0.493230
steps 800    running time 60 seconds

steps 1000    base_loss: 0.470238    reg_loss: 0.592897    l2_loss: 0.012659    loss: 1.075795
steps 1000    v_Prec: 0.172262  v_Recall: 0.803286  v_F1: 0.283688  v_AUC: 0.559123
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.451337    reg_loss: 0.568552    l2_loss: 0.012535    loss: 1.032424
steps 1200    v_Prec: 0.273323  v_Recall: 0.470509  v_F1: 0.345779  v_AUC: 0.651749
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.437773    reg_loss: 0.544732    l2_loss: 0.012520    loss: 0.995025
steps 1400    v_Prec: 0.361075  v_Recall: 0.489402  v_F1: 0.415557  v_AUC: 0.728534
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.417872    reg_loss: 0.518483    l2_loss: 0.012501    loss: 0.948857
steps 1600    v_Prec: 0.401716  v_Recall: 0.501786  v_F1: 0.446209  v_AUC: 0.757217
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.409589    reg_loss: 0.503748    l2_loss: 0.012667    loss: 0.926004
steps 1800    v_Prec: 0.408305  v_Recall: 0.556561  v_F1: 0.471043  v_AUC: 0.780691
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.396835    reg_loss: 0.491224    l2_loss: 0.012809    loss: 0.900867
steps 2000    v_Prec: 0.465995  v_Recall: 0.528697  v_F1: 0.495370  v_AUC: 0.794584
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.384016    reg_loss: 0.483273    l2_loss: 0.013142    loss: 0.880432
steps 2200    v_Prec: 0.510133  v_Recall: 0.549496  v_F1: 0.529084  v_AUC: 0.814059
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.369922    reg_loss: 0.476163    l2_loss: 0.013434    loss: 0.859519
steps 2400    v_Prec: 0.492475  v_Recall: 0.587045  v_F1: 0.535617  v_AUC: 0.820869
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.356236    reg_loss: 0.467616    l2_loss: 0.013845    loss: 0.837696
steps 2600    v_Prec: 0.547805  v_Recall: 0.563547  v_F1: 0.555564  v_AUC: 0.828816
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.352474    reg_loss: 0.467849    l2_loss: 0.014365    loss: 0.834688
steps 2800    v_Prec: 0.562306  v_Recall: 0.561324  v_F1: 0.561815  v_AUC: 0.835808
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.339783    reg_loss: 0.462502    l2_loss: 0.014857    loss: 0.817142
steps 3000    v_Prec: 0.579970  v_Recall: 0.561324  v_F1: 0.570495  v_AUC: 0.841177
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.336120    reg_loss: 0.457135    l2_loss: 0.015457    loss: 0.808712
steps 3200    v_Prec: 0.568972  v_Recall: 0.598873  v_F1: 0.583540  v_AUC: 0.849365
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.333310    reg_loss: 0.456405    l2_loss: 0.016059    loss: 0.805774
steps 3400    v_Prec: 0.567038  v_Recall: 0.606335  v_F1: 0.586028  v_AUC: 0.852304
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.333887    reg_loss: 0.448208    l2_loss: 0.016559    loss: 0.798654
steps 3600    v_Prec: 0.585938  v_Recall: 0.596729  v_F1: 0.591285  v_AUC: 0.855544
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.323416    reg_loss: 0.442182    l2_loss: 0.017119    loss: 0.782717
steps 3800    v_Prec: 0.582589  v_Recall: 0.600857  v_F1: 0.591582  v_AUC: 0.855755
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.321194    reg_loss: 0.432792    l2_loss: 0.017708    loss: 0.771695
steps 4000    v_Prec: 0.588773  v_Recall: 0.613638  v_F1: 0.600948  v_AUC: 0.862754
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.317345    reg_loss: 0.425496    l2_loss: 0.018428    loss: 0.761269
steps 4200    v_Prec: 0.589512  v_Recall: 0.627372  v_F1: 0.607853  v_AUC: 0.866985
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.314204    reg_loss: 0.418722    l2_loss: 0.019108    loss: 0.752034
steps 4400    v_Prec: 0.608141  v_Recall: 0.613162  v_F1: 0.610641  v_AUC: 0.870243
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.312291    reg_loss: 0.411370    l2_loss: 0.019751    loss: 0.743412
steps 4600    v_Prec: 0.588772  v_Recall: 0.625228  v_F1: 0.606453  v_AUC: 0.869810
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.306391    reg_loss: 0.398891    l2_loss: 0.020490    loss: 0.725772
steps 4800    v_Prec: 0.607264  v_Recall: 0.627848  v_F1: 0.617384  v_AUC: 0.873804
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.313013    reg_loss: 0.393447    l2_loss: 0.021389    loss: 0.727849
steps 5000    v_Prec: 0.610585  v_Recall: 0.634675  v_F1: 0.622397  v_AUC: 0.875774
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.313315    reg_loss: 0.386583    l2_loss: 0.022282    loss: 0.722180
steps 5200    v_Prec: 0.612500  v_Recall: 0.630150  v_F1: 0.621200  v_AUC: 0.876857
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.308734    reg_loss: 0.378894    l2_loss: 0.023207    loss: 0.710835
steps 5400    v_Prec: 0.634928  v_Recall: 0.613003  v_F1: 0.623773  v_AUC: 0.881369
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.257331    reg_loss: 0.356416    l2_loss: 0.024278    loss: 0.638026
steps 5600    v_Prec: 0.619601  v_Recall: 0.621815  v_F1: 0.620706  v_AUC: 0.874825
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.258157    reg_loss: 0.349672    l2_loss: 0.025287    loss: 0.633115
steps 5800    v_Prec: 0.614811  v_Recall: 0.621497  v_F1: 0.618136  v_AUC: 0.875965
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.257851    reg_loss: 0.346582    l2_loss: 0.026146    loss: 0.630578
steps 6000    v_Prec: 0.635458  v_Recall: 0.622847  v_F1: 0.629089  v_AUC: 0.880261
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.264222    reg_loss: 0.344249    l2_loss: 0.026832    loss: 0.635303
steps 6200    v_Prec: 0.623489  v_Recall: 0.634675  v_F1: 0.629032  v_AUC: 0.878371
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.263782    reg_loss: 0.340440    l2_loss: 0.027569    loss: 0.631792
steps 6400    v_Prec: 0.634416  v_Recall: 0.620465  v_F1: 0.627363  v_AUC: 0.880164
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.249223    reg_loss: 0.335007    l2_loss: 0.028157    loss: 0.612387
steps 6600    v_Prec: 0.646982  v_Recall: 0.628801  v_F1: 0.637762  v_AUC: 0.883423
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.266328    reg_loss: 0.330866    l2_loss: 0.028787    loss: 0.625981
steps 6800    v_Prec: 0.658938  v_Recall: 0.622688  v_F1: 0.640300  v_AUC: 0.883569
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.265833    reg_loss: 0.326568    l2_loss: 0.029447    loss: 0.621848
steps 7000    v_Prec: 0.641190  v_Recall: 0.658649  v_F1: 0.649802  v_AUC: 0.888943
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.258502    reg_loss: 0.322694    l2_loss: 0.029903    loss: 0.611099
steps 7200    v_Prec: 0.649147  v_Recall: 0.664761  v_F1: 0.656862  v_AUC: 0.890783
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.255165    reg_loss: 0.316670    l2_loss: 0.030539    loss: 0.602374
steps 7400    v_Prec: 0.651037  v_Recall: 0.658014  v_F1: 0.654507  v_AUC: 0.891949
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.252047    reg_loss: 0.314357    l2_loss: 0.030979    loss: 0.597383
steps 7600    v_Prec: 0.663056  v_Recall: 0.651107  v_F1: 0.657027  v_AUC: 0.892797
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.258670    reg_loss: 0.314977    l2_loss: 0.031590    loss: 0.605238
steps 7800    v_Prec: 0.660574  v_Recall: 0.662777  v_F1: 0.661674  v_AUC: 0.895487
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.257205    reg_loss: 0.307981    l2_loss: 0.032043    loss: 0.597230
steps 8000    v_Prec: 0.655371  v_Recall: 0.678574  v_F1: 0.666771  v_AUC: 0.898916
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.248020    reg_loss: 0.303704    l2_loss: 0.032480    loss: 0.584205
steps 8200    v_Prec: 0.692059  v_Recall: 0.646900  v_F1: 0.668718  v_AUC: 0.900595
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.250180    reg_loss: 0.301758    l2_loss: 0.032914    loss: 0.584852
steps 8400    v_Prec: 0.678009  v_Recall: 0.676987  v_F1: 0.677498  v_AUC: 0.902357
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.255349    reg_loss: 0.298949    l2_loss: 0.033435    loss: 0.587734
steps 8600    v_Prec: 0.680620  v_Recall: 0.680241  v_F1: 0.680430  v_AUC: 0.903749
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.252517    reg_loss: 0.296413    l2_loss: 0.033795    loss: 0.582726
steps 8800    v_Prec: 0.695773  v_Recall: 0.674288  v_F1: 0.684862  v_AUC: 0.905300
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.254492    reg_loss: 0.290513    l2_loss: 0.033917    loss: 0.578922
steps 9000    v_Prec: 0.677412  v_Recall: 0.695642  v_F1: 0.686406  v_AUC: 0.907723
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.246420    reg_loss: 0.289434    l2_loss: 0.034521    loss: 0.570375
steps 9200    v_Prec: 0.720299  v_Recall: 0.658887  v_F1: 0.688226  v_AUC: 0.907559
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.244994    reg_loss: 0.287592    l2_loss: 0.034982    loss: 0.567568
steps 9400    v_Prec: 0.691675  v_Recall: 0.687942  v_F1: 0.689803  v_AUC: 0.908028
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.244521    reg_loss: 0.279456    l2_loss: 0.035375    loss: 0.559352
steps 9600    v_Prec: 0.700762  v_Recall: 0.686354  v_F1: 0.693483  v_AUC: 0.910973
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.243463    reg_loss: 0.277730    l2_loss: 0.035705    loss: 0.556898
steps 9800    v_Prec: 0.708299  v_Recall: 0.689688  v_F1: 0.698870  v_AUC: 0.912485
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.244260    reg_loss: 0.274807    l2_loss: 0.036031    loss: 0.555098
steps 10000    v_Prec: 0.716975  v_Recall: 0.680321  v_F1: 0.698167  v_AUC: 0.912869
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.241660    reg_loss: 0.275688    l2_loss: 0.036187    loss: 0.553535
steps 10200    v_Prec: 0.733448  v_Recall: 0.676272  v_F1: 0.703701  v_AUC: 0.914460
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.241715    reg_loss: 0.272839    l2_loss: 0.036608    loss: 0.551162
steps 10400    v_Prec: 0.721594  v_Recall: 0.694213  v_F1: 0.707639  v_AUC: 0.916651
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.239213    reg_loss: 0.271951    l2_loss: 0.036858    loss: 0.548022
steps 10600    v_Prec: 0.718681  v_Recall: 0.693578  v_F1: 0.705906  v_AUC: 0.914366
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.229840    reg_loss: 0.263824    l2_loss: 0.037133    loss: 0.530797
steps 10800    v_Prec: 0.714032  v_Recall: 0.700881  v_F1: 0.707395  v_AUC: 0.916225
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.177867    reg_loss: 0.255544    l2_loss: 0.037372    loss: 0.470783
steps 11000    v_Prec: 0.724097  v_Recall: 0.674605  v_F1: 0.698475  v_AUC: 0.912690
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.165757    reg_loss: 0.254466    l2_loss: 0.037967    loss: 0.458190
steps 11200    v_Prec: 0.682893  v_Recall: 0.697150  v_F1: 0.689948  v_AUC: 0.909341
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.173906    reg_loss: 0.254602    l2_loss: 0.038195    loss: 0.466703
steps 11400    v_Prec: 0.689042  v_Recall: 0.700802  v_F1: 0.694872  v_AUC: 0.909145
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.176792    reg_loss: 0.256028    l2_loss: 0.038565    loss: 0.471385
steps 11600    v_Prec: 0.695733  v_Recall: 0.685957  v_F1: 0.690810  v_AUC: 0.907552
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.176080    reg_loss: 0.256562    l2_loss: 0.038772    loss: 0.471414
steps 11800    v_Prec: 0.716521  v_Recall: 0.665158  v_F1: 0.689885  v_AUC: 0.907453
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.185279    reg_loss: 0.258045    l2_loss: 0.039075    loss: 0.482399
steps 12000    v_Prec: 0.691914  v_Recall: 0.687465  v_F1: 0.689683  v_AUC: 0.908204
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.176083    reg_loss: 0.252854    l2_loss: 0.039472    loss: 0.468409
steps 12200    v_Prec: 0.699147  v_Recall: 0.683496  v_F1: 0.691233  v_AUC: 0.909091
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.182492    reg_loss: 0.255521    l2_loss: 0.039627    loss: 0.477639
steps 12400    v_Prec: 0.699783  v_Recall: 0.690006  v_F1: 0.694860  v_AUC: 0.909947
steps 12400    running time 440 seconds

Early stop model F1: 0.707639
testing thre: 0.39325577
testing Prec: 0.6625663289917993
testing Recall: 0.5340461725394897
testing F1: 0.5914045049651498
testing AUC: 0.8650734799574092
overall running time 443 seconds
(0.5962173808953795, 0.6052004860267315, 0.6006753497346841, 0.8650734799574092, 0.2951672)

2019-02-24 18:59:17.205553: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:59:18.370802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:59:18.374255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:59:18.374295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.380000 seconds
loading data in 30.320000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.749708    reg_loss: 0.647123    l2_loss: 0.013313    loss: 1.410144
steps 200    v_Prec: 0.162640  v_Recall: 0.999920  v_F1: 0.279775  v_AUC: 0.537288
steps 200    running time 40 seconds

steps 400    base_loss: 0.580413    reg_loss: 0.641553    l2_loss: 0.013256    loss: 1.235221
steps 400    v_Prec: 0.176053  v_Recall: 0.751745  v_F1: 0.285292  v_AUC: 0.563103
steps 400    running time 47 seconds

steps 600    base_loss: 0.496845    reg_loss: 0.626823    l2_loss: 0.013138    loss: 1.136806
steps 600    v_Prec: 0.186081  v_Recall: 0.670625  v_F1: 0.291326  v_AUC: 0.573245
steps 600    running time 54 seconds

steps 800    base_loss: 0.475703    reg_loss: 0.606966    l2_loss: 0.012994    loss: 1.095663
steps 800    v_Prec: 0.207635  v_Recall: 0.556848  v_F1: 0.302482  v_AUC: 0.591719
steps 800    running time 60 seconds

steps 1000    base_loss: 0.449768    reg_loss: 0.582872    l2_loss: 0.012880    loss: 1.045520
steps 1000    v_Prec: 0.245261  v_Recall: 0.493140  v_F1: 0.327594  v_AUC: 0.633635
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.446630    reg_loss: 0.558595    l2_loss: 0.012809    loss: 1.018034
steps 1200    v_Prec: 0.295085  v_Recall: 0.452299  v_F1: 0.357156  v_AUC: 0.670554
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.431915    reg_loss: 0.532918    l2_loss: 0.012768    loss: 0.977601
steps 1400    v_Prec: 0.354154  v_Recall: 0.429913  v_F1: 0.388373  v_AUC: 0.704460
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.413329    reg_loss: 0.510374    l2_loss: 0.012817    loss: 0.936521
steps 1600    v_Prec: 0.403453  v_Recall: 0.440584  v_F1: 0.421202  v_AUC: 0.748004
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.399104    reg_loss: 0.490780    l2_loss: 0.012935    loss: 0.902819
steps 1800    v_Prec: 0.447921  v_Recall: 0.460644  v_F1: 0.454193  v_AUC: 0.777321
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.385408    reg_loss: 0.474882    l2_loss: 0.013114    loss: 0.873403
steps 2000    v_Prec: 0.399046  v_Recall: 0.617668  v_F1: 0.484852  v_AUC: 0.802173
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.372990    reg_loss: 0.459625    l2_loss: 0.013319    loss: 0.845934
steps 2200    v_Prec: 0.503773  v_Recall: 0.508866  v_F1: 0.506307  v_AUC: 0.813935
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.360376    reg_loss: 0.445157    l2_loss: 0.013497    loss: 0.819030
steps 2400    v_Prec: 0.464284  v_Recall: 0.601300  v_F1: 0.523983  v_AUC: 0.826089
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.345626    reg_loss: 0.429650    l2_loss: 0.013670    loss: 0.788946
steps 2600    v_Prec: 0.497522  v_Recall: 0.596165  v_F1: 0.542395  v_AUC: 0.834029
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.348345    reg_loss: 0.418623    l2_loss: 0.013946    loss: 0.780914
steps 2800    v_Prec: 0.510963  v_Recall: 0.602102  v_F1: 0.552801  v_AUC: 0.841261
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.336743    reg_loss: 0.406304    l2_loss: 0.014179    loss: 0.757226
steps 3000    v_Prec: 0.533537  v_Recall: 0.602503  v_F1: 0.565927  v_AUC: 0.847281
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.329389    reg_loss: 0.391197    l2_loss: 0.014357    loss: 0.734943
steps 3200    v_Prec: 0.543443  v_Recall: 0.612774  v_F1: 0.576030  v_AUC: 0.853270
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.332568    reg_loss: 0.382273    l2_loss: 0.014653    loss: 0.729494
steps 3400    v_Prec: 0.565605  v_Recall: 0.601139  v_F1: 0.582831  v_AUC: 0.856478
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.330700    reg_loss: 0.374222    l2_loss: 0.014916    loss: 0.719838
steps 3600    v_Prec: 0.571871  v_Recall: 0.608120  v_F1: 0.589438  v_AUC: 0.860190
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.323960    reg_loss: 0.359659    l2_loss: 0.015244    loss: 0.698864
steps 3800    v_Prec: 0.570869  v_Recall: 0.608521  v_F1: 0.589094  v_AUC: 0.860385
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.332888    reg_loss: 0.350418    l2_loss: 0.015544    loss: 0.698850
steps 4000    v_Prec: 0.575395  v_Recall: 0.621841  v_F1: 0.597717  v_AUC: 0.864863
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.329123    reg_loss: 0.337125    l2_loss: 0.015835    loss: 0.682083
steps 4200    v_Prec: 0.553801  v_Recall: 0.647115  v_F1: 0.596833  v_AUC: 0.864809
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.318883    reg_loss: 0.324832    l2_loss: 0.016204    loss: 0.659919
steps 4400    v_Prec: 0.579768  v_Recall: 0.620798  v_F1: 0.599582  v_AUC: 0.864208
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.315200    reg_loss: 0.311639    l2_loss: 0.016564    loss: 0.643402
steps 4600    v_Prec: 0.576763  v_Recall: 0.624569  v_F1: 0.599715  v_AUC: 0.866800
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.318433    reg_loss: 0.303981    l2_loss: 0.016900    loss: 0.639314
steps 4800    v_Prec: 0.582533  v_Recall: 0.632592  v_F1: 0.606532  v_AUC: 0.871038
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.316721    reg_loss: 0.292252    l2_loss: 0.017326    loss: 0.626300
steps 5000    v_Prec: 0.579204  v_Recall: 0.648078  v_F1: 0.611709  v_AUC: 0.871874
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.317499    reg_loss: 0.283992    l2_loss: 0.017741    loss: 0.619233
steps 5200    v_Prec: 0.583773  v_Recall: 0.630426  v_F1: 0.606203  v_AUC: 0.870446
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.316102    reg_loss: 0.275191    l2_loss: 0.018174    loss: 0.609467
steps 5400    v_Prec: 0.577318  v_Recall: 0.644949  v_F1: 0.609262  v_AUC: 0.867921
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.274209    reg_loss: 0.239367    l2_loss: 0.018564    loss: 0.532141
steps 5600    v_Prec: 0.568405  v_Recall: 0.650726  v_F1: 0.606786  v_AUC: 0.860934
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.285278    reg_loss: 0.243143    l2_loss: 0.018909    loss: 0.547330
steps 5800    v_Prec: 0.555749  v_Recall: 0.665490  v_F1: 0.605689  v_AUC: 0.863932
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.276850    reg_loss: 0.234327    l2_loss: 0.019061    loss: 0.530237
steps 6000    v_Prec: 0.557517  v_Recall: 0.671588  v_F1: 0.609259  v_AUC: 0.867346
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.283859    reg_loss: 0.233485    l2_loss: 0.019244    loss: 0.536589
steps 6200    v_Prec: 0.573770  v_Recall: 0.668378  v_F1: 0.617472  v_AUC: 0.869187
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.284306    reg_loss: 0.231719    l2_loss: 0.019482    loss: 0.535507
steps 6400    v_Prec: 0.573194  v_Recall: 0.666052  v_F1: 0.616144  v_AUC: 0.872033
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.281429    reg_loss: 0.226395    l2_loss: 0.019665    loss: 0.527489
steps 6600    v_Prec: 0.584189  v_Recall: 0.661719  v_F1: 0.620542  v_AUC: 0.873944
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.280784    reg_loss: 0.220617    l2_loss: 0.019748    loss: 0.521150
steps 6800    v_Prec: 0.588036  v_Recall: 0.653855  v_F1: 0.619201  v_AUC: 0.877279
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.283445    reg_loss: 0.219568    l2_loss: 0.019792    loss: 0.522805
steps 7000    v_Prec: 0.595100  v_Recall: 0.656744  v_F1: 0.624404  v_AUC: 0.875179
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.282907    reg_loss: 0.218214    l2_loss: 0.020145    loss: 0.521266
steps 7200    v_Prec: 0.603425  v_Recall: 0.653053  v_F1: 0.627259  v_AUC: 0.878140
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.284343    reg_loss: 0.216621    l2_loss: 0.020201    loss: 0.521165
steps 7400    v_Prec: 0.587262  v_Recall: 0.654738  v_F1: 0.619167  v_AUC: 0.876779
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.277827    reg_loss: 0.209480    l2_loss: 0.020309    loss: 0.507616
steps 7600    v_Prec: 0.612639  v_Recall: 0.643264  v_F1: 0.627578  v_AUC: 0.878139
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.281072    reg_loss: 0.210005    l2_loss: 0.020525    loss: 0.511602
steps 7800    v_Prec: 0.603143  v_Recall: 0.655942  v_F1: 0.628435  v_AUC: 0.877714
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.281619    reg_loss: 0.207846    l2_loss: 0.020616    loss: 0.510081
steps 8000    v_Prec: 0.596685  v_Recall: 0.664286  v_F1: 0.628673  v_AUC: 0.880141
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.283421    reg_loss: 0.206699    l2_loss: 0.020622    loss: 0.510742
steps 8200    v_Prec: 0.601649  v_Recall: 0.661558  v_F1: 0.630183  v_AUC: 0.882909
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.285376    reg_loss: 0.206672    l2_loss: 0.020784    loss: 0.512831
steps 8400    v_Prec: 0.619693  v_Recall: 0.641820  v_F1: 0.630562  v_AUC: 0.881076
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.278174    reg_loss: 0.198853    l2_loss: 0.020992    loss: 0.498019
steps 8600    v_Prec: 0.610401  v_Recall: 0.659231  v_F1: 0.633877  v_AUC: 0.881529
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.285044    reg_loss: 0.201578    l2_loss: 0.020976    loss: 0.507599
steps 8800    v_Prec: 0.602048  v_Recall: 0.669823  v_F1: 0.634130  v_AUC: 0.880586
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.276184    reg_loss: 0.196263    l2_loss: 0.021103    loss: 0.493550
steps 9000    v_Prec: 0.613038  v_Recall: 0.660997  v_F1: 0.636114  v_AUC: 0.881797
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.284377    reg_loss: 0.196885    l2_loss: 0.021188    loss: 0.502450
steps 9200    v_Prec: 0.613979  v_Recall: 0.660435  v_F1: 0.636360  v_AUC: 0.882767
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.281197    reg_loss: 0.195487    l2_loss: 0.021036    loss: 0.497720
steps 9400    v_Prec: 0.635597  v_Recall: 0.640696  v_F1: 0.638136  v_AUC: 0.883317
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.280804    reg_loss: 0.195535    l2_loss: 0.021313    loss: 0.497651
steps 9600    v_Prec: 0.606455  v_Recall: 0.679933  v_F1: 0.641095  v_AUC: 0.886089
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.283399    reg_loss: 0.192616    l2_loss: 0.021394    loss: 0.497409
steps 9800    v_Prec: 0.626822  v_Recall: 0.655540  v_F1: 0.640860  v_AUC: 0.887571
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.282417    reg_loss: 0.191363    l2_loss: 0.021485    loss: 0.495265
steps 10000    v_Prec: 0.604318  v_Recall: 0.687234  v_F1: 0.643115  v_AUC: 0.886288
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.281458    reg_loss: 0.188121    l2_loss: 0.021534    loss: 0.491113
steps 10200    v_Prec: 0.648941  v_Recall: 0.634518  v_F1: 0.641649  v_AUC: 0.887955
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.281832    reg_loss: 0.189676    l2_loss: 0.021545    loss: 0.493053
steps 10400    v_Prec: 0.638518  v_Recall: 0.648560  v_F1: 0.643500  v_AUC: 0.887828
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.282846    reg_loss: 0.187407    l2_loss: 0.021413    loss: 0.491667
steps 10600    v_Prec: 0.626666  v_Recall: 0.667897  v_F1: 0.646625  v_AUC: 0.889800
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.274768    reg_loss: 0.181988    l2_loss: 0.021413    loss: 0.478168
steps 10800    v_Prec: 0.618999  v_Recall: 0.677606  v_F1: 0.646978  v_AUC: 0.886883
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.225616    reg_loss: 0.168891    l2_loss: 0.021692    loss: 0.416199
steps 11000    v_Prec: 0.626961  v_Recall: 0.654176  v_F1: 0.640280  v_AUC: 0.880633
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.233552    reg_loss: 0.170217    l2_loss: 0.021712    loss: 0.425481
steps 11200    v_Prec: 0.618143  v_Recall: 0.665410  v_F1: 0.640906  v_AUC: 0.881271
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.234604    reg_loss: 0.170465    l2_loss: 0.021684    loss: 0.426753
steps 11400    v_Prec: 0.616846  v_Recall: 0.666934  v_F1: 0.640913  v_AUC: 0.882816
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.233004    reg_loss: 0.171286    l2_loss: 0.021835    loss: 0.426125
steps 11600    v_Prec: 0.637816  v_Recall: 0.650405  v_F1: 0.644049  v_AUC: 0.881974
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.238263    reg_loss: 0.173685    l2_loss: 0.021932    loss: 0.433880
steps 11800    v_Prec: 0.626877  v_Recall: 0.656503  v_F1: 0.641348  v_AUC: 0.883584
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.231787    reg_loss: 0.172592    l2_loss: 0.021949    loss: 0.426328
steps 12000    v_Prec: 0.615090  v_Recall: 0.669823  v_F1: 0.641291  v_AUC: 0.881197
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.234189    reg_loss: 0.173674    l2_loss: 0.022030    loss: 0.429893
steps 12200    v_Prec: 0.641485  v_Recall: 0.643184  v_F1: 0.642333  v_AUC: 0.883406
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.238758    reg_loss: 0.172427    l2_loss: 0.021953    loss: 0.433138
steps 12400    v_Prec: 0.612115  v_Recall: 0.673754  v_F1: 0.641458  v_AUC: 0.880167
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.239352    reg_loss: 0.173997    l2_loss: 0.022050    loss: 0.435398
steps 12600    v_Prec: 0.626730  v_Recall: 0.657707  v_F1: 0.641845  v_AUC: 0.882540
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.247230    reg_loss: 0.177862    l2_loss: 0.022132    loss: 0.447223
steps 12800    v_Prec: 0.608859  v_Recall: 0.677205  v_F1: 0.641216  v_AUC: 0.886000
steps 12800    running time 451 seconds

Early stop model F1: 0.646978
testing thre: 0.32152584
testing Prec: 0.3890485001947799
testing Recall: 0.7766221142162819
testing F1: 0.5184031664152351
testing AUC: 0.8412528206784173
overall running time 454 seconds
(0.5442117776152158, 0.5785176184690158, 0.5608405776615544, 0.8412528206784173, 0.68598396)

2019-02-24 19:04:14.418505: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:04:14.907324: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:04:14.911190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:04:14.911226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.760000 seconds
loading data in 29.810000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.525882    reg_loss: 0.647019    l2_loss: 0.013352    loss: 1.186253
steps 200    v_Prec: 0.163254  v_Recall: 1.000000  v_F1: 0.280686  v_AUC: 0.476054
steps 200    running time 40 seconds

steps 400    base_loss: 0.504547    reg_loss: 0.639883    l2_loss: 0.013260    loss: 1.157690
steps 400    v_Prec: 0.163257  v_Recall: 1.000000  v_F1: 0.280689  v_AUC: 0.478025
steps 400    running time 46 seconds

steps 600    base_loss: 0.482001    reg_loss: 0.625508    l2_loss: 0.013117    loss: 1.120626
steps 600    v_Prec: 0.163305  v_Recall: 0.999281  v_F1: 0.280732  v_AUC: 0.498652
steps 600    running time 53 seconds

steps 800    base_loss: 0.459496    reg_loss: 0.601646    l2_loss: 0.012859    loss: 1.074001
steps 800    v_Prec: 0.188791  v_Recall: 0.661818  v_F1: 0.293778  v_AUC: 0.581962
steps 800    running time 60 seconds

steps 1000    base_loss: 0.458341    reg_loss: 0.576100    l2_loss: 0.012733    loss: 1.047174
steps 1000    v_Prec: 0.268473  v_Recall: 0.433299  v_F1: 0.331529  v_AUC: 0.633661
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.438737    reg_loss: 0.542469    l2_loss: 0.012584    loss: 0.993791
steps 1200    v_Prec: 0.308904  v_Recall: 0.431221  v_F1: 0.359955  v_AUC: 0.658012
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.427733    reg_loss: 0.515889    l2_loss: 0.012475    loss: 0.956097
steps 1400    v_Prec: 0.358614  v_Recall: 0.424427  v_F1: 0.388755  v_AUC: 0.677289
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.421502    reg_loss: 0.499764    l2_loss: 0.012446    loss: 0.933712
steps 1600    v_Prec: 0.422792  v_Recall: 0.424347  v_F1: 0.423568  v_AUC: 0.707478
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.400731    reg_loss: 0.483986    l2_loss: 0.012446    loss: 0.897163
steps 1800    v_Prec: 0.453353  v_Recall: 0.472304  v_F1: 0.462635  v_AUC: 0.747567
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.383969    reg_loss: 0.472662    l2_loss: 0.012488    loss: 0.869119
steps 2000    v_Prec: 0.488479  v_Recall: 0.493086  v_F1: 0.490772  v_AUC: 0.777000
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.363646    reg_loss: 0.458014    l2_loss: 0.012586    loss: 0.834246
steps 2200    v_Prec: 0.504588  v_Recall: 0.536248  v_F1: 0.519936  v_AUC: 0.799575
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.348024    reg_loss: 0.443128    l2_loss: 0.012676    loss: 0.803827
steps 2400    v_Prec: 0.531730  v_Recall: 0.537127  v_F1: 0.534415  v_AUC: 0.812579
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.342851    reg_loss: 0.433538    l2_loss: 0.012836    loss: 0.789225
steps 2600    v_Prec: 0.527108  v_Recall: 0.573495  v_F1: 0.549324  v_AUC: 0.822698
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.336914    reg_loss: 0.421150    l2_loss: 0.012979    loss: 0.771043
steps 2800    v_Prec: 0.540125  v_Recall: 0.578851  v_F1: 0.558818  v_AUC: 0.830369
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.330037    reg_loss: 0.406718    l2_loss: 0.013127    loss: 0.749883
steps 3000    v_Prec: 0.534739  v_Recall: 0.612101  v_F1: 0.570811  v_AUC: 0.836553
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.326191    reg_loss: 0.396183    l2_loss: 0.013254    loss: 0.735628
steps 3200    v_Prec: 0.553292  v_Recall: 0.599153  v_F1: 0.575310  v_AUC: 0.842620
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.321199    reg_loss: 0.383272    l2_loss: 0.013503    loss: 0.717974
steps 3400    v_Prec: 0.577762  v_Recall: 0.586444  v_F1: 0.582071  v_AUC: 0.846302
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.328024    reg_loss: 0.373833    l2_loss: 0.013681    loss: 0.715538
steps 3600    v_Prec: 0.574275  v_Recall: 0.610583  v_F1: 0.591872  v_AUC: 0.852220
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.318555    reg_loss: 0.362115    l2_loss: 0.013962    loss: 0.694632
steps 3800    v_Prec: 0.576814  v_Recall: 0.617616  v_F1: 0.596518  v_AUC: 0.856149
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.319669    reg_loss: 0.351052    l2_loss: 0.014249    loss: 0.684969
steps 4000    v_Prec: 0.569128  v_Recall: 0.627128  v_F1: 0.596722  v_AUC: 0.858799
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.321591    reg_loss: 0.337869    l2_loss: 0.014593    loss: 0.674052
steps 4200    v_Prec: 0.576274  v_Recall: 0.624730  v_F1: 0.599524  v_AUC: 0.862619
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.313019    reg_loss: 0.326545    l2_loss: 0.014917    loss: 0.654481
steps 4400    v_Prec: 0.553709  v_Recall: 0.660459  v_F1: 0.602391  v_AUC: 0.863793
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.311989    reg_loss: 0.313103    l2_loss: 0.015274    loss: 0.640366
steps 4600    v_Prec: 0.570802  v_Recall: 0.634402  v_F1: 0.600924  v_AUC: 0.865053
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.316448    reg_loss: 0.305722    l2_loss: 0.015633    loss: 0.637803
steps 4800    v_Prec: 0.587584  v_Recall: 0.632483  v_F1: 0.609208  v_AUC: 0.867154
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.319450    reg_loss: 0.295494    l2_loss: 0.016043    loss: 0.630987
steps 5000    v_Prec: 0.574174  v_Recall: 0.640077  v_F1: 0.605337  v_AUC: 0.869345
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.316028    reg_loss: 0.286496    l2_loss: 0.016479    loss: 0.619003
steps 5200    v_Prec: 0.604303  v_Recall: 0.621933  v_F1: 0.612991  v_AUC: 0.869836
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.312414    reg_loss: 0.278169    l2_loss: 0.016945    loss: 0.607529
steps 5400    v_Prec: 0.588296  v_Recall: 0.641196  v_F1: 0.613608  v_AUC: 0.872731
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.262406    reg_loss: 0.245837    l2_loss: 0.017367    loss: 0.525610
steps 5600    v_Prec: 0.589122  v_Recall: 0.637199  v_F1: 0.612218  v_AUC: 0.870002
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.262941    reg_loss: 0.241834    l2_loss: 0.017607    loss: 0.522382
steps 5800    v_Prec: 0.587118  v_Recall: 0.642634  v_F1: 0.613623  v_AUC: 0.869882
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.261337    reg_loss: 0.236559    l2_loss: 0.017889    loss: 0.515785
steps 6000    v_Prec: 0.584310  v_Recall: 0.645352  v_F1: 0.613316  v_AUC: 0.871157
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.268852    reg_loss: 0.237081    l2_loss: 0.017960    loss: 0.523892
steps 6200    v_Prec: 0.562800  v_Recall: 0.665814  v_F1: 0.609988  v_AUC: 0.871959
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.270436    reg_loss: 0.229330    l2_loss: 0.018210    loss: 0.517976
steps 6400    v_Prec: 0.582428  v_Recall: 0.642714  v_F1: 0.611088  v_AUC: 0.869647
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.271336    reg_loss: 0.228914    l2_loss: 0.018359    loss: 0.518609
steps 6600    v_Prec: 0.572497  v_Recall: 0.660858  v_F1: 0.613512  v_AUC: 0.872864
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.270382    reg_loss: 0.225247    l2_loss: 0.018689    loss: 0.514317
steps 6800    v_Prec: 0.598772  v_Recall: 0.639357  v_F1: 0.618400  v_AUC: 0.873753
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.271867    reg_loss: 0.222363    l2_loss: 0.018996    loss: 0.513225
steps 7000    v_Prec: 0.578830  v_Recall: 0.663496  v_F1: 0.618278  v_AUC: 0.874966
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.275329    reg_loss: 0.222513    l2_loss: 0.019167    loss: 0.517009
steps 7200    v_Prec: 0.566068  v_Recall: 0.682439  v_F1: 0.618830  v_AUC: 0.875480
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.272788    reg_loss: 0.216581    l2_loss: 0.019289    loss: 0.508658
steps 7400    v_Prec: 0.592853  v_Recall: 0.661658  v_F1: 0.625368  v_AUC: 0.878040
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.272232    reg_loss: 0.214709    l2_loss: 0.019565    loss: 0.506506
steps 7600    v_Prec: 0.592750  v_Recall: 0.658700  v_F1: 0.623987  v_AUC: 0.878146
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.272795    reg_loss: 0.208973    l2_loss: 0.019830    loss: 0.501599
steps 7800    v_Prec: 0.591412  v_Recall: 0.661658  v_F1: 0.624566  v_AUC: 0.880263
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.277991    reg_loss: 0.208897    l2_loss: 0.019922    loss: 0.506810
steps 8000    v_Prec: 0.598592  v_Recall: 0.659020  v_F1: 0.627354  v_AUC: 0.878673
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.268915    reg_loss: 0.206057    l2_loss: 0.020159    loss: 0.495131
steps 8200    v_Prec: 0.589978  v_Recall: 0.674766  v_F1: 0.629530  v_AUC: 0.881306
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.278257    reg_loss: 0.204762    l2_loss: 0.020332    loss: 0.503351
steps 8400    v_Prec: 0.597800  v_Recall: 0.664695  v_F1: 0.629475  v_AUC: 0.880644
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.274182    reg_loss: 0.202132    l2_loss: 0.020430    loss: 0.496744
steps 8600    v_Prec: 0.588399  v_Recall: 0.674606  v_F1: 0.628561  v_AUC: 0.882792
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.271260    reg_loss: 0.200206    l2_loss: 0.020614    loss: 0.492080
steps 8800    v_Prec: 0.605819  v_Recall: 0.655743  v_F1: 0.629793  v_AUC: 0.885468
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.277524    reg_loss: 0.198873    l2_loss: 0.020842    loss: 0.497240
steps 9000    v_Prec: 0.580193  v_Recall: 0.697706  v_F1: 0.633546  v_AUC: 0.886887
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.281007    reg_loss: 0.199375    l2_loss: 0.021009    loss: 0.501391
steps 9200    v_Prec: 0.594165  v_Recall: 0.683638  v_F1: 0.635769  v_AUC: 0.887584
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.276620    reg_loss: 0.196359    l2_loss: 0.021203    loss: 0.494182
steps 9400    v_Prec: 0.604056  v_Recall: 0.673727  v_F1: 0.636992  v_AUC: 0.890684
steps 9400    running time 340 seconds

steps 9600    base_loss: 0.271608    reg_loss: 0.192135    l2_loss: 0.021273    loss: 0.485016
steps 9600    v_Prec: 0.598535  v_Recall: 0.685557  v_F1: 0.639097  v_AUC: 0.890963
steps 9600    running time 347 seconds

steps 9800    base_loss: 0.277034    reg_loss: 0.194287    l2_loss: 0.021464    loss: 0.492785
steps 9800    v_Prec: 0.586524  v_Recall: 0.707617  v_F1: 0.641406  v_AUC: 0.891653
steps 9800    running time 354 seconds

steps 10000    base_loss: 0.272765    reg_loss: 0.189026    l2_loss: 0.021565    loss: 0.483356
steps 10000    v_Prec: 0.586600  v_Recall: 0.708177  v_F1: 0.641680  v_AUC: 0.892124
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.272088    reg_loss: 0.189044    l2_loss: 0.021753    loss: 0.482886
steps 10200    v_Prec: 0.603420  v_Recall: 0.682519  v_F1: 0.640537  v_AUC: 0.892228
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.272034    reg_loss: 0.185715    l2_loss: 0.021918    loss: 0.479666
steps 10400    v_Prec: 0.609221  v_Recall: 0.672768  v_F1: 0.639420  v_AUC: 0.894645
steps 10400    running time 373 seconds

steps 10600    base_loss: 0.274513    reg_loss: 0.189909    l2_loss: 0.022033    loss: 0.486455
steps 10600    v_Prec: 0.624248  v_Recall: 0.672049  v_F1: 0.647267  v_AUC: 0.894496
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.262173    reg_loss: 0.183508    l2_loss: 0.022122    loss: 0.467803
steps 10800    v_Prec: 0.618717  v_Recall: 0.669011  v_F1: 0.642882  v_AUC: 0.890989
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.205966    reg_loss: 0.175562    l2_loss: 0.022164    loss: 0.403692
steps 11000    v_Prec: 0.601012  v_Recall: 0.693150  v_F1: 0.643801  v_AUC: 0.891130
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.205524    reg_loss: 0.177817    l2_loss: 0.021923    loss: 0.405264
steps 11200    v_Prec: 0.601243  v_Recall: 0.680441  v_F1: 0.638395  v_AUC: 0.889364
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.205409    reg_loss: 0.179515    l2_loss: 0.021778    loss: 0.406702
steps 11400    v_Prec: 0.589156  v_Recall: 0.682679  v_F1: 0.632479  v_AUC: 0.889178
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.204535    reg_loss: 0.177748    l2_loss: 0.021676    loss: 0.403960
steps 11600    v_Prec: 0.589110  v_Recall: 0.677963  v_F1: 0.630421  v_AUC: 0.887047
steps 11600    running time 411 seconds

steps 11800    base_loss: 0.212581    reg_loss: 0.182989    l2_loss: 0.021563    loss: 0.417133
steps 11800    v_Prec: 0.567930  v_Recall: 0.691312  v_F1: 0.623576  v_AUC: 0.885537
steps 11800    running time 416 seconds

steps 12000    base_loss: 0.210673    reg_loss: 0.180112    l2_loss: 0.021461    loss: 0.412245
steps 12000    v_Prec: 0.598315  v_Recall: 0.658620  v_F1: 0.627021  v_AUC: 0.887236
steps 12000    running time 422 seconds

steps 12200    base_loss: 0.211030    reg_loss: 0.179349    l2_loss: 0.021477    loss: 0.411856
steps 12200    v_Prec: 0.579975  v_Recall: 0.674127  v_F1: 0.623517  v_AUC: 0.886770
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.210273    reg_loss: 0.178557    l2_loss: 0.021555    loss: 0.410385
steps 12400    v_Prec: 0.576478  v_Recall: 0.676605  v_F1: 0.622541  v_AUC: 0.885818
steps 12400    running time 435 seconds

steps 12600    base_loss: 0.220040    reg_loss: 0.184110    l2_loss: 0.021472    loss: 0.425623
steps 12600    v_Prec: 0.571827  v_Recall: 0.688194  v_F1: 0.624637  v_AUC: 0.885761
steps 12600    running time 441 seconds

Early stop model F1: 0.647267
testing thre: 0.3586387
testing Prec: 0.41422368533076026
testing Recall: 0.709404617253949
testing F1: 0.5230416397907259
testing AUC: 0.8402191033834399
overall running time 443 seconds
(0.5155464690348411, 0.5882867557715674, 0.5495198964883209, 0.8402191033834399, 0.5925233)

2019-02-24 19:09:03.122904: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:09:03.981397: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:09:03.985560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:09:03.985597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.740000 seconds
loading data in 30.910000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.293507    reg_loss: 0.647683    l2_loss: 0.013341    loss: 1.954531
steps 200    v_Prec: 0.163413  v_Recall: 0.979937  v_F1: 0.280114  v_AUC: 0.523226
steps 200    running time 41 seconds

steps 400    base_loss: 0.751663    reg_loss: 0.643699    l2_loss: 0.013220    loss: 1.408582
steps 400    v_Prec: 0.168700  v_Recall: 0.910120  v_F1: 0.284639  v_AUC: 0.552205
steps 400    running time 48 seconds

steps 600    base_loss: 0.501963    reg_loss: 0.635829    l2_loss: 0.013198    loss: 1.150990
steps 600    v_Prec: 0.186362  v_Recall: 0.712142  v_F1: 0.295416  v_AUC: 0.580639
steps 600    running time 55 seconds

steps 800    base_loss: 0.484042    reg_loss: 0.624899    l2_loss: 0.013046    loss: 1.121986
steps 800    v_Prec: 0.207561  v_Recall: 0.583822  v_F1: 0.306245  v_AUC: 0.610270
steps 800    running time 62 seconds

steps 1000    base_loss: 0.471922    reg_loss: 0.611324    l2_loss: 0.012895    loss: 1.096141
steps 1000    v_Prec: 0.236824  v_Recall: 0.536955  v_F1: 0.328683  v_AUC: 0.642289
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.459198    reg_loss: 0.590082    l2_loss: 0.012806    loss: 1.062086
steps 1200    v_Prec: 0.274807  v_Recall: 0.502287  v_F1: 0.355252  v_AUC: 0.674285
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.447204    reg_loss: 0.568520    l2_loss: 0.012760    loss: 1.028483
steps 1400    v_Prec: 0.343256  v_Recall: 0.465452  v_F1: 0.395122  v_AUC: 0.712927
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.420953    reg_loss: 0.544526    l2_loss: 0.012844    loss: 0.978323
steps 1600    v_Prec: 0.430672  v_Recall: 0.474842  v_F1: 0.451679  v_AUC: 0.755849
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.397875    reg_loss: 0.525032    l2_loss: 0.012993    loss: 0.935900
steps 1800    v_Prec: 0.521412  v_Recall: 0.472915  v_F1: 0.495981  v_AUC: 0.783916
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.371338    reg_loss: 0.505540    l2_loss: 0.013179    loss: 0.890056
steps 2000    v_Prec: 0.545067  v_Recall: 0.512479  v_F1: 0.528271  v_AUC: 0.802413
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.359134    reg_loss: 0.492799    l2_loss: 0.013414    loss: 0.865346
steps 2200    v_Prec: 0.604557  v_Recall: 0.513201  v_F1: 0.555146  v_AUC: 0.820138
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.347229    reg_loss: 0.480491    l2_loss: 0.013638    loss: 0.841358
steps 2400    v_Prec: 0.597118  v_Recall: 0.535350  v_F1: 0.564550  v_AUC: 0.831364
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.332421    reg_loss: 0.466071    l2_loss: 0.013923    loss: 0.812415
steps 2600    v_Prec: 0.598974  v_Recall: 0.562395  v_F1: 0.580108  v_AUC: 0.838938
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.327760    reg_loss: 0.456801    l2_loss: 0.014190    loss: 0.798751
steps 2800    v_Prec: 0.598157  v_Recall: 0.583420  v_F1: 0.590697  v_AUC: 0.849060
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.321468    reg_loss: 0.444720    l2_loss: 0.014489    loss: 0.780677
steps 3000    v_Prec: 0.618990  v_Recall: 0.574432  v_F1: 0.595879  v_AUC: 0.853968
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.323975    reg_loss: 0.436940    l2_loss: 0.014773    loss: 0.775688
steps 3200    v_Prec: 0.618340  v_Recall: 0.594174  v_F1: 0.606016  v_AUC: 0.859965
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.306845    reg_loss: 0.425386    l2_loss: 0.015083    loss: 0.747313
steps 3400    v_Prec: 0.620240  v_Recall: 0.596100  v_F1: 0.607931  v_AUC: 0.860598
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.311897    reg_loss: 0.416801    l2_loss: 0.015381    loss: 0.744079
steps 3600    v_Prec: 0.619319  v_Recall: 0.602520  v_F1: 0.610804  v_AUC: 0.860956
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.305583    reg_loss: 0.406634    l2_loss: 0.015689    loss: 0.727906
steps 3800    v_Prec: 0.654442  v_Recall: 0.579970  v_F1: 0.614959  v_AUC: 0.866070
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.301570    reg_loss: 0.394499    l2_loss: 0.016019    loss: 0.712088
steps 4000    v_Prec: 0.621820  v_Recall: 0.617928  v_F1: 0.619868  v_AUC: 0.869474
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.300545    reg_loss: 0.385899    l2_loss: 0.016331    loss: 0.702775
steps 4200    v_Prec: 0.643945  v_Recall: 0.600433  v_F1: 0.621429  v_AUC: 0.872256
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.306264    reg_loss: 0.380559    l2_loss: 0.016628    loss: 0.703451
steps 4400    v_Prec: 0.658044  v_Recall: 0.604285  v_F1: 0.630020  v_AUC: 0.876079
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.300669    reg_loss: 0.370947    l2_loss: 0.017034    loss: 0.688650
steps 4600    v_Prec: 0.638767  v_Recall: 0.620416  v_F1: 0.629458  v_AUC: 0.878293
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.297109    reg_loss: 0.358683    l2_loss: 0.017466    loss: 0.673257
steps 4800    v_Prec: 0.623561  v_Recall: 0.630367  v_F1: 0.626945  v_AUC: 0.876209
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.298126    reg_loss: 0.351019    l2_loss: 0.017832    loss: 0.666977
steps 5000    v_Prec: 0.619334  v_Recall: 0.637028  v_F1: 0.628056  v_AUC: 0.876162
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.302122    reg_loss: 0.343871    l2_loss: 0.018244    loss: 0.664236
steps 5200    v_Prec: 0.633482  v_Recall: 0.639836  v_F1: 0.636643  v_AUC: 0.881859
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.292627    reg_loss: 0.330884    l2_loss: 0.018585    loss: 0.642097
steps 5400    v_Prec: 0.652370  v_Recall: 0.616403  v_F1: 0.633877  v_AUC: 0.881237
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.231769    reg_loss: 0.287379    l2_loss: 0.019147    loss: 0.538296
steps 5600    v_Prec: 0.639532  v_Recall: 0.614076  v_F1: 0.626545  v_AUC: 0.869613
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.234930    reg_loss: 0.284010    l2_loss: 0.019726    loss: 0.538666
steps 5800    v_Prec: 0.641868  v_Recall: 0.609983  v_F1: 0.625519  v_AUC: 0.867466
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.242657    reg_loss: 0.282507    l2_loss: 0.020183    loss: 0.545347
steps 6000    v_Prec: 0.656370  v_Recall: 0.605329  v_F1: 0.629817  v_AUC: 0.869511
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.242521    reg_loss: 0.278577    l2_loss: 0.020614    loss: 0.541711
steps 6200    v_Prec: 0.636593  v_Recall: 0.628521  v_F1: 0.632531  v_AUC: 0.873697
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.249251    reg_loss: 0.275284    l2_loss: 0.020951    loss: 0.545486
steps 6400    v_Prec: 0.662591  v_Recall: 0.613193  v_F1: 0.636936  v_AUC: 0.877140
steps 6400    running time 242 seconds

steps 6600    base_loss: 0.247045    reg_loss: 0.273574    l2_loss: 0.021350    loss: 0.541969
steps 6600    v_Prec: 0.620708  v_Recall: 0.662948  v_F1: 0.641133  v_AUC: 0.878742
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.245934    reg_loss: 0.268937    l2_loss: 0.021738    loss: 0.536609
steps 6800    v_Prec: 0.650045  v_Recall: 0.639194  v_F1: 0.644574  v_AUC: 0.880340
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.246044    reg_loss: 0.265436    l2_loss: 0.021906    loss: 0.533387
steps 7000    v_Prec: 0.668030  v_Recall: 0.642244  v_F1: 0.654883  v_AUC: 0.886010
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.247539    reg_loss: 0.263620    l2_loss: 0.022086    loss: 0.533245
steps 7200    v_Prec: 0.661128  v_Recall: 0.641762  v_F1: 0.651301  v_AUC: 0.884471
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.241823    reg_loss: 0.262870    l2_loss: 0.022359    loss: 0.527053
steps 7400    v_Prec: 0.666415  v_Recall: 0.636466  v_F1: 0.651096  v_AUC: 0.884778
steps 7400    running time 275 seconds

steps 7600    base_loss: 0.252491    reg_loss: 0.260694    l2_loss: 0.022654    loss: 0.535840
steps 7600    v_Prec: 0.678361  v_Recall: 0.636225  v_F1: 0.656618  v_AUC: 0.887192
steps 7600    running time 281 seconds

steps 7800    base_loss: 0.244940    reg_loss: 0.254198    l2_loss: 0.022993    loss: 0.522131
steps 7800    v_Prec: 0.660970  v_Recall: 0.648664  v_F1: 0.654759  v_AUC: 0.887905
steps 7800    running time 287 seconds

steps 8000    base_loss: 0.252072    reg_loss: 0.254121    l2_loss: 0.022972    loss: 0.529166
steps 8000    v_Prec: 0.663675  v_Recall: 0.658615  v_F1: 0.661135  v_AUC: 0.890342
steps 8000    running time 293 seconds

steps 8200    base_loss: 0.247761    reg_loss: 0.251427    l2_loss: 0.023193    loss: 0.522382
steps 8200    v_Prec: 0.676714  v_Recall: 0.650429  v_F1: 0.663311  v_AUC: 0.891415
steps 8200    running time 300 seconds

steps 8400    base_loss: 0.247263    reg_loss: 0.249768    l2_loss: 0.023421    loss: 0.520452
steps 8400    v_Prec: 0.658720  v_Recall: 0.660782  v_F1: 0.659749  v_AUC: 0.890483
steps 8400    running time 306 seconds

steps 8600    base_loss: 0.250380    reg_loss: 0.246712    l2_loss: 0.023444    loss: 0.520536
steps 8600    v_Prec: 0.659021  v_Recall: 0.668646  v_F1: 0.663799  v_AUC: 0.894732
steps 8600    running time 313 seconds

steps 8800    base_loss: 0.248444    reg_loss: 0.241464    l2_loss: 0.023585    loss: 0.513493
steps 8800    v_Prec: 0.667567  v_Recall: 0.674424  v_F1: 0.670978  v_AUC: 0.896560
steps 8800    running time 319 seconds

steps 9000    base_loss: 0.252085    reg_loss: 0.241889    l2_loss: 0.023722    loss: 0.517696
steps 9000    v_Prec: 0.688965  v_Recall: 0.660380  v_F1: 0.674370  v_AUC: 0.896898
steps 9000    running time 326 seconds

steps 9200    base_loss: 0.248942    reg_loss: 0.240054    l2_loss: 0.024145    loss: 0.513142
steps 9200    v_Prec: 0.676878  v_Recall: 0.679159  v_F1: 0.678016  v_AUC: 0.897367
steps 9200    running time 333 seconds

steps 9400    base_loss: 0.251986    reg_loss: 0.240967    l2_loss: 0.024321    loss: 0.517274
steps 9400    v_Prec: 0.663763  v_Recall: 0.684857  v_F1: 0.674145  v_AUC: 0.898593
steps 9400    running time 339 seconds

steps 9600    base_loss: 0.248500    reg_loss: 0.236607    l2_loss: 0.024412    loss: 0.509518
steps 9600    v_Prec: 0.708424  v_Recall: 0.651232  v_F1: 0.678625  v_AUC: 0.899843
steps 9600    running time 345 seconds

steps 9800    base_loss: 0.255283    reg_loss: 0.237360    l2_loss: 0.024380    loss: 0.517024
steps 9800    v_Prec: 0.716207  v_Recall: 0.645454  v_F1: 0.678992  v_AUC: 0.902155
steps 9800    running time 352 seconds

steps 10000    base_loss: 0.241220    reg_loss: 0.228354    l2_loss: 0.024588    loss: 0.494162
steps 10000    v_Prec: 0.679394  v_Recall: 0.683974  v_F1: 0.681676  v_AUC: 0.903619
steps 10000    running time 359 seconds

steps 10200    base_loss: 0.245069    reg_loss: 0.227070    l2_loss: 0.024609    loss: 0.496748
steps 10200    v_Prec: 0.672491  v_Recall: 0.694888  v_F1: 0.683506  v_AUC: 0.906206
steps 10200    running time 366 seconds

steps 10400    base_loss: 0.241084    reg_loss: 0.224826    l2_loss: 0.024723    loss: 0.490633
steps 10400    v_Prec: 0.697113  v_Recall: 0.672498  v_F1: 0.684585  v_AUC: 0.905823
steps 10400    running time 372 seconds

steps 10600    base_loss: 0.241868    reg_loss: 0.221898    l2_loss: 0.024834    loss: 0.488599
steps 10600    v_Prec: 0.691115  v_Recall: 0.676029  v_F1: 0.683489  v_AUC: 0.905355
steps 10600    running time 379 seconds

steps 10800    base_loss: 0.245535    reg_loss: 0.221374    l2_loss: 0.024798    loss: 0.491706
steps 10800    v_Prec: 0.670604  v_Recall: 0.697135  v_F1: 0.683612  v_AUC: 0.906345
steps 10800    running time 385 seconds

steps 11000    base_loss: 0.181299    reg_loss: 0.195611    l2_loss: 0.025187    loss: 0.402096
steps 11000    v_Prec: 0.698980  v_Recall: 0.648664  v_F1: 0.672882  v_AUC: 0.896917
steps 11000    running time 392 seconds

steps 11200    base_loss: 0.173112    reg_loss: 0.194555    l2_loss: 0.025406    loss: 0.393074
steps 11200    v_Prec: 0.716397  v_Recall: 0.626194  v_F1: 0.668265  v_AUC: 0.892232
steps 11200    running time 398 seconds

steps 11400    base_loss: 0.175080    reg_loss: 0.195586    l2_loss: 0.025778    loss: 0.396445
steps 11400    v_Prec: 0.677104  v_Recall: 0.655967  v_F1: 0.666368  v_AUC: 0.893780
steps 11400    running time 404 seconds

steps 11600    base_loss: 0.186852    reg_loss: 0.200799    l2_loss: 0.026010    loss: 0.413661
steps 11600    v_Prec: 0.672582  v_Recall: 0.660059  v_F1: 0.666262  v_AUC: 0.894891
steps 11600    running time 410 seconds

steps 11800    base_loss: 0.177280    reg_loss: 0.196665    l2_loss: 0.026147    loss: 0.400092
steps 11800    v_Prec: 0.670101  v_Recall: 0.668165  v_F1: 0.669131  v_AUC: 0.892175
steps 11800    running time 416 seconds

steps 12000    base_loss: 0.184740    reg_loss: 0.200330    l2_loss: 0.026321    loss: 0.411391
steps 12000    v_Prec: 0.668806  v_Recall: 0.677393  v_F1: 0.673072  v_AUC: 0.896108
steps 12000    running time 422 seconds

steps 12200    base_loss: 0.185924    reg_loss: 0.197614    l2_loss: 0.026529    loss: 0.410067
steps 12200    v_Prec: 0.690446  v_Recall: 0.654763  v_F1: 0.672131  v_AUC: 0.894467
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.188875    reg_loss: 0.201073    l2_loss: 0.026541    loss: 0.416489
steps 12400    v_Prec: 0.687969  v_Recall: 0.661745  v_F1: 0.674602  v_AUC: 0.895128
steps 12400    running time 435 seconds

Early stop model F1: 0.684585
testing thre: 0.3252774
testing Prec: 0.43264340305164956
testing Recall: 0.7731227217496962
testing F1: 0.5548114819852813
testing AUC: 0.867850733485775
overall running time 438 seconds
(0.601939910101727, 0.6183232077764277, 0.6100215775593383, 0.867850733485775, 0.6327913)

2019-02-24 19:13:49.814680: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:13:50.848634: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:13:50.859603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:13:50.859669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.200000 seconds
loading data in 29.210000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.022453    reg_loss: 0.648036    l2_loss: 0.013317    loss: 1.683806
steps 200    v_Prec: 0.165955  v_Recall: 1.000000  v_F1: 0.284669  v_AUC: 0.524676
steps 200    running time 39 seconds

steps 400    base_loss: 0.637326    reg_loss: 0.641375    l2_loss: 0.013220    loss: 1.291921
steps 400    v_Prec: 0.165947  v_Recall: 0.999685  v_F1: 0.284643  v_AUC: 0.520065
steps 400    running time 46 seconds

steps 600    base_loss: 0.494802    reg_loss: 0.630163    l2_loss: 0.013073    loss: 1.138038
steps 600    v_Prec: 0.165985  v_Recall: 0.998820  v_F1: 0.284664  v_AUC: 0.523542
steps 600    running time 52 seconds

steps 800    base_loss: 0.484251    reg_loss: 0.612129    l2_loss: 0.012972    loss: 1.109352
steps 800    v_Prec: 0.177305  v_Recall: 0.726272  v_F1: 0.285027  v_AUC: 0.546161
steps 800    running time 58 seconds

steps 1000    base_loss: 0.475431    reg_loss: 0.588895    l2_loss: 0.012820    loss: 1.077147
steps 1000    v_Prec: 0.188060  v_Recall: 0.702760  v_F1: 0.296718  v_AUC: 0.579180
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.457102    reg_loss: 0.564071    l2_loss: 0.012714    loss: 1.033887
steps 1200    v_Prec: 0.262389  v_Recall: 0.484234  v_F1: 0.340353  v_AUC: 0.645532
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.438644    reg_loss: 0.536239    l2_loss: 0.012605    loss: 0.987489
steps 1400    v_Prec: 0.327867  v_Recall: 0.440198  v_F1: 0.375818  v_AUC: 0.683831
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.432824    reg_loss: 0.516274    l2_loss: 0.012630    loss: 0.961728
steps 1600    v_Prec: 0.389236  v_Recall: 0.430526  v_F1: 0.408841  v_AUC: 0.722987
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.413722    reg_loss: 0.496620    l2_loss: 0.012734    loss: 0.923077
steps 1800    v_Prec: 0.451366  v_Recall: 0.427302  v_F1: 0.439005  v_AUC: 0.748965
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.396075    reg_loss: 0.478524    l2_loss: 0.012840    loss: 0.887439
steps 2000    v_Prec: 0.482448  v_Recall: 0.442007  v_F1: 0.461343  v_AUC: 0.766252
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.380168    reg_loss: 0.461283    l2_loss: 0.013021    loss: 0.854472
steps 2200    v_Prec: 0.541025  v_Recall: 0.436581  v_F1: 0.483224  v_AUC: 0.799107
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.369100    reg_loss: 0.445430    l2_loss: 0.013197    loss: 0.827727
steps 2400    v_Prec: 0.430002  v_Recall: 0.658646  v_F1: 0.520313  v_AUC: 0.818482
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.363064    reg_loss: 0.436016    l2_loss: 0.013487    loss: 0.812566
steps 2600    v_Prec: 0.449010  v_Recall: 0.634977  v_F1: 0.526041  v_AUC: 0.826293
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.360196    reg_loss: 0.423779    l2_loss: 0.013710    loss: 0.797685
steps 2800    v_Prec: 0.468814  v_Recall: 0.634190  v_F1: 0.539104  v_AUC: 0.832431
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.347017    reg_loss: 0.408944    l2_loss: 0.014051    loss: 0.770012
steps 3000    v_Prec: 0.466391  v_Recall: 0.674923  v_F1: 0.551607  v_AUC: 0.839015
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.341715    reg_loss: 0.397820    l2_loss: 0.014258    loss: 0.753794
steps 3200    v_Prec: 0.504282  v_Recall: 0.634348  v_F1: 0.561886  v_AUC: 0.845036
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.334754    reg_loss: 0.384882    l2_loss: 0.014638    loss: 0.734275
steps 3400    v_Prec: 0.508526  v_Recall: 0.649603  v_F1: 0.570472  v_AUC: 0.848451
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.334334    reg_loss: 0.374755    l2_loss: 0.014940    loss: 0.724028
steps 3600    v_Prec: 0.502656  v_Recall: 0.662263  v_F1: 0.571526  v_AUC: 0.850872
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.335233    reg_loss: 0.363474    l2_loss: 0.015223    loss: 0.713930
steps 3800    v_Prec: 0.531557  v_Recall: 0.643076  v_F1: 0.582023  v_AUC: 0.854036
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.335928    reg_loss: 0.351515    l2_loss: 0.015523    loss: 0.702966
steps 4000    v_Prec: 0.547198  v_Recall: 0.641818  v_F1: 0.590743  v_AUC: 0.859458
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.332709    reg_loss: 0.342995    l2_loss: 0.015723    loss: 0.691427
steps 4200    v_Prec: 0.533446  v_Recall: 0.643391  v_F1: 0.583283  v_AUC: 0.857364
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.322663    reg_loss: 0.329636    l2_loss: 0.016080    loss: 0.668379
steps 4400    v_Prec: 0.555928  v_Recall: 0.638201  v_F1: 0.594230  v_AUC: 0.862770
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.322929    reg_loss: 0.318791    l2_loss: 0.016423    loss: 0.658143
steps 4600    v_Prec: 0.549122  v_Recall: 0.651805  v_F1: 0.596074  v_AUC: 0.863640
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.322806    reg_loss: 0.305215    l2_loss: 0.016726    loss: 0.644746
steps 4800    v_Prec: 0.550793  v_Recall: 0.663836  v_F1: 0.602054  v_AUC: 0.865309
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.316736    reg_loss: 0.295992    l2_loss: 0.017013    loss: 0.629741
steps 5000    v_Prec: 0.551268  v_Recall: 0.652748  v_F1: 0.597732  v_AUC: 0.865010
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.315855    reg_loss: 0.285198    l2_loss: 0.017423    loss: 0.618476
steps 5200    v_Prec: 0.544955  v_Recall: 0.662499  v_F1: 0.598005  v_AUC: 0.866040
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.316274    reg_loss: 0.275310    l2_loss: 0.017871    loss: 0.609455
steps 5400    v_Prec: 0.553710  v_Recall: 0.655422  v_F1: 0.600288  v_AUC: 0.867326
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.279644    reg_loss: 0.242608    l2_loss: 0.018104    loss: 0.540356
steps 5600    v_Prec: 0.546524  v_Recall: 0.664622  v_F1: 0.599815  v_AUC: 0.864915
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.280121    reg_loss: 0.239695    l2_loss: 0.018282    loss: 0.538097
steps 5800    v_Prec: 0.543995  v_Recall: 0.682079  v_F1: 0.605261  v_AUC: 0.864732
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.286608    reg_loss: 0.238324    l2_loss: 0.018555    loss: 0.543487
steps 6000    v_Prec: 0.548491  v_Recall: 0.681765  v_F1: 0.607909  v_AUC: 0.868476
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.288871    reg_loss: 0.238777    l2_loss: 0.018794    loss: 0.546442
steps 6200    v_Prec: 0.565330  v_Recall: 0.670598  v_F1: 0.613481  v_AUC: 0.870252
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.284523    reg_loss: 0.233809    l2_loss: 0.018961    loss: 0.537293
steps 6400    v_Prec: 0.561632  v_Recall: 0.677518  v_F1: 0.614156  v_AUC: 0.868251
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.283830    reg_loss: 0.229328    l2_loss: 0.019235    loss: 0.532392
steps 6600    v_Prec: 0.575801  v_Recall: 0.659747  v_F1: 0.614922  v_AUC: 0.868084
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.291065    reg_loss: 0.227433    l2_loss: 0.019420    loss: 0.537918
steps 6800    v_Prec: 0.569849  v_Recall: 0.680664  v_F1: 0.620346  v_AUC: 0.873944
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.281334    reg_loss: 0.221395    l2_loss: 0.019565    loss: 0.522294
steps 7000    v_Prec: 0.585511  v_Recall: 0.657152  v_F1: 0.619266  v_AUC: 0.876336
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.289442    reg_loss: 0.220221    l2_loss: 0.019760    loss: 0.529423
steps 7200    v_Prec: 0.584582  v_Recall: 0.669026  v_F1: 0.623960  v_AUC: 0.874439
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.287266    reg_loss: 0.216144    l2_loss: 0.019657    loss: 0.523066
steps 7400    v_Prec: 0.568290  v_Recall: 0.697570  v_F1: 0.626328  v_AUC: 0.878243
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.283197    reg_loss: 0.212089    l2_loss: 0.019679    loss: 0.514965
steps 7600    v_Prec: 0.579926  v_Recall: 0.681529  v_F1: 0.626636  v_AUC: 0.876484
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.287686    reg_loss: 0.213248    l2_loss: 0.019960    loss: 0.520894
steps 7800    v_Prec: 0.567619  v_Recall: 0.702996  v_F1: 0.628096  v_AUC: 0.880199
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.287649    reg_loss: 0.208803    l2_loss: 0.019925    loss: 0.516377
steps 8000    v_Prec: 0.578054  v_Recall: 0.690965  v_F1: 0.629486  v_AUC: 0.880412
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.284264    reg_loss: 0.207905    l2_loss: 0.020074    loss: 0.512244
steps 8200    v_Prec: 0.583200  v_Recall: 0.686247  v_F1: 0.630541  v_AUC: 0.881531
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.282858    reg_loss: 0.203308    l2_loss: 0.020179    loss: 0.506345
steps 8400    v_Prec: 0.579340  v_Recall: 0.696784  v_F1: 0.632657  v_AUC: 0.881664
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.284046    reg_loss: 0.200835    l2_loss: 0.020263    loss: 0.505144
steps 8600    v_Prec: 0.572760  v_Recall: 0.710624  v_F1: 0.634287  v_AUC: 0.882250
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.283681    reg_loss: 0.199144    l2_loss: 0.020369    loss: 0.503194
steps 8800    v_Prec: 0.593688  v_Recall: 0.677440  v_F1: 0.632804  v_AUC: 0.881877
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.288046    reg_loss: 0.201769    l2_loss: 0.020559    loss: 0.510375
steps 9000    v_Prec: 0.599037  v_Recall: 0.675159  v_F1: 0.634824  v_AUC: 0.884244
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.291038    reg_loss: 0.198488    l2_loss: 0.020446    loss: 0.509972
steps 9200    v_Prec: 0.582550  v_Recall: 0.711410  v_F1: 0.640564  v_AUC: 0.883648
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.289697    reg_loss: 0.196632    l2_loss: 0.020535    loss: 0.506865
steps 9400    v_Prec: 0.596695  v_Recall: 0.695604  v_F1: 0.642364  v_AUC: 0.885075
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.278858    reg_loss: 0.190429    l2_loss: 0.020664    loss: 0.489951
steps 9600    v_Prec: 0.605740  v_Recall: 0.683809  v_F1: 0.642411  v_AUC: 0.885948
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.276567    reg_loss: 0.189244    l2_loss: 0.020721    loss: 0.486532
steps 9800    v_Prec: 0.584504  v_Recall: 0.706535  v_F1: 0.639752  v_AUC: 0.885676
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.284979    reg_loss: 0.192365    l2_loss: 0.020789    loss: 0.498133
steps 10000    v_Prec: 0.600028  v_Recall: 0.685146  v_F1: 0.639768  v_AUC: 0.884848
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.280496    reg_loss: 0.186038    l2_loss: 0.020696    loss: 0.487231
steps 10200    v_Prec: 0.598505  v_Recall: 0.686089  v_F1: 0.639311  v_AUC: 0.886983
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.279441    reg_loss: 0.184334    l2_loss: 0.020708    loss: 0.484483
steps 10400    v_Prec: 0.594903  v_Recall: 0.693796  v_F1: 0.640555  v_AUC: 0.888190
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.285894    reg_loss: 0.184878    l2_loss: 0.020683    loss: 0.491455
steps 10600    v_Prec: 0.590740  v_Recall: 0.713376  v_F1: 0.646292  v_AUC: 0.889376
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.276704    reg_loss: 0.184691    l2_loss: 0.020867    loss: 0.482262
steps 10800    v_Prec: 0.591034  v_Recall: 0.695604  v_F1: 0.639069  v_AUC: 0.888056
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.234931    reg_loss: 0.167519    l2_loss: 0.020847    loss: 0.423297
steps 11000    v_Prec: 0.609977  v_Recall: 0.674058  v_F1: 0.640418  v_AUC: 0.883685
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.237751    reg_loss: 0.167447    l2_loss: 0.020849    loss: 0.426047
steps 11200    v_Prec: 0.612571  v_Recall: 0.672879  v_F1: 0.641310  v_AUC: 0.884505
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.236484    reg_loss: 0.169687    l2_loss: 0.020787    loss: 0.426959
steps 11400    v_Prec: 0.582475  v_Recall: 0.720296  v_F1: 0.644095  v_AUC: 0.887001
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.232452    reg_loss: 0.169508    l2_loss: 0.020793    loss: 0.422753
steps 11600    v_Prec: 0.610992  v_Recall: 0.671385  v_F1: 0.639766  v_AUC: 0.884569
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.234897    reg_loss: 0.168842    l2_loss: 0.020859    loss: 0.424599
steps 11800    v_Prec: 0.622922  v_Recall: 0.662892  v_F1: 0.642286  v_AUC: 0.885906
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.244001    reg_loss: 0.174340    l2_loss: 0.020993    loss: 0.439335
steps 12000    v_Prec: 0.614542  v_Recall: 0.670598  v_F1: 0.641348  v_AUC: 0.884498
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.253117    reg_loss: 0.177399    l2_loss: 0.020968    loss: 0.451484
steps 12200    v_Prec: 0.608397  v_Recall: 0.690493  v_F1: 0.646851  v_AUC: 0.884378
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.242202    reg_loss: 0.174431    l2_loss: 0.020783    loss: 0.437416
steps 12400    v_Prec: 0.622011  v_Recall: 0.675081  v_F1: 0.647460  v_AUC: 0.885130
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.241535    reg_loss: 0.172986    l2_loss: 0.020803    loss: 0.435325
steps 12600    v_Prec: 0.602293  v_Recall: 0.702131  v_F1: 0.648392  v_AUC: 0.885362
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.247217    reg_loss: 0.177529    l2_loss: 0.020879    loss: 0.445625
steps 12800    v_Prec: 0.622470  v_Recall: 0.679641  v_F1: 0.649801  v_AUC: 0.886373
steps 12800    running time 454 seconds

steps 13000    base_loss: 0.244648    reg_loss: 0.173517    l2_loss: 0.020691    loss: 0.438856
steps 13000    v_Prec: 0.624824  v_Recall: 0.663049  v_F1: 0.643369  v_AUC: 0.884520
steps 13000    running time 461 seconds

steps 13200    base_loss: 0.251430    reg_loss: 0.174053    l2_loss: 0.020750    loss: 0.446233
steps 13200    v_Prec: 0.601634  v_Recall: 0.694739  v_F1: 0.644843  v_AUC: 0.886178
steps 13200    running time 467 seconds

steps 13400    base_loss: 0.250963    reg_loss: 0.178576    l2_loss: 0.020827    loss: 0.450367
steps 13400    v_Prec: 0.601859  v_Recall: 0.697413  v_F1: 0.646122  v_AUC: 0.887191
steps 13400    running time 473 seconds

steps 13600    base_loss: 0.248021    reg_loss: 0.172220    l2_loss: 0.020739    loss: 0.440980
steps 13600    v_Prec: 0.601628  v_Recall: 0.697570  v_F1: 0.646056  v_AUC: 0.886727
steps 13600    running time 479 seconds

steps 13800    base_loss: 0.250920    reg_loss: 0.174546    l2_loss: 0.020896    loss: 0.446362
steps 13800    v_Prec: 0.610677  v_Recall: 0.682708  v_F1: 0.644687  v_AUC: 0.889264
steps 13800    running time 485 seconds

steps 14000    base_loss: 0.241720    reg_loss: 0.170978    l2_loss: 0.020858    loss: 0.433556
steps 14000    v_Prec: 0.589618  v_Recall: 0.708265  v_F1: 0.643518  v_AUC: 0.887463
steps 14000    running time 492 seconds

steps 14200    base_loss: 0.252861    reg_loss: 0.171377    l2_loss: 0.020894    loss: 0.445131
steps 14200    v_Prec: 0.588620  v_Recall: 0.707714  v_F1: 0.642696  v_AUC: 0.885924
steps 14200    running time 498 seconds

steps 14400    base_loss: 0.249945    reg_loss: 0.172343    l2_loss: 0.020874    loss: 0.443163
steps 14400    v_Prec: 0.606984  v_Recall: 0.687505  v_F1: 0.644740  v_AUC: 0.888798
steps 14400    running time 504 seconds

steps 14600    base_loss: 0.255487    reg_loss: 0.175749    l2_loss: 0.020878    loss: 0.452113
steps 14600    v_Prec: 0.613732  v_Recall: 0.678305  v_F1: 0.644405  v_AUC: 0.889315
steps 14600    running time 511 seconds

steps 14800    base_loss: 0.251170    reg_loss: 0.173862    l2_loss: 0.020999    loss: 0.446031
steps 14800    v_Prec: 0.628159  v_Recall: 0.666588  v_F1: 0.646803  v_AUC: 0.891532
steps 14800    running time 517 seconds

Early stop model F1: 0.649801
testing thre: 0.40776703
testing Prec: 0.38513788237545143
testing Recall: 0.7826488456865127
testing F1: 0.5162376174141634
testing AUC: 0.8390347717928132
overall running time 520 seconds
(0.513499376332837, 0.6202673147023087, 0.5618561239764023, 0.8390347717928132, 0.73140174)

2019-02-24 19:19:27.699034: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:19:28.977182: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:19:28.982182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:19:28.982226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.060000 seconds
loading data in 31.130000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.367711    reg_loss: 0.646831    l2_loss: 0.013374    loss: 2.027916
steps 200    v_Prec: 0.164610  v_Recall: 0.999762  v_F1: 0.282678  v_AUC: 0.488750
steps 200    running time 41 seconds

steps 400    base_loss: 0.738008    reg_loss: 0.645033    l2_loss: 0.013621    loss: 1.396662
steps 400    v_Prec: 0.165542  v_Recall: 0.976764  v_F1: 0.283104  v_AUC: 0.512419
steps 400    running time 48 seconds

steps 600    base_loss: 0.498537    reg_loss: 0.638107    l2_loss: 0.013692    loss: 1.150335
steps 600    v_Prec: 0.167957  v_Recall: 0.930531  v_F1: 0.284554  v_AUC: 0.531785
steps 600    running time 55 seconds

steps 800    base_loss: 0.492310    reg_loss: 0.628668    l2_loss: 0.013667    loss: 1.134645
steps 800    v_Prec: 0.167126  v_Recall: 0.948216  v_F1: 0.284166  v_AUC: 0.550662
steps 800    running time 61 seconds

steps 1000    base_loss: 0.474324    reg_loss: 0.614558    l2_loss: 0.013554    loss: 1.102435
steps 1000    v_Prec: 0.179418  v_Recall: 0.763204  v_F1: 0.290536  v_AUC: 0.572798
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.463963    reg_loss: 0.600298    l2_loss: 0.013479    loss: 1.077740
steps 1200    v_Prec: 0.210378  v_Recall: 0.561697  v_F1: 0.306107  v_AUC: 0.604638
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.439944    reg_loss: 0.578412    l2_loss: 0.013431    loss: 1.031786
steps 1400    v_Prec: 0.246680  v_Recall: 0.486122  v_F1: 0.327282  v_AUC: 0.634803
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.441239    reg_loss: 0.561308    l2_loss: 0.013467    loss: 1.016014
steps 1600    v_Prec: 0.313279  v_Recall: 0.428628  v_F1: 0.361986  v_AUC: 0.667778
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.420201    reg_loss: 0.539045    l2_loss: 0.013465    loss: 0.972711
steps 1800    v_Prec: 0.371953  v_Recall: 0.421094  v_F1: 0.395001  v_AUC: 0.697669
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.409438    reg_loss: 0.519893    l2_loss: 0.013647    loss: 0.942978
steps 2000    v_Prec: 0.394984  v_Recall: 0.449643  v_F1: 0.420545  v_AUC: 0.721200
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.403315    reg_loss: 0.502855    l2_loss: 0.013820    loss: 0.919990
steps 2200    v_Prec: 0.437098  v_Recall: 0.463442  v_F1: 0.449885  v_AUC: 0.739096
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.390961    reg_loss: 0.486322    l2_loss: 0.014071    loss: 0.891354
steps 2400    v_Prec: 0.488916  v_Recall: 0.440761  v_F1: 0.463592  v_AUC: 0.747562
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.391426    reg_loss: 0.474843    l2_loss: 0.014270    loss: 0.880540
steps 2600    v_Prec: 0.474462  v_Recall: 0.483981  v_F1: 0.479174  v_AUC: 0.757887
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.380045    reg_loss: 0.458749    l2_loss: 0.014490    loss: 0.853284
steps 2800    v_Prec: 0.499344  v_Recall: 0.483029  v_F1: 0.491051  v_AUC: 0.762267
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.377247    reg_loss: 0.447981    l2_loss: 0.014814    loss: 0.840042
steps 3000    v_Prec: 0.493066  v_Recall: 0.515940  v_F1: 0.504243  v_AUC: 0.772859
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.372227    reg_loss: 0.433961    l2_loss: 0.015123    loss: 0.821310
steps 3200    v_Prec: 0.523251  v_Recall: 0.491673  v_F1: 0.506971  v_AUC: 0.773352
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.375993    reg_loss: 0.424191    l2_loss: 0.015319    loss: 0.815503
steps 3400    v_Prec: 0.508875  v_Recall: 0.516098  v_F1: 0.512461  v_AUC: 0.778108
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.368221    reg_loss: 0.411499    l2_loss: 0.015584    loss: 0.795305
steps 3600    v_Prec: 0.502374  v_Recall: 0.537113  v_F1: 0.519163  v_AUC: 0.783468
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.368977    reg_loss: 0.404763    l2_loss: 0.015844    loss: 0.789583
steps 3800    v_Prec: 0.523862  v_Recall: 0.531007  v_F1: 0.527410  v_AUC: 0.788975
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.364791    reg_loss: 0.393079    l2_loss: 0.015997    loss: 0.773867
steps 4000    v_Prec: 0.527855  v_Recall: 0.542506  v_F1: 0.535080  v_AUC: 0.792777
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.364176    reg_loss: 0.387205    l2_loss: 0.016166    loss: 0.767547
steps 4200    v_Prec: 0.546686  v_Recall: 0.531166  v_F1: 0.538814  v_AUC: 0.800418
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.358175    reg_loss: 0.374302    l2_loss: 0.016464    loss: 0.748941
steps 4400    v_Prec: 0.548415  v_Recall: 0.547502  v_F1: 0.547958  v_AUC: 0.801804
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.348537    reg_loss: 0.365307    l2_loss: 0.016699    loss: 0.730542
steps 4600    v_Prec: 0.538420  v_Recall: 0.560111  v_F1: 0.549052  v_AUC: 0.806088
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.356694    reg_loss: 0.355936    l2_loss: 0.016861    loss: 0.729491
steps 4800    v_Prec: 0.535375  v_Recall: 0.580888  v_F1: 0.557204  v_AUC: 0.810637
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.347388    reg_loss: 0.347334    l2_loss: 0.016887    loss: 0.711609
steps 5000    v_Prec: 0.534034  v_Recall: 0.592308  v_F1: 0.561663  v_AUC: 0.814033
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.345064    reg_loss: 0.338008    l2_loss: 0.016879    loss: 0.699952
steps 5200    v_Prec: 0.553249  v_Recall: 0.585408  v_F1: 0.568875  v_AUC: 0.816970
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.345767    reg_loss: 0.329386    l2_loss: 0.016964    loss: 0.692116
steps 5400    v_Prec: 0.528978  v_Recall: 0.619588  v_F1: 0.570709  v_AUC: 0.821084
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.270814    reg_loss: 0.287997    l2_loss: 0.016891    loss: 0.575702
steps 5600    v_Prec: 0.526778  v_Recall: 0.590484  v_F1: 0.556814  v_AUC: 0.808114
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.272367    reg_loss: 0.283019    l2_loss: 0.016635    loss: 0.572022
steps 5800    v_Prec: 0.544060  v_Recall: 0.548374  v_F1: 0.546209  v_AUC: 0.808810
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.280925    reg_loss: 0.285265    l2_loss: 0.016461    loss: 0.582652
steps 6000    v_Prec: 0.500790  v_Recall: 0.603331  v_F1: 0.547299  v_AUC: 0.810654
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.294279    reg_loss: 0.284481    l2_loss: 0.016299    loss: 0.595059
steps 6200    v_Prec: 0.505188  v_Recall: 0.613878  v_F1: 0.554255  v_AUC: 0.814356
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.291263    reg_loss: 0.277298    l2_loss: 0.016185    loss: 0.584746
steps 6400    v_Prec: 0.529035  v_Recall: 0.576527  v_F1: 0.551761  v_AUC: 0.815689
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.290016    reg_loss: 0.275577    l2_loss: 0.016086    loss: 0.581679
steps 6600    v_Prec: 0.546295  v_Recall: 0.562411  v_F1: 0.554236  v_AUC: 0.817100
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.288754    reg_loss: 0.267119    l2_loss: 0.016093    loss: 0.571965
steps 6800    v_Prec: 0.519001  v_Recall: 0.590246  v_F1: 0.552336  v_AUC: 0.817750
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.289755    reg_loss: 0.263941    l2_loss: 0.016021    loss: 0.569718
steps 7000    v_Prec: 0.528581  v_Recall: 0.584457  v_F1: 0.555116  v_AUC: 0.821186
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.293208    reg_loss: 0.264042    l2_loss: 0.016048    loss: 0.573298
steps 7200    v_Prec: 0.502236  v_Recall: 0.632435  v_F1: 0.559865  v_AUC: 0.823381
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.290575    reg_loss: 0.258578    l2_loss: 0.016091    loss: 0.565244
steps 7400    v_Prec: 0.520327  v_Recall: 0.604917  v_F1: 0.559443  v_AUC: 0.824684
steps 7400    running time 279 seconds

Early stop model F1: 0.570709
testing thre: 0.27858928
testing Prec: 0.3524575956419463
testing Recall: 0.6918104495747266
testing F1: 0.466994750656168
testing AUC: 0.7837091158818239
overall running time 282 seconds
(0.42710784491184883, 0.5734143377885784, 0.4895638823187684, 0.7837091158818239, 0.44523033)

2019-02-24 19:22:37.206106: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:22:37.980324: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:22:37.982530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:22:37.982573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.900000 seconds
loading data in 31.060000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.606660    reg_loss: 2.152021    l2_loss: 0.013374    loss: 2.772055
steps 200    v_Prec: 0.165705  v_Recall: 1.000000  v_F1: 0.284301  v_AUC: 0.478064
steps 200    running time 41 seconds

steps 400    base_loss: 0.513570    reg_loss: 2.127884    l2_loss: 0.013367    loss: 2.654821
steps 400    v_Prec: 0.165705  v_Recall: 1.000000  v_F1: 0.284301  v_AUC: 0.480987
steps 400    running time 48 seconds

steps 600    base_loss: 0.490943    reg_loss: 2.071568    l2_loss: 0.013346    loss: 2.575858
steps 600    v_Prec: 0.166930  v_Recall: 0.975039  v_F1: 0.285057  v_AUC: 0.509405
steps 600    running time 54 seconds

steps 800    base_loss: 0.471838    reg_loss: 1.992833    l2_loss: 0.013262    loss: 2.477932
steps 800    v_Prec: 0.205094  v_Recall: 0.583307  v_F1: 0.303482  v_AUC: 0.592911
steps 800    running time 61 seconds

steps 1000    base_loss: 0.463414    reg_loss: 1.892151    l2_loss: 0.013163    loss: 2.368727
steps 1000    v_Prec: 0.224594  v_Recall: 0.556693  v_F1: 0.320062  v_AUC: 0.629056
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.448087    reg_loss: 1.787002    l2_loss: 0.013186    loss: 2.248276
steps 1200    v_Prec: 0.254627  v_Recall: 0.492913  v_F1: 0.335792  v_AUC: 0.651817
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.425219    reg_loss: 1.688469    l2_loss: 0.013324    loss: 2.127012
steps 1400    v_Prec: 0.275949  v_Recall: 0.554331  v_F1: 0.368471  v_AUC: 0.683210
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.418455    reg_loss: 1.619859    l2_loss: 0.013444    loss: 2.051757
steps 1600    v_Prec: 0.320103  v_Recall: 0.548031  v_F1: 0.404146  v_AUC: 0.718923
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.409253    reg_loss: 1.564013    l2_loss: 0.013637    loss: 1.986903
steps 1800    v_Prec: 0.390512  v_Recall: 0.534724  v_F1: 0.451379  v_AUC: 0.757550
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.388423    reg_loss: 1.510834    l2_loss: 0.013837    loss: 1.913095
steps 2000    v_Prec: 0.418891  v_Recall: 0.562205  v_F1: 0.480081  v_AUC: 0.781540
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.370389    reg_loss: 1.457376    l2_loss: 0.014132    loss: 1.841896
steps 2200    v_Prec: 0.465398  v_Recall: 0.558661  v_F1: 0.507783  v_AUC: 0.799373
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.367577    reg_loss: 1.429930    l2_loss: 0.014442    loss: 1.811949
steps 2400    v_Prec: 0.497252  v_Recall: 0.555591  v_F1: 0.524805  v_AUC: 0.811949
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.350636    reg_loss: 1.367252    l2_loss: 0.014702    loss: 1.732590
steps 2600    v_Prec: 0.504030  v_Recall: 0.576142  v_F1: 0.537679  v_AUC: 0.821371
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.345310    reg_loss: 1.326018    l2_loss: 0.015025    loss: 1.686353
steps 2800    v_Prec: 0.527314  v_Recall: 0.571575  v_F1: 0.548553  v_AUC: 0.828216
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.345201    reg_loss: 1.292137    l2_loss: 0.015322    loss: 1.652660
steps 3000    v_Prec: 0.520472  v_Recall: 0.587559  v_F1: 0.551984  v_AUC: 0.833194
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.342648    reg_loss: 1.246338    l2_loss: 0.015635    loss: 1.604621
steps 3200    v_Prec: 0.548299  v_Recall: 0.582362  v_F1: 0.564817  v_AUC: 0.839552
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.340966    reg_loss: 1.211980    l2_loss: 0.015873    loss: 1.568819
steps 3400    v_Prec: 0.552328  v_Recall: 0.598819  v_F1: 0.574634  v_AUC: 0.841118
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.337390    reg_loss: 1.161441    l2_loss: 0.016242    loss: 1.515074
steps 3600    v_Prec: 0.533563  v_Recall: 0.633386  v_F1: 0.579205  v_AUC: 0.845991
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.334437    reg_loss: 1.114065    l2_loss: 0.016506    loss: 1.465008
steps 3800    v_Prec: 0.551035  v_Recall: 0.622756  v_F1: 0.584704  v_AUC: 0.849682
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.326669    reg_loss: 1.067884    l2_loss: 0.016929    loss: 1.411483
steps 4000    v_Prec: 0.557346  v_Recall: 0.618346  v_F1: 0.586264  v_AUC: 0.849924
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.335312    reg_loss: 1.037953    l2_loss: 0.017327    loss: 1.390593
steps 4200    v_Prec: 0.581503  v_Recall: 0.592126  v_F1: 0.586767  v_AUC: 0.853317
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.330421    reg_loss: 0.993298    l2_loss: 0.017604    loss: 1.341323
steps 4400    v_Prec: 0.563053  v_Recall: 0.631417  v_F1: 0.595279  v_AUC: 0.856708
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.324874    reg_loss: 0.953320    l2_loss: 0.017901    loss: 1.296095
steps 4600    v_Prec: 0.558415  v_Recall: 0.630394  v_F1: 0.592225  v_AUC: 0.856678
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.327913    reg_loss: 0.932053    l2_loss: 0.018329    loss: 1.278295
steps 4800    v_Prec: 0.554584  v_Recall: 0.639213  v_F1: 0.593899  v_AUC: 0.858415
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.325604    reg_loss: 0.903411    l2_loss: 0.018661    loss: 1.247676
steps 5000    v_Prec: 0.552447  v_Recall: 0.637402  v_F1: 0.591891  v_AUC: 0.859262
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.328105    reg_loss: 0.860135    l2_loss: 0.019038    loss: 1.207278
steps 5200    v_Prec: 0.557552  v_Recall: 0.649921  v_F1: 0.600204  v_AUC: 0.860403
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.318154    reg_loss: 0.807025    l2_loss: 0.019265    loss: 1.144444
steps 5400    v_Prec: 0.571980  v_Recall: 0.630079  v_F1: 0.599625  v_AUC: 0.862991
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.296819    reg_loss: 0.706429    l2_loss: 0.019620    loss: 1.022867
steps 5600    v_Prec: 0.587931  v_Recall: 0.582283  v_F1: 0.585094  v_AUC: 0.853962
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.292609    reg_loss: 0.697109    l2_loss: 0.019790    loss: 1.009509
steps 5800    v_Prec: 0.612842  v_Recall: 0.582441  v_F1: 0.597255  v_AUC: 0.857836
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.299922    reg_loss: 0.688814    l2_loss: 0.020078    loss: 1.008814
steps 6000    v_Prec: 0.606255  v_Recall: 0.587638  v_F1: 0.596801  v_AUC: 0.859353
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.295989    reg_loss: 0.681936    l2_loss: 0.020369    loss: 0.998294
steps 6200    v_Prec: 0.577272  v_Recall: 0.611181  v_F1: 0.593743  v_AUC: 0.859145
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.300204    reg_loss: 0.674281    l2_loss: 0.020694    loss: 0.995179
steps 6400    v_Prec: 0.588082  v_Recall: 0.602992  v_F1: 0.595444  v_AUC: 0.859048
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.297769    reg_loss: 0.656669    l2_loss: 0.020767    loss: 0.975205
steps 6600    v_Prec: 0.572279  v_Recall: 0.628425  v_F1: 0.599039  v_AUC: 0.862906
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.304133    reg_loss: 0.669080    l2_loss: 0.020919    loss: 0.994132
steps 6800    v_Prec: 0.568711  v_Recall: 0.644882  v_F1: 0.604406  v_AUC: 0.864541
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.296667    reg_loss: 0.644804    l2_loss: 0.020940    loss: 0.962410
steps 7000    v_Prec: 0.588339  v_Recall: 0.633228  v_F1: 0.609959  v_AUC: 0.865740
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.299354    reg_loss: 0.647096    l2_loss: 0.021017    loss: 0.967466
steps 7200    v_Prec: 0.568031  v_Recall: 0.665669  v_F1: 0.612986  v_AUC: 0.868734
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.302256    reg_loss: 0.641359    l2_loss: 0.021173    loss: 0.964788
steps 7400    v_Prec: 0.572495  v_Recall: 0.651969  v_F1: 0.609653  v_AUC: 0.867441
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.295841    reg_loss: 0.627131    l2_loss: 0.021177    loss: 0.944148
steps 7600    v_Prec: 0.581843  v_Recall: 0.637874  v_F1: 0.608572  v_AUC: 0.867901
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.307790    reg_loss: 0.629595    l2_loss: 0.021398    loss: 0.958782
steps 7800    v_Prec: 0.603351  v_Recall: 0.623780  v_F1: 0.613395  v_AUC: 0.871231
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.293509    reg_loss: 0.611304    l2_loss: 0.021447    loss: 0.926260
steps 8000    v_Prec: 0.590493  v_Recall: 0.640709  v_F1: 0.614577  v_AUC: 0.872682
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.292176    reg_loss: 0.588059    l2_loss: 0.021454    loss: 0.901688
steps 8200    v_Prec: 0.607156  v_Recall: 0.638661  v_F1: 0.622510  v_AUC: 0.874152
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.298717    reg_loss: 0.602396    l2_loss: 0.021557    loss: 0.922670
steps 8400    v_Prec: 0.571448  v_Recall: 0.677638  v_F1: 0.620029  v_AUC: 0.873245
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.306213    reg_loss: 0.608618    l2_loss: 0.021654    loss: 0.936485
steps 8600    v_Prec: 0.591158  v_Recall: 0.653858  v_F1: 0.620929  v_AUC: 0.873856
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.298224    reg_loss: 0.595445    l2_loss: 0.021651    loss: 0.915320
steps 8800    v_Prec: 0.580736  v_Recall: 0.668898  v_F1: 0.621707  v_AUC: 0.874504
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.302788    reg_loss: 0.594193    l2_loss: 0.021706    loss: 0.918687
steps 9000    v_Prec: 0.587604  v_Recall: 0.659921  v_F1: 0.621667  v_AUC: 0.873506
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.293237    reg_loss: 0.580367    l2_loss: 0.021754    loss: 0.895359
steps 9200    v_Prec: 0.566166  v_Recall: 0.688583  v_F1: 0.621403  v_AUC: 0.873930
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.299879    reg_loss: 0.587512    l2_loss: 0.021806    loss: 0.909198
steps 9400    v_Prec: 0.568794  v_Recall: 0.694646  v_F1: 0.625452  v_AUC: 0.876085
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.299528    reg_loss: 0.579031    l2_loss: 0.021815    loss: 0.900374
steps 9600    v_Prec: 0.581056  v_Recall: 0.678189  v_F1: 0.625877  v_AUC: 0.875844
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.297705    reg_loss: 0.575099    l2_loss: 0.021840    loss: 0.894644
steps 9800    v_Prec: 0.577199  v_Recall: 0.678504  v_F1: 0.623765  v_AUC: 0.876722
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.304295    reg_loss: 0.583603    l2_loss: 0.021849    loss: 0.909746
steps 10000    v_Prec: 0.583812  v_Recall: 0.672441  v_F1: 0.625000  v_AUC: 0.878140
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.297518    reg_loss: 0.568148    l2_loss: 0.021813    loss: 0.887479
steps 10200    v_Prec: 0.576598  v_Recall: 0.697638  v_F1: 0.631369  v_AUC: 0.878959
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.300543    reg_loss: 0.571204    l2_loss: 0.021681    loss: 0.893428
steps 10400    v_Prec: 0.600057  v_Recall: 0.664409  v_F1: 0.630596  v_AUC: 0.877765
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.293205    reg_loss: 0.559741    l2_loss: 0.021742    loss: 0.874688
steps 10600    v_Prec: 0.580410  v_Recall: 0.690551  v_F1: 0.630708  v_AUC: 0.879264
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.289535    reg_loss: 0.559371    l2_loss: 0.021775    loss: 0.870681
steps 10800    v_Prec: 0.633429  v_Recall: 0.628740  v_F1: 0.631076  v_AUC: 0.878172
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.254359    reg_loss: 0.496741    l2_loss: 0.021928    loss: 0.773028
steps 11000    v_Prec: 0.644347  v_Recall: 0.615276  v_F1: 0.629476  v_AUC: 0.874156
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.256639    reg_loss: 0.513711    l2_loss: 0.021923    loss: 0.792273
steps 11200    v_Prec: 0.615483  v_Recall: 0.642283  v_F1: 0.628598  v_AUC: 0.876342
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.257210    reg_loss: 0.513334    l2_loss: 0.021922    loss: 0.792467
steps 11400    v_Prec: 0.626007  v_Recall: 0.623937  v_F1: 0.624970  v_AUC: 0.874187
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.260237    reg_loss: 0.514440    l2_loss: 0.022029    loss: 0.796707
steps 11600    v_Prec: 0.628109  v_Recall: 0.620394  v_F1: 0.624228  v_AUC: 0.874231
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.265640    reg_loss: 0.522640    l2_loss: 0.022119    loss: 0.810398
steps 11800    v_Prec: 0.620093  v_Recall: 0.626929  v_F1: 0.623493  v_AUC: 0.871489
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.268003    reg_loss: 0.522632    l2_loss: 0.021955    loss: 0.812591
steps 12000    v_Prec: 0.650393  v_Recall: 0.598976  v_F1: 0.623627  v_AUC: 0.872459
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.263226    reg_loss: 0.512963    l2_loss: 0.021928    loss: 0.798117
steps 12200    v_Prec: 0.659510  v_Recall: 0.599843  v_F1: 0.628263  v_AUC: 0.873931
steps 12200    running time 431 seconds

Early stop model F1: 0.631369
testing thre: 0.22679125
testing Prec: 0.38524384742619416
testing Recall: 0.7471202916160389
testing F1: 0.5083585495312268
testing AUC: 0.8223000877448324
overall running time 434 seconds
(0.4697679691633285, 0.604179829890644, 0.5285626209154496, 0.8223000877448324, 0.45479625)

2019-02-24 19:27:17.296811: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:27:18.077346: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:27:18.078250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:27:18.078285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.680000 seconds
loading data in 29.770000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.548173    reg_loss: 2.164590    l2_loss: 0.013340    loss: 2.726104
steps 200    v_Prec: 0.163656  v_Recall: 1.000000  v_F1: 0.281279  v_AUC: 0.523175
steps 200    running time 39 seconds

steps 400    base_loss: 0.511998    reg_loss: 2.134393    l2_loss: 0.013313    loss: 2.659704
steps 400    v_Prec: 0.173920  v_Recall: 0.814020  v_F1: 0.286605  v_AUC: 0.556807
steps 400    running time 46 seconds

steps 600    base_loss: 0.472008    reg_loss: 2.082049    l2_loss: 0.013259    loss: 2.567315
steps 600    v_Prec: 0.179720  v_Recall: 0.803573  v_F1: 0.293744  v_AUC: 0.573522
steps 600    running time 53 seconds

steps 800    base_loss: 0.462021    reg_loss: 2.017772    l2_loss: 0.013222    loss: 2.493015
steps 800    v_Prec: 0.210309  v_Recall: 0.634181  v_F1: 0.315869  v_AUC: 0.618354
steps 800    running time 60 seconds

steps 1000    base_loss: 0.446706    reg_loss: 1.914644    l2_loss: 0.013163    loss: 2.374513
steps 1000    v_Prec: 0.227402  v_Recall: 0.605710  v_F1: 0.330663  v_AUC: 0.650352
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.431238    reg_loss: 1.809508    l2_loss: 0.013196    loss: 2.253942
steps 1200    v_Prec: 0.275050  v_Recall: 0.482495  v_F1: 0.350369  v_AUC: 0.673582
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.421345    reg_loss: 1.718891    l2_loss: 0.013241    loss: 2.153477
steps 1400    v_Prec: 0.294961  v_Recall: 0.520057  v_F1: 0.376425  v_AUC: 0.703179
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.419929    reg_loss: 1.652045    l2_loss: 0.013292    loss: 2.085266
steps 1600    v_Prec: 0.350572  v_Recall: 0.503310  v_F1: 0.413281  v_AUC: 0.737375
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.404483    reg_loss: 1.588417    l2_loss: 0.013512    loss: 2.006412
steps 1800    v_Prec: 0.385849  v_Recall: 0.523646  v_F1: 0.444309  v_AUC: 0.761579
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.388557    reg_loss: 1.533044    l2_loss: 0.013684    loss: 1.935286
steps 2000    v_Prec: 0.441029  v_Recall: 0.538879  v_F1: 0.485068  v_AUC: 0.786744
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.373714    reg_loss: 1.484610    l2_loss: 0.013915    loss: 1.872239
steps 2200    v_Prec: 0.468971  v_Recall: 0.564718  v_F1: 0.512410  v_AUC: 0.804482
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.356140    reg_loss: 1.429541    l2_loss: 0.014123    loss: 1.799804
steps 2400    v_Prec: 0.495510  v_Recall: 0.572055  v_F1: 0.531038  v_AUC: 0.816587
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.358203    reg_loss: 1.393178    l2_loss: 0.014346    loss: 1.765727
steps 2600    v_Prec: 0.512238  v_Recall: 0.585852  v_F1: 0.546577  v_AUC: 0.827827
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.347016    reg_loss: 1.338946    l2_loss: 0.014598    loss: 1.700560
steps 2800    v_Prec: 0.524231  v_Recall: 0.581466  v_F1: 0.551367  v_AUC: 0.833268
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.349262    reg_loss: 1.304857    l2_loss: 0.014810    loss: 1.668929
steps 3000    v_Prec: 0.553997  v_Recall: 0.576442  v_F1: 0.564996  v_AUC: 0.842168
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.337245    reg_loss: 1.255903    l2_loss: 0.015064    loss: 1.608212
steps 3200    v_Prec: 0.527284  v_Recall: 0.619587  v_F1: 0.569721  v_AUC: 0.843439
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.329799    reg_loss: 1.195277    l2_loss: 0.015330    loss: 1.540407
steps 3400    v_Prec: 0.523076  v_Recall: 0.639046  v_F1: 0.575275  v_AUC: 0.848146
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.337506    reg_loss: 1.170549    l2_loss: 0.015717    loss: 1.523772
steps 3600    v_Prec: 0.519280  v_Recall: 0.628280  v_F1: 0.568603  v_AUC: 0.845640
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.331904    reg_loss: 1.126861    l2_loss: 0.015987    loss: 1.474753
steps 3800    v_Prec: 0.538040  v_Recall: 0.634500  v_F1: 0.582303  v_AUC: 0.852905
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.324590    reg_loss: 1.074898    l2_loss: 0.016373    loss: 1.415862
steps 4000    v_Prec: 0.561301  v_Recall: 0.606827  v_F1: 0.583177  v_AUC: 0.855775
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.327534    reg_loss: 1.036523    l2_loss: 0.016622    loss: 1.380679
steps 4200    v_Prec: 0.564012  v_Recall: 0.613446  v_F1: 0.587691  v_AUC: 0.857738
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.322468    reg_loss: 0.995020    l2_loss: 0.016993    loss: 1.334482
steps 4400    v_Prec: 0.542070  v_Recall: 0.625807  v_F1: 0.580937  v_AUC: 0.853077
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.328927    reg_loss: 0.960899    l2_loss: 0.017255    loss: 1.307082
steps 4600    v_Prec: 0.542633  v_Recall: 0.651168  v_F1: 0.591967  v_AUC: 0.860492
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.327086    reg_loss: 0.925441    l2_loss: 0.017547    loss: 1.270075
steps 4800    v_Prec: 0.544058  v_Recall: 0.660818  v_F1: 0.596781  v_AUC: 0.862855
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.324950    reg_loss: 0.898255    l2_loss: 0.017837    loss: 1.241042
steps 5000    v_Prec: 0.550077  v_Recall: 0.656591  v_F1: 0.598633  v_AUC: 0.863072
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.320847    reg_loss: 0.861607    l2_loss: 0.018244    loss: 1.200697
steps 5200    v_Prec: 0.574130  v_Recall: 0.631869  v_F1: 0.601617  v_AUC: 0.863956
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.318645    reg_loss: 0.815820    l2_loss: 0.018632    loss: 1.153097
steps 5400    v_Prec: 0.543046  v_Recall: 0.667039  v_F1: 0.598690  v_AUC: 0.865259
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.294176    reg_loss: 0.707354    l2_loss: 0.018970    loss: 1.020500
steps 5600    v_Prec: 0.575677  v_Recall: 0.625169  v_F1: 0.599404  v_AUC: 0.859200
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.292213    reg_loss: 0.700645    l2_loss: 0.019257    loss: 1.012115
steps 5800    v_Prec: 0.580442  v_Recall: 0.617753  v_F1: 0.598516  v_AUC: 0.859228
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.293425    reg_loss: 0.686733    l2_loss: 0.019591    loss: 0.999749
steps 6000    v_Prec: 0.585926  v_Recall: 0.614244  v_F1: 0.599751  v_AUC: 0.859567
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.295605    reg_loss: 0.671308    l2_loss: 0.019722    loss: 0.986635
steps 6200    v_Prec: 0.588417  v_Recall: 0.609299  v_F1: 0.598676  v_AUC: 0.859612
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.294711    reg_loss: 0.675953    l2_loss: 0.020044    loss: 0.990708
steps 6400    v_Prec: 0.563858  v_Recall: 0.649972  v_F1: 0.603860  v_AUC: 0.864883
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.298597    reg_loss: 0.665868    l2_loss: 0.020310    loss: 0.984775
steps 6600    v_Prec: 0.567528  v_Recall: 0.644788  v_F1: 0.603696  v_AUC: 0.867802
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.301402    reg_loss: 0.664239    l2_loss: 0.020390    loss: 0.986031
steps 6800    v_Prec: 0.608776  v_Recall: 0.602999  v_F1: 0.605874  v_AUC: 0.869457
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.293233    reg_loss: 0.636157    l2_loss: 0.020606    loss: 0.949995
steps 7000    v_Prec: 0.575218  v_Recall: 0.657150  v_F1: 0.613460  v_AUC: 0.869332
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.299300    reg_loss: 0.647509    l2_loss: 0.020863    loss: 0.967672
steps 7200    v_Prec: 0.581126  v_Recall: 0.656113  v_F1: 0.616347  v_AUC: 0.870992
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.294807    reg_loss: 0.630185    l2_loss: 0.020801    loss: 0.945793
steps 7400    v_Prec: 0.597719  v_Recall: 0.639525  v_F1: 0.617916  v_AUC: 0.869650
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.295140    reg_loss: 0.626582    l2_loss: 0.020970    loss: 0.942691
steps 7600    v_Prec: 0.608859  v_Recall: 0.621581  v_F1: 0.615154  v_AUC: 0.870889
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.293973    reg_loss: 0.612428    l2_loss: 0.020998    loss: 0.927399
steps 7800    v_Prec: 0.591953  v_Recall: 0.647659  v_F1: 0.618554  v_AUC: 0.873912
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.294649    reg_loss: 0.607394    l2_loss: 0.021021    loss: 0.923064
steps 8000    v_Prec: 0.569318  v_Recall: 0.679241  v_F1: 0.619441  v_AUC: 0.873553
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.292575    reg_loss: 0.605017    l2_loss: 0.021099    loss: 0.918692
steps 8200    v_Prec: 0.577736  v_Recall: 0.678364  v_F1: 0.624019  v_AUC: 0.876092
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.295479    reg_loss: 0.608451    l2_loss: 0.021131    loss: 0.925062
steps 8400    v_Prec: 0.560127  v_Recall: 0.702448  v_F1: 0.623266  v_AUC: 0.875960
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.294576    reg_loss: 0.603545    l2_loss: 0.021210    loss: 0.919331
steps 8600    v_Prec: 0.581849  v_Recall: 0.674934  v_F1: 0.624945  v_AUC: 0.878081
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.293322    reg_loss: 0.594421    l2_loss: 0.021291    loss: 0.909033
steps 8800    v_Prec: 0.577731  v_Recall: 0.681952  v_F1: 0.625530  v_AUC: 0.877519
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.294297    reg_loss: 0.577470    l2_loss: 0.021305    loss: 0.893072
steps 9000    v_Prec: 0.581611  v_Recall: 0.686578  v_F1: 0.629750  v_AUC: 0.881101
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.292711    reg_loss: 0.585856    l2_loss: 0.021434    loss: 0.900001
steps 9200    v_Prec: 0.611380  v_Recall: 0.653800  v_F1: 0.631879  v_AUC: 0.880491
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.291671    reg_loss: 0.571921    l2_loss: 0.021516    loss: 0.885109
steps 9400    v_Prec: 0.580111  v_Recall: 0.698780  v_F1: 0.633940  v_AUC: 0.884104
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.295355    reg_loss: 0.586802    l2_loss: 0.021487    loss: 0.903644
steps 9600    v_Prec: 0.574245  v_Recall: 0.708430  v_F1: 0.634319  v_AUC: 0.882226
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.290726    reg_loss: 0.576241    l2_loss: 0.021381    loss: 0.888347
steps 9800    v_Prec: 0.613546  v_Recall: 0.661058  v_F1: 0.636416  v_AUC: 0.883224
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.293150    reg_loss: 0.574424    l2_loss: 0.021444    loss: 0.889017
steps 10000    v_Prec: 0.580639  v_Recall: 0.703166  v_F1: 0.636055  v_AUC: 0.885683
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.292128    reg_loss: 0.569924    l2_loss: 0.021651    loss: 0.883703
steps 10200    v_Prec: 0.591782  v_Recall: 0.698301  v_F1: 0.640644  v_AUC: 0.884955
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.291794    reg_loss: 0.564841    l2_loss: 0.021816    loss: 0.878452
steps 10400    v_Prec: 0.586672  v_Recall: 0.697185  v_F1: 0.637172  v_AUC: 0.885866
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.297750    reg_loss: 0.572701    l2_loss: 0.021856    loss: 0.892307
steps 10600    v_Prec: 0.593792  v_Recall: 0.698780  v_F1: 0.642022  v_AUC: 0.887793
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.290969    reg_loss: 0.555895    l2_loss: 0.021808    loss: 0.868672
steps 10800    v_Prec: 0.582502  v_Recall: 0.716804  v_F1: 0.642712  v_AUC: 0.886366
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.258529    reg_loss: 0.507359    l2_loss: 0.021936    loss: 0.787824
steps 11000    v_Prec: 0.568300  v_Recall: 0.732594  v_F1: 0.640072  v_AUC: 0.879476
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.249514    reg_loss: 0.498771    l2_loss: 0.021922    loss: 0.770206
steps 11200    v_Prec: 0.606415  v_Recall: 0.666481  v_F1: 0.635030  v_AUC: 0.876006
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.255348    reg_loss: 0.508874    l2_loss: 0.021916    loss: 0.786138
steps 11400    v_Prec: 0.596912  v_Recall: 0.675173  v_F1: 0.633635  v_AUC: 0.872689
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.262270    reg_loss: 0.515021    l2_loss: 0.022040    loss: 0.799332
steps 11600    v_Prec: 0.589030  v_Recall: 0.678284  v_F1: 0.630514  v_AUC: 0.880012
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.265024    reg_loss: 0.525723    l2_loss: 0.021992    loss: 0.812738
steps 11800    v_Prec: 0.604531  v_Recall: 0.663929  v_F1: 0.632839  v_AUC: 0.879496
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.257360    reg_loss: 0.518635    l2_loss: 0.022118    loss: 0.798112
steps 12000    v_Prec: 0.657582  v_Recall: 0.604195  v_F1: 0.629759  v_AUC: 0.877019
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.266622    reg_loss: 0.523585    l2_loss: 0.021816    loss: 0.812024
steps 12200    v_Prec: 0.621615  v_Recall: 0.638966  v_F1: 0.630171  v_AUC: 0.880330
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.258582    reg_loss: 0.506220    l2_loss: 0.021938    loss: 0.786740
steps 12400    v_Prec: 0.589500  v_Recall: 0.673419  v_F1: 0.628671  v_AUC: 0.879716
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.261731    reg_loss: 0.513483    l2_loss: 0.022044    loss: 0.797258
steps 12600    v_Prec: 0.583530  v_Recall: 0.690007  v_F1: 0.632317  v_AUC: 0.879210
steps 12600    running time 444 seconds

steps 12800    base_loss: 0.257023    reg_loss: 0.506717    l2_loss: 0.021822    loss: 0.785562
steps 12800    v_Prec: 0.639938  v_Recall: 0.624372  v_F1: 0.632059  v_AUC: 0.878093
steps 12800    running time 450 seconds

Early stop model F1: 0.642712
testing thre: 0.30849972
testing Prec: 0.38650992867261474
testing Recall: 0.7558687727825031
testing F1: 0.5114779977635993
testing AUC: 0.8277168613075836
overall running time 453 seconds
(0.5232917108233884, 0.5519805589307412, 0.537253417853257, 0.8277168613075836, 0.6108463)

2019-02-24 19:32:13.867123: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:32:14.790963: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:32:14.796226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:32:14.796266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.620000 seconds
loading data in 30.710000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.529141    reg_loss: 2.163847    l2_loss: 0.013348    loss: 2.706336
steps 200    v_Prec: 0.164244  v_Recall: 1.000000  v_F1: 0.282147  v_AUC: 0.461441
steps 200    running time 41 seconds

steps 400    base_loss: 0.504560    reg_loss: 2.132688    l2_loss: 0.013344    loss: 2.650591
steps 400    v_Prec: 0.164244  v_Recall: 1.000000  v_F1: 0.282147  v_AUC: 0.445420
steps 400    running time 48 seconds

steps 600    base_loss: 0.473555    reg_loss: 2.070636    l2_loss: 0.013252    loss: 2.557443
steps 600    v_Prec: 0.164276  v_Recall: 0.999921  v_F1: 0.282191  v_AUC: 0.477595
steps 600    running time 54 seconds

steps 800    base_loss: 0.470184    reg_loss: 1.999724    l2_loss: 0.013175    loss: 2.483083
steps 800    v_Prec: 0.184503  v_Recall: 0.730140  v_F1: 0.294569  v_AUC: 0.582378
steps 800    running time 61 seconds

steps 1000    base_loss: 0.453686    reg_loss: 1.893261    l2_loss: 0.013133    loss: 2.360079
steps 1000    v_Prec: 0.221187  v_Recall: 0.607404  v_F1: 0.324285  v_AUC: 0.632015
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.436769    reg_loss: 1.789473    l2_loss: 0.013131    loss: 2.239372
steps 1200    v_Prec: 0.248220  v_Recall: 0.636876  v_F1: 0.357216  v_AUC: 0.670396
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.427566    reg_loss: 1.696415    l2_loss: 0.013175    loss: 2.137156
steps 1400    v_Prec: 0.268404  v_Recall: 0.629965  v_F1: 0.376427  v_AUC: 0.697763
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.415056    reg_loss: 1.616305    l2_loss: 0.013294    loss: 2.044655
steps 1600    v_Prec: 0.325562  v_Recall: 0.561328  v_F1: 0.412108  v_AUC: 0.729532
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.405232    reg_loss: 1.557759    l2_loss: 0.013479    loss: 1.976469
steps 1800    v_Prec: 0.365857  v_Recall: 0.562679  v_F1: 0.443408  v_AUC: 0.757919
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.391428    reg_loss: 1.505328    l2_loss: 0.013723    loss: 1.910478
steps 2000    v_Prec: 0.429334  v_Recall: 0.555767  v_F1: 0.484437  v_AUC: 0.785014
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.382167    reg_loss: 1.462143    l2_loss: 0.014014    loss: 1.858324
steps 2200    v_Prec: 0.410825  v_Recall: 0.600572  v_F1: 0.487899  v_AUC: 0.799499
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.373869    reg_loss: 1.424902    l2_loss: 0.014287    loss: 1.813058
steps 2400    v_Prec: 0.460654  v_Recall: 0.595249  v_F1: 0.519373  v_AUC: 0.814395
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.360353    reg_loss: 1.371436    l2_loss: 0.014549    loss: 1.746338
steps 2600    v_Prec: 0.482376  v_Recall: 0.576184  v_F1: 0.525123  v_AUC: 0.823890
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.348769    reg_loss: 1.320375    l2_loss: 0.014808    loss: 1.683952
steps 2800    v_Prec: 0.491963  v_Recall: 0.593263  v_F1: 0.537885  v_AUC: 0.832238
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.353664    reg_loss: 1.288804    l2_loss: 0.015136    loss: 1.657604
steps 3000    v_Prec: 0.509271  v_Recall: 0.593502  v_F1: 0.548169  v_AUC: 0.838515
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.343286    reg_loss: 1.231074    l2_loss: 0.015499    loss: 1.589859
steps 3200    v_Prec: 0.514846  v_Recall: 0.592310  v_F1: 0.550868  v_AUC: 0.838193
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.340536    reg_loss: 1.199003    l2_loss: 0.015867    loss: 1.555406
steps 3400    v_Prec: 0.513121  v_Recall: 0.632189  v_F1: 0.566466  v_AUC: 0.847892
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.330452    reg_loss: 1.145568    l2_loss: 0.016204    loss: 1.492223
steps 3600    v_Prec: 0.513611  v_Recall: 0.635526  v_F1: 0.568101  v_AUC: 0.848064
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.331588    reg_loss: 1.101150    l2_loss: 0.016543    loss: 1.449281
steps 3800    v_Prec: 0.526822  v_Recall: 0.621783  v_F1: 0.570377  v_AUC: 0.851633
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.331401    reg_loss: 1.060822    l2_loss: 0.016820    loss: 1.409043
steps 4000    v_Prec: 0.546583  v_Recall: 0.597950  v_F1: 0.571114  v_AUC: 0.853317
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.330513    reg_loss: 1.023521    l2_loss: 0.017235    loss: 1.371269
steps 4200    v_Prec: 0.542023  v_Recall: 0.614792  v_F1: 0.576119  v_AUC: 0.854741
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.327949    reg_loss: 0.975720    l2_loss: 0.017594    loss: 1.321262
steps 4400    v_Prec: 0.531354  v_Recall: 0.644185  v_F1: 0.582355  v_AUC: 0.855622
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.328690    reg_loss: 0.955425    l2_loss: 0.017967    loss: 1.302081
steps 4600    v_Prec: 0.561461  v_Recall: 0.614315  v_F1: 0.586700  v_AUC: 0.859585
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.323687    reg_loss: 0.908519    l2_loss: 0.018357    loss: 1.250564
steps 4800    v_Prec: 0.556769  v_Recall: 0.627979  v_F1: 0.590234  v_AUC: 0.861480
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.325675    reg_loss: 0.882036    l2_loss: 0.018762    loss: 1.226472
steps 5000    v_Prec: 0.521866  v_Recall: 0.665475  v_F1: 0.584986  v_AUC: 0.860763
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.326723    reg_loss: 0.848873    l2_loss: 0.019219    loss: 1.194815
steps 5200    v_Prec: 0.529626  v_Recall: 0.670321  v_F1: 0.591725  v_AUC: 0.863982
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.319672    reg_loss: 0.809196    l2_loss: 0.019591    loss: 1.148460
steps 5400    v_Prec: 0.561692  v_Recall: 0.627820  v_F1: 0.592918  v_AUC: 0.862174
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.297325    reg_loss: 0.694078    l2_loss: 0.019854    loss: 1.011257
steps 5600    v_Prec: 0.545660  v_Recall: 0.633699  v_F1: 0.586393  v_AUC: 0.853389
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.292339    reg_loss: 0.679513    l2_loss: 0.019991    loss: 0.991843
steps 5800    v_Prec: 0.538507  v_Recall: 0.647124  v_F1: 0.587841  v_AUC: 0.858320
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.304517    reg_loss: 0.696417    l2_loss: 0.020114    loss: 1.021048
steps 6000    v_Prec: 0.560233  v_Recall: 0.625834  v_F1: 0.591220  v_AUC: 0.859938
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.294793    reg_loss: 0.665798    l2_loss: 0.020187    loss: 0.980778
steps 6200    v_Prec: 0.556922  v_Recall: 0.622577  v_F1: 0.587922  v_AUC: 0.858954
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.305331    reg_loss: 0.672083    l2_loss: 0.020308    loss: 0.997723
steps 6400    v_Prec: 0.539153  v_Recall: 0.657452  v_F1: 0.592455  v_AUC: 0.865214
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.300499    reg_loss: 0.654446    l2_loss: 0.020674    loss: 0.975620
steps 6600    v_Prec: 0.547238  v_Recall: 0.649269  v_F1: 0.593903  v_AUC: 0.866453
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.300592    reg_loss: 0.655945    l2_loss: 0.020919    loss: 0.977456
steps 6800    v_Prec: 0.557691  v_Recall: 0.643152  v_F1: 0.597381  v_AUC: 0.864513
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.295404    reg_loss: 0.639832    l2_loss: 0.021030    loss: 0.956266
steps 7000    v_Prec: 0.535445  v_Recall: 0.678027  v_F1: 0.598360  v_AUC: 0.863621
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.303660    reg_loss: 0.642019    l2_loss: 0.021146    loss: 0.966826
steps 7200    v_Prec: 0.555112  v_Recall: 0.663330  v_F1: 0.604415  v_AUC: 0.867535
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.306491    reg_loss: 0.639277    l2_loss: 0.021202    loss: 0.966969
steps 7400    v_Prec: 0.560397  v_Recall: 0.658961  v_F1: 0.605696  v_AUC: 0.868824
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.298038    reg_loss: 0.614839    l2_loss: 0.021344    loss: 0.934220
steps 7600    v_Prec: 0.549517  v_Recall: 0.682793  v_F1: 0.608948  v_AUC: 0.870610
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.299674    reg_loss: 0.617001    l2_loss: 0.021505    loss: 0.938180
steps 7800    v_Prec: 0.536958  v_Recall: 0.702892  v_F1: 0.608821  v_AUC: 0.869776
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.301991    reg_loss: 0.608184    l2_loss: 0.021408    loss: 0.931583
steps 8000    v_Prec: 0.547567  v_Recall: 0.692723  v_F1: 0.611651  v_AUC: 0.874076
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.299652    reg_loss: 0.601970    l2_loss: 0.021497    loss: 0.923119
steps 8200    v_Prec: 0.571838  v_Recall: 0.665872  v_F1: 0.615283  v_AUC: 0.873668
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.299937    reg_loss: 0.600875    l2_loss: 0.021513    loss: 0.922325
steps 8400    v_Prec: 0.554710  v_Recall: 0.683429  v_F1: 0.612379  v_AUC: 0.871549
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.300904    reg_loss: 0.591675    l2_loss: 0.021647    loss: 0.914225
steps 8600    v_Prec: 0.565122  v_Recall: 0.674214  v_F1: 0.614866  v_AUC: 0.873742
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.297605    reg_loss: 0.587647    l2_loss: 0.021708    loss: 0.906961
steps 8800    v_Prec: 0.555330  v_Recall: 0.694074  v_F1: 0.616998  v_AUC: 0.874242
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.294690    reg_loss: 0.584043    l2_loss: 0.021754    loss: 0.900487
steps 9000    v_Prec: 0.545778  v_Recall: 0.706069  v_F1: 0.615662  v_AUC: 0.873655
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.292014    reg_loss: 0.571746    l2_loss: 0.021742    loss: 0.885502
steps 9200    v_Prec: 0.542809  v_Recall: 0.695027  v_F1: 0.609559  v_AUC: 0.875030
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.297213    reg_loss: 0.578504    l2_loss: 0.021747    loss: 0.897464
steps 9400    v_Prec: 0.554818  v_Recall: 0.690658  v_F1: 0.615330  v_AUC: 0.872416
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.291110    reg_loss: 0.559421    l2_loss: 0.021692    loss: 0.872223
steps 9600    v_Prec: 0.553548  v_Recall: 0.708294  v_F1: 0.621432  v_AUC: 0.877559
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.298527    reg_loss: 0.574820    l2_loss: 0.021841    loss: 0.895189
steps 9800    v_Prec: 0.565911  v_Recall: 0.690261  v_F1: 0.621931  v_AUC: 0.876488
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.288984    reg_loss: 0.554375    l2_loss: 0.021714    loss: 0.865073
steps 10000    v_Prec: 0.551148  v_Recall: 0.709644  v_F1: 0.620433  v_AUC: 0.878137
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.297467    reg_loss: 0.574575    l2_loss: 0.021746    loss: 0.893788
steps 10200    v_Prec: 0.564339  v_Recall: 0.700985  v_F1: 0.625283  v_AUC: 0.880514
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.292909    reg_loss: 0.558789    l2_loss: 0.021914    loss: 0.873613
steps 10400    v_Prec: 0.537254  v_Recall: 0.736654  v_F1: 0.621348  v_AUC: 0.878030
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.296382    reg_loss: 0.551626    l2_loss: 0.022005    loss: 0.870012
steps 10600    v_Prec: 0.540670  v_Recall: 0.734509  v_F1: 0.622857  v_AUC: 0.878222
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.288517    reg_loss: 0.537647    l2_loss: 0.021899    loss: 0.848064
steps 10800    v_Prec: 0.541058  v_Recall: 0.732285  v_F1: 0.622312  v_AUC: 0.878355
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.250255    reg_loss: 0.489100    l2_loss: 0.022001    loss: 0.761356
steps 11000    v_Prec: 0.555861  v_Recall: 0.690499  v_F1: 0.615908  v_AUC: 0.872819
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.261295    reg_loss: 0.516471    l2_loss: 0.022069    loss: 0.799835
steps 11200    v_Prec: 0.581978  v_Recall: 0.647998  v_F1: 0.613216  v_AUC: 0.874075
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.253388    reg_loss: 0.502180    l2_loss: 0.021858    loss: 0.777426
steps 11400    v_Prec: 0.634977  v_Recall: 0.595329  v_F1: 0.614514  v_AUC: 0.870038
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.265036    reg_loss: 0.512366    l2_loss: 0.021873    loss: 0.799275
steps 11600    v_Prec: 0.554226  v_Recall: 0.684461  v_F1: 0.612497  v_AUC: 0.874572
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.269255    reg_loss: 0.519594    l2_loss: 0.021854    loss: 0.810703
steps 11800    v_Prec: 0.546984  v_Recall: 0.700111  v_F1: 0.614146  v_AUC: 0.872380
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.257300    reg_loss: 0.512725    l2_loss: 0.021721    loss: 0.791746
steps 12000    v_Prec: 0.583026  v_Recall: 0.653241  v_F1: 0.616140  v_AUC: 0.872593
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.265118    reg_loss: 0.507725    l2_loss: 0.021731    loss: 0.794575
steps 12200    v_Prec: 0.610310  v_Recall: 0.621703  v_F1: 0.615954  v_AUC: 0.874626
steps 12200    running time 431 seconds

Early stop model F1: 0.625283
testing thre: 0.23419528
testing Prec: 0.3632228571428571
testing Recall: 0.7723450789793439
testing F1: 0.4940847260007773
testing AUC: 0.8199355899565355
overall running time 434 seconds
(0.46392365108247613, 0.6071931956257595, 0.525976759851802, 0.8199355899565355, 0.44858357)

2019-02-24 19:36:56.898882: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:36:58.210856: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:36:58.212678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:36:58.212724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.470000 seconds
loading data in 30.550000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.696328    reg_loss: 2.159445    l2_loss: 0.013363    loss: 2.869136
steps 200    v_Prec: 0.164210  v_Recall: 0.974062  v_F1: 0.281041  v_AUC: 0.528155
steps 200    running time 41 seconds

steps 400    base_loss: 0.549999    reg_loss: 2.137182    l2_loss: 0.013359    loss: 2.700541
steps 400    v_Prec: 0.168713  v_Recall: 0.888461  v_F1: 0.283576  v_AUC: 0.540170
steps 400    running time 47 seconds

steps 600    base_loss: 0.498890    reg_loss: 2.086951    l2_loss: 0.013338    loss: 2.599179
steps 600    v_Prec: 0.191115  v_Recall: 0.675339  v_F1: 0.297921  v_AUC: 0.594378
steps 600    running time 54 seconds

steps 800    base_loss: 0.469337    reg_loss: 2.015543    l2_loss: 0.013273    loss: 2.498152
steps 800    v_Prec: 0.219273  v_Recall: 0.506866  v_F1: 0.306118  v_AUC: 0.610552
steps 800    running time 61 seconds

steps 1000    base_loss: 0.448662    reg_loss: 1.917034    l2_loss: 0.013191    loss: 2.378887
steps 1000    v_Prec: 0.233984  v_Recall: 0.483337  v_F1: 0.315321  v_AUC: 0.625312
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.444661    reg_loss: 1.819176    l2_loss: 0.013179    loss: 2.277015
steps 1200    v_Prec: 0.264208  v_Recall: 0.450976  v_F1: 0.333205  v_AUC: 0.648945
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.437442    reg_loss: 1.725565    l2_loss: 0.013233    loss: 2.176240
steps 1400    v_Prec: 0.265122  v_Recall: 0.542038  v_F1: 0.356078  v_AUC: 0.675673
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.427088    reg_loss: 1.652009    l2_loss: 0.013372    loss: 2.092468
steps 1600    v_Prec: 0.353816  v_Recall: 0.430017  v_F1: 0.388212  v_AUC: 0.711077
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.410336    reg_loss: 1.586438    l2_loss: 0.013491    loss: 2.010265
steps 1800    v_Prec: 0.359340  v_Recall: 0.505581  v_F1: 0.420097  v_AUC: 0.737855
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.390242    reg_loss: 1.521731    l2_loss: 0.013682    loss: 1.925656
steps 2000    v_Prec: 0.455891  v_Recall: 0.494660  v_F1: 0.474485  v_AUC: 0.772130
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.380273    reg_loss: 1.475882    l2_loss: 0.013843    loss: 1.869998
steps 2200    v_Prec: 0.459208  v_Recall: 0.542841  v_F1: 0.497534  v_AUC: 0.789919
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.366096    reg_loss: 1.426345    l2_loss: 0.014092    loss: 1.806534
steps 2400    v_Prec: 0.502043  v_Recall: 0.552558  v_F1: 0.526090  v_AUC: 0.809924
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.352632    reg_loss: 1.377448    l2_loss: 0.014305    loss: 1.744385
steps 2600    v_Prec: 0.511016  v_Recall: 0.555047  v_F1: 0.532122  v_AUC: 0.815572
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.345446    reg_loss: 1.337870    l2_loss: 0.014579    loss: 1.697894
steps 2800    v_Prec: 0.537994  v_Recall: 0.561150  v_F1: 0.549328  v_AUC: 0.827019
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.344441    reg_loss: 1.299752    l2_loss: 0.014811    loss: 1.659004
steps 3000    v_Prec: 0.529831  v_Recall: 0.590460  v_F1: 0.558505  v_AUC: 0.835570
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.348387    reg_loss: 1.269793    l2_loss: 0.015036    loss: 1.633216
steps 3200    v_Prec: 0.539625  v_Recall: 0.596001  v_F1: 0.566414  v_AUC: 0.842071
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.334032    reg_loss: 1.212645    l2_loss: 0.015382    loss: 1.562060
steps 3400    v_Prec: 0.521688  v_Recall: 0.610375  v_F1: 0.562558  v_AUC: 0.843197
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.337465    reg_loss: 1.183258    l2_loss: 0.015678    loss: 1.536401
steps 3600    v_Prec: 0.545487  v_Recall: 0.604754  v_F1: 0.573594  v_AUC: 0.849997
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.337245    reg_loss: 1.144569    l2_loss: 0.015923    loss: 1.497737
steps 3800    v_Prec: 0.542803  v_Recall: 0.617120  v_F1: 0.577581  v_AUC: 0.852629
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.327087    reg_loss: 1.093934    l2_loss: 0.016185    loss: 1.437206
steps 4000    v_Prec: 0.545744  v_Recall: 0.618887  v_F1: 0.580019  v_AUC: 0.853971
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.324746    reg_loss: 1.054982    l2_loss: 0.016506    loss: 1.396234
steps 4200    v_Prec: 0.574073  v_Recall: 0.597768  v_F1: 0.585681  v_AUC: 0.855102
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.323499    reg_loss: 0.995969    l2_loss: 0.016859    loss: 1.336328
steps 4400    v_Prec: 0.564040  v_Recall: 0.610375  v_F1: 0.586293  v_AUC: 0.858596
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.331918    reg_loss: 0.979520    l2_loss: 0.017152    loss: 1.328591
steps 4600    v_Prec: 0.583275  v_Recall: 0.606601  v_F1: 0.594709  v_AUC: 0.861008
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.322628    reg_loss: 0.939315    l2_loss: 0.017557    loss: 1.279500
steps 4800    v_Prec: 0.570911  v_Recall: 0.619690  v_F1: 0.594301  v_AUC: 0.861553
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.324193    reg_loss: 0.906736    l2_loss: 0.017941    loss: 1.248870
steps 5000    v_Prec: 0.536286  v_Recall: 0.666988  v_F1: 0.594538  v_AUC: 0.864047
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.322218    reg_loss: 0.866964    l2_loss: 0.018214    loss: 1.207395
steps 5200    v_Prec: 0.567070  v_Recall: 0.632779  v_F1: 0.598125  v_AUC: 0.865139
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.317561    reg_loss: 0.826249    l2_loss: 0.018457    loss: 1.162267
steps 5400    v_Prec: 0.572314  v_Recall: 0.630450  v_F1: 0.599977  v_AUC: 0.866380
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.287877    reg_loss: 0.713294    l2_loss: 0.018879    loss: 1.020049
steps 5600    v_Prec: 0.572777  v_Recall: 0.613989  v_F1: 0.592667  v_AUC: 0.861131
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.292924    reg_loss: 0.716231    l2_loss: 0.019206    loss: 1.028360
steps 5800    v_Prec: 0.554099  v_Recall: 0.638240  v_F1: 0.593201  v_AUC: 0.862106
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.294853    reg_loss: 0.694568    l2_loss: 0.019546    loss: 1.008966
steps 6000    v_Prec: 0.600033  v_Recall: 0.589818  v_F1: 0.594881  v_AUC: 0.858908
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.288684    reg_loss: 0.687010    l2_loss: 0.019755    loss: 0.995449
steps 6200    v_Prec: 0.592323  v_Recall: 0.600980  v_F1: 0.596620  v_AUC: 0.857236
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.292291    reg_loss: 0.680282    l2_loss: 0.019970    loss: 0.992542
steps 6400    v_Prec: 0.599682  v_Recall: 0.606521  v_F1: 0.603082  v_AUC: 0.862906
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.294826    reg_loss: 0.677258    l2_loss: 0.020108    loss: 0.992192
steps 6600    v_Prec: 0.593029  v_Recall: 0.622982  v_F1: 0.607637  v_AUC: 0.870308
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.298823    reg_loss: 0.671235    l2_loss: 0.020632    loss: 0.990689
steps 6800    v_Prec: 0.583487  v_Recall: 0.635028  v_F1: 0.608167  v_AUC: 0.870807
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.293742    reg_loss: 0.657643    l2_loss: 0.020796    loss: 0.972181
steps 7000    v_Prec: 0.570242  v_Recall: 0.650606  v_F1: 0.607779  v_AUC: 0.871070
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.296217    reg_loss: 0.655736    l2_loss: 0.020791    loss: 0.972744
steps 7200    v_Prec: 0.579643  v_Recall: 0.654862  v_F1: 0.614961  v_AUC: 0.872028
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.297316    reg_loss: 0.643610    l2_loss: 0.020998    loss: 0.961924
steps 7400    v_Prec: 0.606939  v_Recall: 0.615273  v_F1: 0.611078  v_AUC: 0.873141
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.301049    reg_loss: 0.647597    l2_loss: 0.021175    loss: 0.969821
steps 7600    v_Prec: 0.593607  v_Recall: 0.644182  v_F1: 0.617861  v_AUC: 0.874257
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.286504    reg_loss: 0.613438    l2_loss: 0.021311    loss: 0.921252
steps 7800    v_Prec: 0.586961  v_Recall: 0.661527  v_F1: 0.622018  v_AUC: 0.876257
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.293051    reg_loss: 0.606877    l2_loss: 0.021372    loss: 0.921300
steps 8000    v_Prec: 0.606004  v_Recall: 0.628925  v_F1: 0.617252  v_AUC: 0.875879
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.287953    reg_loss: 0.605522    l2_loss: 0.021400    loss: 0.914875
steps 8200    v_Prec: 0.593674  v_Recall: 0.643540  v_F1: 0.617602  v_AUC: 0.876461
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.296922    reg_loss: 0.612219    l2_loss: 0.021645    loss: 0.930785
steps 8400    v_Prec: 0.581655  v_Recall: 0.677267  v_F1: 0.625830  v_AUC: 0.879451
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.296617    reg_loss: 0.599411    l2_loss: 0.021580    loss: 0.917608
steps 8600    v_Prec: 0.593748  v_Recall: 0.654300  v_F1: 0.622555  v_AUC: 0.879491
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.297528    reg_loss: 0.604142    l2_loss: 0.021805    loss: 0.923475
steps 8800    v_Prec: 0.615811  v_Recall: 0.633663  v_F1: 0.624609  v_AUC: 0.879747
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.299469    reg_loss: 0.613852    l2_loss: 0.021774    loss: 0.935095
steps 9000    v_Prec: 0.611707  v_Recall: 0.650365  v_F1: 0.630444  v_AUC: 0.881908
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.294712    reg_loss: 0.589702    l2_loss: 0.021901    loss: 0.906315
steps 9200    v_Prec: 0.581152  v_Recall: 0.677427  v_F1: 0.625607  v_AUC: 0.879995
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.291738    reg_loss: 0.587147    l2_loss: 0.021884    loss: 0.900769
steps 9400    v_Prec: 0.569537  v_Recall: 0.701116  v_F1: 0.628514  v_AUC: 0.882498
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.292826    reg_loss: 0.576763    l2_loss: 0.021918    loss: 0.891507
steps 9600    v_Prec: 0.595461  v_Recall: 0.667951  v_F1: 0.629627  v_AUC: 0.883294
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.294897    reg_loss: 0.575776    l2_loss: 0.021986    loss: 0.892659
steps 9800    v_Prec: 0.613814  v_Recall: 0.644423  v_F1: 0.628746  v_AUC: 0.884133
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.282136    reg_loss: 0.555619    l2_loss: 0.021810    loss: 0.859565
steps 10000    v_Prec: 0.579695  v_Recall: 0.695094  v_F1: 0.632171  v_AUC: 0.883675
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.291556    reg_loss: 0.567600    l2_loss: 0.021865    loss: 0.881021
steps 10200    v_Prec: 0.624290  v_Recall: 0.644343  v_F1: 0.634158  v_AUC: 0.885517
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.293714    reg_loss: 0.561882    l2_loss: 0.021981    loss: 0.877578
steps 10400    v_Prec: 0.621176  v_Recall: 0.640729  v_F1: 0.630801  v_AUC: 0.887290
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.284678    reg_loss: 0.551269    l2_loss: 0.022127    loss: 0.858074
steps 10600    v_Prec: 0.620746  v_Recall: 0.644423  v_F1: 0.632363  v_AUC: 0.885952
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.285789    reg_loss: 0.545396    l2_loss: 0.022315    loss: 0.853500
steps 10800    v_Prec: 0.596317  v_Recall: 0.673412  v_F1: 0.632524  v_AUC: 0.885624
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.262174    reg_loss: 0.525954    l2_loss: 0.022387    loss: 0.810515
steps 11000    v_Prec: 0.624110  v_Recall: 0.640649  v_F1: 0.632271  v_AUC: 0.884349
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.258679    reg_loss: 0.507720    l2_loss: 0.022262    loss: 0.788661
steps 11200    v_Prec: 0.586793  v_Recall: 0.682165  v_F1: 0.630895  v_AUC: 0.883347
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.253296    reg_loss: 0.510196    l2_loss: 0.022115    loss: 0.785607
steps 11400    v_Prec: 0.595428  v_Recall: 0.671404  v_F1: 0.631138  v_AUC: 0.882270
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.255773    reg_loss: 0.511774    l2_loss: 0.022123    loss: 0.789670
steps 11600    v_Prec: 0.650696  v_Recall: 0.604192  v_F1: 0.626582  v_AUC: 0.879271
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.253032    reg_loss: 0.506341    l2_loss: 0.022424    loss: 0.781797
steps 11800    v_Prec: 0.636754  v_Recall: 0.618807  v_F1: 0.627652  v_AUC: 0.878354
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.254850    reg_loss: 0.516275    l2_loss: 0.022214    loss: 0.793338
steps 12000    v_Prec: 0.576083  v_Recall: 0.684333  v_F1: 0.625560  v_AUC: 0.879405
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.259488    reg_loss: 0.512513    l2_loss: 0.022389    loss: 0.794390
steps 12200    v_Prec: 0.600219  v_Recall: 0.661286  v_F1: 0.629274  v_AUC: 0.880561
steps 12200    running time 431 seconds

Early stop model F1: 0.634158
testing thre: 0.34640476
testing Prec: 0.40593245871107336
testing Recall: 0.7203402187120291
testing F1: 0.5192516553971201
testing AUC: 0.8258778861609131
overall running time 434 seconds
(0.5121396054628224, 0.5577156743620899, 0.5339568646611293, 0.8258778861609131, 0.5685257)

2019-02-24 19:41:36.996017: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:41:37.929722: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:41:37.995031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:41:37.995098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.480000 seconds
loading data in 29.590000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.613863    reg_loss: 2.166591    l2_loss: 0.013328    loss: 2.793782
steps 200    v_Prec: 0.164505  v_Recall: 1.000000  v_F1: 0.282532  v_AUC: 0.462725
steps 200    running time 40 seconds

steps 400    base_loss: 0.507891    reg_loss: 2.143082    l2_loss: 0.013264    loss: 2.664237
steps 400    v_Prec: 0.164509  v_Recall: 1.000000  v_F1: 0.282539  v_AUC: 0.457387
steps 400    running time 47 seconds

steps 600    base_loss: 0.486911    reg_loss: 2.094153    l2_loss: 0.013184    loss: 2.594248
steps 600    v_Prec: 0.164512  v_Recall: 1.000000  v_F1: 0.282542  v_AUC: 0.465977
steps 600    running time 53 seconds

steps 800    base_loss: 0.469921    reg_loss: 2.007752    l2_loss: 0.013077    loss: 2.490749
steps 800    v_Prec: 0.172338  v_Recall: 0.878966  v_F1: 0.288173  v_AUC: 0.551642
steps 800    running time 60 seconds

steps 1000    base_loss: 0.456716    reg_loss: 1.899401    l2_loss: 0.012955    loss: 2.369072
steps 1000    v_Prec: 0.223491  v_Recall: 0.530774  v_F1: 0.314540  v_AUC: 0.614917
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.443089    reg_loss: 1.786808    l2_loss: 0.012933    loss: 2.242830
steps 1200    v_Prec: 0.279780  v_Recall: 0.419337  v_F1: 0.335629  v_AUC: 0.644150
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.440441    reg_loss: 1.700044    l2_loss: 0.012976    loss: 2.153461
steps 1400    v_Prec: 0.323109  v_Recall: 0.414419  v_F1: 0.363112  v_AUC: 0.673913
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.420050    reg_loss: 1.619559    l2_loss: 0.013088    loss: 2.052697
steps 1600    v_Prec: 0.372149  v_Recall: 0.419258  v_F1: 0.394301  v_AUC: 0.711611
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.402388    reg_loss: 1.540369    l2_loss: 0.013229    loss: 1.955986
steps 1800    v_Prec: 0.323037  v_Recall: 0.637849  v_F1: 0.428872  v_AUC: 0.751967
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.397135    reg_loss: 1.501741    l2_loss: 0.013465    loss: 1.912341
steps 2000    v_Prec: 0.372190  v_Recall: 0.627776  v_F1: 0.467320  v_AUC: 0.777575
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.383812    reg_loss: 1.444136    l2_loss: 0.013760    loss: 1.841708
steps 2200    v_Prec: 0.363444  v_Recall: 0.653236  v_F1: 0.467039  v_AUC: 0.789062
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.379460    reg_loss: 1.414094    l2_loss: 0.014073    loss: 1.807627
steps 2400    v_Prec: 0.436851  v_Recall: 0.644432  v_F1: 0.520717  v_AUC: 0.811594
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.363949    reg_loss: 1.350822    l2_loss: 0.014367    loss: 1.729138
steps 2600    v_Prec: 0.465724  v_Recall: 0.590577  v_F1: 0.520772  v_AUC: 0.820615
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.349732    reg_loss: 1.298405    l2_loss: 0.014685    loss: 1.662822
steps 2800    v_Prec: 0.490250  v_Recall: 0.594226  v_F1: 0.537253  v_AUC: 0.828554
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.344291    reg_loss: 1.250776    l2_loss: 0.015020    loss: 1.610087
steps 3000    v_Prec: 0.489802  v_Recall: 0.632376  v_F1: 0.552032  v_AUC: 0.833585
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.351200    reg_loss: 1.216993    l2_loss: 0.015391    loss: 1.583585
steps 3200    v_Prec: 0.504809  v_Recall: 0.628648  v_F1: 0.559963  v_AUC: 0.839295
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.341531    reg_loss: 1.164127    l2_loss: 0.015695    loss: 1.521353
steps 3400    v_Prec: 0.520008  v_Recall: 0.625635  v_F1: 0.567952  v_AUC: 0.845209
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.339844    reg_loss: 1.125703    l2_loss: 0.016000    loss: 1.481547
steps 3600    v_Prec: 0.524692  v_Recall: 0.624445  v_F1: 0.570239  v_AUC: 0.846532
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.346315    reg_loss: 1.097679    l2_loss: 0.016405    loss: 1.460398
steps 3800    v_Prec: 0.531138  v_Recall: 0.634518  v_F1: 0.578244  v_AUC: 0.851122
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.334903    reg_loss: 1.036157    l2_loss: 0.016858    loss: 1.387918
steps 4000    v_Prec: 0.545324  v_Recall: 0.630790  v_F1: 0.584951  v_AUC: 0.853245
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.339170    reg_loss: 1.007904    l2_loss: 0.017281    loss: 1.364355
steps 4200    v_Prec: 0.544004  v_Recall: 0.643718  v_F1: 0.589676  v_AUC: 0.857399
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.336329    reg_loss: 0.962631    l2_loss: 0.017646    loss: 1.316607
steps 4400    v_Prec: 0.524897  v_Recall: 0.665530  v_F1: 0.586906  v_AUC: 0.856255
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.327444    reg_loss: 0.927543    l2_loss: 0.018021    loss: 1.273008
steps 4600    v_Prec: 0.563264  v_Recall: 0.621431  v_F1: 0.590919  v_AUC: 0.858908
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.324717    reg_loss: 0.872711    l2_loss: 0.018461    loss: 1.215890
steps 4800    v_Prec: 0.525439  v_Recall: 0.665133  v_F1: 0.587090  v_AUC: 0.858544
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.326960    reg_loss: 0.850354    l2_loss: 0.018786    loss: 1.196100
steps 5000    v_Prec: 0.552615  v_Recall: 0.639356  v_F1: 0.592830  v_AUC: 0.859958
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.327579    reg_loss: 0.829384    l2_loss: 0.019197    loss: 1.176160
steps 5200    v_Prec: 0.536818  v_Recall: 0.675365  v_F1: 0.598174  v_AUC: 0.862742
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.326803    reg_loss: 0.787545    l2_loss: 0.019534    loss: 1.133882
steps 5400    v_Prec: 0.547352  v_Recall: 0.657360  v_F1: 0.597333  v_AUC: 0.861587
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.299966    reg_loss: 0.684076    l2_loss: 0.019759    loss: 1.003802
steps 5600    v_Prec: 0.551478  v_Recall: 0.655536  v_F1: 0.599022  v_AUC: 0.861282
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.303875    reg_loss: 0.682242    l2_loss: 0.019815    loss: 1.005933
steps 5800    v_Prec: 0.538165  v_Recall: 0.674413  v_F1: 0.598634  v_AUC: 0.857501
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.304229    reg_loss: 0.672128    l2_loss: 0.019813    loss: 0.996170
steps 6000    v_Prec: 0.536358  v_Recall: 0.667513  v_F1: 0.594791  v_AUC: 0.860933
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.302482    reg_loss: 0.652734    l2_loss: 0.019946    loss: 0.975162
steps 6200    v_Prec: 0.551596  v_Recall: 0.657995  v_F1: 0.600116  v_AUC: 0.862690
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.305778    reg_loss: 0.656226    l2_loss: 0.020216    loss: 0.982220
steps 6400    v_Prec: 0.564215  v_Recall: 0.644273  v_F1: 0.601592  v_AUC: 0.866473
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.303940    reg_loss: 0.645278    l2_loss: 0.020387    loss: 0.969604
steps 6600    v_Prec: 0.570953  v_Recall: 0.652919  v_F1: 0.609191  v_AUC: 0.866251
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.299227    reg_loss: 0.641502    l2_loss: 0.020512    loss: 0.961241
steps 6800    v_Prec: 0.547741  v_Recall: 0.694321  v_F1: 0.612382  v_AUC: 0.866818
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.299711    reg_loss: 0.625979    l2_loss: 0.020743    loss: 0.946433
steps 7000    v_Prec: 0.566936  v_Recall: 0.657678  v_F1: 0.608945  v_AUC: 0.867200
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.306883    reg_loss: 0.633724    l2_loss: 0.020822    loss: 0.961428
steps 7200    v_Prec: 0.582733  v_Recall: 0.654743  v_F1: 0.616643  v_AUC: 0.869157
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.298179    reg_loss: 0.606509    l2_loss: 0.020916    loss: 0.925605
steps 7400    v_Prec: 0.559066  v_Recall: 0.682027  v_F1: 0.614456  v_AUC: 0.871670
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.302798    reg_loss: 0.616498    l2_loss: 0.020979    loss: 0.940275
steps 7600    v_Prec: 0.563910  v_Recall: 0.684089  v_F1: 0.618213  v_AUC: 0.871445
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.300412    reg_loss: 0.608968    l2_loss: 0.021018    loss: 0.930398
steps 7800    v_Prec: 0.569371  v_Recall: 0.670844  v_F1: 0.615956  v_AUC: 0.872389
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.302134    reg_loss: 0.607487    l2_loss: 0.021064    loss: 0.930685
steps 8000    v_Prec: 0.572809  v_Recall: 0.667671  v_F1: 0.616613  v_AUC: 0.873320
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.303955    reg_loss: 0.596939    l2_loss: 0.021167    loss: 0.922061
steps 8200    v_Prec: 0.577510  v_Recall: 0.660692  v_F1: 0.616307  v_AUC: 0.874038
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.306230    reg_loss: 0.595635    l2_loss: 0.021297    loss: 0.923162
steps 8400    v_Prec: 0.569716  v_Recall: 0.678299  v_F1: 0.619284  v_AUC: 0.875709
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.298596    reg_loss: 0.580853    l2_loss: 0.021280    loss: 0.900729
steps 8600    v_Prec: 0.577958  v_Recall: 0.670923  v_F1: 0.620981  v_AUC: 0.877579
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.295854    reg_loss: 0.578582    l2_loss: 0.021117    loss: 0.895553
steps 8800    v_Prec: 0.575563  v_Recall: 0.676634  v_F1: 0.622020  v_AUC: 0.874102
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.297107    reg_loss: 0.570905    l2_loss: 0.021265    loss: 0.889276
steps 9000    v_Prec: 0.594507  v_Recall: 0.654109  v_F1: 0.622885  v_AUC: 0.875696
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.296999    reg_loss: 0.568668    l2_loss: 0.021387    loss: 0.887053
steps 9200    v_Prec: 0.567945  v_Recall: 0.692814  v_F1: 0.624196  v_AUC: 0.875996
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.302885    reg_loss: 0.569062    l2_loss: 0.021426    loss: 0.893374
steps 9400    v_Prec: 0.579403  v_Recall: 0.679172  v_F1: 0.625333  v_AUC: 0.876910
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.295139    reg_loss: 0.555802    l2_loss: 0.021382    loss: 0.872322
steps 9600    v_Prec: 0.561157  v_Recall: 0.700111  v_F1: 0.622980  v_AUC: 0.875268
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.294275    reg_loss: 0.555631    l2_loss: 0.021415    loss: 0.871321
steps 9800    v_Prec: 0.582301  v_Recall: 0.674810  v_F1: 0.625152  v_AUC: 0.878887
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.298994    reg_loss: 0.559281    l2_loss: 0.021374    loss: 0.879649
steps 10000    v_Prec: 0.569207  v_Recall: 0.702570  v_F1: 0.628896  v_AUC: 0.877012
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.300600    reg_loss: 0.559319    l2_loss: 0.021449    loss: 0.881368
steps 10200    v_Prec: 0.587412  v_Recall: 0.672113  v_F1: 0.626914  v_AUC: 0.877970
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.297605    reg_loss: 0.553738    l2_loss: 0.021436    loss: 0.872779
steps 10400    v_Prec: 0.577112  v_Recall: 0.690355  v_F1: 0.628675  v_AUC: 0.878562
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.295684    reg_loss: 0.539488    l2_loss: 0.021373    loss: 0.856545
steps 10600    v_Prec: 0.559429  v_Recall: 0.724223  v_F1: 0.631248  v_AUC: 0.880448
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.296325    reg_loss: 0.545736    l2_loss: 0.021469    loss: 0.863530
steps 10800    v_Prec: 0.567398  v_Recall: 0.701777  v_F1: 0.627473  v_AUC: 0.878646
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.256524    reg_loss: 0.502666    l2_loss: 0.021527    loss: 0.780716
steps 11000    v_Prec: 0.583985  v_Recall: 0.675048  v_F1: 0.626223  v_AUC: 0.875484
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.269666    reg_loss: 0.524169    l2_loss: 0.021343    loss: 0.815177
steps 11200    v_Prec: 0.565701  v_Recall: 0.697256  v_F1: 0.624627  v_AUC: 0.875232
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.258317    reg_loss: 0.507913    l2_loss: 0.021364    loss: 0.787594
steps 11400    v_Prec: 0.553624  v_Recall: 0.709946  v_F1: 0.622116  v_AUC: 0.873750
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.262166    reg_loss: 0.508156    l2_loss: 0.021297    loss: 0.791619
steps 11600    v_Prec: 0.557484  v_Recall: 0.705742  v_F1: 0.622913  v_AUC: 0.872298
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.267641    reg_loss: 0.501468    l2_loss: 0.021216    loss: 0.790325
steps 11800    v_Prec: 0.569378  v_Recall: 0.682820  v_F1: 0.620961  v_AUC: 0.873860
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.266178    reg_loss: 0.505623    l2_loss: 0.021228    loss: 0.793029
steps 12000    v_Prec: 0.555000  v_Recall: 0.703918  v_F1: 0.620651  v_AUC: 0.874739
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.265944    reg_loss: 0.504907    l2_loss: 0.021241    loss: 0.792092
steps 12200    v_Prec: 0.557830  v_Recall: 0.700428  v_F1: 0.621049  v_AUC: 0.875176
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.273177    reg_loss: 0.517728    l2_loss: 0.021307    loss: 0.812212
steps 12400    v_Prec: 0.565714  v_Recall: 0.703284  v_F1: 0.627042  v_AUC: 0.872697
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.265527    reg_loss: 0.507119    l2_loss: 0.021244    loss: 0.793889
steps 12600    v_Prec: 0.592389  v_Recall: 0.650698  v_F1: 0.620176  v_AUC: 0.874894
steps 12600    running time 447 seconds

Early stop model F1: 0.631248
testing thre: 0.25980857
testing Prec: 0.37490760830690734
testing Recall: 0.764228432563791
testing F1: 0.5030392219591785
testing AUC: 0.8159015994215291
overall running time 449 seconds
(0.4789279547951656, 0.5931956257594168, 0.5299724266701404, 0.8159015994215291, 0.5397375)

2019-02-24 19:46:31.636115: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:46:32.720297: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:46:32.727246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:46:32.727295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.690000 seconds
loading data in 29.830000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.754510    reg_loss: 2.157935    l2_loss: 0.013330    loss: 2.925774
steps 200    v_Prec: 0.163645  v_Recall: 0.999841  v_F1: 0.281257  v_AUC: 0.476252
steps 200    running time 40 seconds

steps 400    base_loss: 0.597293    reg_loss: 2.130000    l2_loss: 0.013258    loss: 2.740551
steps 400    v_Prec: 0.163656  v_Recall: 0.999920  v_F1: 0.281276  v_AUC: 0.459053
steps 400    running time 47 seconds

steps 600    base_loss: 0.490968    reg_loss: 2.080848    l2_loss: 0.013220    loss: 2.585035
steps 600    v_Prec: 0.163637  v_Recall: 1.000000  v_F1: 0.281251  v_AUC: 0.483396
steps 600    running time 53 seconds

steps 800    base_loss: 0.467933    reg_loss: 1.994388    l2_loss: 0.013113    loss: 2.475433
steps 800    v_Prec: 0.163637  v_Recall: 0.999841  v_F1: 0.281244  v_AUC: 0.500891
steps 800    running time 60 seconds

steps 1000    base_loss: 0.468869    reg_loss: 1.889989    l2_loss: 0.013084    loss: 2.371942
steps 1000    v_Prec: 0.163664  v_Recall: 0.999761  v_F1: 0.281282  v_AUC: 0.526161
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.467006    reg_loss: 1.794767    l2_loss: 0.013053    loss: 2.274826
steps 1200    v_Prec: 0.190019  v_Recall: 0.627861  v_F1: 0.291743  v_AUC: 0.569868
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.448654    reg_loss: 1.688395    l2_loss: 0.013057    loss: 2.150106
steps 1400    v_Prec: 0.220357  v_Recall: 0.499402  v_F1: 0.305788  v_AUC: 0.593583
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.446520    reg_loss: 1.616543    l2_loss: 0.013117    loss: 2.076180
steps 1600    v_Prec: 0.238500  v_Recall: 0.484969  v_F1: 0.319752  v_AUC: 0.610144
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.445238    reg_loss: 1.563907    l2_loss: 0.013273    loss: 2.022418
steps 1800    v_Prec: 0.282117  v_Recall: 0.429711  v_F1: 0.340612  v_AUC: 0.633523
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.431526    reg_loss: 1.501428    l2_loss: 0.013411    loss: 1.946365
steps 2000    v_Prec: 0.337132  v_Recall: 0.415118  v_F1: 0.372083  v_AUC: 0.689534
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.408445    reg_loss: 1.445610    l2_loss: 0.013618    loss: 1.867673
steps 2200    v_Prec: 0.326556  v_Recall: 0.584004  v_F1: 0.418885  v_AUC: 0.734675
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.393652    reg_loss: 1.397425    l2_loss: 0.013926    loss: 1.805003
steps 2400    v_Prec: 0.382661  v_Recall: 0.593414  v_F1: 0.465285  v_AUC: 0.772770
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.380596    reg_loss: 1.357326    l2_loss: 0.014257    loss: 1.752179
steps 2600    v_Prec: 0.394637  v_Recall: 0.628977  v_F1: 0.484983  v_AUC: 0.792588
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.367796    reg_loss: 1.306171    l2_loss: 0.014571    loss: 1.688538
steps 2800    v_Prec: 0.433750  v_Recall: 0.646838  v_F1: 0.519284  v_AUC: 0.812534
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.363718    reg_loss: 1.264344    l2_loss: 0.014910    loss: 1.642972
steps 3000    v_Prec: 0.480205  v_Recall: 0.614146  v_F1: 0.538978  v_AUC: 0.820935
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.357997    reg_loss: 1.222073    l2_loss: 0.015233    loss: 1.595304
steps 3200    v_Prec: 0.507815  v_Recall: 0.603620  v_F1: 0.551588  v_AUC: 0.827220
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.351073    reg_loss: 1.159882    l2_loss: 0.015484    loss: 1.526438
steps 3400    v_Prec: 0.475302  v_Recall: 0.649868  v_F1: 0.549043  v_AUC: 0.831114
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.345702    reg_loss: 1.111354    l2_loss: 0.015861    loss: 1.472917
steps 3600    v_Prec: 0.474617  v_Recall: 0.672434  v_F1: 0.556468  v_AUC: 0.838714
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.340916    reg_loss: 1.068450    l2_loss: 0.016248    loss: 1.425614
steps 3800    v_Prec: 0.459721  v_Recall: 0.705765  v_F1: 0.556772  v_AUC: 0.843612
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.339688    reg_loss: 1.034731    l2_loss: 0.016564    loss: 1.390984
steps 4000    v_Prec: 0.490821  v_Recall: 0.667251  v_F1: 0.565596  v_AUC: 0.844482
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.337490    reg_loss: 0.991117    l2_loss: 0.016957    loss: 1.345564
steps 4200    v_Prec: 0.479510  v_Recall: 0.661510  v_F1: 0.555995  v_AUC: 0.847286
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.338231    reg_loss: 0.952100    l2_loss: 0.017400    loss: 1.307731
steps 4400    v_Prec: 0.481274  v_Recall: 0.692688  v_F1: 0.567945  v_AUC: 0.849464
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.338239    reg_loss: 0.916704    l2_loss: 0.017826    loss: 1.272769
steps 4600    v_Prec: 0.482394  v_Recall: 0.699147  v_F1: 0.570889  v_AUC: 0.853096
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.334250    reg_loss: 0.882470    l2_loss: 0.018351    loss: 1.235071
steps 4800    v_Prec: 0.494677  v_Recall: 0.678096  v_F1: 0.572044  v_AUC: 0.854370
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.335875    reg_loss: 0.859708    l2_loss: 0.018706    loss: 1.214289
steps 5000    v_Prec: 0.525384  v_Recall: 0.651065  v_F1: 0.581511  v_AUC: 0.855377
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.334305    reg_loss: 0.827297    l2_loss: 0.019185    loss: 1.180787
steps 5200    v_Prec: 0.549624  v_Recall: 0.623076  v_F1: 0.584050  v_AUC: 0.856124
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.326799    reg_loss: 0.790378    l2_loss: 0.019610    loss: 1.136787
steps 5400    v_Prec: 0.536087  v_Recall: 0.642612  v_F1: 0.584536  v_AUC: 0.855052
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.305885    reg_loss: 0.685059    l2_loss: 0.019688    loss: 1.010632
steps 5600    v_Prec: 0.530234  v_Recall: 0.656566  v_F1: 0.586676  v_AUC: 0.856134
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.306911    reg_loss: 0.677881    l2_loss: 0.019789    loss: 1.004581
steps 5800    v_Prec: 0.540110  v_Recall: 0.635117  v_F1: 0.583773  v_AUC: 0.857516
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.308983    reg_loss: 0.669798    l2_loss: 0.019911    loss: 0.998692
steps 6000    v_Prec: 0.538598  v_Recall: 0.655370  v_F1: 0.591274  v_AUC: 0.858139
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.312088    reg_loss: 0.660344    l2_loss: 0.020088    loss: 0.992519
steps 6200    v_Prec: 0.532737  v_Recall: 0.669564  v_F1: 0.593365  v_AUC: 0.859756
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.309451    reg_loss: 0.645649    l2_loss: 0.020363    loss: 0.975463
steps 6400    v_Prec: 0.555272  v_Recall: 0.641257  v_F1: 0.595175  v_AUC: 0.859646
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.311021    reg_loss: 0.644218    l2_loss: 0.020413    loss: 0.975652
steps 6600    v_Prec: 0.536881  v_Recall: 0.685432  v_F1: 0.602129  v_AUC: 0.862930
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.303304    reg_loss: 0.630701    l2_loss: 0.020550    loss: 0.954554
steps 6800    v_Prec: 0.558325  v_Recall: 0.653776  v_F1: 0.602292  v_AUC: 0.863539
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.304840    reg_loss: 0.627603    l2_loss: 0.020630    loss: 0.953073
steps 7000    v_Prec: 0.569711  v_Recall: 0.646121  v_F1: 0.605515  v_AUC: 0.864930
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.308467    reg_loss: 0.622978    l2_loss: 0.020868    loss: 0.952314
steps 7200    v_Prec: 0.541701  v_Recall: 0.683119  v_F1: 0.604246  v_AUC: 0.866162
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.302464    reg_loss: 0.619265    l2_loss: 0.021019    loss: 0.942748
steps 7400    v_Prec: 0.560074  v_Recall: 0.674268  v_F1: 0.611889  v_AUC: 0.867710
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.302803    reg_loss: 0.616730    l2_loss: 0.021053    loss: 0.940585
steps 7600    v_Prec: 0.574489  v_Recall: 0.654334  v_F1: 0.611817  v_AUC: 0.867890
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.308055    reg_loss: 0.608057    l2_loss: 0.021110    loss: 0.937221
steps 7800    v_Prec: 0.564547  v_Recall: 0.668129  v_F1: 0.611986  v_AUC: 0.867988
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.309543    reg_loss: 0.608129    l2_loss: 0.021109    loss: 0.938780
steps 8000    v_Prec: 0.562584  v_Recall: 0.670919  v_F1: 0.611994  v_AUC: 0.870068
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.306235    reg_loss: 0.605970    l2_loss: 0.021196    loss: 0.933402
steps 8200    v_Prec: 0.557867  v_Recall: 0.686468  v_F1: 0.615522  v_AUC: 0.869952
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.300459    reg_loss: 0.588867    l2_loss: 0.021234    loss: 0.910561
steps 8400    v_Prec: 0.573235  v_Recall: 0.675943  v_F1: 0.620367  v_AUC: 0.870621
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.304692    reg_loss: 0.585284    l2_loss: 0.021278    loss: 0.911254
steps 8600    v_Prec: 0.563939  v_Recall: 0.669883  v_F1: 0.612362  v_AUC: 0.873829
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.303592    reg_loss: 0.582874    l2_loss: 0.021327    loss: 0.907792
steps 8800    v_Prec: 0.543532  v_Recall: 0.698908  v_F1: 0.611505  v_AUC: 0.872076
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.302478    reg_loss: 0.576468    l2_loss: 0.021321    loss: 0.900267
steps 9000    v_Prec: 0.565559  v_Recall: 0.683757  v_F1: 0.619067  v_AUC: 0.875405
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.293366    reg_loss: 0.566237    l2_loss: 0.021347    loss: 0.880950
steps 9200    v_Prec: 0.561611  v_Recall: 0.677059  v_F1: 0.613955  v_AUC: 0.875870
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.300762    reg_loss: 0.569767    l2_loss: 0.021490    loss: 0.892019
steps 9400    v_Prec: 0.570418  v_Recall: 0.681764  v_F1: 0.621141  v_AUC: 0.876422
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.305832    reg_loss: 0.572795    l2_loss: 0.021511    loss: 0.900138
steps 9600    v_Prec: 0.560828  v_Recall: 0.695479  v_F1: 0.620938  v_AUC: 0.877736
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.298091    reg_loss: 0.565599    l2_loss: 0.021525    loss: 0.885214
steps 9800    v_Prec: 0.566946  v_Recall: 0.690136  v_F1: 0.622505  v_AUC: 0.877837
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.299462    reg_loss: 0.558998    l2_loss: 0.021591    loss: 0.880050
steps 10000    v_Prec: 0.566719  v_Recall: 0.690854  v_F1: 0.622660  v_AUC: 0.878397
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.299693    reg_loss: 0.553308    l2_loss: 0.021517    loss: 0.874519
steps 10200    v_Prec: 0.576767  v_Recall: 0.680568  v_F1: 0.624383  v_AUC: 0.878286
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.304926    reg_loss: 0.562793    l2_loss: 0.021477    loss: 0.889195
steps 10400    v_Prec: 0.567547  v_Recall: 0.699466  v_F1: 0.626639  v_AUC: 0.879898
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.303693    reg_loss: 0.555306    l2_loss: 0.021547    loss: 0.880545
steps 10600    v_Prec: 0.562995  v_Recall: 0.720118  v_F1: 0.631936  v_AUC: 0.879385
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.289253    reg_loss: 0.528587    l2_loss: 0.021364    loss: 0.839204
steps 10800    v_Prec: 0.561270  v_Recall: 0.718762  v_F1: 0.630328  v_AUC: 0.878040
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.262558    reg_loss: 0.513655    l2_loss: 0.021466    loss: 0.797679
steps 11000    v_Prec: 0.576398  v_Recall: 0.689738  v_F1: 0.627995  v_AUC: 0.876284
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.259750    reg_loss: 0.496467    l2_loss: 0.021092    loss: 0.777309
steps 11200    v_Prec: 0.547454  v_Recall: 0.710629  v_F1: 0.618459  v_AUC: 0.872782
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.266006    reg_loss: 0.523813    l2_loss: 0.021076    loss: 0.810895
steps 11400    v_Prec: 0.609497  v_Recall: 0.632485  v_F1: 0.620779  v_AUC: 0.873655
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.261973    reg_loss: 0.504425    l2_loss: 0.021078    loss: 0.787477
steps 11600    v_Prec: 0.566480  v_Recall: 0.692369  v_F1: 0.623130  v_AUC: 0.867804
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.270501    reg_loss: 0.510221    l2_loss: 0.021003    loss: 0.801726
steps 11800    v_Prec: 0.559130  v_Recall: 0.702735  v_F1: 0.622761  v_AUC: 0.873164
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.265833    reg_loss: 0.509249    l2_loss: 0.021043    loss: 0.796125
steps 12000    v_Prec: 0.580350  v_Recall: 0.672115  v_F1: 0.622871  v_AUC: 0.875585
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.259539    reg_loss: 0.505111    l2_loss: 0.021102    loss: 0.785752
steps 12200    v_Prec: 0.635716  v_Recall: 0.604896  v_F1: 0.619923  v_AUC: 0.874060
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.270977    reg_loss: 0.507757    l2_loss: 0.021029    loss: 0.799762
steps 12400    v_Prec: 0.547566  v_Recall: 0.720118  v_F1: 0.622098  v_AUC: 0.872288
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.272901    reg_loss: 0.510952    l2_loss: 0.020920    loss: 0.804774
steps 12600    v_Prec: 0.621815  v_Recall: 0.616857  v_F1: 0.619326  v_AUC: 0.872163
steps 12600    running time 446 seconds

Early stop model F1: 0.631936
testing thre: 0.27147505
testing Prec: 0.37794411664309746
testing Recall: 0.7533900364520049
testing F1: 0.5033691081199565
testing AUC: 0.81494005588683
overall running time 449 seconds
(0.4862266217696458, 0.5825030376670717, 0.5300283035556341, 0.81494005588683, 0.5357878)

2019-02-24 19:51:25.257935: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:51:25.911765: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:51:25.915141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:51:25.915183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.340000 seconds
loading data in 30.510000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.626252    reg_loss: 2.154980    l2_loss: 0.013325    loss: 2.794558
steps 200    v_Prec: 0.162803  v_Recall: 0.998476  v_F1: 0.279958  v_AUC: 0.536706
steps 200    running time 40 seconds

steps 400    base_loss: 0.529855    reg_loss: 2.128369    l2_loss: 0.013312    loss: 2.671537
steps 400    v_Prec: 0.173138  v_Recall: 0.813472  v_F1: 0.285509  v_AUC: 0.559216
steps 400    running time 47 seconds

steps 600    base_loss: 0.502788    reg_loss: 2.080080    l2_loss: 0.013218    loss: 2.596086
steps 600    v_Prec: 0.190630  v_Recall: 0.672494  v_F1: 0.297055  v_AUC: 0.589304
steps 600    running time 54 seconds

steps 800    base_loss: 0.481905    reg_loss: 2.004948    l2_loss: 0.013104    loss: 2.499958
steps 800    v_Prec: 0.219557  v_Recall: 0.514595  v_F1: 0.307792  v_AUC: 0.611888
steps 800    running time 61 seconds

steps 1000    base_loss: 0.454983    reg_loss: 1.911339    l2_loss: 0.013032    loss: 2.379354
steps 1000    v_Prec: 0.234141  v_Recall: 0.505533  v_F1: 0.320049  v_AUC: 0.633471
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.448784    reg_loss: 1.813856    l2_loss: 0.013012    loss: 2.275653
steps 1200    v_Prec: 0.278887  v_Recall: 0.437049  v_F1: 0.340497  v_AUC: 0.655057
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.429623    reg_loss: 1.717512    l2_loss: 0.013015    loss: 2.160151
steps 1400    v_Prec: 0.305722  v_Recall: 0.448998  v_F1: 0.363760  v_AUC: 0.685745
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.428622    reg_loss: 1.653701    l2_loss: 0.013134    loss: 2.095457
steps 1600    v_Prec: 0.322143  v_Recall: 0.534804  v_F1: 0.402086  v_AUC: 0.721161
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.398685    reg_loss: 1.574159    l2_loss: 0.013314    loss: 1.986158
steps 1800    v_Prec: 0.386464  v_Recall: 0.540337  v_F1: 0.450627  v_AUC: 0.759041
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.391004    reg_loss: 1.526030    l2_loss: 0.013522    loss: 1.930555
steps 2000    v_Prec: 0.460398  v_Recall: 0.517883  v_F1: 0.487451  v_AUC: 0.783654
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.376417    reg_loss: 1.475113    l2_loss: 0.013742    loss: 1.865272
steps 2200    v_Prec: 0.488316  v_Recall: 0.537931  v_F1: 0.511924  v_AUC: 0.802389
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.364998    reg_loss: 1.423615    l2_loss: 0.013953    loss: 1.802567
steps 2400    v_Prec: 0.509567  v_Recall: 0.563833  v_F1: 0.535328  v_AUC: 0.819225
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.346216    reg_loss: 1.364654    l2_loss: 0.014211    loss: 1.725080
steps 2600    v_Prec: 0.492977  v_Recall: 0.613553  v_F1: 0.546695  v_AUC: 0.827412
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.344417    reg_loss: 1.326491    l2_loss: 0.014444    loss: 1.685351
steps 2800    v_Prec: 0.515900  v_Recall: 0.606255  v_F1: 0.557440  v_AUC: 0.836763
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.344758    reg_loss: 1.283215    l2_loss: 0.014700    loss: 1.642672
steps 3000    v_Prec: 0.545812  v_Recall: 0.578508  v_F1: 0.561685  v_AUC: 0.840085
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.339914    reg_loss: 1.243501    l2_loss: 0.015005    loss: 1.598419
steps 3200    v_Prec: 0.544027  v_Recall: 0.594547  v_F1: 0.568166  v_AUC: 0.844122
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.341694    reg_loss: 1.207638    l2_loss: 0.015268    loss: 1.564600
steps 3400    v_Prec: 0.532527  v_Recall: 0.621652  v_F1: 0.573649  v_AUC: 0.848628
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.336036    reg_loss: 1.155809    l2_loss: 0.015565    loss: 1.507410
steps 3600    v_Prec: 0.559025  v_Recall: 0.607217  v_F1: 0.582126  v_AUC: 0.852794
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.326077    reg_loss: 1.093477    l2_loss: 0.015847    loss: 1.435402
steps 3800    v_Prec: 0.553339  v_Recall: 0.622694  v_F1: 0.585971  v_AUC: 0.853053
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.320560    reg_loss: 1.057768    l2_loss: 0.016155    loss: 1.394483
steps 4000    v_Prec: 0.543156  v_Recall: 0.644427  v_F1: 0.589474  v_AUC: 0.858004
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.321218    reg_loss: 1.027058    l2_loss: 0.016479    loss: 1.364755
steps 4200    v_Prec: 0.554133  v_Recall: 0.624699  v_F1: 0.587304  v_AUC: 0.858028
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.327280    reg_loss: 0.993782    l2_loss: 0.016802    loss: 1.337864
steps 4400    v_Prec: 0.547121  v_Recall: 0.648516  v_F1: 0.593520  v_AUC: 0.860278
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.324220    reg_loss: 0.944023    l2_loss: 0.017060    loss: 1.285303
steps 4600    v_Prec: 0.560566  v_Recall: 0.634964  v_F1: 0.595450  v_AUC: 0.860050
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.327551    reg_loss: 0.918834    l2_loss: 0.017518    loss: 1.263903
steps 4800    v_Prec: 0.543325  v_Recall: 0.665758  v_F1: 0.598342  v_AUC: 0.863189
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.326420    reg_loss: 0.885124    l2_loss: 0.017804    loss: 1.229347
steps 5000    v_Prec: 0.562848  v_Recall: 0.631997  v_F1: 0.595422  v_AUC: 0.862495
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.323509    reg_loss: 0.846383    l2_loss: 0.018167    loss: 1.188058
steps 5200    v_Prec: 0.556855  v_Recall: 0.641700  v_F1: 0.596274  v_AUC: 0.863031
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.323393    reg_loss: 0.812734    l2_loss: 0.018609    loss: 1.154735
steps 5400    v_Prec: 0.541119  v_Recall: 0.669607  v_F1: 0.598545  v_AUC: 0.863567
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.294094    reg_loss: 0.699501    l2_loss: 0.018899    loss: 1.012494
steps 5600    v_Prec: 0.571079  v_Recall: 0.617883  v_F1: 0.593560  v_AUC: 0.857218
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.292848    reg_loss: 0.687365    l2_loss: 0.019097    loss: 0.999309
steps 5800    v_Prec: 0.561727  v_Recall: 0.644747  v_F1: 0.600381  v_AUC: 0.864224
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.298088    reg_loss: 0.693177    l2_loss: 0.019472    loss: 1.010736
steps 6000    v_Prec: 0.565151  v_Recall: 0.648677  v_F1: 0.604040  v_AUC: 0.861265
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.300277    reg_loss: 0.680107    l2_loss: 0.019667    loss: 1.000052
steps 6200    v_Prec: 0.564428  v_Recall: 0.642823  v_F1: 0.601080  v_AUC: 0.864204
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.296454    reg_loss: 0.665584    l2_loss: 0.019810    loss: 0.981847
steps 6400    v_Prec: 0.594690  v_Recall: 0.621492  v_F1: 0.607795  v_AUC: 0.865679
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.299830    reg_loss: 0.661340    l2_loss: 0.019988    loss: 0.981158
steps 6600    v_Prec: 0.581484  v_Recall: 0.636648  v_F1: 0.607817  v_AUC: 0.866355
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.297792    reg_loss: 0.653792    l2_loss: 0.020084    loss: 0.971669
steps 6800    v_Prec: 0.590434  v_Recall: 0.620690  v_F1: 0.605184  v_AUC: 0.867119
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.299022    reg_loss: 0.639651    l2_loss: 0.020271    loss: 0.958944
steps 7000    v_Prec: 0.553548  v_Recall: 0.685565  v_F1: 0.612524  v_AUC: 0.870446
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.293999    reg_loss: 0.622406    l2_loss: 0.020414    loss: 0.936819
steps 7200    v_Prec: 0.551313  v_Recall: 0.686688  v_F1: 0.611599  v_AUC: 0.870345
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.296709    reg_loss: 0.624048    l2_loss: 0.020445    loss: 0.941202
steps 7400    v_Prec: 0.575562  v_Recall: 0.665196  v_F1: 0.617142  v_AUC: 0.871535
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.300372    reg_loss: 0.631672    l2_loss: 0.020705    loss: 0.952750
steps 7600    v_Prec: 0.580942  v_Recall: 0.662470  v_F1: 0.619033  v_AUC: 0.871657
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.300297    reg_loss: 0.625991    l2_loss: 0.020818    loss: 0.947105
steps 7800    v_Prec: 0.585791  v_Recall: 0.654611  v_F1: 0.618292  v_AUC: 0.874662
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.299648    reg_loss: 0.604574    l2_loss: 0.020962    loss: 0.925184
steps 8000    v_Prec: 0.551920  v_Recall: 0.715638  v_F1: 0.623206  v_AUC: 0.875715
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.294670    reg_loss: 0.587708    l2_loss: 0.021053    loss: 0.903431
steps 8200    v_Prec: 0.562294  v_Recall: 0.710826  v_F1: 0.627895  v_AUC: 0.876355
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.302612    reg_loss: 0.600654    l2_loss: 0.021219    loss: 0.924484
steps 8400    v_Prec: 0.598068  v_Recall: 0.655333  v_F1: 0.625392  v_AUC: 0.872838
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.303869    reg_loss: 0.600722    l2_loss: 0.021152    loss: 0.925744
steps 8600    v_Prec: 0.556353  v_Recall: 0.708982  v_F1: 0.623462  v_AUC: 0.876452
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.295865    reg_loss: 0.589005    l2_loss: 0.021194    loss: 0.906063
steps 8800    v_Prec: 0.558846  v_Recall: 0.711307  v_F1: 0.625926  v_AUC: 0.878192
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.297149    reg_loss: 0.584890    l2_loss: 0.021340    loss: 0.903379
steps 9000    v_Prec: 0.583397  v_Recall: 0.676824  v_F1: 0.626647  v_AUC: 0.875944
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.288738    reg_loss: 0.567528    l2_loss: 0.021400    loss: 0.877666
steps 9200    v_Prec: 0.569093  v_Recall: 0.706095  v_F1: 0.630234  v_AUC: 0.876646
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.302601    reg_loss: 0.583937    l2_loss: 0.021469    loss: 0.908007
steps 9400    v_Prec: 0.557997  v_Recall: 0.722935  v_F1: 0.629847  v_AUC: 0.879252
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.289418    reg_loss: 0.563701    l2_loss: 0.021468    loss: 0.874586
steps 9600    v_Prec: 0.585505  v_Recall: 0.684763  v_F1: 0.631256  v_AUC: 0.881258
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.300099    reg_loss: 0.578057    l2_loss: 0.021549    loss: 0.899705
steps 9800    v_Prec: 0.577760  v_Recall: 0.694146  v_F1: 0.630628  v_AUC: 0.881139
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.297563    reg_loss: 0.570512    l2_loss: 0.021409    loss: 0.889484
steps 10000    v_Prec: 0.573295  v_Recall: 0.714435  v_F1: 0.636130  v_AUC: 0.880440
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.286880    reg_loss: 0.548402    l2_loss: 0.021441    loss: 0.856723
steps 10200    v_Prec: 0.578507  v_Recall: 0.709703  v_F1: 0.637424  v_AUC: 0.882919
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.293086    reg_loss: 0.552649    l2_loss: 0.021475    loss: 0.867210
steps 10400    v_Prec: 0.578013  v_Recall: 0.710024  v_F1: 0.637253  v_AUC: 0.882764
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.296182    reg_loss: 0.560826    l2_loss: 0.021471    loss: 0.878479
steps 10600    v_Prec: 0.562622  v_Recall: 0.739936  v_F1: 0.639210  v_AUC: 0.882505
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.290218    reg_loss: 0.551208    l2_loss: 0.021377    loss: 0.862803
steps 10800    v_Prec: 0.598189  v_Recall: 0.683480  v_F1: 0.637997  v_AUC: 0.882042
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.252935    reg_loss: 0.504059    l2_loss: 0.021586    loss: 0.778579
steps 11000    v_Prec: 0.588018  v_Recall: 0.677706  v_F1: 0.629685  v_AUC: 0.879126
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.261827    reg_loss: 0.510324    l2_loss: 0.021736    loss: 0.793886
steps 11200    v_Prec: 0.613135  v_Recall: 0.662550  v_F1: 0.636886  v_AUC: 0.879496
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.253445    reg_loss: 0.493387    l2_loss: 0.021715    loss: 0.768547
steps 11400    v_Prec: 0.586140  v_Recall: 0.676905  v_F1: 0.628261  v_AUC: 0.876640
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.261046    reg_loss: 0.510105    l2_loss: 0.021586    loss: 0.792737
steps 11600    v_Prec: 0.581397  v_Recall: 0.698236  v_F1: 0.634482  v_AUC: 0.875318
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.261820    reg_loss: 0.508354    l2_loss: 0.021662    loss: 0.791836
steps 11800    v_Prec: 0.592763  v_Recall: 0.681796  v_F1: 0.634170  v_AUC: 0.877499
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.265575    reg_loss: 0.502394    l2_loss: 0.021612    loss: 0.789582
steps 12000    v_Prec: 0.628590  v_Recall: 0.630152  v_F1: 0.629370  v_AUC: 0.874420
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.268732    reg_loss: 0.523805    l2_loss: 0.021558    loss: 0.814094
steps 12200    v_Prec: 0.588734  v_Recall: 0.685565  v_F1: 0.633470  v_AUC: 0.877893
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.259071    reg_loss: 0.503429    l2_loss: 0.021647    loss: 0.784146
steps 12400    v_Prec: 0.562843  v_Recall: 0.724699  v_F1: 0.633597  v_AUC: 0.879702
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.267781    reg_loss: 0.513955    l2_loss: 0.021706    loss: 0.803442
steps 12600    v_Prec: 0.614860  v_Recall: 0.643063  v_F1: 0.628645  v_AUC: 0.878190
steps 12600    running time 445 seconds

Early stop model F1: 0.639210
testing thre: 0.2643396
testing Prec: 0.4003266224030842
testing Recall: 0.7267557715674362
testing F1: 0.5162704783606954
testing AUC: 0.8201236537926391
overall running time 447 seconds
(0.4906758473707939, 0.5818712029161603, 0.5323964957531018, 0.8201236537926391, 0.52058434)

2019-02-24 19:56:14.451571: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:56:15.455394: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:56:15.457018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:56:15.457058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.030000 seconds
loading data in 30.100000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.720240    reg_loss: 2.154668    l2_loss: 0.013318    loss: 2.888226
steps 200    v_Prec: 0.163444  v_Recall: 1.000000  v_F1: 0.280965  v_AUC: 0.520875
steps 200    running time 40 seconds

steps 400    base_loss: 0.523410    reg_loss: 2.132108    l2_loss: 0.013177    loss: 2.668694
steps 400    v_Prec: 0.179413  v_Recall: 0.669727  v_F1: 0.283011  v_AUC: 0.546886
steps 400    running time 47 seconds

steps 600    base_loss: 0.473935    reg_loss: 2.081516    l2_loss: 0.013140    loss: 2.568590
steps 600    v_Prec: 0.194209  v_Recall: 0.643062  v_F1: 0.298322  v_AUC: 0.577348
steps 600    running time 54 seconds

steps 800    base_loss: 0.468938    reg_loss: 2.006479    l2_loss: 0.013102    loss: 2.488519
steps 800    v_Prec: 0.205827  v_Recall: 0.610251  v_F1: 0.307829  v_AUC: 0.595157
steps 800    running time 60 seconds

steps 1000    base_loss: 0.448825    reg_loss: 1.912533    l2_loss: 0.013034    loss: 2.374392
steps 1000    v_Prec: 0.240088  v_Recall: 0.520677  v_F1: 0.328639  v_AUC: 0.624765
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.439730    reg_loss: 1.813489    l2_loss: 0.012979    loss: 2.266197
steps 1200    v_Prec: 0.283897  v_Recall: 0.450822  v_F1: 0.348397  v_AUC: 0.646613
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.436478    reg_loss: 1.724846    l2_loss: 0.013036    loss: 2.174361
steps 1400    v_Prec: 0.303034  v_Recall: 0.453776  v_F1: 0.363392  v_AUC: 0.662622
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.424569    reg_loss: 1.642838    l2_loss: 0.013103    loss: 2.080510
steps 1600    v_Prec: 0.363688  v_Recall: 0.406834  v_F1: 0.384053  v_AUC: 0.683720
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.409890    reg_loss: 1.574047    l2_loss: 0.013248    loss: 1.997185
steps 1800    v_Prec: 0.420175  v_Recall: 0.392065  v_F1: 0.405633  v_AUC: 0.716564
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.392786    reg_loss: 1.503519    l2_loss: 0.013429    loss: 1.909733
steps 2000    v_Prec: 0.364572  v_Recall: 0.542871  v_F1: 0.436205  v_AUC: 0.752698
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.380899    reg_loss: 1.458158    l2_loss: 0.013652    loss: 1.852708
steps 2200    v_Prec: 0.450639  v_Recall: 0.534967  v_F1: 0.489196  v_AUC: 0.780615
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.369785    reg_loss: 1.413079    l2_loss: 0.013865    loss: 1.796729
steps 2400    v_Prec: 0.456773  v_Recall: 0.583347  v_F1: 0.512358  v_AUC: 0.797903
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.356966    reg_loss: 1.364948    l2_loss: 0.014037    loss: 1.735950
steps 2600    v_Prec: 0.476775  v_Recall: 0.589175  v_F1: 0.527049  v_AUC: 0.812017
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.351456    reg_loss: 1.320817    l2_loss: 0.014340    loss: 1.686613
steps 2800    v_Prec: 0.476721  v_Recall: 0.622066  v_F1: 0.539780  v_AUC: 0.822553
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.345837    reg_loss: 1.275074    l2_loss: 0.014536    loss: 1.635447
steps 3000    v_Prec: 0.511353  v_Recall: 0.587897  v_F1: 0.546960  v_AUC: 0.830235
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.345507    reg_loss: 1.221116    l2_loss: 0.014879    loss: 1.581502
steps 3200    v_Prec: 0.503246  v_Recall: 0.618793  v_F1: 0.555070  v_AUC: 0.834998
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.333784    reg_loss: 1.178508    l2_loss: 0.015163    loss: 1.527455
steps 3400    v_Prec: 0.516122  v_Recall: 0.603145  v_F1: 0.556251  v_AUC: 0.838277
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.338912    reg_loss: 1.144136    l2_loss: 0.015371    loss: 1.498418
steps 3600    v_Prec: 0.495088  v_Recall: 0.651764  v_F1: 0.562724  v_AUC: 0.841302
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.333655    reg_loss: 1.095150    l2_loss: 0.015748    loss: 1.444553
steps 3800    v_Prec: 0.515730  v_Recall: 0.636037  v_F1: 0.569600  v_AUC: 0.845118
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.335856    reg_loss: 1.059488    l2_loss: 0.016025    loss: 1.411369
steps 4000    v_Prec: 0.527699  v_Recall: 0.625100  v_F1: 0.572285  v_AUC: 0.849043
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.330082    reg_loss: 1.016101    l2_loss: 0.016338    loss: 1.362521
steps 4200    v_Prec: 0.530243  v_Recall: 0.620070  v_F1: 0.571649  v_AUC: 0.849549
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.329142    reg_loss: 0.971537    l2_loss: 0.016721    loss: 1.317401
steps 4400    v_Prec: 0.530536  v_Recall: 0.633882  v_F1: 0.577623  v_AUC: 0.851673
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.328707    reg_loss: 0.942926    l2_loss: 0.017012    loss: 1.288646
steps 4600    v_Prec: 0.540355  v_Recall: 0.627495  v_F1: 0.580674  v_AUC: 0.855315
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.330528    reg_loss: 0.906692    l2_loss: 0.017338    loss: 1.254559
steps 4800    v_Prec: 0.536800  v_Recall: 0.636995  v_F1: 0.582621  v_AUC: 0.853113
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.322986    reg_loss: 0.864561    l2_loss: 0.017703    loss: 1.205251
steps 5000    v_Prec: 0.530425  v_Recall: 0.646495  v_F1: 0.582737  v_AUC: 0.856142
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.321093    reg_loss: 0.823609    l2_loss: 0.017979    loss: 1.162681
steps 5200    v_Prec: 0.520096  v_Recall: 0.671483  v_F1: 0.586173  v_AUC: 0.857992
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.326211    reg_loss: 0.794623    l2_loss: 0.018367    loss: 1.139200
steps 5400    v_Prec: 0.543065  v_Recall: 0.643302  v_F1: 0.588949  v_AUC: 0.856680
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.299990    reg_loss: 0.683335    l2_loss: 0.018740    loss: 1.002065
steps 5600    v_Prec: 0.555587  v_Recall: 0.617995  v_F1: 0.585132  v_AUC: 0.853587
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.300917    reg_loss: 0.687264    l2_loss: 0.018935    loss: 1.007116
steps 5800    v_Prec: 0.546683  v_Recall: 0.629650  v_F1: 0.585241  v_AUC: 0.853102
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.307245    reg_loss: 0.684060    l2_loss: 0.019233    loss: 1.010538
steps 6000    v_Prec: 0.539214  v_Recall: 0.651525  v_F1: 0.590073  v_AUC: 0.856658
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.305376    reg_loss: 0.673348    l2_loss: 0.019416    loss: 0.998140
steps 6200    v_Prec: 0.542868  v_Recall: 0.656634  v_F1: 0.594356  v_AUC: 0.856655
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.296451    reg_loss: 0.643599    l2_loss: 0.019560    loss: 0.959610
steps 6400    v_Prec: 0.549860  v_Recall: 0.642264  v_F1: 0.592481  v_AUC: 0.857949
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.301433    reg_loss: 0.646375    l2_loss: 0.019775    loss: 0.967583
steps 6600    v_Prec: 0.543655  v_Recall: 0.666613  v_F1: 0.598888  v_AUC: 0.859544
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.311800    reg_loss: 0.663162    l2_loss: 0.020007    loss: 0.994969
steps 6800    v_Prec: 0.544549  v_Recall: 0.672361  v_F1: 0.601743  v_AUC: 0.864553
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.296531    reg_loss: 0.623706    l2_loss: 0.020038    loss: 0.940275
steps 7000    v_Prec: 0.532569  v_Recall: 0.671004  v_F1: 0.593825  v_AUC: 0.862166
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.297287    reg_loss: 0.616922    l2_loss: 0.020152    loss: 0.934361
steps 7200    v_Prec: 0.552876  v_Recall: 0.664458  v_F1: 0.603553  v_AUC: 0.865379
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.305409    reg_loss: 0.618326    l2_loss: 0.020218    loss: 0.943953
steps 7400    v_Prec: 0.562074  v_Recall: 0.664697  v_F1: 0.609093  v_AUC: 0.867692
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.299192    reg_loss: 0.610727    l2_loss: 0.020243    loss: 0.930161
steps 7600    v_Prec: 0.548088  v_Recall: 0.694715  v_F1: 0.612752  v_AUC: 0.870707
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.298866    reg_loss: 0.602950    l2_loss: 0.020336    loss: 0.922152
steps 7800    v_Prec: 0.564605  v_Recall: 0.659668  v_F1: 0.608446  v_AUC: 0.870164
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.305337    reg_loss: 0.609930    l2_loss: 0.020547    loss: 0.935814
steps 8000    v_Prec: 0.561673  v_Recall: 0.680904  v_F1: 0.615568  v_AUC: 0.871344
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.308251    reg_loss: 0.605292    l2_loss: 0.020624    loss: 0.934167
steps 8200    v_Prec: 0.536680  v_Recall: 0.710203  v_F1: 0.611367  v_AUC: 0.871869
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.302267    reg_loss: 0.595345    l2_loss: 0.020727    loss: 0.918339
steps 8400    v_Prec: 0.555952  v_Recall: 0.683778  v_F1: 0.613275  v_AUC: 0.872779
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.302445    reg_loss: 0.585391    l2_loss: 0.020824    loss: 0.908660
steps 8600    v_Prec: 0.563171  v_Recall: 0.678269  v_F1: 0.615385  v_AUC: 0.871604
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.302580    reg_loss: 0.592502    l2_loss: 0.021090    loss: 0.916172
steps 8800    v_Prec: 0.590220  v_Recall: 0.652323  v_F1: 0.619719  v_AUC: 0.874040
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.296955    reg_loss: 0.571988    l2_loss: 0.021033    loss: 0.889976
steps 9000    v_Prec: 0.557216  v_Recall: 0.705572  v_F1: 0.622679  v_AUC: 0.874694
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.294711    reg_loss: 0.563119    l2_loss: 0.021047    loss: 0.878876
steps 9200    v_Prec: 0.564007  v_Recall: 0.698547  v_F1: 0.624108  v_AUC: 0.875537
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.294029    reg_loss: 0.558820    l2_loss: 0.020973    loss: 0.873823
steps 9400    v_Prec: 0.567970  v_Recall: 0.694795  v_F1: 0.625013  v_AUC: 0.875471
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.302895    reg_loss: 0.574008    l2_loss: 0.021234    loss: 0.898137
steps 9600    v_Prec: 0.558700  v_Recall: 0.709325  v_F1: 0.625066  v_AUC: 0.876131
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.294565    reg_loss: 0.560330    l2_loss: 0.021228    loss: 0.876122
steps 9800    v_Prec: 0.578246  v_Recall: 0.675236  v_F1: 0.622988  v_AUC: 0.878401
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.298777    reg_loss: 0.557842    l2_loss: 0.021195    loss: 0.877814
steps 10000    v_Prec: 0.567833  v_Recall: 0.700703  v_F1: 0.627309  v_AUC: 0.877353
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.296823    reg_loss: 0.555376    l2_loss: 0.021154    loss: 0.873353
steps 10200    v_Prec: 0.575772  v_Recall: 0.695513  v_F1: 0.630003  v_AUC: 0.879061
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.292090    reg_loss: 0.533452    l2_loss: 0.021201    loss: 0.846743
steps 10400    v_Prec: 0.564179  v_Recall: 0.707409  v_F1: 0.627727  v_AUC: 0.880110
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.289119    reg_loss: 0.542583    l2_loss: 0.021315    loss: 0.853017
steps 10600    v_Prec: 0.576926  v_Recall: 0.689446  v_F1: 0.628187  v_AUC: 0.879675
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.294043    reg_loss: 0.559551    l2_loss: 0.021445    loss: 0.875039
steps 10800    v_Prec: 0.576463  v_Recall: 0.696072  v_F1: 0.630646  v_AUC: 0.882407
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.257490    reg_loss: 0.494159    l2_loss: 0.021197    loss: 0.772847
steps 11000    v_Prec: 0.584917  v_Recall: 0.673080  v_F1: 0.625909  v_AUC: 0.876949
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.264318    reg_loss: 0.505405    l2_loss: 0.021393    loss: 0.791116
steps 11200    v_Prec: 0.626914  v_Recall: 0.621108  v_F1: 0.623997  v_AUC: 0.875007
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.268438    reg_loss: 0.513934    l2_loss: 0.021458    loss: 0.803830
steps 11400    v_Prec: 0.611787  v_Recall: 0.633961  v_F1: 0.622677  v_AUC: 0.874431
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.269899    reg_loss: 0.512536    l2_loss: 0.021322    loss: 0.803757
steps 11600    v_Prec: 0.565405  v_Recall: 0.701182  v_F1: 0.626016  v_AUC: 0.878260
steps 11600    running time 411 seconds

steps 11800    base_loss: 0.254294    reg_loss: 0.490753    l2_loss: 0.021231    loss: 0.766277
steps 11800    v_Prec: 0.555185  v_Recall: 0.718027  v_F1: 0.626192  v_AUC: 0.876677
steps 11800    running time 417 seconds

steps 12000    base_loss: 0.265913    reg_loss: 0.509302    l2_loss: 0.021278    loss: 0.796492
steps 12000    v_Prec: 0.575854  v_Recall: 0.679706  v_F1: 0.623485  v_AUC: 0.875497
steps 12000    running time 423 seconds

steps 12200    base_loss: 0.263277    reg_loss: 0.494181    l2_loss: 0.021313    loss: 0.778770
steps 12200    v_Prec: 0.608804  v_Recall: 0.644819  v_F1: 0.626294  v_AUC: 0.875593
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.268596    reg_loss: 0.516697    l2_loss: 0.021330    loss: 0.806623
steps 12400    v_Prec: 0.588053  v_Recall: 0.667252  v_F1: 0.625154  v_AUC: 0.875213
steps 12400    running time 436 seconds

steps 12600    base_loss: 0.270902    reg_loss: 0.512836    l2_loss: 0.021156    loss: 0.804895
steps 12600    v_Prec: 0.593229  v_Recall: 0.661664  v_F1: 0.625580  v_AUC: 0.877514
steps 12600    running time 442 seconds

steps 12800    base_loss: 0.268667    reg_loss: 0.502321    l2_loss: 0.021254    loss: 0.792243
steps 12800    v_Prec: 0.595006  v_Recall: 0.658231  v_F1: 0.625024  v_AUC: 0.873061
steps 12800    running time 448 seconds

Early stop model F1: 0.630646
testing thre: 0.30267626
testing Prec: 0.3927815869293707
testing Recall: 0.7489671931956258
testing F1: 0.5153156768325309
testing AUC: 0.824784974558316
overall running time 450 seconds
(0.4947298530998423, 0.5794410692588092, 0.5337452152306762, 0.824784974558316, 0.54928976)

2019-02-24 20:01:10.157625: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 20:01:10.990029: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 20:01:10.996757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 20:01:10.996804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.130000 seconds
loading data in 30.170000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.667834    reg_loss: 2.161828    l2_loss: 0.013357    loss: 2.843019
steps 200    v_Prec: 0.162583  v_Recall: 0.999278  v_F1: 0.279665  v_AUC: 0.538017
steps 200    running time 40 seconds

steps 400    base_loss: 0.531748    reg_loss: 2.130297    l2_loss: 0.013325    loss: 2.675369
steps 400    v_Prec: 0.175778  v_Recall: 0.716728  v_F1: 0.282318  v_AUC: 0.554595
steps 400    running time 47 seconds

steps 600    base_loss: 0.481090    reg_loss: 2.078146    l2_loss: 0.013245    loss: 2.572481
steps 600    v_Prec: 0.192088  v_Recall: 0.651710  v_F1: 0.296720  v_AUC: 0.582004
steps 600    running time 54 seconds

steps 800    base_loss: 0.468538    reg_loss: 1.998050    l2_loss: 0.013192    loss: 2.479780
steps 800    v_Prec: 0.208385  v_Recall: 0.596083  v_F1: 0.308812  v_AUC: 0.602052
steps 800    running time 60 seconds

steps 1000    base_loss: 0.447603    reg_loss: 1.892483    l2_loss: 0.013125    loss: 2.353211
steps 1000    v_Prec: 0.242579  v_Recall: 0.484749  v_F1: 0.323348  v_AUC: 0.624133
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.451171    reg_loss: 1.804085    l2_loss: 0.013096    loss: 2.268352
steps 1200    v_Prec: 0.282877  v_Recall: 0.423021  v_F1: 0.339038  v_AUC: 0.645332
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.430923    reg_loss: 1.695945    l2_loss: 0.013139    loss: 2.140007
steps 1400    v_Prec: 0.308908  v_Recall: 0.417242  v_F1: 0.354994  v_AUC: 0.664225
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.427383    reg_loss: 1.635986    l2_loss: 0.013241    loss: 2.076610
steps 1600    v_Prec: 0.330980  v_Recall: 0.455370  v_F1: 0.383337  v_AUC: 0.708309
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.406697    reg_loss: 1.556806    l2_loss: 0.013418    loss: 1.976921
steps 1800    v_Prec: 0.371115  v_Recall: 0.513806  v_F1: 0.430957  v_AUC: 0.744120
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.404449    reg_loss: 1.517883    l2_loss: 0.013619    loss: 1.935951
steps 2000    v_Prec: 0.428753  v_Recall: 0.540295  v_F1: 0.478105  v_AUC: 0.777280
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.382826    reg_loss: 1.462243    l2_loss: 0.013836    loss: 1.858906
steps 2200    v_Prec: 0.460122  v_Recall: 0.567748  v_F1: 0.508300  v_AUC: 0.796750
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.368005    reg_loss: 1.410241    l2_loss: 0.014016    loss: 1.792261
steps 2400    v_Prec: 0.477933  v_Recall: 0.574571  v_F1: 0.521815  v_AUC: 0.809550
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.357531    reg_loss: 1.364854    l2_loss: 0.014286    loss: 1.736671
steps 2600    v_Prec: 0.493685  v_Recall: 0.599294  v_F1: 0.541387  v_AUC: 0.822965
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.347400    reg_loss: 1.313547    l2_loss: 0.014497    loss: 1.675444
steps 2800    v_Prec: 0.513012  v_Recall: 0.601300  v_F1: 0.553659  v_AUC: 0.832992
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.340321    reg_loss: 1.270177    l2_loss: 0.014778    loss: 1.625276
steps 3000    v_Prec: 0.528221  v_Recall: 0.590464  v_F1: 0.557611  v_AUC: 0.838952
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.340178    reg_loss: 1.230302    l2_loss: 0.015104    loss: 1.585584
steps 3200    v_Prec: 0.522570  v_Recall: 0.618879  v_F1: 0.566662  v_AUC: 0.842297
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.334120    reg_loss: 1.175588    l2_loss: 0.015389    loss: 1.525096
steps 3400    v_Prec: 0.524986  v_Recall: 0.613903  v_F1: 0.565974  v_AUC: 0.844427
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.336811    reg_loss: 1.140393    l2_loss: 0.015688    loss: 1.492893
steps 3600    v_Prec: 0.539037  v_Recall: 0.613501  v_F1: 0.573863  v_AUC: 0.850488
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.339377    reg_loss: 1.111954    l2_loss: 0.015953    loss: 1.467285
steps 3800    v_Prec: 0.531877  v_Recall: 0.631482  v_F1: 0.577416  v_AUC: 0.853658
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.328885    reg_loss: 1.061193    l2_loss: 0.016263    loss: 1.406341
steps 4000    v_Prec: 0.541744  v_Recall: 0.628672  v_F1: 0.581980  v_AUC: 0.855111
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.332528    reg_loss: 1.026949    l2_loss: 0.016540    loss: 1.376016
steps 4200    v_Prec: 0.545254  v_Recall: 0.633489  v_F1: 0.586069  v_AUC: 0.856969
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.320950    reg_loss: 0.965184    l2_loss: 0.016948    loss: 1.303082
steps 4400    v_Prec: 0.549602  v_Recall: 0.631482  v_F1: 0.587704  v_AUC: 0.856433
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.332259    reg_loss: 0.948265    l2_loss: 0.017275    loss: 1.297799
steps 4600    v_Prec: 0.559714  v_Recall: 0.615829  v_F1: 0.586432  v_AUC: 0.858744
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.324818    reg_loss: 0.905032    l2_loss: 0.017537    loss: 1.247387
steps 4800    v_Prec: 0.531088  v_Recall: 0.656847  v_F1: 0.587311  v_AUC: 0.857107
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.330463    reg_loss: 0.873504    l2_loss: 0.017815    loss: 1.221783
steps 5000    v_Prec: 0.554734  v_Recall: 0.644325  v_F1: 0.596182  v_AUC: 0.861669
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.319300    reg_loss: 0.837012    l2_loss: 0.018169    loss: 1.174481
steps 5200    v_Prec: 0.523854  v_Recall: 0.680446  v_F1: 0.591969  v_AUC: 0.861467
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.321123    reg_loss: 0.806615    l2_loss: 0.018635    loss: 1.146374
steps 5400    v_Prec: 0.539475  v_Recall: 0.664232  v_F1: 0.595388  v_AUC: 0.863307
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.306808    reg_loss: 0.708743    l2_loss: 0.018959    loss: 1.034509
steps 5600    v_Prec: 0.581392  v_Recall: 0.604913  v_F1: 0.592919  v_AUC: 0.857912
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.298808    reg_loss: 0.689604    l2_loss: 0.019176    loss: 1.007588
steps 5800    v_Prec: 0.582190  v_Recall: 0.612939  v_F1: 0.597169  v_AUC: 0.857819
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.294228    reg_loss: 0.653340    l2_loss: 0.019350    loss: 0.966918
steps 6000    v_Prec: 0.577690  v_Recall: 0.621047  v_F1: 0.598584  v_AUC: 0.856428
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.294676    reg_loss: 0.660233    l2_loss: 0.019678    loss: 0.974587
steps 6200    v_Prec: 0.583907  v_Recall: 0.626746  v_F1: 0.604568  v_AUC: 0.862521
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.304309    reg_loss: 0.671943    l2_loss: 0.019903    loss: 0.996155
steps 6400    v_Prec: 0.562111  v_Recall: 0.659255  v_F1: 0.606820  v_AUC: 0.863896
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.299762    reg_loss: 0.654154    l2_loss: 0.020067    loss: 0.973983
steps 6600    v_Prec: 0.553540  v_Recall: 0.675951  v_F1: 0.608652  v_AUC: 0.866809
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.296287    reg_loss: 0.636636    l2_loss: 0.020304    loss: 0.953227
steps 6800    v_Prec: 0.550336  v_Recall: 0.683657  v_F1: 0.609795  v_AUC: 0.866865
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.296622    reg_loss: 0.635207    l2_loss: 0.020455    loss: 0.952284
steps 7000    v_Prec: 0.557730  v_Recall: 0.688634  v_F1: 0.616307  v_AUC: 0.868238
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.305522    reg_loss: 0.640891    l2_loss: 0.020476    loss: 0.966890
steps 7200    v_Prec: 0.575844  v_Recall: 0.663991  v_F1: 0.616784  v_AUC: 0.870817
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.304012    reg_loss: 0.628470    l2_loss: 0.020511    loss: 0.952993
steps 7400    v_Prec: 0.577772  v_Recall: 0.672660  v_F1: 0.621616  v_AUC: 0.868102
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.298911    reg_loss: 0.613289    l2_loss: 0.020603    loss: 0.932803
steps 7600    v_Prec: 0.568483  v_Recall: 0.677316  v_F1: 0.618146  v_AUC: 0.869931
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.293977    reg_loss: 0.605283    l2_loss: 0.020698    loss: 0.919958
steps 7800    v_Prec: 0.573219  v_Recall: 0.679323  v_F1: 0.621777  v_AUC: 0.875265
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.290824    reg_loss: 0.594355    l2_loss: 0.020769    loss: 0.905948
steps 8000    v_Prec: 0.560049  v_Recall: 0.701477  v_F1: 0.622835  v_AUC: 0.877205
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.299050    reg_loss: 0.592920    l2_loss: 0.020854    loss: 0.912824
steps 8200    v_Prec: 0.565676  v_Recall: 0.696902  v_F1: 0.624470  v_AUC: 0.875321
steps 8200    running time 307 seconds

steps 8400    base_loss: 0.302522    reg_loss: 0.603508    l2_loss: 0.020988    loss: 0.927018
steps 8400    v_Prec: 0.554301  v_Recall: 0.709584  v_F1: 0.622404  v_AUC: 0.875985
steps 8400    running time 314 seconds

steps 8600    base_loss: 0.299833    reg_loss: 0.590587    l2_loss: 0.021191    loss: 0.911611
steps 8600    v_Prec: 0.566320  v_Recall: 0.699149  v_F1: 0.625763  v_AUC: 0.876216
steps 8600    running time 320 seconds

steps 8800    base_loss: 0.303606    reg_loss: 0.590055    l2_loss: 0.021221    loss: 0.914882
steps 8800    v_Prec: 0.561700  v_Recall: 0.704447  v_F1: 0.625027  v_AUC: 0.877180
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.297078    reg_loss: 0.582203    l2_loss: 0.021264    loss: 0.900546
steps 9000    v_Prec: 0.596168  v_Recall: 0.649382  v_F1: 0.621638  v_AUC: 0.875689
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.297267    reg_loss: 0.576053    l2_loss: 0.021288    loss: 0.894608
steps 9200    v_Prec: 0.577973  v_Recall: 0.686627  v_F1: 0.627632  v_AUC: 0.877113
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.303395    reg_loss: 0.584208    l2_loss: 0.021325    loss: 0.908928
steps 9400    v_Prec: 0.573492  v_Recall: 0.691524  v_F1: 0.627001  v_AUC: 0.877869
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.294050    reg_loss: 0.568199    l2_loss: 0.021318    loss: 0.883568
steps 9600    v_Prec: 0.562734  v_Recall: 0.700594  v_F1: 0.624142  v_AUC: 0.879176
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.290454    reg_loss: 0.561314    l2_loss: 0.021365    loss: 0.873133
steps 9800    v_Prec: 0.562674  v_Recall: 0.697945  v_F1: 0.623052  v_AUC: 0.879754
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.289290    reg_loss: 0.549360    l2_loss: 0.021369    loss: 0.860018
steps 10000    v_Prec: 0.581777  v_Recall: 0.687831  v_F1: 0.630375  v_AUC: 0.878249
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.300614    reg_loss: 0.569470    l2_loss: 0.021186    loss: 0.891270
steps 10200    v_Prec: 0.570298  v_Recall: 0.694172  v_F1: 0.626168  v_AUC: 0.879442
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.293077    reg_loss: 0.552727    l2_loss: 0.021130    loss: 0.866933
steps 10400    v_Prec: 0.566160  v_Recall: 0.702360  v_F1: 0.626948  v_AUC: 0.879828
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.295105    reg_loss: 0.554015    l2_loss: 0.021207    loss: 0.870328
steps 10600    v_Prec: 0.576656  v_Recall: 0.700755  v_F1: 0.632677  v_AUC: 0.881439
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.288349    reg_loss: 0.548600    l2_loss: 0.021378    loss: 0.858327
steps 10800    v_Prec: 0.595406  v_Recall: 0.676272  v_F1: 0.633268  v_AUC: 0.882603
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.258256    reg_loss: 0.505891    l2_loss: 0.021536    loss: 0.785683
steps 11000    v_Prec: 0.600857  v_Recall: 0.652753  v_F1: 0.625731  v_AUC: 0.878248
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.257655    reg_loss: 0.502733    l2_loss: 0.021544    loss: 0.781932
steps 11200    v_Prec: 0.602095  v_Recall: 0.650666  v_F1: 0.625439  v_AUC: 0.878693
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.260558    reg_loss: 0.514727    l2_loss: 0.021627    loss: 0.796912
steps 11400    v_Prec: 0.653094  v_Recall: 0.594799  v_F1: 0.622584  v_AUC: 0.876830
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.262643    reg_loss: 0.513556    l2_loss: 0.021554    loss: 0.797753
steps 11600    v_Prec: 0.597605  v_Recall: 0.652914  v_F1: 0.624036  v_AUC: 0.877220
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.263606    reg_loss: 0.513095    l2_loss: 0.021577    loss: 0.798278
steps 11800    v_Prec: 0.596493  v_Recall: 0.657971  v_F1: 0.625725  v_AUC: 0.876494
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.259046    reg_loss: 0.506074    l2_loss: 0.021566    loss: 0.786686
steps 12000    v_Prec: 0.601861  v_Recall: 0.643843  v_F1: 0.622145  v_AUC: 0.876425
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.267130    reg_loss: 0.515486    l2_loss: 0.021407    loss: 0.804023
steps 12200    v_Prec: 0.602188  v_Recall: 0.658212  v_F1: 0.628955  v_AUC: 0.876511
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.266832    reg_loss: 0.509158    l2_loss: 0.021548    loss: 0.797539
steps 12400    v_Prec: 0.548691  v_Recall: 0.729973  v_F1: 0.626481  v_AUC: 0.878384
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.264984    reg_loss: 0.513653    l2_loss: 0.021611    loss: 0.800249
steps 12600    v_Prec: 0.613509  v_Recall: 0.634291  v_F1: 0.623727  v_AUC: 0.874429
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.272946    reg_loss: 0.515964    l2_loss: 0.021538    loss: 0.810447
steps 12800    v_Prec: 0.579095  v_Recall: 0.677316  v_F1: 0.624366  v_AUC: 0.876708
steps 12800    running time 453 seconds

Early stop model F1: 0.633268
testing thre: 0.33685234
testing Prec: 0.4024963092202389
testing Recall: 0.7287970838396112
testing F1: 0.5185889676638422
testing AUC: 0.8257831352512377
overall running time 456 seconds
(0.46063774176685834, 0.6424301336573511, 0.5365536837832353, 0.8257831352512377, 0.50264144)

2019-02-24 20:06:08.397135: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 20:06:09.238594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 20:06:09.349137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 20:06:09.349215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.660000 seconds
loading data in 32.020000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.537529    reg_loss: 2.163419    l2_loss: 0.013328    loss: 2.714276
steps 200    v_Prec: 0.165138  v_Recall: 0.998971  v_F1: 0.283424  v_AUC: 0.524649
steps 200    running time 42 seconds

steps 400    base_loss: 0.489446    reg_loss: 2.140182    l2_loss: 0.013327    loss: 2.642955
steps 400    v_Prec: 0.171249  v_Recall: 0.875910  v_F1: 0.286487  v_AUC: 0.555534
steps 400    running time 49 seconds

steps 600    base_loss: 0.474336    reg_loss: 2.093713    l2_loss: 0.013340    loss: 2.581388
steps 600    v_Prec: 0.195059  v_Recall: 0.657961  v_F1: 0.300910  v_AUC: 0.590965
steps 600    running time 55 seconds

steps 800    base_loss: 0.457839    reg_loss: 2.013056    l2_loss: 0.013281    loss: 2.484175
steps 800    v_Prec: 0.209461  v_Recall: 0.586578  v_F1: 0.308692  v_AUC: 0.613064
steps 800    running time 62 seconds

steps 1000    base_loss: 0.450059    reg_loss: 1.916106    l2_loss: 0.013192    loss: 2.379357
steps 1000    v_Prec: 0.269167  v_Recall: 0.422602  v_F1: 0.328868  v_AUC: 0.635778
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.451479    reg_loss: 1.824178    l2_loss: 0.013140    loss: 2.288797
steps 1200    v_Prec: 0.267931  v_Recall: 0.499604  v_F1: 0.348804  v_AUC: 0.659942
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.434847    reg_loss: 1.724080    l2_loss: 0.013269    loss: 2.172196
steps 1400    v_Prec: 0.323419  v_Recall: 0.441437  v_F1: 0.373323  v_AUC: 0.690529
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.421715    reg_loss: 1.639910    l2_loss: 0.013308    loss: 2.074933
steps 1600    v_Prec: 0.289026  v_Recall: 0.651155  v_F1: 0.400350  v_AUC: 0.730863
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.411694    reg_loss: 1.575367    l2_loss: 0.013492    loss: 2.000553
steps 1800    v_Prec: 0.411871  v_Recall: 0.434948  v_F1: 0.423095  v_AUC: 0.749634
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.400358    reg_loss: 1.517946    l2_loss: 0.013717    loss: 1.932021
steps 2000    v_Prec: 0.364334  v_Recall: 0.649810  v_F1: 0.466892  v_AUC: 0.783122
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.383180    reg_loss: 1.467497    l2_loss: 0.013910    loss: 1.864587
steps 2200    v_Prec: 0.399247  v_Recall: 0.637860  v_F1: 0.491104  v_AUC: 0.799287
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.365871    reg_loss: 1.400570    l2_loss: 0.014149    loss: 1.780591
steps 2400    v_Prec: 0.470033  v_Recall: 0.594571  v_F1: 0.525017  v_AUC: 0.814437
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.362431    reg_loss: 1.367165    l2_loss: 0.014441    loss: 1.744037
steps 2600    v_Prec: 0.467929  v_Recall: 0.625831  v_F1: 0.535482  v_AUC: 0.825034
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.355816    reg_loss: 1.318636    l2_loss: 0.014747    loss: 1.689198
steps 2800    v_Prec: 0.498347  v_Recall: 0.608500  v_F1: 0.547942  v_AUC: 0.831183
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.349355    reg_loss: 1.275818    l2_loss: 0.014971    loss: 1.640145
steps 3000    v_Prec: 0.482669  v_Recall: 0.649098  v_F1: 0.553647  v_AUC: 0.837267
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.345345    reg_loss: 1.224753    l2_loss: 0.015314    loss: 1.585413
steps 3200    v_Prec: 0.495876  v_Recall: 0.627968  v_F1: 0.554159  v_AUC: 0.840030
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.340153    reg_loss: 1.174668    l2_loss: 0.015631    loss: 1.530452
steps 3400    v_Prec: 0.509934  v_Recall: 0.637781  v_F1: 0.566737  v_AUC: 0.845426
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.336728    reg_loss: 1.132650    l2_loss: 0.015904    loss: 1.485282
steps 3600    v_Prec: 0.526733  v_Recall: 0.636198  v_F1: 0.576314  v_AUC: 0.849299
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.334541    reg_loss: 1.089466    l2_loss: 0.016196    loss: 1.440203
steps 3800    v_Prec: 0.549248  v_Recall: 0.609449  v_F1: 0.577784  v_AUC: 0.849810
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.327841    reg_loss: 1.038825    l2_loss: 0.016551    loss: 1.383217
steps 4000    v_Prec: 0.519330  v_Recall: 0.652738  v_F1: 0.578442  v_AUC: 0.850290
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.333343    reg_loss: 1.011265    l2_loss: 0.016824    loss: 1.361431
steps 4200    v_Prec: 0.521107  v_Recall: 0.658436  v_F1: 0.581777  v_AUC: 0.853520
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.337650    reg_loss: 0.980636    l2_loss: 0.017096    loss: 1.335382
steps 4400    v_Prec: 0.535357  v_Recall: 0.643479  v_F1: 0.584459  v_AUC: 0.854336
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.331662    reg_loss: 0.938008    l2_loss: 0.017540    loss: 1.287210
steps 4600    v_Prec: 0.553618  v_Recall: 0.633270  v_F1: 0.590772  v_AUC: 0.858092
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.329900    reg_loss: 0.899525    l2_loss: 0.017884    loss: 1.247310
steps 4800    v_Prec: 0.538655  v_Recall: 0.660019  v_F1: 0.593193  v_AUC: 0.859563
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.328623    reg_loss: 0.867444    l2_loss: 0.018209    loss: 1.214276
steps 5000    v_Prec: 0.551816  v_Recall: 0.640947  v_F1: 0.593051  v_AUC: 0.859446
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.325430    reg_loss: 0.833660    l2_loss: 0.018523    loss: 1.177613
steps 5200    v_Prec: 0.551641  v_Recall: 0.631925  v_F1: 0.589060  v_AUC: 0.859182
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.324377    reg_loss: 0.803355    l2_loss: 0.018942    loss: 1.146673
steps 5400    v_Prec: 0.519912  v_Recall: 0.673631  v_F1: 0.586873  v_AUC: 0.860218
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.300743    reg_loss: 0.685007    l2_loss: 0.019276    loss: 1.005026
steps 5600    v_Prec: 0.561977  v_Recall: 0.621795  v_F1: 0.590375  v_AUC: 0.855536
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.299032    reg_loss: 0.676990    l2_loss: 0.019426    loss: 0.995448
steps 5800    v_Prec: 0.545046  v_Recall: 0.653055  v_F1: 0.594182  v_AUC: 0.861594
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.299691    reg_loss: 0.672208    l2_loss: 0.019617    loss: 0.991516
steps 6000    v_Prec: 0.560003  v_Recall: 0.641105  v_F1: 0.597816  v_AUC: 0.860287
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.299493    reg_loss: 0.666969    l2_loss: 0.019761    loss: 0.986223
steps 6200    v_Prec: 0.543400  v_Recall: 0.658436  v_F1: 0.595413  v_AUC: 0.862799
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.300157    reg_loss: 0.655823    l2_loss: 0.020038    loss: 0.976018
steps 6400    v_Prec: 0.561761  v_Recall: 0.643162  v_F1: 0.599712  v_AUC: 0.861658
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.301481    reg_loss: 0.641810    l2_loss: 0.020293    loss: 0.963584
steps 6600    v_Prec: 0.554238  v_Recall: 0.650997  v_F1: 0.598734  v_AUC: 0.863862
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.303581    reg_loss: 0.647723    l2_loss: 0.020392    loss: 0.971696
steps 6800    v_Prec: 0.538577  v_Recall: 0.680041  v_F1: 0.601098  v_AUC: 0.864486
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.303426    reg_loss: 0.639185    l2_loss: 0.020443    loss: 0.963054
steps 7000    v_Prec: 0.564760  v_Recall: 0.637702  v_F1: 0.599019  v_AUC: 0.861287
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.305056    reg_loss: 0.639153    l2_loss: 0.020750    loss: 0.964958
steps 7200    v_Prec: 0.570721  v_Recall: 0.656220  v_F1: 0.610491  v_AUC: 0.868092
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.296660    reg_loss: 0.611329    l2_loss: 0.020950    loss: 0.928940
steps 7400    v_Prec: 0.560104  v_Recall: 0.667062  v_F1: 0.608922  v_AUC: 0.867327
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.304531    reg_loss: 0.629378    l2_loss: 0.020926    loss: 0.954834
steps 7600    v_Prec: 0.538791  v_Recall: 0.696344  v_F1: 0.607519  v_AUC: 0.870580
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.301245    reg_loss: 0.612954    l2_loss: 0.021015    loss: 0.935214
steps 7800    v_Prec: 0.582303  v_Recall: 0.644745  v_F1: 0.611935  v_AUC: 0.869157
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.301608    reg_loss: 0.593278    l2_loss: 0.021243    loss: 0.916129
steps 8000    v_Prec: 0.565098  v_Recall: 0.685264  v_F1: 0.619407  v_AUC: 0.871459
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.302142    reg_loss: 0.595166    l2_loss: 0.021181    loss: 0.918489
steps 8200    v_Prec: 0.566256  v_Recall: 0.688192  v_F1: 0.621298  v_AUC: 0.875583
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.299686    reg_loss: 0.585069    l2_loss: 0.021245    loss: 0.906000
steps 8400    v_Prec: 0.559158  v_Recall: 0.681070  v_F1: 0.614122  v_AUC: 0.872987
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.300334    reg_loss: 0.584739    l2_loss: 0.021195    loss: 0.906269
steps 8600    v_Prec: 0.573827  v_Recall: 0.681545  v_F1: 0.623065  v_AUC: 0.872378
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.298289    reg_loss: 0.577034    l2_loss: 0.021338    loss: 0.896662
steps 8800    v_Prec: 0.568621  v_Recall: 0.677746  v_F1: 0.618406  v_AUC: 0.873991
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.308405    reg_loss: 0.590503    l2_loss: 0.021376    loss: 0.920284
steps 9000    v_Prec: 0.575723  v_Recall: 0.679012  v_F1: 0.623116  v_AUC: 0.876778
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.300186    reg_loss: 0.574905    l2_loss: 0.021337    loss: 0.896427
steps 9200    v_Prec: 0.578023  v_Recall: 0.676876  v_F1: 0.623556  v_AUC: 0.876597
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.306304    reg_loss: 0.584985    l2_loss: 0.021234    loss: 0.912523
steps 9400    v_Prec: 0.579401  v_Recall: 0.680279  v_F1: 0.625801  v_AUC: 0.876889
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.304382    reg_loss: 0.581853    l2_loss: 0.021303    loss: 0.907538
steps 9600    v_Prec: 0.557323  v_Recall: 0.726337  v_F1: 0.630704  v_AUC: 0.878185
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.297037    reg_loss: 0.561027    l2_loss: 0.021433    loss: 0.879497
steps 9800    v_Prec: 0.575609  v_Recall: 0.688034  v_F1: 0.626820  v_AUC: 0.877594
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.296951    reg_loss: 0.551526    l2_loss: 0.021314    loss: 0.869792
steps 10000    v_Prec: 0.566614  v_Recall: 0.703783  v_F1: 0.627793  v_AUC: 0.879995
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.296005    reg_loss: 0.555354    l2_loss: 0.021392    loss: 0.872752
steps 10200    v_Prec: 0.566479  v_Recall: 0.716841  v_F1: 0.632851  v_AUC: 0.882490
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.301008    reg_loss: 0.560827    l2_loss: 0.021433    loss: 0.883269
steps 10400    v_Prec: 0.581278  v_Recall: 0.689934  v_F1: 0.630962  v_AUC: 0.881332
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.296180    reg_loss: 0.556137    l2_loss: 0.021595    loss: 0.873913
steps 10600    v_Prec: 0.592547  v_Recall: 0.682020  v_F1: 0.634143  v_AUC: 0.882314
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.292047    reg_loss: 0.545159    l2_loss: 0.021533    loss: 0.858739
steps 10800    v_Prec: 0.571603  v_Recall: 0.705049  v_F1: 0.631351  v_AUC: 0.881058
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.260040    reg_loss: 0.507040    l2_loss: 0.021477    loss: 0.788557
steps 11000    v_Prec: 0.563169  v_Recall: 0.707661  v_F1: 0.627201  v_AUC: 0.876807
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.261834    reg_loss: 0.506207    l2_loss: 0.021389    loss: 0.789430
steps 11200    v_Prec: 0.572710  v_Recall: 0.682257  v_F1: 0.622702  v_AUC: 0.872597
steps 11200    running time 404 seconds

steps 11400    base_loss: 0.263991    reg_loss: 0.512603    l2_loss: 0.021387    loss: 0.797981
steps 11400    v_Prec: 0.569609  v_Recall: 0.690013  v_F1: 0.624056  v_AUC: 0.875565
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.258783    reg_loss: 0.507917    l2_loss: 0.021375    loss: 0.788075
steps 11600    v_Prec: 0.557922  v_Recall: 0.708927  v_F1: 0.624425  v_AUC: 0.874761
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.268071    reg_loss: 0.516243    l2_loss: 0.021235    loss: 0.805550
steps 11800    v_Prec: 0.594397  v_Recall: 0.656537  v_F1: 0.623924  v_AUC: 0.874718
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.261498    reg_loss: 0.496318    l2_loss: 0.021157    loss: 0.778974
steps 12000    v_Prec: 0.639309  v_Recall: 0.612140  v_F1: 0.625430  v_AUC: 0.874943
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.275967    reg_loss: 0.520108    l2_loss: 0.021138    loss: 0.817213
steps 12200    v_Prec: 0.584167  v_Recall: 0.670386  v_F1: 0.624314  v_AUC: 0.874136
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.260329    reg_loss: 0.502917    l2_loss: 0.021263    loss: 0.784509
steps 12400    v_Prec: 0.583860  v_Recall: 0.665875  v_F1: 0.622176  v_AUC: 0.875077
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.265185    reg_loss: 0.515589    l2_loss: 0.021274    loss: 0.802048
steps 12600    v_Prec: 0.602940  v_Recall: 0.642688  v_F1: 0.622180  v_AUC: 0.876212
steps 12600    running time 447 seconds

Early stop model F1: 0.634143
testing thre: 0.3075692
testing Prec: 0.38864495047482894
testing Recall: 0.7399270959902795
testing F1: 0.5096155455504042
testing AUC: 0.8189470318348716
overall running time 450 seconds
(0.45624519465995667, 0.6345078979343864, 0.5308097338835919, 0.8189470318348716, 0.48475704)

