2019-02-24 14:48:21.989532: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 14:48:22.575603: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 14:48:22.705756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 14:48:22.705835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.470000 seconds
loading data in 31.420000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.536672    reg_loss: 0.064945    l2_loss: 0.013336    loss: 0.614953
steps 200    v_Prec: 0.163843  v_Recall: 0.999602  v_F1: 0.281540  v_AUC: 0.497366
steps 200    running time 41 seconds

steps 400    base_loss: 0.481779    reg_loss: 0.064830    l2_loss: 0.013273    loss: 0.559882
steps 400    v_Prec: 0.163891  v_Recall: 0.998167  v_F1: 0.281553  v_AUC: 0.506150
steps 400    running time 47 seconds

steps 600    base_loss: 0.475052    reg_loss: 0.064654    l2_loss: 0.013182    loss: 0.552888
steps 600    v_Prec: 0.163740  v_Recall: 1.000000  v_F1: 0.281402  v_AUC: 0.508394
steps 600    running time 52 seconds

steps 800    base_loss: 0.462994    reg_loss: 0.064511    l2_loss: 0.013036    loss: 0.540542
steps 800    v_Prec: 0.163763  v_Recall: 1.000000  v_F1: 0.281437  v_AUC: 0.521454
steps 800    running time 58 seconds

steps 1000    base_loss: 0.453368    reg_loss: 0.064344    l2_loss: 0.012943    loss: 0.530655
steps 1000    v_Prec: 0.163742  v_Recall: 1.000000  v_F1: 0.281406  v_AUC: 0.536784
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.454969    reg_loss: 0.064199    l2_loss: 0.012735    loss: 0.531904
steps 1200    v_Prec: 0.203032  v_Recall: 0.541159  v_F1: 0.295280  v_AUC: 0.588982
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.438714    reg_loss: 0.064079    l2_loss: 0.012626    loss: 0.515419
steps 1400    v_Prec: 0.303766  v_Recall: 0.439637  v_F1: 0.359285  v_AUC: 0.673975
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.408182    reg_loss: 0.064511    l2_loss: 0.012580    loss: 0.485273
steps 1600    v_Prec: 0.384057  v_Recall: 0.463384  v_F1: 0.420007  v_AUC: 0.735931
steps 1600    running time 81 seconds

steps 1800    base_loss: 0.386653    reg_loss: 0.064860    l2_loss: 0.012645    loss: 0.464158
steps 1800    v_Prec: 0.445243  v_Recall: 0.503466  v_F1: 0.472568  v_AUC: 0.776622
steps 1800    running time 87 seconds

steps 2000    base_loss: 0.372482    reg_loss: 0.064963    l2_loss: 0.012800    loss: 0.450246
steps 2000    v_Prec: 0.504001  v_Recall: 0.517013  v_F1: 0.510424  v_AUC: 0.804638
steps 2000    running time 93 seconds

steps 2200    base_loss: 0.354351    reg_loss: 0.065281    l2_loss: 0.012948    loss: 0.432579
steps 2200    v_Prec: 0.523781  v_Recall: 0.548490  v_F1: 0.535851  v_AUC: 0.823107
steps 2200    running time 99 seconds

steps 2400    base_loss: 0.339253    reg_loss: 0.065444    l2_loss: 0.013096    loss: 0.417793
steps 2400    v_Prec: 0.542110  v_Recall: 0.568332  v_F1: 0.554911  v_AUC: 0.836901
steps 2400    running time 104 seconds

steps 2600    base_loss: 0.330945    reg_loss: 0.065672    l2_loss: 0.013296    loss: 0.409913
steps 2600    v_Prec: 0.575607  v_Recall: 0.570882  v_F1: 0.573235  v_AUC: 0.847287
steps 2600    running time 110 seconds

steps 2800    base_loss: 0.322815    reg_loss: 0.065737    l2_loss: 0.013526    loss: 0.402078
steps 2800    v_Prec: 0.555556  v_Recall: 0.612399  v_F1: 0.582594  v_AUC: 0.854602
steps 2800    running time 116 seconds

steps 3000    base_loss: 0.327193    reg_loss: 0.065954    l2_loss: 0.013718    loss: 0.406865
steps 3000    v_Prec: 0.605413  v_Recall: 0.582835  v_F1: 0.593910  v_AUC: 0.861680
steps 3000    running time 122 seconds

steps 3200    base_loss: 0.313131    reg_loss: 0.066036    l2_loss: 0.013967    loss: 0.393133
steps 3200    v_Prec: 0.587277  v_Recall: 0.615029  v_F1: 0.600833  v_AUC: 0.865734
steps 3200    running time 128 seconds

steps 3400    base_loss: 0.305960    reg_loss: 0.065903    l2_loss: 0.014252    loss: 0.386116
steps 3400    v_Prec: 0.590630  v_Recall: 0.620846  v_F1: 0.605361  v_AUC: 0.867660
steps 3400    running time 134 seconds

steps 3600    base_loss: 0.306763    reg_loss: 0.066180    l2_loss: 0.014588    loss: 0.387532
steps 3600    v_Prec: 0.591565  v_Recall: 0.640449  v_F1: 0.615037  v_AUC: 0.874159
steps 3600    running time 139 seconds

steps 3800    base_loss: 0.307226    reg_loss: 0.066190    l2_loss: 0.014904    loss: 0.388320
steps 3800    v_Prec: 0.601729  v_Recall: 0.637740  v_F1: 0.619212  v_AUC: 0.875588
steps 3800    running time 145 seconds

steps 4000    base_loss: 0.292869    reg_loss: 0.066143    l2_loss: 0.015282    loss: 0.374293
steps 4000    v_Prec: 0.621792  v_Recall: 0.627540  v_F1: 0.624653  v_AUC: 0.878813
steps 4000    running time 151 seconds

steps 4200    base_loss: 0.298183    reg_loss: 0.065929    l2_loss: 0.015719    loss: 0.379832
steps 4200    v_Prec: 0.627549  v_Recall: 0.630249  v_F1: 0.628896  v_AUC: 0.882442
steps 4200    running time 157 seconds

steps 4400    base_loss: 0.291966    reg_loss: 0.066071    l2_loss: 0.016102    loss: 0.374140
steps 4400    v_Prec: 0.638018  v_Recall: 0.622918  v_F1: 0.630378  v_AUC: 0.884390
steps 4400    running time 163 seconds

steps 4600    base_loss: 0.290833    reg_loss: 0.065981    l2_loss: 0.016540    loss: 0.373354
steps 4600    v_Prec: 0.613559  v_Recall: 0.644753  v_F1: 0.628769  v_AUC: 0.885192
steps 4600    running time 169 seconds

steps 4800    base_loss: 0.290382    reg_loss: 0.066068    l2_loss: 0.016964    loss: 0.373414
steps 4800    v_Prec: 0.623891  v_Recall: 0.644673  v_F1: 0.634112  v_AUC: 0.886893
steps 4800    running time 174 seconds

steps 5000    base_loss: 0.287585    reg_loss: 0.065910    l2_loss: 0.017477    loss: 0.370971
steps 5000    v_Prec: 0.634635  v_Recall: 0.641007  v_F1: 0.637805  v_AUC: 0.888323
steps 5000    running time 180 seconds

steps 5200    base_loss: 0.280640    reg_loss: 0.065783    l2_loss: 0.018012    loss: 0.364435
steps 5200    v_Prec: 0.628767  v_Recall: 0.650012  v_F1: 0.639213  v_AUC: 0.888821
steps 5200    running time 186 seconds

steps 5400    base_loss: 0.283456    reg_loss: 0.065975    l2_loss: 0.018514    loss: 0.367945
steps 5400    v_Prec: 0.647073  v_Recall: 0.645629  v_F1: 0.646350  v_AUC: 0.890884
steps 5400    running time 192 seconds

steps 5600    base_loss: 0.207515    reg_loss: 0.066537    l2_loss: 0.019302    loss: 0.293353
steps 5600    v_Prec: 0.652185  v_Recall: 0.625628  v_F1: 0.638630  v_AUC: 0.885490
steps 5600    running time 198 seconds

steps 5800    base_loss: 0.205603    reg_loss: 0.066801    l2_loss: 0.019889    loss: 0.292294
steps 5800    v_Prec: 0.629409  v_Recall: 0.641246  v_F1: 0.635273  v_AUC: 0.884833
steps 5800    running time 203 seconds

steps 6000    base_loss: 0.228800    reg_loss: 0.066867    l2_loss: 0.020601    loss: 0.316268
steps 6000    v_Prec: 0.640292  v_Recall: 0.643557  v_F1: 0.641920  v_AUC: 0.887691
steps 6000    running time 209 seconds

steps 6200    base_loss: 0.218730    reg_loss: 0.066570    l2_loss: 0.020908    loss: 0.306208
steps 6200    v_Prec: 0.644489  v_Recall: 0.640689  v_F1: 0.642583  v_AUC: 0.887239
steps 6200    running time 215 seconds

steps 6400    base_loss: 0.212277    reg_loss: 0.066625    l2_loss: 0.021531    loss: 0.300434
steps 6400    v_Prec: 0.628223  v_Recall: 0.652403  v_F1: 0.640084  v_AUC: 0.886427
steps 6400    running time 220 seconds

steps 6600    base_loss: 0.219045    reg_loss: 0.066618    l2_loss: 0.021898    loss: 0.307561
steps 6600    v_Prec: 0.636772  v_Recall: 0.644434  v_F1: 0.640580  v_AUC: 0.888132
steps 6600    running time 226 seconds

steps 6800    base_loss: 0.222326    reg_loss: 0.066650    l2_loss: 0.022233    loss: 0.311209
steps 6800    v_Prec: 0.639018  v_Recall: 0.657503  v_F1: 0.648129  v_AUC: 0.891390
steps 6800    running time 232 seconds

steps 7000    base_loss: 0.217527    reg_loss: 0.066548    l2_loss: 0.022704    loss: 0.306779
steps 7000    v_Prec: 0.640121  v_Recall: 0.659096  v_F1: 0.649470  v_AUC: 0.892007
steps 7000    running time 238 seconds

steps 7200    base_loss: 0.214863    reg_loss: 0.066888    l2_loss: 0.023033    loss: 0.304784
steps 7200    v_Prec: 0.644675  v_Recall: 0.664196  v_F1: 0.654290  v_AUC: 0.894302
steps 7200    running time 244 seconds

steps 7400    base_loss: 0.209686    reg_loss: 0.066567    l2_loss: 0.023422    loss: 0.299675
steps 7400    v_Prec: 0.661615  v_Recall: 0.650490  v_F1: 0.656005  v_AUC: 0.896153
steps 7400    running time 249 seconds

steps 7600    base_loss: 0.221369    reg_loss: 0.066649    l2_loss: 0.023708    loss: 0.311726
steps 7600    v_Prec: 0.638940  v_Recall: 0.670253  v_F1: 0.654222  v_AUC: 0.895364
steps 7600    running time 255 seconds

steps 7800    base_loss: 0.205659    reg_loss: 0.066477    l2_loss: 0.023980    loss: 0.296116
steps 7800    v_Prec: 0.661583  v_Recall: 0.660212  v_F1: 0.660897  v_AUC: 0.897777
steps 7800    running time 261 seconds

steps 8000    base_loss: 0.218450    reg_loss: 0.066466    l2_loss: 0.024234    loss: 0.309150
steps 8000    v_Prec: 0.663117  v_Recall: 0.660053  v_F1: 0.661581  v_AUC: 0.899819
steps 8000    running time 267 seconds

steps 8200    base_loss: 0.219099    reg_loss: 0.066584    l2_loss: 0.024428    loss: 0.310111
steps 8200    v_Prec: 0.648875  v_Recall: 0.678142  v_F1: 0.663186  v_AUC: 0.901147
steps 8200    running time 272 seconds

steps 8400    base_loss: 0.223177    reg_loss: 0.066557    l2_loss: 0.024619    loss: 0.314352
steps 8400    v_Prec: 0.677446  v_Recall: 0.661089  v_F1: 0.669167  v_AUC: 0.902857
steps 8400    running time 278 seconds

steps 8600    base_loss: 0.218520    reg_loss: 0.066322    l2_loss: 0.025033    loss: 0.309875
steps 8600    v_Prec: 0.680879  v_Recall: 0.664276  v_F1: 0.672475  v_AUC: 0.905093
steps 8600    running time 284 seconds

steps 8800    base_loss: 0.212768    reg_loss: 0.066253    l2_loss: 0.025128    loss: 0.304149
steps 8800    v_Prec: 0.680175  v_Recall: 0.668739  v_F1: 0.674408  v_AUC: 0.905556
steps 8800    running time 290 seconds

steps 9000    base_loss: 0.220953    reg_loss: 0.066358    l2_loss: 0.025271    loss: 0.312582
steps 9000    v_Prec: 0.692005  v_Recall: 0.659415  v_F1: 0.675317  v_AUC: 0.905656
steps 9000    running time 296 seconds

steps 9200    base_loss: 0.218292    reg_loss: 0.066410    l2_loss: 0.025572    loss: 0.310275
steps 9200    v_Prec: 0.691904  v_Recall: 0.662682  v_F1: 0.676978  v_AUC: 0.906145
steps 9200    running time 302 seconds

steps 9400    base_loss: 0.214856    reg_loss: 0.066375    l2_loss: 0.025793    loss: 0.307024
steps 9400    v_Prec: 0.699290  v_Recall: 0.659335  v_F1: 0.678725  v_AUC: 0.907242
steps 9400    running time 308 seconds

steps 9600    base_loss: 0.218527    reg_loss: 0.066194    l2_loss: 0.025933    loss: 0.310655
steps 9600    v_Prec: 0.707589  v_Recall: 0.662762  v_F1: 0.684442  v_AUC: 0.909966
steps 9600    running time 314 seconds

steps 9800    base_loss: 0.213173    reg_loss: 0.065874    l2_loss: 0.026174    loss: 0.305221
steps 9800    v_Prec: 0.705147  v_Recall: 0.679018  v_F1: 0.691836  v_AUC: 0.912945
steps 9800    running time 319 seconds

steps 10000    base_loss: 0.215767    reg_loss: 0.065892    l2_loss: 0.026275    loss: 0.307934
steps 10000    v_Prec: 0.701484  v_Recall: 0.681807  v_F1: 0.691506  v_AUC: 0.912261
steps 10000    running time 325 seconds

steps 10200    base_loss: 0.217110    reg_loss: 0.065873    l2_loss: 0.026550    loss: 0.309533
steps 10200    v_Prec: 0.701083  v_Recall: 0.680692  v_F1: 0.690737  v_AUC: 0.912898
steps 10200    running time 331 seconds

steps 10400    base_loss: 0.217588    reg_loss: 0.065693    l2_loss: 0.026612    loss: 0.309893
steps 10400    v_Prec: 0.715336  v_Recall: 0.674237  v_F1: 0.694179  v_AUC: 0.914712
steps 10400    running time 336 seconds

steps 10600    base_loss: 0.208001    reg_loss: 0.065751    l2_loss: 0.026755    loss: 0.300507
steps 10600    v_Prec: 0.715882  v_Recall: 0.684278  v_F1: 0.699723  v_AUC: 0.917172
steps 10600    running time 342 seconds

steps 10800    base_loss: 0.200128    reg_loss: 0.065702    l2_loss: 0.026880    loss: 0.292710
steps 10800    v_Prec: 0.732290  v_Recall: 0.659814  v_F1: 0.694165  v_AUC: 0.913657
steps 10800    running time 348 seconds

steps 11000    base_loss: 0.115716    reg_loss: 0.065791    l2_loss: 0.027095    loss: 0.208601
steps 11000    v_Prec: 0.671930  v_Recall: 0.688421  v_F1: 0.680076  v_AUC: 0.905626
steps 11000    running time 354 seconds

steps 11200    base_loss: 0.110099    reg_loss: 0.065392    l2_loss: 0.027440    loss: 0.202930
steps 11200    v_Prec: 0.681328  v_Recall: 0.659176  v_F1: 0.670069  v_AUC: 0.901690
steps 11200    running time 359 seconds

steps 11400    base_loss: 0.115312    reg_loss: 0.065516    l2_loss: 0.027473    loss: 0.208301
steps 11400    v_Prec: 0.658935  v_Recall: 0.665551  v_F1: 0.662226  v_AUC: 0.898356
steps 11400    running time 365 seconds

steps 11600    base_loss: 0.116482    reg_loss: 0.065683    l2_loss: 0.027526    loss: 0.209691
steps 11600    v_Prec: 0.667391  v_Recall: 0.661009  v_F1: 0.664184  v_AUC: 0.899487
steps 11600    running time 371 seconds

steps 11800    base_loss: 0.120876    reg_loss: 0.065595    l2_loss: 0.027624    loss: 0.214095
steps 11800    v_Prec: 0.646394  v_Recall: 0.688581  v_F1: 0.666821  v_AUC: 0.901694
steps 11800    running time 377 seconds

steps 12000    base_loss: 0.119036    reg_loss: 0.065532    l2_loss: 0.027869    loss: 0.212437
steps 12000    v_Prec: 0.650172  v_Recall: 0.679496  v_F1: 0.664511  v_AUC: 0.899986
steps 12000    running time 382 seconds

steps 12200    base_loss: 0.118709    reg_loss: 0.065140    l2_loss: 0.027772    loss: 0.211621
steps 12200    v_Prec: 0.655225  v_Recall: 0.679974  v_F1: 0.667371  v_AUC: 0.899188
steps 12200    running time 388 seconds

steps 12400    base_loss: 0.118461    reg_loss: 0.065160    l2_loss: 0.027864    loss: 0.211486
steps 12400    v_Prec: 0.643507  v_Recall: 0.687146  v_F1: 0.664611  v_AUC: 0.899040
steps 12400    running time 394 seconds

steps 12600    base_loss: 0.125268    reg_loss: 0.065535    l2_loss: 0.027945    loss: 0.218749
steps 12600    v_Prec: 0.649115  v_Recall: 0.677823  v_F1: 0.663158  v_AUC: 0.899736
steps 12600    running time 399 seconds

Early stop model F1: 0.699723
testing thre: 0.36889234
testing Prec: 0.5254850854329568
testing Recall: 0.7055164034021871
testing F1: 0.6023361480528641
testing AUC: 0.8784437544110774
overall running time 402 seconds
(0.6167460857726345, 0.6164763061968408, 0.6166111664762646, 0.8784437544110774, 0.55367756)

2019-02-24 14:52:20.013322: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 14:52:20.859865: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 14:52:20.863507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 14:52:20.863555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.950000 seconds
loading data in 31.040000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.626411    reg_loss: 0.064964    l2_loss: 0.013349    loss: 0.704724
steps 200    v_Prec: 0.165425  v_Recall: 0.999921  v_F1: 0.283884  v_AUC: 0.489323
steps 200    running time 40 seconds

steps 400    base_loss: 0.515164    reg_loss: 0.064930    l2_loss: 0.013292    loss: 0.593386
steps 400    v_Prec: 0.165469  v_Recall: 0.999448  v_F1: 0.283931  v_AUC: 0.493840
steps 400    running time 46 seconds

steps 600    base_loss: 0.480101    reg_loss: 0.064515    l2_loss: 0.013185    loss: 0.557802
steps 600    v_Prec: 0.165392  v_Recall: 1.000000  v_F1: 0.283840  v_AUC: 0.504149
steps 600    running time 52 seconds

steps 800    base_loss: 0.468355    reg_loss: 0.064387    l2_loss: 0.012949    loss: 0.545691
steps 800    v_Prec: 0.165384  v_Recall: 1.000000  v_F1: 0.283827  v_AUC: 0.506019
steps 800    running time 58 seconds

steps 1000    base_loss: 0.459024    reg_loss: 0.064252    l2_loss: 0.012828    loss: 0.536103
steps 1000    v_Prec: 0.172973  v_Recall: 0.833531  v_F1: 0.286493  v_AUC: 0.549259
steps 1000    running time 63 seconds

steps 1200    base_loss: 0.448157    reg_loss: 0.063706    l2_loss: 0.012647    loss: 0.524509
steps 1200    v_Prec: 0.211162  v_Recall: 0.598185  v_F1: 0.312138  v_AUC: 0.614871
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.443980    reg_loss: 0.063486    l2_loss: 0.012568    loss: 0.520034
steps 1400    v_Prec: 0.283893  v_Recall: 0.467219  v_F1: 0.353183  v_AUC: 0.665659
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.415022    reg_loss: 0.062926    l2_loss: 0.012520    loss: 0.490469
steps 1600    v_Prec: 0.349674  v_Recall: 0.469901  v_F1: 0.400969  v_AUC: 0.712245
steps 1600    running time 81 seconds

steps 1800    base_loss: 0.398264    reg_loss: 0.062697    l2_loss: 0.012496    loss: 0.473456
steps 1800    v_Prec: 0.396075  v_Recall: 0.512663  v_F1: 0.446890  v_AUC: 0.749716
steps 1800    running time 87 seconds

steps 2000    base_loss: 0.382310    reg_loss: 0.062726    l2_loss: 0.012458    loss: 0.457494
steps 2000    v_Prec: 0.437228  v_Recall: 0.538540  v_F1: 0.482625  v_AUC: 0.780081
steps 2000    running time 93 seconds

steps 2200    base_loss: 0.373580    reg_loss: 0.063504    l2_loss: 0.012505    loss: 0.449588
steps 2200    v_Prec: 0.494716  v_Recall: 0.542959  v_F1: 0.517716  v_AUC: 0.802590
steps 2200    running time 99 seconds

steps 2400    base_loss: 0.358292    reg_loss: 0.064009    l2_loss: 0.012643    loss: 0.434944
steps 2400    v_Prec: 0.500961  v_Recall: 0.575937  v_F1: 0.535839  v_AUC: 0.817450
steps 2400    running time 105 seconds

steps 2600    base_loss: 0.345307    reg_loss: 0.064443    l2_loss: 0.012780    loss: 0.422530
steps 2600    v_Prec: 0.542519  v_Recall: 0.567258  v_F1: 0.554613  v_AUC: 0.829281
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.335779    reg_loss: 0.064860    l2_loss: 0.013007    loss: 0.413647
steps 2800    v_Prec: 0.548636  v_Recall: 0.583826  v_F1: 0.565684  v_AUC: 0.837761
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.336416    reg_loss: 0.065348    l2_loss: 0.013298    loss: 0.415062
steps 3000    v_Prec: 0.541229  v_Recall: 0.610020  v_F1: 0.573569  v_AUC: 0.845163
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.325785    reg_loss: 0.065623    l2_loss: 0.013585    loss: 0.404994
steps 3200    v_Prec: 0.567338  v_Recall: 0.606548  v_F1: 0.586288  v_AUC: 0.852132
steps 3200    running time 128 seconds

steps 3400    base_loss: 0.325928    reg_loss: 0.065836    l2_loss: 0.013875    loss: 0.405640
steps 3400    v_Prec: 0.584641  v_Recall: 0.591006  v_F1: 0.587806  v_AUC: 0.854018
steps 3400    running time 134 seconds

steps 3600    base_loss: 0.320395    reg_loss: 0.066246    l2_loss: 0.014218    loss: 0.400858
steps 3600    v_Prec: 0.583950  v_Recall: 0.622327  v_F1: 0.602528  v_AUC: 0.860056
steps 3600    running time 140 seconds

steps 3800    base_loss: 0.320203    reg_loss: 0.066319    l2_loss: 0.014567    loss: 0.401089
steps 3800    v_Prec: 0.610649  v_Recall: 0.602604  v_F1: 0.606600  v_AUC: 0.863936
steps 3800    running time 146 seconds

steps 4000    base_loss: 0.306123    reg_loss: 0.066418    l2_loss: 0.014955    loss: 0.387496
steps 4000    v_Prec: 0.595805  v_Recall: 0.627535  v_F1: 0.611258  v_AUC: 0.865388
steps 4000    running time 152 seconds

steps 4200    base_loss: 0.312298    reg_loss: 0.066509    l2_loss: 0.015328    loss: 0.394135
steps 4200    v_Prec: 0.618598  v_Recall: 0.605128  v_F1: 0.611789  v_AUC: 0.868568
steps 4200    running time 158 seconds

steps 4400    base_loss: 0.304461    reg_loss: 0.066332    l2_loss: 0.015768    loss: 0.386561
steps 4400    v_Prec: 0.598622  v_Recall: 0.630454  v_F1: 0.614125  v_AUC: 0.869377
steps 4400    running time 164 seconds

steps 4600    base_loss: 0.297466    reg_loss: 0.066296    l2_loss: 0.016243    loss: 0.380005
steps 4600    v_Prec: 0.608824  v_Recall: 0.635819  v_F1: 0.622028  v_AUC: 0.872462
steps 4600    running time 170 seconds

steps 4800    base_loss: 0.304371    reg_loss: 0.066459    l2_loss: 0.016759    loss: 0.387588
steps 4800    v_Prec: 0.601362  v_Recall: 0.647811  v_F1: 0.623723  v_AUC: 0.875368
steps 4800    running time 176 seconds

steps 5000    base_loss: 0.299820    reg_loss: 0.066321    l2_loss: 0.017263    loss: 0.383404
steps 5000    v_Prec: 0.619103  v_Recall: 0.629507  v_F1: 0.624262  v_AUC: 0.877378
steps 5000    running time 182 seconds

steps 5200    base_loss: 0.305690    reg_loss: 0.066569    l2_loss: 0.017836    loss: 0.390095
steps 5200    v_Prec: 0.635871  v_Recall: 0.611440  v_F1: 0.623416  v_AUC: 0.877735
steps 5200    running time 188 seconds

steps 5400    base_loss: 0.293691    reg_loss: 0.066668    l2_loss: 0.018362    loss: 0.378721
steps 5400    v_Prec: 0.616037  v_Recall: 0.635819  v_F1: 0.625772  v_AUC: 0.879215
steps 5400    running time 194 seconds

steps 5600    base_loss: 0.219225    reg_loss: 0.067685    l2_loss: 0.019081    loss: 0.305991
steps 5600    v_Prec: 0.589100  v_Recall: 0.651519  v_F1: 0.618739  v_AUC: 0.875411
steps 5600    running time 200 seconds

steps 5800    base_loss: 0.221282    reg_loss: 0.067447    l2_loss: 0.019796    loss: 0.308525
steps 5800    v_Prec: 0.613314  v_Recall: 0.620039  v_F1: 0.616658  v_AUC: 0.874414
steps 5800    running time 205 seconds

steps 6000    base_loss: 0.226446    reg_loss: 0.067488    l2_loss: 0.020405    loss: 0.314339
steps 6000    v_Prec: 0.580663  v_Recall: 0.653412  v_F1: 0.614893  v_AUC: 0.871822
steps 6000    running time 211 seconds

steps 6200    base_loss: 0.231982    reg_loss: 0.067250    l2_loss: 0.020834    loss: 0.320066
steps 6200    v_Prec: 0.593141  v_Recall: 0.650888  v_F1: 0.620674  v_AUC: 0.876029
steps 6200    running time 217 seconds

steps 6400    base_loss: 0.217737    reg_loss: 0.067274    l2_loss: 0.021382    loss: 0.306392
steps 6400    v_Prec: 0.611158  v_Recall: 0.634398  v_F1: 0.622561  v_AUC: 0.878661
steps 6400    running time 223 seconds

steps 6600    base_loss: 0.223346    reg_loss: 0.067344    l2_loss: 0.021733    loss: 0.312423
steps 6600    v_Prec: 0.608847  v_Recall: 0.650493  v_F1: 0.628981  v_AUC: 0.881357
steps 6600    running time 229 seconds

steps 6800    base_loss: 0.226770    reg_loss: 0.067579    l2_loss: 0.022108    loss: 0.316457
steps 6800    v_Prec: 0.609881  v_Recall: 0.658383  v_F1: 0.633204  v_AUC: 0.884218
steps 6800    running time 235 seconds

steps 7000    base_loss: 0.233136    reg_loss: 0.067435    l2_loss: 0.022493    loss: 0.323064
steps 7000    v_Prec: 0.610217  v_Recall: 0.654990  v_F1: 0.631811  v_AUC: 0.882592
steps 7000    running time 241 seconds

steps 7200    base_loss: 0.225511    reg_loss: 0.067390    l2_loss: 0.022827    loss: 0.315727
steps 7200    v_Prec: 0.605604  v_Recall: 0.671874  v_F1: 0.637020  v_AUC: 0.885971
steps 7200    running time 246 seconds

steps 7400    base_loss: 0.230463    reg_loss: 0.067377    l2_loss: 0.023174    loss: 0.321014
steps 7400    v_Prec: 0.619721  v_Recall: 0.666903  v_F1: 0.642447  v_AUC: 0.887589
steps 7400    running time 252 seconds

steps 7600    base_loss: 0.224421    reg_loss: 0.067332    l2_loss: 0.023525    loss: 0.315278
steps 7600    v_Prec: 0.622815  v_Recall: 0.663353  v_F1: 0.642445  v_AUC: 0.887669
steps 7600    running time 258 seconds

steps 7800    base_loss: 0.225645    reg_loss: 0.067197    l2_loss: 0.023818    loss: 0.316660
steps 7800    v_Prec: 0.647262  v_Recall: 0.650020  v_F1: 0.648638  v_AUC: 0.889751
steps 7800    running time 264 seconds

steps 8000    base_loss: 0.222818    reg_loss: 0.067199    l2_loss: 0.024062    loss: 0.314079
steps 8000    v_Prec: 0.652250  v_Recall: 0.644892  v_F1: 0.648550  v_AUC: 0.889683
steps 8000    running time 270 seconds

steps 8200    base_loss: 0.221765    reg_loss: 0.067301    l2_loss: 0.024305    loss: 0.313371
steps 8200    v_Prec: 0.651586  v_Recall: 0.661302  v_F1: 0.656408  v_AUC: 0.894129
steps 8200    running time 275 seconds

steps 8400    base_loss: 0.233057    reg_loss: 0.067127    l2_loss: 0.024518    loss: 0.324702
steps 8400    v_Prec: 0.659712  v_Recall: 0.668560  v_F1: 0.664107  v_AUC: 0.897715
steps 8400    running time 281 seconds

steps 8600    base_loss: 0.225575    reg_loss: 0.067273    l2_loss: 0.024754    loss: 0.317602
steps 8600    v_Prec: 0.668312  v_Recall: 0.662091  v_F1: 0.665187  v_AUC: 0.897268
steps 8600    running time 287 seconds

steps 8800    base_loss: 0.230016    reg_loss: 0.066830    l2_loss: 0.025014    loss: 0.321860
steps 8800    v_Prec: 0.666719  v_Recall: 0.663826  v_F1: 0.665270  v_AUC: 0.898013
steps 8800    running time 293 seconds

steps 9000    base_loss: 0.228075    reg_loss: 0.066825    l2_loss: 0.025094    loss: 0.319994
steps 9000    v_Prec: 0.659970  v_Recall: 0.668718  v_F1: 0.664315  v_AUC: 0.900300
steps 9000    running time 299 seconds

steps 9200    base_loss: 0.222760    reg_loss: 0.066918    l2_loss: 0.025245    loss: 0.314923
steps 9200    v_Prec: 0.662179  v_Recall: 0.667456  v_F1: 0.664807  v_AUC: 0.900767
steps 9200    running time 304 seconds

steps 9400    base_loss: 0.223802    reg_loss: 0.066455    l2_loss: 0.025460    loss: 0.315717
steps 9400    v_Prec: 0.654873  v_Recall: 0.690730  v_F1: 0.672324  v_AUC: 0.904833
steps 9400    running time 310 seconds

steps 9600    base_loss: 0.221230    reg_loss: 0.066831    l2_loss: 0.025699    loss: 0.313761
steps 9600    v_Prec: 0.679713  v_Recall: 0.664536  v_F1: 0.672039  v_AUC: 0.903581
steps 9600    running time 316 seconds

steps 9800    base_loss: 0.220346    reg_loss: 0.066574    l2_loss: 0.025899    loss: 0.312819
steps 9800    v_Prec: 0.683159  v_Recall: 0.668876  v_F1: 0.675942  v_AUC: 0.906160
steps 9800    running time 322 seconds

steps 10000    base_loss: 0.217727    reg_loss: 0.066402    l2_loss: 0.026017    loss: 0.310146
steps 10000    v_Prec: 0.674885  v_Recall: 0.680316  v_F1: 0.677589  v_AUC: 0.907702
steps 10000    running time 328 seconds

steps 10200    base_loss: 0.218820    reg_loss: 0.066654    l2_loss: 0.026153    loss: 0.311628
steps 10200    v_Prec: 0.687721  v_Recall: 0.676055  v_F1: 0.681838  v_AUC: 0.908589
steps 10200    running time 334 seconds

steps 10400    base_loss: 0.216459    reg_loss: 0.065913    l2_loss: 0.026408    loss: 0.308780
steps 10400    v_Prec: 0.703954  v_Recall: 0.672742  v_F1: 0.687994  v_AUC: 0.910857
steps 10400    running time 339 seconds

steps 10600    base_loss: 0.221941    reg_loss: 0.066182    l2_loss: 0.026563    loss: 0.314685
steps 10600    v_Prec: 0.694946  v_Recall: 0.685680  v_F1: 0.690282  v_AUC: 0.912137
steps 10600    running time 345 seconds

steps 10800    base_loss: 0.206312    reg_loss: 0.066448    l2_loss: 0.026739    loss: 0.299500
steps 10800    v_Prec: 0.686438  v_Recall: 0.682051  v_F1: 0.684238  v_AUC: 0.907508
steps 10800    running time 351 seconds

steps 11000    base_loss: 0.118823    reg_loss: 0.066686    l2_loss: 0.026909    loss: 0.212418
steps 11000    v_Prec: 0.647046  v_Recall: 0.680789  v_F1: 0.663489  v_AUC: 0.899582
steps 11000    running time 357 seconds

steps 11200    base_loss: 0.117445    reg_loss: 0.066177    l2_loss: 0.027190    loss: 0.210811
steps 11200    v_Prec: 0.644851  v_Recall: 0.661538  v_F1: 0.653088  v_AUC: 0.893527
steps 11200    running time 362 seconds

steps 11400    base_loss: 0.123107    reg_loss: 0.065999    l2_loss: 0.027264    loss: 0.216370
steps 11400    v_Prec: 0.641475  v_Recall: 0.658935  v_F1: 0.650088  v_AUC: 0.891794
steps 11400    running time 368 seconds

steps 11600    base_loss: 0.122811    reg_loss: 0.066101    l2_loss: 0.027326    loss: 0.216237
steps 11600    v_Prec: 0.642735  v_Recall: 0.650493  v_F1: 0.646591  v_AUC: 0.891256
steps 11600    running time 374 seconds

steps 11800    base_loss: 0.127934    reg_loss: 0.066279    l2_loss: 0.027453    loss: 0.221666
steps 11800    v_Prec: 0.627642  v_Recall: 0.674635  v_F1: 0.650291  v_AUC: 0.893614
steps 11800    running time 380 seconds

steps 12000    base_loss: 0.129230    reg_loss: 0.066157    l2_loss: 0.027525    loss: 0.222912
steps 12000    v_Prec: 0.602810  v_Recall: 0.687179  v_F1: 0.642236  v_AUC: 0.889097
steps 12000    running time 385 seconds

steps 12200    base_loss: 0.130638    reg_loss: 0.066066    l2_loss: 0.027637    loss: 0.224341
steps 12200    v_Prec: 0.607230  v_Recall: 0.670611  v_F1: 0.637349  v_AUC: 0.887658
steps 12200    running time 391 seconds

steps 12400    base_loss: 0.125283    reg_loss: 0.065760    l2_loss: 0.027783    loss: 0.218827
steps 12400    v_Prec: 0.617906  v_Recall: 0.675187  v_F1: 0.645278  v_AUC: 0.890037
steps 12400    running time 397 seconds

steps 12600    base_loss: 0.129830    reg_loss: 0.065755    l2_loss: 0.027882    loss: 0.223467
steps 12600    v_Prec: 0.623912  v_Recall: 0.644734  v_F1: 0.634152  v_AUC: 0.884901
steps 12600    running time 402 seconds

Early stop model F1: 0.690282
testing thre: 0.40011692
testing Prec: 0.5119463560967001
testing Recall: 0.7050303766707169
testing F1: 0.5931711306481292
testing AUC: 0.876392853726963
overall running time 405 seconds
(0.6061757719714964, 0.6201701093560146, 0.6130930930930931, 0.876392853726963, 0.5703096)

2019-02-24 14:56:19.276480: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 14:56:19.938230: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 14:56:19.939386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 14:56:19.939422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.920000 seconds
loading data in 29.950000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.870614    reg_loss: 0.064671    l2_loss: 0.013415    loss: 0.948699
steps 200    v_Prec: 0.164026  v_Recall: 0.999920  v_F1: 0.281822  v_AUC: 0.480925
steps 200    running time 39 seconds

steps 400    base_loss: 0.538332    reg_loss: 0.064891    l2_loss: 0.013402    loss: 0.616625
steps 400    v_Prec: 0.164078  v_Recall: 0.999284  v_F1: 0.281873  v_AUC: 0.494055
steps 400    running time 45 seconds

steps 600    base_loss: 0.476930    reg_loss: 0.065038    l2_loss: 0.013252    loss: 0.555220
steps 600    v_Prec: 0.164586  v_Recall: 0.982971  v_F1: 0.281961  v_AUC: 0.518829
steps 600    running time 51 seconds

steps 800    base_loss: 0.460751    reg_loss: 0.064739    l2_loss: 0.013047    loss: 0.538537
steps 800    v_Prec: 0.176476  v_Recall: 0.790006  v_F1: 0.288504  v_AUC: 0.561648
steps 800    running time 57 seconds

steps 1000    base_loss: 0.454346    reg_loss: 0.064659    l2_loss: 0.012819    loss: 0.531824
steps 1000    v_Prec: 0.221193  v_Recall: 0.579534  v_F1: 0.320181  v_AUC: 0.627423
steps 1000    running time 63 seconds

steps 1200    base_loss: 0.439120    reg_loss: 0.064810    l2_loss: 0.012662    loss: 0.516592
steps 1200    v_Prec: 0.275281  v_Recall: 0.559083  v_F1: 0.368916  v_AUC: 0.691853
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.422049    reg_loss: 0.064918    l2_loss: 0.012552    loss: 0.499519
steps 1400    v_Prec: 0.354134  v_Recall: 0.483648  v_F1: 0.408880  v_AUC: 0.732761
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.398031    reg_loss: 0.065346    l2_loss: 0.012616    loss: 0.475993
steps 1600    v_Prec: 0.419981  v_Recall: 0.504098  v_F1: 0.458211  v_AUC: 0.768362
steps 1600    running time 81 seconds

steps 1800    base_loss: 0.378679    reg_loss: 0.065513    l2_loss: 0.012695    loss: 0.456888
steps 1800    v_Prec: 0.456971  v_Recall: 0.526060  v_F1: 0.489088  v_AUC: 0.793266
steps 1800    running time 86 seconds

steps 2000    base_loss: 0.367257    reg_loss: 0.065883    l2_loss: 0.012787    loss: 0.445926
steps 2000    v_Prec: 0.507271  v_Recall: 0.530198  v_F1: 0.518481  v_AUC: 0.809956
steps 2000    running time 92 seconds

steps 2200    base_loss: 0.345532    reg_loss: 0.066144    l2_loss: 0.012966    loss: 0.424642
steps 2200    v_Prec: 0.546200  v_Recall: 0.551285  v_F1: 0.548731  v_AUC: 0.827958
steps 2200    running time 98 seconds

steps 2400    base_loss: 0.334578    reg_loss: 0.066256    l2_loss: 0.013096    loss: 0.413930
steps 2400    v_Prec: 0.550954  v_Recall: 0.579056  v_F1: 0.564656  v_AUC: 0.839734
steps 2400    running time 104 seconds

steps 2600    base_loss: 0.329691    reg_loss: 0.066219    l2_loss: 0.013282    loss: 0.409191
steps 2600    v_Prec: 0.603505  v_Recall: 0.559083  v_F1: 0.580445  v_AUC: 0.848315
steps 2600    running time 110 seconds

steps 2800    base_loss: 0.319647    reg_loss: 0.066526    l2_loss: 0.013505    loss: 0.399678
steps 2800    v_Prec: 0.600535  v_Recall: 0.589162  v_F1: 0.594794  v_AUC: 0.857709
steps 2800    running time 116 seconds

steps 3000    base_loss: 0.316187    reg_loss: 0.066687    l2_loss: 0.013726    loss: 0.396600
steps 3000    v_Prec: 0.587719  v_Recall: 0.613114  v_F1: 0.600148  v_AUC: 0.861562
steps 3000    running time 122 seconds

steps 3200    base_loss: 0.311793    reg_loss: 0.066656    l2_loss: 0.014017    loss: 0.392467
steps 3200    v_Prec: 0.626422  v_Recall: 0.595767  v_F1: 0.610710  v_AUC: 0.867441
steps 3200    running time 127 seconds

steps 3400    base_loss: 0.299284    reg_loss: 0.066605    l2_loss: 0.014311    loss: 0.380200
steps 3400    v_Prec: 0.600909  v_Recall: 0.631177  v_F1: 0.615671  v_AUC: 0.871484
steps 3400    running time 133 seconds

steps 3600    base_loss: 0.301158    reg_loss: 0.066424    l2_loss: 0.014625    loss: 0.382207
steps 3600    v_Prec: 0.634469  v_Recall: 0.603167  v_F1: 0.618422  v_AUC: 0.874387
steps 3600    running time 139 seconds

steps 3800    base_loss: 0.294840    reg_loss: 0.066257    l2_loss: 0.014978    loss: 0.376075
steps 3800    v_Prec: 0.621887  v_Recall: 0.629904  v_F1: 0.625870  v_AUC: 0.878249
steps 3800    running time 145 seconds

steps 4000    base_loss: 0.292333    reg_loss: 0.066659    l2_loss: 0.015349    loss: 0.374341
steps 4000    v_Prec: 0.643618  v_Recall: 0.619957  v_F1: 0.631566  v_AUC: 0.879595
steps 4000    running time 151 seconds

steps 4200    base_loss: 0.291189    reg_loss: 0.066537    l2_loss: 0.015755    loss: 0.373481
steps 4200    v_Prec: 0.628982  v_Recall: 0.629983  v_F1: 0.629482  v_AUC: 0.881068
steps 4200    running time 157 seconds

steps 4400    base_loss: 0.295197    reg_loss: 0.066616    l2_loss: 0.016280    loss: 0.378093
steps 4400    v_Prec: 0.633538  v_Recall: 0.631018  v_F1: 0.632276  v_AUC: 0.882602
steps 4400    running time 163 seconds

steps 4600    base_loss: 0.288046    reg_loss: 0.066194    l2_loss: 0.016658    loss: 0.370898
steps 4600    v_Prec: 0.614344  v_Recall: 0.654333  v_F1: 0.633708  v_AUC: 0.883596
steps 4600    running time 168 seconds

steps 4800    base_loss: 0.290906    reg_loss: 0.066221    l2_loss: 0.017138    loss: 0.374264
steps 4800    v_Prec: 0.628261  v_Recall: 0.657357  v_F1: 0.642479  v_AUC: 0.887154
steps 4800    running time 174 seconds

steps 5000    base_loss: 0.291604    reg_loss: 0.066315    l2_loss: 0.017631    loss: 0.375549
steps 5000    v_Prec: 0.633331  v_Recall: 0.657118  v_F1: 0.645005  v_AUC: 0.890029
steps 5000    running time 180 seconds

steps 5200    base_loss: 0.287137    reg_loss: 0.066171    l2_loss: 0.018228    loss: 0.371537
steps 5200    v_Prec: 0.659313  v_Recall: 0.632609  v_F1: 0.645685  v_AUC: 0.889468
steps 5200    running time 186 seconds

steps 5400    base_loss: 0.276705    reg_loss: 0.066089    l2_loss: 0.018749    loss: 0.361542
steps 5400    v_Prec: 0.656528  v_Recall: 0.640646  v_F1: 0.648490  v_AUC: 0.890877
steps 5400    running time 192 seconds

steps 5600    base_loss: 0.210207    reg_loss: 0.066582    l2_loss: 0.019483    loss: 0.296272
steps 5600    v_Prec: 0.627366  v_Recall: 0.654174  v_F1: 0.640489  v_AUC: 0.887324
steps 5600    running time 197 seconds

steps 5800    base_loss: 0.202877    reg_loss: 0.066751    l2_loss: 0.020246    loss: 0.289874
steps 5800    v_Prec: 0.620888  v_Recall: 0.662290  v_F1: 0.640921  v_AUC: 0.884790
steps 5800    running time 203 seconds

steps 6000    base_loss: 0.207336    reg_loss: 0.066667    l2_loss: 0.020835    loss: 0.294837
steps 6000    v_Prec: 0.627302  v_Recall: 0.661494  v_F1: 0.643944  v_AUC: 0.886027
steps 6000    running time 209 seconds

steps 6200    base_loss: 0.215926    reg_loss: 0.066658    l2_loss: 0.021207    loss: 0.303791
steps 6200    v_Prec: 0.648247  v_Recall: 0.635713  v_F1: 0.641919  v_AUC: 0.885475
steps 6200    running time 214 seconds

steps 6400    base_loss: 0.228613    reg_loss: 0.066998    l2_loss: 0.021630    loss: 0.317241
steps 6400    v_Prec: 0.636748  v_Recall: 0.659346  v_F1: 0.647850  v_AUC: 0.888996
steps 6400    running time 220 seconds

steps 6600    base_loss: 0.223822    reg_loss: 0.066893    l2_loss: 0.022094    loss: 0.312809
steps 6600    v_Prec: 0.656873  v_Recall: 0.642238  v_F1: 0.649473  v_AUC: 0.891721
steps 6600    running time 226 seconds

steps 6800    base_loss: 0.221057    reg_loss: 0.066491    l2_loss: 0.022450    loss: 0.309998
steps 6800    v_Prec: 0.654387  v_Recall: 0.644545  v_F1: 0.649429  v_AUC: 0.891833
steps 6800    running time 231 seconds

steps 7000    base_loss: 0.216877    reg_loss: 0.066950    l2_loss: 0.022894    loss: 0.306722
steps 7000    v_Prec: 0.637397  v_Recall: 0.655606  v_F1: 0.646374  v_AUC: 0.890083
steps 7000    running time 237 seconds

steps 7200    base_loss: 0.220820    reg_loss: 0.066564    l2_loss: 0.023219    loss: 0.310602
steps 7200    v_Prec: 0.660621  v_Recall: 0.655049  v_F1: 0.657823  v_AUC: 0.896920
steps 7200    running time 243 seconds

steps 7400    base_loss: 0.206057    reg_loss: 0.066899    l2_loss: 0.023592    loss: 0.296548
steps 7400    v_Prec: 0.651582  v_Recall: 0.655367  v_F1: 0.653469  v_AUC: 0.895288
steps 7400    running time 249 seconds

steps 7600    base_loss: 0.213525    reg_loss: 0.066556    l2_loss: 0.023893    loss: 0.303974
steps 7600    v_Prec: 0.652023  v_Recall: 0.657834  v_F1: 0.654916  v_AUC: 0.895908
steps 7600    running time 254 seconds

steps 7800    base_loss: 0.216178    reg_loss: 0.066611    l2_loss: 0.024258    loss: 0.307048
steps 7800    v_Prec: 0.670656  v_Recall: 0.651070  v_F1: 0.660718  v_AUC: 0.897575
steps 7800    running time 260 seconds

steps 8000    base_loss: 0.220258    reg_loss: 0.066479    l2_loss: 0.024569    loss: 0.311306
steps 8000    v_Prec: 0.685538  v_Recall: 0.637861  v_F1: 0.660841  v_AUC: 0.898136
steps 8000    running time 266 seconds

steps 8200    base_loss: 0.213886    reg_loss: 0.066343    l2_loss: 0.024703    loss: 0.304932
steps 8200    v_Prec: 0.675989  v_Recall: 0.659744  v_F1: 0.667767  v_AUC: 0.899126
steps 8200    running time 272 seconds

steps 8400    base_loss: 0.218791    reg_loss: 0.066406    l2_loss: 0.025003    loss: 0.310201
steps 8400    v_Prec: 0.664709  v_Recall: 0.675340  v_F1: 0.669982  v_AUC: 0.901485
steps 8400    running time 278 seconds

steps 8600    base_loss: 0.212019    reg_loss: 0.066436    l2_loss: 0.025230    loss: 0.303685
steps 8600    v_Prec: 0.668087  v_Recall: 0.673510  v_F1: 0.670788  v_AUC: 0.901317
steps 8600    running time 283 seconds

steps 8800    base_loss: 0.218968    reg_loss: 0.066423    l2_loss: 0.025379    loss: 0.310770
steps 8800    v_Prec: 0.681190  v_Recall: 0.663086  v_F1: 0.672016  v_AUC: 0.903565
steps 8800    running time 289 seconds

steps 9000    base_loss: 0.217462    reg_loss: 0.066426    l2_loss: 0.025661    loss: 0.309549
steps 9000    v_Prec: 0.668589  v_Recall: 0.682581  v_F1: 0.675513  v_AUC: 0.903308
steps 9000    running time 295 seconds

steps 9200    base_loss: 0.218489    reg_loss: 0.066455    l2_loss: 0.025825    loss: 0.310769
steps 9200    v_Prec: 0.686458  v_Recall: 0.671600  v_F1: 0.678948  v_AUC: 0.904109
steps 9200    running time 301 seconds

steps 9400    base_loss: 0.209936    reg_loss: 0.066134    l2_loss: 0.026016    loss: 0.302086
steps 9400    v_Prec: 0.707786  v_Recall: 0.659744  v_F1: 0.682921  v_AUC: 0.908114
steps 9400    running time 307 seconds

steps 9600    base_loss: 0.217214    reg_loss: 0.066103    l2_loss: 0.026097    loss: 0.309413
steps 9600    v_Prec: 0.686763  v_Recall: 0.690698  v_F1: 0.688725  v_AUC: 0.912698
steps 9600    running time 313 seconds

steps 9800    base_loss: 0.218711    reg_loss: 0.065988    l2_loss: 0.026171    loss: 0.310871
steps 9800    v_Prec: 0.675119  v_Recall: 0.699133  v_F1: 0.686916  v_AUC: 0.911122
steps 9800    running time 319 seconds

steps 10000    base_loss: 0.215477    reg_loss: 0.065745    l2_loss: 0.026378    loss: 0.307601
steps 10000    v_Prec: 0.693339  v_Recall: 0.691573  v_F1: 0.692455  v_AUC: 0.912304
steps 10000    running time 324 seconds

steps 10200    base_loss: 0.212489    reg_loss: 0.065989    l2_loss: 0.026539    loss: 0.305017
steps 10200    v_Prec: 0.697553  v_Recall: 0.703270  v_F1: 0.700400  v_AUC: 0.916469
steps 10200    running time 330 seconds

steps 10400    base_loss: 0.211803    reg_loss: 0.065644    l2_loss: 0.026691    loss: 0.304138
steps 10400    v_Prec: 0.711172  v_Recall: 0.682820  v_F1: 0.696708  v_AUC: 0.916180
steps 10400    running time 336 seconds

steps 10600    base_loss: 0.211773    reg_loss: 0.065668    l2_loss: 0.026949    loss: 0.304389
steps 10600    v_Prec: 0.708581  v_Recall: 0.691891  v_F1: 0.700137  v_AUC: 0.917137
steps 10600    running time 341 seconds

steps 10800    base_loss: 0.205734    reg_loss: 0.065432    l2_loss: 0.026979    loss: 0.298145
steps 10800    v_Prec: 0.707557  v_Recall: 0.686162  v_F1: 0.696695  v_AUC: 0.915521
steps 10800    running time 347 seconds

steps 11000    base_loss: 0.116502    reg_loss: 0.065258    l2_loss: 0.027280    loss: 0.209041
steps 11000    v_Prec: 0.690699  v_Recall: 0.670088  v_F1: 0.680237  v_AUC: 0.905793
steps 11000    running time 353 seconds

steps 11200    base_loss: 0.120551    reg_loss: 0.065476    l2_loss: 0.027508    loss: 0.213535
steps 11200    v_Prec: 0.676590  v_Recall: 0.661892  v_F1: 0.669161  v_AUC: 0.897716
steps 11200    running time 358 seconds

steps 11400    base_loss: 0.111981    reg_loss: 0.065032    l2_loss: 0.027625    loss: 0.204638
steps 11400    v_Prec: 0.641531  v_Recall: 0.679001  v_F1: 0.659734  v_AUC: 0.895525
steps 11400    running time 364 seconds

steps 11600    base_loss: 0.118574    reg_loss: 0.065065    l2_loss: 0.027742    loss: 0.211381
steps 11600    v_Prec: 0.648267  v_Recall: 0.680353  v_F1: 0.663923  v_AUC: 0.897270
steps 11600    running time 370 seconds

steps 11800    base_loss: 0.121968    reg_loss: 0.065316    l2_loss: 0.027805    loss: 0.215088
steps 11800    v_Prec: 0.627653  v_Recall: 0.691732  v_F1: 0.658137  v_AUC: 0.894301
steps 11800    running time 375 seconds

steps 12000    base_loss: 0.118644    reg_loss: 0.065235    l2_loss: 0.028096    loss: 0.211974
steps 12000    v_Prec: 0.668805  v_Recall: 0.655288  v_F1: 0.661977  v_AUC: 0.896258
steps 12000    running time 381 seconds

steps 12200    base_loss: 0.124455    reg_loss: 0.065097    l2_loss: 0.028109    loss: 0.217660
steps 12200    v_Prec: 0.639910  v_Recall: 0.681308  v_F1: 0.659961  v_AUC: 0.896325
steps 12200    running time 387 seconds

Early stop model F1: 0.700400
testing thre: 0.3450447
testing Prec: 0.5031982942430704
testing Recall: 0.7226245443499393
testing F1: 0.5932724153066518
testing AUC: 0.878570316434887
overall running time 389 seconds
(0.6513683313811096, 0.5946051032806804, 0.6216937266559951, 0.878570316434887, 0.61392283)

2019-02-24 15:00:12.034910: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:00:12.854653: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:00:12.856418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:00:12.856460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.290000 seconds
loading data in 31.470000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.664092    reg_loss: 0.065613    l2_loss: 0.013338    loss: 0.743043
steps 200    v_Prec: 0.163161  v_Recall: 1.000000  v_F1: 0.280547  v_AUC: 0.488261
steps 200    running time 41 seconds

steps 400    base_loss: 0.526923    reg_loss: 0.065521    l2_loss: 0.013352    loss: 0.605796
steps 400    v_Prec: 0.163155  v_Recall: 1.000000  v_F1: 0.280538  v_AUC: 0.497191
steps 400    running time 47 seconds

steps 600    base_loss: 0.484590    reg_loss: 0.065413    l2_loss: 0.013142    loss: 0.563144
steps 600    v_Prec: 0.163981  v_Recall: 0.978967  v_F1: 0.280908  v_AUC: 0.520028
steps 600    running time 52 seconds

steps 800    base_loss: 0.463148    reg_loss: 0.065409    l2_loss: 0.012944    loss: 0.541501
steps 800    v_Prec: 0.168547  v_Recall: 0.856686  v_F1: 0.281676  v_AUC: 0.544814
steps 800    running time 58 seconds

steps 1000    base_loss: 0.451124    reg_loss: 0.065144    l2_loss: 0.012769    loss: 0.529037
steps 1000    v_Prec: 0.204241  v_Recall: 0.592370  v_F1: 0.303752  v_AUC: 0.604172
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.440177    reg_loss: 0.064893    l2_loss: 0.012657    loss: 0.517727
steps 1200    v_Prec: 0.278570  v_Recall: 0.479367  v_F1: 0.352371  v_AUC: 0.671155
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.420221    reg_loss: 0.065021    l2_loss: 0.012605    loss: 0.497847
steps 1400    v_Prec: 0.348072  v_Recall: 0.477847  v_F1: 0.402764  v_AUC: 0.725545
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.402252    reg_loss: 0.065377    l2_loss: 0.012606    loss: 0.480235
steps 1600    v_Prec: 0.419842  v_Recall: 0.489044  v_F1: 0.451808  v_AUC: 0.765828
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.383178    reg_loss: 0.065783    l2_loss: 0.012645    loss: 0.461606
steps 1800    v_Prec: 0.473084  v_Recall: 0.524312  v_F1: 0.497383  v_AUC: 0.795100
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.362427    reg_loss: 0.065795    l2_loss: 0.012750    loss: 0.440972
steps 2000    v_Prec: 0.502963  v_Recall: 0.549824  v_F1: 0.525351  v_AUC: 0.816089
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.354143    reg_loss: 0.066256    l2_loss: 0.012884    loss: 0.433283
steps 2200    v_Prec: 0.585018  v_Recall: 0.534629  v_F1: 0.558690  v_AUC: 0.831492
steps 2200    running time 100 seconds

steps 2400    base_loss: 0.337649    reg_loss: 0.066298    l2_loss: 0.013001    loss: 0.416948
steps 2400    v_Prec: 0.577264  v_Recall: 0.573017  v_F1: 0.575132  v_AUC: 0.843525
steps 2400    running time 105 seconds

steps 2600    base_loss: 0.325138    reg_loss: 0.066309    l2_loss: 0.013183    loss: 0.404630
steps 2600    v_Prec: 0.578076  v_Recall: 0.592131  v_F1: 0.585019  v_AUC: 0.852633
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.324100    reg_loss: 0.066401    l2_loss: 0.013390    loss: 0.403891
steps 2800    v_Prec: 0.601365  v_Recall: 0.592131  v_F1: 0.596712  v_AUC: 0.858741
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.316126    reg_loss: 0.066361    l2_loss: 0.013632    loss: 0.396119
steps 3000    v_Prec: 0.627010  v_Recall: 0.577015  v_F1: 0.600975  v_AUC: 0.864088
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.310256    reg_loss: 0.066271    l2_loss: 0.013904    loss: 0.390431
steps 3200    v_Prec: 0.595453  v_Recall: 0.617882  v_F1: 0.606460  v_AUC: 0.869592
steps 3200    running time 129 seconds

steps 3400    base_loss: 0.310075    reg_loss: 0.066392    l2_loss: 0.014228    loss: 0.390695
steps 3400    v_Prec: 0.614151  v_Recall: 0.624760  v_F1: 0.619410  v_AUC: 0.872625
steps 3400    running time 135 seconds

steps 3600    base_loss: 0.302308    reg_loss: 0.066410    l2_loss: 0.014481    loss: 0.383198
steps 3600    v_Prec: 0.607546  v_Recall: 0.632278  v_F1: 0.619665  v_AUC: 0.875130
steps 3600    running time 141 seconds

steps 3800    base_loss: 0.295298    reg_loss: 0.066254    l2_loss: 0.014891    loss: 0.376442
steps 3800    v_Prec: 0.619354  v_Recall: 0.630598  v_F1: 0.624926  v_AUC: 0.876825
steps 3800    running time 147 seconds

steps 4000    base_loss: 0.302366    reg_loss: 0.066251    l2_loss: 0.015256    loss: 0.383873
steps 4000    v_Prec: 0.625672  v_Recall: 0.632678  v_F1: 0.629155  v_AUC: 0.882724
steps 4000    running time 152 seconds

steps 4200    base_loss: 0.301863    reg_loss: 0.066241    l2_loss: 0.015599    loss: 0.383702
steps 4200    v_Prec: 0.612940  v_Recall: 0.650832  v_F1: 0.631318  v_AUC: 0.884848
steps 4200    running time 158 seconds

steps 4400    base_loss: 0.291477    reg_loss: 0.066065    l2_loss: 0.016011    loss: 0.373553
steps 4400    v_Prec: 0.633520  v_Recall: 0.641475  v_F1: 0.637473  v_AUC: 0.887822
steps 4400    running time 164 seconds

steps 4600    base_loss: 0.291144    reg_loss: 0.066041    l2_loss: 0.016531    loss: 0.373716
steps 4600    v_Prec: 0.641352  v_Recall: 0.640275  v_F1: 0.640813  v_AUC: 0.887292
steps 4600    running time 170 seconds

steps 4800    base_loss: 0.285753    reg_loss: 0.065987    l2_loss: 0.017088    loss: 0.368828
steps 4800    v_Prec: 0.641987  v_Recall: 0.636596  v_F1: 0.639280  v_AUC: 0.888753
steps 4800    running time 176 seconds

steps 5000    base_loss: 0.284745    reg_loss: 0.065816    l2_loss: 0.017503    loss: 0.368064
steps 5000    v_Prec: 0.614399  v_Recall: 0.679063  v_F1: 0.645115  v_AUC: 0.892074
steps 5000    running time 182 seconds

steps 5200    base_loss: 0.285897    reg_loss: 0.065994    l2_loss: 0.018025    loss: 0.369916
steps 5200    v_Prec: 0.637209  v_Recall: 0.657390  v_F1: 0.647142  v_AUC: 0.892126
steps 5200    running time 188 seconds

steps 5400    base_loss: 0.283890    reg_loss: 0.066040    l2_loss: 0.018712    loss: 0.368642
steps 5400    v_Prec: 0.671672  v_Recall: 0.633157  v_F1: 0.651846  v_AUC: 0.893279
steps 5400    running time 193 seconds

steps 5600    base_loss: 0.213109    reg_loss: 0.066696    l2_loss: 0.019381    loss: 0.299186
steps 5600    v_Prec: 0.613896  v_Recall: 0.649392  v_F1: 0.631145  v_AUC: 0.883010
steps 5600    running time 199 seconds

steps 5800    base_loss: 0.218947    reg_loss: 0.066566    l2_loss: 0.020063    loss: 0.305575
steps 5800    v_Prec: 0.635410  v_Recall: 0.639475  v_F1: 0.637436  v_AUC: 0.886511
steps 5800    running time 205 seconds

steps 6000    base_loss: 0.220522    reg_loss: 0.066640    l2_loss: 0.020540    loss: 0.307701
steps 6000    v_Prec: 0.646135  v_Recall: 0.631718  v_F1: 0.638845  v_AUC: 0.887537
steps 6000    running time 210 seconds

steps 6200    base_loss: 0.217443    reg_loss: 0.067046    l2_loss: 0.021116    loss: 0.305606
steps 6200    v_Prec: 0.641799  v_Recall: 0.641235  v_F1: 0.641517  v_AUC: 0.889143
steps 6200    running time 216 seconds

steps 6400    base_loss: 0.222606    reg_loss: 0.066615    l2_loss: 0.021547    loss: 0.310768
steps 6400    v_Prec: 0.635624  v_Recall: 0.650112  v_F1: 0.642787  v_AUC: 0.889243
steps 6400    running time 222 seconds

steps 6600    base_loss: 0.231055    reg_loss: 0.066905    l2_loss: 0.021970    loss: 0.319929
steps 6600    v_Prec: 0.649610  v_Recall: 0.639635  v_F1: 0.644584  v_AUC: 0.890791
steps 6600    running time 228 seconds

steps 6800    base_loss: 0.221052    reg_loss: 0.066828    l2_loss: 0.022348    loss: 0.310228
steps 6800    v_Prec: 0.637113  v_Recall: 0.648832  v_F1: 0.642919  v_AUC: 0.889855
steps 6800    running time 233 seconds

steps 7000    base_loss: 0.222567    reg_loss: 0.066464    l2_loss: 0.022687    loss: 0.311718
steps 7000    v_Prec: 0.667426  v_Recall: 0.632358  v_F1: 0.649419  v_AUC: 0.892731
steps 7000    running time 239 seconds

steps 7200    base_loss: 0.212403    reg_loss: 0.066556    l2_loss: 0.023042    loss: 0.302001
steps 7200    v_Prec: 0.645433  v_Recall: 0.666907  v_F1: 0.655994  v_AUC: 0.895491
steps 7200    running time 244 seconds

steps 7400    base_loss: 0.213973    reg_loss: 0.066397    l2_loss: 0.023385    loss: 0.303755
steps 7400    v_Prec: 0.659036  v_Recall: 0.651552  v_F1: 0.655272  v_AUC: 0.897714
steps 7400    running time 250 seconds

steps 7600    base_loss: 0.215451    reg_loss: 0.066434    l2_loss: 0.023635    loss: 0.305520
steps 7600    v_Prec: 0.636791  v_Recall: 0.672185  v_F1: 0.654009  v_AUC: 0.896030
steps 7600    running time 256 seconds

steps 7800    base_loss: 0.209501    reg_loss: 0.066687    l2_loss: 0.023947    loss: 0.300135
steps 7800    v_Prec: 0.670793  v_Recall: 0.654431  v_F1: 0.662511  v_AUC: 0.899869
steps 7800    running time 262 seconds

steps 8000    base_loss: 0.221464    reg_loss: 0.066754    l2_loss: 0.024215    loss: 0.312432
steps 8000    v_Prec: 0.666105  v_Recall: 0.663868  v_F1: 0.664984  v_AUC: 0.902367
steps 8000    running time 267 seconds

steps 8200    base_loss: 0.226107    reg_loss: 0.066577    l2_loss: 0.024511    loss: 0.317195
steps 8200    v_Prec: 0.678852  v_Recall: 0.650512  v_F1: 0.664380  v_AUC: 0.902537
steps 8200    running time 273 seconds

steps 8400    base_loss: 0.222106    reg_loss: 0.066404    l2_loss: 0.024826    loss: 0.313337
steps 8400    v_Prec: 0.673545  v_Recall: 0.665627  v_F1: 0.669563  v_AUC: 0.905719
steps 8400    running time 279 seconds

steps 8600    base_loss: 0.213754    reg_loss: 0.066695    l2_loss: 0.025030    loss: 0.305479
steps 8600    v_Prec: 0.673971  v_Recall: 0.671545  v_F1: 0.672756  v_AUC: 0.906337
steps 8600    running time 285 seconds

steps 8800    base_loss: 0.219985    reg_loss: 0.066672    l2_loss: 0.025265    loss: 0.311922
steps 8800    v_Prec: 0.683244  v_Recall: 0.669146  v_F1: 0.676121  v_AUC: 0.904918
steps 8800    running time 291 seconds

steps 9000    base_loss: 0.217349    reg_loss: 0.066389    l2_loss: 0.025447    loss: 0.309186
steps 9000    v_Prec: 0.680329  v_Recall: 0.680982  v_F1: 0.680655  v_AUC: 0.907765
steps 9000    running time 297 seconds

steps 9200    base_loss: 0.216795    reg_loss: 0.066566    l2_loss: 0.025732    loss: 0.309093
steps 9200    v_Prec: 0.683672  v_Recall: 0.689139  v_F1: 0.686395  v_AUC: 0.910350
steps 9200    running time 303 seconds

steps 9400    base_loss: 0.214548    reg_loss: 0.066514    l2_loss: 0.025828    loss: 0.306890
steps 9400    v_Prec: 0.699061  v_Recall: 0.672505  v_F1: 0.685526  v_AUC: 0.908927
steps 9400    running time 308 seconds

steps 9600    base_loss: 0.209576    reg_loss: 0.066061    l2_loss: 0.026058    loss: 0.301695
steps 9600    v_Prec: 0.697144  v_Recall: 0.687220  v_F1: 0.692147  v_AUC: 0.913722
steps 9600    running time 314 seconds

steps 9800    base_loss: 0.204928    reg_loss: 0.066048    l2_loss: 0.026277    loss: 0.297253
steps 9800    v_Prec: 0.723108  v_Recall: 0.656430  v_F1: 0.688158  v_AUC: 0.910454
steps 9800    running time 320 seconds

steps 10000    base_loss: 0.226219    reg_loss: 0.066248    l2_loss: 0.026291    loss: 0.318758
steps 10000    v_Prec: 0.697994  v_Recall: 0.690179  v_F1: 0.694065  v_AUC: 0.914527
steps 10000    running time 325 seconds

steps 10200    base_loss: 0.217826    reg_loss: 0.066157    l2_loss: 0.026513    loss: 0.310496
steps 10200    v_Prec: 0.705470  v_Recall: 0.692099  v_F1: 0.698720  v_AUC: 0.917112
steps 10200    running time 332 seconds

steps 10400    base_loss: 0.208265    reg_loss: 0.065757    l2_loss: 0.026652    loss: 0.300674
steps 10400    v_Prec: 0.722515  v_Recall: 0.680102  v_F1: 0.700667  v_AUC: 0.917325
steps 10400    running time 337 seconds

steps 10600    base_loss: 0.209076    reg_loss: 0.065672    l2_loss: 0.026768    loss: 0.301516
steps 10600    v_Prec: 0.706123  v_Recall: 0.690819  v_F1: 0.698387  v_AUC: 0.917610
steps 10600    running time 343 seconds

steps 10800    base_loss: 0.200013    reg_loss: 0.065414    l2_loss: 0.026928    loss: 0.292355
steps 10800    v_Prec: 0.712928  v_Recall: 0.684021  v_F1: 0.698176  v_AUC: 0.916785
steps 10800    running time 349 seconds

steps 11000    base_loss: 0.114712    reg_loss: 0.065415    l2_loss: 0.027136    loss: 0.207263
steps 11000    v_Prec: 0.684832  v_Recall: 0.668346  v_F1: 0.676488  v_AUC: 0.906987
steps 11000    running time 354 seconds

steps 11200    base_loss: 0.113492    reg_loss: 0.065339    l2_loss: 0.027309    loss: 0.206140
steps 11200    v_Prec: 0.650144  v_Recall: 0.688100  v_F1: 0.668583  v_AUC: 0.901330
steps 11200    running time 360 seconds

steps 11400    base_loss: 0.120869    reg_loss: 0.065388    l2_loss: 0.027530    loss: 0.213787
steps 11400    v_Prec: 0.635545  v_Recall: 0.699536  v_F1: 0.666007  v_AUC: 0.903087
steps 11400    running time 365 seconds

steps 11600    base_loss: 0.116277    reg_loss: 0.065546    l2_loss: 0.027721    loss: 0.209544
steps 11600    v_Prec: 0.668858  v_Recall: 0.659229  v_F1: 0.664008  v_AUC: 0.901318
steps 11600    running time 371 seconds

steps 11800    base_loss: 0.115527    reg_loss: 0.065128    l2_loss: 0.027760    loss: 0.208415
steps 11800    v_Prec: 0.668948  v_Recall: 0.656750  v_F1: 0.662793  v_AUC: 0.899815
steps 11800    running time 377 seconds

steps 12000    base_loss: 0.122335    reg_loss: 0.065448    l2_loss: 0.027900    loss: 0.215683
steps 12000    v_Prec: 0.659816  v_Recall: 0.659869  v_F1: 0.659842  v_AUC: 0.896168
steps 12000    running time 382 seconds

steps 12200    base_loss: 0.124009    reg_loss: 0.064976    l2_loss: 0.027990    loss: 0.216975
steps 12200    v_Prec: 0.670777  v_Recall: 0.670026  v_F1: 0.670401  v_AUC: 0.902750
steps 12200    running time 388 seconds

steps 12400    base_loss: 0.120968    reg_loss: 0.065221    l2_loss: 0.028132    loss: 0.214320
steps 12400    v_Prec: 0.652278  v_Recall: 0.673145  v_F1: 0.662547  v_AUC: 0.898107
steps 12400    running time 394 seconds

Early stop model F1: 0.700667
testing thre: 0.4205952
testing Prec: 0.5310964118103544
testing Recall: 0.6985176184690158
testing F1: 0.6034091863296666
testing AUC: 0.8807647457202851
overall running time 396 seconds
(0.6404517774423567, 0.5980558930741191, 0.6185281994571227, 0.8807647457202851, 0.6210903)

2019-02-24 15:04:08.186210: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:04:09.172800: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:04:09.190064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:04:09.190147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.190000 seconds
loading data in 31.400000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.641075    reg_loss: 0.064557    l2_loss: 0.013307    loss: 0.718939
steps 200    v_Prec: 0.163582  v_Recall: 0.999920  v_F1: 0.281167  v_AUC: 0.520294
steps 200    running time 41 seconds

steps 400    base_loss: 0.503947    reg_loss: 0.064196    l2_loss: 0.013180    loss: 0.581322
steps 400    v_Prec: 0.165776  v_Recall: 0.947822  v_F1: 0.282195  v_AUC: 0.528117
steps 400    running time 47 seconds

steps 600    base_loss: 0.474972    reg_loss: 0.063877    l2_loss: 0.013016    loss: 0.551865
steps 600    v_Prec: 0.167374  v_Recall: 0.915829  v_F1: 0.283023  v_AUC: 0.532028
steps 600    running time 53 seconds

steps 800    base_loss: 0.455104    reg_loss: 0.063385    l2_loss: 0.012906    loss: 0.531395
steps 800    v_Prec: 0.172513  v_Recall: 0.833014  v_F1: 0.285832  v_AUC: 0.554689
steps 800    running time 58 seconds

steps 1000    base_loss: 0.448803    reg_loss: 0.062576    l2_loss: 0.012800    loss: 0.524179
steps 1000    v_Prec: 0.192881  v_Recall: 0.672650  v_F1: 0.299796  v_AUC: 0.592802
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.446282    reg_loss: 0.061696    l2_loss: 0.012724    loss: 0.520702
steps 1200    v_Prec: 0.252532  v_Recall: 0.497287  v_F1: 0.334963  v_AUC: 0.649159
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.435551    reg_loss: 0.060423    l2_loss: 0.012678    loss: 0.508652
steps 1400    v_Prec: 0.309504  v_Recall: 0.493936  v_F1: 0.380551  v_AUC: 0.702566
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.405650    reg_loss: 0.059198    l2_loss: 0.012697    loss: 0.477544
steps 1600    v_Prec: 0.385427  v_Recall: 0.489548  v_F1: 0.431293  v_AUC: 0.747731
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.385405    reg_loss: 0.057999    l2_loss: 0.012830    loss: 0.456234
steps 1800    v_Prec: 0.464457  v_Recall: 0.486357  v_F1: 0.475155  v_AUC: 0.776303
steps 1800    running time 89 seconds

steps 2000    base_loss: 0.370750    reg_loss: 0.057074    l2_loss: 0.013005    loss: 0.440829
steps 2000    v_Prec: 0.500468  v_Recall: 0.512047  v_F1: 0.506191  v_AUC: 0.795994
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.361524    reg_loss: 0.056454    l2_loss: 0.013201    loss: 0.431179
steps 2200    v_Prec: 0.567150  v_Recall: 0.518191  v_F1: 0.541566  v_AUC: 0.815772
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.341009    reg_loss: 0.055414    l2_loss: 0.013381    loss: 0.409804
steps 2400    v_Prec: 0.598130  v_Recall: 0.541008  v_F1: 0.568137  v_AUC: 0.831546
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.335050    reg_loss: 0.054675    l2_loss: 0.013570    loss: 0.403296
steps 2600    v_Prec: 0.626103  v_Recall: 0.554572  v_F1: 0.588171  v_AUC: 0.842617
steps 2600    running time 112 seconds

steps 2800    base_loss: 0.320452    reg_loss: 0.053947    l2_loss: 0.013731    loss: 0.388130
steps 2800    v_Prec: 0.657130  v_Recall: 0.562550  v_F1: 0.606173  v_AUC: 0.852495
steps 2800    running time 118 seconds

steps 3000    base_loss: 0.309733    reg_loss: 0.052952    l2_loss: 0.013960    loss: 0.376645
steps 3000    v_Prec: 0.643097  v_Recall: 0.595740  v_F1: 0.618513  v_AUC: 0.859059
steps 3000    running time 124 seconds

steps 3200    base_loss: 0.302830    reg_loss: 0.052646    l2_loss: 0.014143    loss: 0.369620
steps 3200    v_Prec: 0.640100  v_Recall: 0.615127  v_F1: 0.627365  v_AUC: 0.864728
steps 3200    running time 130 seconds

steps 3400    base_loss: 0.305974    reg_loss: 0.052445    l2_loss: 0.014376    loss: 0.372796
steps 3400    v_Prec: 0.664489  v_Recall: 0.608664  v_F1: 0.635353  v_AUC: 0.870882
steps 3400    running time 136 seconds

steps 3600    base_loss: 0.294038    reg_loss: 0.051502    l2_loss: 0.014602    loss: 0.360143
steps 3600    v_Prec: 0.672067  v_Recall: 0.625578  v_F1: 0.647990  v_AUC: 0.875452
steps 3600    running time 142 seconds

steps 3800    base_loss: 0.288384    reg_loss: 0.051226    l2_loss: 0.014843    loss: 0.354453
steps 3800    v_Prec: 0.712378  v_Recall: 0.600128  v_F1: 0.651453  v_AUC: 0.879061
steps 3800    running time 148 seconds

steps 4000    base_loss: 0.292861    reg_loss: 0.050962    l2_loss: 0.015009    loss: 0.358832
steps 4000    v_Prec: 0.698072  v_Recall: 0.618318  v_F1: 0.655779  v_AUC: 0.879985
steps 4000    running time 154 seconds

steps 4200    base_loss: 0.288935    reg_loss: 0.050761    l2_loss: 0.015249    loss: 0.354946
steps 4200    v_Prec: 0.701693  v_Recall: 0.628131  v_F1: 0.662878  v_AUC: 0.882268
steps 4200    running time 160 seconds

steps 4400    base_loss: 0.287460    reg_loss: 0.050916    l2_loss: 0.015566    loss: 0.353942
steps 4400    v_Prec: 0.686401  v_Recall: 0.653981  v_F1: 0.669799  v_AUC: 0.886379
steps 4400    running time 166 seconds

steps 4600    base_loss: 0.277726    reg_loss: 0.050666    l2_loss: 0.015853    loss: 0.344246
steps 4600    v_Prec: 0.694482  v_Recall: 0.650710  v_F1: 0.671884  v_AUC: 0.887248
steps 4600    running time 172 seconds

steps 4800    base_loss: 0.277488    reg_loss: 0.050602    l2_loss: 0.016207    loss: 0.344296
steps 4800    v_Prec: 0.711576  v_Recall: 0.646402  v_F1: 0.677425  v_AUC: 0.890067
steps 4800    running time 178 seconds

steps 5000    base_loss: 0.284146    reg_loss: 0.050257    l2_loss: 0.016467    loss: 0.350870
steps 5000    v_Prec: 0.706825  v_Recall: 0.651109  v_F1: 0.677824  v_AUC: 0.890499
steps 5000    running time 183 seconds

steps 5200    base_loss: 0.278670    reg_loss: 0.050099    l2_loss: 0.016815    loss: 0.345584
steps 5200    v_Prec: 0.712115  v_Recall: 0.654221  v_F1: 0.681941  v_AUC: 0.892609
steps 5200    running time 189 seconds

steps 5400    base_loss: 0.270347    reg_loss: 0.049801    l2_loss: 0.017291    loss: 0.337440
steps 5400    v_Prec: 0.696896  v_Recall: 0.666427  v_F1: 0.681321  v_AUC: 0.893167
steps 5400    running time 195 seconds

steps 5600    base_loss: 0.202437    reg_loss: 0.045783    l2_loss: 0.017879    loss: 0.266099
steps 5600    v_Prec: 0.697029  v_Recall: 0.658768  v_F1: 0.677358  v_AUC: 0.890675
steps 5600    running time 201 seconds

steps 5800    base_loss: 0.211142    reg_loss: 0.046076    l2_loss: 0.018624    loss: 0.275842
steps 5800    v_Prec: 0.716231  v_Recall: 0.637945  v_F1: 0.674825  v_AUC: 0.889767
steps 5800    running time 206 seconds

steps 6000    base_loss: 0.209838    reg_loss: 0.045557    l2_loss: 0.019230    loss: 0.274626
steps 6000    v_Prec: 0.711304  v_Recall: 0.647120  v_F1: 0.677696  v_AUC: 0.888280
steps 6000    running time 212 seconds

steps 6200    base_loss: 0.213665    reg_loss: 0.045427    l2_loss: 0.019656    loss: 0.278748
steps 6200    v_Prec: 0.714625  v_Recall: 0.648715  v_F1: 0.680077  v_AUC: 0.889292
steps 6200    running time 218 seconds

steps 6400    base_loss: 0.194463    reg_loss: 0.045256    l2_loss: 0.020058    loss: 0.259777
steps 6400    v_Prec: 0.712460  v_Recall: 0.645045  v_F1: 0.677079  v_AUC: 0.886039
steps 6400    running time 224 seconds

steps 6600    base_loss: 0.223217    reg_loss: 0.045742    l2_loss: 0.020310    loss: 0.289270
steps 6600    v_Prec: 0.715785  v_Recall: 0.647599  v_F1: 0.679987  v_AUC: 0.889131
steps 6600    running time 229 seconds

steps 6800    base_loss: 0.208626    reg_loss: 0.044872    l2_loss: 0.020801    loss: 0.274299
steps 6800    v_Prec: 0.715868  v_Recall: 0.649673  v_F1: 0.681166  v_AUC: 0.891699
steps 6800    running time 235 seconds

steps 7000    base_loss: 0.206284    reg_loss: 0.044610    l2_loss: 0.021183    loss: 0.272077
steps 7000    v_Prec: 0.709230  v_Recall: 0.665151  v_F1: 0.686484  v_AUC: 0.894651
steps 7000    running time 241 seconds

steps 7200    base_loss: 0.214223    reg_loss: 0.044276    l2_loss: 0.021408    loss: 0.279906
steps 7200    v_Prec: 0.707537  v_Recall: 0.664353  v_F1: 0.685265  v_AUC: 0.893845
steps 7200    running time 246 seconds

steps 7400    base_loss: 0.228128    reg_loss: 0.044554    l2_loss: 0.021632    loss: 0.294314
steps 7400    v_Prec: 0.738365  v_Recall: 0.645524  v_F1: 0.688830  v_AUC: 0.894968
steps 7400    running time 252 seconds

steps 7600    base_loss: 0.218781    reg_loss: 0.044266    l2_loss: 0.021868    loss: 0.284915
steps 7600    v_Prec: 0.711960  v_Recall: 0.676799  v_F1: 0.693934  v_AUC: 0.898724
steps 7600    running time 258 seconds

steps 7800    base_loss: 0.211251    reg_loss: 0.043745    l2_loss: 0.022039    loss: 0.277035
steps 7800    v_Prec: 0.736105  v_Recall: 0.666746  v_F1: 0.699711  v_AUC: 0.898440
steps 7800    running time 264 seconds

steps 8000    base_loss: 0.218565    reg_loss: 0.043876    l2_loss: 0.022210    loss: 0.284652
steps 8000    v_Prec: 0.723245  v_Recall: 0.679911  v_F1: 0.700909  v_AUC: 0.899795
steps 8000    running time 270 seconds

steps 8200    base_loss: 0.218002    reg_loss: 0.043639    l2_loss: 0.022391    loss: 0.284033
steps 8200    v_Prec: 0.720470  v_Recall: 0.685176  v_F1: 0.702380  v_AUC: 0.901341
steps 8200    running time 276 seconds

steps 8400    base_loss: 0.215012    reg_loss: 0.043419    l2_loss: 0.022380    loss: 0.280810
steps 8400    v_Prec: 0.712509  v_Recall: 0.685735  v_F1: 0.698866  v_AUC: 0.901285
steps 8400    running time 282 seconds

steps 8600    base_loss: 0.217359    reg_loss: 0.043271    l2_loss: 0.022575    loss: 0.283205
steps 8600    v_Prec: 0.707183  v_Recall: 0.699059  v_F1: 0.703097  v_AUC: 0.903198
steps 8600    running time 288 seconds

steps 8800    base_loss: 0.218258    reg_loss: 0.042821    l2_loss: 0.022526    loss: 0.283604
steps 8800    v_Prec: 0.724632  v_Recall: 0.690522  v_F1: 0.707166  v_AUC: 0.904574
steps 8800    running time 293 seconds

steps 9000    base_loss: 0.217078    reg_loss: 0.043002    l2_loss: 0.022637    loss: 0.282717
steps 9000    v_Prec: 0.723167  v_Recall: 0.692357  v_F1: 0.707426  v_AUC: 0.905772
steps 9000    running time 299 seconds

steps 9200    base_loss: 0.224478    reg_loss: 0.042977    l2_loss: 0.022751    loss: 0.290205
steps 9200    v_Prec: 0.730283  v_Recall: 0.691479  v_F1: 0.710352  v_AUC: 0.907147
steps 9200    running time 305 seconds

steps 9400    base_loss: 0.215889    reg_loss: 0.042802    l2_loss: 0.022775    loss: 0.281466
steps 9400    v_Prec: 0.739686  v_Recall: 0.688049  v_F1: 0.712933  v_AUC: 0.906936
steps 9400    running time 311 seconds

steps 9600    base_loss: 0.211897    reg_loss: 0.042786    l2_loss: 0.022717    loss: 0.277400
steps 9600    v_Prec: 0.734120  v_Recall: 0.695229  v_F1: 0.714145  v_AUC: 0.907909
steps 9600    running time 317 seconds

steps 9800    base_loss: 0.211206    reg_loss: 0.042108    l2_loss: 0.022688    loss: 0.276002
steps 9800    v_Prec: 0.728313  v_Recall: 0.706000  v_F1: 0.716983  v_AUC: 0.908417
steps 9800    running time 322 seconds

steps 10000    base_loss: 0.214957    reg_loss: 0.042220    l2_loss: 0.022889    loss: 0.280066
steps 10000    v_Prec: 0.737804  v_Recall: 0.698660  v_F1: 0.717699  v_AUC: 0.910270
steps 10000    running time 328 seconds

steps 10200    base_loss: 0.214064    reg_loss: 0.041976    l2_loss: 0.022949    loss: 0.278989
steps 10200    v_Prec: 0.740858  v_Recall: 0.688607  v_F1: 0.713778  v_AUC: 0.909029
steps 10200    running time 334 seconds

steps 10400    base_loss: 0.214301    reg_loss: 0.041896    l2_loss: 0.022933    loss: 0.279130
steps 10400    v_Prec: 0.747059  v_Recall: 0.689006  v_F1: 0.716859  v_AUC: 0.910409
steps 10400    running time 340 seconds

steps 10600    base_loss: 0.218225    reg_loss: 0.041901    l2_loss: 0.022799    loss: 0.282926
steps 10600    v_Prec: 0.727897  v_Recall: 0.710069  v_F1: 0.718872  v_AUC: 0.911631
steps 10600    running time 346 seconds

steps 10800    base_loss: 0.200831    reg_loss: 0.041180    l2_loss: 0.022882    loss: 0.264893
steps 10800    v_Prec: 0.763111  v_Recall: 0.680310  v_F1: 0.719335  v_AUC: 0.911429
steps 10800    running time 351 seconds

steps 11000    base_loss: 0.119061    reg_loss: 0.036903    l2_loss: 0.023165    loss: 0.179129
steps 11000    v_Prec: 0.748474  v_Recall: 0.684698  v_F1: 0.715167  v_AUC: 0.908299
steps 11000    running time 357 seconds

steps 11200    base_loss: 0.110851    reg_loss: 0.036824    l2_loss: 0.023266    loss: 0.170940
steps 11200    v_Prec: 0.739273  v_Recall: 0.683182  v_F1: 0.710121  v_AUC: 0.906571
steps 11200    running time 363 seconds

steps 11400    base_loss: 0.117157    reg_loss: 0.037075    l2_loss: 0.023341    loss: 0.177573
steps 11400    v_Prec: 0.729053  v_Recall: 0.680310  v_F1: 0.703838  v_AUC: 0.904646
steps 11400    running time 369 seconds

steps 11600    base_loss: 0.120397    reg_loss: 0.037047    l2_loss: 0.023452    loss: 0.180897
steps 11600    v_Prec: 0.732439  v_Recall: 0.683820  v_F1: 0.707295  v_AUC: 0.903578
steps 11600    running time 374 seconds

steps 11800    base_loss: 0.131649    reg_loss: 0.037704    l2_loss: 0.023503    loss: 0.192857
steps 11800    v_Prec: 0.746462  v_Recall: 0.677437  v_F1: 0.710276  v_AUC: 0.906833
steps 11800    running time 380 seconds

steps 12000    base_loss: 0.120971    reg_loss: 0.037523    l2_loss: 0.023625    loss: 0.182119
steps 12000    v_Prec: 0.727060  v_Recall: 0.692835  v_F1: 0.709535  v_AUC: 0.905239
steps 12000    running time 386 seconds

steps 12200    base_loss: 0.131466    reg_loss: 0.037603    l2_loss: 0.023484    loss: 0.192552
steps 12200    v_Prec: 0.741235  v_Recall: 0.678076  v_F1: 0.708250  v_AUC: 0.901690
steps 12200    running time 391 seconds

steps 12400    base_loss: 0.127756    reg_loss: 0.037354    l2_loss: 0.023575    loss: 0.188685
steps 12400    v_Prec: 0.719809  v_Recall: 0.696665  v_F1: 0.708048  v_AUC: 0.904017
steps 12400    running time 397 seconds

steps 12600    base_loss: 0.126465    reg_loss: 0.037177    l2_loss: 0.023718    loss: 0.187360
steps 12600    v_Prec: 0.748413  v_Recall: 0.677358  v_F1: 0.711115  v_AUC: 0.906746
steps 12600    running time 402 seconds

steps 12800    base_loss: 0.133130    reg_loss: 0.037702    l2_loss: 0.023678    loss: 0.194511
steps 12800    v_Prec: 0.728920  v_Recall: 0.696585  v_F1: 0.712386  v_AUC: 0.905495
steps 12800    running time 408 seconds

Early stop model F1: 0.719335
testing thre: 0.5081942
testing Prec: 0.5628155966437602
testing Recall: 0.7204860267314702
testing F1: 0.6319648718932516
testing AUC: 0.8848386919951187
overall running time 411 seconds
(0.656168108776267, 0.6450060753341433, 0.6505392156862745, 0.8848386919951187, 0.7366408)

2019-02-24 15:08:10.763079: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:08:12.239947: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:08:12.245303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:08:12.245347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.120000 seconds
loading data in 31.210000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.030716    reg_loss: 0.064859    l2_loss: 0.013343    loss: 1.108919
steps 200    v_Prec: 0.163246  v_Recall: 1.000000  v_F1: 0.280673  v_AUC: 0.494328
steps 200    running time 41 seconds

steps 400    base_loss: 0.624300    reg_loss: 0.064774    l2_loss: 0.013385    loss: 0.702459
steps 400    v_Prec: 0.163982  v_Recall: 0.983774  v_F1: 0.281107  v_AUC: 0.524506
steps 400    running time 47 seconds

steps 600    base_loss: 0.477735    reg_loss: 0.064412    l2_loss: 0.013243    loss: 0.555389
steps 600    v_Prec: 0.169913  v_Recall: 0.847254  v_F1: 0.283059  v_AUC: 0.546655
steps 600    running time 52 seconds

steps 800    base_loss: 0.459424    reg_loss: 0.063672    l2_loss: 0.012972    loss: 0.536068
steps 800    v_Prec: 0.179902  v_Recall: 0.727360  v_F1: 0.288458  v_AUC: 0.559433
steps 800    running time 58 seconds

steps 1000    base_loss: 0.455018    reg_loss: 0.062901    l2_loss: 0.012777    loss: 0.530696
steps 1000    v_Prec: 0.189886  v_Recall: 0.683399  v_F1: 0.297195  v_AUC: 0.585322
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.455674    reg_loss: 0.062386    l2_loss: 0.012639    loss: 0.530699
steps 1200    v_Prec: 0.238445  v_Recall: 0.489889  v_F1: 0.320764  v_AUC: 0.628944
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.429409    reg_loss: 0.061460    l2_loss: 0.012567    loss: 0.503437
steps 1400    v_Prec: 0.348837  v_Recall: 0.428023  v_F1: 0.384395  v_AUC: 0.693651
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.403962    reg_loss: 0.060687    l2_loss: 0.012646    loss: 0.477294
steps 1600    v_Prec: 0.478769  v_Recall: 0.432579  v_F1: 0.454503  v_AUC: 0.744165
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.373437    reg_loss: 0.059793    l2_loss: 0.012775    loss: 0.446005
steps 1800    v_Prec: 0.529281  v_Recall: 0.475342  v_F1: 0.500863  v_AUC: 0.777527
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.360406    reg_loss: 0.059194    l2_loss: 0.012890    loss: 0.432490
steps 2000    v_Prec: 0.578650  v_Recall: 0.506914  v_F1: 0.540412  v_AUC: 0.804201
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.341094    reg_loss: 0.058803    l2_loss: 0.012989    loss: 0.412886
steps 2200    v_Prec: 0.574582  v_Recall: 0.563744  v_F1: 0.569112  v_AUC: 0.822745
steps 2200    running time 99 seconds

steps 2400    base_loss: 0.328959    reg_loss: 0.058086    l2_loss: 0.013088    loss: 0.400133
steps 2400    v_Prec: 0.630685  v_Recall: 0.555271  v_F1: 0.590581  v_AUC: 0.837074
steps 2400    running time 105 seconds

steps 2600    base_loss: 0.319922    reg_loss: 0.057657    l2_loss: 0.013140    loss: 0.390719
steps 2600    v_Prec: 0.650253  v_Recall: 0.565742  v_F1: 0.605061  v_AUC: 0.847410
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.320116    reg_loss: 0.057218    l2_loss: 0.013296    loss: 0.390630
steps 2800    v_Prec: 0.658504  v_Recall: 0.582447  v_F1: 0.618145  v_AUC: 0.856127
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.300344    reg_loss: 0.056692    l2_loss: 0.013467    loss: 0.370504
steps 3000    v_Prec: 0.675601  v_Recall: 0.584286  v_F1: 0.626634  v_AUC: 0.861073
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.309991    reg_loss: 0.056611    l2_loss: 0.013692    loss: 0.380294
steps 3200    v_Prec: 0.670630  v_Recall: 0.604108  v_F1: 0.635633  v_AUC: 0.865152
steps 3200    running time 129 seconds

steps 3400    base_loss: 0.298958    reg_loss: 0.055979    l2_loss: 0.013863    loss: 0.368800
steps 3400    v_Prec: 0.653526  v_Recall: 0.633363  v_F1: 0.643286  v_AUC: 0.871022
steps 3400    running time 135 seconds

steps 3600    base_loss: 0.296590    reg_loss: 0.055577    l2_loss: 0.014107    loss: 0.366274
steps 3600    v_Prec: 0.675128  v_Recall: 0.622892  v_F1: 0.647959  v_AUC: 0.876423
steps 3600    running time 141 seconds

steps 3800    base_loss: 0.290239    reg_loss: 0.055317    l2_loss: 0.014345    loss: 0.359901
steps 3800    v_Prec: 0.678456  v_Recall: 0.636320  v_F1: 0.656713  v_AUC: 0.880190
steps 3800    running time 147 seconds

steps 4000    base_loss: 0.286855    reg_loss: 0.055025    l2_loss: 0.014627    loss: 0.356507
steps 4000    v_Prec: 0.682807  v_Recall: 0.634562  v_F1: 0.657801  v_AUC: 0.881647
steps 4000    running time 153 seconds

steps 4200    base_loss: 0.285381    reg_loss: 0.054657    l2_loss: 0.014893    loss: 0.354930
steps 4200    v_Prec: 0.666829  v_Recall: 0.654944  v_F1: 0.660833  v_AUC: 0.882674
steps 4200    running time 159 seconds

steps 4400    base_loss: 0.279946    reg_loss: 0.054049    l2_loss: 0.015155    loss: 0.349150
steps 4400    v_Prec: 0.681214  v_Recall: 0.651267  v_F1: 0.665904  v_AUC: 0.885918
steps 4400    running time 165 seconds

steps 4600    base_loss: 0.288578    reg_loss: 0.053829    l2_loss: 0.015435    loss: 0.357841
steps 4600    v_Prec: 0.713345  v_Recall: 0.631924  v_F1: 0.670170  v_AUC: 0.888126
steps 4600    running time 171 seconds

steps 4800    base_loss: 0.278171    reg_loss: 0.053586    l2_loss: 0.015885    loss: 0.347641
steps 4800    v_Prec: 0.694058  v_Recall: 0.653505  v_F1: 0.673171  v_AUC: 0.889056
steps 4800    running time 177 seconds

steps 5000    base_loss: 0.278361    reg_loss: 0.053216    l2_loss: 0.016227    loss: 0.347804
steps 5000    v_Prec: 0.675512  v_Recall: 0.669411  v_F1: 0.672448  v_AUC: 0.891788
steps 5000    running time 183 seconds

steps 5200    base_loss: 0.277237    reg_loss: 0.053453    l2_loss: 0.016637    loss: 0.347327
steps 5200    v_Prec: 0.696062  v_Recall: 0.661178  v_F1: 0.678172  v_AUC: 0.892786
steps 5200    running time 189 seconds

steps 5400    base_loss: 0.271893    reg_loss: 0.052670    l2_loss: 0.017056    loss: 0.341619
steps 5400    v_Prec: 0.690998  v_Recall: 0.665095  v_F1: 0.677799  v_AUC: 0.894126
steps 5400    running time 195 seconds

steps 5600    base_loss: 0.202707    reg_loss: 0.047852    l2_loss: 0.017630    loss: 0.268189
steps 5600    v_Prec: 0.713930  v_Recall: 0.642315  v_F1: 0.676232  v_AUC: 0.890854
steps 5600    running time 200 seconds

steps 5800    base_loss: 0.205607    reg_loss: 0.047872    l2_loss: 0.018256    loss: 0.271735
steps 5800    v_Prec: 0.686119  v_Recall: 0.657821  v_F1: 0.671672  v_AUC: 0.889268
steps 5800    running time 206 seconds

steps 6000    base_loss: 0.205175    reg_loss: 0.047601    l2_loss: 0.018852    loss: 0.271628
steps 6000    v_Prec: 0.689684  v_Recall: 0.653025  v_F1: 0.670854  v_AUC: 0.889266
steps 6000    running time 211 seconds

steps 6200    base_loss: 0.214705    reg_loss: 0.047693    l2_loss: 0.019280    loss: 0.281678
steps 6200    v_Prec: 0.681926  v_Recall: 0.664375  v_F1: 0.673036  v_AUC: 0.891427
steps 6200    running time 217 seconds

steps 6400    base_loss: 0.217031    reg_loss: 0.047458    l2_loss: 0.019578    loss: 0.284067
steps 6400    v_Prec: 0.710180  v_Recall: 0.647910  v_F1: 0.677618  v_AUC: 0.891937
steps 6400    running time 223 seconds

steps 6600    base_loss: 0.218299    reg_loss: 0.047577    l2_loss: 0.019934    loss: 0.285809
steps 6600    v_Prec: 0.700085  v_Recall: 0.656382  v_F1: 0.677530  v_AUC: 0.894256
steps 6600    running time 229 seconds

steps 6800    base_loss: 0.201130    reg_loss: 0.046538    l2_loss: 0.020173    loss: 0.267841
steps 6800    v_Prec: 0.714559  v_Recall: 0.656302  v_F1: 0.684193  v_AUC: 0.894198
steps 6800    running time 234 seconds

steps 7000    base_loss: 0.217282    reg_loss: 0.046849    l2_loss: 0.020498    loss: 0.284629
steps 7000    v_Prec: 0.691862  v_Recall: 0.678203  v_F1: 0.684965  v_AUC: 0.894284
steps 7000    running time 240 seconds

steps 7200    base_loss: 0.216281    reg_loss: 0.046923    l2_loss: 0.020740    loss: 0.283943
steps 7200    v_Prec: 0.709661  v_Recall: 0.665814  v_F1: 0.687039  v_AUC: 0.896037
steps 7200    running time 246 seconds

steps 7400    base_loss: 0.207257    reg_loss: 0.046483    l2_loss: 0.020835    loss: 0.274575
steps 7400    v_Prec: 0.718010  v_Recall: 0.669171  v_F1: 0.692731  v_AUC: 0.897105
steps 7400    running time 252 seconds

steps 7600    base_loss: 0.218954    reg_loss: 0.046471    l2_loss: 0.020812    loss: 0.286236
steps 7600    v_Prec: 0.725723  v_Recall: 0.663656  v_F1: 0.693303  v_AUC: 0.897385
steps 7600    running time 258 seconds

steps 7800    base_loss: 0.215428    reg_loss: 0.046198    l2_loss: 0.021036    loss: 0.282661
steps 7800    v_Prec: 0.723845  v_Recall: 0.667493  v_F1: 0.694528  v_AUC: 0.897361
steps 7800    running time 264 seconds

steps 8000    base_loss: 0.207508    reg_loss: 0.045793    l2_loss: 0.021198    loss: 0.274499
steps 8000    v_Prec: 0.705993  v_Recall: 0.693070  v_F1: 0.699472  v_AUC: 0.899822
steps 8000    running time 270 seconds

steps 8200    base_loss: 0.212715    reg_loss: 0.045903    l2_loss: 0.021324    loss: 0.279942
steps 8200    v_Prec: 0.731342  v_Recall: 0.667333  v_F1: 0.697873  v_AUC: 0.899328
steps 8200    running time 276 seconds

steps 8400    base_loss: 0.217014    reg_loss: 0.045749    l2_loss: 0.021419    loss: 0.284182
steps 8400    v_Prec: 0.725805  v_Recall: 0.682759  v_F1: 0.703624  v_AUC: 0.902690
steps 8400    running time 281 seconds

steps 8600    base_loss: 0.221431    reg_loss: 0.045732    l2_loss: 0.021377    loss: 0.288541
steps 8600    v_Prec: 0.734736  v_Recall: 0.678123  v_F1: 0.705296  v_AUC: 0.904545
steps 8600    running time 287 seconds

steps 8800    base_loss: 0.220012    reg_loss: 0.045701    l2_loss: 0.021434    loss: 0.287147
steps 8800    v_Prec: 0.712609  v_Recall: 0.688914  v_F1: 0.700561  v_AUC: 0.904702
steps 8800    running time 293 seconds

steps 9000    base_loss: 0.212511    reg_loss: 0.045306    l2_loss: 0.021367    loss: 0.279185
steps 9000    v_Prec: 0.721938  v_Recall: 0.688354  v_F1: 0.704746  v_AUC: 0.906961
steps 9000    running time 299 seconds

steps 9200    base_loss: 0.213160    reg_loss: 0.045176    l2_loss: 0.021527    loss: 0.279863
steps 9200    v_Prec: 0.716760  v_Recall: 0.698026  v_F1: 0.707269  v_AUC: 0.906785
steps 9200    running time 305 seconds

steps 9400    base_loss: 0.213215    reg_loss: 0.044935    l2_loss: 0.021534    loss: 0.279685
steps 9400    v_Prec: 0.715885  v_Recall: 0.695228  v_F1: 0.705405  v_AUC: 0.907366
steps 9400    running time 311 seconds

steps 9600    base_loss: 0.209359    reg_loss: 0.044885    l2_loss: 0.021683    loss: 0.275926
steps 9600    v_Prec: 0.698986  v_Recall: 0.716250  v_F1: 0.707513  v_AUC: 0.908267
steps 9600    running time 316 seconds

steps 9800    base_loss: 0.220144    reg_loss: 0.044737    l2_loss: 0.021811    loss: 0.286692
steps 9800    v_Prec: 0.719342  v_Recall: 0.698585  v_F1: 0.708811  v_AUC: 0.909547
steps 9800    running time 322 seconds

steps 10000    base_loss: 0.211660    reg_loss: 0.044458    l2_loss: 0.021929    loss: 0.278047
steps 10000    v_Prec: 0.740393  v_Recall: 0.680681  v_F1: 0.709282  v_AUC: 0.909676
steps 10000    running time 328 seconds

steps 10200    base_loss: 0.215808    reg_loss: 0.044495    l2_loss: 0.021995    loss: 0.282298
steps 10200    v_Prec: 0.718454  v_Recall: 0.702662  v_F1: 0.710470  v_AUC: 0.910680
steps 10200    running time 334 seconds

steps 10400    base_loss: 0.216367    reg_loss: 0.044183    l2_loss: 0.021911    loss: 0.282461
steps 10400    v_Prec: 0.731327  v_Recall: 0.697306  v_F1: 0.713912  v_AUC: 0.912520
steps 10400    running time 340 seconds

steps 10600    base_loss: 0.218122    reg_loss: 0.044186    l2_loss: 0.021896    loss: 0.284203
steps 10600    v_Prec: 0.742494  v_Recall: 0.695788  v_F1: 0.718383  v_AUC: 0.913365
steps 10600    running time 346 seconds

steps 10800    base_loss: 0.205647    reg_loss: 0.043526    l2_loss: 0.021929    loss: 0.271102
steps 10800    v_Prec: 0.738577  v_Recall: 0.700264  v_F1: 0.718910  v_AUC: 0.914832
steps 10800    running time 352 seconds

steps 11000    base_loss: 0.115919    reg_loss: 0.038592    l2_loss: 0.022157    loss: 0.176667
steps 11000    v_Prec: 0.714887  v_Recall: 0.705859  v_F1: 0.710344  v_AUC: 0.910782
steps 11000    running time 357 seconds

steps 11200    base_loss: 0.110425    reg_loss: 0.038899    l2_loss: 0.022103    loss: 0.171427
steps 11200    v_Prec: 0.736635  v_Recall: 0.688354  v_F1: 0.711677  v_AUC: 0.910080
steps 11200    running time 363 seconds

steps 11400    base_loss: 0.119347    reg_loss: 0.039126    l2_loss: 0.022294    loss: 0.180766
steps 11400    v_Prec: 0.717456  v_Recall: 0.697786  v_F1: 0.707484  v_AUC: 0.907637
steps 11400    running time 369 seconds

steps 11600    base_loss: 0.116355    reg_loss: 0.039039    l2_loss: 0.022216    loss: 0.177610
steps 11600    v_Prec: 0.722809  v_Recall: 0.689473  v_F1: 0.705748  v_AUC: 0.906354
steps 11600    running time 374 seconds

steps 11800    base_loss: 0.121544    reg_loss: 0.039024    l2_loss: 0.022480    loss: 0.183048
steps 11800    v_Prec: 0.736960  v_Recall: 0.681001  v_F1: 0.707876  v_AUC: 0.907208
steps 11800    running time 380 seconds

steps 12000    base_loss: 0.116381    reg_loss: 0.039141    l2_loss: 0.022501    loss: 0.178023
steps 12000    v_Prec: 0.718779  v_Recall: 0.684997  v_F1: 0.701482  v_AUC: 0.905156
steps 12000    running time 386 seconds

steps 12200    base_loss: 0.125417    reg_loss: 0.038969    l2_loss: 0.022575    loss: 0.186961
steps 12200    v_Prec: 0.728966  v_Recall: 0.675885  v_F1: 0.701423  v_AUC: 0.906740
steps 12200    running time 392 seconds

steps 12400    base_loss: 0.120957    reg_loss: 0.038916    l2_loss: 0.022601    loss: 0.182474
steps 12400    v_Prec: 0.718114  v_Recall: 0.696187  v_F1: 0.706981  v_AUC: 0.906968
steps 12400    running time 397 seconds

steps 12600    base_loss: 0.120903    reg_loss: 0.038970    l2_loss: 0.022645    loss: 0.182518
steps 12600    v_Prec: 0.722041  v_Recall: 0.689953  v_F1: 0.705632  v_AUC: 0.905534
steps 12600    running time 403 seconds

steps 12800    base_loss: 0.128493    reg_loss: 0.038970    l2_loss: 0.022656    loss: 0.190119
steps 12800    v_Prec: 0.735325  v_Recall: 0.678843  v_F1: 0.705956  v_AUC: 0.905370
steps 12800    running time 409 seconds

Early stop model F1: 0.718910
testing thre: 0.5123292
testing Prec: 0.5476199282464771
testing Recall: 0.7196111786148238
testing F1: 0.6219440477190624
testing AUC: 0.8783063716503796
overall running time 411 seconds
(0.6351771286513362, 0.6457351154313488, 0.6404126096596934, 0.8783063716503796, 0.7289462)

2019-02-24 15:12:14.100353: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:12:15.352681: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:12:15.359308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:12:15.359369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.340000 seconds
loading data in 31.480000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.177902    reg_loss: 0.064999    l2_loss: 0.013306    loss: 1.256206
steps 200    v_Prec: 0.164201  v_Recall: 1.000000  v_F1: 0.282083  v_AUC: 0.501596
steps 200    running time 41 seconds

steps 400    base_loss: 0.589386    reg_loss: 0.064993    l2_loss: 0.013071    loss: 0.667449
steps 400    v_Prec: 0.164226  v_Recall: 1.000000  v_F1: 0.282121  v_AUC: 0.516547
steps 400    running time 47 seconds

steps 600    base_loss: 0.484238    reg_loss: 0.064966    l2_loss: 0.012917    loss: 0.562122
steps 600    v_Prec: 0.170452  v_Recall: 0.856961  v_F1: 0.284347  v_AUC: 0.545198
steps 600    running time 53 seconds

steps 800    base_loss: 0.459547    reg_loss: 0.064692    l2_loss: 0.012775    loss: 0.537014
steps 800    v_Prec: 0.209806  v_Recall: 0.590989  v_F1: 0.309675  v_AUC: 0.608753
steps 800    running time 59 seconds

steps 1000    base_loss: 0.441818    reg_loss: 0.064489    l2_loss: 0.012664    loss: 0.518971
steps 1000    v_Prec: 0.251227  v_Recall: 0.557295  v_F1: 0.346330  v_AUC: 0.666717
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.423818    reg_loss: 0.064542    l2_loss: 0.012628    loss: 0.500987
steps 1200    v_Prec: 0.318919  v_Recall: 0.521615  v_F1: 0.395827  v_AUC: 0.717863
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.406720    reg_loss: 0.064800    l2_loss: 0.012564    loss: 0.484084
steps 1400    v_Prec: 0.400145  v_Recall: 0.481167  v_F1: 0.436932  v_AUC: 0.755737
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.389272    reg_loss: 0.065099    l2_loss: 0.012597    loss: 0.466968
steps 1600    v_Prec: 0.458945  v_Recall: 0.499682  v_F1: 0.478448  v_AUC: 0.786145
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.369265    reg_loss: 0.065323    l2_loss: 0.012663    loss: 0.447251
steps 1800    v_Prec: 0.502309  v_Recall: 0.527177  v_F1: 0.514443  v_AUC: 0.808550
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.354963    reg_loss: 0.065714    l2_loss: 0.012750    loss: 0.433428
steps 2000    v_Prec: 0.537149  v_Recall: 0.537746  v_F1: 0.537447  v_AUC: 0.824258
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.344055    reg_loss: 0.065687    l2_loss: 0.012876    loss: 0.422618
steps 2200    v_Prec: 0.540632  v_Recall: 0.586300  v_F1: 0.562541  v_AUC: 0.839165
steps 2200    running time 100 seconds

steps 2400    base_loss: 0.329999    reg_loss: 0.066084    l2_loss: 0.013062    loss: 0.409146
steps 2400    v_Prec: 0.576792  v_Recall: 0.577479  v_F1: 0.577135  v_AUC: 0.848580
steps 2400    running time 106 seconds

steps 2600    base_loss: 0.320131    reg_loss: 0.066132    l2_loss: 0.013237    loss: 0.399500
steps 2600    v_Prec: 0.593205  v_Recall: 0.581373  v_F1: 0.587230  v_AUC: 0.856098
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.313277    reg_loss: 0.066275    l2_loss: 0.013494    loss: 0.393046
steps 2800    v_Prec: 0.591695  v_Recall: 0.603544  v_F1: 0.597561  v_AUC: 0.861163
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.309040    reg_loss: 0.066293    l2_loss: 0.013750    loss: 0.389083
steps 3000    v_Prec: 0.607352  v_Recall: 0.601319  v_F1: 0.604321  v_AUC: 0.865712
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.304279    reg_loss: 0.066211    l2_loss: 0.014047    loss: 0.384537
steps 3200    v_Prec: 0.608279  v_Recall: 0.610696  v_F1: 0.609485  v_AUC: 0.870758
steps 3200    running time 129 seconds

steps 3400    base_loss: 0.306662    reg_loss: 0.066384    l2_loss: 0.014368    loss: 0.387414
steps 3400    v_Prec: 0.612470  v_Recall: 0.612762  v_F1: 0.612616  v_AUC: 0.873130
steps 3400    running time 135 seconds

steps 3600    base_loss: 0.293105    reg_loss: 0.065898    l2_loss: 0.014679    loss: 0.373682
steps 3600    v_Prec: 0.623301  v_Recall: 0.616020  v_F1: 0.619640  v_AUC: 0.875910
steps 3600    running time 141 seconds

steps 3800    base_loss: 0.300559    reg_loss: 0.066271    l2_loss: 0.015060    loss: 0.381890
steps 3800    v_Prec: 0.610927  v_Recall: 0.628258  v_F1: 0.619471  v_AUC: 0.877886
steps 3800    running time 147 seconds

steps 4000    base_loss: 0.295578    reg_loss: 0.066148    l2_loss: 0.015362    loss: 0.377088
steps 4000    v_Prec: 0.612407  v_Recall: 0.642483  v_F1: 0.627084  v_AUC: 0.879956
steps 4000    running time 153 seconds

steps 4200    base_loss: 0.294465    reg_loss: 0.066178    l2_loss: 0.015751    loss: 0.376394
steps 4200    v_Prec: 0.625596  v_Recall: 0.635490  v_F1: 0.630504  v_AUC: 0.881950
steps 4200    running time 158 seconds

steps 4400    base_loss: 0.294206    reg_loss: 0.066402    l2_loss: 0.016238    loss: 0.376846
steps 4400    v_Prec: 0.624726  v_Recall: 0.633662  v_F1: 0.629162  v_AUC: 0.883965
steps 4400    running time 164 seconds

steps 4600    base_loss: 0.289536    reg_loss: 0.066222    l2_loss: 0.016664    loss: 0.372422
steps 4600    v_Prec: 0.642333  v_Recall: 0.632788  v_F1: 0.637525  v_AUC: 0.885495
steps 4600    running time 170 seconds

steps 4800    base_loss: 0.287335    reg_loss: 0.066159    l2_loss: 0.017210    loss: 0.370703
steps 4800    v_Prec: 0.621747  v_Recall: 0.651144  v_F1: 0.636106  v_AUC: 0.885687
steps 4800    running time 176 seconds

steps 5000    base_loss: 0.286926    reg_loss: 0.066223    l2_loss: 0.017711    loss: 0.370860
steps 5000    v_Prec: 0.641582  v_Recall: 0.639542  v_F1: 0.640560  v_AUC: 0.887853
steps 5000    running time 182 seconds

steps 5200    base_loss: 0.292354    reg_loss: 0.066123    l2_loss: 0.018251    loss: 0.376727
steps 5200    v_Prec: 0.646001  v_Recall: 0.639224  v_F1: 0.642595  v_AUC: 0.890523
steps 5200    running time 187 seconds

steps 5400    base_loss: 0.281101    reg_loss: 0.066003    l2_loss: 0.018773    loss: 0.365878
steps 5400    v_Prec: 0.649221  v_Recall: 0.638748  v_F1: 0.643942  v_AUC: 0.891484
steps 5400    running time 193 seconds

steps 5600    base_loss: 0.201056    reg_loss: 0.066985    l2_loss: 0.019558    loss: 0.287599
steps 5600    v_Prec: 0.618386  v_Recall: 0.629688  v_F1: 0.623986  v_AUC: 0.880869
steps 5600    running time 199 seconds

steps 5800    base_loss: 0.222510    reg_loss: 0.067098    l2_loss: 0.020194    loss: 0.309802
steps 5800    v_Prec: 0.628195  v_Recall: 0.636682  v_F1: 0.632410  v_AUC: 0.883662
steps 5800    running time 205 seconds

steps 6000    base_loss: 0.213766    reg_loss: 0.066811    l2_loss: 0.020791    loss: 0.301368
steps 6000    v_Prec: 0.624932  v_Recall: 0.638191  v_F1: 0.631492  v_AUC: 0.883384
steps 6000    running time 211 seconds

steps 6200    base_loss: 0.214422    reg_loss: 0.066665    l2_loss: 0.021200    loss: 0.302287
steps 6200    v_Prec: 0.610693  v_Recall: 0.645343  v_F1: 0.627540  v_AUC: 0.880152
steps 6200    running time 216 seconds

steps 6400    base_loss: 0.224184    reg_loss: 0.066657    l2_loss: 0.021697    loss: 0.312537
steps 6400    v_Prec: 0.649106  v_Recall: 0.631516  v_F1: 0.640190  v_AUC: 0.886693
steps 6400    running time 222 seconds

steps 6600    base_loss: 0.220254    reg_loss: 0.067046    l2_loss: 0.022068    loss: 0.309368
steps 6600    v_Prec: 0.633567  v_Recall: 0.646456  v_F1: 0.639947  v_AUC: 0.885164
steps 6600    running time 228 seconds

steps 6800    base_loss: 0.207677    reg_loss: 0.066724    l2_loss: 0.022491    loss: 0.296892
steps 6800    v_Prec: 0.615947  v_Recall: 0.669739  v_F1: 0.641718  v_AUC: 0.887303
steps 6800    running time 233 seconds

steps 7000    base_loss: 0.224500    reg_loss: 0.066868    l2_loss: 0.022841    loss: 0.314209
steps 7000    v_Prec: 0.646394  v_Recall: 0.645264  v_F1: 0.645828  v_AUC: 0.889653
steps 7000    running time 239 seconds

steps 7200    base_loss: 0.211891    reg_loss: 0.066581    l2_loss: 0.023230    loss: 0.301702
steps 7200    v_Prec: 0.637828  v_Recall: 0.651462  v_F1: 0.644573  v_AUC: 0.889529
steps 7200    running time 245 seconds

steps 7400    base_loss: 0.218801    reg_loss: 0.066395    l2_loss: 0.023520    loss: 0.308716
steps 7400    v_Prec: 0.641470  v_Recall: 0.658853  v_F1: 0.650045  v_AUC: 0.891047
steps 7400    running time 251 seconds

steps 7600    base_loss: 0.222175    reg_loss: 0.066750    l2_loss: 0.023819    loss: 0.312744
steps 7600    v_Prec: 0.633399  v_Recall: 0.662190  v_F1: 0.647475  v_AUC: 0.891345
steps 7600    running time 256 seconds

steps 7800    base_loss: 0.220865    reg_loss: 0.066353    l2_loss: 0.024058    loss: 0.311275
steps 7800    v_Prec: 0.619838  v_Recall: 0.682295  v_F1: 0.649569  v_AUC: 0.892698
steps 7800    running time 262 seconds

steps 8000    base_loss: 0.217905    reg_loss: 0.066611    l2_loss: 0.024369    loss: 0.308885
steps 8000    v_Prec: 0.643904  v_Recall: 0.670613  v_F1: 0.656987  v_AUC: 0.895166
steps 8000    running time 268 seconds

steps 8200    base_loss: 0.220753    reg_loss: 0.066566    l2_loss: 0.024720    loss: 0.312040
steps 8200    v_Prec: 0.650508  v_Recall: 0.681421  v_F1: 0.665606  v_AUC: 0.899528
steps 8200    running time 274 seconds

steps 8400    base_loss: 0.214678    reg_loss: 0.066345    l2_loss: 0.024955    loss: 0.305978
steps 8400    v_Prec: 0.671330  v_Recall: 0.655912  v_F1: 0.663531  v_AUC: 0.899183
steps 8400    running time 279 seconds

steps 8600    base_loss: 0.212900    reg_loss: 0.066509    l2_loss: 0.025251    loss: 0.304660
steps 8600    v_Prec: 0.677036  v_Recall: 0.652018  v_F1: 0.664292  v_AUC: 0.898564
steps 8600    running time 285 seconds

steps 8800    base_loss: 0.210132    reg_loss: 0.066465    l2_loss: 0.025377    loss: 0.301973
steps 8800    v_Prec: 0.666981  v_Recall: 0.674984  v_F1: 0.670959  v_AUC: 0.902593
steps 8800    running time 291 seconds

steps 9000    base_loss: 0.222307    reg_loss: 0.066293    l2_loss: 0.025553    loss: 0.314153
steps 9000    v_Prec: 0.679342  v_Recall: 0.665846  v_F1: 0.672526  v_AUC: 0.904452
steps 9000    running time 297 seconds

steps 9200    base_loss: 0.210620    reg_loss: 0.066527    l2_loss: 0.025719    loss: 0.302866
steps 9200    v_Prec: 0.672680  v_Recall: 0.684441  v_F1: 0.678510  v_AUC: 0.906092
steps 9200    running time 303 seconds

steps 9400    base_loss: 0.217263    reg_loss: 0.066192    l2_loss: 0.026081    loss: 0.309537
steps 9400    v_Prec: 0.659477  v_Recall: 0.699777  v_F1: 0.679030  v_AUC: 0.908155
steps 9400    running time 309 seconds

steps 9600    base_loss: 0.212487    reg_loss: 0.066172    l2_loss: 0.026232    loss: 0.304891
steps 9600    v_Prec: 0.698283  v_Recall: 0.672203  v_F1: 0.684995  v_AUC: 0.909506
steps 9600    running time 314 seconds

steps 9800    base_loss: 0.217125    reg_loss: 0.065866    l2_loss: 0.026261    loss: 0.309252
steps 9800    v_Prec: 0.701282  v_Recall: 0.664892  v_F1: 0.682602  v_AUC: 0.908691
steps 9800    running time 320 seconds

steps 10000    base_loss: 0.215327    reg_loss: 0.066147    l2_loss: 0.026433    loss: 0.307907
steps 10000    v_Prec: 0.724178  v_Recall: 0.650747  v_F1: 0.685501  v_AUC: 0.910745
steps 10000    running time 326 seconds

steps 10200    base_loss: 0.218302    reg_loss: 0.066038    l2_loss: 0.026703    loss: 0.311043
steps 10200    v_Prec: 0.700441  v_Recall: 0.682295  v_F1: 0.691249  v_AUC: 0.913291
steps 10200    running time 332 seconds

steps 10400    base_loss: 0.214501    reg_loss: 0.065894    l2_loss: 0.026884    loss: 0.307279
steps 10400    v_Prec: 0.727100  v_Recall: 0.668627  v_F1: 0.696639  v_AUC: 0.914211
steps 10400    running time 338 seconds

steps 10600    base_loss: 0.210792    reg_loss: 0.065695    l2_loss: 0.027006    loss: 0.303493
steps 10600    v_Prec: 0.708456  v_Recall: 0.685712  v_F1: 0.696899  v_AUC: 0.914525
steps 10600    running time 344 seconds

steps 10800    base_loss: 0.197595    reg_loss: 0.065450    l2_loss: 0.026931    loss: 0.289976
steps 10800    v_Prec: 0.703920  v_Recall: 0.680706  v_F1: 0.692118  v_AUC: 0.911953
steps 10800    running time 350 seconds

steps 11000    base_loss: 0.110801    reg_loss: 0.065427    l2_loss: 0.027297    loss: 0.203525
steps 11000    v_Prec: 0.639954  v_Recall: 0.710744  v_F1: 0.673494  v_AUC: 0.903589
steps 11000    running time 356 seconds

steps 11200    base_loss: 0.111743    reg_loss: 0.065258    l2_loss: 0.027466    loss: 0.204467
steps 11200    v_Prec: 0.660237  v_Recall: 0.660919  v_F1: 0.660577  v_AUC: 0.897524
steps 11200    running time 361 seconds

steps 11400    base_loss: 0.116352    reg_loss: 0.065226    l2_loss: 0.027576    loss: 0.209154
steps 11400    v_Prec: 0.633558  v_Recall: 0.673633  v_F1: 0.652981  v_AUC: 0.894182
steps 11400    running time 367 seconds

steps 11600    base_loss: 0.113988    reg_loss: 0.064971    l2_loss: 0.027688    loss: 0.206646
steps 11600    v_Prec: 0.642370  v_Recall: 0.672997  v_F1: 0.657327  v_AUC: 0.898657
steps 11600    running time 372 seconds

steps 11800    base_loss: 0.119993    reg_loss: 0.065464    l2_loss: 0.027817    loss: 0.213274
steps 11800    v_Prec: 0.638868  v_Recall: 0.674507  v_F1: 0.656204  v_AUC: 0.896250
steps 11800    running time 378 seconds

steps 12000    base_loss: 0.121090    reg_loss: 0.065173    l2_loss: 0.027838    loss: 0.214101
steps 12000    v_Prec: 0.652800  v_Recall: 0.640973  v_F1: 0.646832  v_AUC: 0.889691
steps 12000    running time 384 seconds

steps 12200    base_loss: 0.120810    reg_loss: 0.065160    l2_loss: 0.028045    loss: 0.214015
steps 12200    v_Prec: 0.656610  v_Recall: 0.652018  v_F1: 0.654306  v_AUC: 0.894029
steps 12200    running time 389 seconds

steps 12400    base_loss: 0.118911    reg_loss: 0.065235    l2_loss: 0.028059    loss: 0.212205
steps 12400    v_Prec: 0.624503  v_Recall: 0.686189  v_F1: 0.653894  v_AUC: 0.894590
steps 12400    running time 395 seconds

steps 12600    base_loss: 0.133606    reg_loss: 0.065264    l2_loss: 0.028187    loss: 0.227056
steps 12600    v_Prec: 0.644606  v_Recall: 0.669501  v_F1: 0.656818  v_AUC: 0.894191
steps 12600    running time 401 seconds

Early stop model F1: 0.696899
testing thre: 0.26759356
testing Prec: 0.5064809038608166
testing Recall: 0.7102794653705954
testing F1: 0.5913127920856178
testing AUC: 0.8754678890506907
overall running time 403 seconds
(0.6081158589045025, 0.6183718104495747, 0.613200954285852, 0.8754678890506907, 0.46199986)

2019-02-24 15:16:14.598665: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:16:15.913695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:16:15.921392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:16:15.921470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.590000 seconds
loading data in 30.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.516555    reg_loss: 0.064959    l2_loss: 0.013241    loss: 0.594755
steps 200    v_Prec: 0.162715  v_Recall: 1.000000  v_F1: 0.279888  v_AUC: 0.493925
steps 200    running time 40 seconds

steps 400    base_loss: 0.495572    reg_loss: 0.064872    l2_loss: 0.013212    loss: 0.573656
steps 400    v_Prec: 0.162717  v_Recall: 1.000000  v_F1: 0.279891  v_AUC: 0.506938
steps 400    running time 45 seconds

steps 600    base_loss: 0.470213    reg_loss: 0.064786    l2_loss: 0.012988    loss: 0.547987
steps 600    v_Prec: 0.163213  v_Recall: 0.985324  v_F1: 0.280039  v_AUC: 0.530524
steps 600    running time 51 seconds

steps 800    base_loss: 0.453913    reg_loss: 0.064369    l2_loss: 0.012876    loss: 0.531158
steps 800    v_Prec: 0.186615  v_Recall: 0.718983  v_F1: 0.296320  v_AUC: 0.589838
steps 800    running time 57 seconds

steps 1000    base_loss: 0.442475    reg_loss: 0.064211    l2_loss: 0.012758    loss: 0.519444
steps 1000    v_Prec: 0.237122  v_Recall: 0.562274  v_F1: 0.333571  v_AUC: 0.648881
steps 1000    running time 63 seconds

steps 1200    base_loss: 0.432664    reg_loss: 0.063982    l2_loss: 0.012620    loss: 0.509266
steps 1200    v_Prec: 0.302199  v_Recall: 0.498196  v_F1: 0.376200  v_AUC: 0.697790
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.408749    reg_loss: 0.063949    l2_loss: 0.012543    loss: 0.485241
steps 1400    v_Prec: 0.382190  v_Recall: 0.486005  v_F1: 0.427891  v_AUC: 0.743395
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.387341    reg_loss: 0.063999    l2_loss: 0.012533    loss: 0.463874
steps 1600    v_Prec: 0.428265  v_Recall: 0.528591  v_F1: 0.473168  v_AUC: 0.777755
steps 1600    running time 80 seconds

steps 1800    base_loss: 0.373974    reg_loss: 0.064680    l2_loss: 0.012561    loss: 0.451215
steps 1800    v_Prec: 0.484488  v_Recall: 0.532280  v_F1: 0.507261  v_AUC: 0.801462
steps 1800    running time 86 seconds

steps 2000    base_loss: 0.360295    reg_loss: 0.065083    l2_loss: 0.012644    loss: 0.438021
steps 2000    v_Prec: 0.497839  v_Recall: 0.572780  v_F1: 0.532687  v_AUC: 0.818815
steps 2000    running time 92 seconds

steps 2200    base_loss: 0.345219    reg_loss: 0.065347    l2_loss: 0.012728    loss: 0.423294
steps 2200    v_Prec: 0.546942  v_Recall: 0.555057  v_F1: 0.550969  v_AUC: 0.833595
steps 2200    running time 98 seconds

steps 2400    base_loss: 0.331959    reg_loss: 0.065303    l2_loss: 0.012896    loss: 0.410158
steps 2400    v_Prec: 0.553507  v_Recall: 0.575347  v_F1: 0.564215  v_AUC: 0.842656
steps 2400    running time 104 seconds

steps 2600    base_loss: 0.332956    reg_loss: 0.066034    l2_loss: 0.013120    loss: 0.412110
steps 2600    v_Prec: 0.574636  v_Recall: 0.597402  v_F1: 0.585797  v_AUC: 0.854003
steps 2600    running time 109 seconds

steps 2800    base_loss: 0.321560    reg_loss: 0.065661    l2_loss: 0.013299    loss: 0.400520
steps 2800    v_Prec: 0.582823  v_Recall: 0.595397  v_F1: 0.589043  v_AUC: 0.859494
steps 2800    running time 115 seconds

steps 3000    base_loss: 0.326945    reg_loss: 0.066194    l2_loss: 0.013534    loss: 0.406673
steps 3000    v_Prec: 0.575729  v_Recall: 0.630443  v_F1: 0.601845  v_AUC: 0.864079
steps 3000    running time 121 seconds

steps 3200    base_loss: 0.321070    reg_loss: 0.066216    l2_loss: 0.013716    loss: 0.401003
steps 3200    v_Prec: 0.581686  v_Recall: 0.630203  v_F1: 0.604973  v_AUC: 0.867712
steps 3200    running time 127 seconds

steps 3400    base_loss: 0.308288    reg_loss: 0.065942    l2_loss: 0.014026    loss: 0.388256
steps 3400    v_Prec: 0.610946  v_Recall: 0.610554  v_F1: 0.610750  v_AUC: 0.870375
steps 3400    running time 133 seconds

steps 3600    base_loss: 0.309778    reg_loss: 0.066315    l2_loss: 0.014361    loss: 0.390455
steps 3600    v_Prec: 0.585614  v_Recall: 0.645120  v_F1: 0.613929  v_AUC: 0.874630
steps 3600    running time 138 seconds

steps 3800    base_loss: 0.304057    reg_loss: 0.066284    l2_loss: 0.014723    loss: 0.385064
steps 3800    v_Prec: 0.604877  v_Recall: 0.630684  v_F1: 0.617511  v_AUC: 0.877035
steps 3800    running time 144 seconds

steps 4000    base_loss: 0.301678    reg_loss: 0.066525    l2_loss: 0.015084    loss: 0.383287
steps 4000    v_Prec: 0.609534  v_Recall: 0.638864  v_F1: 0.623855  v_AUC: 0.879274
steps 4000    running time 150 seconds

steps 4200    base_loss: 0.305743    reg_loss: 0.066469    l2_loss: 0.015471    loss: 0.387683
steps 4200    v_Prec: 0.610203  v_Recall: 0.643676  v_F1: 0.626493  v_AUC: 0.880441
steps 4200    running time 156 seconds

steps 4400    base_loss: 0.302965    reg_loss: 0.066461    l2_loss: 0.015907    loss: 0.385333
steps 4400    v_Prec: 0.617519  v_Recall: 0.637180  v_F1: 0.627196  v_AUC: 0.881282
steps 4400    running time 162 seconds

steps 4600    base_loss: 0.297134    reg_loss: 0.066350    l2_loss: 0.016392    loss: 0.379875
steps 4600    v_Prec: 0.617909  v_Recall: 0.644719  v_F1: 0.631029  v_AUC: 0.882559
steps 4600    running time 167 seconds

steps 4800    base_loss: 0.298284    reg_loss: 0.066492    l2_loss: 0.016891    loss: 0.381667
steps 4800    v_Prec: 0.628708  v_Recall: 0.642473  v_F1: 0.635516  v_AUC: 0.885198
steps 4800    running time 173 seconds

steps 5000    base_loss: 0.293520    reg_loss: 0.066499    l2_loss: 0.017443    loss: 0.377463
steps 5000    v_Prec: 0.601283  v_Recall: 0.669180  v_F1: 0.633417  v_AUC: 0.886545
steps 5000    running time 179 seconds

steps 5200    base_loss: 0.283624    reg_loss: 0.066408    l2_loss: 0.018035    loss: 0.368068
steps 5200    v_Prec: 0.633288  v_Recall: 0.635015  v_F1: 0.634150  v_AUC: 0.886732
steps 5200    running time 185 seconds

steps 5400    base_loss: 0.292030    reg_loss: 0.066473    l2_loss: 0.018664    loss: 0.377166
steps 5400    v_Prec: 0.623357  v_Recall: 0.654102  v_F1: 0.638359  v_AUC: 0.888071
steps 5400    running time 191 seconds

steps 5600    base_loss: 0.219158    reg_loss: 0.067810    l2_loss: 0.019316    loss: 0.306283
steps 5600    v_Prec: 0.633841  v_Recall: 0.630283  v_F1: 0.632057  v_AUC: 0.883134
steps 5600    running time 197 seconds

steps 5800    base_loss: 0.212520    reg_loss: 0.067631    l2_loss: 0.019928    loss: 0.300080
steps 5800    v_Prec: 0.634174  v_Recall: 0.629241  v_F1: 0.631698  v_AUC: 0.882562
steps 5800    running time 202 seconds

steps 6000    base_loss: 0.209179    reg_loss: 0.067789    l2_loss: 0.020435    loss: 0.297403
steps 6000    v_Prec: 0.636118  v_Recall: 0.623466  v_F1: 0.629729  v_AUC: 0.882044
steps 6000    running time 208 seconds

steps 6200    base_loss: 0.227681    reg_loss: 0.067418    l2_loss: 0.020965    loss: 0.316064
steps 6200    v_Prec: 0.628378  v_Recall: 0.639666  v_F1: 0.633972  v_AUC: 0.885207
steps 6200    running time 214 seconds

steps 6400    base_loss: 0.225400    reg_loss: 0.067674    l2_loss: 0.021429    loss: 0.314503
steps 6400    v_Prec: 0.618503  v_Recall: 0.663245  v_F1: 0.640093  v_AUC: 0.887618
steps 6400    running time 219 seconds

steps 6600    base_loss: 0.217961    reg_loss: 0.067507    l2_loss: 0.021834    loss: 0.307301
steps 6600    v_Prec: 0.645313  v_Recall: 0.638223  v_F1: 0.641748  v_AUC: 0.889767
steps 6600    running time 225 seconds

steps 6800    base_loss: 0.222980    reg_loss: 0.067444    l2_loss: 0.022220    loss: 0.312644
steps 6800    v_Prec: 0.633618  v_Recall: 0.647847  v_F1: 0.640654  v_AUC: 0.890832
steps 6800    running time 231 seconds

steps 7000    base_loss: 0.222731    reg_loss: 0.067539    l2_loss: 0.022596    loss: 0.312866
steps 7000    v_Prec: 0.636215  v_Recall: 0.656268  v_F1: 0.646086  v_AUC: 0.892307
steps 7000    running time 236 seconds

steps 7200    base_loss: 0.215540    reg_loss: 0.067358    l2_loss: 0.022950    loss: 0.305848
steps 7200    v_Prec: 0.631692  v_Recall: 0.661480  v_F1: 0.646243  v_AUC: 0.891726
steps 7200    running time 242 seconds

steps 7400    base_loss: 0.232298    reg_loss: 0.067567    l2_loss: 0.023375    loss: 0.323240
steps 7400    v_Prec: 0.636488  v_Recall: 0.669260  v_F1: 0.652463  v_AUC: 0.896065
steps 7400    running time 248 seconds

steps 7600    base_loss: 0.220098    reg_loss: 0.067307    l2_loss: 0.023622    loss: 0.311028
steps 7600    v_Prec: 0.638138  v_Recall: 0.673911  v_F1: 0.655537  v_AUC: 0.896440
steps 7600    running time 254 seconds

steps 7800    base_loss: 0.222160    reg_loss: 0.067198    l2_loss: 0.023863    loss: 0.313221
steps 7800    v_Prec: 0.631752  v_Recall: 0.677199  v_F1: 0.653687  v_AUC: 0.897619
steps 7800    running time 259 seconds

steps 8000    base_loss: 0.233411    reg_loss: 0.067435    l2_loss: 0.023949    loss: 0.324795
steps 8000    v_Prec: 0.662045  v_Recall: 0.666292  v_F1: 0.664162  v_AUC: 0.900889
steps 8000    running time 265 seconds

steps 8200    base_loss: 0.220679    reg_loss: 0.067152    l2_loss: 0.024363    loss: 0.312194
steps 8200    v_Prec: 0.645827  v_Recall: 0.685139  v_F1: 0.664903  v_AUC: 0.900978
steps 8200    running time 271 seconds

steps 8400    base_loss: 0.221533    reg_loss: 0.067098    l2_loss: 0.024604    loss: 0.313234
steps 8400    v_Prec: 0.672274  v_Recall: 0.669901  v_F1: 0.671085  v_AUC: 0.903085
steps 8400    running time 276 seconds

steps 8600    base_loss: 0.220984    reg_loss: 0.067082    l2_loss: 0.024784    loss: 0.312850
steps 8600    v_Prec: 0.659230  v_Recall: 0.689630  v_F1: 0.674088  v_AUC: 0.905397
steps 8600    running time 282 seconds

steps 8800    base_loss: 0.215447    reg_loss: 0.066845    l2_loss: 0.025044    loss: 0.307336
steps 8800    v_Prec: 0.685987  v_Recall: 0.674874  v_F1: 0.680385  v_AUC: 0.905846
steps 8800    running time 288 seconds

steps 9000    base_loss: 0.213546    reg_loss: 0.066625    l2_loss: 0.025245    loss: 0.305417
steps 9000    v_Prec: 0.674088  v_Recall: 0.679926  v_F1: 0.676994  v_AUC: 0.904888
steps 9000    running time 293 seconds

steps 9200    base_loss: 0.210549    reg_loss: 0.066699    l2_loss: 0.025503    loss: 0.302751
steps 9200    v_Prec: 0.669790  v_Recall: 0.676397  v_F1: 0.673078  v_AUC: 0.904221
steps 9200    running time 299 seconds

steps 9400    base_loss: 0.209291    reg_loss: 0.066889    l2_loss: 0.025663    loss: 0.301843
steps 9400    v_Prec: 0.689449  v_Recall: 0.682813  v_F1: 0.686115  v_AUC: 0.910515
steps 9400    running time 305 seconds

steps 9600    base_loss: 0.223977    reg_loss: 0.066975    l2_loss: 0.025803    loss: 0.316754
steps 9600    v_Prec: 0.688740  v_Recall: 0.682332  v_F1: 0.685521  v_AUC: 0.911842
steps 9600    running time 310 seconds

steps 9800    base_loss: 0.216927    reg_loss: 0.066670    l2_loss: 0.025957    loss: 0.309554
steps 9800    v_Prec: 0.686246  v_Recall: 0.683054  v_F1: 0.684646  v_AUC: 0.908936
steps 9800    running time 316 seconds

steps 10000    base_loss: 0.209683    reg_loss: 0.066394    l2_loss: 0.026185    loss: 0.302261
steps 10000    v_Prec: 0.669369  v_Recall: 0.701901  v_F1: 0.685249  v_AUC: 0.910363
steps 10000    running time 321 seconds

steps 10200    base_loss: 0.213983    reg_loss: 0.066385    l2_loss: 0.026305    loss: 0.306672
steps 10200    v_Prec: 0.695294  v_Recall: 0.676558  v_F1: 0.685798  v_AUC: 0.911774
steps 10200    running time 327 seconds

steps 10400    base_loss: 0.213487    reg_loss: 0.066600    l2_loss: 0.026582    loss: 0.306668
steps 10400    v_Prec: 0.731675  v_Recall: 0.655626  v_F1: 0.691566  v_AUC: 0.912516
steps 10400    running time 333 seconds

steps 10600    base_loss: 0.212234    reg_loss: 0.066105    l2_loss: 0.026652    loss: 0.304991
steps 10600    v_Prec: 0.707995  v_Recall: 0.692437  v_F1: 0.700130  v_AUC: 0.916021
steps 10600    running time 338 seconds

steps 10800    base_loss: 0.205673    reg_loss: 0.066435    l2_loss: 0.026881    loss: 0.298989
steps 10800    v_Prec: 0.677314  v_Recall: 0.697249  v_F1: 0.687137  v_AUC: 0.910810
steps 10800    running time 344 seconds

steps 11000    base_loss: 0.118627    reg_loss: 0.066539    l2_loss: 0.027192    loss: 0.212358
steps 11000    v_Prec: 0.647669  v_Recall: 0.690833  v_F1: 0.668555  v_AUC: 0.901624
steps 11000    running time 350 seconds

steps 11200    base_loss: 0.116616    reg_loss: 0.066661    l2_loss: 0.027302    loss: 0.210579
steps 11200    v_Prec: 0.661527  v_Recall: 0.667576  v_F1: 0.664538  v_AUC: 0.901795
steps 11200    running time 355 seconds

steps 11400    base_loss: 0.114097    reg_loss: 0.066241    l2_loss: 0.027383    loss: 0.207722
steps 11400    v_Prec: 0.649706  v_Recall: 0.663566  v_F1: 0.656562  v_AUC: 0.897941
steps 11400    running time 361 seconds

steps 11600    base_loss: 0.118472    reg_loss: 0.066187    l2_loss: 0.027512    loss: 0.212171
steps 11600    v_Prec: 0.638335  v_Recall: 0.667977  v_F1: 0.652820  v_AUC: 0.894519
steps 11600    running time 366 seconds

steps 11800    base_loss: 0.124854    reg_loss: 0.066244    l2_loss: 0.027533    loss: 0.218631
steps 11800    v_Prec: 0.620767  v_Recall: 0.689470  v_F1: 0.653317  v_AUC: 0.894283
steps 11800    running time 372 seconds

steps 12000    base_loss: 0.113462    reg_loss: 0.066122    l2_loss: 0.027632    loss: 0.207217
steps 12000    v_Prec: 0.620830  v_Recall: 0.683615  v_F1: 0.650712  v_AUC: 0.892601
steps 12000    running time 377 seconds

steps 12200    base_loss: 0.119641    reg_loss: 0.066227    l2_loss: 0.027713    loss: 0.213581
steps 12200    v_Prec: 0.627554  v_Recall: 0.682412  v_F1: 0.653834  v_AUC: 0.896030
steps 12200    running time 383 seconds

steps 12400    base_loss: 0.120492    reg_loss: 0.066040    l2_loss: 0.027967    loss: 0.214499
steps 12400    v_Prec: 0.627078  v_Recall: 0.686823  v_F1: 0.655592  v_AUC: 0.895695
steps 12400    running time 389 seconds

steps 12600    base_loss: 0.121542    reg_loss: 0.066361    l2_loss: 0.027939    loss: 0.215842
steps 12600    v_Prec: 0.606137  v_Recall: 0.693881  v_F1: 0.647048  v_AUC: 0.891498
steps 12600    running time 394 seconds

Early stop model F1: 0.700130
testing thre: 0.36737648
testing Prec: 0.5228765284278509
testing Recall: 0.7004131227217497
testing F1: 0.5987618414492272
testing AUC: 0.877034641086055
overall running time 397 seconds
(0.6348547717842323, 0.6023329283110571, 0.6181664006384677, 0.877034641086055, 0.5583452)

2019-02-24 15:20:10.918157: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:20:12.476293: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:20:12.492005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:20:12.492054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.280000 seconds
loading data in 30.350000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.586266    reg_loss: 0.064765    l2_loss: 0.013292    loss: 0.664322
steps 200    v_Prec: 0.164779  v_Recall: 1.000000  v_F1: 0.282936  v_AUC: 0.496130
steps 200    running time 40 seconds

steps 400    base_loss: 0.502972    reg_loss: 0.064858    l2_loss: 0.013425    loss: 0.581255
steps 400    v_Prec: 0.164781  v_Recall: 1.000000  v_F1: 0.282939  v_AUC: 0.504394
steps 400    running time 46 seconds

steps 600    base_loss: 0.466249    reg_loss: 0.065107    l2_loss: 0.013268    loss: 0.544623
steps 600    v_Prec: 0.164781  v_Recall: 1.000000  v_F1: 0.282939  v_AUC: 0.511741
steps 600    running time 52 seconds

steps 800    base_loss: 0.464359    reg_loss: 0.065085    l2_loss: 0.013203    loss: 0.542646
steps 800    v_Prec: 0.164818  v_Recall: 0.999842  v_F1: 0.282987  v_AUC: 0.518969
steps 800    running time 57 seconds

steps 1000    base_loss: 0.461477    reg_loss: 0.064908    l2_loss: 0.013059    loss: 0.539444
steps 1000    v_Prec: 0.164811  v_Recall: 0.999921  v_F1: 0.282980  v_AUC: 0.542866
steps 1000    running time 63 seconds

steps 1200    base_loss: 0.450706    reg_loss: 0.064493    l2_loss: 0.012888    loss: 0.528087
steps 1200    v_Prec: 0.205635  v_Recall: 0.509146  v_F1: 0.292952  v_AUC: 0.583259
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.444411    reg_loss: 0.064444    l2_loss: 0.012732    loss: 0.521587
steps 1400    v_Prec: 0.254771  v_Recall: 0.505266  v_F1: 0.338739  v_AUC: 0.651993
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.432160    reg_loss: 0.064505    l2_loss: 0.012625    loss: 0.509290
steps 1600    v_Prec: 0.326081  v_Recall: 0.492517  v_F1: 0.392380  v_AUC: 0.711873
steps 1600    running time 80 seconds

steps 1800    base_loss: 0.403952    reg_loss: 0.064833    l2_loss: 0.012644    loss: 0.481429
steps 1800    v_Prec: 0.393050  v_Recall: 0.490775  v_F1: 0.436510  v_AUC: 0.752543
steps 1800    running time 86 seconds

steps 2000    base_loss: 0.381190    reg_loss: 0.065059    l2_loss: 0.012736    loss: 0.458986
steps 2000    v_Prec: 0.456846  v_Recall: 0.514688  v_F1: 0.484045  v_AUC: 0.783862
steps 2000    running time 92 seconds

steps 2200    base_loss: 0.369011    reg_loss: 0.065534    l2_loss: 0.012833    loss: 0.447379
steps 2200    v_Prec: 0.500413  v_Recall: 0.528149  v_F1: 0.513907  v_AUC: 0.806638
steps 2200    running time 98 seconds

steps 2400    base_loss: 0.352224    reg_loss: 0.065961    l2_loss: 0.013024    loss: 0.431208
steps 2400    v_Prec: 0.528098  v_Recall: 0.552142  v_F1: 0.539852  v_AUC: 0.821876
steps 2400    running time 103 seconds

steps 2600    base_loss: 0.336193    reg_loss: 0.066008    l2_loss: 0.013196    loss: 0.415398
steps 2600    v_Prec: 0.554295  v_Recall: 0.564653  v_F1: 0.559426  v_AUC: 0.834413
steps 2600    running time 109 seconds

steps 2800    base_loss: 0.329389    reg_loss: 0.065998    l2_loss: 0.013428    loss: 0.408815
steps 2800    v_Prec: 0.568131  v_Recall: 0.580727  v_F1: 0.574360  v_AUC: 0.845746
steps 2800    running time 115 seconds

steps 3000    base_loss: 0.325482    reg_loss: 0.066376    l2_loss: 0.013697    loss: 0.405555
steps 3000    v_Prec: 0.575733  v_Recall: 0.608283  v_F1: 0.591560  v_AUC: 0.854739
steps 3000    running time 121 seconds

steps 3200    base_loss: 0.309481    reg_loss: 0.066196    l2_loss: 0.014003    loss: 0.389679
steps 3200    v_Prec: 0.599854  v_Recall: 0.586745  v_F1: 0.593227  v_AUC: 0.859753
steps 3200    running time 127 seconds

steps 3400    base_loss: 0.309637    reg_loss: 0.066256    l2_loss: 0.014331    loss: 0.390224
steps 3400    v_Prec: 0.593576  v_Recall: 0.607253  v_F1: 0.600337  v_AUC: 0.862691
steps 3400    running time 132 seconds

steps 3600    base_loss: 0.308123    reg_loss: 0.066391    l2_loss: 0.014649    loss: 0.389164
steps 3600    v_Prec: 0.602258  v_Recall: 0.616755  v_F1: 0.609420  v_AUC: 0.866872
steps 3600    running time 138 seconds

steps 3800    base_loss: 0.303774    reg_loss: 0.066582    l2_loss: 0.015016    loss: 0.385372
steps 3800    v_Prec: 0.596632  v_Recall: 0.631166  v_F1: 0.613413  v_AUC: 0.871376
steps 3800    running time 144 seconds

steps 4000    base_loss: 0.300629    reg_loss: 0.066332    l2_loss: 0.015400    loss: 0.382361
steps 4000    v_Prec: 0.616179  v_Recall: 0.613984  v_F1: 0.615080  v_AUC: 0.872015
steps 4000    running time 150 seconds

steps 4200    base_loss: 0.300002    reg_loss: 0.066401    l2_loss: 0.015811    loss: 0.382214
steps 4200    v_Prec: 0.616719  v_Recall: 0.622140  v_F1: 0.619417  v_AUC: 0.877737
steps 4200    running time 156 seconds

steps 4400    base_loss: 0.295341    reg_loss: 0.066586    l2_loss: 0.016192    loss: 0.378119
steps 4400    v_Prec: 0.609566  v_Recall: 0.638768  v_F1: 0.623826  v_AUC: 0.878702
steps 4400    running time 161 seconds

steps 4600    base_loss: 0.292463    reg_loss: 0.066379    l2_loss: 0.016648    loss: 0.375491
steps 4600    v_Prec: 0.630160  v_Recall: 0.627366  v_F1: 0.628760  v_AUC: 0.881132
steps 4600    running time 167 seconds

steps 4800    base_loss: 0.290852    reg_loss: 0.066302    l2_loss: 0.017175    loss: 0.374329
steps 4800    v_Prec: 0.627880  v_Recall: 0.649458  v_F1: 0.638487  v_AUC: 0.884910
steps 4800    running time 173 seconds

steps 5000    base_loss: 0.283933    reg_loss: 0.066342    l2_loss: 0.017725    loss: 0.367999
steps 5000    v_Prec: 0.624024  v_Recall: 0.645815  v_F1: 0.634733  v_AUC: 0.885691
steps 5000    running time 179 seconds

steps 5200    base_loss: 0.283514    reg_loss: 0.065991    l2_loss: 0.018307    loss: 0.367812
steps 5200    v_Prec: 0.633143  v_Recall: 0.642569  v_F1: 0.637821  v_AUC: 0.886939
steps 5200    running time 184 seconds

steps 5400    base_loss: 0.275230    reg_loss: 0.066350    l2_loss: 0.018931    loss: 0.360511
steps 5400    v_Prec: 0.610995  v_Recall: 0.674083  v_F1: 0.640991  v_AUC: 0.887658
steps 5400    running time 190 seconds

steps 5600    base_loss: 0.204650    reg_loss: 0.066715    l2_loss: 0.019753    loss: 0.291118
steps 5600    v_Prec: 0.639951  v_Recall: 0.621506  v_F1: 0.630594  v_AUC: 0.880878
steps 5600    running time 196 seconds

steps 5800    base_loss: 0.224407    reg_loss: 0.067111    l2_loss: 0.020260    loss: 0.311778
steps 5800    v_Prec: 0.637085  v_Recall: 0.629266  v_F1: 0.633151  v_AUC: 0.883339
steps 5800    running time 202 seconds

steps 6000    base_loss: 0.215491    reg_loss: 0.067038    l2_loss: 0.020924    loss: 0.303454
steps 6000    v_Prec: 0.649011  v_Recall: 0.620952  v_F1: 0.634671  v_AUC: 0.884567
steps 6000    running time 207 seconds

steps 6200    base_loss: 0.209330    reg_loss: 0.066994    l2_loss: 0.021438    loss: 0.297762
steps 6200    v_Prec: 0.648454  v_Recall: 0.625861  v_F1: 0.636957  v_AUC: 0.884261
steps 6200    running time 213 seconds

steps 6400    base_loss: 0.218270    reg_loss: 0.066787    l2_loss: 0.021887    loss: 0.306945
steps 6400    v_Prec: 0.642329  v_Recall: 0.632512  v_F1: 0.637383  v_AUC: 0.885239
steps 6400    running time 218 seconds

steps 6600    base_loss: 0.221647    reg_loss: 0.066997    l2_loss: 0.022314    loss: 0.310958
steps 6600    v_Prec: 0.645868  v_Recall: 0.639322  v_F1: 0.642579  v_AUC: 0.886578
steps 6600    running time 224 seconds

steps 6800    base_loss: 0.222592    reg_loss: 0.066969    l2_loss: 0.022791    loss: 0.312351
steps 6800    v_Prec: 0.615519  v_Recall: 0.668303  v_F1: 0.640826  v_AUC: 0.885017
steps 6800    running time 230 seconds

steps 7000    base_loss: 0.218847    reg_loss: 0.066790    l2_loss: 0.023041    loss: 0.308678
steps 7000    v_Prec: 0.661025  v_Recall: 0.630929  v_F1: 0.645627  v_AUC: 0.889646
steps 7000    running time 236 seconds

steps 7200    base_loss: 0.221970    reg_loss: 0.066881    l2_loss: 0.023409    loss: 0.312260
steps 7200    v_Prec: 0.643954  v_Recall: 0.654050  v_F1: 0.648963  v_AUC: 0.891641
steps 7200    running time 241 seconds

steps 7400    base_loss: 0.221058    reg_loss: 0.066558    l2_loss: 0.023627    loss: 0.311243
steps 7400    v_Prec: 0.650947  v_Recall: 0.655792  v_F1: 0.653361  v_AUC: 0.893911
steps 7400    running time 247 seconds

steps 7600    base_loss: 0.222838    reg_loss: 0.067027    l2_loss: 0.023962    loss: 0.313828
steps 7600    v_Prec: 0.654830  v_Recall: 0.652704  v_F1: 0.653765  v_AUC: 0.894537
steps 7600    running time 253 seconds

steps 7800    base_loss: 0.224274    reg_loss: 0.066655    l2_loss: 0.024158    loss: 0.315087
steps 7800    v_Prec: 0.664289  v_Recall: 0.648824  v_F1: 0.656465  v_AUC: 0.896259
steps 7800    running time 259 seconds

steps 8000    base_loss: 0.226224    reg_loss: 0.066556    l2_loss: 0.024492    loss: 0.317272
steps 8000    v_Prec: 0.679280  v_Recall: 0.642490  v_F1: 0.660373  v_AUC: 0.896248
steps 8000    running time 264 seconds

steps 8200    base_loss: 0.210793    reg_loss: 0.066127    l2_loss: 0.024655    loss: 0.301575
steps 8200    v_Prec: 0.664109  v_Recall: 0.657851  v_F1: 0.660965  v_AUC: 0.898753
steps 8200    running time 270 seconds

steps 8400    base_loss: 0.221091    reg_loss: 0.066655    l2_loss: 0.025013    loss: 0.312759
steps 8400    v_Prec: 0.670980  v_Recall: 0.665136  v_F1: 0.668045  v_AUC: 0.901411
steps 8400    running time 276 seconds

steps 8600    base_loss: 0.211746    reg_loss: 0.066408    l2_loss: 0.025174    loss: 0.303328
steps 8600    v_Prec: 0.654169  v_Recall: 0.678359  v_F1: 0.666045  v_AUC: 0.902001
steps 8600    running time 282 seconds

steps 8800    base_loss: 0.219439    reg_loss: 0.066500    l2_loss: 0.025424    loss: 0.311363
steps 8800    v_Prec: 0.665650  v_Recall: 0.674083  v_F1: 0.669840  v_AUC: 0.902727
steps 8800    running time 288 seconds

steps 9000    base_loss: 0.226035    reg_loss: 0.066404    l2_loss: 0.025679    loss: 0.318118
steps 9000    v_Prec: 0.684929  v_Recall: 0.663235  v_F1: 0.673908  v_AUC: 0.904482
steps 9000    running time 293 seconds

steps 9200    base_loss: 0.218899    reg_loss: 0.066409    l2_loss: 0.025845    loss: 0.311154
steps 9200    v_Prec: 0.698551  v_Recall: 0.664423  v_F1: 0.681060  v_AUC: 0.907154
steps 9200    running time 299 seconds

steps 9400    base_loss: 0.219746    reg_loss: 0.066132    l2_loss: 0.025917    loss: 0.311796
steps 9400    v_Prec: 0.703162  v_Recall: 0.655000  v_F1: 0.678227  v_AUC: 0.905507
steps 9400    running time 305 seconds

steps 9600    base_loss: 0.221491    reg_loss: 0.065795    l2_loss: 0.026181    loss: 0.313467
steps 9600    v_Prec: 0.692333  v_Recall: 0.672817  v_F1: 0.682435  v_AUC: 0.908939
steps 9600    running time 311 seconds

steps 9800    base_loss: 0.210543    reg_loss: 0.066068    l2_loss: 0.026309    loss: 0.302920
steps 9800    v_Prec: 0.717677  v_Recall: 0.658405  v_F1: 0.686764  v_AUC: 0.910533
steps 9800    running time 317 seconds

steps 10000    base_loss: 0.214288    reg_loss: 0.065878    l2_loss: 0.026454    loss: 0.306620
steps 10000    v_Prec: 0.708745  v_Recall: 0.669966  v_F1: 0.688810  v_AUC: 0.909111
steps 10000    running time 323 seconds

steps 10200    base_loss: 0.209542    reg_loss: 0.065992    l2_loss: 0.026657    loss: 0.302191
steps 10200    v_Prec: 0.702194  v_Recall: 0.674004  v_F1: 0.687811  v_AUC: 0.913172
steps 10200    running time 329 seconds

steps 10400    base_loss: 0.210147    reg_loss: 0.065946    l2_loss: 0.026804    loss: 0.302897
steps 10400    v_Prec: 0.690187  v_Recall: 0.687782  v_F1: 0.688982  v_AUC: 0.912522
steps 10400    running time 334 seconds

steps 10600    base_loss: 0.208733    reg_loss: 0.065813    l2_loss: 0.026845    loss: 0.301391
steps 10600    v_Prec: 0.701725  v_Recall: 0.686278  v_F1: 0.693915  v_AUC: 0.914061
steps 10600    running time 340 seconds

steps 10800    base_loss: 0.195617    reg_loss: 0.065796    l2_loss: 0.027142    loss: 0.288555
steps 10800    v_Prec: 0.730262  v_Recall: 0.657693  v_F1: 0.692080  v_AUC: 0.911616
steps 10800    running time 346 seconds

steps 11000    base_loss: 0.116685    reg_loss: 0.065079    l2_loss: 0.027368    loss: 0.209131
steps 11000    v_Prec: 0.644247  v_Recall: 0.694750  v_F1: 0.668546  v_AUC: 0.899737
steps 11000    running time 352 seconds

steps 11200    base_loss: 0.120159    reg_loss: 0.065470    l2_loss: 0.027424    loss: 0.213054
steps 11200    v_Prec: 0.642237  v_Recall: 0.696651  v_F1: 0.668338  v_AUC: 0.900278
steps 11200    running time 357 seconds

steps 11400    base_loss: 0.125068    reg_loss: 0.065445    l2_loss: 0.027627    loss: 0.218141
steps 11400    v_Prec: 0.686955  v_Recall: 0.655080  v_F1: 0.670639  v_AUC: 0.900397
steps 11400    running time 363 seconds

steps 11600    base_loss: 0.115296    reg_loss: 0.065328    l2_loss: 0.027822    loss: 0.208445
steps 11600    v_Prec: 0.659422  v_Recall: 0.663077  v_F1: 0.661244  v_AUC: 0.897156
steps 11600    running time 369 seconds

steps 11800    base_loss: 0.119749    reg_loss: 0.065208    l2_loss: 0.027821    loss: 0.212778
steps 11800    v_Prec: 0.670147  v_Recall: 0.650566  v_F1: 0.660211  v_AUC: 0.895573
steps 11800    running time 374 seconds

steps 12000    base_loss: 0.127057    reg_loss: 0.065246    l2_loss: 0.027981    loss: 0.220283
steps 12000    v_Prec: 0.662391  v_Recall: 0.662444  v_F1: 0.662417  v_AUC: 0.896984
steps 12000    running time 380 seconds

steps 12200    base_loss: 0.122323    reg_loss: 0.065332    l2_loss: 0.028090    loss: 0.215744
steps 12200    v_Prec: 0.654901  v_Recall: 0.665532  v_F1: 0.660174  v_AUC: 0.895751
steps 12200    running time 385 seconds

steps 12400    base_loss: 0.125445    reg_loss: 0.065294    l2_loss: 0.028184    loss: 0.218922
steps 12400    v_Prec: 0.648025  v_Recall: 0.671629  v_F1: 0.659616  v_AUC: 0.896493
steps 12400    running time 391 seconds

steps 12600    base_loss: 0.126662    reg_loss: 0.065430    l2_loss: 0.028174    loss: 0.220266
steps 12600    v_Prec: 0.660923  v_Recall: 0.659039  v_F1: 0.659979  v_AUC: 0.895530
steps 12600    running time 397 seconds

Early stop model F1: 0.693915
testing thre: 0.32968098
testing Prec: 0.5150727285503478
testing Recall: 0.7125151883353584
testing F1: 0.597915859453066
testing AUC: 0.8804755882961812
overall running time 400 seconds
(0.6436278342455043, 0.6001458080194411, 0.6211267605633803, 0.8804755882961812, 0.5634534)

2019-02-24 15:24:08.417185: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:24:08.928566: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:24:08.930343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:24:08.930381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.580000 seconds
loading data in 30.830000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.645810    reg_loss: 0.064769    l2_loss: 0.013330    loss: 0.723908
steps 200    v_Prec: 0.163696  v_Recall: 0.999043  v_F1: 0.281299  v_AUC: 0.506531
steps 200    running time 40 seconds

steps 400    base_loss: 0.501600    reg_loss: 0.064472    l2_loss: 0.013334    loss: 0.579405
steps 400    v_Prec: 0.165168  v_Recall: 0.950786  v_F1: 0.281444  v_AUC: 0.527789
steps 400    running time 46 seconds

steps 600    base_loss: 0.475388    reg_loss: 0.063877    l2_loss: 0.013200    loss: 0.552465
steps 600    v_Prec: 0.172624  v_Recall: 0.835128  v_F1: 0.286109  v_AUC: 0.557231
steps 600    running time 52 seconds

steps 800    base_loss: 0.459755    reg_loss: 0.063082    l2_loss: 0.013008    loss: 0.535845
steps 800    v_Prec: 0.188008  v_Recall: 0.665550  v_F1: 0.293194  v_AUC: 0.579222
steps 800    running time 58 seconds

steps 1000    base_loss: 0.461375    reg_loss: 0.062420    l2_loss: 0.012846    loss: 0.536641
steps 1000    v_Prec: 0.232639  v_Recall: 0.531467  v_F1: 0.323619  v_AUC: 0.630395
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.442146    reg_loss: 0.060904    l2_loss: 0.012752    loss: 0.515802
steps 1200    v_Prec: 0.299378  v_Recall: 0.460397  v_F1: 0.362825  v_AUC: 0.681728
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.415734    reg_loss: 0.059591    l2_loss: 0.012711    loss: 0.488036
steps 1400    v_Prec: 0.351009  v_Recall: 0.481535  v_F1: 0.406040  v_AUC: 0.722097
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.400454    reg_loss: 0.058646    l2_loss: 0.012776    loss: 0.471877
steps 1600    v_Prec: 0.446976  v_Recall: 0.475712  v_F1: 0.460896  v_AUC: 0.760617
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.380531    reg_loss: 0.057727    l2_loss: 0.012859    loss: 0.451116
steps 1800    v_Prec: 0.531618  v_Recall: 0.479461  v_F1: 0.504194  v_AUC: 0.789645
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.357935    reg_loss: 0.056972    l2_loss: 0.013063    loss: 0.427971
steps 2000    v_Prec: 0.553213  v_Recall: 0.517030  v_F1: 0.534510  v_AUC: 0.809407
steps 2000    running time 93 seconds

steps 2200    base_loss: 0.343945    reg_loss: 0.056077    l2_loss: 0.013269    loss: 0.413291
steps 2200    v_Prec: 0.571055  v_Recall: 0.539762  v_F1: 0.554968  v_AUC: 0.822417
steps 2200    running time 99 seconds

steps 2400    base_loss: 0.340620    reg_loss: 0.055536    l2_loss: 0.013444    loss: 0.409600
steps 2400    v_Prec: 0.633862  v_Recall: 0.532743  v_F1: 0.578920  v_AUC: 0.835549
steps 2400    running time 105 seconds

steps 2600    base_loss: 0.331555    reg_loss: 0.055040    l2_loss: 0.013647    loss: 0.400242
steps 2600    v_Prec: 0.655221  v_Recall: 0.552525  v_F1: 0.599507  v_AUC: 0.844421
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.309655    reg_loss: 0.054088    l2_loss: 0.013829    loss: 0.377572
steps 2800    v_Prec: 0.631405  v_Recall: 0.592726  v_F1: 0.611454  v_AUC: 0.852759
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.306156    reg_loss: 0.053644    l2_loss: 0.014006    loss: 0.373806
steps 3000    v_Prec: 0.679731  v_Recall: 0.581000  v_F1: 0.626500  v_AUC: 0.858190
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.309948    reg_loss: 0.053143    l2_loss: 0.014200    loss: 0.377290
steps 3200    v_Prec: 0.648372  v_Recall: 0.616256  v_F1: 0.631906  v_AUC: 0.864461
steps 3200    running time 128 seconds

steps 3400    base_loss: 0.298903    reg_loss: 0.052731    l2_loss: 0.014399    loss: 0.366033
steps 3400    v_Prec: 0.655544  v_Recall: 0.620563  v_F1: 0.637574  v_AUC: 0.870011
steps 3400    running time 134 seconds

steps 3600    base_loss: 0.307994    reg_loss: 0.052693    l2_loss: 0.014675    loss: 0.375362
steps 3600    v_Prec: 0.687215  v_Recall: 0.613544  v_F1: 0.648293  v_AUC: 0.874768
steps 3600    running time 140 seconds

steps 3800    base_loss: 0.286837    reg_loss: 0.051906    l2_loss: 0.014842    loss: 0.353586
steps 3800    v_Prec: 0.679356  v_Recall: 0.626306  v_F1: 0.651753  v_AUC: 0.876100
steps 3800    running time 146 seconds

steps 4000    base_loss: 0.297107    reg_loss: 0.051964    l2_loss: 0.015132    loss: 0.364204
steps 4000    v_Prec: 0.703000  v_Recall: 0.622477  v_F1: 0.660293  v_AUC: 0.880106
steps 4000    running time 152 seconds

steps 4200    base_loss: 0.283535    reg_loss: 0.051521    l2_loss: 0.015352    loss: 0.350407
steps 4200    v_Prec: 0.679306  v_Recall: 0.643057  v_F1: 0.660684  v_AUC: 0.881986
steps 4200    running time 158 seconds

steps 4400    base_loss: 0.282206    reg_loss: 0.051428    l2_loss: 0.015613    loss: 0.349246
steps 4400    v_Prec: 0.711037  v_Recall: 0.625907  v_F1: 0.665762  v_AUC: 0.886157
steps 4400    running time 164 seconds

steps 4600    base_loss: 0.286551    reg_loss: 0.051215    l2_loss: 0.015934    loss: 0.353700
steps 4600    v_Prec: 0.698238  v_Recall: 0.648002  v_F1: 0.672183  v_AUC: 0.888999
steps 4600    running time 170 seconds

steps 4800    base_loss: 0.285168    reg_loss: 0.050971    l2_loss: 0.016253    loss: 0.352391
steps 4800    v_Prec: 0.702601  v_Recall: 0.655021  v_F1: 0.677977  v_AUC: 0.891763
steps 4800    running time 176 seconds

steps 5000    base_loss: 0.272116    reg_loss: 0.050772    l2_loss: 0.016642    loss: 0.339531
steps 5000    v_Prec: 0.708176  v_Recall: 0.656377  v_F1: 0.681293  v_AUC: 0.892720
steps 5000    running time 182 seconds

steps 5200    base_loss: 0.280748    reg_loss: 0.050640    l2_loss: 0.017044    loss: 0.348432
steps 5200    v_Prec: 0.708978  v_Recall: 0.654463  v_F1: 0.680630  v_AUC: 0.893086
steps 5200    running time 187 seconds

steps 5400    base_loss: 0.275430    reg_loss: 0.049967    l2_loss: 0.017413    loss: 0.342810
steps 5400    v_Prec: 0.695999  v_Recall: 0.674404  v_F1: 0.685031  v_AUC: 0.894584
steps 5400    running time 193 seconds

steps 5600    base_loss: 0.207107    reg_loss: 0.046603    l2_loss: 0.017887    loss: 0.271597
steps 5600    v_Prec: 0.706082  v_Recall: 0.662998  v_F1: 0.683862  v_AUC: 0.891560
steps 5600    running time 199 seconds

steps 5800    base_loss: 0.203281    reg_loss: 0.046315    l2_loss: 0.018682    loss: 0.268277
steps 5800    v_Prec: 0.722987  v_Recall: 0.649517  v_F1: 0.684286  v_AUC: 0.889590
steps 5800    running time 205 seconds

steps 6000    base_loss: 0.205106    reg_loss: 0.046242    l2_loss: 0.019302    loss: 0.270650
steps 6000    v_Prec: 0.706039  v_Recall: 0.656537  v_F1: 0.680389  v_AUC: 0.888830
steps 6000    running time 210 seconds

steps 6200    base_loss: 0.217620    reg_loss: 0.046165    l2_loss: 0.019885    loss: 0.283670
steps 6200    v_Prec: 0.720330  v_Recall: 0.647763  v_F1: 0.682122  v_AUC: 0.891815
steps 6200    running time 216 seconds

steps 6400    base_loss: 0.208202    reg_loss: 0.045486    l2_loss: 0.020318    loss: 0.274006
steps 6400    v_Prec: 0.698010  v_Recall: 0.671453  v_F1: 0.684474  v_AUC: 0.890709
steps 6400    running time 222 seconds

steps 6600    base_loss: 0.209497    reg_loss: 0.045240    l2_loss: 0.020688    loss: 0.275425
steps 6600    v_Prec: 0.712128  v_Recall: 0.669299  v_F1: 0.690049  v_AUC: 0.893598
steps 6600    running time 227 seconds

steps 6800    base_loss: 0.210976    reg_loss: 0.044521    l2_loss: 0.020913    loss: 0.276409
steps 6800    v_Prec: 0.720334  v_Recall: 0.660924  v_F1: 0.689351  v_AUC: 0.891941
steps 6800    running time 233 seconds

steps 7000    base_loss: 0.217515    reg_loss: 0.045161    l2_loss: 0.021153    loss: 0.283830
steps 7000    v_Prec: 0.720475  v_Recall: 0.667145  v_F1: 0.692786  v_AUC: 0.894274
steps 7000    running time 239 seconds

steps 7200    base_loss: 0.214029    reg_loss: 0.045041    l2_loss: 0.021461    loss: 0.280531
steps 7200    v_Prec: 0.739301  v_Recall: 0.647603  v_F1: 0.690421  v_AUC: 0.895536
steps 7200    running time 245 seconds

steps 7400    base_loss: 0.212024    reg_loss: 0.044297    l2_loss: 0.021643    loss: 0.277964
steps 7400    v_Prec: 0.702337  v_Recall: 0.687884  v_F1: 0.695035  v_AUC: 0.897283
steps 7400    running time 250 seconds

steps 7600    base_loss: 0.220959    reg_loss: 0.044491    l2_loss: 0.021796    loss: 0.287247
steps 7600    v_Prec: 0.745398  v_Recall: 0.655739  v_F1: 0.697700  v_AUC: 0.898914
steps 7600    running time 256 seconds

steps 7800    base_loss: 0.217983    reg_loss: 0.044145    l2_loss: 0.021853    loss: 0.283981
steps 7800    v_Prec: 0.724682  v_Recall: 0.681503  v_F1: 0.702429  v_AUC: 0.899010
steps 7800    running time 262 seconds

steps 8000    base_loss: 0.216543    reg_loss: 0.044152    l2_loss: 0.021986    loss: 0.282681
steps 8000    v_Prec: 0.703796  v_Recall: 0.699529  v_F1: 0.701656  v_AUC: 0.900693
steps 8000    running time 268 seconds

steps 8200    base_loss: 0.221857    reg_loss: 0.043771    l2_loss: 0.022128    loss: 0.287756
steps 8200    v_Prec: 0.723851  v_Recall: 0.687246  v_F1: 0.705074  v_AUC: 0.902793
steps 8200    running time 274 seconds

steps 8400    base_loss: 0.220253    reg_loss: 0.043755    l2_loss: 0.022263    loss: 0.286271
steps 8400    v_Prec: 0.721937  v_Recall: 0.694584  v_F1: 0.707996  v_AUC: 0.902551
steps 8400    running time 280 seconds

steps 8600    base_loss: 0.224042    reg_loss: 0.043552    l2_loss: 0.022275    loss: 0.289869
steps 8600    v_Prec: 0.727120  v_Recall: 0.688203  v_F1: 0.707126  v_AUC: 0.903377
steps 8600    running time 285 seconds

steps 8800    base_loss: 0.220892    reg_loss: 0.043505    l2_loss: 0.022246    loss: 0.286643
steps 8800    v_Prec: 0.741771  v_Recall: 0.683018  v_F1: 0.711183  v_AUC: 0.906580
steps 8800    running time 291 seconds

steps 9000    base_loss: 0.217096    reg_loss: 0.043139    l2_loss: 0.022387    loss: 0.282622
steps 9000    v_Prec: 0.736356  v_Recall: 0.693069  v_F1: 0.714057  v_AUC: 0.906339
steps 9000    running time 297 seconds

steps 9200    base_loss: 0.213107    reg_loss: 0.042804    l2_loss: 0.022510    loss: 0.278421
steps 9200    v_Prec: 0.727446  v_Recall: 0.700407  v_F1: 0.713670  v_AUC: 0.905387
steps 9200    running time 303 seconds

steps 9400    base_loss: 0.221773    reg_loss: 0.043104    l2_loss: 0.022585    loss: 0.287461
steps 9400    v_Prec: 0.724305  v_Recall: 0.702640  v_F1: 0.713308  v_AUC: 0.905965
steps 9400    running time 309 seconds

steps 9600    base_loss: 0.217544    reg_loss: 0.042696    l2_loss: 0.022565    loss: 0.282805
steps 9600    v_Prec: 0.738952  v_Recall: 0.689559  v_F1: 0.713402  v_AUC: 0.908880
steps 9600    running time 314 seconds

steps 9800    base_loss: 0.213930    reg_loss: 0.042600    l2_loss: 0.022754    loss: 0.279285
steps 9800    v_Prec: 0.744052  v_Recall: 0.690995  v_F1: 0.716543  v_AUC: 0.910505
steps 9800    running time 320 seconds

steps 10000    base_loss: 0.209651    reg_loss: 0.042177    l2_loss: 0.022730    loss: 0.274558
steps 10000    v_Prec: 0.746685  v_Recall: 0.687246  v_F1: 0.715734  v_AUC: 0.910939
steps 10000    running time 326 seconds

steps 10200    base_loss: 0.224611    reg_loss: 0.042603    l2_loss: 0.022822    loss: 0.290036
steps 10200    v_Prec: 0.738977  v_Recall: 0.700487  v_F1: 0.719217  v_AUC: 0.912933
steps 10200    running time 332 seconds

steps 10400    base_loss: 0.217924    reg_loss: 0.042070    l2_loss: 0.022825    loss: 0.282819
steps 10400    v_Prec: 0.744303  v_Recall: 0.706070  v_F1: 0.724683  v_AUC: 0.915178
steps 10400    running time 337 seconds

steps 10600    base_loss: 0.211697    reg_loss: 0.041987    l2_loss: 0.022798    loss: 0.276483
steps 10600    v_Prec: 0.746882  v_Recall: 0.707027  v_F1: 0.726409  v_AUC: 0.914288
steps 10600    running time 343 seconds

steps 10800    base_loss: 0.202791    reg_loss: 0.041523    l2_loss: 0.022903    loss: 0.267218
steps 10800    v_Prec: 0.758621  v_Recall: 0.701922  v_F1: 0.729171  v_AUC: 0.913989
steps 10800    running time 349 seconds

steps 11000    base_loss: 0.118858    reg_loss: 0.037240    l2_loss: 0.023096    loss: 0.179194
steps 11000    v_Prec: 0.741351  v_Recall: 0.692271  v_F1: 0.715971  v_AUC: 0.909938
steps 11000    running time 355 seconds

steps 11200    base_loss: 0.120525    reg_loss: 0.037587    l2_loss: 0.023158    loss: 0.181271
steps 11200    v_Prec: 0.745314  v_Recall: 0.691393  v_F1: 0.717342  v_AUC: 0.909662
steps 11200    running time 361 seconds

steps 11400    base_loss: 0.119324    reg_loss: 0.037779    l2_loss: 0.023181    loss: 0.180284
steps 11400    v_Prec: 0.744008  v_Recall: 0.683417  v_F1: 0.712427  v_AUC: 0.907217
steps 11400    running time 367 seconds

steps 11600    base_loss: 0.114879    reg_loss: 0.037632    l2_loss: 0.023239    loss: 0.175750
steps 11600    v_Prec: 0.736056  v_Recall: 0.684215  v_F1: 0.709189  v_AUC: 0.906130
steps 11600    running time 372 seconds

steps 11800    base_loss: 0.125897    reg_loss: 0.037813    l2_loss: 0.023243    loss: 0.186952
steps 11800    v_Prec: 0.750000  v_Recall: 0.677674  v_F1: 0.712005  v_AUC: 0.904238
steps 11800    running time 378 seconds

steps 12000    base_loss: 0.120178    reg_loss: 0.038082    l2_loss: 0.023263    loss: 0.181522
steps 12000    v_Prec: 0.747338  v_Recall: 0.677355  v_F1: 0.710628  v_AUC: 0.903396
steps 12000    running time 383 seconds

steps 12200    base_loss: 0.129284    reg_loss: 0.037953    l2_loss: 0.023407    loss: 0.190644
steps 12200    v_Prec: 0.730964  v_Recall: 0.690676  v_F1: 0.710249  v_AUC: 0.905256
steps 12200    running time 389 seconds

steps 12400    base_loss: 0.127415    reg_loss: 0.037668    l2_loss: 0.023523    loss: 0.188606
steps 12400    v_Prec: 0.717379  v_Recall: 0.708224  v_F1: 0.712772  v_AUC: 0.907073
steps 12400    running time 395 seconds

steps 12600    base_loss: 0.128696    reg_loss: 0.037641    l2_loss: 0.023573    loss: 0.189910
steps 12600    v_Prec: 0.737125  v_Recall: 0.679269  v_F1: 0.707015  v_AUC: 0.906044
steps 12600    running time 401 seconds

steps 12800    base_loss: 0.130949    reg_loss: 0.037771    l2_loss: 0.023549    loss: 0.192269
steps 12800    v_Prec: 0.735741  v_Recall: 0.687326  v_F1: 0.710710  v_AUC: 0.904799
steps 12800    running time 407 seconds

Early stop model F1: 0.729171
testing thre: 0.519985
testing Prec: 0.5611011552979753
testing Recall: 0.7152369380315917
testing F1: 0.628862014443827
testing AUC: 0.8837777263683615
overall running time 409 seconds
(0.6734371711218691, 0.6220170109356015, 0.6467065868263473, 0.8837777263683615, 0.7954456)

2019-02-24 15:28:09.540355: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:28:11.422454: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:28:11.426135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:28:11.426185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.910000 seconds
loading data in 31.060000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.625274    reg_loss: 0.064826    l2_loss: 0.013254    loss: 0.703355
steps 200    v_Prec: 0.162034  v_Recall: 1.000000  v_F1: 0.278881  v_AUC: 0.483674
steps 200    running time 41 seconds

steps 400    base_loss: 0.523099    reg_loss: 0.064883    l2_loss: 0.013237    loss: 0.601218
steps 400    v_Prec: 0.162085  v_Recall: 0.998550  v_F1: 0.278899  v_AUC: 0.498156
steps 400    running time 47 seconds

steps 600    base_loss: 0.486228    reg_loss: 0.064829    l2_loss: 0.013071    loss: 0.564129
steps 600    v_Prec: 0.162774  v_Recall: 0.985505  v_F1: 0.279400  v_AUC: 0.513994
steps 600    running time 53 seconds

steps 800    base_loss: 0.457759    reg_loss: 0.064689    l2_loss: 0.012894    loss: 0.535342
steps 800    v_Prec: 0.168302  v_Recall: 0.853519  v_F1: 0.281163  v_AUC: 0.538240
steps 800    running time 59 seconds

steps 1000    base_loss: 0.455777    reg_loss: 0.064431    l2_loss: 0.012798    loss: 0.533006
steps 1000    v_Prec: 0.207561  v_Recall: 0.590272  v_F1: 0.307125  v_AUC: 0.613362
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.441784    reg_loss: 0.064311    l2_loss: 0.012643    loss: 0.518738
steps 1200    v_Prec: 0.324321  v_Recall: 0.453052  v_F1: 0.378028  v_AUC: 0.701588
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.418605    reg_loss: 0.064324    l2_loss: 0.012631    loss: 0.495560
steps 1400    v_Prec: 0.398618  v_Recall: 0.496940  v_F1: 0.442381  v_AUC: 0.754968
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.396082    reg_loss: 0.064731    l2_loss: 0.012655    loss: 0.473467
steps 1600    v_Prec: 0.468426  v_Recall: 0.505959  v_F1: 0.486470  v_AUC: 0.787153
steps 1600    running time 84 seconds

steps 1800    base_loss: 0.378934    reg_loss: 0.065241    l2_loss: 0.012812    loss: 0.456986
steps 1800    v_Prec: 0.528895  v_Recall: 0.523273  v_F1: 0.526069  v_AUC: 0.810790
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.352441    reg_loss: 0.065669    l2_loss: 0.012992    loss: 0.431102
steps 2000    v_Prec: 0.567164  v_Recall: 0.538573  v_F1: 0.552499  v_AUC: 0.826906
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.340863    reg_loss: 0.066053    l2_loss: 0.013210    loss: 0.420126
steps 2200    v_Prec: 0.599642  v_Recall: 0.540103  v_F1: 0.568318  v_AUC: 0.839142
steps 2200    running time 102 seconds

steps 2400    base_loss: 0.327770    reg_loss: 0.066141    l2_loss: 0.013407    loss: 0.407319
steps 2400    v_Prec: 0.602131  v_Recall: 0.573522  v_F1: 0.587478  v_AUC: 0.848956
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.324572    reg_loss: 0.066626    l2_loss: 0.013727    loss: 0.404925
steps 2600    v_Prec: 0.616276  v_Recall: 0.590916  v_F1: 0.603330  v_AUC: 0.858136
steps 2600    running time 114 seconds

steps 2800    base_loss: 0.311687    reg_loss: 0.066772    l2_loss: 0.013955    loss: 0.392413
steps 2800    v_Prec: 0.630346  v_Recall: 0.595829  v_F1: 0.612601  v_AUC: 0.866120
steps 2800    running time 121 seconds

steps 3000    base_loss: 0.302536    reg_loss: 0.066755    l2_loss: 0.014232    loss: 0.383523
steps 3000    v_Prec: 0.643202  v_Recall: 0.601144  v_F1: 0.621462  v_AUC: 0.870862
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.310391    reg_loss: 0.067331    l2_loss: 0.014551    loss: 0.392273
steps 3200    v_Prec: 0.627380  v_Recall: 0.626268  v_F1: 0.626824  v_AUC: 0.877054
steps 3200    running time 133 seconds

steps 3400    base_loss: 0.298335    reg_loss: 0.067059    l2_loss: 0.014907    loss: 0.380301
steps 3400    v_Prec: 0.648161  v_Recall: 0.615800  v_F1: 0.631566  v_AUC: 0.881125
steps 3400    running time 139 seconds

steps 3600    base_loss: 0.298882    reg_loss: 0.066941    l2_loss: 0.015280    loss: 0.381103
steps 3600    v_Prec: 0.651147  v_Recall: 0.623933  v_F1: 0.637250  v_AUC: 0.884800
steps 3600    running time 145 seconds

steps 3800    base_loss: 0.293514    reg_loss: 0.066932    l2_loss: 0.015619    loss: 0.376065
steps 3800    v_Prec: 0.643869  v_Recall: 0.636818  v_F1: 0.640324  v_AUC: 0.886451
steps 3800    running time 151 seconds

steps 4000    base_loss: 0.279439    reg_loss: 0.066891    l2_loss: 0.016010    loss: 0.362340
steps 4000    v_Prec: 0.620338  v_Recall: 0.656305  v_F1: 0.637815  v_AUC: 0.886937
steps 4000    running time 157 seconds

steps 4200    base_loss: 0.281821    reg_loss: 0.066854    l2_loss: 0.016464    loss: 0.365138
steps 4200    v_Prec: 0.667069  v_Recall: 0.622806  v_F1: 0.644178  v_AUC: 0.889437
steps 4200    running time 163 seconds

steps 4400    base_loss: 0.281887    reg_loss: 0.066996    l2_loss: 0.016960    loss: 0.365843
steps 4400    v_Prec: 0.643252  v_Recall: 0.645998  v_F1: 0.644622  v_AUC: 0.890075
steps 4400    running time 169 seconds

steps 4600    base_loss: 0.285904    reg_loss: 0.066853    l2_loss: 0.017448    loss: 0.370205
steps 4600    v_Prec: 0.656610  v_Recall: 0.637945  v_F1: 0.647143  v_AUC: 0.892745
steps 4600    running time 175 seconds

steps 4800    base_loss: 0.279460    reg_loss: 0.066933    l2_loss: 0.018010    loss: 0.364404
steps 4800    v_Prec: 0.677500  v_Recall: 0.612740  v_F1: 0.643494  v_AUC: 0.891556
steps 4800    running time 182 seconds

steps 5000    base_loss: 0.279111    reg_loss: 0.066991    l2_loss: 0.018633    loss: 0.364735
steps 5000    v_Prec: 0.649358  v_Recall: 0.651554  v_F1: 0.650454  v_AUC: 0.893062
steps 5000    running time 187 seconds

steps 5200    base_loss: 0.277912    reg_loss: 0.066915    l2_loss: 0.019161    loss: 0.363988
steps 5200    v_Prec: 0.648258  v_Recall: 0.657916  v_F1: 0.653051  v_AUC: 0.895128
steps 5200    running time 194 seconds

steps 5400    base_loss: 0.269058    reg_loss: 0.066761    l2_loss: 0.019777    loss: 0.355596
steps 5400    v_Prec: 0.681489  v_Recall: 0.628201  v_F1: 0.653761  v_AUC: 0.895585
steps 5400    running time 200 seconds

steps 5600    base_loss: 0.191334    reg_loss: 0.067298    l2_loss: 0.020757    loss: 0.279389
steps 5600    v_Prec: 0.664349  v_Recall: 0.638670  v_F1: 0.651256  v_AUC: 0.892814
steps 5600    running time 206 seconds

steps 5800    base_loss: 0.189961    reg_loss: 0.067572    l2_loss: 0.021431    loss: 0.278963
steps 5800    v_Prec: 0.651763  v_Recall: 0.632711  v_F1: 0.642095  v_AUC: 0.889807
steps 5800    running time 212 seconds

steps 6000    base_loss: 0.190747    reg_loss: 0.067656    l2_loss: 0.022148    loss: 0.280552
steps 6000    v_Prec: 0.632135  v_Recall: 0.655500  v_F1: 0.643605  v_AUC: 0.888892
steps 6000    running time 217 seconds

steps 6200    base_loss: 0.198632    reg_loss: 0.067607    l2_loss: 0.022660    loss: 0.288899
steps 6200    v_Prec: 0.659082  v_Recall: 0.646078  v_F1: 0.652515  v_AUC: 0.891994
steps 6200    running time 223 seconds

steps 6400    base_loss: 0.196515    reg_loss: 0.067635    l2_loss: 0.023165    loss: 0.287315
steps 6400    v_Prec: 0.666779  v_Recall: 0.638911  v_F1: 0.652548  v_AUC: 0.891810
steps 6400    running time 229 seconds

steps 6600    base_loss: 0.206173    reg_loss: 0.067585    l2_loss: 0.023656    loss: 0.297413
steps 6600    v_Prec: 0.646309  v_Recall: 0.653648  v_F1: 0.649958  v_AUC: 0.891037
steps 6600    running time 235 seconds

steps 6800    base_loss: 0.207136    reg_loss: 0.067356    l2_loss: 0.024089    loss: 0.298581
steps 6800    v_Prec: 0.662574  v_Recall: 0.656225  v_F1: 0.659384  v_AUC: 0.895206
steps 6800    running time 241 seconds

steps 7000    base_loss: 0.196098    reg_loss: 0.067499    l2_loss: 0.024509    loss: 0.288106
steps 7000    v_Prec: 0.672453  v_Recall: 0.645756  v_F1: 0.658834  v_AUC: 0.895766
steps 7000    running time 247 seconds

steps 7200    base_loss: 0.201274    reg_loss: 0.067680    l2_loss: 0.024873    loss: 0.293827
steps 7200    v_Prec: 0.688056  v_Recall: 0.641569  v_F1: 0.664000  v_AUC: 0.896344
steps 7200    running time 252 seconds

steps 7400    base_loss: 0.202763    reg_loss: 0.067490    l2_loss: 0.025278    loss: 0.295531
steps 7400    v_Prec: 0.665987  v_Recall: 0.657674  v_F1: 0.661805  v_AUC: 0.896663
steps 7400    running time 259 seconds

steps 7600    base_loss: 0.197437    reg_loss: 0.067640    l2_loss: 0.025785    loss: 0.290862
steps 7600    v_Prec: 0.666186  v_Recall: 0.669351  v_F1: 0.667765  v_AUC: 0.898021
steps 7600    running time 264 seconds

steps 7800    base_loss: 0.210243    reg_loss: 0.067542    l2_loss: 0.026101    loss: 0.303885
steps 7800    v_Prec: 0.660525  v_Recall: 0.678451  v_F1: 0.669368  v_AUC: 0.898415
steps 7800    running time 271 seconds

steps 8000    base_loss: 0.208175    reg_loss: 0.067654    l2_loss: 0.026308    loss: 0.302137
steps 8000    v_Prec: 0.675449  v_Recall: 0.668868  v_F1: 0.672142  v_AUC: 0.901211
steps 8000    running time 277 seconds

steps 8200    base_loss: 0.206992    reg_loss: 0.067482    l2_loss: 0.026661    loss: 0.301135
steps 8200    v_Prec: 0.674542  v_Recall: 0.664439  v_F1: 0.669452  v_AUC: 0.900815
steps 8200    running time 283 seconds

steps 8400    base_loss: 0.200608    reg_loss: 0.067394    l2_loss: 0.026893    loss: 0.294895
steps 8400    v_Prec: 0.672337  v_Recall: 0.677967  v_F1: 0.675140  v_AUC: 0.902954
steps 8400    running time 289 seconds

steps 8600    base_loss: 0.204261    reg_loss: 0.067526    l2_loss: 0.027242    loss: 0.299029
steps 8600    v_Prec: 0.674241  v_Recall: 0.681028  v_F1: 0.677617  v_AUC: 0.905099
steps 8600    running time 295 seconds

steps 8800    base_loss: 0.211720    reg_loss: 0.067397    l2_loss: 0.027473    loss: 0.306590
steps 8800    v_Prec: 0.696105  v_Recall: 0.672169  v_F1: 0.683928  v_AUC: 0.906046
steps 8800    running time 301 seconds

steps 9000    base_loss: 0.200780    reg_loss: 0.067260    l2_loss: 0.027730    loss: 0.295770
steps 9000    v_Prec: 0.715559  v_Recall: 0.659204  v_F1: 0.686227  v_AUC: 0.907975
steps 9000    running time 307 seconds

steps 9200    base_loss: 0.201395    reg_loss: 0.067254    l2_loss: 0.028058    loss: 0.296707
steps 9200    v_Prec: 0.715143  v_Recall: 0.662103  v_F1: 0.687602  v_AUC: 0.909550
steps 9200    running time 313 seconds

steps 9400    base_loss: 0.201141    reg_loss: 0.067122    l2_loss: 0.028249    loss: 0.296511
steps 9400    v_Prec: 0.720658  v_Recall: 0.663553  v_F1: 0.690927  v_AUC: 0.909820
steps 9400    running time 319 seconds

steps 9600    base_loss: 0.199544    reg_loss: 0.067087    l2_loss: 0.028486    loss: 0.295116
steps 9600    v_Prec: 0.713994  v_Recall: 0.674666  v_F1: 0.693773  v_AUC: 0.910573
steps 9600    running time 325 seconds

steps 9800    base_loss: 0.198360    reg_loss: 0.066961    l2_loss: 0.028580    loss: 0.293900
steps 9800    v_Prec: 0.721108  v_Recall: 0.674827  v_F1: 0.697200  v_AUC: 0.913211
steps 9800    running time 331 seconds

steps 10000    base_loss: 0.199079    reg_loss: 0.066840    l2_loss: 0.028783    loss: 0.294702
steps 10000    v_Prec: 0.698170  v_Recall: 0.691255  v_F1: 0.694695  v_AUC: 0.913550
steps 10000    running time 338 seconds

steps 10200    base_loss: 0.195963    reg_loss: 0.066618    l2_loss: 0.028938    loss: 0.291519
steps 10200    v_Prec: 0.715091  v_Recall: 0.684571  v_F1: 0.699498  v_AUC: 0.915469
steps 10200    running time 343 seconds

steps 10400    base_loss: 0.194197    reg_loss: 0.066974    l2_loss: 0.029158    loss: 0.290329
steps 10400    v_Prec: 0.746888  v_Recall: 0.666774  v_F1: 0.704561  v_AUC: 0.917415
steps 10400    running time 349 seconds

steps 10600    base_loss: 0.191397    reg_loss: 0.066837    l2_loss: 0.029256    loss: 0.287490
steps 10600    v_Prec: 0.740201  v_Recall: 0.675230  v_F1: 0.706224  v_AUC: 0.919055
steps 10600    running time 356 seconds

steps 10800    base_loss: 0.184832    reg_loss: 0.066680    l2_loss: 0.029444    loss: 0.280956
steps 10800    v_Prec: 0.715487  v_Recall: 0.685296  v_F1: 0.700066  v_AUC: 0.916451
steps 10800    running time 362 seconds

steps 11000    base_loss: 0.090371    reg_loss: 0.066277    l2_loss: 0.029709    loss: 0.186358
steps 11000    v_Prec: 0.667466  v_Recall: 0.694878  v_F1: 0.680896  v_AUC: 0.908627
steps 11000    running time 368 seconds

steps 11200    base_loss: 0.097072    reg_loss: 0.066196    l2_loss: 0.029776    loss: 0.193044
steps 11200    v_Prec: 0.690236  v_Recall: 0.650105  v_F1: 0.669570  v_AUC: 0.900691
steps 11200    running time 373 seconds

steps 11400    base_loss: 0.090353    reg_loss: 0.065864    l2_loss: 0.029924    loss: 0.186141
steps 11400    v_Prec: 0.684456  v_Recall: 0.662023  v_F1: 0.673053  v_AUC: 0.902091
steps 11400    running time 379 seconds

steps 11600    base_loss: 0.100876    reg_loss: 0.066364    l2_loss: 0.030052    loss: 0.197292
steps 11600    v_Prec: 0.673996  v_Recall: 0.666452  v_F1: 0.670203  v_AUC: 0.900416
steps 11600    running time 385 seconds

steps 11800    base_loss: 0.101016    reg_loss: 0.065976    l2_loss: 0.030190    loss: 0.197182
steps 11800    v_Prec: 0.670238  v_Recall: 0.670076  v_F1: 0.670157  v_AUC: 0.899107
steps 11800    running time 391 seconds

steps 12000    base_loss: 0.096420    reg_loss: 0.065799    l2_loss: 0.030274    loss: 0.192493
steps 12000    v_Prec: 0.668839  v_Recall: 0.669431  v_F1: 0.669135  v_AUC: 0.898659
steps 12000    running time 397 seconds

steps 12200    base_loss: 0.106026    reg_loss: 0.065912    l2_loss: 0.030391    loss: 0.202329
steps 12200    v_Prec: 0.681134  v_Recall: 0.659688  v_F1: 0.670239  v_AUC: 0.898172
steps 12200    running time 402 seconds

steps 12400    base_loss: 0.101850    reg_loss: 0.065834    l2_loss: 0.030625    loss: 0.198308
steps 12400    v_Prec: 0.661017  v_Recall: 0.665808  v_F1: 0.663404  v_AUC: 0.895481
steps 12400    running time 408 seconds

steps 12600    base_loss: 0.101379    reg_loss: 0.065779    l2_loss: 0.030676    loss: 0.197835
steps 12600    v_Prec: 0.664731  v_Recall: 0.663714  v_F1: 0.664222  v_AUC: 0.895261
steps 12600    running time 414 seconds

Early stop model F1: 0.706224
testing thre: 0.36001423
testing Prec: 0.5473198544581567
testing Recall: 0.7091616038882138
testing F1: 0.6178176737096158
testing AUC: 0.8896835869323372
overall running time 417 seconds
(0.65466297322253, 0.6202673147023087, 0.6370011729766154, 0.8896835869323372, 0.56659853)

2019-02-24 15:32:24.721666: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:32:25.928885: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:32:25.931724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:32:25.931778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.390000 seconds
loading data in 31.360000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.505426    reg_loss: 0.064967    l2_loss: 0.013295    loss: 0.583689
steps 200    v_Prec: 0.164671  v_Recall: 0.998890  v_F1: 0.282733  v_AUC: 0.503889
steps 200    running time 41 seconds

steps 400    base_loss: 0.492498    reg_loss: 0.064809    l2_loss: 0.013258    loss: 0.570565
steps 400    v_Prec: 0.164557  v_Recall: 1.000000  v_F1: 0.282609  v_AUC: 0.480172
steps 400    running time 47 seconds

steps 600    base_loss: 0.463343    reg_loss: 0.064486    l2_loss: 0.013101    loss: 0.540930
steps 600    v_Prec: 0.164957  v_Recall: 0.994370  v_F1: 0.282971  v_AUC: 0.507552
steps 600    running time 53 seconds

steps 800    base_loss: 0.457801    reg_loss: 0.064127    l2_loss: 0.012946    loss: 0.534875
steps 800    v_Prec: 0.169875  v_Recall: 0.885744  v_F1: 0.285076  v_AUC: 0.540970
steps 800    running time 59 seconds

steps 1000    base_loss: 0.456724    reg_loss: 0.063852    l2_loss: 0.012825    loss: 0.533402
steps 1000    v_Prec: 0.195332  v_Recall: 0.660324  v_F1: 0.301482  v_AUC: 0.597433
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.445354    reg_loss: 0.063251    l2_loss: 0.012710    loss: 0.521314
steps 1200    v_Prec: 0.270229  v_Recall: 0.488820  v_F1: 0.348049  v_AUC: 0.663165
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.429986    reg_loss: 0.062799    l2_loss: 0.012576    loss: 0.505361
steps 1400    v_Prec: 0.322835  v_Recall: 0.499841  v_F1: 0.392296  v_AUC: 0.715022
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.416860    reg_loss: 0.063141    l2_loss: 0.012580    loss: 0.492580
steps 1600    v_Prec: 0.391424  v_Recall: 0.496511  v_F1: 0.437749  v_AUC: 0.756352
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.387108    reg_loss: 0.063638    l2_loss: 0.012743    loss: 0.463489
steps 1800    v_Prec: 0.463117  v_Recall: 0.506264  v_F1: 0.483730  v_AUC: 0.790169
steps 1800    running time 89 seconds

steps 2000    base_loss: 0.370485    reg_loss: 0.064313    l2_loss: 0.012959    loss: 0.447757
steps 2000    v_Prec: 0.498603  v_Recall: 0.551697  v_F1: 0.523808  v_AUC: 0.815353
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.345514    reg_loss: 0.064693    l2_loss: 0.013213    loss: 0.423419
steps 2200    v_Prec: 0.566675  v_Recall: 0.533381  v_F1: 0.549524  v_AUC: 0.827892
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.348687    reg_loss: 0.065331    l2_loss: 0.013429    loss: 0.427447
steps 2400    v_Prec: 0.574436  v_Recall: 0.569061  v_F1: 0.571736  v_AUC: 0.841176
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.328614    reg_loss: 0.065634    l2_loss: 0.013655    loss: 0.407903
steps 2600    v_Prec: 0.580234  v_Recall: 0.588884  v_F1: 0.584527  v_AUC: 0.849418
steps 2600    running time 114 seconds

steps 2800    base_loss: 0.315042    reg_loss: 0.065915    l2_loss: 0.013921    loss: 0.394878
steps 2800    v_Prec: 0.597939  v_Recall: 0.593482  v_F1: 0.595702  v_AUC: 0.856367
steps 2800    running time 120 seconds

steps 3000    base_loss: 0.317397    reg_loss: 0.066248    l2_loss: 0.014248    loss: 0.397894
steps 3000    v_Prec: 0.617356  v_Recall: 0.597923  v_F1: 0.607484  v_AUC: 0.864211
steps 3000    running time 126 seconds

steps 3200    base_loss: 0.315543    reg_loss: 0.066876    l2_loss: 0.014486    loss: 0.396905
steps 3200    v_Prec: 0.627353  v_Recall: 0.607755  v_F1: 0.617398  v_AUC: 0.870185
steps 3200    running time 132 seconds

steps 3400    base_loss: 0.304405    reg_loss: 0.066598    l2_loss: 0.014796    loss: 0.385798
steps 3400    v_Prec: 0.642554  v_Recall: 0.612750  v_F1: 0.627298  v_AUC: 0.875271
steps 3400    running time 138 seconds

steps 3600    base_loss: 0.298728    reg_loss: 0.066610    l2_loss: 0.015127    loss: 0.380465
steps 3600    v_Prec: 0.644721  v_Recall: 0.625040  v_F1: 0.634728  v_AUC: 0.877095
steps 3600    running time 144 seconds

steps 3800    base_loss: 0.294834    reg_loss: 0.066872    l2_loss: 0.015565    loss: 0.377271
steps 3800    v_Prec: 0.621435  v_Recall: 0.647796  v_F1: 0.634341  v_AUC: 0.880715
steps 3800    running time 150 seconds

steps 4000    base_loss: 0.292765    reg_loss: 0.066779    l2_loss: 0.016068    loss: 0.375612
steps 4000    v_Prec: 0.646135  v_Recall: 0.632969  v_F1: 0.639484  v_AUC: 0.883284
steps 4000    running time 156 seconds

steps 4200    base_loss: 0.289351    reg_loss: 0.066946    l2_loss: 0.016498    loss: 0.372794
steps 4200    v_Prec: 0.661659  v_Recall: 0.628608  v_F1: 0.644710  v_AUC: 0.886217
steps 4200    running time 162 seconds

steps 4400    base_loss: 0.287940    reg_loss: 0.067177    l2_loss: 0.016956    loss: 0.372073
steps 4400    v_Prec: 0.676967  v_Recall: 0.616635  v_F1: 0.645394  v_AUC: 0.888067
steps 4400    running time 169 seconds

steps 4600    base_loss: 0.285543    reg_loss: 0.066969    l2_loss: 0.017563    loss: 0.370075
steps 4600    v_Prec: 0.682946  v_Recall: 0.619807  v_F1: 0.649846  v_AUC: 0.890326
steps 4600    running time 175 seconds

steps 4800    base_loss: 0.287548    reg_loss: 0.066910    l2_loss: 0.018013    loss: 0.372472
steps 4800    v_Prec: 0.646314  v_Recall: 0.655487  v_F1: 0.650868  v_AUC: 0.893066
steps 4800    running time 181 seconds

steps 5000    base_loss: 0.282759    reg_loss: 0.067050    l2_loss: 0.018676    loss: 0.368485
steps 5000    v_Prec: 0.671047  v_Recall: 0.635664  v_F1: 0.652877  v_AUC: 0.893832
steps 5000    running time 187 seconds

steps 5200    base_loss: 0.274894    reg_loss: 0.066875    l2_loss: 0.019227    loss: 0.360996
steps 5200    v_Prec: 0.667159  v_Recall: 0.644148  v_F1: 0.655452  v_AUC: 0.893372
steps 5200    running time 193 seconds

steps 5400    base_loss: 0.272363    reg_loss: 0.066808    l2_loss: 0.019951    loss: 0.359123
steps 5400    v_Prec: 0.675362  v_Recall: 0.640501  v_F1: 0.657470  v_AUC: 0.895011
steps 5400    running time 199 seconds

steps 5600    base_loss: 0.188127    reg_loss: 0.067694    l2_loss: 0.020810    loss: 0.276631
steps 5600    v_Prec: 0.669248  v_Recall: 0.637250  v_F1: 0.652857  v_AUC: 0.890339
steps 5600    running time 205 seconds

steps 5800    base_loss: 0.199407    reg_loss: 0.067522    l2_loss: 0.021545    loss: 0.288473
steps 5800    v_Prec: 0.662965  v_Recall: 0.638995  v_F1: 0.650759  v_AUC: 0.890033
steps 5800    running time 211 seconds

steps 6000    base_loss: 0.197841    reg_loss: 0.067624    l2_loss: 0.022265    loss: 0.287731
steps 6000    v_Prec: 0.668795  v_Recall: 0.631145  v_F1: 0.649425  v_AUC: 0.889606
steps 6000    running time 217 seconds

steps 6200    base_loss: 0.188008    reg_loss: 0.067811    l2_loss: 0.022806    loss: 0.278625
steps 6200    v_Prec: 0.658501  v_Recall: 0.639391  v_F1: 0.648805  v_AUC: 0.890202
steps 6200    running time 222 seconds

steps 6400    base_loss: 0.206216    reg_loss: 0.067904    l2_loss: 0.023538    loss: 0.297658
steps 6400    v_Prec: 0.667828  v_Recall: 0.638440  v_F1: 0.652803  v_AUC: 0.891081
steps 6400    running time 228 seconds

steps 6600    base_loss: 0.200965    reg_loss: 0.067625    l2_loss: 0.024024    loss: 0.292614
steps 6600    v_Prec: 0.680499  v_Recall: 0.631938  v_F1: 0.655320  v_AUC: 0.892681
steps 6600    running time 234 seconds

steps 6800    base_loss: 0.214801    reg_loss: 0.067715    l2_loss: 0.024364    loss: 0.306880
steps 6800    v_Prec: 0.656125  v_Recall: 0.651443  v_F1: 0.653776  v_AUC: 0.892794
steps 6800    running time 240 seconds

steps 7000    base_loss: 0.203054    reg_loss: 0.067528    l2_loss: 0.024812    loss: 0.295394
steps 7000    v_Prec: 0.668919  v_Recall: 0.643514  v_F1: 0.655971  v_AUC: 0.893175
steps 7000    running time 246 seconds

steps 7200    base_loss: 0.206184    reg_loss: 0.067617    l2_loss: 0.025094    loss: 0.298894
steps 7200    v_Prec: 0.649926  v_Recall: 0.665953  v_F1: 0.657842  v_AUC: 0.895615
steps 7200    running time 252 seconds

steps 7400    base_loss: 0.196895    reg_loss: 0.067611    l2_loss: 0.025465    loss: 0.289971
steps 7400    v_Prec: 0.672930  v_Recall: 0.655963  v_F1: 0.664338  v_AUC: 0.896397
steps 7400    running time 258 seconds

steps 7600    base_loss: 0.203141    reg_loss: 0.067578    l2_loss: 0.025929    loss: 0.296647
steps 7600    v_Prec: 0.693315  v_Recall: 0.642245  v_F1: 0.666804  v_AUC: 0.898224
steps 7600    running time 264 seconds

steps 7800    base_loss: 0.208620    reg_loss: 0.067604    l2_loss: 0.026144    loss: 0.302367
steps 7800    v_Prec: 0.685705  v_Recall: 0.656835  v_F1: 0.670959  v_AUC: 0.900299
steps 7800    running time 270 seconds

steps 8000    base_loss: 0.216120    reg_loss: 0.067567    l2_loss: 0.026281    loss: 0.309968
steps 8000    v_Prec: 0.687516  v_Recall: 0.657152  v_F1: 0.671991  v_AUC: 0.901564
steps 8000    running time 276 seconds

steps 8200    base_loss: 0.205472    reg_loss: 0.067241    l2_loss: 0.026751    loss: 0.299464
steps 8200    v_Prec: 0.672285  v_Recall: 0.676816  v_F1: 0.674543  v_AUC: 0.902916
steps 8200    running time 282 seconds

steps 8400    base_loss: 0.206609    reg_loss: 0.067194    l2_loss: 0.026985    loss: 0.300788
steps 8400    v_Prec: 0.676522  v_Recall: 0.678560  v_F1: 0.677539  v_AUC: 0.904662
steps 8400    running time 288 seconds

steps 8600    base_loss: 0.209651    reg_loss: 0.067305    l2_loss: 0.027261    loss: 0.304217
steps 8600    v_Prec: 0.715063  v_Recall: 0.656835  v_F1: 0.684713  v_AUC: 0.907765
steps 8600    running time 294 seconds

steps 8800    base_loss: 0.202159    reg_loss: 0.066993    l2_loss: 0.027511    loss: 0.296663
steps 8800    v_Prec: 0.720329  v_Recall: 0.653505  v_F1: 0.685291  v_AUC: 0.908148
steps 8800    running time 300 seconds

steps 9000    base_loss: 0.204679    reg_loss: 0.066975    l2_loss: 0.027717    loss: 0.299371
steps 9000    v_Prec: 0.702781  v_Recall: 0.675309  v_F1: 0.688771  v_AUC: 0.911121
steps 9000    running time 306 seconds

steps 9200    base_loss: 0.193779    reg_loss: 0.067106    l2_loss: 0.028022    loss: 0.288907
steps 9200    v_Prec: 0.723103  v_Recall: 0.665081  v_F1: 0.692880  v_AUC: 0.911380
steps 9200    running time 312 seconds

steps 9400    base_loss: 0.201271    reg_loss: 0.067035    l2_loss: 0.028155    loss: 0.296461
steps 9400    v_Prec: 0.704642  v_Recall: 0.672851  v_F1: 0.688380  v_AUC: 0.910921
steps 9400    running time 318 seconds

steps 9600    base_loss: 0.202903    reg_loss: 0.066908    l2_loss: 0.028326    loss: 0.298136
steps 9600    v_Prec: 0.697132  v_Recall: 0.691881  v_F1: 0.694496  v_AUC: 0.914157
steps 9600    running time 324 seconds

steps 9800    base_loss: 0.209069    reg_loss: 0.066944    l2_loss: 0.028429    loss: 0.304441
steps 9800    v_Prec: 0.721902  v_Recall: 0.674278  v_F1: 0.697278  v_AUC: 0.914175
steps 9800    running time 330 seconds

steps 10000    base_loss: 0.204539    reg_loss: 0.067019    l2_loss: 0.028698    loss: 0.300257
steps 10000    v_Prec: 0.727265  v_Recall: 0.678481  v_F1: 0.702026  v_AUC: 0.916306
steps 10000    running time 336 seconds

steps 10200    base_loss: 0.204039    reg_loss: 0.066873    l2_loss: 0.028909    loss: 0.299822
steps 10200    v_Prec: 0.709942  v_Recall: 0.699810  v_F1: 0.704839  v_AUC: 0.919017
steps 10200    running time 342 seconds

steps 10400    base_loss: 0.196560    reg_loss: 0.066872    l2_loss: 0.029145    loss: 0.292577
steps 10400    v_Prec: 0.717060  v_Recall: 0.690850  v_F1: 0.703711  v_AUC: 0.918528
steps 10400    running time 348 seconds

steps 10600    base_loss: 0.198412    reg_loss: 0.066586    l2_loss: 0.029183    loss: 0.294181
steps 10600    v_Prec: 0.717649  v_Recall: 0.700920  v_F1: 0.709186  v_AUC: 0.919684
steps 10600    running time 354 seconds

steps 10800    base_loss: 0.192443    reg_loss: 0.066762    l2_loss: 0.029300    loss: 0.288506
steps 10800    v_Prec: 0.735043  v_Recall: 0.688709  v_F1: 0.711122  v_AUC: 0.920616
steps 10800    running time 360 seconds

steps 11000    base_loss: 0.100442    reg_loss: 0.066355    l2_loss: 0.029684    loss: 0.196481
steps 11000    v_Prec: 0.721939  v_Recall: 0.661434  v_F1: 0.690363  v_AUC: 0.909644
steps 11000    running time 366 seconds

steps 11200    base_loss: 0.094557    reg_loss: 0.066367    l2_loss: 0.029698    loss: 0.190622
steps 11200    v_Prec: 0.680359  v_Recall: 0.685538  v_F1: 0.682938  v_AUC: 0.907620
steps 11200    running time 372 seconds

steps 11400    base_loss: 0.094002    reg_loss: 0.066198    l2_loss: 0.029969    loss: 0.190169
steps 11400    v_Prec: 0.701052  v_Recall: 0.660641  v_F1: 0.680247  v_AUC: 0.904935
steps 11400    running time 378 seconds

steps 11600    base_loss: 0.096235    reg_loss: 0.066067    l2_loss: 0.030157    loss: 0.192459
steps 11600    v_Prec: 0.664552  v_Recall: 0.689423  v_F1: 0.676759  v_AUC: 0.903182
steps 11600    running time 383 seconds

steps 11800    base_loss: 0.097450    reg_loss: 0.066115    l2_loss: 0.030192    loss: 0.193758
steps 11800    v_Prec: 0.687871  v_Recall: 0.661037  v_F1: 0.674187  v_AUC: 0.900997
steps 11800    running time 389 seconds

steps 12000    base_loss: 0.104658    reg_loss: 0.066112    l2_loss: 0.030335    loss: 0.201104
steps 12000    v_Prec: 0.692477  v_Recall: 0.649540  v_F1: 0.670322  v_AUC: 0.899991
steps 12000    running time 395 seconds

steps 12200    base_loss: 0.104799    reg_loss: 0.065856    l2_loss: 0.030348    loss: 0.201003
steps 12200    v_Prec: 0.668592  v_Recall: 0.660799  v_F1: 0.664673  v_AUC: 0.898147
steps 12200    running time 401 seconds

steps 12400    base_loss: 0.100835    reg_loss: 0.066034    l2_loss: 0.030540    loss: 0.197409
steps 12400    v_Prec: 0.657531  v_Recall: 0.671503  v_F1: 0.664444  v_AUC: 0.899811
steps 12400    running time 406 seconds

steps 12600    base_loss: 0.110608    reg_loss: 0.065976    l2_loss: 0.030771    loss: 0.207354
steps 12600    v_Prec: 0.679383  v_Recall: 0.649540  v_F1: 0.664126  v_AUC: 0.899938
steps 12600    running time 412 seconds

steps 12800    base_loss: 0.111480    reg_loss: 0.065861    l2_loss: 0.030877    loss: 0.208217
steps 12800    v_Prec: 0.672236  v_Recall: 0.657152  v_F1: 0.664608  v_AUC: 0.898573
steps 12800    running time 418 seconds

Early stop model F1: 0.711122
testing thre: 0.40465748
testing Prec: 0.5351075079309129
testing Recall: 0.7378371810449574
testing F1: 0.6203289406476656
testing AUC: 0.8926381986914259
overall running time 421 seconds
(0.6789370391980056, 0.6221142162818954, 0.649284772243076, 0.8926381986914259, 0.7124651)

2019-02-24 15:36:41.227809: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:36:41.932973: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:36:41.935544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:36:41.935586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.890000 seconds
loading data in 29.940000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.702689    reg_loss: 0.064994    l2_loss: 0.013364    loss: 0.781047
steps 200    v_Prec: 0.164831  v_Recall: 1.000000  v_F1: 0.283013  v_AUC: 0.482227
steps 200    running time 39 seconds

steps 400    base_loss: 0.552164    reg_loss: 0.065301    l2_loss: 0.013354    loss: 0.630818
steps 400    v_Prec: 0.164838  v_Recall: 1.000000  v_F1: 0.283023  v_AUC: 0.498924
steps 400    running time 46 seconds

steps 600    base_loss: 0.503686    reg_loss: 0.065100    l2_loss: 0.013221    loss: 0.582007
steps 600    v_Prec: 0.164851  v_Recall: 0.999921  v_F1: 0.283038  v_AUC: 0.514313
steps 600    running time 52 seconds

steps 800    base_loss: 0.472107    reg_loss: 0.064858    l2_loss: 0.013097    loss: 0.550062
steps 800    v_Prec: 0.164831  v_Recall: 1.000000  v_F1: 0.283013  v_AUC: 0.527190
steps 800    running time 58 seconds

steps 1000    base_loss: 0.453532    reg_loss: 0.064962    l2_loss: 0.012989    loss: 0.531483
steps 1000    v_Prec: 0.205539  v_Recall: 0.477638  v_F1: 0.287402  v_AUC: 0.576317
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.442304    reg_loss: 0.065275    l2_loss: 0.012935    loss: 0.520514
steps 1200    v_Prec: 0.301675  v_Recall: 0.413362  v_F1: 0.348796  v_AUC: 0.651469
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.427556    reg_loss: 0.065619    l2_loss: 0.012941    loss: 0.506117
steps 1400    v_Prec: 0.383444  v_Recall: 0.442571  v_F1: 0.410891  v_AUC: 0.720376
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.396402    reg_loss: 0.065946    l2_loss: 0.012968    loss: 0.475317
steps 1600    v_Prec: 0.444954  v_Recall: 0.491411  v_F1: 0.467030  v_AUC: 0.766702
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.382376    reg_loss: 0.066322    l2_loss: 0.012972    loss: 0.461669
steps 1800    v_Prec: 0.499092  v_Recall: 0.522204  v_F1: 0.510386  v_AUC: 0.798107
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.360539    reg_loss: 0.066687    l2_loss: 0.013158    loss: 0.440384
steps 2000    v_Prec: 0.561720  v_Recall: 0.516900  v_F1: 0.538379  v_AUC: 0.818160
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.341750    reg_loss: 0.066788    l2_loss: 0.013353    loss: 0.421891
steps 2200    v_Prec: 0.615802  v_Recall: 0.521333  v_F1: 0.564643  v_AUC: 0.835628
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.328844    reg_loss: 0.067069    l2_loss: 0.013514    loss: 0.409427
steps 2400    v_Prec: 0.618137  v_Recall: 0.557904  v_F1: 0.586478  v_AUC: 0.846557
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.320001    reg_loss: 0.067305    l2_loss: 0.013745    loss: 0.401050
steps 2600    v_Prec: 0.622664  v_Recall: 0.582839  v_F1: 0.602093  v_AUC: 0.856672
steps 2600    running time 113 seconds

steps 2800    base_loss: 0.303684    reg_loss: 0.067404    l2_loss: 0.014014    loss: 0.385101
steps 2800    v_Prec: 0.624867  v_Recall: 0.605874  v_F1: 0.615224  v_AUC: 0.864948
steps 2800    running time 119 seconds

steps 3000    base_loss: 0.307332    reg_loss: 0.067767    l2_loss: 0.014256    loss: 0.389355
steps 3000    v_Prec: 0.631160  v_Recall: 0.608327  v_F1: 0.619533  v_AUC: 0.869543
steps 3000    running time 125 seconds

steps 3200    base_loss: 0.302731    reg_loss: 0.067583    l2_loss: 0.014534    loss: 0.384848
steps 3200    v_Prec: 0.641595  v_Recall: 0.612444  v_F1: 0.626681  v_AUC: 0.875097
steps 3200    running time 131 seconds

steps 3400    base_loss: 0.300389    reg_loss: 0.067758    l2_loss: 0.014869    loss: 0.383016
steps 3400    v_Prec: 0.656852  v_Recall: 0.618064  v_F1: 0.636868  v_AUC: 0.880325
steps 3400    running time 137 seconds

steps 3600    base_loss: 0.289770    reg_loss: 0.067634    l2_loss: 0.015252    loss: 0.372657
steps 3600    v_Prec: 0.657422  v_Recall: 0.611731  v_F1: 0.633754  v_AUC: 0.880920
steps 3600    running time 143 seconds

steps 3800    base_loss: 0.290860    reg_loss: 0.067590    l2_loss: 0.015655    loss: 0.374106
steps 3800    v_Prec: 0.673425  v_Recall: 0.615214  v_F1: 0.643005  v_AUC: 0.886301
steps 3800    running time 149 seconds

steps 4000    base_loss: 0.282501    reg_loss: 0.067744    l2_loss: 0.016059    loss: 0.366304
steps 4000    v_Prec: 0.659093  v_Recall: 0.636033  v_F1: 0.647357  v_AUC: 0.888470
steps 4000    running time 155 seconds

steps 4200    base_loss: 0.280552    reg_loss: 0.067481    l2_loss: 0.016491    loss: 0.364525
steps 4200    v_Prec: 0.668818  v_Recall: 0.631600  v_F1: 0.649676  v_AUC: 0.889281
steps 4200    running time 161 seconds

steps 4400    base_loss: 0.281386    reg_loss: 0.067518    l2_loss: 0.016960    loss: 0.365865
steps 4400    v_Prec: 0.658093  v_Recall: 0.642049  v_F1: 0.649972  v_AUC: 0.889179
steps 4400    running time 168 seconds

steps 4600    base_loss: 0.280265    reg_loss: 0.067270    l2_loss: 0.017510    loss: 0.365044
steps 4600    v_Prec: 0.634568  v_Recall: 0.658830  v_F1: 0.646472  v_AUC: 0.891323
steps 4600    running time 174 seconds

steps 4800    base_loss: 0.279941    reg_loss: 0.067270    l2_loss: 0.017917    loss: 0.365128
steps 4800    v_Prec: 0.676722  v_Recall: 0.646402  v_F1: 0.661215  v_AUC: 0.895641
steps 4800    running time 180 seconds

steps 5000    base_loss: 0.273172    reg_loss: 0.067251    l2_loss: 0.018433    loss: 0.358856
steps 5000    v_Prec: 0.661409  v_Recall: 0.657168  v_F1: 0.659281  v_AUC: 0.895393
steps 5000    running time 186 seconds

steps 5200    base_loss: 0.276710    reg_loss: 0.067000    l2_loss: 0.019008    loss: 0.362718
steps 5200    v_Prec: 0.692761  v_Recall: 0.633262  v_F1: 0.661677  v_AUC: 0.897702
steps 5200    running time 192 seconds

steps 5400    base_loss: 0.269804    reg_loss: 0.066820    l2_loss: 0.019599    loss: 0.356224
steps 5400    v_Prec: 0.644824  v_Recall: 0.678461  v_F1: 0.661215  v_AUC: 0.898559
steps 5400    running time 198 seconds

steps 5600    base_loss: 0.188849    reg_loss: 0.067302    l2_loss: 0.020429    loss: 0.276580
steps 5600    v_Prec: 0.665963  v_Recall: 0.649569  v_F1: 0.657664  v_AUC: 0.893499
steps 5600    running time 204 seconds

steps 5800    base_loss: 0.191476    reg_loss: 0.067563    l2_loss: 0.021187    loss: 0.280225
steps 5800    v_Prec: 0.647760  v_Recall: 0.662630  v_F1: 0.655110  v_AUC: 0.893184
steps 5800    running time 210 seconds

steps 6000    base_loss: 0.193806    reg_loss: 0.067696    l2_loss: 0.021827    loss: 0.283328
steps 6000    v_Prec: 0.647685  v_Recall: 0.668962  v_F1: 0.658152  v_AUC: 0.894380
steps 6000    running time 216 seconds

steps 6200    base_loss: 0.189818    reg_loss: 0.067327    l2_loss: 0.022462    loss: 0.279607
steps 6200    v_Prec: 0.668036  v_Recall: 0.643711  v_F1: 0.655648  v_AUC: 0.893656
steps 6200    running time 222 seconds

steps 6400    base_loss: 0.194547    reg_loss: 0.067614    l2_loss: 0.023043    loss: 0.285203
steps 6400    v_Prec: 0.644661  v_Recall: 0.664767  v_F1: 0.654560  v_AUC: 0.893546
steps 6400    running time 228 seconds

steps 6600    base_loss: 0.195152    reg_loss: 0.067898    l2_loss: 0.023581    loss: 0.286632
steps 6600    v_Prec: 0.662498  v_Recall: 0.645769  v_F1: 0.654027  v_AUC: 0.891751
steps 6600    running time 233 seconds

steps 6800    base_loss: 0.192091    reg_loss: 0.067248    l2_loss: 0.024053    loss: 0.283392
steps 6800    v_Prec: 0.644835  v_Recall: 0.681944  v_F1: 0.662871  v_AUC: 0.895566
steps 6800    running time 239 seconds

steps 7000    base_loss: 0.194222    reg_loss: 0.067468    l2_loss: 0.024533    loss: 0.286223
steps 7000    v_Prec: 0.678133  v_Recall: 0.655426  v_F1: 0.666586  v_AUC: 0.897268
steps 7000    running time 246 seconds

steps 7200    base_loss: 0.197434    reg_loss: 0.067548    l2_loss: 0.024870    loss: 0.289852
steps 7200    v_Prec: 0.674668  v_Recall: 0.651864  v_F1: 0.663070  v_AUC: 0.896062
steps 7200    running time 252 seconds

steps 7400    base_loss: 0.198933    reg_loss: 0.067528    l2_loss: 0.025214    loss: 0.291675
steps 7400    v_Prec: 0.694316  v_Recall: 0.644028  v_F1: 0.668227  v_AUC: 0.899135
steps 7400    running time 258 seconds

steps 7600    base_loss: 0.192486    reg_loss: 0.067294    l2_loss: 0.025566    loss: 0.285346
steps 7600    v_Prec: 0.692060  v_Recall: 0.646481  v_F1: 0.668495  v_AUC: 0.897771
steps 7600    running time 264 seconds

steps 7800    base_loss: 0.207519    reg_loss: 0.067395    l2_loss: 0.025897    loss: 0.300811
steps 7800    v_Prec: 0.694384  v_Recall: 0.651785  v_F1: 0.672410  v_AUC: 0.900291
steps 7800    running time 270 seconds

steps 8000    base_loss: 0.210055    reg_loss: 0.067321    l2_loss: 0.026235    loss: 0.303612
steps 8000    v_Prec: 0.696740  v_Recall: 0.654714  v_F1: 0.675073  v_AUC: 0.901657
steps 8000    running time 276 seconds

steps 8200    base_loss: 0.204413    reg_loss: 0.067140    l2_loss: 0.026425    loss: 0.297978
steps 8200    v_Prec: 0.709915  v_Recall: 0.657484  v_F1: 0.682694  v_AUC: 0.905302
steps 8200    running time 282 seconds

steps 8400    base_loss: 0.191888    reg_loss: 0.067080    l2_loss: 0.026776    loss: 0.285745
steps 8400    v_Prec: 0.713212  v_Recall: 0.653368  v_F1: 0.681980  v_AUC: 0.904247
steps 8400    running time 288 seconds

steps 8600    base_loss: 0.200759    reg_loss: 0.067122    l2_loss: 0.026989    loss: 0.294870
steps 8600    v_Prec: 0.678678  v_Recall: 0.682815  v_F1: 0.680740  v_AUC: 0.906722
steps 8600    running time 293 seconds

steps 8800    base_loss: 0.195882    reg_loss: 0.067280    l2_loss: 0.027234    loss: 0.290396
steps 8800    v_Prec: 0.716153  v_Recall: 0.663659  v_F1: 0.688907  v_AUC: 0.908736
steps 8800    running time 299 seconds

steps 9000    base_loss: 0.197619    reg_loss: 0.067301    l2_loss: 0.027614    loss: 0.292533
steps 9000    v_Prec: 0.683441  v_Recall: 0.692314  v_F1: 0.687849  v_AUC: 0.909127
steps 9000    running time 305 seconds

steps 9200    base_loss: 0.203063    reg_loss: 0.066956    l2_loss: 0.027761    loss: 0.297780
steps 9200    v_Prec: 0.701950  v_Recall: 0.684002  v_F1: 0.692860  v_AUC: 0.913214
steps 9200    running time 311 seconds

steps 9400    base_loss: 0.197966    reg_loss: 0.066900    l2_loss: 0.027924    loss: 0.292791
steps 9400    v_Prec: 0.705536  v_Recall: 0.693026  v_F1: 0.699225  v_AUC: 0.913760
steps 9400    running time 317 seconds

steps 9600    base_loss: 0.202747    reg_loss: 0.066762    l2_loss: 0.028168    loss: 0.297676
steps 9600    v_Prec: 0.726431  v_Recall: 0.677036  v_F1: 0.700865  v_AUC: 0.915913
steps 9600    running time 323 seconds

steps 9800    base_loss: 0.197620    reg_loss: 0.066766    l2_loss: 0.028281    loss: 0.292667
steps 9800    v_Prec: 0.729796  v_Recall: 0.682657  v_F1: 0.705440  v_AUC: 0.918497
steps 9800    running time 329 seconds

steps 10000    base_loss: 0.196457    reg_loss: 0.066742    l2_loss: 0.028451    loss: 0.291650
steps 10000    v_Prec: 0.724814  v_Recall: 0.685110  v_F1: 0.704403  v_AUC: 0.917398
steps 10000    running time 335 seconds

steps 10200    base_loss: 0.189889    reg_loss: 0.066577    l2_loss: 0.028615    loss: 0.285081
steps 10200    v_Prec: 0.727143  v_Recall: 0.684319  v_F1: 0.705081  v_AUC: 0.917764
steps 10200    running time 341 seconds

steps 10400    base_loss: 0.200817    reg_loss: 0.066557    l2_loss: 0.028865    loss: 0.296239
steps 10400    v_Prec: 0.740102  v_Recall: 0.686614  v_F1: 0.712356  v_AUC: 0.920953
steps 10400    running time 347 seconds

steps 10600    base_loss: 0.196160    reg_loss: 0.066622    l2_loss: 0.029040    loss: 0.291822
steps 10600    v_Prec: 0.737152  v_Recall: 0.693739  v_F1: 0.714787  v_AUC: 0.922322
steps 10600    running time 353 seconds

steps 10800    base_loss: 0.180197    reg_loss: 0.066465    l2_loss: 0.029226    loss: 0.275887
steps 10800    v_Prec: 0.741590  v_Recall: 0.685823  v_F1: 0.712617  v_AUC: 0.920987
steps 10800    running time 359 seconds

steps 11000    base_loss: 0.089840    reg_loss: 0.065755    l2_loss: 0.029468    loss: 0.185062
steps 11000    v_Prec: 0.706186  v_Recall: 0.682261  v_F1: 0.694017  v_AUC: 0.911084
steps 11000    running time 365 seconds

steps 11200    base_loss: 0.095809    reg_loss: 0.065294    l2_loss: 0.029501    loss: 0.190603
steps 11200    v_Prec: 0.702016  v_Recall: 0.675453  v_F1: 0.688478  v_AUC: 0.907865
steps 11200    running time 370 seconds

steps 11400    base_loss: 0.095543    reg_loss: 0.065296    l2_loss: 0.029746    loss: 0.190585
steps 11400    v_Prec: 0.683201  v_Recall: 0.682498  v_F1: 0.682850  v_AUC: 0.905864
steps 11400    running time 377 seconds

steps 11600    base_loss: 0.090565    reg_loss: 0.065144    l2_loss: 0.029968    loss: 0.185677
steps 11600    v_Prec: 0.673946  v_Recall: 0.674266  v_F1: 0.674106  v_AUC: 0.901579
steps 11600    running time 383 seconds

steps 11800    base_loss: 0.100843    reg_loss: 0.065350    l2_loss: 0.030085    loss: 0.196278
steps 11800    v_Prec: 0.693073  v_Recall: 0.662076  v_F1: 0.677220  v_AUC: 0.904154
steps 11800    running time 388 seconds

steps 12000    base_loss: 0.091340    reg_loss: 0.065435    l2_loss: 0.030217    loss: 0.186991
steps 12000    v_Prec: 0.704547  v_Recall: 0.648777  v_F1: 0.675513  v_AUC: 0.901800
steps 12000    running time 394 seconds

steps 12200    base_loss: 0.102037    reg_loss: 0.065385    l2_loss: 0.030260    loss: 0.197682
steps 12200    v_Prec: 0.681413  v_Recall: 0.671812  v_F1: 0.676578  v_AUC: 0.903642
steps 12200    running time 400 seconds

steps 12400    base_loss: 0.101623    reg_loss: 0.065131    l2_loss: 0.030409    loss: 0.197163
steps 12400    v_Prec: 0.687197  v_Recall: 0.661521  v_F1: 0.674115  v_AUC: 0.902341
steps 12400    running time 406 seconds

steps 12600    base_loss: 0.099269    reg_loss: 0.065333    l2_loss: 0.030502    loss: 0.195105
steps 12600    v_Prec: 0.673124  v_Recall: 0.676641  v_F1: 0.674878  v_AUC: 0.902031
steps 12600    running time 412 seconds

Early stop model F1: 0.714787
testing thre: 0.37624142
testing Prec: 0.5522820663340182
testing Recall: 0.7316160388821386
testing F1: 0.6294244318538187
testing AUC: 0.8947463318051289
overall running time 414 seconds
(0.6772808212003771, 0.6285297691373025, 0.6519952607829791, 0.8947463318051289, 0.6053644)

2019-02-24 15:40:54.352039: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:40:54.880849: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:40:54.884510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:40:54.884568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.510000 seconds
loading data in 30.540000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.459945    reg_loss: 0.064903    l2_loss: 0.013344    loss: 1.538192
steps 200    v_Prec: 0.163523  v_Recall: 0.998243  v_F1: 0.281013  v_AUC: 0.506207
steps 200    running time 40 seconds

steps 400    base_loss: 0.709381    reg_loss: 0.065009    l2_loss: 0.013372    loss: 0.787762
steps 400    v_Prec: 0.164391  v_Recall: 0.989380  v_F1: 0.281937  v_AUC: 0.515869
steps 400    running time 46 seconds

steps 600    base_loss: 0.473566    reg_loss: 0.064853    l2_loss: 0.013401    loss: 0.551820
steps 600    v_Prec: 0.166950  v_Recall: 0.941233  v_F1: 0.283597  v_AUC: 0.529931
steps 600    running time 52 seconds

steps 800    base_loss: 0.463993    reg_loss: 0.064635    l2_loss: 0.013236    loss: 0.541864
steps 800    v_Prec: 0.167352  v_Recall: 0.929495  v_F1: 0.283636  v_AUC: 0.537593
steps 800    running time 58 seconds

steps 1000    base_loss: 0.456016    reg_loss: 0.064340    l2_loss: 0.013017    loss: 0.533372
steps 1000    v_Prec: 0.173223  v_Recall: 0.826972  v_F1: 0.286445  v_AUC: 0.548002
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.460992    reg_loss: 0.063981    l2_loss: 0.012890    loss: 0.537863
steps 1200    v_Prec: 0.180820  v_Recall: 0.725487  v_F1: 0.289488  v_AUC: 0.571792
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.449088    reg_loss: 0.063474    l2_loss: 0.012750    loss: 0.525312
steps 1400    v_Prec: 0.194772  v_Recall: 0.619371  v_F1: 0.296351  v_AUC: 0.592510
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.445557    reg_loss: 0.063198    l2_loss: 0.012691    loss: 0.521446
steps 1600    v_Prec: 0.254836  v_Recall: 0.486985  v_F1: 0.334586  v_AUC: 0.645233
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.426778    reg_loss: 0.062453    l2_loss: 0.012685    loss: 0.501916
steps 1800    v_Prec: 0.352558  v_Recall: 0.419275  v_F1: 0.383033  v_AUC: 0.687346
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.411169    reg_loss: 0.061921    l2_loss: 0.012801    loss: 0.485891
steps 2000    v_Prec: 0.436870  v_Recall: 0.425743  v_F1: 0.431235  v_AUC: 0.726333
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.394921    reg_loss: 0.061332    l2_loss: 0.013002    loss: 0.469255
steps 2200    v_Prec: 0.489317  v_Recall: 0.446183  v_F1: 0.466756  v_AUC: 0.753040
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.377405    reg_loss: 0.060765    l2_loss: 0.013206    loss: 0.451375
steps 2400    v_Prec: 0.497581  v_Recall: 0.509103  v_F1: 0.503276  v_AUC: 0.778688
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.365664    reg_loss: 0.060300    l2_loss: 0.013353    loss: 0.439317
steps 2600    v_Prec: 0.543411  v_Recall: 0.503753  v_F1: 0.522831  v_AUC: 0.790610
steps 2600    running time 113 seconds

steps 2800    base_loss: 0.358435    reg_loss: 0.059846    l2_loss: 0.013480    loss: 0.431761
steps 2800    v_Prec: 0.563351  v_Recall: 0.521878  v_F1: 0.541822  v_AUC: 0.804634
steps 2800    running time 119 seconds

steps 3000    base_loss: 0.351562    reg_loss: 0.059298    l2_loss: 0.013482    loss: 0.424341
steps 3000    v_Prec: 0.545656  v_Recall: 0.569227  v_F1: 0.557193  v_AUC: 0.818485
steps 3000    running time 125 seconds

steps 3200    base_loss: 0.347356    reg_loss: 0.058937    l2_loss: 0.013587    loss: 0.419880
steps 3200    v_Prec: 0.577969  v_Recall: 0.551341  v_F1: 0.564341  v_AUC: 0.823570
steps 3200    running time 131 seconds

steps 3400    base_loss: 0.335895    reg_loss: 0.058485    l2_loss: 0.013705    loss: 0.408085
steps 3400    v_Prec: 0.574914  v_Recall: 0.558847  v_F1: 0.566767  v_AUC: 0.826681
steps 3400    running time 137 seconds

steps 3600    base_loss: 0.339764    reg_loss: 0.058228    l2_loss: 0.013769    loss: 0.411761
steps 3600    v_Prec: 0.581337  v_Recall: 0.571543  v_F1: 0.576398  v_AUC: 0.832145
steps 3600    running time 143 seconds

steps 3800    base_loss: 0.333779    reg_loss: 0.057922    l2_loss: 0.013850    loss: 0.405552
steps 3800    v_Prec: 0.600406  v_Recall: 0.566273  v_F1: 0.582840  v_AUC: 0.836158
steps 3800    running time 149 seconds

steps 4000    base_loss: 0.323433    reg_loss: 0.057941    l2_loss: 0.013978    loss: 0.395352
steps 4000    v_Prec: 0.573666  v_Recall: 0.608432  v_F1: 0.590537  v_AUC: 0.839059
steps 4000    running time 155 seconds

steps 4200    base_loss: 0.332621    reg_loss: 0.058248    l2_loss: 0.014247    loss: 0.405116
steps 4200    v_Prec: 0.582809  v_Recall: 0.606356  v_F1: 0.594349  v_AUC: 0.843129
steps 4200    running time 162 seconds

steps 4400    base_loss: 0.330770    reg_loss: 0.058551    l2_loss: 0.014750    loss: 0.404071
steps 4400    v_Prec: 0.607751  v_Recall: 0.601006  v_F1: 0.604360  v_AUC: 0.846855
steps 4400    running time 168 seconds

steps 4600    base_loss: 0.318081    reg_loss: 0.058694    l2_loss: 0.015261    loss: 0.392035
steps 4600    v_Prec: 0.639458  v_Recall: 0.583599  v_F1: 0.610253  v_AUC: 0.848524
steps 4600    running time 174 seconds

steps 4800    base_loss: 0.321373    reg_loss: 0.058923    l2_loss: 0.015901    loss: 0.396197
steps 4800    v_Prec: 0.626710  v_Recall: 0.607394  v_F1: 0.616900  v_AUC: 0.852726
steps 4800    running time 180 seconds

steps 5000    base_loss: 0.309543    reg_loss: 0.058696    l2_loss: 0.016357    loss: 0.384597
steps 5000    v_Prec: 0.636714  v_Recall: 0.605957  v_F1: 0.620955  v_AUC: 0.858366
steps 5000    running time 186 seconds

steps 5200    base_loss: 0.305371    reg_loss: 0.059151    l2_loss: 0.017080    loss: 0.381602
steps 5200    v_Prec: 0.650073  v_Recall: 0.605797  v_F1: 0.627154  v_AUC: 0.862006
steps 5200    running time 192 seconds

steps 5400    base_loss: 0.307700    reg_loss: 0.059121    l2_loss: 0.017751    loss: 0.384573
steps 5400    v_Prec: 0.639518  v_Recall: 0.618173  v_F1: 0.628664  v_AUC: 0.864202
steps 5400    running time 198 seconds

steps 5600    base_loss: 0.222423    reg_loss: 0.055249    l2_loss: 0.018138    loss: 0.295810
steps 5600    v_Prec: 0.638075  v_Recall: 0.614181  v_F1: 0.625900  v_AUC: 0.862714
steps 5600    running time 205 seconds

steps 5800    base_loss: 0.214959    reg_loss: 0.056154    l2_loss: 0.018460    loss: 0.289572
steps 5800    v_Prec: 0.649024  v_Recall: 0.605078  v_F1: 0.626281  v_AUC: 0.862368
steps 5800    running time 210 seconds

steps 6000    base_loss: 0.226158    reg_loss: 0.056785    l2_loss: 0.018870    loss: 0.301814
steps 6000    v_Prec: 0.653321  v_Recall: 0.614979  v_F1: 0.633571  v_AUC: 0.863937
steps 6000    running time 216 seconds

steps 6200    base_loss: 0.218128    reg_loss: 0.056818    l2_loss: 0.019142    loss: 0.294088
steps 6200    v_Prec: 0.645175  v_Recall: 0.619211  v_F1: 0.631926  v_AUC: 0.863596
steps 6200    running time 222 seconds

steps 6400    base_loss: 0.233119    reg_loss: 0.057230    l2_loss: 0.019138    loss: 0.309487
steps 6400    v_Prec: 0.650025  v_Recall: 0.623762  v_F1: 0.636623  v_AUC: 0.865532
steps 6400    running time 228 seconds

steps 6600    base_loss: 0.221562    reg_loss: 0.057013    l2_loss: 0.019241    loss: 0.297816
steps 6600    v_Prec: 0.655242  v_Recall: 0.619770  v_F1: 0.637013  v_AUC: 0.865176
steps 6600    running time 234 seconds

steps 6800    base_loss: 0.234066    reg_loss: 0.057766    l2_loss: 0.019433    loss: 0.311264
steps 6800    v_Prec: 0.681021  v_Recall: 0.613702  v_F1: 0.645611  v_AUC: 0.869475
steps 6800    running time 240 seconds

steps 7000    base_loss: 0.237877    reg_loss: 0.057752    l2_loss: 0.019720    loss: 0.315349
steps 7000    v_Prec: 0.678142  v_Recall: 0.625998  v_F1: 0.651028  v_AUC: 0.870141
steps 7000    running time 247 seconds

steps 7200    base_loss: 0.230518    reg_loss: 0.057531    l2_loss: 0.019815    loss: 0.307864
steps 7200    v_Prec: 0.679397  v_Recall: 0.633504  v_F1: 0.655648  v_AUC: 0.874084
steps 7200    running time 253 seconds

steps 7400    base_loss: 0.224890    reg_loss: 0.057438    l2_loss: 0.019861    loss: 0.302190
steps 7400    v_Prec: 0.692944  v_Recall: 0.628873  v_F1: 0.659355  v_AUC: 0.875914
steps 7400    running time 259 seconds

steps 7600    base_loss: 0.229773    reg_loss: 0.057471    l2_loss: 0.020030    loss: 0.307274
steps 7600    v_Prec: 0.680810  v_Recall: 0.644443  v_F1: 0.662127  v_AUC: 0.875683
steps 7600    running time 265 seconds

steps 7800    base_loss: 0.230242    reg_loss: 0.057448    l2_loss: 0.020097    loss: 0.307787
steps 7800    v_Prec: 0.698742  v_Recall: 0.634302  v_F1: 0.664965  v_AUC: 0.877275
steps 7800    running time 271 seconds

steps 8000    base_loss: 0.228913    reg_loss: 0.057350    l2_loss: 0.020250    loss: 0.306513
steps 8000    v_Prec: 0.688233  v_Recall: 0.651469  v_F1: 0.669347  v_AUC: 0.878855
steps 8000    running time 277 seconds

steps 8200    base_loss: 0.227808    reg_loss: 0.057296    l2_loss: 0.020323    loss: 0.305426
steps 8200    v_Prec: 0.695962  v_Recall: 0.648116  v_F1: 0.671187  v_AUC: 0.880716
steps 8200    running time 284 seconds

steps 8400    base_loss: 0.227862    reg_loss: 0.057502    l2_loss: 0.020383    loss: 0.305748
steps 8400    v_Prec: 0.707624  v_Recall: 0.650671  v_F1: 0.677953  v_AUC: 0.881754
steps 8400    running time 290 seconds

steps 8600    base_loss: 0.226050    reg_loss: 0.057203    l2_loss: 0.020479    loss: 0.303732
steps 8600    v_Prec: 0.720556  v_Recall: 0.646279  v_F1: 0.681399  v_AUC: 0.884144
steps 8600    running time 296 seconds

steps 8800    base_loss: 0.217697    reg_loss: 0.057316    l2_loss: 0.020584    loss: 0.295596
steps 8800    v_Prec: 0.733370  v_Recall: 0.641728  v_F1: 0.684495  v_AUC: 0.885476
steps 8800    running time 302 seconds

steps 9000    base_loss: 0.229033    reg_loss: 0.057571    l2_loss: 0.020627    loss: 0.307231
steps 9000    v_Prec: 0.737751  v_Recall: 0.644443  v_F1: 0.687947  v_AUC: 0.887071
steps 9000    running time 308 seconds

steps 9200    base_loss: 0.217957    reg_loss: 0.056777    l2_loss: 0.020568    loss: 0.295302
steps 9200    v_Prec: 0.711914  v_Recall: 0.664165  v_F1: 0.687211  v_AUC: 0.888086
steps 9200    running time 314 seconds

steps 9400    base_loss: 0.222443    reg_loss: 0.057042    l2_loss: 0.020697    loss: 0.300182
steps 9400    v_Prec: 0.709846  v_Recall: 0.671191  v_F1: 0.689978  v_AUC: 0.889600
steps 9400    running time 320 seconds

steps 9600    base_loss: 0.226796    reg_loss: 0.057113    l2_loss: 0.020851    loss: 0.304760
steps 9600    v_Prec: 0.716633  v_Recall: 0.672229  v_F1: 0.693721  v_AUC: 0.891953
steps 9600    running time 326 seconds

steps 9800    base_loss: 0.220560    reg_loss: 0.057107    l2_loss: 0.020898    loss: 0.298565
steps 9800    v_Prec: 0.739747  v_Recall: 0.653865  v_F1: 0.694160  v_AUC: 0.892768
steps 9800    running time 333 seconds

steps 10000    base_loss: 0.222384    reg_loss: 0.056696    l2_loss: 0.020937    loss: 0.300017
steps 10000    v_Prec: 0.715572  v_Recall: 0.678777  v_F1: 0.696689  v_AUC: 0.893330
steps 10000    running time 339 seconds

steps 10200    base_loss: 0.219031    reg_loss: 0.056371    l2_loss: 0.020983    loss: 0.296385
steps 10200    v_Prec: 0.733567  v_Recall: 0.667439  v_F1: 0.698942  v_AUC: 0.894491
steps 10200    running time 345 seconds

steps 10400    base_loss: 0.225565    reg_loss: 0.056540    l2_loss: 0.021093    loss: 0.303198
steps 10400    v_Prec: 0.735945  v_Recall: 0.672070  v_F1: 0.702558  v_AUC: 0.896953
steps 10400    running time 351 seconds

steps 10600    base_loss: 0.220710    reg_loss: 0.056266    l2_loss: 0.021238    loss: 0.298214
steps 10600    v_Prec: 0.741324  v_Recall: 0.677100  v_F1: 0.707758  v_AUC: 0.898270
steps 10600    running time 357 seconds

steps 10800    base_loss: 0.206255    reg_loss: 0.055818    l2_loss: 0.021299    loss: 0.283372
steps 10800    v_Prec: 0.738479  v_Recall: 0.684526  v_F1: 0.710479  v_AUC: 0.899995
steps 10800    running time 363 seconds

steps 11000    base_loss: 0.084422    reg_loss: 0.050864    l2_loss: 0.020993    loss: 0.156280
steps 11000    v_Prec: 0.765323  v_Recall: 0.658017  v_F1: 0.707625  v_AUC: 0.896402
steps 11000    running time 369 seconds

steps 11200    base_loss: 0.089881    reg_loss: 0.051392    l2_loss: 0.020635    loss: 0.161908
steps 11200    v_Prec: 0.759523  v_Recall: 0.651150  v_F1: 0.701174  v_AUC: 0.894063
steps 11200    running time 375 seconds

steps 11400    base_loss: 0.085891    reg_loss: 0.051531    l2_loss: 0.020255    loss: 0.157677
steps 11400    v_Prec: 0.767188  v_Recall: 0.634382  v_F1: 0.694493  v_AUC: 0.891371
steps 11400    running time 380 seconds

steps 11600    base_loss: 0.093979    reg_loss: 0.051588    l2_loss: 0.019919    loss: 0.165486
steps 11600    v_Prec: 0.726228  v_Recall: 0.661051  v_F1: 0.692108  v_AUC: 0.889943
steps 11600    running time 386 seconds

steps 11800    base_loss: 0.088869    reg_loss: 0.051846    l2_loss: 0.019638    loss: 0.160353
steps 11800    v_Prec: 0.720118  v_Recall: 0.661929  v_F1: 0.689799  v_AUC: 0.889993
steps 11800    running time 392 seconds

steps 12000    base_loss: 0.098372    reg_loss: 0.052360    l2_loss: 0.019555    loss: 0.170288
steps 12000    v_Prec: 0.726632  v_Recall: 0.650511  v_F1: 0.686468  v_AUC: 0.887480
steps 12000    running time 398 seconds

steps 12200    base_loss: 0.097687    reg_loss: 0.052428    l2_loss: 0.019360    loss: 0.169475
steps 12200    v_Prec: 0.735433  v_Recall: 0.648994  v_F1: 0.689515  v_AUC: 0.888497
steps 12200    running time 404 seconds

steps 12400    base_loss: 0.093711    reg_loss: 0.052251    l2_loss: 0.019100    loss: 0.165061
steps 12400    v_Prec: 0.707855  v_Recall: 0.664165  v_F1: 0.685314  v_AUC: 0.887233
steps 12400    running time 410 seconds

steps 12600    base_loss: 0.094131    reg_loss: 0.051871    l2_loss: 0.018905    loss: 0.164908
steps 12600    v_Prec: 0.723176  v_Recall: 0.652268  v_F1: 0.685894  v_AUC: 0.888144
steps 12600    running time 416 seconds

steps 12800    base_loss: 0.094207    reg_loss: 0.051782    l2_loss: 0.018758    loss: 0.164748
steps 12800    v_Prec: 0.708093  v_Recall: 0.667838  v_F1: 0.687377  v_AUC: 0.889054
steps 12800    running time 422 seconds

Early stop model F1: 0.710479
testing thre: 0.5595596
testing Prec: 0.5901956473950318
testing Recall: 0.6524422843256379
testing F1: 0.6197599261311172
testing AUC: 0.8668213837602529
overall running time 424 seconds
(0.6508724271236026, 0.6055407047387606, 0.62738877558728, 0.8668213837602529, 0.6964602)

2019-02-24 15:45:13.238810: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:45:14.029074: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:45:14.158272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:45:14.158352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.190000 seconds
loading data in 31.430000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.639820    reg_loss: 0.064439    l2_loss: 0.013357    loss: 0.717616
steps 200    v_Prec: 0.163125  v_Recall: 1.000000  v_F1: 0.280495  v_AUC: 0.491670
steps 200    running time 41 seconds

steps 400    base_loss: 0.514796    reg_loss: 0.064608    l2_loss: 0.013230    loss: 0.592634
steps 400    v_Prec: 0.165320  v_Recall: 0.942555  v_F1: 0.281300  v_AUC: 0.529623
steps 400    running time 47 seconds

steps 600    base_loss: 0.484731    reg_loss: 0.064530    l2_loss: 0.013005    loss: 0.562265
steps 600    v_Prec: 0.185453  v_Recall: 0.711737  v_F1: 0.294238  v_AUC: 0.581490
steps 600    running time 53 seconds

steps 800    base_loss: 0.455713    reg_loss: 0.064302    l2_loss: 0.012733    loss: 0.532748
steps 800    v_Prec: 0.246836  v_Recall: 0.488359  v_F1: 0.327925  v_AUC: 0.640738
steps 800    running time 59 seconds

steps 1000    base_loss: 0.429270    reg_loss: 0.064205    l2_loss: 0.012550    loss: 0.506025
steps 1000    v_Prec: 0.333125  v_Recall: 0.468277  v_F1: 0.389305  v_AUC: 0.709577
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.404249    reg_loss: 0.064499    l2_loss: 0.012533    loss: 0.481281
steps 1200    v_Prec: 0.410298  v_Recall: 0.489639  v_F1: 0.446471  v_AUC: 0.760414
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.384394    reg_loss: 0.064756    l2_loss: 0.012546    loss: 0.461696
steps 1400    v_Prec: 0.486838  v_Recall: 0.509001  v_F1: 0.497673  v_AUC: 0.797494
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.356599    reg_loss: 0.065236    l2_loss: 0.012661    loss: 0.434496
steps 1600    v_Prec: 0.525310  v_Recall: 0.538843  v_F1: 0.531991  v_AUC: 0.818788
steps 1600    running time 84 seconds

steps 1800    base_loss: 0.342072    reg_loss: 0.065194    l2_loss: 0.012775    loss: 0.420040
steps 1800    v_Prec: 0.542016  v_Recall: 0.569726  v_F1: 0.555525  v_AUC: 0.835049
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.333405    reg_loss: 0.065671    l2_loss: 0.012923    loss: 0.411998
steps 2000    v_Prec: 0.594664  v_Recall: 0.556365  v_F1: 0.574877  v_AUC: 0.846278
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.326778    reg_loss: 0.065823    l2_loss: 0.013132    loss: 0.405733
steps 2200    v_Prec: 0.601326  v_Recall: 0.587807  v_F1: 0.594490  v_AUC: 0.857487
steps 2200    running time 102 seconds

steps 2400    base_loss: 0.315309    reg_loss: 0.066193    l2_loss: 0.013288    loss: 0.394790
steps 2400    v_Prec: 0.637661  v_Recall: 0.575726  v_F1: 0.605113  v_AUC: 0.864251
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.312515    reg_loss: 0.066278    l2_loss: 0.013496    loss: 0.392289
steps 2600    v_Prec: 0.618091  v_Recall: 0.605728  v_F1: 0.611847  v_AUC: 0.869767
steps 2600    running time 114 seconds

steps 2800    base_loss: 0.297801    reg_loss: 0.066182    l2_loss: 0.013715    loss: 0.377698
steps 2800    v_Prec: 0.627491  v_Recall: 0.609569  v_F1: 0.618400  v_AUC: 0.874219
steps 2800    running time 120 seconds

steps 3000    base_loss: 0.304467    reg_loss: 0.066532    l2_loss: 0.013975    loss: 0.384974
steps 3000    v_Prec: 0.630226  v_Recall: 0.619890  v_F1: 0.625015  v_AUC: 0.878870
steps 3000    running time 126 seconds

steps 3200    base_loss: 0.292654    reg_loss: 0.066656    l2_loss: 0.014322    loss: 0.373632
steps 3200    v_Prec: 0.644882  v_Recall: 0.618930  v_F1: 0.631639  v_AUC: 0.881123
steps 3200    running time 132 seconds

steps 3400    base_loss: 0.290236    reg_loss: 0.066623    l2_loss: 0.014611    loss: 0.371469
steps 3400    v_Prec: 0.625595  v_Recall: 0.641011  v_F1: 0.633210  v_AUC: 0.882466
steps 3400    running time 138 seconds

steps 3600    base_loss: 0.291618    reg_loss: 0.066742    l2_loss: 0.014966    loss: 0.373326
steps 3600    v_Prec: 0.640920  v_Recall: 0.637331  v_F1: 0.639121  v_AUC: 0.884772
steps 3600    running time 145 seconds

steps 3800    base_loss: 0.289127    reg_loss: 0.066841    l2_loss: 0.015369    loss: 0.371337
steps 3800    v_Prec: 0.643758  v_Recall: 0.637011  v_F1: 0.640367  v_AUC: 0.886123
steps 3800    running time 151 seconds

steps 4000    base_loss: 0.284810    reg_loss: 0.066593    l2_loss: 0.015701    loss: 0.367104
steps 4000    v_Prec: 0.633743  v_Recall: 0.659653  v_F1: 0.646439  v_AUC: 0.888843
steps 4000    running time 157 seconds

steps 4200    base_loss: 0.288491    reg_loss: 0.067038    l2_loss: 0.016137    loss: 0.371666
steps 4200    v_Prec: 0.657190  v_Recall: 0.638051  v_F1: 0.647479  v_AUC: 0.889937
steps 4200    running time 163 seconds

steps 4400    base_loss: 0.283283    reg_loss: 0.067027    l2_loss: 0.016531    loss: 0.366842
steps 4400    v_Prec: 0.664341  v_Recall: 0.632291  v_F1: 0.647920  v_AUC: 0.891594
steps 4400    running time 169 seconds

steps 4600    base_loss: 0.276462    reg_loss: 0.066735    l2_loss: 0.017047    loss: 0.360244
steps 4600    v_Prec: 0.653076  v_Recall: 0.657413  v_F1: 0.655237  v_AUC: 0.893082
steps 4600    running time 175 seconds

steps 4800    base_loss: 0.277135    reg_loss: 0.066730    l2_loss: 0.017475    loss: 0.361340
steps 4800    v_Prec: 0.649585  v_Recall: 0.663253  v_F1: 0.656348  v_AUC: 0.894681
steps 4800    running time 181 seconds

steps 5000    base_loss: 0.274824    reg_loss: 0.066654    l2_loss: 0.018069    loss: 0.359547
steps 5000    v_Prec: 0.684087  v_Recall: 0.627330  v_F1: 0.654480  v_AUC: 0.895517
steps 5000    running time 187 seconds

steps 5200    base_loss: 0.272676    reg_loss: 0.066555    l2_loss: 0.018642    loss: 0.357873
steps 5200    v_Prec: 0.665233  v_Recall: 0.643411  v_F1: 0.654140  v_AUC: 0.895858
steps 5200    running time 193 seconds

steps 5400    base_loss: 0.268624    reg_loss: 0.066843    l2_loss: 0.019278    loss: 0.354745
steps 5400    v_Prec: 0.678134  v_Recall: 0.637171  v_F1: 0.657014  v_AUC: 0.896264
steps 5400    running time 199 seconds

steps 5600    base_loss: 0.193041    reg_loss: 0.067912    l2_loss: 0.020041    loss: 0.280994
steps 5600    v_Prec: 0.643865  v_Recall: 0.653652  v_F1: 0.648722  v_AUC: 0.890766
steps 5600    running time 205 seconds

steps 5800    base_loss: 0.195287    reg_loss: 0.067522    l2_loss: 0.020776    loss: 0.283585
steps 5800    v_Prec: 0.680429  v_Recall: 0.614449  v_F1: 0.645758  v_AUC: 0.889695
steps 5800    running time 210 seconds

steps 6000    base_loss: 0.188074    reg_loss: 0.067795    l2_loss: 0.021446    loss: 0.277314
steps 6000    v_Prec: 0.639724  v_Recall: 0.652212  v_F1: 0.645908  v_AUC: 0.888116
steps 6000    running time 216 seconds

steps 6200    base_loss: 0.200922    reg_loss: 0.067894    l2_loss: 0.021967    loss: 0.290782
steps 6200    v_Prec: 0.643397  v_Recall: 0.660693  v_F1: 0.651930  v_AUC: 0.890009
steps 6200    running time 222 seconds

steps 6400    base_loss: 0.189526    reg_loss: 0.067839    l2_loss: 0.022567    loss: 0.279931
steps 6400    v_Prec: 0.663750  v_Recall: 0.631251  v_F1: 0.647093  v_AUC: 0.888864
steps 6400    running time 228 seconds

steps 6600    base_loss: 0.193993    reg_loss: 0.067863    l2_loss: 0.023114    loss: 0.284969
steps 6600    v_Prec: 0.666037  v_Recall: 0.648612  v_F1: 0.657209  v_AUC: 0.892392
steps 6600    running time 233 seconds

steps 6800    base_loss: 0.206827    reg_loss: 0.067594    l2_loss: 0.023565    loss: 0.297986
steps 6800    v_Prec: 0.635589  v_Recall: 0.674134  v_F1: 0.654294  v_AUC: 0.892107
steps 6800    running time 239 seconds

steps 7000    base_loss: 0.200394    reg_loss: 0.067724    l2_loss: 0.023903    loss: 0.292022
steps 7000    v_Prec: 0.653870  v_Recall: 0.667733  v_F1: 0.660729  v_AUC: 0.892717
steps 7000    running time 245 seconds

steps 7200    base_loss: 0.196277    reg_loss: 0.067715    l2_loss: 0.024375    loss: 0.288366
steps 7200    v_Prec: 0.679153  v_Recall: 0.641171  v_F1: 0.659616  v_AUC: 0.893385
steps 7200    running time 251 seconds

steps 7400    base_loss: 0.203823    reg_loss: 0.067568    l2_loss: 0.024718    loss: 0.296109
steps 7400    v_Prec: 0.664013  v_Recall: 0.673894  v_F1: 0.668917  v_AUC: 0.895601
steps 7400    running time 256 seconds

steps 7600    base_loss: 0.203268    reg_loss: 0.067531    l2_loss: 0.025032    loss: 0.295831
steps 7600    v_Prec: 0.666588  v_Recall: 0.674214  v_F1: 0.670379  v_AUC: 0.897109
steps 7600    running time 262 seconds

steps 7800    base_loss: 0.201271    reg_loss: 0.067420    l2_loss: 0.025377    loss: 0.294068
steps 7800    v_Prec: 0.682155  v_Recall: 0.663653  v_F1: 0.672777  v_AUC: 0.897971
steps 7800    running time 268 seconds

steps 8000    base_loss: 0.193446    reg_loss: 0.067578    l2_loss: 0.025595    loss: 0.286620
steps 8000    v_Prec: 0.699637  v_Recall: 0.647412  v_F1: 0.672512  v_AUC: 0.899363
steps 8000    running time 275 seconds

steps 8200    base_loss: 0.202808    reg_loss: 0.067572    l2_loss: 0.025976    loss: 0.296356
steps 8200    v_Prec: 0.685740  v_Recall: 0.674054  v_F1: 0.679847  v_AUC: 0.901927
steps 8200    running time 280 seconds

steps 8400    base_loss: 0.196033    reg_loss: 0.067475    l2_loss: 0.026258    loss: 0.289765
steps 8400    v_Prec: 0.674637  v_Recall: 0.683975  v_F1: 0.679274  v_AUC: 0.903334
steps 8400    running time 286 seconds

steps 8600    base_loss: 0.207421    reg_loss: 0.067291    l2_loss: 0.026554    loss: 0.301266
steps 8600    v_Prec: 0.700665  v_Recall: 0.657893  v_F1: 0.678605  v_AUC: 0.904180
steps 8600    running time 292 seconds

steps 8800    base_loss: 0.203539    reg_loss: 0.067332    l2_loss: 0.026829    loss: 0.297699
steps 8800    v_Prec: 0.686661  v_Recall: 0.679574  v_F1: 0.683099  v_AUC: 0.905801
steps 8800    running time 298 seconds

steps 9000    base_loss: 0.199033    reg_loss: 0.067282    l2_loss: 0.027063    loss: 0.293379
steps 9000    v_Prec: 0.705158  v_Recall: 0.673734  v_F1: 0.689088  v_AUC: 0.908002
steps 9000    running time 304 seconds

steps 9200    base_loss: 0.200741    reg_loss: 0.067446    l2_loss: 0.027455    loss: 0.295643
steps 9200    v_Prec: 0.714654  v_Recall: 0.666053  v_F1: 0.689498  v_AUC: 0.910214
steps 9200    running time 310 seconds

steps 9400    base_loss: 0.203129    reg_loss: 0.067435    l2_loss: 0.027561    loss: 0.298126
steps 9400    v_Prec: 0.711098  v_Recall: 0.667973  v_F1: 0.688861  v_AUC: 0.909787
steps 9400    running time 316 seconds

steps 9600    base_loss: 0.193369    reg_loss: 0.067291    l2_loss: 0.027859    loss: 0.288518
steps 9600    v_Prec: 0.706231  v_Recall: 0.676454  v_F1: 0.691022  v_AUC: 0.911089
steps 9600    running time 321 seconds

steps 9800    base_loss: 0.201163    reg_loss: 0.067606    l2_loss: 0.028017    loss: 0.296786
steps 9800    v_Prec: 0.705143  v_Recall: 0.691095  v_F1: 0.698048  v_AUC: 0.912789
steps 9800    running time 327 seconds

steps 10000    base_loss: 0.199664    reg_loss: 0.067228    l2_loss: 0.028186    loss: 0.295079
steps 10000    v_Prec: 0.719223  v_Recall: 0.681014  v_F1: 0.699597  v_AUC: 0.913106
steps 10000    running time 334 seconds

steps 10200    base_loss: 0.195610    reg_loss: 0.067037    l2_loss: 0.028394    loss: 0.291041
steps 10200    v_Prec: 0.706853  v_Recall: 0.692375  v_F1: 0.699539  v_AUC: 0.914410
steps 10200    running time 340 seconds

steps 10400    base_loss: 0.199703    reg_loss: 0.066916    l2_loss: 0.028642    loss: 0.295261
steps 10400    v_Prec: 0.711902  v_Recall: 0.689575  v_F1: 0.700561  v_AUC: 0.914436
steps 10400    running time 345 seconds

steps 10600    base_loss: 0.196689    reg_loss: 0.067188    l2_loss: 0.028828    loss: 0.292705
steps 10600    v_Prec: 0.726146  v_Recall: 0.689255  v_F1: 0.707220  v_AUC: 0.917944
steps 10600    running time 351 seconds

steps 10800    base_loss: 0.194061    reg_loss: 0.066876    l2_loss: 0.029051    loss: 0.289989
steps 10800    v_Prec: 0.743399  v_Recall: 0.680294  v_F1: 0.710448  v_AUC: 0.919902
steps 10800    running time 357 seconds

steps 11000    base_loss: 0.090942    reg_loss: 0.066532    l2_loss: 0.029335    loss: 0.186809
steps 11000    v_Prec: 0.688156  v_Recall: 0.681495  v_F1: 0.684809  v_AUC: 0.906952
steps 11000    running time 363 seconds

steps 11200    base_loss: 0.092897    reg_loss: 0.066588    l2_loss: 0.029454    loss: 0.188939
steps 11200    v_Prec: 0.683397  v_Recall: 0.668854  v_F1: 0.676047  v_AUC: 0.902628
steps 11200    running time 369 seconds

steps 11400    base_loss: 0.090093    reg_loss: 0.066670    l2_loss: 0.029526    loss: 0.186290
steps 11400    v_Prec: 0.664400  v_Recall: 0.679974  v_F1: 0.672097  v_AUC: 0.900332
steps 11400    running time 375 seconds

steps 11600    base_loss: 0.086206    reg_loss: 0.066442    l2_loss: 0.029783    loss: 0.182432
steps 11600    v_Prec: 0.691672  v_Recall: 0.642531  v_F1: 0.666197  v_AUC: 0.896991
steps 11600    running time 381 seconds

steps 11800    base_loss: 0.099886    reg_loss: 0.066558    l2_loss: 0.029924    loss: 0.196368
steps 11800    v_Prec: 0.649141  v_Recall: 0.686535  v_F1: 0.667315  v_AUC: 0.896452
steps 11800    running time 386 seconds

steps 12000    base_loss: 0.092622    reg_loss: 0.066140    l2_loss: 0.030050    loss: 0.188813
steps 12000    v_Prec: 0.680558  v_Recall: 0.648052  v_F1: 0.663907  v_AUC: 0.895835
steps 12000    running time 392 seconds

steps 12200    base_loss: 0.089912    reg_loss: 0.066222    l2_loss: 0.030053    loss: 0.186187
steps 12200    v_Prec: 0.665539  v_Recall: 0.661173  v_F1: 0.663349  v_AUC: 0.893565
steps 12200    running time 398 seconds

steps 12400    base_loss: 0.101502    reg_loss: 0.065915    l2_loss: 0.030197    loss: 0.197614
steps 12400    v_Prec: 0.668568  v_Recall: 0.665893  v_F1: 0.667228  v_AUC: 0.895909
steps 12400    running time 404 seconds

steps 12600    base_loss: 0.096162    reg_loss: 0.066141    l2_loss: 0.030187    loss: 0.192490
steps 12600    v_Prec: 0.658331  v_Recall: 0.655012  v_F1: 0.656667  v_AUC: 0.891731
steps 12600    running time 410 seconds

steps 12800    base_loss: 0.105693    reg_loss: 0.066127    l2_loss: 0.030398    loss: 0.202218
steps 12800    v_Prec: 0.652843  v_Recall: 0.665013  v_F1: 0.658872  v_AUC: 0.892683
steps 12800    running time 415 seconds

Early stop model F1: 0.710448
testing thre: 0.3487696
testing Prec: 0.5350933447342169
testing Recall: 0.7299635479951397
testing F1: 0.6175194786505767
testing AUC: 0.8904846025593618
overall running time 418 seconds
(0.6704545454545454, 0.6107897934386392, 0.6392329408174164, 0.8904846025593618, 0.6617862)

2019-02-24 15:49:31.004073: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:49:31.838998: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:49:31.846648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:49:31.846704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.870000 seconds
loading data in 30.800000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.808679    reg_loss: 0.064656    l2_loss: 0.013364    loss: 0.886699
steps 200    v_Prec: 0.163430  v_Recall: 0.997843  v_F1: 0.280860  v_AUC: 0.494023
steps 200    running time 40 seconds

steps 400    base_loss: 0.533567    reg_loss: 0.064834    l2_loss: 0.013223    loss: 0.611624
steps 400    v_Prec: 0.164707  v_Recall: 0.960607  v_F1: 0.281200  v_AUC: 0.517551
steps 400    running time 46 seconds

steps 600    base_loss: 0.482893    reg_loss: 0.064654    l2_loss: 0.013149    loss: 0.560696
steps 600    v_Prec: 0.172686  v_Recall: 0.840192  v_F1: 0.286489  v_AUC: 0.554590
steps 600    running time 52 seconds

steps 800    base_loss: 0.460563    reg_loss: 0.064641    l2_loss: 0.012952    loss: 0.538156
steps 800    v_Prec: 0.204631  v_Recall: 0.619337  v_F1: 0.307622  v_AUC: 0.608847
steps 800    running time 58 seconds

steps 1000    base_loss: 0.452217    reg_loss: 0.064571    l2_loss: 0.012856    loss: 0.529644
steps 1000    v_Prec: 0.271215  v_Recall: 0.487255  v_F1: 0.348467  v_AUC: 0.659067
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.433973    reg_loss: 0.064337    l2_loss: 0.012839    loss: 0.511149
steps 1200    v_Prec: 0.329037  v_Recall: 0.467119  v_F1: 0.386104  v_AUC: 0.700836
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.414007    reg_loss: 0.064142    l2_loss: 0.012813    loss: 0.490963
steps 1400    v_Prec: 0.386940  v_Recall: 0.481982  v_F1: 0.429263  v_AUC: 0.737960
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.398388    reg_loss: 0.064182    l2_loss: 0.012807    loss: 0.475378
steps 1600    v_Prec: 0.442773  v_Recall: 0.493967  v_F1: 0.466971  v_AUC: 0.768428
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.377339    reg_loss: 0.064492    l2_loss: 0.012872    loss: 0.454703
steps 1800    v_Prec: 0.475853  v_Recall: 0.531442  v_F1: 0.502114  v_AUC: 0.794134
steps 1800    running time 89 seconds

steps 2000    base_loss: 0.367244    reg_loss: 0.064742    l2_loss: 0.012982    loss: 0.444968
steps 2000    v_Prec: 0.518169  v_Recall: 0.538953  v_F1: 0.528357  v_AUC: 0.815762
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.352875    reg_loss: 0.065265    l2_loss: 0.013150    loss: 0.431290
steps 2200    v_Prec: 0.539102  v_Recall: 0.574511  v_F1: 0.556243  v_AUC: 0.833732
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.333004    reg_loss: 0.065760    l2_loss: 0.013314    loss: 0.412078
steps 2400    v_Prec: 0.571316  v_Recall: 0.579305  v_F1: 0.575283  v_AUC: 0.846199
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.326288    reg_loss: 0.066141    l2_loss: 0.013500    loss: 0.405929
steps 2600    v_Prec: 0.595248  v_Recall: 0.584499  v_F1: 0.589824  v_AUC: 0.856254
steps 2600    running time 113 seconds

steps 2800    base_loss: 0.320918    reg_loss: 0.066535    l2_loss: 0.013760    loss: 0.401213
steps 2800    v_Prec: 0.605484  v_Recall: 0.599920  v_F1: 0.602689  v_AUC: 0.862696
steps 2800    running time 120 seconds

steps 3000    base_loss: 0.308439    reg_loss: 0.066612    l2_loss: 0.014005    loss: 0.389055
steps 3000    v_Prec: 0.597216  v_Recall: 0.630763  v_F1: 0.613531  v_AUC: 0.868914
steps 3000    running time 126 seconds

steps 3200    base_loss: 0.313512    reg_loss: 0.066817    l2_loss: 0.014321    loss: 0.394650
steps 3200    v_Prec: 0.631341  v_Recall: 0.601678  v_F1: 0.616153  v_AUC: 0.872916
steps 3200    running time 132 seconds

steps 3400    base_loss: 0.304427    reg_loss: 0.066912    l2_loss: 0.014593    loss: 0.385932
steps 3400    v_Prec: 0.615373  v_Recall: 0.635238  v_F1: 0.625147  v_AUC: 0.877465
steps 3400    running time 138 seconds

steps 3600    base_loss: 0.300870    reg_loss: 0.067032    l2_loss: 0.015023    loss: 0.382924
steps 3600    v_Prec: 0.630957  v_Recall: 0.627327  v_F1: 0.629137  v_AUC: 0.881059
steps 3600    running time 144 seconds

steps 3800    base_loss: 0.300587    reg_loss: 0.067014    l2_loss: 0.015370    loss: 0.382971
steps 3800    v_Prec: 0.615448  v_Recall: 0.652577  v_F1: 0.633469  v_AUC: 0.884308
steps 3800    running time 150 seconds

steps 4000    base_loss: 0.292223    reg_loss: 0.067226    l2_loss: 0.015854    loss: 0.375303
steps 4000    v_Prec: 0.621016  v_Recall: 0.650739  v_F1: 0.635530  v_AUC: 0.887058
steps 4000    running time 156 seconds

steps 4200    base_loss: 0.293749    reg_loss: 0.067271    l2_loss: 0.016277    loss: 0.377298
steps 4200    v_Prec: 0.657236  v_Recall: 0.625569  v_F1: 0.641012  v_AUC: 0.889311
steps 4200    running time 162 seconds

steps 4400    base_loss: 0.294817    reg_loss: 0.067119    l2_loss: 0.016715    loss: 0.378650
steps 4400    v_Prec: 0.648899  v_Recall: 0.644906  v_F1: 0.646896  v_AUC: 0.893237
steps 4400    running time 168 seconds

steps 4600    base_loss: 0.287950    reg_loss: 0.067435    l2_loss: 0.017203    loss: 0.372588
steps 4600    v_Prec: 0.651773  v_Recall: 0.644586  v_F1: 0.648160  v_AUC: 0.892382
steps 4600    running time 174 seconds

steps 4800    base_loss: 0.284522    reg_loss: 0.067262    l2_loss: 0.017770    loss: 0.369553
steps 4800    v_Prec: 0.656573  v_Recall: 0.644507  v_F1: 0.650484  v_AUC: 0.894326
steps 4800    running time 180 seconds

steps 5000    base_loss: 0.284225    reg_loss: 0.067184    l2_loss: 0.018332    loss: 0.369741
steps 5000    v_Prec: 0.661842  v_Recall: 0.643068  v_F1: 0.652320  v_AUC: 0.895285
steps 5000    running time 186 seconds

steps 5200    base_loss: 0.285300    reg_loss: 0.067248    l2_loss: 0.018947    loss: 0.371496
steps 5200    v_Prec: 0.653003  v_Recall: 0.661926  v_F1: 0.657434  v_AUC: 0.897467
steps 5200    running time 192 seconds

steps 5400    base_loss: 0.272633    reg_loss: 0.067164    l2_loss: 0.019616    loss: 0.359413
steps 5400    v_Prec: 0.657058  v_Recall: 0.657531  v_F1: 0.657295  v_AUC: 0.897886
steps 5400    running time 199 seconds

steps 5600    base_loss: 0.188809    reg_loss: 0.068727    l2_loss: 0.020514    loss: 0.278050
steps 5600    v_Prec: 0.636842  v_Recall: 0.658010  v_F1: 0.647253  v_AUC: 0.891846
steps 5600    running time 205 seconds

steps 5800    base_loss: 0.194714    reg_loss: 0.068393    l2_loss: 0.021185    loss: 0.284292
steps 5800    v_Prec: 0.629382  v_Recall: 0.662725  v_F1: 0.645623  v_AUC: 0.891229
steps 5800    running time 210 seconds

steps 6000    base_loss: 0.184819    reg_loss: 0.068502    l2_loss: 0.021903    loss: 0.275224
steps 6000    v_Prec: 0.650416  v_Recall: 0.637475  v_F1: 0.643880  v_AUC: 0.890336
steps 6000    running time 216 seconds

steps 6200    base_loss: 0.195615    reg_loss: 0.068389    l2_loss: 0.022510    loss: 0.286514
steps 6200    v_Prec: 0.638857  v_Recall: 0.664483  v_F1: 0.651418  v_AUC: 0.893698
steps 6200    running time 222 seconds

steps 6400    base_loss: 0.200594    reg_loss: 0.068280    l2_loss: 0.022933    loss: 0.291807
steps 6400    v_Prec: 0.651032  v_Recall: 0.645465  v_F1: 0.648237  v_AUC: 0.892224
steps 6400    running time 228 seconds

steps 6600    base_loss: 0.208898    reg_loss: 0.068396    l2_loss: 0.023391    loss: 0.300685
steps 6600    v_Prec: 0.647264  v_Recall: 0.653056  v_F1: 0.650147  v_AUC: 0.890690
steps 6600    running time 233 seconds

steps 6800    base_loss: 0.199182    reg_loss: 0.068294    l2_loss: 0.023881    loss: 0.291357
steps 6800    v_Prec: 0.689953  v_Recall: 0.625010  v_F1: 0.655878  v_AUC: 0.893125
steps 6800    running time 239 seconds

steps 7000    base_loss: 0.215402    reg_loss: 0.068279    l2_loss: 0.024344    loss: 0.308025
steps 7000    v_Prec: 0.692179  v_Recall: 0.627247  v_F1: 0.658115  v_AUC: 0.894332
steps 7000    running time 245 seconds

steps 7200    base_loss: 0.215597    reg_loss: 0.068487    l2_loss: 0.024738    loss: 0.308823
steps 7200    v_Prec: 0.682633  v_Recall: 0.629724  v_F1: 0.655112  v_AUC: 0.894992
steps 7200    running time 251 seconds

steps 7400    base_loss: 0.204185    reg_loss: 0.068002    l2_loss: 0.025143    loss: 0.297329
steps 7400    v_Prec: 0.651170  v_Recall: 0.662565  v_F1: 0.656818  v_AUC: 0.896580
steps 7400    running time 257 seconds

steps 7600    base_loss: 0.212403    reg_loss: 0.068227    l2_loss: 0.025345    loss: 0.305975
steps 7600    v_Prec: 0.663097  v_Recall: 0.667918  v_F1: 0.665499  v_AUC: 0.900319
steps 7600    running time 263 seconds

steps 7800    base_loss: 0.203245    reg_loss: 0.068346    l2_loss: 0.025714    loss: 0.297304
steps 7800    v_Prec: 0.648935  v_Recall: 0.679425  v_F1: 0.663830  v_AUC: 0.900100
steps 7800    running time 269 seconds

steps 8000    base_loss: 0.200266    reg_loss: 0.068152    l2_loss: 0.026020    loss: 0.294438
steps 8000    v_Prec: 0.673238  v_Recall: 0.668558  v_F1: 0.670890  v_AUC: 0.902198
steps 8000    running time 275 seconds

steps 8200    base_loss: 0.201863    reg_loss: 0.068155    l2_loss: 0.026429    loss: 0.296447
steps 8200    v_Prec: 0.671246  v_Recall: 0.675429  v_F1: 0.673331  v_AUC: 0.903651
steps 8200    running time 281 seconds

steps 8400    base_loss: 0.211144    reg_loss: 0.067965    l2_loss: 0.026640    loss: 0.305749
steps 8400    v_Prec: 0.674812  v_Recall: 0.679664  v_F1: 0.677229  v_AUC: 0.905830
steps 8400    running time 287 seconds

steps 8600    base_loss: 0.209456    reg_loss: 0.067926    l2_loss: 0.026897    loss: 0.304280
steps 8600    v_Prec: 0.660377  v_Recall: 0.699161  v_F1: 0.679216  v_AUC: 0.907268
steps 8600    running time 293 seconds

steps 8800    base_loss: 0.206442    reg_loss: 0.068200    l2_loss: 0.027203    loss: 0.301845
steps 8800    v_Prec: 0.673552  v_Recall: 0.687815  v_F1: 0.680609  v_AUC: 0.906690
steps 8800    running time 299 seconds

steps 9000    base_loss: 0.207366    reg_loss: 0.067949    l2_loss: 0.027335    loss: 0.302650
steps 9000    v_Prec: 0.699488  v_Recall: 0.665282  v_F1: 0.681956  v_AUC: 0.908730
steps 9000    running time 305 seconds

steps 9200    base_loss: 0.207673    reg_loss: 0.068136    l2_loss: 0.027609    loss: 0.303418
steps 9200    v_Prec: 0.684716  v_Recall: 0.684059  v_F1: 0.684387  v_AUC: 0.911159
steps 9200    running time 311 seconds

steps 9400    base_loss: 0.199754    reg_loss: 0.067742    l2_loss: 0.027871    loss: 0.295367
steps 9400    v_Prec: 0.709718  v_Recall: 0.679265  v_F1: 0.694158  v_AUC: 0.911703
steps 9400    running time 317 seconds

steps 9600    base_loss: 0.209710    reg_loss: 0.067839    l2_loss: 0.027967    loss: 0.305516
steps 9600    v_Prec: 0.715479  v_Recall: 0.677347  v_F1: 0.695891  v_AUC: 0.914299
steps 9600    running time 323 seconds

steps 9800    base_loss: 0.198328    reg_loss: 0.067928    l2_loss: 0.028166    loss: 0.294422
steps 9800    v_Prec: 0.688096  v_Recall: 0.703875  v_F1: 0.695896  v_AUC: 0.912715
steps 9800    running time 330 seconds

steps 10000    base_loss: 0.205365    reg_loss: 0.067752    l2_loss: 0.028432    loss: 0.301549
steps 10000    v_Prec: 0.692445  v_Recall: 0.714742  v_F1: 0.703417  v_AUC: 0.916978
steps 10000    running time 336 seconds

steps 10200    base_loss: 0.204982    reg_loss: 0.067758    l2_loss: 0.028629    loss: 0.301368
steps 10200    v_Prec: 0.738120  v_Recall: 0.677667  v_F1: 0.706603  v_AUC: 0.917911
steps 10200    running time 342 seconds

steps 10400    base_loss: 0.198865    reg_loss: 0.067585    l2_loss: 0.028790    loss: 0.295241
steps 10400    v_Prec: 0.703978  v_Recall: 0.705553  v_F1: 0.704765  v_AUC: 0.918787
steps 10400    running time 348 seconds

steps 10600    base_loss: 0.206385    reg_loss: 0.067382    l2_loss: 0.028897    loss: 0.302663
steps 10600    v_Prec: 0.742115  v_Recall: 0.673032  v_F1: 0.705887  v_AUC: 0.920270
steps 10600    running time 353 seconds

steps 10800    base_loss: 0.187544    reg_loss: 0.067461    l2_loss: 0.029050    loss: 0.284055
steps 10800    v_Prec: 0.713428  v_Recall: 0.693248  v_F1: 0.703193  v_AUC: 0.917518
steps 10800    running time 359 seconds

steps 11000    base_loss: 0.092724    reg_loss: 0.067381    l2_loss: 0.029330    loss: 0.189435
steps 11000    v_Prec: 0.700358  v_Recall: 0.671594  v_F1: 0.685675  v_AUC: 0.908624
steps 11000    running time 365 seconds

steps 11200    base_loss: 0.094144    reg_loss: 0.066991    l2_loss: 0.029518    loss: 0.190653
steps 11200    v_Prec: 0.667023  v_Recall: 0.697083  v_F1: 0.681722  v_AUC: 0.906673
steps 11200    running time 370 seconds

steps 11400    base_loss: 0.095682    reg_loss: 0.066973    l2_loss: 0.029643    loss: 0.192298
steps 11400    v_Prec: 0.688167  v_Recall: 0.659848  v_F1: 0.673710  v_AUC: 0.902952
steps 11400    running time 376 seconds

steps 11600    base_loss: 0.095989    reg_loss: 0.067037    l2_loss: 0.029813    loss: 0.192839
steps 11600    v_Prec: 0.680163  v_Recall: 0.655054  v_F1: 0.667372  v_AUC: 0.898784
steps 11600    running time 382 seconds

steps 11800    base_loss: 0.106241    reg_loss: 0.066892    l2_loss: 0.029909    loss: 0.203042
steps 11800    v_Prec: 0.639931  v_Recall: 0.681502  v_F1: 0.660063  v_AUC: 0.897383
steps 11800    running time 387 seconds

steps 12000    base_loss: 0.099530    reg_loss: 0.066951    l2_loss: 0.030031    loss: 0.196513
steps 12000    v_Prec: 0.685416  v_Recall: 0.635797  v_F1: 0.659675  v_AUC: 0.896739
steps 12000    running time 393 seconds

steps 12200    base_loss: 0.098782    reg_loss: 0.066631    l2_loss: 0.030041    loss: 0.195453
steps 12200    v_Prec: 0.651766  v_Recall: 0.672233  v_F1: 0.661842  v_AUC: 0.897782
steps 12200    running time 399 seconds

Early stop model F1: 0.706603
testing thre: 0.42508093
testing Prec: 0.5333787710298813
testing Recall: 0.7226731470230863
testing F1: 0.6137620738050028
testing AUC: 0.8877499590627409
overall running time 402 seconds
(0.6634273772204806, 0.6171567436208991, 0.63945612488984, 0.8877499590627409, 0.65096474)

2019-02-24 15:53:35.003163: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:53:36.239462: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:53:36.241344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:53:36.241387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.200000 seconds
loading data in 31.340000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.288430    reg_loss: 0.065194    l2_loss: 0.013318    loss: 1.366942
steps 200    v_Prec: 0.163085  v_Recall: 1.000000  v_F1: 0.280435  v_AUC: 0.479461
steps 200    running time 41 seconds

steps 400    base_loss: 0.733954    reg_loss: 0.065354    l2_loss: 0.013229    loss: 0.812536
steps 400    v_Prec: 0.163085  v_Recall: 1.000000  v_F1: 0.280435  v_AUC: 0.493224
steps 400    running time 47 seconds

steps 600    base_loss: 0.474508    reg_loss: 0.065211    l2_loss: 0.013116    loss: 0.552835
steps 600    v_Prec: 0.163089  v_Recall: 1.000000  v_F1: 0.280442  v_AUC: 0.505194
steps 600    running time 53 seconds

steps 800    base_loss: 0.471252    reg_loss: 0.064994    l2_loss: 0.012945    loss: 0.549190
steps 800    v_Prec: 0.163111  v_Recall: 1.000000  v_F1: 0.280473  v_AUC: 0.516362
steps 800    running time 60 seconds

steps 1000    base_loss: 0.458903    reg_loss: 0.064467    l2_loss: 0.012605    loss: 0.535975
steps 1000    v_Prec: 0.163332  v_Recall: 0.994800  v_F1: 0.280595  v_AUC: 0.544859
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.453700    reg_loss: 0.064085    l2_loss: 0.012387    loss: 0.530172
steps 1200    v_Prec: 0.209949  v_Recall: 0.574046  v_F1: 0.307452  v_AUC: 0.610959
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.438428    reg_loss: 0.064029    l2_loss: 0.012230    loss: 0.514687
steps 1400    v_Prec: 0.402379  v_Recall: 0.411393  v_F1: 0.406836  v_AUC: 0.715116
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.409727    reg_loss: 0.064066    l2_loss: 0.012104    loss: 0.485897
steps 1600    v_Prec: 0.455630  v_Recall: 0.458437  v_F1: 0.457029  v_AUC: 0.762427
steps 1600    running time 84 seconds

steps 1800    base_loss: 0.378178    reg_loss: 0.064158    l2_loss: 0.012194    loss: 0.454529
steps 1800    v_Prec: 0.501117  v_Recall: 0.502440  v_F1: 0.501778  v_AUC: 0.792645
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.366295    reg_loss: 0.064838    l2_loss: 0.012377    loss: 0.443510
steps 2000    v_Prec: 0.542427  v_Recall: 0.527802  v_F1: 0.535015  v_AUC: 0.813735
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.337727    reg_loss: 0.065364    l2_loss: 0.012694    loss: 0.415785
steps 2200    v_Prec: 0.558361  v_Recall: 0.548444  v_F1: 0.553358  v_AUC: 0.827172
steps 2200    running time 102 seconds

steps 2400    base_loss: 0.323531    reg_loss: 0.065695    l2_loss: 0.012936    loss: 0.402162
steps 2400    v_Prec: 0.596972  v_Recall: 0.552124  v_F1: 0.573673  v_AUC: 0.838217
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.330268    reg_loss: 0.066135    l2_loss: 0.013243    loss: 0.409647
steps 2600    v_Prec: 0.595112  v_Recall: 0.582447  v_F1: 0.588711  v_AUC: 0.848122
steps 2600    running time 115 seconds

steps 2800    base_loss: 0.314035    reg_loss: 0.066292    l2_loss: 0.013496    loss: 0.393824
steps 2800    v_Prec: 0.593440  v_Recall: 0.597808  v_F1: 0.595616  v_AUC: 0.855357
steps 2800    running time 121 seconds

steps 3000    base_loss: 0.308288    reg_loss: 0.066474    l2_loss: 0.013863    loss: 0.388625
steps 3000    v_Prec: 0.627677  v_Recall: 0.593327  v_F1: 0.610019  v_AUC: 0.863395
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.310017    reg_loss: 0.066760    l2_loss: 0.014213    loss: 0.390990
steps 3200    v_Prec: 0.654085  v_Recall: 0.580926  v_F1: 0.615339  v_AUC: 0.868150
steps 3200    running time 133 seconds

steps 3400    base_loss: 0.303937    reg_loss: 0.066944    l2_loss: 0.014564    loss: 0.385444
steps 3400    v_Prec: 0.647278  v_Recall: 0.598288  v_F1: 0.621819  v_AUC: 0.872294
steps 3400    running time 139 seconds

steps 3600    base_loss: 0.300637    reg_loss: 0.067069    l2_loss: 0.015055    loss: 0.382761
steps 3600    v_Prec: 0.646045  v_Recall: 0.605728  v_F1: 0.625237  v_AUC: 0.876573
steps 3600    running time 146 seconds

steps 3800    base_loss: 0.289138    reg_loss: 0.066962    l2_loss: 0.015373    loss: 0.371473
steps 3800    v_Prec: 0.635232  v_Recall: 0.628930  v_F1: 0.632066  v_AUC: 0.880107
steps 3800    running time 152 seconds

steps 4000    base_loss: 0.286536    reg_loss: 0.066913    l2_loss: 0.015856    loss: 0.369305
steps 4000    v_Prec: 0.634139  v_Recall: 0.638451  v_F1: 0.636288  v_AUC: 0.882026
steps 4000    running time 158 seconds

steps 4200    base_loss: 0.292319    reg_loss: 0.066771    l2_loss: 0.016335    loss: 0.375424
steps 4200    v_Prec: 0.664539  v_Recall: 0.616369  v_F1: 0.639548  v_AUC: 0.885460
steps 4200    running time 164 seconds

steps 4400    base_loss: 0.287022    reg_loss: 0.066957    l2_loss: 0.016822    loss: 0.370801
steps 4400    v_Prec: 0.615459  v_Recall: 0.663813  v_F1: 0.638722  v_AUC: 0.885718
steps 4400    running time 170 seconds

steps 4600    base_loss: 0.288398    reg_loss: 0.066914    l2_loss: 0.017336    loss: 0.372648
steps 4600    v_Prec: 0.653194  v_Recall: 0.632291  v_F1: 0.642573  v_AUC: 0.888856
steps 4600    running time 176 seconds

steps 4800    base_loss: 0.286846    reg_loss: 0.066972    l2_loss: 0.017822    loss: 0.371640
steps 4800    v_Prec: 0.648760  v_Recall: 0.642531  v_F1: 0.645631  v_AUC: 0.890457
steps 4800    running time 182 seconds

steps 5000    base_loss: 0.277572    reg_loss: 0.066822    l2_loss: 0.018488    loss: 0.362882
steps 5000    v_Prec: 0.652709  v_Recall: 0.644772  v_F1: 0.648716  v_AUC: 0.891245
steps 5000    running time 188 seconds

steps 5200    base_loss: 0.279806    reg_loss: 0.067012    l2_loss: 0.019095    loss: 0.365913
steps 5200    v_Prec: 0.683797  v_Recall: 0.619570  v_F1: 0.650101  v_AUC: 0.892585
steps 5200    running time 194 seconds

steps 5400    base_loss: 0.273841    reg_loss: 0.066939    l2_loss: 0.019645    loss: 0.360426
steps 5400    v_Prec: 0.663354  v_Recall: 0.651572  v_F1: 0.657410  v_AUC: 0.895402
steps 5400    running time 200 seconds

steps 5600    base_loss: 0.192705    reg_loss: 0.068109    l2_loss: 0.020515    loss: 0.281329
steps 5600    v_Prec: 0.671323  v_Recall: 0.626690  v_F1: 0.648239  v_AUC: 0.890727
steps 5600    running time 207 seconds

steps 5800    base_loss: 0.203885    reg_loss: 0.067695    l2_loss: 0.021389    loss: 0.292970
steps 5800    v_Prec: 0.657929  v_Recall: 0.640611  v_F1: 0.649155  v_AUC: 0.891960
steps 5800    running time 212 seconds

steps 6000    base_loss: 0.199276    reg_loss: 0.067898    l2_loss: 0.021914    loss: 0.289088
steps 6000    v_Prec: 0.640540  v_Recall: 0.652532  v_F1: 0.646481  v_AUC: 0.890581
steps 6000    running time 218 seconds

steps 6200    base_loss: 0.201319    reg_loss: 0.067790    l2_loss: 0.022539    loss: 0.291648
steps 6200    v_Prec: 0.654954  v_Recall: 0.636771  v_F1: 0.645734  v_AUC: 0.889225
steps 6200    running time 224 seconds

steps 6400    base_loss: 0.202239    reg_loss: 0.067669    l2_loss: 0.023032    loss: 0.292940
steps 6400    v_Prec: 0.647316  v_Recall: 0.652132  v_F1: 0.649715  v_AUC: 0.890316
steps 6400    running time 230 seconds

steps 6600    base_loss: 0.210799    reg_loss: 0.067528    l2_loss: 0.023456    loss: 0.301782
steps 6600    v_Prec: 0.668612  v_Recall: 0.641651  v_F1: 0.654854  v_AUC: 0.891548
steps 6600    running time 235 seconds

steps 6800    base_loss: 0.211296    reg_loss: 0.067814    l2_loss: 0.023951    loss: 0.303061
steps 6800    v_Prec: 0.636599  v_Recall: 0.669094  v_F1: 0.652442  v_AUC: 0.891098
steps 6800    running time 241 seconds

steps 7000    base_loss: 0.202712    reg_loss: 0.067496    l2_loss: 0.024382    loss: 0.294590
steps 7000    v_Prec: 0.652122  v_Recall: 0.660053  v_F1: 0.656064  v_AUC: 0.893727
steps 7000    running time 247 seconds

steps 7200    base_loss: 0.201179    reg_loss: 0.067573    l2_loss: 0.024798    loss: 0.293550
steps 7200    v_Prec: 0.653837  v_Recall: 0.667333  v_F1: 0.660516  v_AUC: 0.892587
steps 7200    running time 253 seconds

steps 7400    base_loss: 0.206973    reg_loss: 0.067691    l2_loss: 0.025166    loss: 0.299830
steps 7400    v_Prec: 0.672317  v_Recall: 0.660053  v_F1: 0.666128  v_AUC: 0.897184
steps 7400    running time 259 seconds

steps 7600    base_loss: 0.201125    reg_loss: 0.067390    l2_loss: 0.025420    loss: 0.293935
steps 7600    v_Prec: 0.669899  v_Recall: 0.652212  v_F1: 0.660937  v_AUC: 0.895757
steps 7600    running time 265 seconds

steps 7800    base_loss: 0.205830    reg_loss: 0.067496    l2_loss: 0.025832    loss: 0.299157
steps 7800    v_Prec: 0.670794  v_Recall: 0.658773  v_F1: 0.664729  v_AUC: 0.898712
steps 7800    running time 271 seconds

steps 8000    base_loss: 0.209405    reg_loss: 0.067632    l2_loss: 0.026148    loss: 0.303185
steps 8000    v_Prec: 0.684517  v_Recall: 0.648372  v_F1: 0.665954  v_AUC: 0.899745
steps 8000    running time 276 seconds

steps 8200    base_loss: 0.209073    reg_loss: 0.067544    l2_loss: 0.026477    loss: 0.303094
steps 8200    v_Prec: 0.686411  v_Recall: 0.655492  v_F1: 0.670595  v_AUC: 0.900889
steps 8200    running time 282 seconds

steps 8400    base_loss: 0.201313    reg_loss: 0.067408    l2_loss: 0.026890    loss: 0.295611
steps 8400    v_Prec: 0.685465  v_Recall: 0.660293  v_F1: 0.672644  v_AUC: 0.903136
steps 8400    running time 289 seconds

steps 8600    base_loss: 0.198310    reg_loss: 0.067143    l2_loss: 0.027128    loss: 0.292581
steps 8600    v_Prec: 0.707065  v_Recall: 0.655812  v_F1: 0.680475  v_AUC: 0.904515
steps 8600    running time 295 seconds

steps 8800    base_loss: 0.204995    reg_loss: 0.067226    l2_loss: 0.027372    loss: 0.299594
steps 8800    v_Prec: 0.692232  v_Recall: 0.671574  v_F1: 0.681746  v_AUC: 0.905995
steps 8800    running time 301 seconds

steps 9000    base_loss: 0.203321    reg_loss: 0.067384    l2_loss: 0.027649    loss: 0.298354
steps 9000    v_Prec: 0.705628  v_Recall: 0.665093  v_F1: 0.684761  v_AUC: 0.908017
steps 9000    running time 307 seconds

steps 9200    base_loss: 0.204699    reg_loss: 0.067004    l2_loss: 0.027769    loss: 0.299473
steps 9200    v_Prec: 0.701959  v_Recall: 0.673654  v_F1: 0.687515  v_AUC: 0.908251
steps 9200    running time 313 seconds

steps 9400    base_loss: 0.205309    reg_loss: 0.067272    l2_loss: 0.028107    loss: 0.300688
steps 9400    v_Prec: 0.738980  v_Recall: 0.650532  v_F1: 0.691941  v_AUC: 0.909311
steps 9400    running time 319 seconds

steps 9600    base_loss: 0.207153    reg_loss: 0.067342    l2_loss: 0.028287    loss: 0.302782
steps 9600    v_Prec: 0.712505  v_Recall: 0.681495  v_F1: 0.696655  v_AUC: 0.911280
steps 9600    running time 325 seconds

steps 9800    base_loss: 0.202472    reg_loss: 0.067167    l2_loss: 0.028447    loss: 0.298086
steps 9800    v_Prec: 0.712601  v_Recall: 0.681815  v_F1: 0.696868  v_AUC: 0.913082
steps 9800    running time 331 seconds

steps 10000    base_loss: 0.193865    reg_loss: 0.067173    l2_loss: 0.028581    loss: 0.289619
steps 10000    v_Prec: 0.703769  v_Recall: 0.699096  v_F1: 0.701425  v_AUC: 0.915617
steps 10000    running time 337 seconds

steps 10200    base_loss: 0.199632    reg_loss: 0.067043    l2_loss: 0.028717    loss: 0.295391
steps 10200    v_Prec: 0.729218  v_Recall: 0.681495  v_F1: 0.704549  v_AUC: 0.917438
steps 10200    running time 343 seconds

steps 10400    base_loss: 0.198943    reg_loss: 0.066872    l2_loss: 0.028857    loss: 0.294671
steps 10400    v_Prec: 0.704737  v_Recall: 0.701016  v_F1: 0.702872  v_AUC: 0.918372
steps 10400    running time 350 seconds

steps 10600    base_loss: 0.199146    reg_loss: 0.067121    l2_loss: 0.029046    loss: 0.295314
steps 10600    v_Prec: 0.744264  v_Recall: 0.672214  v_F1: 0.706407  v_AUC: 0.918488
steps 10600    running time 355 seconds

steps 10800    base_loss: 0.190549    reg_loss: 0.066843    l2_loss: 0.029281    loss: 0.286673
steps 10800    v_Prec: 0.700503  v_Recall: 0.701736  v_F1: 0.701119  v_AUC: 0.918800
steps 10800    running time 361 seconds

steps 11000    base_loss: 0.094586    reg_loss: 0.066408    l2_loss: 0.029508    loss: 0.190502
steps 11000    v_Prec: 0.672344  v_Recall: 0.691655  v_F1: 0.681863  v_AUC: 0.908182
steps 11000    running time 367 seconds

steps 11200    base_loss: 0.094606    reg_loss: 0.066499    l2_loss: 0.029708    loss: 0.190812
steps 11200    v_Prec: 0.661653  v_Recall: 0.696856  v_F1: 0.678798  v_AUC: 0.905684
steps 11200    running time 373 seconds

steps 11400    base_loss: 0.090809    reg_loss: 0.065974    l2_loss: 0.029783    loss: 0.186567
steps 11400    v_Prec: 0.665001  v_Recall: 0.681335  v_F1: 0.673069  v_AUC: 0.903840
steps 11400    running time 379 seconds

steps 11600    base_loss: 0.092352    reg_loss: 0.066388    l2_loss: 0.029886    loss: 0.188626
steps 11600    v_Prec: 0.647077  v_Recall: 0.684455  v_F1: 0.665241  v_AUC: 0.900636
steps 11600    running time 385 seconds

steps 11800    base_loss: 0.094765    reg_loss: 0.066369    l2_loss: 0.030079    loss: 0.191213
steps 11800    v_Prec: 0.655638  v_Recall: 0.672214  v_F1: 0.663822  v_AUC: 0.899220
steps 11800    running time 390 seconds

steps 12000    base_loss: 0.096367    reg_loss: 0.066015    l2_loss: 0.030377    loss: 0.192760
steps 12000    v_Prec: 0.677776  v_Recall: 0.657333  v_F1: 0.667398  v_AUC: 0.900056
steps 12000    running time 396 seconds

steps 12200    base_loss: 0.102641    reg_loss: 0.066302    l2_loss: 0.030413    loss: 0.199357
steps 12200    v_Prec: 0.647182  v_Recall: 0.666133  v_F1: 0.656521  v_AUC: 0.895120
steps 12200    running time 402 seconds

steps 12400    base_loss: 0.096072    reg_loss: 0.066421    l2_loss: 0.030622    loss: 0.193115
steps 12400    v_Prec: 0.675867  v_Recall: 0.648452  v_F1: 0.661876  v_AUC: 0.898118
steps 12400    running time 408 seconds

steps 12600    base_loss: 0.101143    reg_loss: 0.065889    l2_loss: 0.030629    loss: 0.197661
steps 12600    v_Prec: 0.657731  v_Recall: 0.669414  v_F1: 0.663521  v_AUC: 0.898521
steps 12600    running time 414 seconds

Early stop model F1: 0.706407
testing thre: 0.46338394
testing Prec: 0.5388365529122833
testing Recall: 0.7144592952612394
testing F1: 0.6143430290872619
testing AUC: 0.8869457736053337
overall running time 417 seconds
(0.6474005961703633, 0.6227946537059539, 0.6348592944906858, 0.8869457736053337, 0.65368974)

2019-02-24 15:57:50.334744: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 15:57:51.122926: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 15:57:51.123897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 15:57:51.123944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.820000 seconds
loading data in 31.860000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.552028    reg_loss: 0.064695    l2_loss: 0.013276    loss: 0.629999
steps 200    v_Prec: 0.163592  v_Recall: 1.000000  v_F1: 0.281184  v_AUC: 0.479864
steps 200    running time 41 seconds

steps 400    base_loss: 0.497678    reg_loss: 0.064952    l2_loss: 0.013232    loss: 0.575862
steps 400    v_Prec: 0.163596  v_Recall: 1.000000  v_F1: 0.281190  v_AUC: 0.494492
steps 400    running time 47 seconds

steps 600    base_loss: 0.483584    reg_loss: 0.064813    l2_loss: 0.013051    loss: 0.561448
steps 600    v_Prec: 0.163676  v_Recall: 0.999521  v_F1: 0.281289  v_AUC: 0.524422
steps 600    running time 54 seconds

steps 800    base_loss: 0.464688    reg_loss: 0.064533    l2_loss: 0.012848    loss: 0.542070
steps 800    v_Prec: 0.184241  v_Recall: 0.684240  v_F1: 0.290312  v_AUC: 0.573932
steps 800    running time 60 seconds

steps 1000    base_loss: 0.445940    reg_loss: 0.064475    l2_loss: 0.012689    loss: 0.523104
steps 1000    v_Prec: 0.277546  v_Recall: 0.472324  v_F1: 0.349638  v_AUC: 0.667732
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.422294    reg_loss: 0.064473    l2_loss: 0.012618    loss: 0.499384
steps 1200    v_Prec: 0.414484  v_Recall: 0.408997  v_F1: 0.411722  v_AUC: 0.730671
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.399337    reg_loss: 0.064784    l2_loss: 0.012646    loss: 0.476767
steps 1400    v_Prec: 0.469085  v_Recall: 0.468336  v_F1: 0.468710  v_AUC: 0.775446
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.367559    reg_loss: 0.065065    l2_loss: 0.012712    loss: 0.445336
steps 1600    v_Prec: 0.526871  v_Recall: 0.513718  v_F1: 0.520212  v_AUC: 0.806999
steps 1600    running time 84 seconds

steps 1800    base_loss: 0.348673    reg_loss: 0.065231    l2_loss: 0.012917    loss: 0.426821
steps 1800    v_Prec: 0.562635  v_Recall: 0.540916  v_F1: 0.551561  v_AUC: 0.826537
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.332627    reg_loss: 0.065622    l2_loss: 0.013087    loss: 0.411336
steps 2000    v_Prec: 0.583583  v_Recall: 0.559659  v_F1: 0.571370  v_AUC: 0.841113
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.321033    reg_loss: 0.065679    l2_loss: 0.013297    loss: 0.400010
steps 2200    v_Prec: 0.606146  v_Recall: 0.567953  v_F1: 0.586428  v_AUC: 0.852907
steps 2200    running time 103 seconds

steps 2400    base_loss: 0.320562    reg_loss: 0.066147    l2_loss: 0.013489    loss: 0.400198
steps 2400    v_Prec: 0.609019  v_Recall: 0.587015  v_F1: 0.597815  v_AUC: 0.859095
steps 2400    running time 109 seconds

steps 2600    base_loss: 0.300921    reg_loss: 0.065995    l2_loss: 0.013701    loss: 0.380617
steps 2600    v_Prec: 0.637074  v_Recall: 0.584942  v_F1: 0.609896  v_AUC: 0.866011
steps 2600    running time 115 seconds

steps 2800    base_loss: 0.301341    reg_loss: 0.066105    l2_loss: 0.013994    loss: 0.381440
steps 2800    v_Prec: 0.610246  v_Recall: 0.628011  v_F1: 0.619001  v_AUC: 0.872753
steps 2800    running time 122 seconds

steps 3000    base_loss: 0.300140    reg_loss: 0.066321    l2_loss: 0.014309    loss: 0.380771
steps 3000    v_Prec: 0.631192  v_Recall: 0.622986  v_F1: 0.627062  v_AUC: 0.877764
steps 3000    running time 128 seconds

steps 3200    base_loss: 0.284511    reg_loss: 0.066394    l2_loss: 0.014629    loss: 0.365534
steps 3200    v_Prec: 0.633092  v_Recall: 0.628649  v_F1: 0.630863  v_AUC: 0.879768
steps 3200    running time 134 seconds

steps 3400    base_loss: 0.295404    reg_loss: 0.066514    l2_loss: 0.014890    loss: 0.376808
steps 3400    v_Prec: 0.649492  v_Recall: 0.632398  v_F1: 0.640831  v_AUC: 0.883289
steps 3400    running time 140 seconds

steps 3600    base_loss: 0.290515    reg_loss: 0.066591    l2_loss: 0.015243    loss: 0.372348
steps 3600    v_Prec: 0.635210  v_Recall: 0.650662  v_F1: 0.642843  v_AUC: 0.885337
steps 3600    running time 146 seconds

steps 3800    base_loss: 0.281076    reg_loss: 0.066486    l2_loss: 0.015655    loss: 0.363218
steps 3800    v_Prec: 0.650393  v_Recall: 0.633275  v_F1: 0.641720  v_AUC: 0.886934
steps 3800    running time 152 seconds

steps 4000    base_loss: 0.284656    reg_loss: 0.066527    l2_loss: 0.016005    loss: 0.367189
steps 4000    v_Prec: 0.654125  v_Recall: 0.632318  v_F1: 0.643037  v_AUC: 0.888646
steps 4000    running time 158 seconds

steps 4200    base_loss: 0.289484    reg_loss: 0.066761    l2_loss: 0.016491    loss: 0.372737
steps 4200    v_Prec: 0.659066  v_Recall: 0.633993  v_F1: 0.646286  v_AUC: 0.890282
steps 4200    running time 164 seconds

steps 4400    base_loss: 0.277381    reg_loss: 0.066443    l2_loss: 0.016882    loss: 0.360707
steps 4400    v_Prec: 0.672518  v_Recall: 0.638619  v_F1: 0.655130  v_AUC: 0.892465
steps 4400    running time 170 seconds

steps 4600    base_loss: 0.276118    reg_loss: 0.066679    l2_loss: 0.017412    loss: 0.360208
steps 4600    v_Prec: 0.671058  v_Recall: 0.637821  v_F1: 0.654018  v_AUC: 0.894531
steps 4600    running time 177 seconds

steps 4800    base_loss: 0.278350    reg_loss: 0.066566    l2_loss: 0.017908    loss: 0.362824
steps 4800    v_Prec: 0.651265  v_Recall: 0.650901  v_F1: 0.651083  v_AUC: 0.894345
steps 4800    running time 182 seconds

steps 5000    base_loss: 0.273747    reg_loss: 0.066464    l2_loss: 0.018400    loss: 0.358611
steps 5000    v_Prec: 0.681987  v_Recall: 0.630802  v_F1: 0.655397  v_AUC: 0.893845
steps 5000    running time 189 seconds

steps 5200    base_loss: 0.279470    reg_loss: 0.066505    l2_loss: 0.019074    loss: 0.365049
steps 5200    v_Prec: 0.651038  v_Recall: 0.665577  v_F1: 0.658227  v_AUC: 0.896910
steps 5200    running time 195 seconds

steps 5400    base_loss: 0.267656    reg_loss: 0.066438    l2_loss: 0.019558    loss: 0.353651
steps 5400    v_Prec: 0.680074  v_Recall: 0.648668  v_F1: 0.664000  v_AUC: 0.897801
steps 5400    running time 201 seconds

steps 5600    base_loss: 0.193116    reg_loss: 0.067332    l2_loss: 0.020355    loss: 0.280804
steps 5600    v_Prec: 0.680682  v_Recall: 0.633993  v_F1: 0.656508  v_AUC: 0.892566
steps 5600    running time 207 seconds

steps 5800    base_loss: 0.193462    reg_loss: 0.067160    l2_loss: 0.021124    loss: 0.281746
steps 5800    v_Prec: 0.645226  v_Recall: 0.667252  v_F1: 0.656054  v_AUC: 0.891128
steps 5800    running time 213 seconds

steps 6000    base_loss: 0.192738    reg_loss: 0.067271    l2_loss: 0.021737    loss: 0.281746
steps 6000    v_Prec: 0.649960  v_Recall: 0.654730  v_F1: 0.652336  v_AUC: 0.889846
steps 6000    running time 219 seconds

steps 6200    base_loss: 0.190566    reg_loss: 0.067388    l2_loss: 0.022389    loss: 0.280343
steps 6200    v_Prec: 0.661115  v_Recall: 0.645877  v_F1: 0.653407  v_AUC: 0.888887
steps 6200    running time 224 seconds

steps 6400    base_loss: 0.198498    reg_loss: 0.067290    l2_loss: 0.022977    loss: 0.288766
steps 6400    v_Prec: 0.662499  v_Recall: 0.655049  v_F1: 0.658753  v_AUC: 0.892010
steps 6400    running time 230 seconds

steps 6600    base_loss: 0.195415    reg_loss: 0.067424    l2_loss: 0.023496    loss: 0.286335
steps 6600    v_Prec: 0.664045  v_Recall: 0.653294  v_F1: 0.658626  v_AUC: 0.892967
steps 6600    running time 236 seconds

steps 6800    base_loss: 0.206128    reg_loss: 0.067335    l2_loss: 0.023903    loss: 0.297367
steps 6800    v_Prec: 0.694681  v_Recall: 0.632238  v_F1: 0.661990  v_AUC: 0.895356
steps 6800    running time 242 seconds

steps 7000    base_loss: 0.199187    reg_loss: 0.067209    l2_loss: 0.024319    loss: 0.290715
steps 7000    v_Prec: 0.674213  v_Recall: 0.655607  v_F1: 0.664780  v_AUC: 0.895419
steps 7000    running time 247 seconds

steps 7200    base_loss: 0.195423    reg_loss: 0.067138    l2_loss: 0.024770    loss: 0.287331
steps 7200    v_Prec: 0.665089  v_Recall: 0.661429  v_F1: 0.663254  v_AUC: 0.895860
steps 7200    running time 254 seconds

steps 7400    base_loss: 0.193705    reg_loss: 0.067256    l2_loss: 0.025197    loss: 0.286158
steps 7400    v_Prec: 0.693469  v_Recall: 0.641091  v_F1: 0.666252  v_AUC: 0.897982
steps 7400    running time 259 seconds

steps 7600    base_loss: 0.197532    reg_loss: 0.066881    l2_loss: 0.025536    loss: 0.289948
steps 7600    v_Prec: 0.658725  v_Recall: 0.679215  v_F1: 0.668813  v_AUC: 0.899735
steps 7600    running time 266 seconds

steps 7800    base_loss: 0.198801    reg_loss: 0.066979    l2_loss: 0.025823    loss: 0.291604
steps 7800    v_Prec: 0.694197  v_Recall: 0.651619  v_F1: 0.672234  v_AUC: 0.899044
steps 7800    running time 271 seconds

steps 8000    base_loss: 0.202136    reg_loss: 0.067109    l2_loss: 0.026116    loss: 0.295361
steps 8000    v_Prec: 0.714652  v_Recall: 0.644999  v_F1: 0.678041  v_AUC: 0.903156
steps 8000    running time 278 seconds

steps 8200    base_loss: 0.206460    reg_loss: 0.067000    l2_loss: 0.026407    loss: 0.299867
steps 8200    v_Prec: 0.702259  v_Recall: 0.661988  v_F1: 0.681529  v_AUC: 0.903350
steps 8200    running time 284 seconds

steps 8400    base_loss: 0.200501    reg_loss: 0.067076    l2_loss: 0.026675    loss: 0.294252
steps 8400    v_Prec: 0.720556  v_Recall: 0.645558  v_F1: 0.680998  v_AUC: 0.904213
steps 8400    running time 290 seconds

steps 8600    base_loss: 0.201864    reg_loss: 0.067124    l2_loss: 0.026915    loss: 0.295902
steps 8600    v_Prec: 0.713037  v_Recall: 0.650822  v_F1: 0.680510  v_AUC: 0.904554
steps 8600    running time 296 seconds

steps 8800    base_loss: 0.198740    reg_loss: 0.067027    l2_loss: 0.027145    loss: 0.292912
steps 8800    v_Prec: 0.707418  v_Recall: 0.665497  v_F1: 0.685818  v_AUC: 0.907897
steps 8800    running time 301 seconds

steps 9000    base_loss: 0.205718    reg_loss: 0.067174    l2_loss: 0.027520    loss: 0.300412
steps 9000    v_Prec: 0.708396  v_Recall: 0.674270  v_F1: 0.690912  v_AUC: 0.910100
steps 9000    running time 308 seconds

steps 9200    base_loss: 0.197249    reg_loss: 0.066757    l2_loss: 0.027745    loss: 0.291751
steps 9200    v_Prec: 0.703317  v_Recall: 0.681608  v_F1: 0.692292  v_AUC: 0.909043
steps 9200    running time 313 seconds

steps 9400    base_loss: 0.199298    reg_loss: 0.066904    l2_loss: 0.028020    loss: 0.294222
steps 9400    v_Prec: 0.728384  v_Recall: 0.669884  v_F1: 0.697910  v_AUC: 0.912406
steps 9400    running time 320 seconds

steps 9600    base_loss: 0.195201    reg_loss: 0.066802    l2_loss: 0.028210    loss: 0.290214
steps 9600    v_Prec: 0.728976  v_Recall: 0.667172  v_F1: 0.696706  v_AUC: 0.911465
steps 9600    running time 326 seconds

steps 9800    base_loss: 0.203804    reg_loss: 0.066868    l2_loss: 0.028384    loss: 0.299056
steps 9800    v_Prec: 0.739919  v_Recall: 0.670282  v_F1: 0.703381  v_AUC: 0.914531
steps 9800    running time 331 seconds

steps 10000    base_loss: 0.189957    reg_loss: 0.066824    l2_loss: 0.028480    loss: 0.285261
steps 10000    v_Prec: 0.720485  v_Recall: 0.687271  v_F1: 0.703486  v_AUC: 0.913466
steps 10000    running time 338 seconds

steps 10200    base_loss: 0.195880    reg_loss: 0.066412    l2_loss: 0.028687    loss: 0.290979
steps 10200    v_Prec: 0.725099  v_Recall: 0.689185  v_F1: 0.706686  v_AUC: 0.916818
steps 10200    running time 344 seconds

steps 10400    base_loss: 0.197005    reg_loss: 0.066682    l2_loss: 0.028865    loss: 0.292552
steps 10400    v_Prec: 0.719904  v_Recall: 0.696363  v_F1: 0.707938  v_AUC: 0.916888
steps 10400    running time 350 seconds

steps 10600    base_loss: 0.192326    reg_loss: 0.066778    l2_loss: 0.029081    loss: 0.288185
steps 10600    v_Prec: 0.739885  v_Recall: 0.676743  v_F1: 0.706907  v_AUC: 0.917357
steps 10600    running time 356 seconds

steps 10800    base_loss: 0.185503    reg_loss: 0.066403    l2_loss: 0.029177    loss: 0.281082
steps 10800    v_Prec: 0.716262  v_Recall: 0.698038  v_F1: 0.707032  v_AUC: 0.918084
steps 10800    running time 362 seconds

steps 11000    base_loss: 0.092674    reg_loss: 0.066044    l2_loss: 0.029467    loss: 0.188185
steps 11000    v_Prec: 0.703753  v_Recall: 0.677540  v_F1: 0.690398  v_AUC: 0.909094
steps 11000    running time 367 seconds

steps 11200    base_loss: 0.093917    reg_loss: 0.065894    l2_loss: 0.029566    loss: 0.189377
steps 11200    v_Prec: 0.682937  v_Recall: 0.675148  v_F1: 0.679020  v_AUC: 0.903254
steps 11200    running time 373 seconds

steps 11400    base_loss: 0.093608    reg_loss: 0.065827    l2_loss: 0.029609    loss: 0.189044
steps 11400    v_Prec: 0.685831  v_Recall: 0.669804  v_F1: 0.677723  v_AUC: 0.903490
steps 11400    running time 379 seconds

steps 11600    base_loss: 0.095030    reg_loss: 0.066013    l2_loss: 0.029821    loss: 0.190863
steps 11600    v_Prec: 0.682862  v_Recall: 0.680412  v_F1: 0.681635  v_AUC: 0.904245
steps 11600    running time 385 seconds

steps 11800    base_loss: 0.096966    reg_loss: 0.065562    l2_loss: 0.030080    loss: 0.192608
steps 11800    v_Prec: 0.692813  v_Recall: 0.656564  v_F1: 0.674201  v_AUC: 0.899428
steps 11800    running time 391 seconds

steps 12000    base_loss: 0.097979    reg_loss: 0.065689    l2_loss: 0.030172    loss: 0.193840
steps 12000    v_Prec: 0.669406  v_Recall: 0.675706  v_F1: 0.672541  v_AUC: 0.899360
steps 12000    running time 397 seconds

steps 12200    base_loss: 0.096541    reg_loss: 0.065693    l2_loss: 0.030261    loss: 0.192495
steps 12200    v_Prec: 0.686765  v_Recall: 0.656803  v_F1: 0.671450  v_AUC: 0.898199
steps 12200    running time 402 seconds

steps 12400    base_loss: 0.102630    reg_loss: 0.065546    l2_loss: 0.030279    loss: 0.198455
steps 12400    v_Prec: 0.675268  v_Recall: 0.667890  v_F1: 0.671559  v_AUC: 0.899010
steps 12400    running time 408 seconds

Early stop model F1: 0.707938
testing thre: 0.43012592
testing Prec: 0.5202374893977948
testing Recall: 0.745273390036452
testing F1: 0.6127472527472528
testing AUC: 0.892655505092544
overall running time 411 seconds
(0.6806104226419178, 0.6112758201701094, 0.6440825523633943, 0.892655505092544, 0.72694)

2019-02-24 16:02:00.355162: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:02:01.755393: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:02:01.760817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:02:01.760904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.800000 seconds
loading data in 30.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.481674    reg_loss: 0.065006    l2_loss: 0.013351    loss: 0.560032
steps 200    v_Prec: 0.164182  v_Recall: 0.966058  v_F1: 0.280664  v_AUC: 0.515250
steps 200    running time 40 seconds

steps 400    base_loss: 0.465338    reg_loss: 0.064839    l2_loss: 0.013246    loss: 0.543423
steps 400    v_Prec: 0.167909  v_Recall: 0.903698  v_F1: 0.283198  v_AUC: 0.537964
steps 400    running time 47 seconds

steps 600    base_loss: 0.460788    reg_loss: 0.064592    l2_loss: 0.013097    loss: 0.538477
steps 600    v_Prec: 0.177567  v_Recall: 0.801553  v_F1: 0.290729  v_AUC: 0.569959
steps 600    running time 53 seconds

steps 800    base_loss: 0.456076    reg_loss: 0.064276    l2_loss: 0.012923    loss: 0.533274
steps 800    v_Prec: 0.197043  v_Recall: 0.690202  v_F1: 0.306565  v_AUC: 0.607532
steps 800    running time 59 seconds

steps 1000    base_loss: 0.445445    reg_loss: 0.063313    l2_loss: 0.012767    loss: 0.521524
steps 1000    v_Prec: 0.245559  v_Recall: 0.516811  v_F1: 0.332929  v_AUC: 0.649191
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.435867    reg_loss: 0.062399    l2_loss: 0.012614    loss: 0.510880
steps 1200    v_Prec: 0.308143  v_Recall: 0.446206  v_F1: 0.364540  v_AUC: 0.690172
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.419485    reg_loss: 0.061524    l2_loss: 0.012639    loss: 0.493648
steps 1400    v_Prec: 0.352378  v_Recall: 0.485831  v_F1: 0.408481  v_AUC: 0.739144
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.399363    reg_loss: 0.061010    l2_loss: 0.012748    loss: 0.473121
steps 1600    v_Prec: 0.401862  v_Recall: 0.525296  v_F1: 0.455362  v_AUC: 0.775782
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.372993    reg_loss: 0.060547    l2_loss: 0.012995    loss: 0.446536
steps 1800    v_Prec: 0.479236  v_Recall: 0.509926  v_F1: 0.494105  v_AUC: 0.801176
steps 1800    running time 89 seconds

steps 2000    base_loss: 0.356787    reg_loss: 0.060075    l2_loss: 0.013334    loss: 0.430196
steps 2000    v_Prec: 0.466692  v_Recall: 0.578770  v_F1: 0.516724  v_AUC: 0.816863
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.346713    reg_loss: 0.059463    l2_loss: 0.013672    loss: 0.419848
steps 2200    v_Prec: 0.500000  v_Recall: 0.587976  v_F1: 0.540431  v_AUC: 0.832513
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.341513    reg_loss: 0.058917    l2_loss: 0.014072    loss: 0.414502
steps 2400    v_Prec: 0.535296  v_Recall: 0.563321  v_F1: 0.548951  v_AUC: 0.839118
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.335446    reg_loss: 0.058502    l2_loss: 0.014505    loss: 0.408453
steps 2600    v_Prec: 0.540381  v_Recall: 0.594541  v_F1: 0.566169  v_AUC: 0.847030
steps 2600    running time 114 seconds

steps 2800    base_loss: 0.332015    reg_loss: 0.058076    l2_loss: 0.014808    loss: 0.404900
steps 2800    v_Prec: 0.544122  v_Recall: 0.609110  v_F1: 0.574785  v_AUC: 0.852903
steps 2800    running time 120 seconds

steps 3000    base_loss: 0.329513    reg_loss: 0.057418    l2_loss: 0.015273    loss: 0.402204
steps 3000    v_Prec: 0.558432  v_Recall: 0.604387  v_F1: 0.580501  v_AUC: 0.857231
steps 3000    running time 126 seconds

steps 3200    base_loss: 0.322415    reg_loss: 0.056879    l2_loss: 0.015758    loss: 0.395052
steps 3200    v_Prec: 0.573214  v_Recall: 0.601985  v_F1: 0.587248  v_AUC: 0.860654
steps 3200    running time 132 seconds

steps 3400    base_loss: 0.322500    reg_loss: 0.056357    l2_loss: 0.016234    loss: 0.395091
steps 3400    v_Prec: 0.582006  v_Recall: 0.602786  v_F1: 0.592214  v_AUC: 0.864131
steps 3400    running time 138 seconds

steps 3600    base_loss: 0.312660    reg_loss: 0.055645    l2_loss: 0.016700    loss: 0.385005
steps 3600    v_Prec: 0.587532  v_Recall: 0.613353  v_F1: 0.600164  v_AUC: 0.867469
steps 3600    running time 144 seconds

steps 3800    base_loss: 0.313484    reg_loss: 0.055149    l2_loss: 0.017298    loss: 0.385930
steps 3800    v_Prec: 0.608394  v_Recall: 0.604547  v_F1: 0.606465  v_AUC: 0.871060
steps 3800    running time 150 seconds

steps 4000    base_loss: 0.316258    reg_loss: 0.054788    l2_loss: 0.017878    loss: 0.388924
steps 4000    v_Prec: 0.603120  v_Recall: 0.612872  v_F1: 0.607957  v_AUC: 0.872829
steps 4000    running time 157 seconds

steps 4200    base_loss: 0.313108    reg_loss: 0.054005    l2_loss: 0.018469    loss: 0.385582
steps 4200    v_Prec: 0.604487  v_Recall: 0.629843  v_F1: 0.616905  v_AUC: 0.875793
steps 4200    running time 163 seconds

steps 4400    base_loss: 0.308609    reg_loss: 0.053350    l2_loss: 0.019081    loss: 0.381040
steps 4400    v_Prec: 0.588031  v_Recall: 0.651297  v_F1: 0.618049  v_AUC: 0.877283
steps 4400    running time 169 seconds

steps 4600    base_loss: 0.306074    reg_loss: 0.052856    l2_loss: 0.019780    loss: 0.378710
steps 4600    v_Prec: 0.610342  v_Recall: 0.632085  v_F1: 0.621023  v_AUC: 0.879351
steps 4600    running time 175 seconds

steps 4800    base_loss: 0.304363    reg_loss: 0.052137    l2_loss: 0.020444    loss: 0.376945
steps 4800    v_Prec: 0.623089  v_Recall: 0.623039  v_F1: 0.623064  v_AUC: 0.880767
steps 4800    running time 181 seconds

steps 5000    base_loss: 0.300437    reg_loss: 0.051724    l2_loss: 0.021190    loss: 0.373350
steps 5000    v_Prec: 0.600699  v_Recall: 0.646574  v_F1: 0.622793  v_AUC: 0.881341
steps 5000    running time 187 seconds

steps 5200    base_loss: 0.300715    reg_loss: 0.051133    l2_loss: 0.021976    loss: 0.373824
steps 5200    v_Prec: 0.624922  v_Recall: 0.637528  v_F1: 0.631162  v_AUC: 0.883073
steps 5200    running time 193 seconds

steps 5400    base_loss: 0.295776    reg_loss: 0.050719    l2_loss: 0.022670    loss: 0.369165
steps 5400    v_Prec: 0.618365  v_Recall: 0.642571  v_F1: 0.630236  v_AUC: 0.883189
steps 5400    running time 199 seconds

steps 5600    base_loss: 0.196469    reg_loss: 0.052394    l2_loss: 0.023326    loss: 0.272189
steps 5600    v_Prec: 0.625655  v_Recall: 0.621598  v_F1: 0.623620  v_AUC: 0.880155
steps 5600    running time 205 seconds

steps 5800    base_loss: 0.191684    reg_loss: 0.053144    l2_loss: 0.023770    loss: 0.268597
steps 5800    v_Prec: 0.621295  v_Recall: 0.620797  v_F1: 0.621046  v_AUC: 0.877598
steps 5800    running time 211 seconds

steps 6000    base_loss: 0.190894    reg_loss: 0.053650    l2_loss: 0.024357    loss: 0.268901
steps 6000    v_Prec: 0.585199  v_Recall: 0.648815  v_F1: 0.615367  v_AUC: 0.873722
steps 6000    running time 217 seconds

steps 6200    base_loss: 0.189339    reg_loss: 0.053305    l2_loss: 0.024887    loss: 0.267531
steps 6200    v_Prec: 0.600696  v_Recall: 0.635367  v_F1: 0.617545  v_AUC: 0.873463
steps 6200    running time 223 seconds

steps 6400    base_loss: 0.196009    reg_loss: 0.053270    l2_loss: 0.025291    loss: 0.274569
steps 6400    v_Prec: 0.576044  v_Recall: 0.653698  v_F1: 0.612419  v_AUC: 0.873908
steps 6400    running time 229 seconds

steps 6600    base_loss: 0.194891    reg_loss: 0.053499    l2_loss: 0.025616    loss: 0.274006
steps 6600    v_Prec: 0.582963  v_Recall: 0.640410  v_F1: 0.610338  v_AUC: 0.871951
steps 6600    running time 235 seconds

steps 6800    base_loss: 0.202679    reg_loss: 0.053090    l2_loss: 0.026134    loss: 0.281903
steps 6800    v_Prec: 0.566798  v_Recall: 0.666346  v_F1: 0.612554  v_AUC: 0.874813
steps 6800    running time 240 seconds

steps 7000    base_loss: 0.197849    reg_loss: 0.052668    l2_loss: 0.026498    loss: 0.277014
steps 7000    v_Prec: 0.598210  v_Recall: 0.636567  v_F1: 0.616793  v_AUC: 0.874997
steps 7000    running time 246 seconds

steps 7200    base_loss: 0.197645    reg_loss: 0.052487    l2_loss: 0.026821    loss: 0.276953
steps 7200    v_Prec: 0.594021  v_Recall: 0.641050  v_F1: 0.616640  v_AUC: 0.875509
steps 7200    running time 252 seconds

Early stop model F1: 0.631162
testing thre: 0.35503697
testing Prec: 0.45449505682343155
testing Recall: 0.7172296476306197
testing F1: 0.5564060025639092
testing AUC: 0.8575675699797333
overall running time 255 seconds
(0.5728629200948264, 0.5989793438639125, 0.5856301083444212, 0.8575675699797333, 0.5484379)

2019-02-24 16:04:42.300916: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:04:42.724280: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:04:42.726633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:04:42.726684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.340000 seconds
loading data in 31.490000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.596974    reg_loss: 0.064869    l2_loss: 0.013345    loss: 0.675188
steps 200    v_Prec: 0.163749  v_Recall: 0.940650  v_F1: 0.278940  v_AUC: 0.524565
steps 200    running time 41 seconds

steps 400    base_loss: 0.512468    reg_loss: 0.064412    l2_loss: 0.013264    loss: 0.590144
steps 400    v_Prec: 0.165449  v_Recall: 0.925651  v_F1: 0.280722  v_AUC: 0.540561
steps 400    running time 47 seconds

steps 600    base_loss: 0.491764    reg_loss: 0.064046    l2_loss: 0.013143    loss: 0.568953
steps 600    v_Prec: 0.171388  v_Recall: 0.814692  v_F1: 0.283199  v_AUC: 0.557371
steps 600    running time 53 seconds

steps 800    base_loss: 0.458141    reg_loss: 0.063533    l2_loss: 0.013101    loss: 0.534774
steps 800    v_Prec: 0.186820  v_Recall: 0.715749  v_F1: 0.296301  v_AUC: 0.587358
steps 800    running time 59 seconds

steps 1000    base_loss: 0.442315    reg_loss: 0.062706    l2_loss: 0.013077    loss: 0.518099
steps 1000    v_Prec: 0.233994  v_Recall: 0.541085  v_F1: 0.326704  v_AUC: 0.644987
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.428494    reg_loss: 0.061703    l2_loss: 0.013067    loss: 0.503263
steps 1200    v_Prec: 0.285040  v_Recall: 0.511007  v_F1: 0.365952  v_AUC: 0.696436
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.416317    reg_loss: 0.060856    l2_loss: 0.013121    loss: 0.490295
steps 1400    v_Prec: 0.339371  v_Recall: 0.506169  v_F1: 0.406318  v_AUC: 0.738615
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.395039    reg_loss: 0.059859    l2_loss: 0.013292    loss: 0.468189
steps 1600    v_Prec: 0.431191  v_Recall: 0.476010  v_F1: 0.452493  v_AUC: 0.773247
steps 1600    running time 84 seconds

steps 1800    base_loss: 0.384281    reg_loss: 0.059126    l2_loss: 0.013431    loss: 0.456838
steps 1800    v_Prec: 0.447741  v_Recall: 0.545117  v_F1: 0.491654  v_AUC: 0.801504
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.349050    reg_loss: 0.057786    l2_loss: 0.013675    loss: 0.420511
steps 2000    v_Prec: 0.519696  v_Recall: 0.529796  v_F1: 0.524698  v_AUC: 0.821583
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.346354    reg_loss: 0.057192    l2_loss: 0.013952    loss: 0.417499
steps 2200    v_Prec: 0.557532  v_Recall: 0.556004  v_F1: 0.556767  v_AUC: 0.836017
steps 2200    running time 102 seconds

steps 2400    base_loss: 0.338629    reg_loss: 0.056354    l2_loss: 0.014214    loss: 0.409197
steps 2400    v_Prec: 0.590425  v_Recall: 0.567857  v_F1: 0.578921  v_AUC: 0.848137
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.324601    reg_loss: 0.055382    l2_loss: 0.014555    loss: 0.394538
steps 2600    v_Prec: 0.615492  v_Recall: 0.569631  v_F1: 0.591674  v_AUC: 0.856351
steps 2600    running time 115 seconds

steps 2800    base_loss: 0.312910    reg_loss: 0.054266    l2_loss: 0.014837    loss: 0.382013
steps 2800    v_Prec: 0.643878  v_Recall: 0.574147  v_F1: 0.607016  v_AUC: 0.863946
steps 2800    running time 121 seconds

steps 3000    base_loss: 0.310108    reg_loss: 0.053720    l2_loss: 0.015226    loss: 0.379055
steps 3000    v_Prec: 0.646216  v_Recall: 0.596242  v_F1: 0.620224  v_AUC: 0.869126
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.301934    reg_loss: 0.052966    l2_loss: 0.015575    loss: 0.370474
steps 3200    v_Prec: 0.648822  v_Recall: 0.595194  v_F1: 0.620852  v_AUC: 0.871484
steps 3200    running time 134 seconds

steps 3400    base_loss: 0.301067    reg_loss: 0.052217    l2_loss: 0.015889    loss: 0.369173
steps 3400    v_Prec: 0.672036  v_Recall: 0.595516  v_F1: 0.631466  v_AUC: 0.875114
steps 3400    running time 140 seconds

steps 3600    base_loss: 0.297928    reg_loss: 0.051278    l2_loss: 0.016222    loss: 0.365428
steps 3600    v_Prec: 0.668655  v_Recall: 0.614628  v_F1: 0.640504  v_AUC: 0.880086
steps 3600    running time 146 seconds

steps 3800    base_loss: 0.291092    reg_loss: 0.050643    l2_loss: 0.016566    loss: 0.358301
steps 3800    v_Prec: 0.685403  v_Recall: 0.614547  v_F1: 0.648044  v_AUC: 0.881416
steps 3800    running time 152 seconds

steps 4000    base_loss: 0.286757    reg_loss: 0.049849    l2_loss: 0.016908    loss: 0.353513
steps 4000    v_Prec: 0.692184  v_Recall: 0.627046  v_F1: 0.658007  v_AUC: 0.883982
steps 4000    running time 158 seconds

steps 4200    base_loss: 0.286390    reg_loss: 0.049428    l2_loss: 0.017297    loss: 0.353115
steps 4200    v_Prec: 0.706770  v_Recall: 0.615354  v_F1: 0.657902  v_AUC: 0.885666
steps 4200    running time 165 seconds

steps 4400    base_loss: 0.283657    reg_loss: 0.048795    l2_loss: 0.017678    loss: 0.350130
steps 4400    v_Prec: 0.692199  v_Recall: 0.634707  v_F1: 0.662208  v_AUC: 0.887055
steps 4400    running time 170 seconds

steps 4600    base_loss: 0.281023    reg_loss: 0.048366    l2_loss: 0.018058    loss: 0.347446
steps 4600    v_Prec: 0.694975  v_Recall: 0.636803  v_F1: 0.664619  v_AUC: 0.889269
steps 4600    running time 177 seconds

steps 4800    base_loss: 0.283809    reg_loss: 0.048049    l2_loss: 0.018400    loss: 0.350258
steps 4800    v_Prec: 0.705683  v_Recall: 0.636884  v_F1: 0.669521  v_AUC: 0.892398
steps 4800    running time 183 seconds

steps 5000    base_loss: 0.275048    reg_loss: 0.047488    l2_loss: 0.018721    loss: 0.341257
steps 5000    v_Prec: 0.692069  v_Recall: 0.648093  v_F1: 0.669360  v_AUC: 0.890582
steps 5000    running time 189 seconds

steps 5200    base_loss: 0.278691    reg_loss: 0.047239    l2_loss: 0.019193    loss: 0.345124
steps 5200    v_Prec: 0.701706  v_Recall: 0.656721  v_F1: 0.678469  v_AUC: 0.892819
steps 5200    running time 195 seconds

steps 5400    base_loss: 0.271788    reg_loss: 0.046950    l2_loss: 0.019651    loss: 0.338389
steps 5400    v_Prec: 0.724294  v_Recall: 0.643577  v_F1: 0.681554  v_AUC: 0.895185
steps 5400    running time 201 seconds

steps 5600    base_loss: 0.193000    reg_loss: 0.045801    l2_loss: 0.020026    loss: 0.258828
steps 5600    v_Prec: 0.696119  v_Recall: 0.643577  v_F1: 0.668818  v_AUC: 0.891215
steps 5600    running time 207 seconds

steps 5800    base_loss: 0.190139    reg_loss: 0.046447    l2_loss: 0.020829    loss: 0.257415
steps 5800    v_Prec: 0.726466  v_Recall: 0.620434  v_F1: 0.669276  v_AUC: 0.889020
steps 5800    running time 213 seconds

steps 6000    base_loss: 0.197323    reg_loss: 0.046569    l2_loss: 0.021619    loss: 0.265511
steps 6000    v_Prec: 0.701422  v_Recall: 0.632530  v_F1: 0.665197  v_AUC: 0.885631
steps 6000    running time 219 seconds

steps 6200    base_loss: 0.193500    reg_loss: 0.046106    l2_loss: 0.022346    loss: 0.261952
steps 6200    v_Prec: 0.708121  v_Recall: 0.637771  v_F1: 0.671107  v_AUC: 0.886776
steps 6200    running time 225 seconds

steps 6400    base_loss: 0.195649    reg_loss: 0.045829    l2_loss: 0.022929    loss: 0.264407
steps 6400    v_Prec: 0.715016  v_Recall: 0.632046  v_F1: 0.670975  v_AUC: 0.888570
steps 6400    running time 230 seconds

steps 6600    base_loss: 0.193464    reg_loss: 0.045380    l2_loss: 0.023439    loss: 0.262282
steps 6600    v_Prec: 0.687468  v_Recall: 0.657366  v_F1: 0.672080  v_AUC: 0.890103
steps 6600    running time 236 seconds

steps 6800    base_loss: 0.201169    reg_loss: 0.045343    l2_loss: 0.023847    loss: 0.270359
steps 6800    v_Prec: 0.728453  v_Recall: 0.633175  v_F1: 0.677481  v_AUC: 0.891430
steps 6800    running time 242 seconds

steps 7000    base_loss: 0.200375    reg_loss: 0.045067    l2_loss: 0.024178    loss: 0.269620
steps 7000    v_Prec: 0.725388  v_Recall: 0.637529  v_F1: 0.678627  v_AUC: 0.891174
steps 7000    running time 248 seconds

steps 7200    base_loss: 0.201458    reg_loss: 0.044905    l2_loss: 0.024589    loss: 0.270951
steps 7200    v_Prec: 0.727063  v_Recall: 0.633900  v_F1: 0.677293  v_AUC: 0.890201
steps 7200    running time 254 seconds

steps 7400    base_loss: 0.203389    reg_loss: 0.044684    l2_loss: 0.024916    loss: 0.272988
steps 7400    v_Prec: 0.727414  v_Recall: 0.642126  v_F1: 0.682114  v_AUC: 0.893690
steps 7400    running time 260 seconds

steps 7600    base_loss: 0.203649    reg_loss: 0.044385    l2_loss: 0.025136    loss: 0.273170
steps 7600    v_Prec: 0.711665  v_Recall: 0.663172  v_F1: 0.686563  v_AUC: 0.894032
steps 7600    running time 266 seconds

steps 7800    base_loss: 0.191738    reg_loss: 0.043656    l2_loss: 0.025266    loss: 0.260661
steps 7800    v_Prec: 0.738993  v_Recall: 0.641561  v_F1: 0.686839  v_AUC: 0.896073
steps 7800    running time 272 seconds

steps 8000    base_loss: 0.206242    reg_loss: 0.043938    l2_loss: 0.025589    loss: 0.275769
steps 8000    v_Prec: 0.709601  v_Recall: 0.673494  v_F1: 0.691076  v_AUC: 0.896512
steps 8000    running time 278 seconds

steps 8200    base_loss: 0.205091    reg_loss: 0.043548    l2_loss: 0.025748    loss: 0.274387
steps 8200    v_Prec: 0.699884  v_Recall: 0.683574  v_F1: 0.691633  v_AUC: 0.897063
steps 8200    running time 284 seconds

steps 8400    base_loss: 0.203847    reg_loss: 0.043451    l2_loss: 0.025988    loss: 0.273286
steps 8400    v_Prec: 0.715309  v_Recall: 0.676316  v_F1: 0.695267  v_AUC: 0.900192
steps 8400    running time 290 seconds

steps 8600    base_loss: 0.197630    reg_loss: 0.042979    l2_loss: 0.026202    loss: 0.266811
steps 8600    v_Prec: 0.711788  v_Recall: 0.676316  v_F1: 0.693599  v_AUC: 0.900152
steps 8600    running time 296 seconds

steps 8800    base_loss: 0.212823    reg_loss: 0.042796    l2_loss: 0.026348    loss: 0.281966
steps 8800    v_Prec: 0.730365  v_Recall: 0.678655  v_F1: 0.703561  v_AUC: 0.905666
steps 8800    running time 302 seconds

steps 9000    base_loss: 0.205425    reg_loss: 0.042480    l2_loss: 0.026567    loss: 0.274471
steps 9000    v_Prec: 0.736115  v_Recall: 0.674381  v_F1: 0.703897  v_AUC: 0.903967
steps 9000    running time 308 seconds

steps 9200    base_loss: 0.211074    reg_loss: 0.042443    l2_loss: 0.026447    loss: 0.279964
steps 9200    v_Prec: 0.729634  v_Recall: 0.679623  v_F1: 0.703741  v_AUC: 0.905266
steps 9200    running time 314 seconds

steps 9400    base_loss: 0.205561    reg_loss: 0.042275    l2_loss: 0.026603    loss: 0.274438
steps 9400    v_Prec: 0.733911  v_Recall: 0.683251  v_F1: 0.707676  v_AUC: 0.906532
steps 9400    running time 320 seconds

steps 9600    base_loss: 0.203152    reg_loss: 0.041838    l2_loss: 0.026937    loss: 0.271927
steps 9600    v_Prec: 0.746667  v_Recall: 0.677365  v_F1: 0.710329  v_AUC: 0.906677
steps 9600    running time 326 seconds

steps 9800    base_loss: 0.210367    reg_loss: 0.041867    l2_loss: 0.026923    loss: 0.279156
steps 9800    v_Prec: 0.747354  v_Recall: 0.683413  v_F1: 0.713955  v_AUC: 0.908600
steps 9800    running time 332 seconds

steps 10000    base_loss: 0.206388    reg_loss: 0.041470    l2_loss: 0.027021    loss: 0.274879
steps 10000    v_Prec: 0.740304  v_Recall: 0.694218  v_F1: 0.716521  v_AUC: 0.911915
steps 10000    running time 338 seconds

steps 10200    base_loss: 0.198282    reg_loss: 0.041126    l2_loss: 0.027179    loss: 0.266588
steps 10200    v_Prec: 0.750618  v_Recall: 0.686154  v_F1: 0.716940  v_AUC: 0.907910
steps 10200    running time 344 seconds

steps 10400    base_loss: 0.198938    reg_loss: 0.041087    l2_loss: 0.027184    loss: 0.267209
steps 10400    v_Prec: 0.731305  v_Recall: 0.707362  v_F1: 0.719134  v_AUC: 0.913573
steps 10400    running time 350 seconds

steps 10600    base_loss: 0.205415    reg_loss: 0.041200    l2_loss: 0.027195    loss: 0.273810
steps 10600    v_Prec: 0.752640  v_Recall: 0.684058  v_F1: 0.716712  v_AUC: 0.912444
steps 10600    running time 357 seconds

steps 10800    base_loss: 0.191333    reg_loss: 0.040525    l2_loss: 0.027450    loss: 0.259308
steps 10800    v_Prec: 0.741633  v_Recall: 0.702282  v_F1: 0.721421  v_AUC: 0.913738
steps 10800    running time 363 seconds

steps 11000    base_loss: 0.094220    reg_loss: 0.038235    l2_loss: 0.027505    loss: 0.159960
steps 11000    v_Prec: 0.725873  v_Recall: 0.676881  v_F1: 0.700522  v_AUC: 0.901920
steps 11000    running time 369 seconds

steps 11200    base_loss: 0.090800    reg_loss: 0.038297    l2_loss: 0.027512    loss: 0.156609
steps 11200    v_Prec: 0.716788  v_Recall: 0.653496  v_F1: 0.683680  v_AUC: 0.893853
steps 11200    running time 374 seconds

steps 11400    base_loss: 0.086573    reg_loss: 0.038125    l2_loss: 0.027552    loss: 0.152249
steps 11400    v_Prec: 0.714542  v_Recall: 0.675591  v_F1: 0.694520  v_AUC: 0.897805
steps 11400    running time 380 seconds

steps 11600    base_loss: 0.096436    reg_loss: 0.038315    l2_loss: 0.027656    loss: 0.162407
steps 11600    v_Prec: 0.730902  v_Recall: 0.646561  v_F1: 0.686150  v_AUC: 0.892773
steps 11600    running time 386 seconds

steps 11800    base_loss: 0.091859    reg_loss: 0.038537    l2_loss: 0.027801    loss: 0.158196
steps 11800    v_Prec: 0.729335  v_Recall: 0.663817  v_F1: 0.695035  v_AUC: 0.895870
steps 11800    running time 392 seconds

steps 12000    base_loss: 0.096507    reg_loss: 0.038310    l2_loss: 0.027891    loss: 0.162708
steps 12000    v_Prec: 0.735386  v_Recall: 0.662447  v_F1: 0.697013  v_AUC: 0.896590
steps 12000    running time 398 seconds

steps 12200    base_loss: 0.100794    reg_loss: 0.038750    l2_loss: 0.028058    loss: 0.167602
steps 12200    v_Prec: 0.714044  v_Recall: 0.646964  v_F1: 0.678851  v_AUC: 0.886706
steps 12200    running time 404 seconds

steps 12400    base_loss: 0.100789    reg_loss: 0.038759    l2_loss: 0.027960    loss: 0.167508
steps 12400    v_Prec: 0.703934  v_Recall: 0.666640  v_F1: 0.684779  v_AUC: 0.892255
steps 12400    running time 410 seconds

steps 12600    base_loss: 0.101825    reg_loss: 0.038402    l2_loss: 0.027986    loss: 0.168212
steps 12600    v_Prec: 0.731568  v_Recall: 0.652931  v_F1: 0.690017  v_AUC: 0.895886
steps 12600    running time 415 seconds

steps 12800    base_loss: 0.103899    reg_loss: 0.038294    l2_loss: 0.028015    loss: 0.170208
steps 12800    v_Prec: 0.741400  v_Recall: 0.662124  v_F1: 0.699523  v_AUC: 0.898394
steps 12800    running time 421 seconds

Early stop model F1: 0.721421
testing thre: 0.36948952
testing Prec: 0.5437775424452567
testing Recall: 0.7736573511543134
testing F1: 0.6386615310544053
testing AUC: 0.9004287782856033
overall running time 424 seconds
(0.7211804989401598, 0.6449088699878494, 0.6809154821162826, 0.9004287782856033, 0.771469)

2019-02-24 16:08:58.380149: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:08:58.712261: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:08:58.713997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:08:58.714034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.290000 seconds
loading data in 31.410000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.742641    reg_loss: 0.064922    l2_loss: 0.013368    loss: 0.820930
steps 200    v_Prec: 0.163612  v_Recall: 0.995128  v_F1: 0.281020  v_AUC: 0.501702
steps 200    running time 41 seconds

steps 400    base_loss: 0.570105    reg_loss: 0.064869    l2_loss: 0.013425    loss: 0.648399
steps 400    v_Prec: 0.163736  v_Recall: 0.986902  v_F1: 0.280873  v_AUC: 0.492983
steps 400    running time 47 seconds

steps 600    base_loss: 0.495743    reg_loss: 0.064481    l2_loss: 0.013428    loss: 0.573651
steps 600    v_Prec: 0.163904  v_Recall: 0.995927  v_F1: 0.281483  v_AUC: 0.503535
steps 600    running time 53 seconds

steps 800    base_loss: 0.470083    reg_loss: 0.063654    l2_loss: 0.013078    loss: 0.546815
steps 800    v_Prec: 0.167409  v_Recall: 0.903123  v_F1: 0.282460  v_AUC: 0.531911
steps 800    running time 60 seconds

steps 1000    base_loss: 0.466905    reg_loss: 0.062912    l2_loss: 0.012528    loss: 0.542345
steps 1000    v_Prec: 0.192932  v_Recall: 0.664084  v_F1: 0.298999  v_AUC: 0.588787
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.447597    reg_loss: 0.061959    l2_loss: 0.012151    loss: 0.521707
steps 1200    v_Prec: 0.324271  v_Recall: 0.422011  v_F1: 0.366741  v_AUC: 0.679824
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.425137    reg_loss: 0.061160    l2_loss: 0.012060    loss: 0.498357
steps 1400    v_Prec: 0.410946  v_Recall: 0.455155  v_F1: 0.431922  v_AUC: 0.741925
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.394659    reg_loss: 0.060836    l2_loss: 0.012104    loss: 0.467599
steps 1600    v_Prec: 0.458965  v_Recall: 0.500679  v_F1: 0.478915  v_AUC: 0.778871
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.374052    reg_loss: 0.061476    l2_loss: 0.012249    loss: 0.447777
steps 1800    v_Prec: 0.508376  v_Recall: 0.521125  v_F1: 0.514671  v_AUC: 0.803655
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.362877    reg_loss: 0.062306    l2_loss: 0.012388    loss: 0.437571
steps 2000    v_Prec: 0.540134  v_Recall: 0.553550  v_F1: 0.546760  v_AUC: 0.820717
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.339705    reg_loss: 0.062942    l2_loss: 0.012641    loss: 0.415288
steps 2200    v_Prec: 0.547778  v_Recall: 0.583739  v_F1: 0.565187  v_AUC: 0.833635
steps 2200    running time 104 seconds

steps 2400    base_loss: 0.332307    reg_loss: 0.063574    l2_loss: 0.012873    loss: 0.408753
steps 2400    v_Prec: 0.580552  v_Recall: 0.575034  v_F1: 0.577780  v_AUC: 0.842680
steps 2400    running time 111 seconds

steps 2600    base_loss: 0.321492    reg_loss: 0.064212    l2_loss: 0.013161    loss: 0.398865
steps 2600    v_Prec: 0.604702  v_Recall: 0.579347  v_F1: 0.591753  v_AUC: 0.851163
steps 2600    running time 117 seconds

steps 2800    base_loss: 0.313851    reg_loss: 0.064918    l2_loss: 0.013475    loss: 0.392244
steps 2800    v_Prec: 0.615976  v_Recall: 0.595559  v_F1: 0.605595  v_AUC: 0.858741
steps 2800    running time 124 seconds

steps 3000    base_loss: 0.309684    reg_loss: 0.065255    l2_loss: 0.013815    loss: 0.388755
steps 3000    v_Prec: 0.617638  v_Recall: 0.613050  v_F1: 0.615335  v_AUC: 0.864432
steps 3000    running time 130 seconds

steps 3200    base_loss: 0.307474    reg_loss: 0.065648    l2_loss: 0.014158    loss: 0.387279
steps 3200    v_Prec: 0.625204  v_Recall: 0.610574  v_F1: 0.617803  v_AUC: 0.868274
steps 3200    running time 136 seconds

steps 3400    base_loss: 0.302680    reg_loss: 0.065834    l2_loss: 0.014575    loss: 0.383088
steps 3400    v_Prec: 0.614133  v_Recall: 0.633017  v_F1: 0.623432  v_AUC: 0.873133
steps 3400    running time 143 seconds

steps 3600    base_loss: 0.302306    reg_loss: 0.066394    l2_loss: 0.015029    loss: 0.383729
steps 3600    v_Prec: 0.622205  v_Recall: 0.628864  v_F1: 0.625516  v_AUC: 0.875530
steps 3600    running time 149 seconds

steps 3800    base_loss: 0.298144    reg_loss: 0.066546    l2_loss: 0.015456    loss: 0.380145
steps 3800    v_Prec: 0.630234  v_Recall: 0.632298  v_F1: 0.631264  v_AUC: 0.878957
steps 3800    running time 155 seconds

steps 4000    base_loss: 0.286194    reg_loss: 0.066721    l2_loss: 0.015957    loss: 0.368872
steps 4000    v_Prec: 0.650726  v_Recall: 0.630301  v_F1: 0.640351  v_AUC: 0.880172
steps 4000    running time 162 seconds

steps 4200    base_loss: 0.288214    reg_loss: 0.066836    l2_loss: 0.016478    loss: 0.371527
steps 4200    v_Prec: 0.660922  v_Recall: 0.624870  v_F1: 0.642391  v_AUC: 0.882867
steps 4200    running time 168 seconds

steps 4400    base_loss: 0.284700    reg_loss: 0.067120    l2_loss: 0.016948    loss: 0.368768
steps 4400    v_Prec: 0.674173  v_Recall: 0.616884  v_F1: 0.644257  v_AUC: 0.884682
steps 4400    running time 175 seconds

steps 4600    base_loss: 0.283360    reg_loss: 0.067232    l2_loss: 0.017585    loss: 0.368177
steps 4600    v_Prec: 0.690058  v_Recall: 0.608657  v_F1: 0.646807  v_AUC: 0.886080
steps 4600    running time 181 seconds

steps 4800    base_loss: 0.278247    reg_loss: 0.067273    l2_loss: 0.018227    loss: 0.363747
steps 4800    v_Prec: 0.661122  v_Recall: 0.638048  v_F1: 0.649380  v_AUC: 0.887822
steps 4800    running time 188 seconds

steps 5000    base_loss: 0.281713    reg_loss: 0.067373    l2_loss: 0.018777    loss: 0.367862
steps 5000    v_Prec: 0.671115  v_Recall: 0.634614  v_F1: 0.652354  v_AUC: 0.890737
steps 5000    running time 194 seconds

steps 5200    base_loss: 0.279041    reg_loss: 0.067274    l2_loss: 0.019502    loss: 0.365817
steps 5200    v_Prec: 0.672803  v_Recall: 0.633416  v_F1: 0.652516  v_AUC: 0.892424
steps 5200    running time 200 seconds

steps 5400    base_loss: 0.275356    reg_loss: 0.067263    l2_loss: 0.020058    loss: 0.362677
steps 5400    v_Prec: 0.690761  v_Recall: 0.631180  v_F1: 0.659628  v_AUC: 0.894661
steps 5400    running time 207 seconds

steps 5600    base_loss: 0.181392    reg_loss: 0.068662    l2_loss: 0.020996    loss: 0.271049
steps 5600    v_Prec: 0.657916  v_Recall: 0.638527  v_F1: 0.648077  v_AUC: 0.886493
steps 5600    running time 213 seconds

steps 5800    base_loss: 0.189379    reg_loss: 0.068092    l2_loss: 0.021866    loss: 0.279337
steps 5800    v_Prec: 0.660133  v_Recall: 0.640204  v_F1: 0.650016  v_AUC: 0.887027
steps 5800    running time 219 seconds

steps 6000    base_loss: 0.184618    reg_loss: 0.067987    l2_loss: 0.022612    loss: 0.275218
steps 6000    v_Prec: 0.689327  v_Recall: 0.606581  v_F1: 0.645312  v_AUC: 0.886796
steps 6000    running time 225 seconds

steps 6200    base_loss: 0.199411    reg_loss: 0.068089    l2_loss: 0.023241    loss: 0.290741
steps 6200    v_Prec: 0.656965  v_Recall: 0.639965  v_F1: 0.648353  v_AUC: 0.888408
steps 6200    running time 231 seconds

steps 6400    base_loss: 0.207896    reg_loss: 0.067862    l2_loss: 0.023798    loss: 0.299557
steps 6400    v_Prec: 0.656167  v_Recall: 0.652184  v_F1: 0.654170  v_AUC: 0.889268
steps 6400    running time 237 seconds

steps 6600    base_loss: 0.205811    reg_loss: 0.067750    l2_loss: 0.024253    loss: 0.297814
steps 6600    v_Prec: 0.671823  v_Recall: 0.641722  v_F1: 0.656427  v_AUC: 0.890828
steps 6600    running time 243 seconds

steps 6800    base_loss: 0.194858    reg_loss: 0.067776    l2_loss: 0.024547    loss: 0.287181
steps 6800    v_Prec: 0.667075  v_Recall: 0.651625  v_F1: 0.659260  v_AUC: 0.892516
steps 6800    running time 249 seconds

steps 7000    base_loss: 0.191440    reg_loss: 0.067706    l2_loss: 0.025179    loss: 0.284325
steps 7000    v_Prec: 0.655059  v_Recall: 0.667039  v_F1: 0.660995  v_AUC: 0.891422
steps 7000    running time 255 seconds

steps 7200    base_loss: 0.204805    reg_loss: 0.067720    l2_loss: 0.025573    loss: 0.298099
steps 7200    v_Prec: 0.693904  v_Recall: 0.635492  v_F1: 0.663415  v_AUC: 0.893877
steps 7200    running time 261 seconds

steps 7400    base_loss: 0.198366    reg_loss: 0.067775    l2_loss: 0.025903    loss: 0.292044
steps 7400    v_Prec: 0.691275  v_Recall: 0.645396  v_F1: 0.667548  v_AUC: 0.894761
steps 7400    running time 268 seconds

steps 7600    base_loss: 0.202628    reg_loss: 0.067662    l2_loss: 0.026311    loss: 0.296601
steps 7600    v_Prec: 0.701739  v_Recall: 0.644517  v_F1: 0.671912  v_AUC: 0.895736
steps 7600    running time 274 seconds

steps 7800    base_loss: 0.201251    reg_loss: 0.067423    l2_loss: 0.026589    loss: 0.295263
steps 7800    v_Prec: 0.688948  v_Recall: 0.657695  v_F1: 0.672959  v_AUC: 0.899689
steps 7800    running time 281 seconds

steps 8000    base_loss: 0.198555    reg_loss: 0.067715    l2_loss: 0.027019    loss: 0.293289
steps 8000    v_Prec: 0.702822  v_Recall: 0.646354  v_F1: 0.673407  v_AUC: 0.899675
steps 8000    running time 287 seconds

steps 8200    base_loss: 0.200347    reg_loss: 0.067496    l2_loss: 0.027351    loss: 0.295194
steps 8200    v_Prec: 0.662569  v_Recall: 0.680137  v_F1: 0.671238  v_AUC: 0.900980
steps 8200    running time 293 seconds

steps 8400    base_loss: 0.200942    reg_loss: 0.067514    l2_loss: 0.027736    loss: 0.296193
steps 8400    v_Prec: 0.674480  v_Recall: 0.677981  v_F1: 0.676226  v_AUC: 0.901415
steps 8400    running time 299 seconds

steps 8600    base_loss: 0.209996    reg_loss: 0.067559    l2_loss: 0.027948    loss: 0.305504
steps 8600    v_Prec: 0.702632  v_Recall: 0.663126  v_F1: 0.682308  v_AUC: 0.904718
steps 8600    running time 306 seconds

steps 8800    base_loss: 0.196189    reg_loss: 0.067297    l2_loss: 0.028152    loss: 0.291638
steps 8800    v_Prec: 0.717635  v_Recall: 0.655219  v_F1: 0.685008  v_AUC: 0.904161
steps 8800    running time 312 seconds

steps 9000    base_loss: 0.195649    reg_loss: 0.067206    l2_loss: 0.028350    loss: 0.291204
steps 9000    v_Prec: 0.711570  v_Recall: 0.660650  v_F1: 0.685165  v_AUC: 0.905489
steps 9000    running time 318 seconds

steps 9200    base_loss: 0.199193    reg_loss: 0.067183    l2_loss: 0.028609    loss: 0.294986
steps 9200    v_Prec: 0.719772  v_Recall: 0.666081  v_F1: 0.691887  v_AUC: 0.907178
steps 9200    running time 324 seconds

steps 9400    base_loss: 0.201329    reg_loss: 0.067584    l2_loss: 0.028697    loss: 0.297611
steps 9400    v_Prec: 0.734205  v_Recall: 0.663605  v_F1: 0.697122  v_AUC: 0.909484
steps 9400    running time 331 seconds

steps 9600    base_loss: 0.201763    reg_loss: 0.067535    l2_loss: 0.028978    loss: 0.298275
steps 9600    v_Prec: 0.709886  v_Recall: 0.684770  v_F1: 0.697102  v_AUC: 0.910930
steps 9600    running time 337 seconds

steps 9800    base_loss: 0.198935    reg_loss: 0.067342    l2_loss: 0.029236    loss: 0.295512
steps 9800    v_Prec: 0.746116  v_Recall: 0.659772  v_F1: 0.700292  v_AUC: 0.912350
steps 9800    running time 343 seconds

steps 10000    base_loss: 0.202779    reg_loss: 0.067262    l2_loss: 0.029553    loss: 0.299594
steps 10000    v_Prec: 0.708896  v_Recall: 0.691798  v_F1: 0.700243  v_AUC: 0.913416
steps 10000    running time 349 seconds

steps 10200    base_loss: 0.195969    reg_loss: 0.066894    l2_loss: 0.029661    loss: 0.292525
steps 10200    v_Prec: 0.729126  v_Recall: 0.679978  v_F1: 0.703695  v_AUC: 0.914849
steps 10200    running time 355 seconds

steps 10400    base_loss: 0.193918    reg_loss: 0.066784    l2_loss: 0.029798    loss: 0.290500
steps 10400    v_Prec: 0.751294  v_Recall: 0.672151  v_F1: 0.709522  v_AUC: 0.917724
steps 10400    running time 361 seconds

steps 10600    base_loss: 0.197629    reg_loss: 0.066937    l2_loss: 0.029896    loss: 0.294462
steps 10600    v_Prec: 0.748078  v_Recall: 0.676144  v_F1: 0.710294  v_AUC: 0.916563
steps 10600    running time 368 seconds

steps 10800    base_loss: 0.188561    reg_loss: 0.066823    l2_loss: 0.030055    loss: 0.285440
steps 10800    v_Prec: 0.734340  v_Recall: 0.679738  v_F1: 0.705985  v_AUC: 0.916216
steps 10800    running time 374 seconds

steps 11000    base_loss: 0.086975    reg_loss: 0.066522    l2_loss: 0.030319    loss: 0.183815
steps 11000    v_Prec: 0.714274  v_Recall: 0.670633  v_F1: 0.691766  v_AUC: 0.908859
steps 11000    running time 380 seconds

steps 11200    base_loss: 0.083742    reg_loss: 0.066553    l2_loss: 0.030428    loss: 0.180723
steps 11200    v_Prec: 0.694552  v_Recall: 0.673029  v_F1: 0.683621  v_AUC: 0.903655
steps 11200    running time 386 seconds

steps 11400    base_loss: 0.087103    reg_loss: 0.066270    l2_loss: 0.030605    loss: 0.183979
steps 11400    v_Prec: 0.704960  v_Recall: 0.660650  v_F1: 0.682086  v_AUC: 0.903285
steps 11400    running time 392 seconds

steps 11600    base_loss: 0.091732    reg_loss: 0.066094    l2_loss: 0.030730    loss: 0.188556
steps 11600    v_Prec: 0.683703  v_Recall: 0.662407  v_F1: 0.672887  v_AUC: 0.898438
steps 11600    running time 398 seconds

steps 11800    base_loss: 0.085230    reg_loss: 0.065902    l2_loss: 0.030832    loss: 0.181964
steps 11800    v_Prec: 0.669720  v_Recall: 0.659772  v_F1: 0.664709  v_AUC: 0.894017
steps 11800    running time 404 seconds

steps 12000    base_loss: 0.090623    reg_loss: 0.065912    l2_loss: 0.030909    loss: 0.187444
steps 12000    v_Prec: 0.679331  v_Recall: 0.658334  v_F1: 0.668668  v_AUC: 0.895236
steps 12000    running time 410 seconds

steps 12200    base_loss: 0.096118    reg_loss: 0.065929    l2_loss: 0.031025    loss: 0.193072
steps 12200    v_Prec: 0.681967  v_Recall: 0.664484  v_F1: 0.673112  v_AUC: 0.898326
steps 12200    running time 416 seconds

steps 12400    base_loss: 0.090285    reg_loss: 0.065877    l2_loss: 0.031098    loss: 0.187260
steps 12400    v_Prec: 0.679559  v_Recall: 0.665123  v_F1: 0.672263  v_AUC: 0.896379
steps 12400    running time 422 seconds

steps 12600    base_loss: 0.088903    reg_loss: 0.065841    l2_loss: 0.031320    loss: 0.186064
steps 12600    v_Prec: 0.695678  v_Recall: 0.649229  v_F1: 0.671652  v_AUC: 0.896699
steps 12600    running time 428 seconds

Early stop model F1: 0.710294
testing thre: 0.47270715
testing Prec: 0.5454346796809557
testing Recall: 0.7278736330498178
testing F1: 0.6235842771485677
testing AUC: 0.8929472037661375
overall running time 430 seconds
(0.6623831775700935, 0.6338274605103281, 0.6477907756501006, 0.8929472037661375, 0.6806662)

2019-02-24 16:13:29.457175: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:13:30.631860: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:13:30.632786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:13:30.632827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.400000 seconds
loading data in 30.500000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.818979    reg_loss: 0.064706    l2_loss: 0.013355    loss: 0.897040
steps 200    v_Prec: 0.165826  v_Recall: 0.917041  v_F1: 0.280864  v_AUC: 0.533597
steps 200    running time 40 seconds

steps 400    base_loss: 0.564340    reg_loss: 0.064467    l2_loss: 0.013211    loss: 0.642018
steps 400    v_Prec: 0.163951  v_Recall: 0.972587  v_F1: 0.280600  v_AUC: 0.537818
steps 400    running time 47 seconds

steps 600    base_loss: 0.482456    reg_loss: 0.064054    l2_loss: 0.013056    loss: 0.559566
steps 600    v_Prec: 0.174991  v_Recall: 0.816127  v_F1: 0.288189  v_AUC: 0.567791
steps 600    running time 53 seconds

steps 800    base_loss: 0.469737    reg_loss: 0.063624    l2_loss: 0.012889    loss: 0.546249
steps 800    v_Prec: 0.200063  v_Recall: 0.665598  v_F1: 0.307652  v_AUC: 0.607908
steps 800    running time 59 seconds

steps 1000    base_loss: 0.450496    reg_loss: 0.062963    l2_loss: 0.012730    loss: 0.526189
steps 1000    v_Prec: 0.250584  v_Recall: 0.507374  v_F1: 0.335480  v_AUC: 0.658257
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.434831    reg_loss: 0.062024    l2_loss: 0.012662    loss: 0.509518
steps 1200    v_Prec: 0.294049  v_Recall: 0.504569  v_F1: 0.371562  v_AUC: 0.701022
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.419926    reg_loss: 0.061226    l2_loss: 0.012718    loss: 0.493870
steps 1400    v_Prec: 0.388342  v_Recall: 0.458721  v_F1: 0.420608  v_AUC: 0.747784
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.396873    reg_loss: 0.060678    l2_loss: 0.012816    loss: 0.470366
steps 1600    v_Prec: 0.414755  v_Recall: 0.514588  v_F1: 0.459310  v_AUC: 0.777602
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.384437    reg_loss: 0.060120    l2_loss: 0.013007    loss: 0.457564
steps 1800    v_Prec: 0.490761  v_Recall: 0.487496  v_F1: 0.489123  v_AUC: 0.802965
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.363136    reg_loss: 0.059457    l2_loss: 0.013343    loss: 0.435936
steps 2000    v_Prec: 0.505016  v_Recall: 0.544726  v_F1: 0.524120  v_AUC: 0.821356
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.352190    reg_loss: 0.058942    l2_loss: 0.013624    loss: 0.424756
steps 2200    v_Prec: 0.514391  v_Recall: 0.580154  v_F1: 0.545297  v_AUC: 0.836517
steps 2200    running time 104 seconds

steps 2400    base_loss: 0.335057    reg_loss: 0.058417    l2_loss: 0.014007    loss: 0.407481
steps 2400    v_Prec: 0.573256  v_Recall: 0.553222  v_F1: 0.563061  v_AUC: 0.847100
steps 2400    running time 110 seconds

steps 2600    base_loss: 0.337453    reg_loss: 0.057911    l2_loss: 0.014428    loss: 0.409792
steps 2600    v_Prec: 0.537072  v_Recall: 0.614861  v_F1: 0.573340  v_AUC: 0.853626
steps 2600    running time 117 seconds

steps 2800    base_loss: 0.333106    reg_loss: 0.057362    l2_loss: 0.014860    loss: 0.405328
steps 2800    v_Prec: 0.568725  v_Recall: 0.604601  v_F1: 0.586114  v_AUC: 0.860057
steps 2800    running time 123 seconds

steps 3000    base_loss: 0.319010    reg_loss: 0.056618    l2_loss: 0.015331    loss: 0.390959
steps 3000    v_Prec: 0.577061  v_Recall: 0.617025  v_F1: 0.596374  v_AUC: 0.863717
steps 3000    running time 130 seconds

steps 3200    base_loss: 0.317048    reg_loss: 0.056156    l2_loss: 0.015752    loss: 0.388956
steps 3200    v_Prec: 0.595818  v_Recall: 0.612055  v_F1: 0.603827  v_AUC: 0.868706
steps 3200    running time 136 seconds

steps 3400    base_loss: 0.320037    reg_loss: 0.055568    l2_loss: 0.016266    loss: 0.391871
steps 3400    v_Prec: 0.608720  v_Recall: 0.605402  v_F1: 0.607057  v_AUC: 0.871510
steps 3400    running time 142 seconds

steps 3600    base_loss: 0.314240    reg_loss: 0.055011    l2_loss: 0.016799    loss: 0.386049
steps 3600    v_Prec: 0.610591  v_Recall: 0.611815  v_F1: 0.611202  v_AUC: 0.874115
steps 3600    running time 149 seconds

steps 3800    base_loss: 0.308108    reg_loss: 0.054323    l2_loss: 0.017396    loss: 0.379827
steps 3800    v_Prec: 0.595985  v_Recall: 0.637785  v_F1: 0.616177  v_AUC: 0.876615
steps 3800    running time 155 seconds

steps 4000    base_loss: 0.301804    reg_loss: 0.053353    l2_loss: 0.017984    loss: 0.373140
steps 4000    v_Prec: 0.628815  v_Recall: 0.620952  v_F1: 0.624859  v_AUC: 0.879122
steps 4000    running time 161 seconds

steps 4200    base_loss: 0.295245    reg_loss: 0.052789    l2_loss: 0.018543    loss: 0.366577
steps 4200    v_Prec: 0.605933  v_Recall: 0.654937  v_F1: 0.629483  v_AUC: 0.882241
steps 4200    running time 168 seconds

steps 4400    base_loss: 0.298281    reg_loss: 0.052307    l2_loss: 0.019227    loss: 0.369815
steps 4400    v_Prec: 0.622229  v_Recall: 0.645720  v_F1: 0.633757  v_AUC: 0.885202
steps 4400    running time 174 seconds

steps 4600    base_loss: 0.300119    reg_loss: 0.051814    l2_loss: 0.019782    loss: 0.371714
steps 4600    v_Prec: 0.627029  v_Recall: 0.647082  v_F1: 0.636898  v_AUC: 0.886595
steps 4600    running time 181 seconds

steps 4800    base_loss: 0.284970    reg_loss: 0.050945    l2_loss: 0.020438    loss: 0.356352
steps 4800    v_Prec: 0.646068  v_Recall: 0.633536  v_F1: 0.639741  v_AUC: 0.886796
steps 4800    running time 187 seconds

steps 5000    base_loss: 0.287229    reg_loss: 0.050363    l2_loss: 0.021096    loss: 0.358687
steps 5000    v_Prec: 0.649971  v_Recall: 0.634498  v_F1: 0.642142  v_AUC: 0.888172
steps 5000    running time 194 seconds

steps 5200    base_loss: 0.283780    reg_loss: 0.049787    l2_loss: 0.021807    loss: 0.355374
steps 5200    v_Prec: 0.668646  v_Recall: 0.631933  v_F1: 0.649771  v_AUC: 0.889995
steps 5200    running time 200 seconds

steps 5400    base_loss: 0.289150    reg_loss: 0.049422    l2_loss: 0.022553    loss: 0.361125
steps 5400    v_Prec: 0.674070  v_Recall: 0.627605  v_F1: 0.650008  v_AUC: 0.891373
steps 5400    running time 206 seconds

steps 5600    base_loss: 0.177845    reg_loss: 0.050657    l2_loss: 0.023218    loss: 0.251720
steps 5600    v_Prec: 0.642329  v_Recall: 0.633937  v_F1: 0.638106  v_AUC: 0.884749
steps 5600    running time 213 seconds

steps 5800    base_loss: 0.177886    reg_loss: 0.051747    l2_loss: 0.023686    loss: 0.253320
steps 5800    v_Prec: 0.641747  v_Recall: 0.615822  v_F1: 0.628518  v_AUC: 0.879719
steps 5800    running time 219 seconds

steps 6000    base_loss: 0.191111    reg_loss: 0.051697    l2_loss: 0.024230    loss: 0.267039
steps 6000    v_Prec: 0.628042  v_Recall: 0.632975  v_F1: 0.630499  v_AUC: 0.880867
steps 6000    running time 225 seconds

steps 6200    base_loss: 0.190176    reg_loss: 0.051968    l2_loss: 0.024816    loss: 0.266960
steps 6200    v_Prec: 0.638882  v_Recall: 0.626643  v_F1: 0.632703  v_AUC: 0.881045
steps 6200    running time 231 seconds

steps 6400    base_loss: 0.176023    reg_loss: 0.051707    l2_loss: 0.025305    loss: 0.253035
steps 6400    v_Prec: 0.613400  v_Recall: 0.651651  v_F1: 0.631947  v_AUC: 0.881693
steps 6400    running time 237 seconds

steps 6600    base_loss: 0.182439    reg_loss: 0.051471    l2_loss: 0.025652    loss: 0.259562
steps 6600    v_Prec: 0.614066  v_Recall: 0.651571  v_F1: 0.632263  v_AUC: 0.880896
steps 6600    running time 243 seconds

steps 6800    base_loss: 0.190552    reg_loss: 0.051625    l2_loss: 0.026186    loss: 0.268364
steps 6800    v_Prec: 0.622932  v_Recall: 0.636662  v_F1: 0.629722  v_AUC: 0.882462
steps 6800    running time 249 seconds

steps 7000    base_loss: 0.178776    reg_loss: 0.051270    l2_loss: 0.026718    loss: 0.256764
steps 7000    v_Prec: 0.601912  v_Recall: 0.656140  v_F1: 0.627857  v_AUC: 0.881354
steps 7000    running time 255 seconds

steps 7200    base_loss: 0.192692    reg_loss: 0.050901    l2_loss: 0.027097    loss: 0.270690
steps 7200    v_Prec: 0.628203  v_Recall: 0.636662  v_F1: 0.632404  v_AUC: 0.884923
steps 7200    running time 261 seconds

steps 7400    base_loss: 0.188264    reg_loss: 0.050589    l2_loss: 0.027425    loss: 0.266278
steps 7400    v_Prec: 0.617714  v_Recall: 0.657422  v_F1: 0.636950  v_AUC: 0.886156
steps 7400    running time 267 seconds

Early stop model F1: 0.650008
testing thre: 0.23338497
testing Prec: 0.48931752729221084
testing Recall: 0.7101822600243013
testing F1: 0.5794159049903841
testing AUC: 0.8687493121559756
overall running time 270 seconds
(0.6504643458426111, 0.5821142162818955, 0.6143941725659178, 0.8687493121559756, 0.46905786)

2019-02-24 16:16:23.974108: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:16:24.682012: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:16:24.685076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:16:24.685116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.310000 seconds
loading data in 31.280000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.409522    reg_loss: 0.065006    l2_loss: 0.013291    loss: 1.487820
steps 200    v_Prec: 0.166020  v_Recall: 0.999371  v_F1: 0.284738  v_AUC: 0.502167
steps 200    running time 41 seconds

steps 400    base_loss: 0.827363    reg_loss: 0.064902    l2_loss: 0.013016    loss: 0.905281
steps 400    v_Prec: 0.166654  v_Recall: 0.996539  v_F1: 0.285553  v_AUC: 0.530346
steps 400    running time 48 seconds

steps 600    base_loss: 0.496306    reg_loss: 0.064596    l2_loss: 0.012770    loss: 0.573671
steps 600    v_Prec: 0.186421  v_Recall: 0.658487  v_F1: 0.290578  v_AUC: 0.559068
steps 600    running time 54 seconds

steps 800    base_loss: 0.472361    reg_loss: 0.064159    l2_loss: 0.012688    loss: 0.549208
steps 800    v_Prec: 0.214646  v_Recall: 0.574957  v_F1: 0.312594  v_AUC: 0.606284
steps 800    running time 60 seconds

steps 1000    base_loss: 0.446660    reg_loss: 0.063760    l2_loss: 0.012596    loss: 0.523016
steps 1000    v_Prec: 0.253522  v_Recall: 0.530832  v_F1: 0.343155  v_AUC: 0.654369
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.433218    reg_loss: 0.063585    l2_loss: 0.012576    loss: 0.509380
steps 1200    v_Prec: 0.309675  v_Recall: 0.480101  v_F1: 0.376500  v_AUC: 0.690803
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.409590    reg_loss: 0.063124    l2_loss: 0.012592    loss: 0.485306
steps 1400    v_Prec: 0.359473  v_Recall: 0.472314  v_F1: 0.408240  v_AUC: 0.717872
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.399645    reg_loss: 0.062905    l2_loss: 0.012674    loss: 0.475224
steps 1600    v_Prec: 0.387761  v_Recall: 0.501888  v_F1: 0.437504  v_AUC: 0.746517
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.392458    reg_loss: 0.062846    l2_loss: 0.012747    loss: 0.468051
steps 1800    v_Prec: 0.438639  v_Recall: 0.507157  v_F1: 0.470417  v_AUC: 0.766484
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.386816    reg_loss: 0.062879    l2_loss: 0.012880    loss: 0.462574
steps 2000    v_Prec: 0.499063  v_Recall: 0.502753  v_F1: 0.500901  v_AUC: 0.784799
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.377193    reg_loss: 0.062800    l2_loss: 0.013041    loss: 0.453034
steps 2200    v_Prec: 0.533086  v_Recall: 0.508809  v_F1: 0.520665  v_AUC: 0.801195
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.363986    reg_loss: 0.062710    l2_loss: 0.013175    loss: 0.439871
steps 2400    v_Prec: 0.518247  v_Recall: 0.555136  v_F1: 0.536057  v_AUC: 0.813976
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.356815    reg_loss: 0.062464    l2_loss: 0.013336    loss: 0.432615
steps 2600    v_Prec: 0.516841  v_Recall: 0.587777  v_F1: 0.550031  v_AUC: 0.822240
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.352606    reg_loss: 0.062696    l2_loss: 0.013480    loss: 0.428781
steps 2800    v_Prec: 0.516306  v_Recall: 0.607677  v_F1: 0.558277  v_AUC: 0.829048
steps 2800    running time 124 seconds

steps 3000    base_loss: 0.338375    reg_loss: 0.062839    l2_loss: 0.013589    loss: 0.414802
steps 3000    v_Prec: 0.541750  v_Recall: 0.600126  v_F1: 0.569445  v_AUC: 0.835851
steps 3000    running time 131 seconds

steps 3200    base_loss: 0.338743    reg_loss: 0.063319    l2_loss: 0.013714    loss: 0.415776
steps 3200    v_Prec: 0.547546  v_Recall: 0.617744  v_F1: 0.580531  v_AUC: 0.846540
steps 3200    running time 137 seconds

steps 3400    base_loss: 0.325902    reg_loss: 0.064198    l2_loss: 0.013951    loss: 0.404051
steps 3400    v_Prec: 0.572870  v_Recall: 0.616171  v_F1: 0.593732  v_AUC: 0.855456
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.318591    reg_loss: 0.065098    l2_loss: 0.014317    loss: 0.398007
steps 3600    v_Prec: 0.587286  v_Recall: 0.618373  v_F1: 0.602429  v_AUC: 0.863136
steps 3600    running time 150 seconds

steps 3800    base_loss: 0.314746    reg_loss: 0.066030    l2_loss: 0.014824    loss: 0.395599
steps 3800    v_Prec: 0.610669  v_Recall: 0.614991  v_F1: 0.612822  v_AUC: 0.871401
steps 3800    running time 157 seconds

steps 4000    base_loss: 0.304807    reg_loss: 0.066561    l2_loss: 0.015437    loss: 0.386805
steps 4000    v_Prec: 0.594826  v_Recall: 0.651015  v_F1: 0.621653  v_AUC: 0.874236
steps 4000    running time 163 seconds

steps 4200    base_loss: 0.302761    reg_loss: 0.067068    l2_loss: 0.016012    loss: 0.385841
steps 4200    v_Prec: 0.622972  v_Recall: 0.631351  v_F1: 0.627134  v_AUC: 0.877757
steps 4200    running time 170 seconds

steps 4400    base_loss: 0.304341    reg_loss: 0.067192    l2_loss: 0.016791    loss: 0.388324
steps 4400    v_Prec: 0.643618  v_Recall: 0.622306  v_F1: 0.632783  v_AUC: 0.882892
steps 4400    running time 176 seconds

steps 4600    base_loss: 0.286303    reg_loss: 0.067267    l2_loss: 0.017418    loss: 0.370987
steps 4600    v_Prec: 0.638649  v_Recall: 0.635284  v_F1: 0.636962  v_AUC: 0.884897
steps 4600    running time 182 seconds

steps 4800    base_loss: 0.285479    reg_loss: 0.067378    l2_loss: 0.018115    loss: 0.370972
steps 4800    v_Prec: 0.631086  v_Recall: 0.646374  v_F1: 0.638638  v_AUC: 0.887373
steps 4800    running time 189 seconds

steps 5000    base_loss: 0.287299    reg_loss: 0.067602    l2_loss: 0.018860    loss: 0.373762
steps 5000    v_Prec: 0.643421  v_Recall: 0.647318  v_F1: 0.645364  v_AUC: 0.889176
steps 5000    running time 195 seconds

steps 5200    base_loss: 0.293823    reg_loss: 0.067921    l2_loss: 0.019563    loss: 0.381307
steps 5200    v_Prec: 0.633041  v_Recall: 0.659431  v_F1: 0.645967  v_AUC: 0.890832
steps 5200    running time 202 seconds

steps 5400    base_loss: 0.277929    reg_loss: 0.067941    l2_loss: 0.020399    loss: 0.366270
steps 5400    v_Prec: 0.677082  v_Recall: 0.632295  v_F1: 0.653923  v_AUC: 0.892228
steps 5400    running time 208 seconds

steps 5600    base_loss: 0.199461    reg_loss: 0.069295    l2_loss: 0.021153    loss: 0.289909
steps 5600    v_Prec: 0.633539  v_Recall: 0.654318  v_F1: 0.643761  v_AUC: 0.886272
steps 5600    running time 214 seconds

steps 5800    base_loss: 0.203084    reg_loss: 0.069236    l2_loss: 0.021849    loss: 0.294169
steps 5800    v_Prec: 0.626719  v_Recall: 0.670442  v_F1: 0.647843  v_AUC: 0.888061
steps 5800    running time 221 seconds

steps 6000    base_loss: 0.205998    reg_loss: 0.069139    l2_loss: 0.022463    loss: 0.297600
steps 6000    v_Prec: 0.637923  v_Recall: 0.652273  v_F1: 0.645018  v_AUC: 0.887323
steps 6000    running time 227 seconds

steps 6200    base_loss: 0.206648    reg_loss: 0.068967    l2_loss: 0.023171    loss: 0.298786
steps 6200    v_Prec: 0.626627  v_Recall: 0.662655  v_F1: 0.644138  v_AUC: 0.887653
steps 6200    running time 233 seconds

steps 6400    base_loss: 0.200136    reg_loss: 0.069148    l2_loss: 0.023791    loss: 0.293074
steps 6400    v_Prec: 0.661544  v_Recall: 0.633082  v_F1: 0.647000  v_AUC: 0.887023
steps 6400    running time 239 seconds

steps 6600    base_loss: 0.207289    reg_loss: 0.068944    l2_loss: 0.024199    loss: 0.300432
steps 6600    v_Prec: 0.663852  v_Recall: 0.637014  v_F1: 0.650157  v_AUC: 0.887923
steps 6600    running time 245 seconds

steps 6800    base_loss: 0.215420    reg_loss: 0.068859    l2_loss: 0.024609    loss: 0.308888
steps 6800    v_Prec: 0.654122  v_Recall: 0.645273  v_F1: 0.649667  v_AUC: 0.887920
steps 6800    running time 251 seconds

steps 7000    base_loss: 0.216066    reg_loss: 0.068955    l2_loss: 0.025077    loss: 0.310098
steps 7000    v_Prec: 0.682256  v_Recall: 0.634497  v_F1: 0.657511  v_AUC: 0.892207
steps 7000    running time 257 seconds

steps 7200    base_loss: 0.217429    reg_loss: 0.068776    l2_loss: 0.025457    loss: 0.311661
steps 7200    v_Prec: 0.658346  v_Recall: 0.657622  v_F1: 0.657984  v_AUC: 0.892889
steps 7200    running time 263 seconds

steps 7400    base_loss: 0.210189    reg_loss: 0.068460    l2_loss: 0.025891    loss: 0.304540
steps 7400    v_Prec: 0.661046  v_Recall: 0.669105  v_F1: 0.665051  v_AUC: 0.894433
steps 7400    running time 270 seconds

steps 7600    base_loss: 0.208704    reg_loss: 0.068662    l2_loss: 0.026223    loss: 0.303590
steps 7600    v_Prec: 0.681402  v_Recall: 0.649835  v_F1: 0.665244  v_AUC: 0.894811
steps 7600    running time 276 seconds

steps 7800    base_loss: 0.213306    reg_loss: 0.068816    l2_loss: 0.026574    loss: 0.308695
steps 7800    v_Prec: 0.678319  v_Recall: 0.656284  v_F1: 0.667120  v_AUC: 0.895867
steps 7800    running time 282 seconds

steps 8000    base_loss: 0.216005    reg_loss: 0.068667    l2_loss: 0.026787    loss: 0.311460
steps 8000    v_Prec: 0.680312  v_Recall: 0.665330  v_F1: 0.672737  v_AUC: 0.899398
steps 8000    running time 289 seconds

steps 8200    base_loss: 0.215211    reg_loss: 0.068667    l2_loss: 0.027216    loss: 0.311094
steps 8200    v_Prec: 0.684537  v_Recall: 0.668869  v_F1: 0.676612  v_AUC: 0.902015
steps 8200    running time 295 seconds

steps 8400    base_loss: 0.209983    reg_loss: 0.068533    l2_loss: 0.027549    loss: 0.306065
steps 8400    v_Prec: 0.695863  v_Recall: 0.665487  v_F1: 0.680336  v_AUC: 0.904409
steps 8400    running time 302 seconds

steps 8600    base_loss: 0.210943    reg_loss: 0.068457    l2_loss: 0.027894    loss: 0.307294
steps 8600    v_Prec: 0.701890  v_Recall: 0.662970  v_F1: 0.681875  v_AUC: 0.904470
steps 8600    running time 308 seconds

steps 8800    base_loss: 0.207252    reg_loss: 0.068166    l2_loss: 0.028139    loss: 0.303558
steps 8800    v_Prec: 0.701562  v_Recall: 0.664150  v_F1: 0.682343  v_AUC: 0.904990
steps 8800    running time 314 seconds

steps 9000    base_loss: 0.200895    reg_loss: 0.068062    l2_loss: 0.028354    loss: 0.297311
steps 9000    v_Prec: 0.681220  v_Recall: 0.692150  v_F1: 0.686642  v_AUC: 0.906665
steps 9000    running time 321 seconds

steps 9200    base_loss: 0.210791    reg_loss: 0.068186    l2_loss: 0.028650    loss: 0.307626
steps 9200    v_Prec: 0.692258  v_Recall: 0.680824  v_F1: 0.686494  v_AUC: 0.907828
steps 9200    running time 327 seconds

steps 9400    base_loss: 0.195541    reg_loss: 0.067974    l2_loss: 0.028786    loss: 0.292301
steps 9400    v_Prec: 0.696743  v_Recall: 0.681454  v_F1: 0.689013  v_AUC: 0.908558
steps 9400    running time 333 seconds

steps 9600    base_loss: 0.212272    reg_loss: 0.068184    l2_loss: 0.028943    loss: 0.309399
steps 9600    v_Prec: 0.705810  v_Recall: 0.676498  v_F1: 0.690843  v_AUC: 0.910350
steps 9600    running time 339 seconds

steps 9800    base_loss: 0.201300    reg_loss: 0.068088    l2_loss: 0.029042    loss: 0.298431
steps 9800    v_Prec: 0.688453  v_Recall: 0.703398  v_F1: 0.695845  v_AUC: 0.910884
steps 9800    running time 346 seconds

steps 10000    base_loss: 0.216958    reg_loss: 0.068306    l2_loss: 0.029365    loss: 0.314629
steps 10000    v_Prec: 0.715550  v_Recall: 0.686959  v_F1: 0.700963  v_AUC: 0.912988
steps 10000    running time 352 seconds

steps 10200    base_loss: 0.206020    reg_loss: 0.067954    l2_loss: 0.029643    loss: 0.303616
steps 10200    v_Prec: 0.723583  v_Recall: 0.678622  v_F1: 0.700382  v_AUC: 0.914564
steps 10200    running time 359 seconds

steps 10400    base_loss: 0.210792    reg_loss: 0.067872    l2_loss: 0.029818    loss: 0.308483
steps 10400    v_Prec: 0.737972  v_Recall: 0.673195  v_F1: 0.704097  v_AUC: 0.916287
steps 10400    running time 364 seconds

steps 10600    base_loss: 0.204728    reg_loss: 0.067879    l2_loss: 0.029916    loss: 0.302523
steps 10600    v_Prec: 0.719616  v_Recall: 0.694825  v_F1: 0.707003  v_AUC: 0.916258
steps 10600    running time 371 seconds

steps 10800    base_loss: 0.193152    reg_loss: 0.067751    l2_loss: 0.030168    loss: 0.291072
steps 10800    v_Prec: 0.717690  v_Recall: 0.698836  v_F1: 0.708137  v_AUC: 0.917068
steps 10800    running time 377 seconds

steps 11000    base_loss: 0.088437    reg_loss: 0.067520    l2_loss: 0.030533    loss: 0.186491
steps 11000    v_Prec: 0.693317  v_Recall: 0.681375  v_F1: 0.687294  v_AUC: 0.907302
steps 11000    running time 384 seconds

steps 11200    base_loss: 0.090528    reg_loss: 0.067556    l2_loss: 0.030489    loss: 0.188574
steps 11200    v_Prec: 0.674663  v_Recall: 0.681296  v_F1: 0.677963  v_AUC: 0.901569
steps 11200    running time 390 seconds

steps 11400    base_loss: 0.086139    reg_loss: 0.067476    l2_loss: 0.030625    loss: 0.184239
steps 11400    v_Prec: 0.691828  v_Recall: 0.662498  v_F1: 0.676845  v_AUC: 0.900988
steps 11400    running time 396 seconds

steps 11600    base_loss: 0.088570    reg_loss: 0.067188    l2_loss: 0.030870    loss: 0.186629
steps 11600    v_Prec: 0.660628  v_Recall: 0.676892  v_F1: 0.668661  v_AUC: 0.895862
steps 11600    running time 402 seconds

steps 11800    base_loss: 0.090957    reg_loss: 0.066934    l2_loss: 0.030955    loss: 0.188847
steps 11800    v_Prec: 0.666693  v_Recall: 0.671779  v_F1: 0.669226  v_AUC: 0.897554
steps 11800    running time 408 seconds

steps 12000    base_loss: 0.097090    reg_loss: 0.067124    l2_loss: 0.031102    loss: 0.195316
steps 12000    v_Prec: 0.657389  v_Recall: 0.665094  v_F1: 0.661219  v_AUC: 0.893890
steps 12000    running time 414 seconds

steps 12200    base_loss: 0.099917    reg_loss: 0.067036    l2_loss: 0.031297    loss: 0.198251
steps 12200    v_Prec: 0.674523  v_Recall: 0.652824  v_F1: 0.663496  v_AUC: 0.895935
steps 12200    running time 420 seconds

steps 12400    base_loss: 0.099463    reg_loss: 0.066839    l2_loss: 0.031472    loss: 0.197774
steps 12400    v_Prec: 0.661094  v_Recall: 0.659431  v_F1: 0.660261  v_AUC: 0.893062
steps 12400    running time 426 seconds

steps 12600    base_loss: 0.102768    reg_loss: 0.066782    l2_loss: 0.031472    loss: 0.201022
steps 12600    v_Prec: 0.681170  v_Recall: 0.650149  v_F1: 0.665298  v_AUC: 0.895407
steps 12600    running time 432 seconds

steps 12800    base_loss: 0.096438    reg_loss: 0.066910    l2_loss: 0.031568    loss: 0.194916
steps 12800    v_Prec: 0.652697  v_Recall: 0.673745  v_F1: 0.663054  v_AUC: 0.894693
steps 12800    running time 438 seconds

Early stop model F1: 0.708137
testing thre: 0.37921432
testing Prec: 0.5058141450077412
testing Recall: 0.7462940461725395
testing F1: 0.6029608104924213
testing AUC: 0.8879279885844326
overall running time 441 seconds
(0.6763132030140876, 0.601992709599028, 0.6369924657358123, 0.8879279885844326, 0.73740476)

2019-02-24 16:21:00.253299: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:21:00.783355: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:21:00.789675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:21:00.789743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.700000 seconds
loading data in 30.680000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.502681    reg_loss: 0.064648    l2_loss: 0.013326    loss: 0.580656
steps 200    v_Prec: 0.162700  v_Recall: 0.981459  v_F1: 0.279128  v_AUC: 0.507142
steps 200    running time 40 seconds

steps 400    base_loss: 0.485240    reg_loss: 0.064528    l2_loss: 0.013287    loss: 0.563055
steps 400    v_Prec: 0.165131  v_Recall: 0.921483  v_F1: 0.280072  v_AUC: 0.519303
steps 400    running time 47 seconds

steps 600    base_loss: 0.475912    reg_loss: 0.064341    l2_loss: 0.013128    loss: 0.553382
steps 600    v_Prec: 0.164553  v_Recall: 0.929867  v_F1: 0.279623  v_AUC: 0.526591
steps 600    running time 53 seconds

steps 800    base_loss: 0.466040    reg_loss: 0.064202    l2_loss: 0.013057    loss: 0.543298
steps 800    v_Prec: 0.168002  v_Recall: 0.887707  v_F1: 0.282533  v_AUC: 0.542157
steps 800    running time 59 seconds

steps 1000    base_loss: 0.459270    reg_loss: 0.063892    l2_loss: 0.012999    loss: 0.536161
steps 1000    v_Prec: 0.186962  v_Recall: 0.694478  v_F1: 0.294610  v_AUC: 0.589874
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.442408    reg_loss: 0.063674    l2_loss: 0.012992    loss: 0.519074
steps 1200    v_Prec: 0.276359  v_Recall: 0.451753  v_F1: 0.342931  v_AUC: 0.657329
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.420671    reg_loss: 0.063462    l2_loss: 0.013007    loss: 0.497140
steps 1400    v_Prec: 0.405405  v_Recall: 0.419589  v_F1: 0.412375  v_AUC: 0.717524
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.399452    reg_loss: 0.062941    l2_loss: 0.013027    loss: 0.475420
steps 1600    v_Prec: 0.457472  v_Recall: 0.467392  v_F1: 0.462379  v_AUC: 0.756219
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.377957    reg_loss: 0.062480    l2_loss: 0.013100    loss: 0.453536
steps 1800    v_Prec: 0.506558  v_Recall: 0.504393  v_F1: 0.505473  v_AUC: 0.782811
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.368486    reg_loss: 0.062072    l2_loss: 0.013081    loss: 0.443639
steps 2000    v_Prec: 0.564919  v_Recall: 0.491737  v_F1: 0.525794  v_AUC: 0.799737
steps 2000    running time 97 seconds

steps 2200    base_loss: 0.357261    reg_loss: 0.061407    l2_loss: 0.013007    loss: 0.431674
steps 2200    v_Prec: 0.572122  v_Recall: 0.522451  v_F1: 0.546159  v_AUC: 0.810565
steps 2200    running time 104 seconds

steps 2400    base_loss: 0.345204    reg_loss: 0.060722    l2_loss: 0.012948    loss: 0.418873
steps 2400    v_Prec: 0.557959  v_Recall: 0.557195  v_F1: 0.557577  v_AUC: 0.819489
steps 2400    running time 110 seconds

steps 2600    base_loss: 0.343919    reg_loss: 0.060234    l2_loss: 0.012900    loss: 0.417053
steps 2600    v_Prec: 0.588194  v_Recall: 0.545425  v_F1: 0.566003  v_AUC: 0.828323
steps 2600    running time 117 seconds

steps 2800    base_loss: 0.338580    reg_loss: 0.059639    l2_loss: 0.012875    loss: 0.411095
steps 2800    v_Prec: 0.594939  v_Recall: 0.572350  v_F1: 0.583426  v_AUC: 0.838051
steps 2800    running time 123 seconds

steps 3000    base_loss: 0.327885    reg_loss: 0.059247    l2_loss: 0.013018    loss: 0.400151
steps 3000    v_Prec: 0.610694  v_Recall: 0.596614  v_F1: 0.603572  v_AUC: 0.850542
steps 3000    running time 129 seconds

steps 3200    base_loss: 0.321655    reg_loss: 0.058950    l2_loss: 0.013282    loss: 0.393887
steps 3200    v_Prec: 0.655784  v_Recall: 0.592664  v_F1: 0.622629  v_AUC: 0.861402
steps 3200    running time 135 seconds

steps 3400    base_loss: 0.307773    reg_loss: 0.058463    l2_loss: 0.013699    loss: 0.379935
steps 3400    v_Prec: 0.673619  v_Recall: 0.598791  v_F1: 0.634005  v_AUC: 0.869657
steps 3400    running time 142 seconds

steps 3600    base_loss: 0.300691    reg_loss: 0.058288    l2_loss: 0.014109    loss: 0.373088
steps 3600    v_Prec: 0.698491  v_Recall: 0.604514  v_F1: 0.648114  v_AUC: 0.876511
steps 3600    running time 148 seconds

steps 3800    base_loss: 0.294036    reg_loss: 0.058216    l2_loss: 0.014636    loss: 0.366888
steps 3800    v_Prec: 0.712777  v_Recall: 0.609351  v_F1: 0.657019  v_AUC: 0.879340
steps 3800    running time 155 seconds

steps 4000    base_loss: 0.285725    reg_loss: 0.058232    l2_loss: 0.015144    loss: 0.359101
steps 4000    v_Prec: 0.711389  v_Recall: 0.619347  v_F1: 0.662185  v_AUC: 0.884531
steps 4000    running time 161 seconds

steps 4200    base_loss: 0.288504    reg_loss: 0.058150    l2_loss: 0.015640    loss: 0.362294
steps 4200    v_Prec: 0.702224  v_Recall: 0.638936  v_F1: 0.669087  v_AUC: 0.886677
steps 4200    running time 167 seconds

steps 4400    base_loss: 0.280493    reg_loss: 0.057642    l2_loss: 0.016103    loss: 0.354238
steps 4400    v_Prec: 0.698402  v_Recall: 0.655220  v_F1: 0.676122  v_AUC: 0.889871
steps 4400    running time 174 seconds

steps 4600    base_loss: 0.281516    reg_loss: 0.057717    l2_loss: 0.016605    loss: 0.355837
steps 4600    v_Prec: 0.715674  v_Recall: 0.647078  v_F1: 0.679649  v_AUC: 0.892987
steps 4600    running time 180 seconds

steps 4800    base_loss: 0.278817    reg_loss: 0.057333    l2_loss: 0.017043    loss: 0.353194
steps 4800    v_Prec: 0.730872  v_Recall: 0.639903  v_F1: 0.682369  v_AUC: 0.893896
steps 4800    running time 186 seconds

steps 5000    base_loss: 0.265260    reg_loss: 0.057009    l2_loss: 0.017518    loss: 0.339787
steps 5000    v_Prec: 0.709797  v_Recall: 0.664651  v_F1: 0.686483  v_AUC: 0.895845
steps 5000    running time 193 seconds

steps 5200    base_loss: 0.271963    reg_loss: 0.056786    l2_loss: 0.017991    loss: 0.346740
steps 5200    v_Prec: 0.725077  v_Recall: 0.663120  v_F1: 0.692716  v_AUC: 0.899003
steps 5200    running time 200 seconds

steps 5400    base_loss: 0.265644    reg_loss: 0.056209    l2_loss: 0.018521    loss: 0.340374
steps 5400    v_Prec: 0.730275  v_Recall: 0.664813  v_F1: 0.696008  v_AUC: 0.900103
steps 5400    running time 206 seconds

steps 5600    base_loss: 0.193995    reg_loss: 0.051997    l2_loss: 0.019004    loss: 0.264997
steps 5600    v_Prec: 0.734417  v_Recall: 0.666747  v_F1: 0.698948  v_AUC: 0.899537
steps 5600    running time 212 seconds

steps 5800    base_loss: 0.186595    reg_loss: 0.051600    l2_loss: 0.019598    loss: 0.257794
steps 5800    v_Prec: 0.755247  v_Recall: 0.641032  v_F1: 0.693468  v_AUC: 0.898064
steps 5800    running time 219 seconds

steps 6000    base_loss: 0.189942    reg_loss: 0.051699    l2_loss: 0.020160    loss: 0.261802
steps 6000    v_Prec: 0.754316  v_Recall: 0.644498  v_F1: 0.695097  v_AUC: 0.898099
steps 6000    running time 225 seconds

steps 6200    base_loss: 0.190229    reg_loss: 0.051453    l2_loss: 0.020680    loss: 0.262361
steps 6200    v_Prec: 0.721781  v_Recall: 0.674244  v_F1: 0.697203  v_AUC: 0.898870
steps 6200    running time 231 seconds

steps 6400    base_loss: 0.192120    reg_loss: 0.051282    l2_loss: 0.021158    loss: 0.264560
steps 6400    v_Prec: 0.765151  v_Recall: 0.644256  v_F1: 0.699519  v_AUC: 0.899260
steps 6400    running time 237 seconds

steps 6600    base_loss: 0.192691    reg_loss: 0.051015    l2_loss: 0.021563    loss: 0.265269
steps 6600    v_Prec: 0.729639  v_Recall: 0.680290  v_F1: 0.704101  v_AUC: 0.900271
steps 6600    running time 244 seconds

steps 6800    base_loss: 0.198899    reg_loss: 0.051257    l2_loss: 0.021997    loss: 0.272153
steps 6800    v_Prec: 0.719477  v_Recall: 0.687868  v_F1: 0.703318  v_AUC: 0.901685
steps 6800    running time 250 seconds

steps 7000    base_loss: 0.193812    reg_loss: 0.050847    l2_loss: 0.022219    loss: 0.266879
steps 7000    v_Prec: 0.752017  v_Recall: 0.668601  v_F1: 0.707860  v_AUC: 0.903804
steps 7000    running time 256 seconds

steps 7200    base_loss: 0.197457    reg_loss: 0.050651    l2_loss: 0.022491    loss: 0.270599
steps 7200    v_Prec: 0.752726  v_Recall: 0.673358  v_F1: 0.710833  v_AUC: 0.905385
steps 7200    running time 262 seconds

steps 7400    base_loss: 0.201415    reg_loss: 0.050804    l2_loss: 0.022812    loss: 0.275031
steps 7400    v_Prec: 0.741896  v_Recall: 0.688190  v_F1: 0.714035  v_AUC: 0.907589
steps 7400    running time 269 seconds

steps 7600    base_loss: 0.202889    reg_loss: 0.050385    l2_loss: 0.023046    loss: 0.276320
steps 7600    v_Prec: 0.757844  v_Recall: 0.675615  v_F1: 0.714371  v_AUC: 0.908511
steps 7600    running time 275 seconds

steps 7800    base_loss: 0.201439    reg_loss: 0.050325    l2_loss: 0.023135    loss: 0.274900
steps 7800    v_Prec: 0.754642  v_Recall: 0.684805  v_F1: 0.718029  v_AUC: 0.909338
steps 7800    running time 281 seconds

steps 8000    base_loss: 0.205824    reg_loss: 0.050104    l2_loss: 0.023283    loss: 0.279210
steps 8000    v_Prec: 0.763423  v_Recall: 0.677388  v_F1: 0.717837  v_AUC: 0.910682
steps 8000    running time 288 seconds

steps 8200    base_loss: 0.199653    reg_loss: 0.049659    l2_loss: 0.023422    loss: 0.272734
steps 8200    v_Prec: 0.740056  v_Recall: 0.703426  v_F1: 0.721276  v_AUC: 0.912343
steps 8200    running time 294 seconds

steps 8400    base_loss: 0.198000    reg_loss: 0.049638    l2_loss: 0.023470    loss: 0.271108
steps 8400    v_Prec: 0.768847  v_Recall: 0.683192  v_F1: 0.723493  v_AUC: 0.911152
steps 8400    running time 300 seconds

steps 8600    base_loss: 0.206500    reg_loss: 0.049645    l2_loss: 0.023628    loss: 0.279772
steps 8600    v_Prec: 0.758672  v_Recall: 0.698186  v_F1: 0.727174  v_AUC: 0.915056
steps 8600    running time 307 seconds

steps 8800    base_loss: 0.205106    reg_loss: 0.049596    l2_loss: 0.023714    loss: 0.278416
steps 8800    v_Prec: 0.764290  v_Recall: 0.688755  v_F1: 0.724559  v_AUC: 0.914723
steps 8800    running time 313 seconds

steps 9000    base_loss: 0.207328    reg_loss: 0.049272    l2_loss: 0.023771    loss: 0.280371
steps 9000    v_Prec: 0.745146  v_Recall: 0.714631  v_F1: 0.729570  v_AUC: 0.916566
steps 9000    running time 319 seconds

steps 9200    base_loss: 0.194603    reg_loss: 0.048812    l2_loss: 0.023746    loss: 0.267160
steps 9200    v_Prec: 0.760501  v_Recall: 0.704958  v_F1: 0.731677  v_AUC: 0.917741
steps 9200    running time 325 seconds

steps 9400    base_loss: 0.202595    reg_loss: 0.049119    l2_loss: 0.023939    loss: 0.275654
steps 9400    v_Prec: 0.757915  v_Recall: 0.710198  v_F1: 0.733281  v_AUC: 0.918877
steps 9400    running time 332 seconds

steps 9600    base_loss: 0.192459    reg_loss: 0.048829    l2_loss: 0.024113    loss: 0.265401
steps 9600    v_Prec: 0.778490  v_Recall: 0.694962  v_F1: 0.734358  v_AUC: 0.918671
steps 9600    running time 339 seconds

steps 9800    base_loss: 0.197935    reg_loss: 0.048793    l2_loss: 0.024207    loss: 0.270935
steps 9800    v_Prec: 0.758885  v_Recall: 0.710923  v_F1: 0.734121  v_AUC: 0.920100
steps 9800    running time 345 seconds

steps 10000    base_loss: 0.193358    reg_loss: 0.048519    l2_loss: 0.024237    loss: 0.266115
steps 10000    v_Prec: 0.773099  v_Recall: 0.701491  v_F1: 0.735556  v_AUC: 0.919670
steps 10000    running time 351 seconds

steps 10200    base_loss: 0.204524    reg_loss: 0.048542    l2_loss: 0.024313    loss: 0.277379
steps 10200    v_Prec: 0.767104  v_Recall: 0.711326  v_F1: 0.738163  v_AUC: 0.920204
steps 10200    running time 357 seconds

steps 10400    base_loss: 0.190598    reg_loss: 0.048291    l2_loss: 0.024338    loss: 0.263227
steps 10400    v_Prec: 0.772067  v_Recall: 0.710762  v_F1: 0.740147  v_AUC: 0.922108
steps 10400    running time 364 seconds

steps 10600    base_loss: 0.195972    reg_loss: 0.048264    l2_loss: 0.024424    loss: 0.268661
steps 10600    v_Prec: 0.781036  v_Recall: 0.706489  v_F1: 0.741895  v_AUC: 0.922954
steps 10600    running time 370 seconds

steps 10800    base_loss: 0.194083    reg_loss: 0.047853    l2_loss: 0.024476    loss: 0.266412
steps 10800    v_Prec: 0.785984  v_Recall: 0.705200  v_F1: 0.743403  v_AUC: 0.923730
steps 10800    running time 377 seconds

steps 11000    base_loss: 0.079258    reg_loss: 0.042733    l2_loss: 0.024438    loss: 0.146429
steps 11000    v_Prec: 0.759851  v_Recall: 0.721322  v_F1: 0.740085  v_AUC: 0.921339
steps 11000    running time 383 seconds

steps 11200    base_loss: 0.074665    reg_loss: 0.042566    l2_loss: 0.024393    loss: 0.141624
steps 11200    v_Prec: 0.767990  v_Recall: 0.709794  v_F1: 0.737746  v_AUC: 0.920789
steps 11200    running time 389 seconds

steps 11400    base_loss: 0.081452    reg_loss: 0.042829    l2_loss: 0.024424    loss: 0.148705
steps 11400    v_Prec: 0.777798  v_Recall: 0.700363  v_F1: 0.737052  v_AUC: 0.919236
steps 11400    running time 395 seconds

steps 11600    base_loss: 0.082137    reg_loss: 0.042795    l2_loss: 0.024424    loss: 0.149356
steps 11600    v_Prec: 0.789049  v_Recall: 0.693511  v_F1: 0.738201  v_AUC: 0.918230
steps 11600    running time 401 seconds

steps 11800    base_loss: 0.076487    reg_loss: 0.042964    l2_loss: 0.024601    loss: 0.144053
steps 11800    v_Prec: 0.760360  v_Recall: 0.714389  v_F1: 0.736658  v_AUC: 0.918481
steps 11800    running time 407 seconds

steps 12000    base_loss: 0.082287    reg_loss: 0.042955    l2_loss: 0.024630    loss: 0.149871
steps 12000    v_Prec: 0.758334  v_Recall: 0.713341  v_F1: 0.735150  v_AUC: 0.916823
steps 12000    running time 413 seconds

steps 12200    base_loss: 0.085831    reg_loss: 0.043195    l2_loss: 0.024746    loss: 0.153772
steps 12200    v_Prec: 0.783326  v_Recall: 0.696816  v_F1: 0.737543  v_AUC: 0.918922
steps 12200    running time 419 seconds

steps 12400    base_loss: 0.082163    reg_loss: 0.042978    l2_loss: 0.024728    loss: 0.149869
steps 12400    v_Prec: 0.753161  v_Recall: 0.720193  v_F1: 0.736309  v_AUC: 0.916636
steps 12400    running time 425 seconds

steps 12600    base_loss: 0.084884    reg_loss: 0.042938    l2_loss: 0.024617    loss: 0.152439
steps 12600    v_Prec: 0.758354  v_Recall: 0.711649  v_F1: 0.734259  v_AUC: 0.917400
steps 12600    running time 431 seconds

steps 12800    base_loss: 0.082610    reg_loss: 0.043093    l2_loss: 0.024660    loss: 0.150364
steps 12800    v_Prec: 0.771891  v_Recall: 0.699960  v_F1: 0.734168  v_AUC: 0.917392
steps 12800    running time 437 seconds

Early stop model F1: 0.743403
testing thre: 0.56573784
testing Prec: 0.5927445302445302
testing Recall: 0.7163061968408262
testing F1: 0.6486938532978278
testing AUC: 0.8933747072488364
overall running time 440 seconds
(0.6876599300224555, 0.64, 0.6629745242170979, 0.8933747072488364, 0.76408887)

2019-02-24 16:25:37.191505: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:25:38.157314: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:25:38.163315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:25:38.163353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.430000 seconds
loading data in 30.440000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.593914    reg_loss: 0.064993    l2_loss: 0.013348    loss: 0.672255
steps 200    v_Prec: 0.163298  v_Recall: 1.000000  v_F1: 0.280750  v_AUC: 0.492530
steps 200    running time 40 seconds

steps 400    base_loss: 0.498451    reg_loss: 0.065028    l2_loss: 0.013258    loss: 0.576737
steps 400    v_Prec: 0.163500  v_Recall: 0.995605  v_F1: 0.280874  v_AUC: 0.526765
steps 400    running time 46 seconds

steps 600    base_loss: 0.475894    reg_loss: 0.064985    l2_loss: 0.013093    loss: 0.553972
steps 600    v_Prec: 0.198198  v_Recall: 0.613393  v_F1: 0.299592  v_AUC: 0.590658
steps 600    running time 53 seconds

steps 800    base_loss: 0.443121    reg_loss: 0.064924    l2_loss: 0.012980    loss: 0.521024
steps 800    v_Prec: 0.269380  v_Recall: 0.472910  v_F1: 0.343242  v_AUC: 0.662233
steps 800    running time 60 seconds

steps 1000    base_loss: 0.423212    reg_loss: 0.065143    l2_loss: 0.012949    loss: 0.501304
steps 1000    v_Prec: 0.338694  v_Recall: 0.488013  v_F1: 0.399869  v_AUC: 0.722411
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.402429    reg_loss: 0.065242    l2_loss: 0.012927    loss: 0.480599
steps 1200    v_Prec: 0.429689  v_Recall: 0.482739  v_F1: 0.454672  v_AUC: 0.765766
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.386667    reg_loss: 0.065486    l2_loss: 0.012988    loss: 0.465141
steps 1400    v_Prec: 0.517721  v_Recall: 0.482100  v_F1: 0.499276  v_AUC: 0.796437
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.375666    reg_loss: 0.066022    l2_loss: 0.013083    loss: 0.454771
steps 1600    v_Prec: 0.514124  v_Recall: 0.545389  v_F1: 0.529295  v_AUC: 0.816704
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.349369    reg_loss: 0.066130    l2_loss: 0.013160    loss: 0.428659
steps 1800    v_Prec: 0.573872  v_Recall: 0.541633  v_F1: 0.557287  v_AUC: 0.833783
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.340707    reg_loss: 0.066614    l2_loss: 0.013360    loss: 0.420680
steps 2000    v_Prec: 0.606907  v_Recall: 0.551862  v_F1: 0.578077  v_AUC: 0.845100
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.322556    reg_loss: 0.066749    l2_loss: 0.013519    loss: 0.402825
steps 2200    v_Prec: 0.613475  v_Recall: 0.578472  v_F1: 0.595459  v_AUC: 0.855121
steps 2200    running time 104 seconds

steps 2400    base_loss: 0.313953    reg_loss: 0.067050    l2_loss: 0.013691    loss: 0.394694
steps 2400    v_Prec: 0.645423  v_Recall: 0.571360  v_F1: 0.606138  v_AUC: 0.862906
steps 2400    running time 111 seconds

steps 2600    base_loss: 0.305628    reg_loss: 0.066991    l2_loss: 0.014019    loss: 0.386637
steps 2600    v_Prec: 0.637222  v_Recall: 0.604123  v_F1: 0.620231  v_AUC: 0.867899
steps 2600    running time 117 seconds

steps 2800    base_loss: 0.298937    reg_loss: 0.067280    l2_loss: 0.014177    loss: 0.380394
steps 2800    v_Prec: 0.660557  v_Recall: 0.593256  v_F1: 0.625100  v_AUC: 0.872053
steps 2800    running time 123 seconds

steps 3000    base_loss: 0.301325    reg_loss: 0.067530    l2_loss: 0.014480    loss: 0.383334
steps 3000    v_Prec: 0.700504  v_Recall: 0.588381  v_F1: 0.639566  v_AUC: 0.875654
steps 3000    running time 130 seconds

steps 3200    base_loss: 0.291755    reg_loss: 0.067529    l2_loss: 0.014719    loss: 0.374003
steps 3200    v_Prec: 0.661910  v_Recall: 0.630174  v_F1: 0.645653  v_AUC: 0.881188
steps 3200    running time 136 seconds

steps 3400    base_loss: 0.283608    reg_loss: 0.067351    l2_loss: 0.015019    loss: 0.365978
steps 3400    v_Prec: 0.673184  v_Recall: 0.627297  v_F1: 0.649431  v_AUC: 0.884099
steps 3400    running time 142 seconds

steps 3600    base_loss: 0.285807    reg_loss: 0.067586    l2_loss: 0.015358    loss: 0.368751
steps 3600    v_Prec: 0.674454  v_Recall: 0.632092  v_F1: 0.652586  v_AUC: 0.887853
steps 3600    running time 149 seconds

steps 3800    base_loss: 0.279529    reg_loss: 0.067535    l2_loss: 0.015771    loss: 0.362835
steps 3800    v_Prec: 0.687170  v_Recall: 0.624021  v_F1: 0.654075  v_AUC: 0.889312
steps 3800    running time 155 seconds

steps 4000    base_loss: 0.284069    reg_loss: 0.067512    l2_loss: 0.016283    loss: 0.367864
steps 4000    v_Prec: 0.676654  v_Recall: 0.631613  v_F1: 0.653358  v_AUC: 0.890610
steps 4000    running time 162 seconds

steps 4200    base_loss: 0.281757    reg_loss: 0.067553    l2_loss: 0.016677    loss: 0.365987
steps 4200    v_Prec: 0.674352  v_Recall: 0.638085  v_F1: 0.655718  v_AUC: 0.893398
steps 4200    running time 168 seconds

steps 4400    base_loss: 0.279670    reg_loss: 0.067541    l2_loss: 0.017128    loss: 0.364339
steps 4400    v_Prec: 0.697742  v_Recall: 0.629775  v_F1: 0.662019  v_AUC: 0.895798
steps 4400    running time 175 seconds

steps 4600    base_loss: 0.281576    reg_loss: 0.067566    l2_loss: 0.017605    loss: 0.366746
steps 4600    v_Prec: 0.690657  v_Recall: 0.645677  v_F1: 0.667410  v_AUC: 0.897121
steps 4600    running time 181 seconds

steps 4800    base_loss: 0.275583    reg_loss: 0.067487    l2_loss: 0.018108    loss: 0.361177
steps 4800    v_Prec: 0.691955  v_Recall: 0.639204  v_F1: 0.664534  v_AUC: 0.898683
steps 4800    running time 188 seconds

steps 5000    base_loss: 0.267442    reg_loss: 0.067414    l2_loss: 0.018738    loss: 0.353594
steps 5000    v_Prec: 0.667072  v_Recall: 0.657584  v_F1: 0.662294  v_AUC: 0.897961
steps 5000    running time 194 seconds

steps 5200    base_loss: 0.280000    reg_loss: 0.067200    l2_loss: 0.019246    loss: 0.366446
steps 5200    v_Prec: 0.682613  v_Recall: 0.648793  v_F1: 0.665274  v_AUC: 0.899658
steps 5200    running time 200 seconds

steps 5400    base_loss: 0.268961    reg_loss: 0.067286    l2_loss: 0.019832    loss: 0.356079
steps 5400    v_Prec: 0.678194  v_Recall: 0.666054  v_F1: 0.672069  v_AUC: 0.901743
steps 5400    running time 205 seconds

steps 5600    base_loss: 0.174032    reg_loss: 0.068225    l2_loss: 0.020716    loss: 0.262973
steps 5600    v_Prec: 0.689092  v_Recall: 0.644159  v_F1: 0.665868  v_AUC: 0.897854
steps 5600    running time 212 seconds

steps 5800    base_loss: 0.177147    reg_loss: 0.067812    l2_loss: 0.021493    loss: 0.266452
steps 5800    v_Prec: 0.661684  v_Recall: 0.657983  v_F1: 0.659829  v_AUC: 0.894164
steps 5800    running time 218 seconds

steps 6000    base_loss: 0.192993    reg_loss: 0.068017    l2_loss: 0.022229    loss: 0.283239
steps 6000    v_Prec: 0.669377  v_Recall: 0.651350  v_F1: 0.660241  v_AUC: 0.893767
steps 6000    running time 224 seconds

steps 6200    base_loss: 0.184984    reg_loss: 0.068084    l2_loss: 0.022805    loss: 0.275872
steps 6200    v_Prec: 0.663012  v_Recall: 0.657184  v_F1: 0.660085  v_AUC: 0.894872
steps 6200    running time 230 seconds

steps 6400    base_loss: 0.195755    reg_loss: 0.067963    l2_loss: 0.023489    loss: 0.287207
steps 6400    v_Prec: 0.704558  v_Recall: 0.622583  v_F1: 0.661039  v_AUC: 0.895054
steps 6400    running time 236 seconds

steps 6600    base_loss: 0.181392    reg_loss: 0.067950    l2_loss: 0.024004    loss: 0.273346
steps 6600    v_Prec: 0.681450  v_Recall: 0.645837  v_F1: 0.663166  v_AUC: 0.894568
steps 6600    running time 242 seconds

steps 6800    base_loss: 0.190211    reg_loss: 0.067789    l2_loss: 0.024472    loss: 0.282472
steps 6800    v_Prec: 0.681978  v_Recall: 0.652549  v_F1: 0.666939  v_AUC: 0.896639
steps 6800    running time 248 seconds

steps 7000    base_loss: 0.197844    reg_loss: 0.067853    l2_loss: 0.025076    loss: 0.290773
steps 7000    v_Prec: 0.697453  v_Recall: 0.639044  v_F1: 0.666972  v_AUC: 0.896241
steps 7000    running time 254 seconds

steps 7200    base_loss: 0.194389    reg_loss: 0.067884    l2_loss: 0.025530    loss: 0.287803
steps 7200    v_Prec: 0.707095  v_Recall: 0.638725  v_F1: 0.671173  v_AUC: 0.896729
steps 7200    running time 260 seconds

steps 7400    base_loss: 0.184156    reg_loss: 0.067747    l2_loss: 0.025869    loss: 0.277773
steps 7400    v_Prec: 0.707994  v_Recall: 0.639763  v_F1: 0.672152  v_AUC: 0.898972
steps 7400    running time 266 seconds

steps 7600    base_loss: 0.188605    reg_loss: 0.067730    l2_loss: 0.026207    loss: 0.282541
steps 7600    v_Prec: 0.712194  v_Recall: 0.637526  v_F1: 0.672795  v_AUC: 0.899691
steps 7600    running time 272 seconds

steps 7800    base_loss: 0.194491    reg_loss: 0.067876    l2_loss: 0.026608    loss: 0.288975
steps 7800    v_Prec: 0.703152  v_Recall: 0.652469  v_F1: 0.676863  v_AUC: 0.901278
steps 7800    running time 279 seconds

steps 8000    base_loss: 0.196438    reg_loss: 0.067587    l2_loss: 0.027010    loss: 0.291035
steps 8000    v_Prec: 0.703351  v_Recall: 0.654227  v_F1: 0.677900  v_AUC: 0.900811
steps 8000    running time 285 seconds

steps 8200    base_loss: 0.189802    reg_loss: 0.067530    l2_loss: 0.027311    loss: 0.284643
steps 8200    v_Prec: 0.708139  v_Recall: 0.666773  v_F1: 0.686834  v_AUC: 0.904823
steps 8200    running time 291 seconds

steps 8400    base_loss: 0.185893    reg_loss: 0.067550    l2_loss: 0.027603    loss: 0.281046
steps 8400    v_Prec: 0.714520  v_Recall: 0.661020  v_F1: 0.686729  v_AUC: 0.904649
steps 8400    running time 298 seconds

steps 8600    base_loss: 0.189832    reg_loss: 0.067478    l2_loss: 0.027913    loss: 0.285222
steps 8600    v_Prec: 0.724225  v_Recall: 0.661259  v_F1: 0.691312  v_AUC: 0.906060
steps 8600    running time 304 seconds

steps 8800    base_loss: 0.196764    reg_loss: 0.067412    l2_loss: 0.028016    loss: 0.292192
steps 8800    v_Prec: 0.704547  v_Recall: 0.679719  v_F1: 0.691910  v_AUC: 0.907254
steps 8800    running time 311 seconds

steps 9000    base_loss: 0.190236    reg_loss: 0.067469    l2_loss: 0.028386    loss: 0.286090
steps 9000    v_Prec: 0.711094  v_Recall: 0.674045  v_F1: 0.692074  v_AUC: 0.907173
steps 9000    running time 317 seconds

steps 9200    base_loss: 0.198476    reg_loss: 0.067403    l2_loss: 0.028660    loss: 0.294539
steps 9200    v_Prec: 0.725826  v_Recall: 0.670609  v_F1: 0.697126  v_AUC: 0.910585
steps 9200    running time 323 seconds

steps 9400    base_loss: 0.188062    reg_loss: 0.067481    l2_loss: 0.028985    loss: 0.284529
steps 9400    v_Prec: 0.705267  v_Recall: 0.694502  v_F1: 0.699843  v_AUC: 0.912350
steps 9400    running time 330 seconds

steps 9600    base_loss: 0.200513    reg_loss: 0.067226    l2_loss: 0.029108    loss: 0.296847
steps 9600    v_Prec: 0.718029  v_Recall: 0.694103  v_F1: 0.705863  v_AUC: 0.913531
steps 9600    running time 336 seconds

steps 9800    base_loss: 0.192981    reg_loss: 0.067031    l2_loss: 0.029341    loss: 0.289353
steps 9800    v_Prec: 0.715522  v_Recall: 0.700256  v_F1: 0.707807  v_AUC: 0.915631
steps 9800    running time 342 seconds

steps 10000    base_loss: 0.191082    reg_loss: 0.067119    l2_loss: 0.029541    loss: 0.287742
steps 10000    v_Prec: 0.744890  v_Recall: 0.672687  v_F1: 0.706949  v_AUC: 0.916216
steps 10000    running time 349 seconds

steps 10200    base_loss: 0.182113    reg_loss: 0.067247    l2_loss: 0.029786    loss: 0.279147
steps 10200    v_Prec: 0.728450  v_Recall: 0.692185  v_F1: 0.709855  v_AUC: 0.917365
steps 10200    running time 355 seconds

steps 10400    base_loss: 0.199189    reg_loss: 0.066752    l2_loss: 0.029953    loss: 0.295893
steps 10400    v_Prec: 0.744639  v_Recall: 0.690906  v_F1: 0.716767  v_AUC: 0.919269
steps 10400    running time 361 seconds

steps 10600    base_loss: 0.194364    reg_loss: 0.067224    l2_loss: 0.030062    loss: 0.291650
steps 10600    v_Prec: 0.733624  v_Recall: 0.698098  v_F1: 0.715421  v_AUC: 0.919839
steps 10600    running time 367 seconds

steps 10800    base_loss: 0.174978    reg_loss: 0.066819    l2_loss: 0.030345    loss: 0.272141
steps 10800    v_Prec: 0.754992  v_Recall: 0.682835  v_F1: 0.717103  v_AUC: 0.918647
steps 10800    running time 373 seconds

steps 11000    base_loss: 0.079072    reg_loss: 0.066195    l2_loss: 0.030508    loss: 0.175774
steps 11000    v_Prec: 0.727397  v_Recall: 0.680837  v_F1: 0.703348  v_AUC: 0.912901
steps 11000    running time 380 seconds

steps 11200    base_loss: 0.081981    reg_loss: 0.066163    l2_loss: 0.030651    loss: 0.178795
steps 11200    v_Prec: 0.724325  v_Recall: 0.662218  v_F1: 0.691881  v_AUC: 0.905889
steps 11200    running time 386 seconds

steps 11400    base_loss: 0.081695    reg_loss: 0.066229    l2_loss: 0.030799    loss: 0.178723
steps 11400    v_Prec: 0.706326  v_Recall: 0.666533  v_F1: 0.685853  v_AUC: 0.903093
steps 11400    running time 392 seconds

steps 11600    base_loss: 0.080866    reg_loss: 0.066021    l2_loss: 0.031023    loss: 0.177910
steps 11600    v_Prec: 0.688672  v_Recall: 0.683554  v_F1: 0.686104  v_AUC: 0.903027
steps 11600    running time 398 seconds

steps 11800    base_loss: 0.091004    reg_loss: 0.066007    l2_loss: 0.031020    loss: 0.188031
steps 11800    v_Prec: 0.690718  v_Recall: 0.673166  v_F1: 0.681829  v_AUC: 0.900071
steps 11800    running time 404 seconds

steps 12000    base_loss: 0.084057    reg_loss: 0.065704    l2_loss: 0.031154    loss: 0.180914
steps 12000    v_Prec: 0.701256  v_Recall: 0.660460  v_F1: 0.680247  v_AUC: 0.898381
steps 12000    running time 410 seconds

steps 12200    base_loss: 0.087795    reg_loss: 0.065703    l2_loss: 0.031226    loss: 0.184724
steps 12200    v_Prec: 0.694477  v_Recall: 0.659182  v_F1: 0.676369  v_AUC: 0.897639
steps 12200    running time 416 seconds

steps 12400    base_loss: 0.092502    reg_loss: 0.065934    l2_loss: 0.031285    loss: 0.189721
steps 12400    v_Prec: 0.684358  v_Recall: 0.664616  v_F1: 0.674342  v_AUC: 0.897583
steps 12400    running time 422 seconds

steps 12600    base_loss: 0.087225    reg_loss: 0.065708    l2_loss: 0.031513    loss: 0.184446
steps 12600    v_Prec: 0.689664  v_Recall: 0.662218  v_F1: 0.675662  v_AUC: 0.898583
steps 12600    running time 428 seconds

steps 12800    base_loss: 0.092476    reg_loss: 0.065590    l2_loss: 0.031652    loss: 0.189718
steps 12800    v_Prec: 0.682119  v_Recall: 0.659661  v_F1: 0.670702  v_AUC: 0.895923
steps 12800    running time 434 seconds

Early stop model F1: 0.717103
testing thre: 0.45662287
testing Prec: 0.5459570778235422
testing Recall: 0.7344349939246658
testing F1: 0.6263237518910741
testing AUC: 0.8952714500937585
overall running time 436 seconds
(0.6952281816687668, 0.616767922235723, 0.6536520037086639, 0.8952714500937585, 0.75641614)

2019-02-24 16:30:14.250544: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:30:16.621872: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:30:16.635558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:30:16.635633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.750000 seconds
loading data in 30.910000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.667765    reg_loss: 0.064943    l2_loss: 0.013370    loss: 0.746078
steps 200    v_Prec: 0.162634  v_Recall: 0.999599  v_F1: 0.279752  v_AUC: 0.498562
steps 200    running time 41 seconds

steps 400    base_loss: 0.516744    reg_loss: 0.064928    l2_loss: 0.013284    loss: 0.594956
steps 400    v_Prec: 0.163108  v_Recall: 0.992456  v_F1: 0.280170  v_AUC: 0.526180
steps 400    running time 48 seconds

steps 600    base_loss: 0.489226    reg_loss: 0.064876    l2_loss: 0.013153    loss: 0.567255
steps 600    v_Prec: 0.171741  v_Recall: 0.849358  v_F1: 0.285710  v_AUC: 0.561346
steps 600    running time 54 seconds

steps 800    base_loss: 0.472109    reg_loss: 0.064964    l2_loss: 0.013055    loss: 0.550129
steps 800    v_Prec: 0.219450  v_Recall: 0.530819  v_F1: 0.310524  v_AUC: 0.613432
steps 800    running time 61 seconds

steps 1000    base_loss: 0.447999    reg_loss: 0.065020    l2_loss: 0.012903    loss: 0.525923
steps 1000    v_Prec: 0.314827  v_Recall: 0.439165  v_F1: 0.366744  v_AUC: 0.685968
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.424125    reg_loss: 0.065132    l2_loss: 0.012835    loss: 0.502092
steps 1200    v_Prec: 0.397664  v_Recall: 0.472793  v_F1: 0.431987  v_AUC: 0.747341
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.393753    reg_loss: 0.065415    l2_loss: 0.012839    loss: 0.472006
steps 1400    v_Prec: 0.464125  v_Recall: 0.495265  v_F1: 0.479189  v_AUC: 0.783712
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.372937    reg_loss: 0.065722    l2_loss: 0.012938    loss: 0.451597
steps 1600    v_Prec: 0.518996  v_Recall: 0.507624  v_F1: 0.513247  v_AUC: 0.808295
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.353956    reg_loss: 0.065978    l2_loss: 0.013101    loss: 0.433035
steps 1800    v_Prec: 0.565695  v_Recall: 0.532825  v_F1: 0.548768  v_AUC: 0.828661
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.336494    reg_loss: 0.066289    l2_loss: 0.013221    loss: 0.416003
steps 2000    v_Prec: 0.584106  v_Recall: 0.561557  v_F1: 0.572609  v_AUC: 0.844482
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.328073    reg_loss: 0.066639    l2_loss: 0.013472    loss: 0.408183
steps 2200    v_Prec: 0.599389  v_Recall: 0.582745  v_F1: 0.590950  v_AUC: 0.855712
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.315084    reg_loss: 0.066919    l2_loss: 0.013657    loss: 0.395660
steps 2400    v_Prec: 0.633441  v_Recall: 0.581942  v_F1: 0.606601  v_AUC: 0.862329
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.309416    reg_loss: 0.067147    l2_loss: 0.013872    loss: 0.390435
steps 2600    v_Prec: 0.617289  v_Recall: 0.622392  v_F1: 0.619830  v_AUC: 0.870915
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.306133    reg_loss: 0.067338    l2_loss: 0.014146    loss: 0.387617
steps 2800    v_Prec: 0.638485  v_Recall: 0.610353  v_F1: 0.624102  v_AUC: 0.874936
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.295536    reg_loss: 0.067517    l2_loss: 0.014355    loss: 0.377408
steps 3000    v_Prec: 0.647103  v_Recall: 0.627368  v_F1: 0.637082  v_AUC: 0.880796
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.288966    reg_loss: 0.067408    l2_loss: 0.014762    loss: 0.371136
steps 3200    v_Prec: 0.653942  v_Recall: 0.632424  v_F1: 0.643003  v_AUC: 0.884153
steps 3200    running time 138 seconds

steps 3400    base_loss: 0.282985    reg_loss: 0.067453    l2_loss: 0.015079    loss: 0.365517
steps 3400    v_Prec: 0.650807  v_Recall: 0.634510  v_F1: 0.642555  v_AUC: 0.886155
steps 3400    running time 145 seconds

steps 3600    base_loss: 0.280677    reg_loss: 0.067324    l2_loss: 0.015442    loss: 0.363443
steps 3600    v_Prec: 0.678879  v_Recall: 0.614205  v_F1: 0.644925  v_AUC: 0.887102
steps 3600    running time 151 seconds

steps 3800    base_loss: 0.284603    reg_loss: 0.067398    l2_loss: 0.015807    loss: 0.367808
steps 3800    v_Prec: 0.662282  v_Recall: 0.642456  v_F1: 0.652218  v_AUC: 0.891035
steps 3800    running time 158 seconds

steps 4000    base_loss: 0.282370    reg_loss: 0.067429    l2_loss: 0.016253    loss: 0.366052
steps 4000    v_Prec: 0.676432  v_Recall: 0.626324  v_F1: 0.650415  v_AUC: 0.891746
steps 4000    running time 164 seconds

steps 4200    base_loss: 0.273592    reg_loss: 0.067569    l2_loss: 0.016691    loss: 0.357852
steps 4200    v_Prec: 0.689643  v_Recall: 0.629535  v_F1: 0.658219  v_AUC: 0.894037
steps 4200    running time 170 seconds

steps 4400    base_loss: 0.279504    reg_loss: 0.067578    l2_loss: 0.017121    loss: 0.364204
steps 4400    v_Prec: 0.698733  v_Recall: 0.628411  v_F1: 0.661709  v_AUC: 0.896256
steps 4400    running time 177 seconds

steps 4600    base_loss: 0.279285    reg_loss: 0.067282    l2_loss: 0.017635    loss: 0.364202
steps 4600    v_Prec: 0.682904  v_Recall: 0.640209  v_F1: 0.660867  v_AUC: 0.897715
steps 4600    running time 183 seconds

steps 4800    base_loss: 0.270662    reg_loss: 0.067502    l2_loss: 0.018192    loss: 0.356357
steps 4800    v_Prec: 0.690196  v_Recall: 0.639567  v_F1: 0.663917  v_AUC: 0.897603
steps 4800    running time 189 seconds

steps 5000    base_loss: 0.273455    reg_loss: 0.067067    l2_loss: 0.018787    loss: 0.359309
steps 5000    v_Prec: 0.691378  v_Recall: 0.647432  v_F1: 0.668684  v_AUC: 0.899549
steps 5000    running time 196 seconds

steps 5200    base_loss: 0.265331    reg_loss: 0.067147    l2_loss: 0.019372    loss: 0.351850
steps 5200    v_Prec: 0.671476  v_Recall: 0.661075  v_F1: 0.666235  v_AUC: 0.900602
steps 5200    running time 202 seconds

steps 5400    base_loss: 0.265634    reg_loss: 0.067041    l2_loss: 0.020006    loss: 0.352681
steps 5400    v_Prec: 0.660461  v_Recall: 0.669101  v_F1: 0.664753  v_AUC: 0.900824
steps 5400    running time 208 seconds

steps 5600    base_loss: 0.178961    reg_loss: 0.067757    l2_loss: 0.020886    loss: 0.267603
steps 5600    v_Prec: 0.657857  v_Recall: 0.659230  v_F1: 0.658542  v_AUC: 0.895593
steps 5600    running time 214 seconds

steps 5800    base_loss: 0.179048    reg_loss: 0.067667    l2_loss: 0.021622    loss: 0.268337
steps 5800    v_Prec: 0.693806  v_Recall: 0.620305  v_F1: 0.655000  v_AUC: 0.893277
steps 5800    running time 220 seconds

steps 6000    base_loss: 0.176137    reg_loss: 0.067760    l2_loss: 0.022310    loss: 0.266206
steps 6000    v_Prec: 0.666997  v_Recall: 0.648636  v_F1: 0.657688  v_AUC: 0.894142
steps 6000    running time 226 seconds

steps 6200    base_loss: 0.181898    reg_loss: 0.067777    l2_loss: 0.023065    loss: 0.272739
steps 6200    v_Prec: 0.674609  v_Recall: 0.643098  v_F1: 0.658476  v_AUC: 0.892165
steps 6200    running time 232 seconds

steps 6400    base_loss: 0.185606    reg_loss: 0.067971    l2_loss: 0.023681    loss: 0.277258
steps 6400    v_Prec: 0.674503  v_Recall: 0.642456  v_F1: 0.658089  v_AUC: 0.892915
steps 6400    running time 238 seconds

steps 6600    base_loss: 0.197980    reg_loss: 0.068044    l2_loss: 0.024241    loss: 0.290265
steps 6600    v_Prec: 0.659342  v_Recall: 0.659872  v_F1: 0.659607  v_AUC: 0.893190
steps 6600    running time 244 seconds

steps 6800    base_loss: 0.192050    reg_loss: 0.067833    l2_loss: 0.024652    loss: 0.284535
steps 6800    v_Prec: 0.672001  v_Recall: 0.653772  v_F1: 0.662761  v_AUC: 0.895660
steps 6800    running time 250 seconds

steps 7000    base_loss: 0.185337    reg_loss: 0.067809    l2_loss: 0.025103    loss: 0.278249
steps 7000    v_Prec: 0.689173  v_Recall: 0.640610  v_F1: 0.664005  v_AUC: 0.894249
steps 7000    running time 256 seconds

Early stop model F1: 0.668684
testing thre: 0.38171622
testing Prec: 0.518783542039356
testing Recall: 0.6624544349939246
testing F1: 0.5818818306010928
testing AUC: 0.8625153272591637
overall running time 259 seconds
(0.6172348880987241, 0.5737059538274605, 0.5946749288395172, 0.8625153272591637, 0.51407653)

2019-02-24 16:33:05.164826: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:33:06.767143: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:33:06.768957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:33:06.769000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.140000 seconds
loading data in 30.320000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.795602    reg_loss: 0.064604    l2_loss: 0.013346    loss: 0.873552
steps 200    v_Prec: 0.163570  v_Recall: 0.981329  v_F1: 0.280402  v_AUC: 0.536552
steps 200    running time 41 seconds

steps 400    base_loss: 0.571743    reg_loss: 0.064182    l2_loss: 0.013316    loss: 0.649242
steps 400    v_Prec: 0.176386  v_Recall: 0.736357  v_F1: 0.284599  v_AUC: 0.556767
steps 400    running time 47 seconds

steps 600    base_loss: 0.485830    reg_loss: 0.063815    l2_loss: 0.013285    loss: 0.562931
steps 600    v_Prec: 0.194172  v_Recall: 0.651414  v_F1: 0.299168  v_AUC: 0.590895
steps 600    running time 54 seconds

steps 800    base_loss: 0.462184    reg_loss: 0.063373    l2_loss: 0.013189    loss: 0.538746
steps 800    v_Prec: 0.224514  v_Recall: 0.599167  v_F1: 0.326635  v_AUC: 0.637044
steps 800    running time 60 seconds

steps 1000    base_loss: 0.445678    reg_loss: 0.062776    l2_loss: 0.013117    loss: 0.521571
steps 1000    v_Prec: 0.305591  v_Recall: 0.466063  v_F1: 0.369141  v_AUC: 0.685399
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.428811    reg_loss: 0.062094    l2_loss: 0.013074    loss: 0.503978
steps 1200    v_Prec: 0.415143  v_Recall: 0.434971  v_F1: 0.424826  v_AUC: 0.731632
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.407127    reg_loss: 0.061301    l2_loss: 0.013172    loss: 0.481599
steps 1400    v_Prec: 0.494710  v_Recall: 0.475839  v_F1: 0.485091  v_AUC: 0.773899
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.378640    reg_loss: 0.060265    l2_loss: 0.013314    loss: 0.452218
steps 1600    v_Prec: 0.558123  v_Recall: 0.512862  v_F1: 0.534536  v_AUC: 0.808302
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.345936    reg_loss: 0.059398    l2_loss: 0.013521    loss: 0.418855
steps 1800    v_Prec: 0.627810  v_Recall: 0.521356  v_F1: 0.569652  v_AUC: 0.828674
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.338128    reg_loss: 0.059120    l2_loss: 0.013796    loss: 0.411044
steps 2000    v_Prec: 0.613964  v_Recall: 0.583460  v_F1: 0.598324  v_AUC: 0.845497
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.315936    reg_loss: 0.058617    l2_loss: 0.014027    loss: 0.388580
steps 2200    v_Prec: 0.638470  v_Recall: 0.600609  v_F1: 0.618961  v_AUC: 0.857243
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.301406    reg_loss: 0.058183    l2_loss: 0.014259    loss: 0.373848
steps 2400    v_Prec: 0.715514  v_Recall: 0.573604  v_F1: 0.636748  v_AUC: 0.864503
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.300729    reg_loss: 0.058104    l2_loss: 0.014577    loss: 0.373410
steps 2600    v_Prec: 0.689334  v_Recall: 0.611668  v_F1: 0.648183  v_AUC: 0.869611
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.294121    reg_loss: 0.057492    l2_loss: 0.014855    loss: 0.366468
steps 2800    v_Prec: 0.715263  v_Recall: 0.611748  v_F1: 0.659468  v_AUC: 0.874078
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.284524    reg_loss: 0.057155    l2_loss: 0.015147    loss: 0.356826
steps 3000    v_Prec: 0.723793  v_Recall: 0.615274  v_F1: 0.665136  v_AUC: 0.879331
steps 3000    running time 131 seconds

steps 3200    base_loss: 0.279284    reg_loss: 0.056854    l2_loss: 0.015402    loss: 0.351540
steps 3200    v_Prec: 0.710936  v_Recall: 0.636589  v_F1: 0.671712  v_AUC: 0.883451
steps 3200    running time 137 seconds

steps 3400    base_loss: 0.272167    reg_loss: 0.056489    l2_loss: 0.015614    loss: 0.344270
steps 3400    v_Prec: 0.736847  v_Recall: 0.629618  v_F1: 0.679025  v_AUC: 0.886625
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.278703    reg_loss: 0.056350    l2_loss: 0.015899    loss: 0.350951
steps 3600    v_Prec: 0.734261  v_Recall: 0.638352  v_F1: 0.682956  v_AUC: 0.888355
steps 3600    running time 150 seconds

steps 3800    base_loss: 0.272032    reg_loss: 0.055996    l2_loss: 0.016187    loss: 0.344214
steps 3800    v_Prec: 0.760273  v_Recall: 0.625691  v_F1: 0.686448  v_AUC: 0.891816
steps 3800    running time 156 seconds

steps 4000    base_loss: 0.274485    reg_loss: 0.055793    l2_loss: 0.016433    loss: 0.346711
steps 4000    v_Prec: 0.740683  v_Recall: 0.648209  v_F1: 0.691368  v_AUC: 0.895176
steps 4000    running time 163 seconds

steps 4200    base_loss: 0.275071    reg_loss: 0.055652    l2_loss: 0.016696    loss: 0.347419
steps 4200    v_Prec: 0.746362  v_Recall: 0.653418  v_F1: 0.696804  v_AUC: 0.899254
steps 4200    running time 169 seconds

steps 4400    base_loss: 0.261254    reg_loss: 0.055519    l2_loss: 0.017011    loss: 0.333785
steps 4400    v_Prec: 0.736356  v_Recall: 0.664957  v_F1: 0.698838  v_AUC: 0.900639
steps 4400    running time 176 seconds

steps 4600    base_loss: 0.261319    reg_loss: 0.055317    l2_loss: 0.017482    loss: 0.334118
steps 4600    v_Prec: 0.732510  v_Recall: 0.679622  v_F1: 0.705075  v_AUC: 0.902857
steps 4600    running time 182 seconds

steps 4800    base_loss: 0.260939    reg_loss: 0.055203    l2_loss: 0.017744    loss: 0.333886
steps 4800    v_Prec: 0.752784  v_Recall: 0.660790  v_F1: 0.703794  v_AUC: 0.904156
steps 4800    running time 189 seconds

steps 5000    base_loss: 0.264577    reg_loss: 0.055145    l2_loss: 0.018142    loss: 0.337864
steps 5000    v_Prec: 0.731159  v_Recall: 0.677138  v_F1: 0.703112  v_AUC: 0.904789
steps 5000    running time 195 seconds

steps 5200    base_loss: 0.256919    reg_loss: 0.054874    l2_loss: 0.018575    loss: 0.330367
steps 5200    v_Prec: 0.751569  v_Recall: 0.671769  v_F1: 0.709432  v_AUC: 0.905645
steps 5200    running time 201 seconds

steps 5400    base_loss: 0.254635    reg_loss: 0.054550    l2_loss: 0.019079    loss: 0.328264
steps 5400    v_Prec: 0.769761  v_Recall: 0.662553  v_F1: 0.712145  v_AUC: 0.908602
steps 5400    running time 207 seconds

steps 5600    base_loss: 0.165996    reg_loss: 0.050416    l2_loss: 0.019616    loss: 0.236028
steps 5600    v_Prec: 0.755773  v_Recall: 0.668804  v_F1: 0.709634  v_AUC: 0.904546
steps 5600    running time 213 seconds

steps 5800    base_loss: 0.177137    reg_loss: 0.050727    l2_loss: 0.020255    loss: 0.248119
steps 5800    v_Prec: 0.751206  v_Recall: 0.673852  v_F1: 0.710430  v_AUC: 0.903291
steps 5800    running time 219 seconds

steps 6000    base_loss: 0.172811    reg_loss: 0.050306    l2_loss: 0.020896    loss: 0.244013
steps 6000    v_Prec: 0.773634  v_Recall: 0.649892  v_F1: 0.706384  v_AUC: 0.903727
steps 6000    running time 225 seconds

steps 6200    base_loss: 0.174317    reg_loss: 0.049950    l2_loss: 0.021568    loss: 0.245835
steps 6200    v_Prec: 0.762070  v_Recall: 0.667842  v_F1: 0.711851  v_AUC: 0.903367
steps 6200    running time 231 seconds

steps 6400    base_loss: 0.175273    reg_loss: 0.049706    l2_loss: 0.021916    loss: 0.246895
steps 6400    v_Prec: 0.752249  v_Recall: 0.676657  v_F1: 0.712454  v_AUC: 0.904022
steps 6400    running time 237 seconds

steps 6600    base_loss: 0.166760    reg_loss: 0.049460    l2_loss: 0.022354    loss: 0.238574
steps 6600    v_Prec: 0.740970  v_Recall: 0.682186  v_F1: 0.710364  v_AUC: 0.903315
steps 6600    running time 244 seconds

steps 6800    base_loss: 0.176110    reg_loss: 0.048967    l2_loss: 0.022858    loss: 0.247935
steps 6800    v_Prec: 0.768155  v_Recall: 0.660309  v_F1: 0.710161  v_AUC: 0.902012
steps 6800    running time 250 seconds

steps 7000    base_loss: 0.176872    reg_loss: 0.049256    l2_loss: 0.023253    loss: 0.249382
steps 7000    v_Prec: 0.741291  v_Recall: 0.683789  v_F1: 0.711380  v_AUC: 0.904197
steps 7000    running time 256 seconds

steps 7200    base_loss: 0.183588    reg_loss: 0.049191    l2_loss: 0.023524    loss: 0.256304
steps 7200    v_Prec: 0.757129  v_Recall: 0.674493  v_F1: 0.713426  v_AUC: 0.904629
steps 7200    running time 262 seconds

steps 7400    base_loss: 0.177867    reg_loss: 0.048863    l2_loss: 0.023803    loss: 0.250533
steps 7400    v_Prec: 0.753335  v_Recall: 0.683308  v_F1: 0.716615  v_AUC: 0.906760
steps 7400    running time 268 seconds

steps 7600    base_loss: 0.186389    reg_loss: 0.048831    l2_loss: 0.023924    loss: 0.259144
steps 7600    v_Prec: 0.768357  v_Recall: 0.672490  v_F1: 0.717234  v_AUC: 0.907591
steps 7600    running time 275 seconds

steps 7800    base_loss: 0.182055    reg_loss: 0.048772    l2_loss: 0.024114    loss: 0.254942
steps 7800    v_Prec: 0.778005  v_Recall: 0.671769  v_F1: 0.720994  v_AUC: 0.907337
steps 7800    running time 281 seconds

steps 8000    base_loss: 0.180551    reg_loss: 0.048615    l2_loss: 0.024288    loss: 0.253454
steps 8000    v_Prec: 0.775865  v_Recall: 0.679061  v_F1: 0.724243  v_AUC: 0.910134
steps 8000    running time 287 seconds

steps 8200    base_loss: 0.185687    reg_loss: 0.048313    l2_loss: 0.024548    loss: 0.258547
steps 8200    v_Prec: 0.778562  v_Recall: 0.680423  v_F1: 0.726192  v_AUC: 0.910700
steps 8200    running time 294 seconds

steps 8400    base_loss: 0.182702    reg_loss: 0.048027    l2_loss: 0.024766    loss: 0.255494
steps 8400    v_Prec: 0.759607  v_Recall: 0.700136  v_F1: 0.728660  v_AUC: 0.913520
steps 8400    running time 300 seconds

steps 8600    base_loss: 0.190782    reg_loss: 0.048063    l2_loss: 0.024889    loss: 0.263734
steps 8600    v_Prec: 0.775884  v_Recall: 0.689398  v_F1: 0.730089  v_AUC: 0.913842
steps 8600    running time 306 seconds

steps 8800    base_loss: 0.196046    reg_loss: 0.048036    l2_loss: 0.025028    loss: 0.269110
steps 8800    v_Prec: 0.762315  v_Recall: 0.701899  v_F1: 0.730861  v_AUC: 0.914069
steps 8800    running time 313 seconds

steps 9000    base_loss: 0.185336    reg_loss: 0.047635    l2_loss: 0.025082    loss: 0.258052
steps 9000    v_Prec: 0.789246  v_Recall: 0.686914  v_F1: 0.734533  v_AUC: 0.916461
steps 9000    running time 319 seconds

steps 9200    base_loss: 0.189699    reg_loss: 0.047623    l2_loss: 0.025326    loss: 0.262648
steps 9200    v_Prec: 0.764206  v_Recall: 0.705906  v_F1: 0.733900  v_AUC: 0.917635
steps 9200    running time 326 seconds

steps 9400    base_loss: 0.188090    reg_loss: 0.047738    l2_loss: 0.025281    loss: 0.261108
steps 9400    v_Prec: 0.777305  v_Recall: 0.702059  v_F1: 0.737768  v_AUC: 0.918333
steps 9400    running time 332 seconds

steps 9600    base_loss: 0.177363    reg_loss: 0.047493    l2_loss: 0.025363    loss: 0.250219
steps 9600    v_Prec: 0.787569  v_Recall: 0.697572  v_F1: 0.739844  v_AUC: 0.919476
steps 9600    running time 338 seconds

steps 9800    base_loss: 0.185477    reg_loss: 0.047374    l2_loss: 0.025416    loss: 0.258266
steps 9800    v_Prec: 0.769137  v_Recall: 0.709352  v_F1: 0.738036  v_AUC: 0.919554
steps 9800    running time 344 seconds

steps 10000    base_loss: 0.177653    reg_loss: 0.047152    l2_loss: 0.025612    loss: 0.250417
steps 10000    v_Prec: 0.786496  v_Recall: 0.697251  v_F1: 0.739190  v_AUC: 0.921480
steps 10000    running time 350 seconds

steps 10200    base_loss: 0.186078    reg_loss: 0.047307    l2_loss: 0.025608    loss: 0.258993
steps 10200    v_Prec: 0.781703  v_Recall: 0.709352  v_F1: 0.743772  v_AUC: 0.922301
steps 10200    running time 356 seconds

steps 10400    base_loss: 0.189670    reg_loss: 0.047260    l2_loss: 0.025666    loss: 0.262596
steps 10400    v_Prec: 0.759824  v_Recall: 0.731389  v_F1: 0.745335  v_AUC: 0.923858
steps 10400    running time 363 seconds

steps 10600    base_loss: 0.188361    reg_loss: 0.047035    l2_loss: 0.025619    loss: 0.261015
steps 10600    v_Prec: 0.774174  v_Recall: 0.719208  v_F1: 0.745680  v_AUC: 0.924070
steps 10600    running time 369 seconds

steps 10800    base_loss: 0.173397    reg_loss: 0.046136    l2_loss: 0.025665    loss: 0.245198
steps 10800    v_Prec: 0.789576  v_Recall: 0.712637  v_F1: 0.749137  v_AUC: 0.925146
steps 10800    running time 376 seconds

steps 11000    base_loss: 0.073933    reg_loss: 0.041689    l2_loss: 0.025676    loss: 0.141298
steps 11000    v_Prec: 0.779159  v_Recall: 0.713038  v_F1: 0.744634  v_AUC: 0.921994
steps 11000    running time 382 seconds

steps 11200    base_loss: 0.074868    reg_loss: 0.041824    l2_loss: 0.025643    loss: 0.142335
steps 11200    v_Prec: 0.787165  v_Recall: 0.701819  v_F1: 0.742046  v_AUC: 0.921326
steps 11200    running time 388 seconds

steps 11400    base_loss: 0.069153    reg_loss: 0.041846    l2_loss: 0.025731    loss: 0.136729
steps 11400    v_Prec: 0.782934  v_Recall: 0.704383  v_F1: 0.741584  v_AUC: 0.919800
steps 11400    running time 394 seconds

steps 11600    base_loss: 0.069953    reg_loss: 0.042022    l2_loss: 0.025649    loss: 0.137623
steps 11600    v_Prec: 0.769918  v_Recall: 0.710874  v_F1: 0.739219  v_AUC: 0.918741
steps 11600    running time 400 seconds

steps 11800    base_loss: 0.069586    reg_loss: 0.042198    l2_loss: 0.025509    loss: 0.137293
steps 11800    v_Prec: 0.787282  v_Recall: 0.701418  v_F1: 0.741874  v_AUC: 0.919957
steps 11800    running time 406 seconds

steps 12000    base_loss: 0.070515    reg_loss: 0.042383    l2_loss: 0.025649    loss: 0.138548
steps 12000    v_Prec: 0.799589  v_Recall: 0.686433  v_F1: 0.738703  v_AUC: 0.918332
steps 12000    running time 412 seconds

steps 12200    base_loss: 0.074569    reg_loss: 0.042172    l2_loss: 0.025689    loss: 0.142430
steps 12200    v_Prec: 0.784698  v_Recall: 0.698614  v_F1: 0.739158  v_AUC: 0.919539
steps 12200    running time 418 seconds

steps 12400    base_loss: 0.077320    reg_loss: 0.042231    l2_loss: 0.025645    loss: 0.145196
steps 12400    v_Prec: 0.763805  v_Recall: 0.711595  v_F1: 0.736777  v_AUC: 0.918779
steps 12400    running time 424 seconds

steps 12600    base_loss: 0.081035    reg_loss: 0.042161    l2_loss: 0.025522    loss: 0.148718
steps 12600    v_Prec: 0.775606  v_Recall: 0.699655  v_F1: 0.735676  v_AUC: 0.917799
steps 12600    running time 430 seconds

steps 12800    base_loss: 0.084161    reg_loss: 0.042101    l2_loss: 0.025371    loss: 0.151634
steps 12800    v_Prec: 0.791008  v_Recall: 0.693645  v_F1: 0.739134  v_AUC: 0.919945
steps 12800    running time 436 seconds

Early stop model F1: 0.749137
testing thre: 0.5457877
testing Prec: 0.5794304630779069
testing Recall: 0.7486269744835966
testing F1: 0.653250773993808
testing AUC: 0.8985431495772184
overall running time 438 seconds
(0.7046090108751942, 0.6612879708383961, 0.682261501817726, 0.8985431495772184, 0.804083)

2019-02-24 16:37:45.037432: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:37:46.254997: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:37:46.264679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:37:46.264753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.570000 seconds
loading data in 30.790000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.579276    reg_loss: 0.064742    l2_loss: 0.013293    loss: 0.657310
steps 200    v_Prec: 0.165399  v_Recall: 0.975075  v_F1: 0.282823  v_AUC: 0.524053
steps 200    running time 40 seconds

steps 400    base_loss: 0.508549    reg_loss: 0.064451    l2_loss: 0.013209    loss: 0.586209
steps 400    v_Prec: 0.172170  v_Recall: 0.829497  v_F1: 0.285153  v_AUC: 0.544025
steps 400    running time 47 seconds

steps 600    base_loss: 0.485507    reg_loss: 0.064041    l2_loss: 0.012945    loss: 0.562493
steps 600    v_Prec: 0.180398  v_Recall: 0.752580  v_F1: 0.291034  v_AUC: 0.567173
steps 600    running time 53 seconds

steps 800    base_loss: 0.454799    reg_loss: 0.063529    l2_loss: 0.012638    loss: 0.530966
steps 800    v_Prec: 0.233180  v_Recall: 0.511986  v_F1: 0.320425  v_AUC: 0.629331
steps 800    running time 60 seconds

steps 1000    base_loss: 0.442014    reg_loss: 0.062955    l2_loss: 0.012531    loss: 0.517499
steps 1000    v_Prec: 0.318472  v_Recall: 0.423004  v_F1: 0.363370  v_AUC: 0.673921
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.416827    reg_loss: 0.062100    l2_loss: 0.012423    loss: 0.491350
steps 1200    v_Prec: 0.360947  v_Recall: 0.451341  v_F1: 0.401115  v_AUC: 0.705598
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.410972    reg_loss: 0.061962    l2_loss: 0.012366    loss: 0.485301
steps 1400    v_Prec: 0.440783  v_Recall: 0.434275  v_F1: 0.437505  v_AUC: 0.737478
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.392291    reg_loss: 0.061838    l2_loss: 0.012445    loss: 0.466574
steps 1600    v_Prec: 0.460996  v_Recall: 0.498174  v_F1: 0.478865  v_AUC: 0.770452
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.383579    reg_loss: 0.061936    l2_loss: 0.012487    loss: 0.458003
steps 1800    v_Prec: 0.488395  v_Recall: 0.501111  v_F1: 0.494672  v_AUC: 0.783023
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.362694    reg_loss: 0.061746    l2_loss: 0.012582    loss: 0.437022
steps 2000    v_Prec: 0.528276  v_Recall: 0.519051  v_F1: 0.523623  v_AUC: 0.804128
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.360316    reg_loss: 0.061901    l2_loss: 0.012708    loss: 0.434925
steps 2200    v_Prec: 0.506175  v_Recall: 0.572631  v_F1: 0.537356  v_AUC: 0.814571
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.354341    reg_loss: 0.062155    l2_loss: 0.012763    loss: 0.429258
steps 2400    v_Prec: 0.526998  v_Recall: 0.577949  v_F1: 0.551299  v_AUC: 0.827019
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.338213    reg_loss: 0.062676    l2_loss: 0.012892    loss: 0.413780
steps 2600    v_Prec: 0.529412  v_Recall: 0.606525  v_F1: 0.565351  v_AUC: 0.837168
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.329436    reg_loss: 0.063606    l2_loss: 0.013119    loss: 0.406160
steps 2800    v_Prec: 0.542353  v_Recall: 0.617003  v_F1: 0.577274  v_AUC: 0.845877
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.329066    reg_loss: 0.064647    l2_loss: 0.013468    loss: 0.407181
steps 3000    v_Prec: 0.592769  v_Recall: 0.584299  v_F1: 0.588503  v_AUC: 0.853383
steps 3000    running time 131 seconds

steps 3200    base_loss: 0.315859    reg_loss: 0.065344    l2_loss: 0.013874    loss: 0.395077
steps 3200    v_Prec: 0.576983  v_Recall: 0.622003  v_F1: 0.598648  v_AUC: 0.860134
steps 3200    running time 138 seconds

steps 3400    base_loss: 0.316465    reg_loss: 0.065921    l2_loss: 0.014405    loss: 0.396791
steps 3400    v_Prec: 0.605039  v_Recall: 0.613828  v_F1: 0.609401  v_AUC: 0.867244
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.301812    reg_loss: 0.066309    l2_loss: 0.014933    loss: 0.383053
steps 3600    v_Prec: 0.601213  v_Recall: 0.629703  v_F1: 0.615128  v_AUC: 0.869739
steps 3600    running time 151 seconds

steps 3800    base_loss: 0.297451    reg_loss: 0.066746    l2_loss: 0.015432    loss: 0.379628
steps 3800    v_Prec: 0.625692  v_Recall: 0.618987  v_F1: 0.622322  v_AUC: 0.873445
steps 3800    running time 157 seconds

steps 4000    base_loss: 0.295484    reg_loss: 0.066998    l2_loss: 0.015896    loss: 0.378378
steps 4000    v_Prec: 0.638762  v_Recall: 0.620813  v_F1: 0.629659  v_AUC: 0.877231
steps 4000    running time 164 seconds

steps 4200    base_loss: 0.302680    reg_loss: 0.067309    l2_loss: 0.016433    loss: 0.386423
steps 4200    v_Prec: 0.626339  v_Recall: 0.640260  v_F1: 0.633223  v_AUC: 0.880231
steps 4200    running time 170 seconds

steps 4400    base_loss: 0.295200    reg_loss: 0.067564    l2_loss: 0.016950    loss: 0.379714
steps 4400    v_Prec: 0.668160  v_Recall: 0.615495  v_F1: 0.640747  v_AUC: 0.883900
steps 4400    running time 177 seconds

steps 4600    base_loss: 0.285609    reg_loss: 0.067930    l2_loss: 0.017583    loss: 0.371122
steps 4600    v_Prec: 0.648232  v_Recall: 0.637323  v_F1: 0.642731  v_AUC: 0.885190
steps 4600    running time 183 seconds

steps 4800    base_loss: 0.283600    reg_loss: 0.067682    l2_loss: 0.018144    loss: 0.369426
steps 4800    v_Prec: 0.640128  v_Recall: 0.652881  v_F1: 0.646442  v_AUC: 0.886607
steps 4800    running time 189 seconds

steps 5000    base_loss: 0.285649    reg_loss: 0.067612    l2_loss: 0.018963    loss: 0.372225
steps 5000    v_Prec: 0.658186  v_Recall: 0.636609  v_F1: 0.647218  v_AUC: 0.888320
steps 5000    running time 196 seconds

steps 5200    base_loss: 0.285813    reg_loss: 0.067949    l2_loss: 0.019639    loss: 0.373401
steps 5200    v_Prec: 0.650879  v_Recall: 0.643594  v_F1: 0.647216  v_AUC: 0.889069
steps 5200    running time 202 seconds

steps 5400    base_loss: 0.274036    reg_loss: 0.067836    l2_loss: 0.020338    loss: 0.362210
steps 5400    v_Prec: 0.664963  v_Recall: 0.640419  v_F1: 0.652460  v_AUC: 0.891033
steps 5400    running time 208 seconds

steps 5600    base_loss: 0.198731    reg_loss: 0.069226    l2_loss: 0.021210    loss: 0.289167
steps 5600    v_Prec: 0.650723  v_Recall: 0.636053  v_F1: 0.643304  v_AUC: 0.886134
steps 5600    running time 214 seconds

steps 5800    base_loss: 0.190955    reg_loss: 0.069103    l2_loss: 0.021961    loss: 0.282019
steps 5800    v_Prec: 0.645047  v_Recall: 0.649706  v_F1: 0.647368  v_AUC: 0.886235
steps 5800    running time 220 seconds

steps 6000    base_loss: 0.205849    reg_loss: 0.068880    l2_loss: 0.022720    loss: 0.297449
steps 6000    v_Prec: 0.639907  v_Recall: 0.655501  v_F1: 0.647610  v_AUC: 0.885834
steps 6000    running time 227 seconds

steps 6200    base_loss: 0.203134    reg_loss: 0.069206    l2_loss: 0.023187    loss: 0.295527
steps 6200    v_Prec: 0.657425  v_Recall: 0.634307  v_F1: 0.645659  v_AUC: 0.885934
steps 6200    running time 232 seconds

steps 6400    base_loss: 0.200007    reg_loss: 0.068777    l2_loss: 0.023812    loss: 0.292597
steps 6400    v_Prec: 0.638668  v_Recall: 0.657882  v_F1: 0.648133  v_AUC: 0.885506
steps 6400    running time 239 seconds

steps 6600    base_loss: 0.202499    reg_loss: 0.068654    l2_loss: 0.024283    loss: 0.295437
steps 6600    v_Prec: 0.639607  v_Recall: 0.661692  v_F1: 0.650462  v_AUC: 0.888180
steps 6600    running time 245 seconds

steps 6800    base_loss: 0.196876    reg_loss: 0.068744    l2_loss: 0.024799    loss: 0.290419
steps 6800    v_Prec: 0.674707  v_Recall: 0.639467  v_F1: 0.656614  v_AUC: 0.888628
steps 6800    running time 251 seconds

steps 7000    base_loss: 0.209523    reg_loss: 0.069166    l2_loss: 0.025220    loss: 0.303909
steps 7000    v_Prec: 0.654060  v_Recall: 0.664391  v_F1: 0.659185  v_AUC: 0.890821
steps 7000    running time 257 seconds

steps 7200    base_loss: 0.203803    reg_loss: 0.068574    l2_loss: 0.025574    loss: 0.297951
steps 7200    v_Prec: 0.665675  v_Recall: 0.657327  v_F1: 0.661475  v_AUC: 0.891798
steps 7200    running time 264 seconds

steps 7400    base_loss: 0.214793    reg_loss: 0.068616    l2_loss: 0.025938    loss: 0.309347
steps 7400    v_Prec: 0.656610  v_Recall: 0.670265  v_F1: 0.663367  v_AUC: 0.893258
steps 7400    running time 270 seconds

steps 7600    base_loss: 0.205521    reg_loss: 0.068730    l2_loss: 0.026220    loss: 0.300471
steps 7600    v_Prec: 0.662829  v_Recall: 0.662724  v_F1: 0.662777  v_AUC: 0.894083
steps 7600    running time 276 seconds

steps 7800    base_loss: 0.205871    reg_loss: 0.068306    l2_loss: 0.026572    loss: 0.300749
steps 7800    v_Prec: 0.660233  v_Recall: 0.673440  v_F1: 0.666771  v_AUC: 0.896408
steps 7800    running time 282 seconds

steps 8000    base_loss: 0.208433    reg_loss: 0.068514    l2_loss: 0.026988    loss: 0.303935
steps 8000    v_Prec: 0.708735  v_Recall: 0.629862  v_F1: 0.666975  v_AUC: 0.897233
steps 8000    running time 289 seconds

steps 8200    base_loss: 0.204694    reg_loss: 0.068621    l2_loss: 0.027135    loss: 0.300450
steps 8200    v_Prec: 0.672085  v_Recall: 0.666217  v_F1: 0.669138  v_AUC: 0.897894
steps 8200    running time 295 seconds

steps 8400    base_loss: 0.211246    reg_loss: 0.068647    l2_loss: 0.027525    loss: 0.307418
steps 8400    v_Prec: 0.686572  v_Recall: 0.660740  v_F1: 0.673408  v_AUC: 0.899466
steps 8400    running time 302 seconds

steps 8600    base_loss: 0.205539    reg_loss: 0.068004    l2_loss: 0.027780    loss: 0.301322
steps 8600    v_Prec: 0.686047  v_Recall: 0.658438  v_F1: 0.671959  v_AUC: 0.900785
steps 8600    running time 308 seconds

steps 8800    base_loss: 0.219383    reg_loss: 0.068485    l2_loss: 0.028042    loss: 0.315911
steps 8800    v_Prec: 0.676452  v_Recall: 0.682251  v_F1: 0.679339  v_AUC: 0.903000
steps 8800    running time 314 seconds

steps 9000    base_loss: 0.205600    reg_loss: 0.068320    l2_loss: 0.028260    loss: 0.302180
steps 9000    v_Prec: 0.714323  v_Recall: 0.655183  v_F1: 0.683476  v_AUC: 0.905054
steps 9000    running time 321 seconds

steps 9200    base_loss: 0.201480    reg_loss: 0.068162    l2_loss: 0.028518    loss: 0.298160
steps 9200    v_Prec: 0.714322  v_Recall: 0.662327  v_F1: 0.687343  v_AUC: 0.904628
steps 9200    running time 327 seconds

steps 9400    base_loss: 0.202303    reg_loss: 0.068118    l2_loss: 0.028812    loss: 0.299233
steps 9400    v_Prec: 0.739851  v_Recall: 0.648119  v_F1: 0.690954  v_AUC: 0.907004
steps 9400    running time 334 seconds

steps 9600    base_loss: 0.200600    reg_loss: 0.068040    l2_loss: 0.029046    loss: 0.297686
steps 9600    v_Prec: 0.707269  v_Recall: 0.681219  v_F1: 0.694000  v_AUC: 0.908826
steps 9600    running time 340 seconds

steps 9800    base_loss: 0.201563    reg_loss: 0.068056    l2_loss: 0.029226    loss: 0.298846
steps 9800    v_Prec: 0.736721  v_Recall: 0.661692  v_F1: 0.697194  v_AUC: 0.911947
steps 9800    running time 346 seconds

steps 10000    base_loss: 0.196406    reg_loss: 0.068040    l2_loss: 0.029420    loss: 0.293866
steps 10000    v_Prec: 0.739608  v_Recall: 0.662407  v_F1: 0.698882  v_AUC: 0.910864
steps 10000    running time 353 seconds

steps 10200    base_loss: 0.198223    reg_loss: 0.067987    l2_loss: 0.029631    loss: 0.295841
steps 10200    v_Prec: 0.755726  v_Recall: 0.657406  v_F1: 0.703146  v_AUC: 0.913487
steps 10200    running time 359 seconds

steps 10400    base_loss: 0.196716    reg_loss: 0.067955    l2_loss: 0.029816    loss: 0.294486
steps 10400    v_Prec: 0.746606  v_Recall: 0.667963  v_F1: 0.705099  v_AUC: 0.914405
steps 10400    running time 365 seconds

steps 10600    base_loss: 0.200133    reg_loss: 0.067849    l2_loss: 0.029843    loss: 0.297826
steps 10600    v_Prec: 0.750510  v_Recall: 0.671694  v_F1: 0.708918  v_AUC: 0.916735
steps 10600    running time 372 seconds

steps 10800    base_loss: 0.193446    reg_loss: 0.068074    l2_loss: 0.030127    loss: 0.291648
steps 10800    v_Prec: 0.722300  v_Recall: 0.697015  v_F1: 0.709432  v_AUC: 0.916826
steps 10800    running time 378 seconds

steps 11000    base_loss: 0.088747    reg_loss: 0.068169    l2_loss: 0.030295    loss: 0.187211
steps 11000    v_Prec: 0.674670  v_Recall: 0.702572  v_F1: 0.688338  v_AUC: 0.907245
steps 11000    running time 385 seconds

steps 11200    base_loss: 0.090518    reg_loss: 0.067458    l2_loss: 0.030327    loss: 0.188304
steps 11200    v_Prec: 0.676979  v_Recall: 0.680902  v_F1: 0.678935  v_AUC: 0.903341
steps 11200    running time 391 seconds

steps 11400    base_loss: 0.088354    reg_loss: 0.067397    l2_loss: 0.030534    loss: 0.186285
steps 11400    v_Prec: 0.674503  v_Recall: 0.680981  v_F1: 0.677726  v_AUC: 0.901546
steps 11400    running time 397 seconds

steps 11600    base_loss: 0.092481    reg_loss: 0.067323    l2_loss: 0.030680    loss: 0.190483
steps 11600    v_Prec: 0.666151  v_Recall: 0.682966  v_F1: 0.674453  v_AUC: 0.900173
steps 11600    running time 403 seconds

steps 11800    base_loss: 0.090926    reg_loss: 0.067287    l2_loss: 0.030974    loss: 0.189187
steps 11800    v_Prec: 0.642900  v_Recall: 0.677092  v_F1: 0.659553  v_AUC: 0.892960
steps 11800    running time 409 seconds

steps 12000    base_loss: 0.091624    reg_loss: 0.067063    l2_loss: 0.030912    loss: 0.189600
steps 12000    v_Prec: 0.652506  v_Recall: 0.671773  v_F1: 0.661999  v_AUC: 0.894075
steps 12000    running time 415 seconds

steps 12200    base_loss: 0.095646    reg_loss: 0.067272    l2_loss: 0.031087    loss: 0.194005
steps 12200    v_Prec: 0.661025  v_Recall: 0.666534  v_F1: 0.663768  v_AUC: 0.893584
steps 12200    running time 421 seconds

steps 12400    base_loss: 0.096835    reg_loss: 0.067296    l2_loss: 0.031222    loss: 0.195353
steps 12400    v_Prec: 0.666238  v_Recall: 0.658041  v_F1: 0.662114  v_AUC: 0.891418
steps 12400    running time 427 seconds

steps 12600    base_loss: 0.097248    reg_loss: 0.067031    l2_loss: 0.031337    loss: 0.195617
steps 12600    v_Prec: 0.653028  v_Recall: 0.675266  v_F1: 0.663961  v_AUC: 0.892673
steps 12600    running time 432 seconds

steps 12800    base_loss: 0.092830    reg_loss: 0.066782    l2_loss: 0.031514    loss: 0.191126
steps 12800    v_Prec: 0.652740  v_Recall: 0.672170  v_F1: 0.662313  v_AUC: 0.892348
steps 12800    running time 439 seconds

Early stop model F1: 0.709432
testing thre: 0.34748748
testing Prec: 0.5128627082213864
testing Recall: 0.7422114216281895
testing F1: 0.6065817957935293
testing AUC: 0.8904754282494584
overall running time 441 seconds
(0.6654951741502309, 0.6166221142162819, 0.6401271475062438, 0.8904754282494584, 0.6740193)

2019-02-24 16:42:24.967363: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:42:25.412412: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:42:25.414879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:42:25.414923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.740000 seconds
loading data in 29.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.741177    reg_loss: 0.064771    l2_loss: 0.013365    loss: 0.819313
steps 200    v_Prec: 0.164038  v_Recall: 0.999124  v_F1: 0.281808  v_AUC: 0.507792
steps 200    running time 39 seconds

steps 400    base_loss: 0.572639    reg_loss: 0.064613    l2_loss: 0.013422    loss: 0.650674
steps 400    v_Prec: 0.163933  v_Recall: 1.000000  v_F1: 0.281688  v_AUC: 0.463243
steps 400    running time 46 seconds

steps 600    base_loss: 0.485085    reg_loss: 0.064471    l2_loss: 0.013211    loss: 0.562766
steps 600    v_Prec: 0.163942  v_Recall: 1.000000  v_F1: 0.281701  v_AUC: 0.487655
steps 600    running time 52 seconds

steps 800    base_loss: 0.463939    reg_loss: 0.064027    l2_loss: 0.012915    loss: 0.540882
steps 800    v_Prec: 0.163931  v_Recall: 1.000000  v_F1: 0.281685  v_AUC: 0.513683
steps 800    running time 58 seconds

steps 1000    base_loss: 0.457661    reg_loss: 0.064059    l2_loss: 0.012753    loss: 0.534473
steps 1000    v_Prec: 0.164165  v_Recall: 0.995782  v_F1: 0.281862  v_AUC: 0.537548
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.457118    reg_loss: 0.063978    l2_loss: 0.012658    loss: 0.533754
steps 1200    v_Prec: 0.177187  v_Recall: 0.723894  v_F1: 0.284690  v_AUC: 0.569869
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.443222    reg_loss: 0.063566    l2_loss: 0.012571    loss: 0.519359
steps 1400    v_Prec: 0.246561  v_Recall: 0.425183  v_F1: 0.312124  v_AUC: 0.610348
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.430600    reg_loss: 0.063346    l2_loss: 0.012549    loss: 0.506494
steps 1600    v_Prec: 0.328823  v_Recall: 0.386819  v_F1: 0.355471  v_AUC: 0.660186
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.420202    reg_loss: 0.063325    l2_loss: 0.012645    loss: 0.496172
steps 1800    v_Prec: 0.422621  v_Recall: 0.405365  v_F1: 0.413813  v_AUC: 0.705953
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.408426    reg_loss: 0.063527    l2_loss: 0.012856    loss: 0.484809
steps 2000    v_Prec: 0.479207  v_Recall: 0.450334  v_F1: 0.464322  v_AUC: 0.746795
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.379508    reg_loss: 0.063548    l2_loss: 0.013112    loss: 0.456169
steps 2200    v_Prec: 0.524227  v_Recall: 0.489971  v_F1: 0.506521  v_AUC: 0.777568
steps 2200    running time 103 seconds

steps 2400    base_loss: 0.358360    reg_loss: 0.063607    l2_loss: 0.013391    loss: 0.435358
steps 2400    v_Prec: 0.585911  v_Recall: 0.505094  v_F1: 0.542509  v_AUC: 0.802557
steps 2400    running time 110 seconds

steps 2600    base_loss: 0.350148    reg_loss: 0.064081    l2_loss: 0.013743    loss: 0.427972
steps 2600    v_Prec: 0.639980  v_Recall: 0.513451  v_F1: 0.569776  v_AUC: 0.820130
steps 2600    running time 116 seconds

steps 2800    base_loss: 0.340078    reg_loss: 0.064056    l2_loss: 0.014085    loss: 0.418218
steps 2800    v_Prec: 0.642925  v_Recall: 0.538125  v_F1: 0.585875  v_AUC: 0.831594
steps 2800    running time 122 seconds

steps 3000    base_loss: 0.331151    reg_loss: 0.064140    l2_loss: 0.014393    loss: 0.409683
steps 3000    v_Prec: 0.694700  v_Recall: 0.540433  v_F1: 0.607933  v_AUC: 0.842670
steps 3000    running time 129 seconds

steps 3200    base_loss: 0.326194    reg_loss: 0.064324    l2_loss: 0.014743    loss: 0.405262
steps 3200    v_Prec: 0.695299  v_Recall: 0.559217  v_F1: 0.619877  v_AUC: 0.847287
steps 3200    running time 135 seconds

steps 3400    base_loss: 0.317858    reg_loss: 0.064285    l2_loss: 0.015183    loss: 0.397326
steps 3400    v_Prec: 0.684265  v_Recall: 0.580786  v_F1: 0.628293  v_AUC: 0.854576
steps 3400    running time 141 seconds

steps 3600    base_loss: 0.312167    reg_loss: 0.064137    l2_loss: 0.015489    loss: 0.391793
steps 3600    v_Prec: 0.706291  v_Recall: 0.582617  v_F1: 0.638521  v_AUC: 0.858683
steps 3600    running time 148 seconds

steps 3800    base_loss: 0.308509    reg_loss: 0.064116    l2_loss: 0.015835    loss: 0.388460
steps 3800    v_Prec: 0.721631  v_Recall: 0.593203  v_F1: 0.651145  v_AUC: 0.862761
steps 3800    running time 155 seconds

steps 4000    base_loss: 0.297418    reg_loss: 0.064428    l2_loss: 0.016212    loss: 0.378059
steps 4000    v_Prec: 0.740581  v_Recall: 0.588268  v_F1: 0.655696  v_AUC: 0.866116
steps 4000    running time 161 seconds

steps 4200    base_loss: 0.289105    reg_loss: 0.064042    l2_loss: 0.016676    loss: 0.369823
steps 4200    v_Prec: 0.713573  v_Recall: 0.615091  v_F1: 0.660682  v_AUC: 0.871229
steps 4200    running time 167 seconds

steps 4400    base_loss: 0.297388    reg_loss: 0.064381    l2_loss: 0.017069    loss: 0.378838
steps 4400    v_Prec: 0.731661  v_Recall: 0.612862  v_F1: 0.667013  v_AUC: 0.873531
steps 4400    running time 174 seconds

steps 4600    base_loss: 0.288702    reg_loss: 0.064325    l2_loss: 0.017577    loss: 0.370605
steps 4600    v_Prec: 0.752750  v_Recall: 0.609917  v_F1: 0.673848  v_AUC: 0.875393
steps 4600    running time 180 seconds

steps 4800    base_loss: 0.281805    reg_loss: 0.064393    l2_loss: 0.017947    loss: 0.364144
steps 4800    v_Prec: 0.743284  v_Recall: 0.625438  v_F1: 0.679288  v_AUC: 0.879091
steps 4800    running time 187 seconds

steps 5000    base_loss: 0.278579    reg_loss: 0.063937    l2_loss: 0.018509    loss: 0.361025
steps 5000    v_Prec: 0.750334  v_Recall: 0.625756  v_F1: 0.682406  v_AUC: 0.880168
steps 5000    running time 193 seconds

steps 5200    base_loss: 0.274575    reg_loss: 0.063984    l2_loss: 0.018884    loss: 0.357442
steps 5200    v_Prec: 0.748869  v_Recall: 0.632283  v_F1: 0.685655  v_AUC: 0.880368
steps 5200    running time 199 seconds

steps 5400    base_loss: 0.271570    reg_loss: 0.063625    l2_loss: 0.019462    loss: 0.354657
steps 5400    v_Prec: 0.748785  v_Recall: 0.637456  v_F1: 0.688650  v_AUC: 0.884046
steps 5400    running time 206 seconds

steps 5600    base_loss: 0.193358    reg_loss: 0.060672    l2_loss: 0.019726    loss: 0.273756
steps 5600    v_Prec: 0.754205  v_Recall: 0.628144  v_F1: 0.685426  v_AUC: 0.880663
steps 5600    running time 212 seconds

steps 5800    base_loss: 0.190438    reg_loss: 0.060693    l2_loss: 0.020058    loss: 0.271189
steps 5800    v_Prec: 0.780237  v_Recall: 0.608962  v_F1: 0.684041  v_AUC: 0.880145
steps 5800    running time 218 seconds

steps 6000    base_loss: 0.191724    reg_loss: 0.061211    l2_loss: 0.020370    loss: 0.273305
steps 6000    v_Prec: 0.750470  v_Recall: 0.635307  v_F1: 0.688103  v_AUC: 0.882354
steps 6000    running time 224 seconds

steps 6200    base_loss: 0.196264    reg_loss: 0.061234    l2_loss: 0.020680    loss: 0.278178
steps 6200    v_Prec: 0.765939  v_Recall: 0.622493  v_F1: 0.686806  v_AUC: 0.880405
steps 6200    running time 230 seconds

steps 6400    base_loss: 0.193062    reg_loss: 0.061388    l2_loss: 0.020955    loss: 0.275405
steps 6400    v_Prec: 0.757437  v_Recall: 0.630293  v_F1: 0.688040  v_AUC: 0.883239
steps 6400    running time 236 seconds

steps 6600    base_loss: 0.200833    reg_loss: 0.061644    l2_loss: 0.021175    loss: 0.283652
steps 6600    v_Prec: 0.780629  v_Recall: 0.622254  v_F1: 0.692502  v_AUC: 0.885905
steps 6600    running time 242 seconds

steps 6800    base_loss: 0.201717    reg_loss: 0.061636    l2_loss: 0.021350    loss: 0.284703
steps 6800    v_Prec: 0.756086  v_Recall: 0.645177  v_F1: 0.696242  v_AUC: 0.887170
steps 6800    running time 249 seconds

steps 7000    base_loss: 0.196831    reg_loss: 0.061646    l2_loss: 0.021538    loss: 0.280016
steps 7000    v_Prec: 0.772512  v_Recall: 0.637058  v_F1: 0.698277  v_AUC: 0.888374
steps 7000    running time 255 seconds

steps 7200    base_loss: 0.204899    reg_loss: 0.061849    l2_loss: 0.021709    loss: 0.288457
steps 7200    v_Prec: 0.733812  v_Recall: 0.666587  v_F1: 0.698586  v_AUC: 0.888851
steps 7200    running time 262 seconds

steps 7400    base_loss: 0.195741    reg_loss: 0.061464    l2_loss: 0.021924    loss: 0.279128
steps 7400    v_Prec: 0.743824  v_Recall: 0.666269  v_F1: 0.702914  v_AUC: 0.890865
steps 7400    running time 268 seconds

steps 7600    base_loss: 0.189039    reg_loss: 0.061556    l2_loss: 0.022087    loss: 0.272682
steps 7600    v_Prec: 0.756458  v_Recall: 0.652658  v_F1: 0.700735  v_AUC: 0.888346
steps 7600    running time 275 seconds

steps 7800    base_loss: 0.199742    reg_loss: 0.061804    l2_loss: 0.022127    loss: 0.283673
steps 7800    v_Prec: 0.779087  v_Recall: 0.642232  v_F1: 0.704071  v_AUC: 0.891368
steps 7800    running time 281 seconds

steps 8000    base_loss: 0.199614    reg_loss: 0.061653    l2_loss: 0.022210    loss: 0.283477
steps 8000    v_Prec: 0.761677  v_Recall: 0.658071  v_F1: 0.706093  v_AUC: 0.893424
steps 8000    running time 287 seconds

steps 8200    base_loss: 0.195192    reg_loss: 0.061640    l2_loss: 0.022304    loss: 0.279136
steps 8200    v_Prec: 0.780604  v_Recall: 0.652181  v_F1: 0.710637  v_AUC: 0.895670
steps 8200    running time 294 seconds

steps 8400    base_loss: 0.198772    reg_loss: 0.061769    l2_loss: 0.022385    loss: 0.282926
steps 8400    v_Prec: 0.772328  v_Recall: 0.665552  v_F1: 0.714976  v_AUC: 0.895269
steps 8400    running time 300 seconds

steps 8600    base_loss: 0.191258    reg_loss: 0.061577    l2_loss: 0.022459    loss: 0.275294
steps 8600    v_Prec: 0.777218  v_Recall: 0.663085  v_F1: 0.715629  v_AUC: 0.896207
steps 8600    running time 306 seconds

steps 8800    base_loss: 0.195495    reg_loss: 0.061410    l2_loss: 0.022571    loss: 0.279476
steps 8800    v_Prec: 0.769273  v_Recall: 0.674308  v_F1: 0.718666  v_AUC: 0.896183
steps 8800    running time 313 seconds

steps 9000    base_loss: 0.191676    reg_loss: 0.061358    l2_loss: 0.022618    loss: 0.275652
steps 9000    v_Prec: 0.779372  v_Recall: 0.665791  v_F1: 0.718118  v_AUC: 0.898634
steps 9000    running time 319 seconds

steps 9200    base_loss: 0.197737    reg_loss: 0.061603    l2_loss: 0.022735    loss: 0.282076
steps 9200    v_Prec: 0.747329  v_Recall: 0.695877  v_F1: 0.720686  v_AUC: 0.900320
steps 9200    running time 325 seconds

steps 9400    base_loss: 0.196532    reg_loss: 0.061466    l2_loss: 0.022694    loss: 0.280691
steps 9400    v_Prec: 0.802665  v_Recall: 0.661732  v_F1: 0.725417  v_AUC: 0.900130
steps 9400    running time 332 seconds

steps 9600    base_loss: 0.189733    reg_loss: 0.061209    l2_loss: 0.022685    loss: 0.273627
steps 9600    v_Prec: 0.798244  v_Recall: 0.665712  v_F1: 0.725979  v_AUC: 0.900860
steps 9600    running time 338 seconds

steps 9800    base_loss: 0.198294    reg_loss: 0.061594    l2_loss: 0.022813    loss: 0.282701
steps 9800    v_Prec: 0.783612  v_Recall: 0.675899  v_F1: 0.725781  v_AUC: 0.903069
steps 9800    running time 345 seconds

steps 10000    base_loss: 0.192745    reg_loss: 0.061387    l2_loss: 0.022786    loss: 0.276918
steps 10000    v_Prec: 0.767573  v_Recall: 0.691818  v_F1: 0.727729  v_AUC: 0.902702
steps 10000    running time 351 seconds

steps 10200    base_loss: 0.184118    reg_loss: 0.061262    l2_loss: 0.022863    loss: 0.268243
steps 10200    v_Prec: 0.790299  v_Recall: 0.678208  v_F1: 0.729975  v_AUC: 0.904151
steps 10200    running time 357 seconds

steps 10400    base_loss: 0.196559    reg_loss: 0.061534    l2_loss: 0.022926    loss: 0.281018
steps 10400    v_Prec: 0.787718  v_Recall: 0.684018  v_F1: 0.732214  v_AUC: 0.905063
steps 10400    running time 364 seconds

steps 10600    base_loss: 0.195846    reg_loss: 0.061467    l2_loss: 0.022943    loss: 0.280256
steps 10600    v_Prec: 0.794036  v_Recall: 0.682426  v_F1: 0.734012  v_AUC: 0.905868
steps 10600    running time 370 seconds

steps 10800    base_loss: 0.182629    reg_loss: 0.060930    l2_loss: 0.023024    loss: 0.266583
steps 10800    v_Prec: 0.795030  v_Recall: 0.685053  v_F1: 0.735956  v_AUC: 0.907304
steps 10800    running time 377 seconds

steps 11000    base_loss: 0.066338    reg_loss: 0.057011    l2_loss: 0.022875    loss: 0.146224
steps 11000    v_Prec: 0.801455  v_Recall: 0.675024  v_F1: 0.732826  v_AUC: 0.903235
steps 11000    running time 383 seconds

steps 11200    base_loss: 0.066839    reg_loss: 0.056650    l2_loss: 0.022411    loss: 0.145900
steps 11200    v_Prec: 0.790049  v_Recall: 0.673591  v_F1: 0.727187  v_AUC: 0.899231
steps 11200    running time 389 seconds

steps 11400    base_loss: 0.060979    reg_loss: 0.056805    l2_loss: 0.022057    loss: 0.139842
steps 11400    v_Prec: 0.779687  v_Recall: 0.675183  v_F1: 0.723682  v_AUC: 0.897281
steps 11400    running time 395 seconds

steps 11600    base_loss: 0.067595    reg_loss: 0.056553    l2_loss: 0.021737    loss: 0.145885
steps 11600    v_Prec: 0.794397  v_Recall: 0.659026  v_F1: 0.720407  v_AUC: 0.895774
steps 11600    running time 401 seconds

steps 11800    base_loss: 0.066169    reg_loss: 0.056767    l2_loss: 0.021511    loss: 0.144448
steps 11800    v_Prec: 0.761524  v_Recall: 0.682426  v_F1: 0.719809  v_AUC: 0.895783
steps 11800    running time 407 seconds

steps 12000    base_loss: 0.074307    reg_loss: 0.056798    l2_loss: 0.021313    loss: 0.152418
steps 12000    v_Prec: 0.773833  v_Recall: 0.666110  v_F1: 0.715942  v_AUC: 0.894599
steps 12000    running time 413 seconds

steps 12200    base_loss: 0.074109    reg_loss: 0.056745    l2_loss: 0.021113    loss: 0.151968
steps 12200    v_Prec: 0.788775  v_Recall: 0.657752  v_F1: 0.717330  v_AUC: 0.895331
steps 12200    running time 420 seconds

steps 12400    base_loss: 0.071349    reg_loss: 0.056578    l2_loss: 0.020937    loss: 0.148864
steps 12400    v_Prec: 0.768190  v_Recall: 0.668895  v_F1: 0.715112  v_AUC: 0.893443
steps 12400    running time 426 seconds

steps 12600    base_loss: 0.068215    reg_loss: 0.056479    l2_loss: 0.020773    loss: 0.145467
steps 12600    v_Prec: 0.785429  v_Recall: 0.657275  v_F1: 0.715660  v_AUC: 0.892586
steps 12600    running time 431 seconds

steps 12800    base_loss: 0.076395    reg_loss: 0.056439    l2_loss: 0.020709    loss: 0.153544
steps 12800    v_Prec: 0.767538  v_Recall: 0.666189  v_F1: 0.713281  v_AUC: 0.892311
steps 12800    running time 438 seconds

Early stop model F1: 0.735956
testing thre: 0.5810459
testing Prec: 0.641874824586023
testing Recall: 0.6669258809234508
testing F1: 0.6541606082997641
testing AUC: 0.8817638283937487
overall running time 440 seconds
(0.7103240895422653, 0.6199756986634265, 0.6620818519191343, 0.8817638283937487, 0.715658)

2019-02-24 16:47:04.458220: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:47:05.633398: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:47:05.638652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:47:05.638720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.810000 seconds
loading data in 30.880000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.583982    reg_loss: 0.065073    l2_loss: 0.013261    loss: 1.662316
steps 200    v_Prec: 0.164839  v_Recall: 0.999446  v_F1: 0.283002  v_AUC: 0.487549
steps 200    running time 41 seconds

steps 400    base_loss: 0.866507    reg_loss: 0.065147    l2_loss: 0.013017    loss: 0.944671
steps 400    v_Prec: 0.165315  v_Recall: 0.992400  v_F1: 0.283418  v_AUC: 0.500955
steps 400    running time 47 seconds

steps 600    base_loss: 0.489998    reg_loss: 0.065019    l2_loss: 0.012745    loss: 0.567762
steps 600    v_Prec: 0.167518  v_Recall: 0.948068  v_F1: 0.284726  v_AUC: 0.529685
steps 600    running time 54 seconds

steps 800    base_loss: 0.479393    reg_loss: 0.064899    l2_loss: 0.012602    loss: 0.556893
steps 800    v_Prec: 0.179323  v_Recall: 0.744775  v_F1: 0.289050  v_AUC: 0.570107
steps 800    running time 60 seconds

steps 1000    base_loss: 0.467231    reg_loss: 0.064872    l2_loss: 0.012424    loss: 0.544527
steps 1000    v_Prec: 0.236092  v_Recall: 0.440785  v_F1: 0.307488  v_AUC: 0.608475
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.439459    reg_loss: 0.064938    l2_loss: 0.012305    loss: 0.516702
steps 1200    v_Prec: 0.371766  v_Recall: 0.418619  v_F1: 0.393804  v_AUC: 0.696809
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.414940    reg_loss: 0.065154    l2_loss: 0.012292    loss: 0.492386
steps 1400    v_Prec: 0.483653  v_Recall: 0.435640  v_F1: 0.458392  v_AUC: 0.757009
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.390578    reg_loss: 0.065539    l2_loss: 0.012357    loss: 0.468475
steps 1600    v_Prec: 0.534050  v_Recall: 0.483613  v_F1: 0.507582  v_AUC: 0.791720
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.364237    reg_loss: 0.065899    l2_loss: 0.012495    loss: 0.442630
steps 1800    v_Prec: 0.585236  v_Recall: 0.505225  v_F1: 0.542295  v_AUC: 0.818116
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.347741    reg_loss: 0.066166    l2_loss: 0.012666    loss: 0.426573
steps 2000    v_Prec: 0.604490  v_Recall: 0.539265  v_F1: 0.570018  v_AUC: 0.837765
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.322305    reg_loss: 0.066213    l2_loss: 0.012855    loss: 0.401372
steps 2200    v_Prec: 0.616446  v_Recall: 0.576235  v_F1: 0.595663  v_AUC: 0.850995
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.317338    reg_loss: 0.066736    l2_loss: 0.013188    loss: 0.397262
steps 2400    v_Prec: 0.618664  v_Recall: 0.595155  v_F1: 0.606682  v_AUC: 0.858627
steps 2400    running time 111 seconds

steps 2600    base_loss: 0.306686    reg_loss: 0.066855    l2_loss: 0.013495    loss: 0.387036
steps 2600    v_Prec: 0.627922  v_Recall: 0.614550  v_F1: 0.621164  v_AUC: 0.865189
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.304130    reg_loss: 0.066945    l2_loss: 0.013862    loss: 0.384937
steps 2800    v_Prec: 0.646837  v_Recall: 0.612017  v_F1: 0.628946  v_AUC: 0.870703
steps 2800    running time 124 seconds

steps 3000    base_loss: 0.301888    reg_loss: 0.067158    l2_loss: 0.014164    loss: 0.383210
steps 3000    v_Prec: 0.663135  v_Recall: 0.614313  v_F1: 0.637791  v_AUC: 0.875947
steps 3000    running time 131 seconds

steps 3200    base_loss: 0.284997    reg_loss: 0.066961    l2_loss: 0.014521    loss: 0.366479
steps 3200    v_Prec: 0.658037  v_Recall: 0.635845  v_F1: 0.646751  v_AUC: 0.881853
steps 3200    running time 137 seconds

steps 3400    base_loss: 0.290326    reg_loss: 0.067280    l2_loss: 0.014802    loss: 0.372408
steps 3400    v_Prec: 0.675760  v_Recall: 0.619696  v_F1: 0.646515  v_AUC: 0.885837
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.289968    reg_loss: 0.067484    l2_loss: 0.015213    loss: 0.372665
steps 3600    v_Prec: 0.679749  v_Recall: 0.634816  v_F1: 0.656515  v_AUC: 0.889748
steps 3600    running time 150 seconds

steps 3800    base_loss: 0.287278    reg_loss: 0.067368    l2_loss: 0.015658    loss: 0.370303
steps 3800    v_Prec: 0.661088  v_Recall: 0.647324  v_F1: 0.654134  v_AUC: 0.891591
steps 3800    running time 156 seconds

steps 4000    base_loss: 0.288679    reg_loss: 0.067338    l2_loss: 0.016186    loss: 0.372202
steps 4000    v_Prec: 0.667904  v_Recall: 0.655003  v_F1: 0.661391  v_AUC: 0.895547
steps 4000    running time 162 seconds

steps 4200    base_loss: 0.276762    reg_loss: 0.067151    l2_loss: 0.016586    loss: 0.360500
steps 4200    v_Prec: 0.704809  v_Recall: 0.626583  v_F1: 0.663398  v_AUC: 0.897567
steps 4200    running time 168 seconds

steps 4400    base_loss: 0.273732    reg_loss: 0.067398    l2_loss: 0.016993    loss: 0.358123
steps 4400    v_Prec: 0.669417  v_Recall: 0.661574  v_F1: 0.665472  v_AUC: 0.897070
steps 4400    running time 175 seconds

steps 4600    base_loss: 0.277639    reg_loss: 0.066925    l2_loss: 0.017583    loss: 0.362146
steps 4600    v_Prec: 0.668315  v_Recall: 0.663236  v_F1: 0.665766  v_AUC: 0.899333
steps 4600    running time 182 seconds

steps 4800    base_loss: 0.273314    reg_loss: 0.067083    l2_loss: 0.018115    loss: 0.358512
steps 4800    v_Prec: 0.658146  v_Recall: 0.670598  v_F1: 0.664314  v_AUC: 0.900846
steps 4800    running time 188 seconds

steps 5000    base_loss: 0.271447    reg_loss: 0.067071    l2_loss: 0.018675    loss: 0.357192
steps 5000    v_Prec: 0.695700  v_Recall: 0.650649  v_F1: 0.672421  v_AUC: 0.901270
steps 5000    running time 194 seconds

steps 5200    base_loss: 0.262577    reg_loss: 0.066884    l2_loss: 0.019235    loss: 0.348697
steps 5200    v_Prec: 0.701972  v_Recall: 0.645345  v_F1: 0.672469  v_AUC: 0.901778
steps 5200    running time 200 seconds

steps 5400    base_loss: 0.267176    reg_loss: 0.066919    l2_loss: 0.019933    loss: 0.354028
steps 5400    v_Prec: 0.691756  v_Recall: 0.656270  v_F1: 0.673546  v_AUC: 0.902618
steps 5400    running time 207 seconds

steps 5600    base_loss: 0.180519    reg_loss: 0.067295    l2_loss: 0.020789    loss: 0.268603
steps 5600    v_Prec: 0.711956  v_Recall: 0.628879  v_F1: 0.667844  v_AUC: 0.897890
steps 5600    running time 213 seconds

steps 5800    base_loss: 0.186810    reg_loss: 0.067465    l2_loss: 0.021743    loss: 0.276017
steps 5800    v_Prec: 0.668126  v_Recall: 0.664265  v_F1: 0.666190  v_AUC: 0.896978
steps 5800    running time 219 seconds

steps 6000    base_loss: 0.181049    reg_loss: 0.067722    l2_loss: 0.022396    loss: 0.271167
steps 6000    v_Prec: 0.671799  v_Recall: 0.649303  v_F1: 0.660360  v_AUC: 0.894192
steps 6000    running time 225 seconds

steps 6200    base_loss: 0.196748    reg_loss: 0.067435    l2_loss: 0.023002    loss: 0.287185
steps 6200    v_Prec: 0.685743  v_Recall: 0.641229  v_F1: 0.662739  v_AUC: 0.894476
steps 6200    running time 231 seconds

steps 6400    base_loss: 0.190777    reg_loss: 0.067559    l2_loss: 0.023609    loss: 0.281946
steps 6400    v_Prec: 0.688520  v_Recall: 0.647641  v_F1: 0.667455  v_AUC: 0.895741
steps 6400    running time 237 seconds

steps 6600    base_loss: 0.195292    reg_loss: 0.067506    l2_loss: 0.024221    loss: 0.287019
steps 6600    v_Prec: 0.679071  v_Recall: 0.657299  v_F1: 0.668008  v_AUC: 0.897445
steps 6600    running time 243 seconds

steps 6800    base_loss: 0.191122    reg_loss: 0.067245    l2_loss: 0.024604    loss: 0.282972
steps 6800    v_Prec: 0.688638  v_Recall: 0.652549  v_F1: 0.670108  v_AUC: 0.899117
steps 6800    running time 249 seconds

steps 7000    base_loss: 0.194905    reg_loss: 0.067168    l2_loss: 0.025082    loss: 0.287155
steps 7000    v_Prec: 0.674634  v_Recall: 0.674794  v_F1: 0.674714  v_AUC: 0.900164
steps 7000    running time 255 seconds

steps 7200    base_loss: 0.197649    reg_loss: 0.067621    l2_loss: 0.025492    loss: 0.290763
steps 7200    v_Prec: 0.683968  v_Recall: 0.668699  v_F1: 0.676247  v_AUC: 0.901981
steps 7200    running time 262 seconds

steps 7400    base_loss: 0.192612    reg_loss: 0.067518    l2_loss: 0.026010    loss: 0.286140
steps 7400    v_Prec: 0.709786  v_Recall: 0.651124  v_F1: 0.679191  v_AUC: 0.901658
steps 7400    running time 268 seconds

steps 7600    base_loss: 0.190587    reg_loss: 0.067299    l2_loss: 0.026300    loss: 0.284186
steps 7600    v_Prec: 0.705394  v_Recall: 0.659436  v_F1: 0.681642  v_AUC: 0.904141
steps 7600    running time 274 seconds

steps 7800    base_loss: 0.193919    reg_loss: 0.067298    l2_loss: 0.026628    loss: 0.287844
steps 7800    v_Prec: 0.704453  v_Recall: 0.658724  v_F1: 0.680821  v_AUC: 0.903834
steps 7800    running time 281 seconds

steps 8000    base_loss: 0.190401    reg_loss: 0.066967    l2_loss: 0.026898    loss: 0.284266
steps 8000    v_Prec: 0.728183  v_Recall: 0.644712  v_F1: 0.683910  v_AUC: 0.905592
steps 8000    running time 287 seconds

steps 8200    base_loss: 0.190337    reg_loss: 0.067327    l2_loss: 0.027426    loss: 0.285090
steps 8200    v_Prec: 0.689967  v_Recall: 0.682156  v_F1: 0.686040  v_AUC: 0.906594
steps 8200    running time 294 seconds

steps 8400    base_loss: 0.191675    reg_loss: 0.066978    l2_loss: 0.027622    loss: 0.286275
steps 8400    v_Prec: 0.718766  v_Recall: 0.660386  v_F1: 0.688341  v_AUC: 0.908659
steps 8400    running time 300 seconds

steps 8600    base_loss: 0.191257    reg_loss: 0.067208    l2_loss: 0.027953    loss: 0.286418
steps 8600    v_Prec: 0.714213  v_Recall: 0.666719  v_F1: 0.689650  v_AUC: 0.910005
steps 8600    running time 307 seconds

steps 8800    base_loss: 0.194114    reg_loss: 0.067253    l2_loss: 0.028157    loss: 0.289525
steps 8800    v_Prec: 0.744909  v_Recall: 0.648670  v_F1: 0.693466  v_AUC: 0.908720
steps 8800    running time 313 seconds

steps 9000    base_loss: 0.198549    reg_loss: 0.066923    l2_loss: 0.028442    loss: 0.293915
steps 9000    v_Prec: 0.741464  v_Recall: 0.658407  v_F1: 0.697472  v_AUC: 0.911264
steps 9000    running time 320 seconds

steps 9200    base_loss: 0.195905    reg_loss: 0.067018    l2_loss: 0.028703    loss: 0.291627
steps 9200    v_Prec: 0.726033  v_Recall: 0.678673  v_F1: 0.701555  v_AUC: 0.913938
steps 9200    running time 326 seconds

steps 9400    base_loss: 0.199397    reg_loss: 0.066684    l2_loss: 0.028998    loss: 0.295079
steps 9400    v_Prec: 0.746303  v_Recall: 0.667194  v_F1: 0.704535  v_AUC: 0.915298
steps 9400    running time 332 seconds

steps 9600    base_loss: 0.195440    reg_loss: 0.066979    l2_loss: 0.029325    loss: 0.291744
steps 9600    v_Prec: 0.719868  v_Recall: 0.691260  v_F1: 0.705274  v_AUC: 0.915305
steps 9600    running time 339 seconds

steps 9800    base_loss: 0.191672    reg_loss: 0.066977    l2_loss: 0.029403    loss: 0.288051
steps 9800    v_Prec: 0.745477  v_Recall: 0.678436  v_F1: 0.710378  v_AUC: 0.915677
steps 9800    running time 345 seconds

steps 10000    base_loss: 0.195053    reg_loss: 0.066926    l2_loss: 0.029656    loss: 0.291635
steps 10000    v_Prec: 0.733400  v_Recall: 0.692527  v_F1: 0.712378  v_AUC: 0.916724
steps 10000    running time 351 seconds

steps 10200    base_loss: 0.190928    reg_loss: 0.066647    l2_loss: 0.029780    loss: 0.287355
steps 10200    v_Prec: 0.762531  v_Recall: 0.674398  v_F1: 0.715762  v_AUC: 0.919864
steps 10200    running time 358 seconds

steps 10400    base_loss: 0.185420    reg_loss: 0.066488    l2_loss: 0.030010    loss: 0.281917
steps 10400    v_Prec: 0.716649  v_Recall: 0.713189  v_F1: 0.714915  v_AUC: 0.919791
steps 10400    running time 364 seconds

steps 10600    base_loss: 0.181632    reg_loss: 0.066633    l2_loss: 0.030273    loss: 0.278538
steps 10600    v_Prec: 0.744910  v_Recall: 0.695139  v_F1: 0.719165  v_AUC: 0.921064
steps 10600    running time 370 seconds

steps 10800    base_loss: 0.172635    reg_loss: 0.066270    l2_loss: 0.030425    loss: 0.269330
steps 10800    v_Prec: 0.752037  v_Recall: 0.686906  v_F1: 0.717998  v_AUC: 0.920494
steps 10800    running time 377 seconds

steps 11000    base_loss: 0.083338    reg_loss: 0.065881    l2_loss: 0.030612    loss: 0.179832
steps 11000    v_Prec: 0.712602  v_Recall: 0.693873  v_F1: 0.703112  v_AUC: 0.913194
steps 11000    running time 383 seconds

steps 11200    base_loss: 0.086054    reg_loss: 0.065635    l2_loss: 0.030756    loss: 0.182445
steps 11200    v_Prec: 0.728894  v_Recall: 0.666403  v_F1: 0.696249  v_AUC: 0.908322
steps 11200    running time 389 seconds

steps 11400    base_loss: 0.081022    reg_loss: 0.065581    l2_loss: 0.030807    loss: 0.177411
steps 11400    v_Prec: 0.708211  v_Recall: 0.668461  v_F1: 0.687762  v_AUC: 0.905291
steps 11400    running time 395 seconds

steps 11600    base_loss: 0.084763    reg_loss: 0.065343    l2_loss: 0.030995    loss: 0.181102
steps 11600    v_Prec: 0.692007  v_Recall: 0.687460  v_F1: 0.689726  v_AUC: 0.904830
steps 11600    running time 401 seconds

steps 11800    base_loss: 0.090869    reg_loss: 0.065623    l2_loss: 0.031202    loss: 0.187694
steps 11800    v_Prec: 0.693215  v_Recall: 0.684215  v_F1: 0.688685  v_AUC: 0.904340
steps 11800    running time 407 seconds

steps 12000    base_loss: 0.090972    reg_loss: 0.065624    l2_loss: 0.031344    loss: 0.187940
steps 12000    v_Prec: 0.686251  v_Recall: 0.682394  v_F1: 0.684317  v_AUC: 0.901444
steps 12000    running time 413 seconds

steps 12200    base_loss: 0.091794    reg_loss: 0.065354    l2_loss: 0.031416    loss: 0.188564
steps 12200    v_Prec: 0.683973  v_Recall: 0.684136  v_F1: 0.684054  v_AUC: 0.902067
steps 12200    running time 418 seconds

steps 12400    base_loss: 0.090107    reg_loss: 0.065344    l2_loss: 0.031528    loss: 0.186979
steps 12400    v_Prec: 0.682052  v_Recall: 0.683186  v_F1: 0.682618  v_AUC: 0.901421
steps 12400    running time 424 seconds

steps 12600    base_loss: 0.084951    reg_loss: 0.065174    l2_loss: 0.031636    loss: 0.181760
steps 12600    v_Prec: 0.696868  v_Recall: 0.660624  v_F1: 0.678262  v_AUC: 0.899584
steps 12600    running time 430 seconds

Early stop model F1: 0.719165
testing thre: 0.41668722
testing Prec: 0.5390195185198163
testing Recall: 0.7476063183475091
testing F1: 0.626404951946571
testing AUC: 0.894956950971352
overall running time 433 seconds
(0.6997229916897507, 0.6138517618469016, 0.6539805825242719, 0.894956950971352, 0.73495746)

2019-02-24 16:51:38.738689: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:51:39.517754: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:51:39.585135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:51:39.585197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.710000 seconds
loading data in 30.710000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.500667    reg_loss: 0.064643    l2_loss: 0.013356    loss: 0.578667
steps 200    v_Prec: 0.163126  v_Recall: 1.000000  v_F1: 0.280496  v_AUC: 0.505012
steps 200    running time 40 seconds

steps 400    base_loss: 0.494159    reg_loss: 0.064738    l2_loss: 0.013265    loss: 0.572162
steps 400    v_Prec: 0.165772  v_Recall: 0.928411  v_F1: 0.281314  v_AUC: 0.535857
steps 400    running time 47 seconds

steps 600    base_loss: 0.458939    reg_loss: 0.064463    l2_loss: 0.013125    loss: 0.536527
steps 600    v_Prec: 0.194629  v_Recall: 0.645257  v_F1: 0.299055  v_AUC: 0.592998
steps 600    running time 54 seconds

steps 800    base_loss: 0.439267    reg_loss: 0.064343    l2_loss: 0.012986    loss: 0.516596
steps 800    v_Prec: 0.248594  v_Recall: 0.523276  v_F1: 0.337060  v_AUC: 0.654288
steps 800    running time 60 seconds

steps 1000    base_loss: 0.420974    reg_loss: 0.064081    l2_loss: 0.012944    loss: 0.497999
steps 1000    v_Prec: 0.334417  v_Recall: 0.452728  v_F1: 0.384681  v_AUC: 0.705720
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.403440    reg_loss: 0.064203    l2_loss: 0.012950    loss: 0.480593
steps 1200    v_Prec: 0.409394  v_Recall: 0.466405  v_F1: 0.436044  v_AUC: 0.749340
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.392826    reg_loss: 0.064632    l2_loss: 0.012969    loss: 0.470427
steps 1400    v_Prec: 0.444240  v_Recall: 0.521597  v_F1: 0.479820  v_AUC: 0.784623
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.362102    reg_loss: 0.064849    l2_loss: 0.013074    loss: 0.440025
steps 1600    v_Prec: 0.521488  v_Recall: 0.527036  v_F1: 0.524247  v_AUC: 0.812678
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.347831    reg_loss: 0.065473    l2_loss: 0.013274    loss: 0.426578
steps 1800    v_Prec: 0.565102  v_Recall: 0.546073  v_F1: 0.555424  v_AUC: 0.831108
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.336941    reg_loss: 0.065842    l2_loss: 0.013437    loss: 0.416220
steps 2000    v_Prec: 0.571623  v_Recall: 0.570709  v_F1: 0.571166  v_AUC: 0.842219
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.320366    reg_loss: 0.066136    l2_loss: 0.013635    loss: 0.400137
steps 2200    v_Prec: 0.610693  v_Recall: 0.571029  v_F1: 0.590195  v_AUC: 0.850085
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.304663    reg_loss: 0.066513    l2_loss: 0.013865    loss: 0.385040
steps 2400    v_Prec: 0.618056  v_Recall: 0.586466  v_F1: 0.601847  v_AUC: 0.857525
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.308385    reg_loss: 0.066617    l2_loss: 0.014081    loss: 0.389083
steps 2600    v_Prec: 0.602482  v_Recall: 0.621421  v_F1: 0.611805  v_AUC: 0.864287
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.300713    reg_loss: 0.066939    l2_loss: 0.014322    loss: 0.381974
steps 2800    v_Prec: 0.659537  v_Recall: 0.591905  v_F1: 0.623893  v_AUC: 0.870189
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.301056    reg_loss: 0.067265    l2_loss: 0.014645    loss: 0.382966
steps 3000    v_Prec: 0.648834  v_Recall: 0.612142  v_F1: 0.629954  v_AUC: 0.873524
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.298449    reg_loss: 0.067399    l2_loss: 0.014881    loss: 0.380729
steps 3200    v_Prec: 0.685273  v_Recall: 0.602944  v_F1: 0.641477  v_AUC: 0.879399
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.292189    reg_loss: 0.067609    l2_loss: 0.015227    loss: 0.375024
steps 3400    v_Prec: 0.665987  v_Recall: 0.626780  v_F1: 0.645789  v_AUC: 0.881336
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.288268    reg_loss: 0.067537    l2_loss: 0.015615    loss: 0.371420
steps 3600    v_Prec: 0.678807  v_Recall: 0.626140  v_F1: 0.651411  v_AUC: 0.885505
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.280940    reg_loss: 0.067566    l2_loss: 0.015928    loss: 0.364434
steps 3800    v_Prec: 0.688758  v_Recall: 0.624300  v_F1: 0.654947  v_AUC: 0.887354
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.275835    reg_loss: 0.067528    l2_loss: 0.016491    loss: 0.359854
steps 4000    v_Prec: 0.673771  v_Recall: 0.644777  v_F1: 0.658955  v_AUC: 0.890072
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.276668    reg_loss: 0.067406    l2_loss: 0.016967    loss: 0.361042
steps 4200    v_Prec: 0.682293  v_Recall: 0.636778  v_F1: 0.658751  v_AUC: 0.891478
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.274607    reg_loss: 0.067730    l2_loss: 0.017451    loss: 0.359788
steps 4400    v_Prec: 0.676113  v_Recall: 0.645017  v_F1: 0.660199  v_AUC: 0.892143
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.281160    reg_loss: 0.067843    l2_loss: 0.018074    loss: 0.367076
steps 4600    v_Prec: 0.705861  v_Recall: 0.624220  v_F1: 0.662535  v_AUC: 0.893124
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.275102    reg_loss: 0.067648    l2_loss: 0.018591    loss: 0.361341
steps 4800    v_Prec: 0.696247  v_Recall: 0.639498  v_F1: 0.666667  v_AUC: 0.897660
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.265212    reg_loss: 0.067575    l2_loss: 0.019168    loss: 0.351956
steps 5000    v_Prec: 0.677991  v_Recall: 0.657655  v_F1: 0.667668  v_AUC: 0.897579
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.268447    reg_loss: 0.067470    l2_loss: 0.019813    loss: 0.355729
steps 5200    v_Prec: 0.714273  v_Recall: 0.630059  v_F1: 0.669528  v_AUC: 0.899257
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.267183    reg_loss: 0.067676    l2_loss: 0.020327    loss: 0.355186
steps 5400    v_Prec: 0.675994  v_Recall: 0.660854  v_F1: 0.668338  v_AUC: 0.900048
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.171329    reg_loss: 0.068060    l2_loss: 0.021148    loss: 0.260536
steps 5600    v_Prec: 0.689706  v_Recall: 0.639338  v_F1: 0.663567  v_AUC: 0.894816
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.184933    reg_loss: 0.068284    l2_loss: 0.022008    loss: 0.275225
steps 5800    v_Prec: 0.669862  v_Recall: 0.654055  v_F1: 0.661864  v_AUC: 0.894094
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.179051    reg_loss: 0.068106    l2_loss: 0.022763    loss: 0.269920
steps 6000    v_Prec: 0.687973  v_Recall: 0.639658  v_F1: 0.662936  v_AUC: 0.892231
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.179720    reg_loss: 0.068098    l2_loss: 0.023411    loss: 0.271229
steps 6200    v_Prec: 0.673430  v_Recall: 0.645097  v_F1: 0.658959  v_AUC: 0.891954
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.183233    reg_loss: 0.068257    l2_loss: 0.024083    loss: 0.275572
steps 6400    v_Prec: 0.711378  v_Recall: 0.620621  v_F1: 0.662907  v_AUC: 0.892613
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.187041    reg_loss: 0.068027    l2_loss: 0.024639    loss: 0.279708
steps 6600    v_Prec: 0.704836  v_Recall: 0.627260  v_F1: 0.663789  v_AUC: 0.893272
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.189933    reg_loss: 0.068116    l2_loss: 0.025091    loss: 0.283140
steps 6800    v_Prec: 0.718718  v_Recall: 0.615182  v_F1: 0.662932  v_AUC: 0.894435
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.180851    reg_loss: 0.068025    l2_loss: 0.025623    loss: 0.274499
steps 7000    v_Prec: 0.734541  v_Recall: 0.609982  v_F1: 0.666492  v_AUC: 0.896446
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.191618    reg_loss: 0.068237    l2_loss: 0.026059    loss: 0.285914
steps 7200    v_Prec: 0.693314  v_Recall: 0.644457  v_F1: 0.667993  v_AUC: 0.894766
steps 7200    running time 269 seconds

Early stop model F1: 0.669528
testing thre: 0.32339662
testing Prec: 0.5497270451093872
testing Recall: 0.6509356014580802
testing F1: 0.5960656905069206
testing AUC: 0.8690407376243582
overall running time 272 seconds
(0.6503778059676797, 0.5731227217496963, 0.6093112178990336, 0.8690407376243582, 0.45138416)

2019-02-24 16:54:42.918488: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:54:43.276607: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:54:43.277929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:54:43.277969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.480000 seconds
loading data in 30.930000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.546820    reg_loss: 0.064866    l2_loss: 0.013384    loss: 0.625069
steps 200    v_Prec: 0.164533  v_Recall: 1.000000  v_F1: 0.282574  v_AUC: 0.500344
steps 200    running time 41 seconds

steps 400    base_loss: 0.497444    reg_loss: 0.064571    l2_loss: 0.013375    loss: 0.575391
steps 400    v_Prec: 0.164752  v_Recall: 0.994211  v_F1: 0.282664  v_AUC: 0.516300
steps 400    running time 48 seconds

steps 600    base_loss: 0.489247    reg_loss: 0.064439    l2_loss: 0.013214    loss: 0.566899
steps 600    v_Prec: 0.170771  v_Recall: 0.876527  v_F1: 0.285851  v_AUC: 0.543359
steps 600    running time 54 seconds

steps 800    base_loss: 0.469577    reg_loss: 0.064074    l2_loss: 0.013075    loss: 0.546726
steps 800    v_Prec: 0.200221  v_Recall: 0.660745  v_F1: 0.307318  v_AUC: 0.606676
steps 800    running time 61 seconds

steps 1000    base_loss: 0.451016    reg_loss: 0.063902    l2_loss: 0.012887    loss: 0.527806
steps 1000    v_Prec: 0.296446  v_Recall: 0.492863  v_F1: 0.370216  v_AUC: 0.687604
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.422950    reg_loss: 0.063623    l2_loss: 0.012841    loss: 0.499414
steps 1200    v_Prec: 0.412388  v_Recall: 0.459873  v_F1: 0.434838  v_AUC: 0.742755
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.389408    reg_loss: 0.063729    l2_loss: 0.012800    loss: 0.465937
steps 1400    v_Prec: 0.469730  v_Recall: 0.495321  v_F1: 0.482186  v_AUC: 0.777502
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.373658    reg_loss: 0.064190    l2_loss: 0.012920    loss: 0.450768
steps 1600    v_Prec: 0.526918  v_Recall: 0.525456  v_F1: 0.526186  v_AUC: 0.808216
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.351172    reg_loss: 0.064569    l2_loss: 0.013064    loss: 0.428806
steps 1800    v_Prec: 0.554624  v_Recall: 0.550753  v_F1: 0.552682  v_AUC: 0.828262
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.334968    reg_loss: 0.065052    l2_loss: 0.013261    loss: 0.413281
steps 2000    v_Prec: 0.605259  v_Recall: 0.547661  v_F1: 0.575021  v_AUC: 0.841549
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.326800    reg_loss: 0.065569    l2_loss: 0.013429    loss: 0.405799
steps 2200    v_Prec: 0.614011  v_Recall: 0.578271  v_F1: 0.595606  v_AUC: 0.852439
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.317796    reg_loss: 0.066070    l2_loss: 0.013639    loss: 0.397505
steps 2400    v_Prec: 0.600819  v_Recall: 0.616971  v_F1: 0.608788  v_AUC: 0.860151
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.311006    reg_loss: 0.066135    l2_loss: 0.013920    loss: 0.391061
steps 2600    v_Prec: 0.647864  v_Recall: 0.592942  v_F1: 0.619188  v_AUC: 0.866721
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.303299    reg_loss: 0.066488    l2_loss: 0.014181    loss: 0.383968
steps 2800    v_Prec: 0.659853  v_Recall: 0.599048  v_F1: 0.627982  v_AUC: 0.871497
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.300227    reg_loss: 0.066560    l2_loss: 0.014487    loss: 0.381273
steps 3000    v_Prec: 0.668707  v_Recall: 0.606344  v_F1: 0.636001  v_AUC: 0.875683
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.298734    reg_loss: 0.066969    l2_loss: 0.014821    loss: 0.380524
steps 3200    v_Prec: 0.647097  v_Recall: 0.626725  v_F1: 0.636748  v_AUC: 0.878624
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.286296    reg_loss: 0.066983    l2_loss: 0.015138    loss: 0.368417
steps 3400    v_Prec: 0.655997  v_Recall: 0.624108  v_F1: 0.639655  v_AUC: 0.881458
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.285002    reg_loss: 0.067110    l2_loss: 0.015505    loss: 0.367617
steps 3600    v_Prec: 0.663010  v_Recall: 0.632672  v_F1: 0.647486  v_AUC: 0.883571
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.289217    reg_loss: 0.067043    l2_loss: 0.015923    loss: 0.372183
steps 3800    v_Prec: 0.686273  v_Recall: 0.615305  v_F1: 0.648854  v_AUC: 0.886254
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.281784    reg_loss: 0.067072    l2_loss: 0.016369    loss: 0.365225
steps 4000    v_Prec: 0.670089  v_Recall: 0.641872  v_F1: 0.655677  v_AUC: 0.888192
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.277618    reg_loss: 0.067098    l2_loss: 0.016876    loss: 0.361592
steps 4200    v_Prec: 0.675381  v_Recall: 0.639175  v_F1: 0.656780  v_AUC: 0.890585
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.280812    reg_loss: 0.067251    l2_loss: 0.017326    loss: 0.365390
steps 4400    v_Prec: 0.637958  v_Recall: 0.674941  v_F1: 0.655928  v_AUC: 0.891749
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.275618    reg_loss: 0.067250    l2_loss: 0.017748    loss: 0.360617
steps 4600    v_Prec: 0.644113  v_Recall: 0.665107  v_F1: 0.654442  v_AUC: 0.892442
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.276402    reg_loss: 0.067477    l2_loss: 0.018367    loss: 0.362246
steps 4800    v_Prec: 0.660637  v_Recall: 0.657494  v_F1: 0.659062  v_AUC: 0.892639
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.283053    reg_loss: 0.067548    l2_loss: 0.018947    loss: 0.369548
steps 5000    v_Prec: 0.687382  v_Recall: 0.635924  v_F1: 0.660652  v_AUC: 0.894465
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.279834    reg_loss: 0.067577    l2_loss: 0.019512    loss: 0.366923
steps 5200    v_Prec: 0.700017  v_Recall: 0.634734  v_F1: 0.665779  v_AUC: 0.897406
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.265246    reg_loss: 0.067286    l2_loss: 0.020263    loss: 0.352796
steps 5400    v_Prec: 0.682730  v_Recall: 0.658366  v_F1: 0.670327  v_AUC: 0.900146
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.175016    reg_loss: 0.068490    l2_loss: 0.021067    loss: 0.264573
steps 5600    v_Prec: 0.675888  v_Recall: 0.649088  v_F1: 0.662217  v_AUC: 0.893470
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.173123    reg_loss: 0.068567    l2_loss: 0.021944    loss: 0.263634
steps 5800    v_Prec: 0.671397  v_Recall: 0.634021  v_F1: 0.652174  v_AUC: 0.888152
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.179388    reg_loss: 0.068284    l2_loss: 0.022739    loss: 0.270412
steps 6000    v_Prec: 0.676704  v_Recall: 0.643378  v_F1: 0.659620  v_AUC: 0.890744
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.181961    reg_loss: 0.068573    l2_loss: 0.023352    loss: 0.273886
steps 6200    v_Prec: 0.706569  v_Recall: 0.614116  v_F1: 0.657106  v_AUC: 0.890565
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.181896    reg_loss: 0.068404    l2_loss: 0.024025    loss: 0.274326
steps 6400    v_Prec: 0.663469  v_Recall: 0.647105  v_F1: 0.655185  v_AUC: 0.890035
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.197099    reg_loss: 0.068373    l2_loss: 0.024480    loss: 0.289952
steps 6600    v_Prec: 0.675246  v_Recall: 0.642902  v_F1: 0.658677  v_AUC: 0.891532
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.185191    reg_loss: 0.068427    l2_loss: 0.024940    loss: 0.278558
steps 6800    v_Prec: 0.674207  v_Recall: 0.647581  v_F1: 0.660626  v_AUC: 0.891978
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.194374    reg_loss: 0.068358    l2_loss: 0.025523    loss: 0.288255
steps 7000    v_Prec: 0.696886  v_Recall: 0.642506  v_F1: 0.668592  v_AUC: 0.896627
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.194086    reg_loss: 0.068325    l2_loss: 0.026032    loss: 0.288443
steps 7200    v_Prec: 0.676820  v_Recall: 0.659001  v_F1: 0.667792  v_AUC: 0.896625
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.185994    reg_loss: 0.068318    l2_loss: 0.026382    loss: 0.280694
steps 7400    v_Prec: 0.679047  v_Recall: 0.666931  v_F1: 0.672935  v_AUC: 0.898782
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.195984    reg_loss: 0.068002    l2_loss: 0.026726    loss: 0.290712
steps 7600    v_Prec: 0.696753  v_Recall: 0.648295  v_F1: 0.671651  v_AUC: 0.897409
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.192309    reg_loss: 0.067863    l2_loss: 0.027015    loss: 0.287187
steps 7800    v_Prec: 0.671469  v_Recall: 0.676368  v_F1: 0.673910  v_AUC: 0.899164
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.204845    reg_loss: 0.068070    l2_loss: 0.027284    loss: 0.300199
steps 8000    v_Prec: 0.698646  v_Recall: 0.658921  v_F1: 0.678203  v_AUC: 0.900657
steps 8000    running time 296 seconds

steps 8200    base_loss: 0.190548    reg_loss: 0.067848    l2_loss: 0.027535    loss: 0.285932
steps 8200    v_Prec: 0.698441  v_Recall: 0.660666  v_F1: 0.679028  v_AUC: 0.902678
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.194746    reg_loss: 0.068049    l2_loss: 0.027816    loss: 0.290611
steps 8400    v_Prec: 0.691347  v_Recall: 0.684933  v_F1: 0.688125  v_AUC: 0.905264
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.182848    reg_loss: 0.068071    l2_loss: 0.028119    loss: 0.279038
steps 8600    v_Prec: 0.701395  v_Recall: 0.673751  v_F1: 0.687295  v_AUC: 0.904410
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.200050    reg_loss: 0.067882    l2_loss: 0.028485    loss: 0.296417
steps 8800    v_Prec: 0.716968  v_Recall: 0.663125  v_F1: 0.688996  v_AUC: 0.906637
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.186089    reg_loss: 0.068044    l2_loss: 0.028785    loss: 0.282918
steps 9000    v_Prec: 0.721763  v_Recall: 0.671451  v_F1: 0.695699  v_AUC: 0.908866
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.187912    reg_loss: 0.067623    l2_loss: 0.029069    loss: 0.284604
steps 9200    v_Prec: 0.734863  v_Recall: 0.660270  v_F1: 0.695572  v_AUC: 0.908107
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.194159    reg_loss: 0.067978    l2_loss: 0.029116    loss: 0.291253
steps 9400    v_Prec: 0.741119  v_Recall: 0.668358  v_F1: 0.702860  v_AUC: 0.911012
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.193991    reg_loss: 0.067690    l2_loss: 0.029451    loss: 0.291132
steps 9600    v_Prec: 0.720581  v_Recall: 0.692466  v_F1: 0.706244  v_AUC: 0.912889
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.189169    reg_loss: 0.067795    l2_loss: 0.029557    loss: 0.286521
steps 9800    v_Prec: 0.732682  v_Recall: 0.677716  v_F1: 0.704128  v_AUC: 0.913003
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.196838    reg_loss: 0.067725    l2_loss: 0.029669    loss: 0.294232
steps 10000    v_Prec: 0.729839  v_Recall: 0.686836  v_F1: 0.707685  v_AUC: 0.914415
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.195108    reg_loss: 0.067728    l2_loss: 0.029938    loss: 0.292775
steps 10200    v_Prec: 0.736895  v_Recall: 0.692308  v_F1: 0.713906  v_AUC: 0.918734
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.195936    reg_loss: 0.067582    l2_loss: 0.030139    loss: 0.293657
steps 10400    v_Prec: 0.736669  v_Recall: 0.693497  v_F1: 0.714432  v_AUC: 0.918821
steps 10400    running time 375 seconds

steps 10600    base_loss: 0.191875    reg_loss: 0.067424    l2_loss: 0.030188    loss: 0.289486
steps 10600    v_Prec: 0.753633  v_Recall: 0.686757  v_F1: 0.718642  v_AUC: 0.919413
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.172617    reg_loss: 0.067307    l2_loss: 0.030453    loss: 0.270377
steps 10800    v_Prec: 0.731584  v_Recall: 0.711975  v_F1: 0.721646  v_AUC: 0.919494
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.074296    reg_loss: 0.067016    l2_loss: 0.030574    loss: 0.171886
steps 11000    v_Prec: 0.710446  v_Recall: 0.685488  v_F1: 0.697744  v_AUC: 0.907713
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.080308    reg_loss: 0.066987    l2_loss: 0.030740    loss: 0.178036
steps 11200    v_Prec: 0.721835  v_Recall: 0.673751  v_F1: 0.696965  v_AUC: 0.907103
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.081527    reg_loss: 0.066924    l2_loss: 0.030834    loss: 0.179284
steps 11400    v_Prec: 0.693552  v_Recall: 0.679857  v_F1: 0.686636  v_AUC: 0.902713
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.084628    reg_loss: 0.066765    l2_loss: 0.031087    loss: 0.182480
steps 11600    v_Prec: 0.720614  v_Recall: 0.647581  v_F1: 0.682149  v_AUC: 0.901599
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.080734    reg_loss: 0.066946    l2_loss: 0.031202    loss: 0.178882
steps 11800    v_Prec: 0.719795  v_Recall: 0.645361  v_F1: 0.680549  v_AUC: 0.900889
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.084210    reg_loss: 0.066923    l2_loss: 0.031231    loss: 0.182363
steps 12000    v_Prec: 0.669447  v_Recall: 0.674703  v_F1: 0.672064  v_AUC: 0.897000
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.082206    reg_loss: 0.066781    l2_loss: 0.031306    loss: 0.180294
steps 12200    v_Prec: 0.673728  v_Recall: 0.665821  v_F1: 0.669751  v_AUC: 0.895708
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.090016    reg_loss: 0.066669    l2_loss: 0.031587    loss: 0.188272
steps 12400    v_Prec: 0.662192  v_Recall: 0.684615  v_F1: 0.673217  v_AUC: 0.898443
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.090818    reg_loss: 0.066639    l2_loss: 0.031711    loss: 0.189167
steps 12600    v_Prec: 0.685258  v_Recall: 0.660587  v_F1: 0.672696  v_AUC: 0.896491
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.082025    reg_loss: 0.066552    l2_loss: 0.031832    loss: 0.180409
steps 12800    v_Prec: 0.697217  v_Recall: 0.651546  v_F1: 0.673608  v_AUC: 0.896463
steps 12800    running time 452 seconds

Early stop model F1: 0.721646
testing thre: 0.3227183
testing Prec: 0.5170242921652
testing Recall: 0.7623815309842041
testing F1: 0.616176297285619
testing AUC: 0.8964827842011113
overall running time 455 seconds
(0.7093400034108351, 0.606464155528554, 0.65388041712519, 0.8964827842011113, 0.72219336)

2019-02-24 16:59:36.931986: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 16:59:38.273860: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 16:59:38.286142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 16:59:38.286200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.570000 seconds
loading data in 29.660000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.688449    reg_loss: 0.065010    l2_loss: 0.013313    loss: 0.766773
steps 200    v_Prec: 0.165744  v_Recall: 1.000000  v_F1: 0.284358  v_AUC: 0.485887
steps 200    running time 40 seconds

steps 400    base_loss: 0.552824    reg_loss: 0.064799    l2_loss: 0.013233    loss: 0.630856
steps 400    v_Prec: 0.165719  v_Recall: 1.000000  v_F1: 0.284320  v_AUC: 0.500397
steps 400    running time 47 seconds

steps 600    base_loss: 0.515896    reg_loss: 0.064735    l2_loss: 0.013094    loss: 0.593724
steps 600    v_Prec: 0.166703  v_Recall: 0.970002  v_F1: 0.284510  v_AUC: 0.523722
steps 600    running time 53 seconds

steps 800    base_loss: 0.487643    reg_loss: 0.064440    l2_loss: 0.012818    loss: 0.564901
steps 800    v_Prec: 0.169000  v_Recall: 0.943626  v_F1: 0.286661  v_AUC: 0.531702
steps 800    running time 60 seconds

steps 1000    base_loss: 0.461468    reg_loss: 0.063865    l2_loss: 0.012598    loss: 0.537931
steps 1000    v_Prec: 0.179991  v_Recall: 0.828360  v_F1: 0.295725  v_AUC: 0.570145
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.451685    reg_loss: 0.063360    l2_loss: 0.012521    loss: 0.527567
steps 1200    v_Prec: 0.260983  v_Recall: 0.522006  v_F1: 0.347986  v_AUC: 0.660554
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.435627    reg_loss: 0.062966    l2_loss: 0.012487    loss: 0.511081
steps 1400    v_Prec: 0.389823  v_Recall: 0.425242  v_F1: 0.406763  v_AUC: 0.714728
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.405255    reg_loss: 0.062423    l2_loss: 0.012555    loss: 0.480234
steps 1600    v_Prec: 0.460477  v_Recall: 0.443981  v_F1: 0.452078  v_AUC: 0.747599
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.385344    reg_loss: 0.062153    l2_loss: 0.012633    loss: 0.460129
steps 1800    v_Prec: 0.481156  v_Recall: 0.495552  v_F1: 0.488248  v_AUC: 0.775270
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.367708    reg_loss: 0.061826    l2_loss: 0.012818    loss: 0.442352
steps 2000    v_Prec: 0.535816  v_Recall: 0.490591  v_F1: 0.512207  v_AUC: 0.792834
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.359669    reg_loss: 0.061503    l2_loss: 0.012987    loss: 0.434159
steps 2200    v_Prec: 0.523046  v_Recall: 0.554838  v_F1: 0.538473  v_AUC: 0.811313
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.349963    reg_loss: 0.061195    l2_loss: 0.013152    loss: 0.424309
steps 2400    v_Prec: 0.521795  v_Recall: 0.574915  v_F1: 0.547069  v_AUC: 0.823146
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.349279    reg_loss: 0.061074    l2_loss: 0.013458    loss: 0.423811
steps 2600    v_Prec: 0.538831  v_Recall: 0.582867  v_F1: 0.559985  v_AUC: 0.832751
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.346356    reg_loss: 0.060777    l2_loss: 0.013880    loss: 0.421013
steps 2800    v_Prec: 0.533031  v_Recall: 0.611763  v_F1: 0.569690  v_AUC: 0.840730
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.331856    reg_loss: 0.060228    l2_loss: 0.014397    loss: 0.406482
steps 3000    v_Prec: 0.553729  v_Recall: 0.602079  v_F1: 0.576893  v_AUC: 0.846283
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.328699    reg_loss: 0.060156    l2_loss: 0.014944    loss: 0.403799
steps 3200    v_Prec: 0.565156  v_Recall: 0.596882  v_F1: 0.580586  v_AUC: 0.850992
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.321709    reg_loss: 0.059666    l2_loss: 0.015535    loss: 0.396910
steps 3400    v_Prec: 0.554943  v_Recall: 0.617904  v_F1: 0.584733  v_AUC: 0.854219
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.326024    reg_loss: 0.059445    l2_loss: 0.016176    loss: 0.401645
steps 3600    v_Prec: 0.563493  v_Recall: 0.617353  v_F1: 0.589194  v_AUC: 0.858836
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.321379    reg_loss: 0.058992    l2_loss: 0.016860    loss: 0.397231
steps 3800    v_Prec: 0.566167  v_Recall: 0.626880  v_F1: 0.594978  v_AUC: 0.861978
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.317148    reg_loss: 0.058469    l2_loss: 0.017637    loss: 0.393254
steps 4000    v_Prec: 0.581001  v_Recall: 0.617825  v_F1: 0.598848  v_AUC: 0.864490
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.315486    reg_loss: 0.058035    l2_loss: 0.018362    loss: 0.391883
steps 4200    v_Prec: 0.567321  v_Recall: 0.636958  v_F1: 0.600126  v_AUC: 0.867493
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.305105    reg_loss: 0.057518    l2_loss: 0.019066    loss: 0.381689
steps 4400    v_Prec: 0.588512  v_Recall: 0.620345  v_F1: 0.604009  v_AUC: 0.868672
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.313163    reg_loss: 0.057170    l2_loss: 0.019873    loss: 0.390206
steps 4600    v_Prec: 0.605271  v_Recall: 0.605700  v_F1: 0.605486  v_AUC: 0.871113
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.313126    reg_loss: 0.056618    l2_loss: 0.020791    loss: 0.390535
steps 4800    v_Prec: 0.578832  v_Recall: 0.644595  v_F1: 0.609946  v_AUC: 0.873827
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.305918    reg_loss: 0.056027    l2_loss: 0.021625    loss: 0.383570
steps 5000    v_Prec: 0.597557  v_Recall: 0.643335  v_F1: 0.619602  v_AUC: 0.875751
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.306133    reg_loss: 0.055589    l2_loss: 0.022479    loss: 0.384201
steps 5200    v_Prec: 0.595228  v_Recall: 0.646170  v_F1: 0.619653  v_AUC: 0.876550
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.305823    reg_loss: 0.055212    l2_loss: 0.023338    loss: 0.384373
steps 5400    v_Prec: 0.611660  v_Recall: 0.638532  v_F1: 0.624807  v_AUC: 0.878334
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.196425    reg_loss: 0.057287    l2_loss: 0.024039    loss: 0.277751
steps 5600    v_Prec: 0.582519  v_Recall: 0.652783  v_F1: 0.615653  v_AUC: 0.874129
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.188737    reg_loss: 0.058023    l2_loss: 0.024426    loss: 0.271186
steps 5800    v_Prec: 0.594684  v_Recall: 0.623573  v_F1: 0.608786  v_AUC: 0.869659
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.175311    reg_loss: 0.058259    l2_loss: 0.024952    loss: 0.258522
steps 6000    v_Prec: 0.594246  v_Recall: 0.613101  v_F1: 0.603526  v_AUC: 0.867143
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.186443    reg_loss: 0.058579    l2_loss: 0.025415    loss: 0.270437
steps 6200    v_Prec: 0.606070  v_Recall: 0.606881  v_F1: 0.606475  v_AUC: 0.866283
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.165901    reg_loss: 0.058832    l2_loss: 0.025846    loss: 0.250580
steps 6400    v_Prec: 0.586885  v_Recall: 0.622234  v_F1: 0.604043  v_AUC: 0.866367
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.183641    reg_loss: 0.058552    l2_loss: 0.026285    loss: 0.268478
steps 6600    v_Prec: 0.587163  v_Recall: 0.623730  v_F1: 0.604894  v_AUC: 0.866183
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.183477    reg_loss: 0.058201    l2_loss: 0.026705    loss: 0.268383
steps 6800    v_Prec: 0.599136  v_Recall: 0.611212  v_F1: 0.605113  v_AUC: 0.866939
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.184414    reg_loss: 0.058269    l2_loss: 0.027136    loss: 0.269819
steps 7000    v_Prec: 0.577662  v_Recall: 0.636879  v_F1: 0.605827  v_AUC: 0.867194
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.196398    reg_loss: 0.057852    l2_loss: 0.027539    loss: 0.281789
steps 7200    v_Prec: 0.598234  v_Recall: 0.624282  v_F1: 0.610981  v_AUC: 0.870670
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.195563    reg_loss: 0.057600    l2_loss: 0.027861    loss: 0.281024
steps 7400    v_Prec: 0.562847  v_Recall: 0.662468  v_F1: 0.608608  v_AUC: 0.870320
steps 7400    running time 275 seconds

Early stop model F1: 0.624807
testing thre: 0.35244346
testing Prec: 0.43063309513175524
testing Recall: 0.7497934386391252
testing F1: 0.54706643734818
testing AUC: 0.860203730773836
overall running time 278 seconds
(0.5955426547279347, 0.5883353584447144, 0.5919170680423461, 0.860203730773836, 0.61076474)

2019-02-24 17:02:44.016663: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:02:45.116481: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:02:45.122185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:02:45.122238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.750000 seconds
loading data in 30.880000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.804921    reg_loss: 0.064985    l2_loss: 0.013259    loss: 1.883166
steps 200    v_Prec: 0.162396  v_Recall: 1.000000  v_F1: 0.279415  v_AUC: 0.497336
steps 200    running time 41 seconds

steps 400    base_loss: 1.100986    reg_loss: 0.064845    l2_loss: 0.012880    loss: 1.178711
steps 400    v_Prec: 0.162913  v_Recall: 0.990358  v_F1: 0.279799  v_AUC: 0.513601
steps 400    running time 47 seconds

steps 600    base_loss: 0.539395    reg_loss: 0.064854    l2_loss: 0.012456    loss: 0.616705
steps 600    v_Prec: 0.162398  v_Recall: 1.000000  v_F1: 0.279419  v_AUC: 0.500603
steps 600    running time 54 seconds

steps 800    base_loss: 0.468141    reg_loss: 0.064605    l2_loss: 0.012326    loss: 0.545071
steps 800    v_Prec: 0.162662  v_Recall: 0.990599  v_F1: 0.279439  v_AUC: 0.522541
steps 800    running time 61 seconds

steps 1000    base_loss: 0.461373    reg_loss: 0.064294    l2_loss: 0.012206    loss: 0.537872
steps 1000    v_Prec: 0.171101  v_Recall: 0.797204  v_F1: 0.281735  v_AUC: 0.557619
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.454644    reg_loss: 0.064048    l2_loss: 0.012048    loss: 0.530741
steps 1200    v_Prec: 0.195348  v_Recall: 0.645107  v_F1: 0.299886  v_AUC: 0.596303
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.449287    reg_loss: 0.063886    l2_loss: 0.011902    loss: 0.525074
steps 1400    v_Prec: 0.254305  v_Recall: 0.493653  v_F1: 0.335683  v_AUC: 0.647732
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.430549    reg_loss: 0.063749    l2_loss: 0.011771    loss: 0.506069
steps 1600    v_Prec: 0.417023  v_Recall: 0.462558  v_F1: 0.438612  v_AUC: 0.745126
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.408982    reg_loss: 0.064083    l2_loss: 0.011749    loss: 0.484814
steps 1800    v_Prec: 0.534291  v_Recall: 0.481359  v_F1: 0.506446  v_AUC: 0.795469
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.381967    reg_loss: 0.064574    l2_loss: 0.011749    loss: 0.458289
steps 2000    v_Prec: 0.578121  v_Recall: 0.508677  v_F1: 0.541180  v_AUC: 0.822440
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.350231    reg_loss: 0.065058    l2_loss: 0.012021    loss: 0.427310
steps 2200    v_Prec: 0.582690  v_Recall: 0.558252  v_F1: 0.570209  v_AUC: 0.837157
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.340200    reg_loss: 0.065607    l2_loss: 0.012328    loss: 0.418135
steps 2400    v_Prec: 0.601562  v_Recall: 0.581552  v_F1: 0.591388  v_AUC: 0.848327
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.325545    reg_loss: 0.066154    l2_loss: 0.012747    loss: 0.404446
steps 2600    v_Prec: 0.665893  v_Recall: 0.552949  v_F1: 0.604188  v_AUC: 0.857332
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.311240    reg_loss: 0.066535    l2_loss: 0.013177    loss: 0.390952
steps 2800    v_Prec: 0.636805  v_Recall: 0.600273  v_F1: 0.618000  v_AUC: 0.863042
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.300135    reg_loss: 0.066716    l2_loss: 0.013684    loss: 0.380535
steps 3000    v_Prec: 0.672036  v_Recall: 0.583320  v_F1: 0.624543  v_AUC: 0.868328
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.302266    reg_loss: 0.066873    l2_loss: 0.014114    loss: 0.383253
steps 3200    v_Prec: 0.652307  v_Recall: 0.615619  v_F1: 0.633433  v_AUC: 0.873104
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.291471    reg_loss: 0.067022    l2_loss: 0.014634    loss: 0.373128
steps 3400    v_Prec: 0.641465  v_Recall: 0.637394  v_F1: 0.639423  v_AUC: 0.878678
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.282971    reg_loss: 0.066965    l2_loss: 0.015059    loss: 0.364995
steps 3600    v_Prec: 0.673065  v_Recall: 0.611361  v_F1: 0.640731  v_AUC: 0.881027
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.282431    reg_loss: 0.067144    l2_loss: 0.015602    loss: 0.365176
steps 3800    v_Prec: 0.652925  v_Recall: 0.646473  v_F1: 0.649683  v_AUC: 0.885180
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.287834    reg_loss: 0.067094    l2_loss: 0.016099    loss: 0.371027
steps 4000    v_Prec: 0.677233  v_Recall: 0.623092  v_F1: 0.649035  v_AUC: 0.887104
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.283391    reg_loss: 0.067540    l2_loss: 0.016630    loss: 0.367560
steps 4200    v_Prec: 0.668792  v_Recall: 0.640527  v_F1: 0.654354  v_AUC: 0.890391
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.280856    reg_loss: 0.067383    l2_loss: 0.017198    loss: 0.365437
steps 4400    v_Prec: 0.694480  v_Recall: 0.618592  v_F1: 0.654343  v_AUC: 0.891311
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.271008    reg_loss: 0.067279    l2_loss: 0.017753    loss: 0.356039
steps 4600    v_Prec: 0.665262  v_Recall: 0.659650  v_F1: 0.662444  v_AUC: 0.892980
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.277521    reg_loss: 0.067419    l2_loss: 0.018355    loss: 0.363295
steps 4800    v_Prec: 0.672411  v_Recall: 0.652097  v_F1: 0.662098  v_AUC: 0.894558
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.278100    reg_loss: 0.067592    l2_loss: 0.018913    loss: 0.364605
steps 5000    v_Prec: 0.695510  v_Recall: 0.633537  v_F1: 0.663079  v_AUC: 0.895701
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.273602    reg_loss: 0.067166    l2_loss: 0.019621    loss: 0.360389
steps 5200    v_Prec: 0.692858  v_Recall: 0.637635  v_F1: 0.664100  v_AUC: 0.896482
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.272293    reg_loss: 0.067462    l2_loss: 0.020223    loss: 0.359978
steps 5400    v_Prec: 0.677344  v_Recall: 0.655793  v_F1: 0.666395  v_AUC: 0.898870
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.193894    reg_loss: 0.068198    l2_loss: 0.020985    loss: 0.283077
steps 5600    v_Prec: 0.702503  v_Recall: 0.633698  v_F1: 0.666329  v_AUC: 0.895790
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.186070    reg_loss: 0.068042    l2_loss: 0.021891    loss: 0.276003
steps 5800    v_Prec: 0.682969  v_Recall: 0.641813  v_F1: 0.661751  v_AUC: 0.893297
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.192706    reg_loss: 0.067744    l2_loss: 0.022608    loss: 0.283058
steps 6000    v_Prec: 0.683659  v_Recall: 0.644384  v_F1: 0.663440  v_AUC: 0.892111
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.192077    reg_loss: 0.067867    l2_loss: 0.023260    loss: 0.283205
steps 6200    v_Prec: 0.674765  v_Recall: 0.644946  v_F1: 0.659519  v_AUC: 0.890615
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.197684    reg_loss: 0.067912    l2_loss: 0.023886    loss: 0.289482
steps 6400    v_Prec: 0.684408  v_Recall: 0.643661  v_F1: 0.663409  v_AUC: 0.892555
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.189401    reg_loss: 0.067636    l2_loss: 0.024594    loss: 0.281632
steps 6600    v_Prec: 0.699149  v_Recall: 0.633537  v_F1: 0.664728  v_AUC: 0.893470
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.190396    reg_loss: 0.068046    l2_loss: 0.025149    loss: 0.283590
steps 6800    v_Prec: 0.673683  v_Recall: 0.650570  v_F1: 0.661925  v_AUC: 0.891968
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.184259    reg_loss: 0.067620    l2_loss: 0.025604    loss: 0.277483
steps 7000    v_Prec: 0.698657  v_Recall: 0.635224  v_F1: 0.665432  v_AUC: 0.892974
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.194672    reg_loss: 0.067582    l2_loss: 0.025930    loss: 0.288183
steps 7200    v_Prec: 0.715882  v_Recall: 0.633055  v_F1: 0.671926  v_AUC: 0.896163
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.198556    reg_loss: 0.067662    l2_loss: 0.026383    loss: 0.292601
steps 7400    v_Prec: 0.717759  v_Recall: 0.638117  v_F1: 0.675599  v_AUC: 0.899123
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.187821    reg_loss: 0.067463    l2_loss: 0.026832    loss: 0.282116
steps 7600    v_Prec: 0.732031  v_Recall: 0.629278  v_F1: 0.676777  v_AUC: 0.898800
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.197410    reg_loss: 0.067406    l2_loss: 0.027152    loss: 0.291968
steps 7800    v_Prec: 0.704625  v_Recall: 0.662221  v_F1: 0.682765  v_AUC: 0.901236
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.194252    reg_loss: 0.067730    l2_loss: 0.027486    loss: 0.289467
steps 8000    v_Prec: 0.708660  v_Recall: 0.660775  v_F1: 0.683880  v_AUC: 0.901484
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.188086    reg_loss: 0.067557    l2_loss: 0.027747    loss: 0.283389
steps 8200    v_Prec: 0.732974  v_Recall: 0.656355  v_F1: 0.692552  v_AUC: 0.903063
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.200471    reg_loss: 0.067541    l2_loss: 0.028148    loss: 0.296161
steps 8400    v_Prec: 0.718807  v_Recall: 0.664229  v_F1: 0.690441  v_AUC: 0.905222
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.191396    reg_loss: 0.067327    l2_loss: 0.028468    loss: 0.287192
steps 8600    v_Prec: 0.717295  v_Recall: 0.673148  v_F1: 0.694520  v_AUC: 0.907311
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.198871    reg_loss: 0.067252    l2_loss: 0.028792    loss: 0.294915
steps 8800    v_Prec: 0.723118  v_Recall: 0.677567  v_F1: 0.699602  v_AUC: 0.908887
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.197793    reg_loss: 0.067286    l2_loss: 0.028948    loss: 0.294027
steps 9000    v_Prec: 0.745879  v_Recall: 0.661739  v_F1: 0.701294  v_AUC: 0.910188
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.192003    reg_loss: 0.067592    l2_loss: 0.029216    loss: 0.288811
steps 9200    v_Prec: 0.749469  v_Recall: 0.652338  v_F1: 0.697539  v_AUC: 0.909965
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.198430    reg_loss: 0.067119    l2_loss: 0.029344    loss: 0.294893
steps 9400    v_Prec: 0.742155  v_Recall: 0.665113  v_F1: 0.701525  v_AUC: 0.908867
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.189691    reg_loss: 0.067054    l2_loss: 0.029606    loss: 0.286351
steps 9600    v_Prec: 0.732856  v_Recall: 0.682629  v_F1: 0.706851  v_AUC: 0.912828
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.186849    reg_loss: 0.067149    l2_loss: 0.029906    loss: 0.283903
steps 9800    v_Prec: 0.721442  v_Recall: 0.685039  v_F1: 0.702770  v_AUC: 0.910916
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.197786    reg_loss: 0.066972    l2_loss: 0.030122    loss: 0.294881
steps 10000    v_Prec: 0.727242  v_Recall: 0.693235  v_F1: 0.709831  v_AUC: 0.915531
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.190323    reg_loss: 0.067033    l2_loss: 0.030363    loss: 0.287719
steps 10200    v_Prec: 0.760923  v_Recall: 0.670256  v_F1: 0.712717  v_AUC: 0.916316
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.189827    reg_loss: 0.066987    l2_loss: 0.030540    loss: 0.287354
steps 10400    v_Prec: 0.734598  v_Recall: 0.703198  v_F1: 0.718555  v_AUC: 0.917738
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.188151    reg_loss: 0.066977    l2_loss: 0.030734    loss: 0.285863
steps 10600    v_Prec: 0.743658  v_Recall: 0.697172  v_F1: 0.719665  v_AUC: 0.917718
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.176823    reg_loss: 0.066909    l2_loss: 0.030904    loss: 0.274637
steps 10800    v_Prec: 0.759650  v_Recall: 0.683111  v_F1: 0.719350  v_AUC: 0.918759
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.085692    reg_loss: 0.066211    l2_loss: 0.030979    loss: 0.182882
steps 11000    v_Prec: 0.728558  v_Recall: 0.683191  v_F1: 0.705146  v_AUC: 0.912465
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.077880    reg_loss: 0.066418    l2_loss: 0.031210    loss: 0.175508
steps 11200    v_Prec: 0.718667  v_Recall: 0.672184  v_F1: 0.694649  v_AUC: 0.906791
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.077396    reg_loss: 0.066316    l2_loss: 0.031346    loss: 0.175058
steps 11400    v_Prec: 0.707356  v_Recall: 0.683031  v_F1: 0.694980  v_AUC: 0.904840
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.086681    reg_loss: 0.066155    l2_loss: 0.031533    loss: 0.184369
steps 11600    v_Prec: 0.738991  v_Recall: 0.647196  v_F1: 0.690054  v_AUC: 0.902390
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.081112    reg_loss: 0.065947    l2_loss: 0.031770    loss: 0.178829
steps 11800    v_Prec: 0.695453  v_Recall: 0.681986  v_F1: 0.688654  v_AUC: 0.901308
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.087667    reg_loss: 0.065737    l2_loss: 0.031921    loss: 0.185325
steps 12000    v_Prec: 0.703282  v_Recall: 0.664631  v_F1: 0.683410  v_AUC: 0.899268
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.095623    reg_loss: 0.066194    l2_loss: 0.032092    loss: 0.193910
steps 12200    v_Prec: 0.703659  v_Recall: 0.661257  v_F1: 0.681799  v_AUC: 0.896459
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.091636    reg_loss: 0.065678    l2_loss: 0.032238    loss: 0.189552
steps 12400    v_Prec: 0.722506  v_Recall: 0.648722  v_F1: 0.683629  v_AUC: 0.896958
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.093610    reg_loss: 0.065796    l2_loss: 0.032329    loss: 0.191735
steps 12600    v_Prec: 0.705307  v_Recall: 0.654588  v_F1: 0.679002  v_AUC: 0.895344
steps 12600    running time 446 seconds

Early stop model F1: 0.719665
testing thre: 0.43320796
testing Prec: 0.5357837012355963
testing Recall: 0.7502794653705954
testing F1: 0.6251442687346873
testing AUC: 0.8964994306851396
overall running time 449 seconds
(0.7045429485058993, 0.621093560145808, 0.660191666881926, 0.8964994306851396, 0.7234043)

2019-02-24 17:07:35.654655: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:07:37.213616: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:07:37.226503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:07:37.226578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.660000 seconds
loading data in 30.760000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.976508    reg_loss: 0.064785    l2_loss: 0.013380    loss: 1.054673
steps 200    v_Prec: 0.162309  v_Recall: 1.000000  v_F1: 0.279286  v_AUC: 0.485164
steps 200    running time 41 seconds

steps 400    base_loss: 0.649168    reg_loss: 0.065008    l2_loss: 0.013430    loss: 0.727606
steps 400    v_Prec: 0.162302  v_Recall: 1.000000  v_F1: 0.279277  v_AUC: 0.502272
steps 400    running time 48 seconds

steps 600    base_loss: 0.493341    reg_loss: 0.065137    l2_loss: 0.013392    loss: 0.571871
steps 600    v_Prec: 0.162300  v_Recall: 1.000000  v_F1: 0.279274  v_AUC: 0.529971
steps 600    running time 54 seconds

steps 800    base_loss: 0.480074    reg_loss: 0.065179    l2_loss: 0.013229    loss: 0.558482
steps 800    v_Prec: 0.193642  v_Recall: 0.532760  v_F1: 0.284043  v_AUC: 0.571489
steps 800    running time 60 seconds

steps 1000    base_loss: 0.467611    reg_loss: 0.065088    l2_loss: 0.013051    loss: 0.545750
steps 1000    v_Prec: 0.236273  v_Recall: 0.462497  v_F1: 0.312765  v_AUC: 0.613651
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.435938    reg_loss: 0.065049    l2_loss: 0.013033    loss: 0.514020
steps 1200    v_Prec: 0.324209  v_Recall: 0.404695  v_F1: 0.360009  v_AUC: 0.658642
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.420535    reg_loss: 0.065327    l2_loss: 0.013084    loss: 0.498947
steps 1400    v_Prec: 0.426625  v_Recall: 0.405258  v_F1: 0.415667  v_AUC: 0.712417
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.391496    reg_loss: 0.065515    l2_loss: 0.013197    loss: 0.470208
steps 1600    v_Prec: 0.522435  v_Recall: 0.424954  v_F1: 0.468679  v_AUC: 0.748959
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.368778    reg_loss: 0.065683    l2_loss: 0.013361    loss: 0.447821
steps 1800    v_Prec: 0.542733  v_Recall: 0.473752  v_F1: 0.505902  v_AUC: 0.783509
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.354233    reg_loss: 0.065812    l2_loss: 0.013524    loss: 0.433568
steps 2000    v_Prec: 0.578311  v_Recall: 0.503738  v_F1: 0.538455  v_AUC: 0.808072
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.335860    reg_loss: 0.065932    l2_loss: 0.013776    loss: 0.415567
steps 2200    v_Prec: 0.634326  v_Recall: 0.511938  v_F1: 0.566598  v_AUC: 0.822956
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.318658    reg_loss: 0.065897    l2_loss: 0.014017    loss: 0.398572
steps 2400    v_Prec: 0.655890  v_Recall: 0.534930  v_F1: 0.589267  v_AUC: 0.835399
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.311040    reg_loss: 0.066060    l2_loss: 0.014289    loss: 0.391389
steps 2600    v_Prec: 0.687679  v_Recall: 0.539352  v_F1: 0.604551  v_AUC: 0.843467
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.313788    reg_loss: 0.066126    l2_loss: 0.014512    loss: 0.394426
steps 2800    v_Prec: 0.688190  v_Recall: 0.561219  v_F1: 0.618253  v_AUC: 0.852004
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.304362    reg_loss: 0.066201    l2_loss: 0.014803    loss: 0.385366
steps 3000    v_Prec: 0.705560  v_Recall: 0.569258  v_F1: 0.630122  v_AUC: 0.857266
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.290516    reg_loss: 0.066123    l2_loss: 0.015075    loss: 0.371714
steps 3200    v_Prec: 0.703473  v_Recall: 0.589517  v_F1: 0.641473  v_AUC: 0.865578
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.289192    reg_loss: 0.065899    l2_loss: 0.015395    loss: 0.370486
steps 3400    v_Prec: 0.729296  v_Recall: 0.584774  v_F1: 0.649088  v_AUC: 0.867036
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.284756    reg_loss: 0.065806    l2_loss: 0.015664    loss: 0.366227
steps 3600    v_Prec: 0.738869  v_Recall: 0.601656  v_F1: 0.663240  v_AUC: 0.872991
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.279377    reg_loss: 0.066008    l2_loss: 0.016120    loss: 0.361505
steps 3800    v_Prec: 0.755844  v_Recall: 0.595305  v_F1: 0.666037  v_AUC: 0.874605
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.273764    reg_loss: 0.066112    l2_loss: 0.016443    loss: 0.356319
steps 4000    v_Prec: 0.739608  v_Recall: 0.616529  v_F1: 0.672483  v_AUC: 0.881407
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.274432    reg_loss: 0.066098    l2_loss: 0.016835    loss: 0.357365
steps 4200    v_Prec: 0.759491  v_Recall: 0.609535  v_F1: 0.676300  v_AUC: 0.883590
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.273579    reg_loss: 0.065716    l2_loss: 0.017211    loss: 0.356506
steps 4400    v_Prec: 0.744765  v_Recall: 0.634778  v_F1: 0.685387  v_AUC: 0.887047
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.269806    reg_loss: 0.065953    l2_loss: 0.017607    loss: 0.353366
steps 4600    v_Prec: 0.757449  v_Recall: 0.627382  v_F1: 0.686307  v_AUC: 0.888749
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.266388    reg_loss: 0.065648    l2_loss: 0.018074    loss: 0.350110
steps 4800    v_Prec: 0.748340  v_Recall: 0.643299  v_F1: 0.691855  v_AUC: 0.890559
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.258221    reg_loss: 0.065334    l2_loss: 0.018454    loss: 0.342010
steps 5000    v_Prec: 0.754728  v_Recall: 0.651339  v_F1: 0.699232  v_AUC: 0.892096
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.265473    reg_loss: 0.065432    l2_loss: 0.018859    loss: 0.349763
steps 5200    v_Prec: 0.757632  v_Recall: 0.658413  v_F1: 0.704546  v_AUC: 0.893856
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.250390    reg_loss: 0.065184    l2_loss: 0.019371    loss: 0.334945
steps 5400    v_Prec: 0.758459  v_Recall: 0.661388  v_F1: 0.706605  v_AUC: 0.895034
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.165676    reg_loss: 0.062036    l2_loss: 0.019679    loss: 0.247391
steps 5600    v_Prec: 0.751920  v_Recall: 0.661066  v_F1: 0.703572  v_AUC: 0.892385
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.159409    reg_loss: 0.062334    l2_loss: 0.020052    loss: 0.241795
steps 5800    v_Prec: 0.764895  v_Recall: 0.650213  v_F1: 0.702907  v_AUC: 0.889419
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.164403    reg_loss: 0.062434    l2_loss: 0.020408    loss: 0.247244
steps 6000    v_Prec: 0.763278  v_Recall: 0.644666  v_F1: 0.698976  v_AUC: 0.890453
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.164395    reg_loss: 0.062645    l2_loss: 0.020830    loss: 0.247870
steps 6200    v_Prec: 0.772772  v_Recall: 0.634295  v_F1: 0.696720  v_AUC: 0.888656
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.171904    reg_loss: 0.062684    l2_loss: 0.021158    loss: 0.255746
steps 6400    v_Prec: 0.765280  v_Recall: 0.643219  v_F1: 0.698960  v_AUC: 0.889941
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.165672    reg_loss: 0.062416    l2_loss: 0.021381    loss: 0.249469
steps 6600    v_Prec: 0.776931  v_Recall: 0.638958  v_F1: 0.701222  v_AUC: 0.890689
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.183548    reg_loss: 0.062638    l2_loss: 0.021599    loss: 0.267785
steps 6800    v_Prec: 0.804913  v_Recall: 0.624246  v_F1: 0.703160  v_AUC: 0.892342
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.165720    reg_loss: 0.062782    l2_loss: 0.021833    loss: 0.250334
steps 7000    v_Prec: 0.768409  v_Recall: 0.653509  v_F1: 0.706317  v_AUC: 0.893104
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.173086    reg_loss: 0.062550    l2_loss: 0.021942    loss: 0.257577
steps 7200    v_Prec: 0.774723  v_Recall: 0.652464  v_F1: 0.708357  v_AUC: 0.895238
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.166454    reg_loss: 0.062465    l2_loss: 0.022119    loss: 0.251038
steps 7400    v_Prec: 0.779610  v_Recall: 0.649811  v_F1: 0.708817  v_AUC: 0.895132
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.167866    reg_loss: 0.062441    l2_loss: 0.022266    loss: 0.252573
steps 7600    v_Prec: 0.791247  v_Recall: 0.643862  v_F1: 0.709986  v_AUC: 0.895643
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.178025    reg_loss: 0.062834    l2_loss: 0.022472    loss: 0.263331
steps 7800    v_Prec: 0.780564  v_Recall: 0.660584  v_F1: 0.715580  v_AUC: 0.898482
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.175066    reg_loss: 0.062883    l2_loss: 0.022508    loss: 0.260456
steps 8000    v_Prec: 0.769533  v_Recall: 0.677788  v_F1: 0.720752  v_AUC: 0.898385
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.180539    reg_loss: 0.063057    l2_loss: 0.022748    loss: 0.266344
steps 8200    v_Prec: 0.773801  v_Recall: 0.679556  v_F1: 0.723623  v_AUC: 0.900463
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.174311    reg_loss: 0.062905    l2_loss: 0.022724    loss: 0.259939
steps 8400    v_Prec: 0.784654  v_Recall: 0.671678  v_F1: 0.723784  v_AUC: 0.903064
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.176957    reg_loss: 0.062679    l2_loss: 0.022808    loss: 0.262445
steps 8600    v_Prec: 0.783959  v_Recall: 0.682048  v_F1: 0.729461  v_AUC: 0.902293
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.175598    reg_loss: 0.062814    l2_loss: 0.022888    loss: 0.261301
steps 8800    v_Prec: 0.793667  v_Recall: 0.675054  v_F1: 0.729571  v_AUC: 0.904757
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.176039    reg_loss: 0.062977    l2_loss: 0.022965    loss: 0.261980
steps 9000    v_Prec: 0.779424  v_Recall: 0.685184  v_F1: 0.729272  v_AUC: 0.903619
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.175630    reg_loss: 0.062803    l2_loss: 0.023027    loss: 0.261460
steps 9200    v_Prec: 0.784890  v_Recall: 0.678190  v_F1: 0.727649  v_AUC: 0.904251
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.171541    reg_loss: 0.062482    l2_loss: 0.023038    loss: 0.257061
steps 9400    v_Prec: 0.777348  v_Recall: 0.694107  v_F1: 0.733373  v_AUC: 0.906528
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.176271    reg_loss: 0.062818    l2_loss: 0.023084    loss: 0.262172
steps 9600    v_Prec: 0.778394  v_Recall: 0.699172  v_F1: 0.736659  v_AUC: 0.908445
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.181724    reg_loss: 0.062978    l2_loss: 0.023257    loss: 0.267959
steps 9800    v_Prec: 0.792619  v_Recall: 0.694107  v_F1: 0.740099  v_AUC: 0.910430
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.175310    reg_loss: 0.062902    l2_loss: 0.023286    loss: 0.261498
steps 10000    v_Prec: 0.788992  v_Recall: 0.699494  v_F1: 0.741552  v_AUC: 0.910589
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.170577    reg_loss: 0.062809    l2_loss: 0.023251    loss: 0.256638
steps 10200    v_Prec: 0.805883  v_Recall: 0.687194  v_F1: 0.741821  v_AUC: 0.913520
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.172077    reg_loss: 0.062908    l2_loss: 0.023406    loss: 0.258390
steps 10400    v_Prec: 0.810854  v_Recall: 0.688239  v_F1: 0.744532  v_AUC: 0.912628
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.176516    reg_loss: 0.062816    l2_loss: 0.023337    loss: 0.262669
steps 10600    v_Prec: 0.822721  v_Recall: 0.683495  v_F1: 0.746674  v_AUC: 0.914000
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.160383    reg_loss: 0.062273    l2_loss: 0.023493    loss: 0.246149
steps 10800    v_Prec: 0.826642  v_Recall: 0.681968  v_F1: 0.747368  v_AUC: 0.914770
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.048543    reg_loss: 0.058253    l2_loss: 0.023264    loss: 0.130060
steps 11000    v_Prec: 0.800037  v_Recall: 0.696037  v_F1: 0.744422  v_AUC: 0.912166
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.048271    reg_loss: 0.057900    l2_loss: 0.022852    loss: 0.129022
steps 11200    v_Prec: 0.806677  v_Recall: 0.685666  v_F1: 0.741265  v_AUC: 0.909345
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.046641    reg_loss: 0.057888    l2_loss: 0.022500    loss: 0.127029
steps 11400    v_Prec: 0.795227  v_Recall: 0.688399  v_F1: 0.737967  v_AUC: 0.905572
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.050558    reg_loss: 0.057726    l2_loss: 0.022096    loss: 0.130380
steps 11600    v_Prec: 0.806195  v_Recall: 0.675858  v_F1: 0.735295  v_AUC: 0.902673
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.050701    reg_loss: 0.057484    l2_loss: 0.021876    loss: 0.130061
steps 11800    v_Prec: 0.813181  v_Recall: 0.671517  v_F1: 0.735591  v_AUC: 0.903020
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.053389    reg_loss: 0.057574    l2_loss: 0.021552    loss: 0.132515
steps 12000    v_Prec: 0.793399  v_Recall: 0.676421  v_F1: 0.730255  v_AUC: 0.900962
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.061664    reg_loss: 0.057421    l2_loss: 0.021388    loss: 0.140473
steps 12200    v_Prec: 0.770568  v_Recall: 0.691213  v_F1: 0.728737  v_AUC: 0.900548
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.056605    reg_loss: 0.057517    l2_loss: 0.021224    loss: 0.135346
steps 12400    v_Prec: 0.783739  v_Recall: 0.681164  v_F1: 0.728860  v_AUC: 0.900353
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.056793    reg_loss: 0.057230    l2_loss: 0.021017    loss: 0.135040
steps 12600    v_Prec: 0.791749  v_Recall: 0.678833  v_F1: 0.730956  v_AUC: 0.900658
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.058212    reg_loss: 0.056958    l2_loss: 0.020795    loss: 0.135965
steps 12800    v_Prec: 0.779664  v_Recall: 0.683013  v_F1: 0.728145  v_AUC: 0.900653
steps 12800    running time 453 seconds

Early stop model F1: 0.747368
testing thre: 0.559071
testing Prec: 0.6790068391317277
testing Recall: 0.6659052247873634
testing F1: 0.6723922165239369
testing AUC: 0.8861701537605658
overall running time 455 seconds
(0.7200813589137486, 0.6366464155528554, 0.6757983800237322, 0.8861701537605658, 0.6581457)

2019-02-24 17:12:34.173793: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:12:35.357588: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:12:35.377256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:12:35.377325: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.700000 seconds
loading data in 30.740000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.670595    reg_loss: 0.064911    l2_loss: 0.013320    loss: 0.748826
steps 200    v_Prec: 0.163918  v_Recall: 1.000000  v_F1: 0.281666  v_AUC: 0.467099
steps 200    running time 41 seconds

steps 400    base_loss: 0.525804    reg_loss: 0.064968    l2_loss: 0.013291    loss: 0.604063
steps 400    v_Prec: 0.164050  v_Recall: 0.998169  v_F1: 0.281788  v_AUC: 0.485097
steps 400    running time 47 seconds

steps 600    base_loss: 0.493305    reg_loss: 0.064741    l2_loss: 0.013212    loss: 0.571257
steps 600    v_Prec: 0.163955  v_Recall: 0.999522  v_F1: 0.281702  v_AUC: 0.504829
steps 600    running time 54 seconds

steps 800    base_loss: 0.469376    reg_loss: 0.064470    l2_loss: 0.013095    loss: 0.546940
steps 800    v_Prec: 0.165539  v_Recall: 0.967762  v_F1: 0.282718  v_AUC: 0.534041
steps 800    running time 60 seconds

steps 1000    base_loss: 0.448240    reg_loss: 0.063972    l2_loss: 0.012949    loss: 0.525161
steps 1000    v_Prec: 0.207654  v_Recall: 0.556316  v_F1: 0.302423  v_AUC: 0.603430
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.444631    reg_loss: 0.063692    l2_loss: 0.012904    loss: 0.521226
steps 1200    v_Prec: 0.257919  v_Recall: 0.502269  v_F1: 0.340823  v_AUC: 0.655003
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.435396    reg_loss: 0.063228    l2_loss: 0.012831    loss: 0.511455
steps 1400    v_Prec: 0.338795  v_Recall: 0.419725  v_F1: 0.374942  v_AUC: 0.685995
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.422030    reg_loss: 0.062949    l2_loss: 0.012829    loss: 0.497808
steps 1600    v_Prec: 0.369012  v_Recall: 0.434132  v_F1: 0.398932  v_AUC: 0.707785
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.407517    reg_loss: 0.062618    l2_loss: 0.012909    loss: 0.483044
steps 1800    v_Prec: 0.381148  v_Recall: 0.494707  v_F1: 0.430566  v_AUC: 0.734380
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.403202    reg_loss: 0.062576    l2_loss: 0.012994    loss: 0.478771
steps 2000    v_Prec: 0.443945  v_Recall: 0.510945  v_F1: 0.475094  v_AUC: 0.770489
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.381850    reg_loss: 0.062196    l2_loss: 0.013115    loss: 0.457161
steps 2200    v_Prec: 0.480710  v_Recall: 0.508796  v_F1: 0.494354  v_AUC: 0.785895
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.373299    reg_loss: 0.062226    l2_loss: 0.013366    loss: 0.448891
steps 2400    v_Prec: 0.485687  v_Recall: 0.525352  v_F1: 0.504742  v_AUC: 0.794917
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.370166    reg_loss: 0.062337    l2_loss: 0.013517    loss: 0.446020
steps 2600    v_Prec: 0.512058  v_Recall: 0.550983  v_F1: 0.530808  v_AUC: 0.813072
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.358011    reg_loss: 0.062389    l2_loss: 0.013755    loss: 0.434154
steps 2800    v_Prec: 0.526900  v_Recall: 0.555839  v_F1: 0.540982  v_AUC: 0.821795
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.349841    reg_loss: 0.062663    l2_loss: 0.013859    loss: 0.426363
steps 3000    v_Prec: 0.512042  v_Recall: 0.604155  v_F1: 0.554298  v_AUC: 0.832244
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.346043    reg_loss: 0.063011    l2_loss: 0.014060    loss: 0.423114
steps 3200    v_Prec: 0.541610  v_Recall: 0.603518  v_F1: 0.570891  v_AUC: 0.841892
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.338805    reg_loss: 0.063815    l2_loss: 0.014305    loss: 0.416926
steps 3400    v_Prec: 0.549703  v_Recall: 0.618005  v_F1: 0.581856  v_AUC: 0.850932
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.334029    reg_loss: 0.064424    l2_loss: 0.014554    loss: 0.413007
steps 3600    v_Prec: 0.549607  v_Recall: 0.640691  v_F1: 0.591664  v_AUC: 0.857843
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.320512    reg_loss: 0.065301    l2_loss: 0.014921    loss: 0.400734
steps 3800    v_Prec: 0.558382  v_Recall: 0.644830  v_F1: 0.598500  v_AUC: 0.865218
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.318308    reg_loss: 0.066225    l2_loss: 0.015463    loss: 0.399997
steps 4000    v_Prec: 0.595519  v_Recall: 0.626284  v_F1: 0.610514  v_AUC: 0.871571
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.311629    reg_loss: 0.066837    l2_loss: 0.016072    loss: 0.394538
steps 4200    v_Prec: 0.602614  v_Recall: 0.631298  v_F1: 0.616623  v_AUC: 0.874749
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.298740    reg_loss: 0.067124    l2_loss: 0.016713    loss: 0.382576
steps 4400    v_Prec: 0.616344  v_Recall: 0.633368  v_F1: 0.624740  v_AUC: 0.878635
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.296880    reg_loss: 0.067462    l2_loss: 0.017425    loss: 0.381766
steps 4600    v_Prec: 0.631604  v_Recall: 0.642362  v_F1: 0.636938  v_AUC: 0.883752
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.294041    reg_loss: 0.067624    l2_loss: 0.018169    loss: 0.379834
steps 4800    v_Prec: 0.640765  v_Recall: 0.642601  v_F1: 0.641682  v_AUC: 0.886711
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.292535    reg_loss: 0.067960    l2_loss: 0.018889    loss: 0.379383
steps 5000    v_Prec: 0.655196  v_Recall: 0.622861  v_F1: 0.638619  v_AUC: 0.886330
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.286494    reg_loss: 0.067740    l2_loss: 0.019709    loss: 0.373943
steps 5200    v_Prec: 0.677938  v_Recall: 0.608055  v_F1: 0.641098  v_AUC: 0.889355
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.282479    reg_loss: 0.067973    l2_loss: 0.020464    loss: 0.370916
steps 5400    v_Prec: 0.675058  v_Recall: 0.621110  v_F1: 0.646961  v_AUC: 0.890906
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.209861    reg_loss: 0.069500    l2_loss: 0.021368    loss: 0.300729
steps 5600    v_Prec: 0.663118  v_Recall: 0.614821  v_F1: 0.638057  v_AUC: 0.886423
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.204403    reg_loss: 0.069421    l2_loss: 0.022117    loss: 0.295942
steps 5800    v_Prec: 0.642043  v_Recall: 0.632333  v_F1: 0.637151  v_AUC: 0.884760
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.202007    reg_loss: 0.069278    l2_loss: 0.022818    loss: 0.294104
steps 6000    v_Prec: 0.626728  v_Recall: 0.642442  v_F1: 0.634488  v_AUC: 0.883887
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.210013    reg_loss: 0.068828    l2_loss: 0.023548    loss: 0.302390
steps 6200    v_Prec: 0.639229  v_Recall: 0.652153  v_F1: 0.645626  v_AUC: 0.887079
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.221603    reg_loss: 0.068966    l2_loss: 0.024153    loss: 0.314721
steps 6400    v_Prec: 0.671549  v_Recall: 0.635039  v_F1: 0.652784  v_AUC: 0.889165
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.208050    reg_loss: 0.068878    l2_loss: 0.024516    loss: 0.301444
steps 6600    v_Prec: 0.645756  v_Recall: 0.663695  v_F1: 0.654603  v_AUC: 0.891887
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.203848    reg_loss: 0.069092    l2_loss: 0.024920    loss: 0.297860
steps 6800    v_Prec: 0.662574  v_Recall: 0.644273  v_F1: 0.653295  v_AUC: 0.891662
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.213538    reg_loss: 0.068709    l2_loss: 0.025422    loss: 0.307669
steps 7000    v_Prec: 0.662654  v_Recall: 0.657327  v_F1: 0.659980  v_AUC: 0.893052
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.206066    reg_loss: 0.068579    l2_loss: 0.025879    loss: 0.300525
steps 7200    v_Prec: 0.681869  v_Recall: 0.636711  v_F1: 0.658517  v_AUC: 0.894125
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.210735    reg_loss: 0.068768    l2_loss: 0.026277    loss: 0.305779
steps 7400    v_Prec: 0.676344  v_Recall: 0.639736  v_F1: 0.657531  v_AUC: 0.893934
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.218151    reg_loss: 0.068763    l2_loss: 0.026737    loss: 0.313651
steps 7600    v_Prec: 0.659274  v_Recall: 0.669665  v_F1: 0.664429  v_AUC: 0.896906
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.216717    reg_loss: 0.068967    l2_loss: 0.026966    loss: 0.312650
steps 7800    v_Prec: 0.683428  v_Recall: 0.651278  v_F1: 0.666966  v_AUC: 0.898503
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.205148    reg_loss: 0.068841    l2_loss: 0.027375    loss: 0.301363
steps 8000    v_Prec: 0.665691  v_Recall: 0.669506  v_F1: 0.667593  v_AUC: 0.898886
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.218428    reg_loss: 0.068649    l2_loss: 0.027663    loss: 0.314740
steps 8200    v_Prec: 0.664619  v_Recall: 0.680331  v_F1: 0.672383  v_AUC: 0.901577
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.215337    reg_loss: 0.068580    l2_loss: 0.028089    loss: 0.312006
steps 8400    v_Prec: 0.695459  v_Recall: 0.662023  v_F1: 0.678330  v_AUC: 0.903467
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.207727    reg_loss: 0.068612    l2_loss: 0.028253    loss: 0.304592
steps 8600    v_Prec: 0.709053  v_Recall: 0.656451  v_F1: 0.681739  v_AUC: 0.904047
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.206136    reg_loss: 0.068704    l2_loss: 0.028516    loss: 0.303356
steps 8800    v_Prec: 0.713099  v_Recall: 0.662979  v_F1: 0.687126  v_AUC: 0.906785
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.211848    reg_loss: 0.068561    l2_loss: 0.028693    loss: 0.309102
steps 9000    v_Prec: 0.722868  v_Recall: 0.663775  v_F1: 0.692062  v_AUC: 0.908076
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.212513    reg_loss: 0.068342    l2_loss: 0.028863    loss: 0.309719
steps 9200    v_Prec: 0.697501  v_Recall: 0.684231  v_F1: 0.690802  v_AUC: 0.908283
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.207604    reg_loss: 0.068289    l2_loss: 0.029211    loss: 0.305104
steps 9400    v_Prec: 0.724227  v_Recall: 0.672690  v_F1: 0.697507  v_AUC: 0.911913
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.210736    reg_loss: 0.068275    l2_loss: 0.029331    loss: 0.308342
steps 9600    v_Prec: 0.709741  v_Recall: 0.687256  v_F1: 0.698318  v_AUC: 0.912636
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.207147    reg_loss: 0.068400    l2_loss: 0.029526    loss: 0.305073
steps 9800    v_Prec: 0.721563  v_Recall: 0.682162  v_F1: 0.701309  v_AUC: 0.913348
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.207784    reg_loss: 0.068439    l2_loss: 0.029751    loss: 0.305974
steps 10000    v_Prec: 0.718051  v_Recall: 0.689644  v_F1: 0.703561  v_AUC: 0.915585
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.211120    reg_loss: 0.068202    l2_loss: 0.029941    loss: 0.309263
steps 10200    v_Prec: 0.724326  v_Recall: 0.697286  v_F1: 0.710549  v_AUC: 0.917648
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.195634    reg_loss: 0.068199    l2_loss: 0.029945    loss: 0.293778
steps 10400    v_Prec: 0.726770  v_Recall: 0.690440  v_F1: 0.708139  v_AUC: 0.918301
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.205685    reg_loss: 0.068371    l2_loss: 0.030124    loss: 0.304180
steps 10600    v_Prec: 0.761581  v_Recall: 0.668710  v_F1: 0.712130  v_AUC: 0.919438
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.200481    reg_loss: 0.068157    l2_loss: 0.030187    loss: 0.298825
steps 10800    v_Prec: 0.731812  v_Recall: 0.694181  v_F1: 0.712500  v_AUC: 0.920793
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.094483    reg_loss: 0.068339    l2_loss: 0.030616    loss: 0.193438
steps 11000    v_Prec: 0.714499  v_Recall: 0.684470  v_F1: 0.699163  v_AUC: 0.911908
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.092731    reg_loss: 0.067828    l2_loss: 0.030812    loss: 0.191372
steps 11200    v_Prec: 0.703574  v_Recall: 0.672212  v_F1: 0.687536  v_AUC: 0.906068
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.093055    reg_loss: 0.067975    l2_loss: 0.030930    loss: 0.191960
steps 11400    v_Prec: 0.692955  v_Recall: 0.668630  v_F1: 0.680575  v_AUC: 0.904154
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.096176    reg_loss: 0.067800    l2_loss: 0.031140    loss: 0.195116
steps 11600    v_Prec: 0.695044  v_Recall: 0.656372  v_F1: 0.675155  v_AUC: 0.901377
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.099953    reg_loss: 0.067784    l2_loss: 0.031402    loss: 0.199139
steps 11800    v_Prec: 0.674960  v_Recall: 0.669426  v_F1: 0.672182  v_AUC: 0.899656
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.099508    reg_loss: 0.067730    l2_loss: 0.031509    loss: 0.198746
steps 12000    v_Prec: 0.701762  v_Recall: 0.646740  v_F1: 0.673129  v_AUC: 0.899074
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.098189    reg_loss: 0.067368    l2_loss: 0.031715    loss: 0.197272
steps 12200    v_Prec: 0.680526  v_Recall: 0.663138  v_F1: 0.671719  v_AUC: 0.898654
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.098882    reg_loss: 0.067613    l2_loss: 0.031905    loss: 0.198401
steps 12400    v_Prec: 0.680810  v_Recall: 0.652631  v_F1: 0.666423  v_AUC: 0.895849
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.097258    reg_loss: 0.067501    l2_loss: 0.031978    loss: 0.196737
steps 12600    v_Prec: 0.671724  v_Recall: 0.662581  v_F1: 0.667121  v_AUC: 0.896946
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.097566    reg_loss: 0.067454    l2_loss: 0.032054    loss: 0.197074
steps 12800    v_Prec: 0.673022  v_Recall: 0.657486  v_F1: 0.665163  v_AUC: 0.895920
steps 12800    running time 452 seconds

Early stop model F1: 0.712500
testing thre: 0.4066565
testing Prec: 0.5311011487811712
testing Recall: 0.737010935601458
testing F1: 0.6173387343008936
testing AUC: 0.8921458501724285
overall running time 455 seconds
(0.6784819572517456, 0.6186634264884568, 0.6471934106162294, 0.8921458501724285, 0.6830968)

2019-02-24 17:17:29.277283: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:17:29.995594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:17:29.998738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:17:29.998775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.800000 seconds
loading data in 29.880000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.307055    reg_loss: 0.064600    l2_loss: 0.013303    loss: 1.384959
steps 200    v_Prec: 0.160528  v_Recall: 1.000000  v_F1: 0.276646  v_AUC: 0.482945
steps 200    running time 40 seconds

steps 400    base_loss: 0.759065    reg_loss: 0.064935    l2_loss: 0.013068    loss: 0.837069
steps 400    v_Prec: 0.160526  v_Recall: 1.000000  v_F1: 0.276643  v_AUC: 0.484234
steps 400    running time 46 seconds

steps 600    base_loss: 0.484485    reg_loss: 0.065053    l2_loss: 0.012926    loss: 0.562464
steps 600    v_Prec: 0.160526  v_Recall: 1.000000  v_F1: 0.276643  v_AUC: 0.510968
steps 600    running time 53 seconds

steps 800    base_loss: 0.466909    reg_loss: 0.064999    l2_loss: 0.012715    loss: 0.544623
steps 800    v_Prec: 0.180789  v_Recall: 0.603511  v_F1: 0.278231  v_AUC: 0.565560
steps 800    running time 59 seconds

steps 1000    base_loss: 0.464550    reg_loss: 0.065057    l2_loss: 0.012579    loss: 0.542186
steps 1000    v_Prec: 0.257834  v_Recall: 0.432008  v_F1: 0.322933  v_AUC: 0.628401
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.450486    reg_loss: 0.065109    l2_loss: 0.012392    loss: 0.527986
steps 1200    v_Prec: 0.362967  v_Recall: 0.420792  v_F1: 0.389746  v_AUC: 0.706628
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.419382    reg_loss: 0.065027    l2_loss: 0.012325    loss: 0.496734
steps 1400    v_Prec: 0.457239  v_Recall: 0.454117  v_F1: 0.455672  v_AUC: 0.760629
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.404402    reg_loss: 0.065342    l2_loss: 0.012334    loss: 0.482078
steps 1600    v_Prec: 0.534286  v_Recall: 0.483215  v_F1: 0.507469  v_AUC: 0.795642
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.376350    reg_loss: 0.065684    l2_loss: 0.012486    loss: 0.454520
steps 1800    v_Prec: 0.577054  v_Recall: 0.508575  v_F1: 0.540655  v_AUC: 0.819325
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.356242    reg_loss: 0.066098    l2_loss: 0.012587    loss: 0.434926
steps 2000    v_Prec: 0.582280  v_Recall: 0.553930  v_F1: 0.567751  v_AUC: 0.837289
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.334992    reg_loss: 0.066279    l2_loss: 0.012878    loss: 0.414149
steps 2200    v_Prec: 0.611165  v_Recall: 0.567748  v_F1: 0.588657  v_AUC: 0.848736
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.319406    reg_loss: 0.066684    l2_loss: 0.013280    loss: 0.399370
steps 2400    v_Prec: 0.613838  v_Recall: 0.585548  v_F1: 0.599359  v_AUC: 0.856052
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.310758    reg_loss: 0.066978    l2_loss: 0.013633    loss: 0.391370
steps 2600    v_Prec: 0.655293  v_Recall: 0.579127  v_F1: 0.614860  v_AUC: 0.863986
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.304311    reg_loss: 0.067152    l2_loss: 0.014061    loss: 0.385525
steps 2800    v_Prec: 0.681148  v_Recall: 0.578558  v_F1: 0.625676  v_AUC: 0.869985
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.302303    reg_loss: 0.067506    l2_loss: 0.014490    loss: 0.384299
steps 3000    v_Prec: 0.680964  v_Recall: 0.594896  v_F1: 0.635027  v_AUC: 0.873689
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.292681    reg_loss: 0.067610    l2_loss: 0.014851    loss: 0.375142
steps 3200    v_Prec: 0.665968  v_Recall: 0.620011  v_F1: 0.642169  v_AUC: 0.878212
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.282911    reg_loss: 0.067538    l2_loss: 0.015287    loss: 0.365735
steps 3400    v_Prec: 0.693505  v_Recall: 0.604893  v_F1: 0.646175  v_AUC: 0.882097
steps 3400    running time 145 seconds

steps 3600    base_loss: 0.277778    reg_loss: 0.067522    l2_loss: 0.015722    loss: 0.361022
steps 3600    v_Prec: 0.708223  v_Recall: 0.606275  v_F1: 0.653295  v_AUC: 0.885573
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.283260    reg_loss: 0.067640    l2_loss: 0.016210    loss: 0.367110
steps 3800    v_Prec: 0.706257  v_Recall: 0.612859  v_F1: 0.656251  v_AUC: 0.888058
steps 3800    running time 158 seconds

steps 4000    base_loss: 0.278188    reg_loss: 0.067780    l2_loss: 0.016702    loss: 0.362671
steps 4000    v_Prec: 0.700427  v_Recall: 0.626189  v_F1: 0.661231  v_AUC: 0.891013
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.279688    reg_loss: 0.067557    l2_loss: 0.017219    loss: 0.364463
steps 4200    v_Prec: 0.674405  v_Recall: 0.651711  v_F1: 0.662864  v_AUC: 0.894097
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.269748    reg_loss: 0.067521    l2_loss: 0.017687    loss: 0.354955
steps 4400    v_Prec: 0.672774  v_Recall: 0.662603  v_F1: 0.667649  v_AUC: 0.896211
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.273051    reg_loss: 0.067599    l2_loss: 0.018247    loss: 0.358897
steps 4600    v_Prec: 0.704509  v_Recall: 0.635048  v_F1: 0.667978  v_AUC: 0.896281
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.265882    reg_loss: 0.067448    l2_loss: 0.018921    loss: 0.352251
steps 4800    v_Prec: 0.685385  v_Recall: 0.656750  v_F1: 0.670762  v_AUC: 0.898907
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.273441    reg_loss: 0.067496    l2_loss: 0.019490    loss: 0.360426
steps 5000    v_Prec: 0.710663  v_Recall: 0.633260  v_F1: 0.669733  v_AUC: 0.900423
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.268967    reg_loss: 0.067388    l2_loss: 0.020147    loss: 0.356503
steps 5200    v_Prec: 0.697777  v_Recall: 0.653255  v_F1: 0.674783  v_AUC: 0.900675
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.264616    reg_loss: 0.067639    l2_loss: 0.020768    loss: 0.353023
steps 5400    v_Prec: 0.687058  v_Recall: 0.671869  v_F1: 0.679379  v_AUC: 0.903285
steps 5400    running time 210 seconds

steps 5600    base_loss: 0.176917    reg_loss: 0.067701    l2_loss: 0.021654    loss: 0.266272
steps 5600    v_Prec: 0.684139  v_Recall: 0.656669  v_F1: 0.670123  v_AUC: 0.899051
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.177602    reg_loss: 0.068022    l2_loss: 0.022472    loss: 0.268097
steps 5800    v_Prec: 0.668870  v_Recall: 0.666098  v_F1: 0.667481  v_AUC: 0.896673
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.186159    reg_loss: 0.067760    l2_loss: 0.023228    loss: 0.277148
steps 6000    v_Prec: 0.691151  v_Recall: 0.638625  v_F1: 0.663850  v_AUC: 0.894928
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.185955    reg_loss: 0.067800    l2_loss: 0.023920    loss: 0.277675
steps 6200    v_Prec: 0.686333  v_Recall: 0.651467  v_F1: 0.668446  v_AUC: 0.897364
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.185114    reg_loss: 0.067828    l2_loss: 0.024511    loss: 0.277453
steps 6400    v_Prec: 0.689522  v_Recall: 0.651467  v_F1: 0.669954  v_AUC: 0.896352
steps 6400    running time 242 seconds

steps 6600    base_loss: 0.182717    reg_loss: 0.067806    l2_loss: 0.025065    loss: 0.275587
steps 6600    v_Prec: 0.715657  v_Recall: 0.630090  v_F1: 0.670153  v_AUC: 0.896548
steps 6600    running time 248 seconds

steps 6800    base_loss: 0.182380    reg_loss: 0.067626    l2_loss: 0.025651    loss: 0.275657
steps 6800    v_Prec: 0.704234  v_Recall: 0.643502  v_F1: 0.672499  v_AUC: 0.895957
steps 6800    running time 254 seconds

steps 7000    base_loss: 0.185697    reg_loss: 0.067601    l2_loss: 0.026061    loss: 0.279359
steps 7000    v_Prec: 0.706116  v_Recall: 0.651305  v_F1: 0.677603  v_AUC: 0.899232
steps 7000    running time 260 seconds

steps 7200    base_loss: 0.196802    reg_loss: 0.067549    l2_loss: 0.026547    loss: 0.290899
steps 7200    v_Prec: 0.693541  v_Recall: 0.653743  v_F1: 0.673054  v_AUC: 0.899713
steps 7200    running time 266 seconds

steps 7400    base_loss: 0.191733    reg_loss: 0.067404    l2_loss: 0.026861    loss: 0.285998
steps 7400    v_Prec: 0.724424  v_Recall: 0.646346  v_F1: 0.683162  v_AUC: 0.902818
steps 7400    running time 272 seconds

steps 7600    base_loss: 0.191742    reg_loss: 0.067400    l2_loss: 0.027311    loss: 0.286453
steps 7600    v_Prec: 0.707936  v_Recall: 0.664147  v_F1: 0.685343  v_AUC: 0.903957
steps 7600    running time 279 seconds

steps 7800    base_loss: 0.184284    reg_loss: 0.067369    l2_loss: 0.027574    loss: 0.279226
steps 7800    v_Prec: 0.697724  v_Recall: 0.670162  v_F1: 0.683665  v_AUC: 0.903928
steps 7800    running time 286 seconds

steps 8000    base_loss: 0.192002    reg_loss: 0.067368    l2_loss: 0.027924    loss: 0.287295
steps 8000    v_Prec: 0.687339  v_Recall: 0.692758  v_F1: 0.690038  v_AUC: 0.906176
steps 8000    running time 291 seconds

steps 8200    base_loss: 0.193340    reg_loss: 0.067387    l2_loss: 0.028276    loss: 0.289004
steps 8200    v_Prec: 0.748112  v_Recall: 0.644314  v_F1: 0.692345  v_AUC: 0.907290
steps 8200    running time 298 seconds

steps 8400    base_loss: 0.192232    reg_loss: 0.067255    l2_loss: 0.028620    loss: 0.288106
steps 8400    v_Prec: 0.730332  v_Recall: 0.657970  v_F1: 0.692265  v_AUC: 0.906477
steps 8400    running time 305 seconds

steps 8600    base_loss: 0.199990    reg_loss: 0.067334    l2_loss: 0.028942    loss: 0.296266
steps 8600    v_Prec: 0.730084  v_Recall: 0.669674  v_F1: 0.698576  v_AUC: 0.909777
steps 8600    running time 311 seconds

steps 8800    base_loss: 0.195148    reg_loss: 0.067319    l2_loss: 0.029065    loss: 0.291531
steps 8800    v_Prec: 0.725651  v_Recall: 0.681297  v_F1: 0.702775  v_AUC: 0.912336
steps 8800    running time 318 seconds

steps 9000    base_loss: 0.185900    reg_loss: 0.067172    l2_loss: 0.029456    loss: 0.282529
steps 9000    v_Prec: 0.741776  v_Recall: 0.668943  v_F1: 0.703479  v_AUC: 0.913942
steps 9000    running time 325 seconds

steps 9200    base_loss: 0.184860    reg_loss: 0.067054    l2_loss: 0.029597    loss: 0.281510
steps 9200    v_Prec: 0.749612  v_Recall: 0.666748  v_F1: 0.705756  v_AUC: 0.913230
steps 9200    running time 331 seconds

steps 9400    base_loss: 0.183023    reg_loss: 0.066990    l2_loss: 0.029847    loss: 0.279861
steps 9400    v_Prec: 0.752523  v_Recall: 0.666585  v_F1: 0.706952  v_AUC: 0.915062
steps 9400    running time 338 seconds

steps 9600    base_loss: 0.190009    reg_loss: 0.066954    l2_loss: 0.030264    loss: 0.287227
steps 9600    v_Prec: 0.749707  v_Recall: 0.675608  v_F1: 0.710731  v_AUC: 0.916751
steps 9600    running time 344 seconds

steps 9800    base_loss: 0.186179    reg_loss: 0.066797    l2_loss: 0.030415    loss: 0.283390
steps 9800    v_Prec: 0.752911  v_Recall: 0.677883  v_F1: 0.713430  v_AUC: 0.918323
steps 9800    running time 351 seconds

steps 10000    base_loss: 0.191639    reg_loss: 0.066884    l2_loss: 0.030663    loss: 0.289185
steps 10000    v_Prec: 0.746987  v_Recall: 0.685117  v_F1: 0.714716  v_AUC: 0.917428
steps 10000    running time 357 seconds

steps 10200    base_loss: 0.186366    reg_loss: 0.066941    l2_loss: 0.030759    loss: 0.284066
steps 10200    v_Prec: 0.737598  v_Recall: 0.697310  v_F1: 0.716888  v_AUC: 0.919842
steps 10200    running time 364 seconds

steps 10400    base_loss: 0.188154    reg_loss: 0.066829    l2_loss: 0.031035    loss: 0.286017
steps 10400    v_Prec: 0.752808  v_Recall: 0.691864  v_F1: 0.721050  v_AUC: 0.922496
steps 10400    running time 371 seconds

steps 10600    base_loss: 0.187784    reg_loss: 0.066816    l2_loss: 0.031183    loss: 0.285783
steps 10600    v_Prec: 0.748980  v_Recall: 0.701374  v_F1: 0.724396  v_AUC: 0.923090
steps 10600    running time 377 seconds

steps 10800    base_loss: 0.174261    reg_loss: 0.066479    l2_loss: 0.031335    loss: 0.272075
steps 10800    v_Prec: 0.765033  v_Recall: 0.692839  v_F1: 0.727149  v_AUC: 0.923306
steps 10800    running time 384 seconds

steps 11000    base_loss: 0.081409    reg_loss: 0.065709    l2_loss: 0.031502    loss: 0.178620
steps 11000    v_Prec: 0.742484  v_Recall: 0.688531  v_F1: 0.714491  v_AUC: 0.916812
steps 11000    running time 391 seconds

steps 11200    base_loss: 0.081559    reg_loss: 0.065947    l2_loss: 0.031488    loss: 0.178994
steps 11200    v_Prec: 0.750318  v_Recall: 0.672194  v_F1: 0.709110  v_AUC: 0.912264
steps 11200    running time 397 seconds

steps 11400    base_loss: 0.083026    reg_loss: 0.065459    l2_loss: 0.031676    loss: 0.180162
steps 11400    v_Prec: 0.722385  v_Recall: 0.680403  v_F1: 0.700766  v_AUC: 0.908765
steps 11400    running time 403 seconds

steps 11600    base_loss: 0.078826    reg_loss: 0.065592    l2_loss: 0.031946    loss: 0.176364
steps 11600    v_Prec: 0.728866  v_Recall: 0.676258  v_F1: 0.701577  v_AUC: 0.908303
steps 11600    running time 409 seconds

steps 11800    base_loss: 0.074524    reg_loss: 0.065447    l2_loss: 0.031891    loss: 0.171862
steps 11800    v_Prec: 0.720704  v_Recall: 0.675364  v_F1: 0.697298  v_AUC: 0.907026
steps 11800    running time 415 seconds

steps 12000    base_loss: 0.086045    reg_loss: 0.065355    l2_loss: 0.032076    loss: 0.183476
steps 12000    v_Prec: 0.722075  v_Recall: 0.664147  v_F1: 0.691901  v_AUC: 0.904966
steps 12000    running time 421 seconds

steps 12200    base_loss: 0.085573    reg_loss: 0.065149    l2_loss: 0.032262    loss: 0.182984
steps 12200    v_Prec: 0.718898  v_Recall: 0.664147  v_F1: 0.690439  v_AUC: 0.904229
steps 12200    running time 427 seconds

steps 12400    base_loss: 0.083506    reg_loss: 0.065293    l2_loss: 0.032312    loss: 0.181112
steps 12400    v_Prec: 0.722872  v_Recall: 0.667642  v_F1: 0.694160  v_AUC: 0.905282
steps 12400    running time 433 seconds

steps 12600    base_loss: 0.092997    reg_loss: 0.065103    l2_loss: 0.032455    loss: 0.190555
steps 12600    v_Prec: 0.722957  v_Recall: 0.653499  v_F1: 0.686475  v_AUC: 0.902569
steps 12600    running time 440 seconds

steps 12800    base_loss: 0.095938    reg_loss: 0.065331    l2_loss: 0.032659    loss: 0.193928
steps 12800    v_Prec: 0.707137  v_Recall: 0.676502  v_F1: 0.691480  v_AUC: 0.905772
steps 12800    running time 446 seconds

Early stop model F1: 0.727149
testing thre: 0.45200276
testing Prec: 0.5542288191637886
testing Recall: 0.7331713244228433
testing F1: 0.6312639926349047
testing AUC: 0.8989147098246717
overall running time 449 seconds
(0.7115631811322863, 0.6188092345078979, 0.6619527919309557, 0.8989147098246717, 0.7485892)

2019-02-24 17:22:23.048159: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:22:23.918186: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:22:23.919103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:22:23.919139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.570000 seconds
loading data in 30.620000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.893643    reg_loss: 0.065094    l2_loss: 0.013311    loss: 0.972049
steps 200    v_Prec: 0.162413  v_Recall: 1.000000  v_F1: 0.279441  v_AUC: 0.481404
steps 200    running time 40 seconds

steps 400    base_loss: 0.642496    reg_loss: 0.065280    l2_loss: 0.013085    loss: 0.720861
steps 400    v_Prec: 0.162415  v_Recall: 1.000000  v_F1: 0.279444  v_AUC: 0.495551
steps 400    running time 47 seconds

steps 600    base_loss: 0.501673    reg_loss: 0.065549    l2_loss: 0.012874    loss: 0.580097
steps 600    v_Prec: 0.163408  v_Recall: 0.977746  v_F1: 0.280018  v_AUC: 0.535657
steps 600    running time 54 seconds

steps 800    base_loss: 0.468711    reg_loss: 0.065583    l2_loss: 0.012661    loss: 0.546956
steps 800    v_Prec: 0.189871  v_Recall: 0.632522  v_F1: 0.292069  v_AUC: 0.584933
steps 800    running time 61 seconds

steps 1000    base_loss: 0.460368    reg_loss: 0.065514    l2_loss: 0.012398    loss: 0.538280
steps 1000    v_Prec: 0.232387  v_Recall: 0.528963  v_F1: 0.322911  v_AUC: 0.638315
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.434506    reg_loss: 0.065397    l2_loss: 0.012246    loss: 0.512149
steps 1200    v_Prec: 0.362507  v_Recall: 0.438258  v_F1: 0.396799  v_AUC: 0.722069
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.410924    reg_loss: 0.065373    l2_loss: 0.012178    loss: 0.488475
steps 1400    v_Prec: 0.459894  v_Recall: 0.516831  v_F1: 0.486703  v_AUC: 0.788639
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.367709    reg_loss: 0.065240    l2_loss: 0.012250    loss: 0.445199
steps 1600    v_Prec: 0.571262  v_Recall: 0.512975  v_F1: 0.540552  v_AUC: 0.822523
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.338649    reg_loss: 0.065244    l2_loss: 0.012359    loss: 0.416252
steps 1800    v_Prec: 0.603110  v_Recall: 0.545352  v_F1: 0.572779  v_AUC: 0.841634
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.314683    reg_loss: 0.065254    l2_loss: 0.012638    loss: 0.392575
steps 2000    v_Prec: 0.618945  v_Recall: 0.574837  v_F1: 0.596076  v_AUC: 0.855218
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.314167    reg_loss: 0.065868    l2_loss: 0.012923    loss: 0.392957
steps 2200    v_Prec: 0.635587  v_Recall: 0.586005  v_F1: 0.609790  v_AUC: 0.865684
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.301231    reg_loss: 0.066109    l2_loss: 0.013234    loss: 0.380574
steps 2400    v_Prec: 0.659675  v_Recall: 0.596288  v_F1: 0.626382  v_AUC: 0.871763
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.290248    reg_loss: 0.066384    l2_loss: 0.013639    loss: 0.370271
steps 2600    v_Prec: 0.675595  v_Recall: 0.597815  v_F1: 0.634329  v_AUC: 0.877685
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.291025    reg_loss: 0.066546    l2_loss: 0.013954    loss: 0.371524
steps 2800    v_Prec: 0.663245  v_Recall: 0.617739  v_F1: 0.639684  v_AUC: 0.881426
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.292924    reg_loss: 0.066650    l2_loss: 0.014293    loss: 0.373868
steps 3000    v_Prec: 0.662229  v_Recall: 0.631477  v_F1: 0.646488  v_AUC: 0.885778
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.283304    reg_loss: 0.066719    l2_loss: 0.014667    loss: 0.364689
steps 3200    v_Prec: 0.666526  v_Recall: 0.633004  v_F1: 0.649332  v_AUC: 0.888024
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.279712    reg_loss: 0.066823    l2_loss: 0.015077    loss: 0.361612
steps 3400    v_Prec: 0.698049  v_Recall: 0.612356  v_F1: 0.652401  v_AUC: 0.890985
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.279150    reg_loss: 0.066740    l2_loss: 0.015432    loss: 0.361323
steps 3600    v_Prec: 0.687632  v_Recall: 0.628907  v_F1: 0.656959  v_AUC: 0.892221
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.286073    reg_loss: 0.066882    l2_loss: 0.015864    loss: 0.368820
steps 3800    v_Prec: 0.689904  v_Recall: 0.636860  v_F1: 0.662322  v_AUC: 0.895409
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.270992    reg_loss: 0.066894    l2_loss: 0.016348    loss: 0.354235
steps 4000    v_Prec: 0.669143  v_Recall: 0.658392  v_F1: 0.663724  v_AUC: 0.896920
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.276006    reg_loss: 0.067111    l2_loss: 0.016773    loss: 0.359890
steps 4200    v_Prec: 0.682458  v_Recall: 0.650438  v_F1: 0.666063  v_AUC: 0.898465
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.271136    reg_loss: 0.066872    l2_loss: 0.017262    loss: 0.355270
steps 4400    v_Prec: 0.669540  v_Recall: 0.661525  v_F1: 0.665508  v_AUC: 0.899565
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.269178    reg_loss: 0.066956    l2_loss: 0.017803    loss: 0.353937
steps 4600    v_Prec: 0.688866  v_Recall: 0.653169  v_F1: 0.670543  v_AUC: 0.902181
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.263160    reg_loss: 0.066766    l2_loss: 0.018402    loss: 0.348328
steps 4800    v_Prec: 0.694401  v_Recall: 0.647706  v_F1: 0.670242  v_AUC: 0.903459
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.275810    reg_loss: 0.067146    l2_loss: 0.019017    loss: 0.361973
steps 5000    v_Prec: 0.683071  v_Recall: 0.669077  v_F1: 0.676001  v_AUC: 0.905640
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.271740    reg_loss: 0.066962    l2_loss: 0.019652    loss: 0.358354
steps 5200    v_Prec: 0.678035  v_Recall: 0.670844  v_F1: 0.674420  v_AUC: 0.904798
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.258403    reg_loss: 0.066964    l2_loss: 0.020267    loss: 0.345634
steps 5400    v_Prec: 0.691043  v_Recall: 0.668836  v_F1: 0.679758  v_AUC: 0.906552
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.172222    reg_loss: 0.067356    l2_loss: 0.021097    loss: 0.260675
steps 5600    v_Prec: 0.693429  v_Recall: 0.649474  v_F1: 0.670732  v_AUC: 0.900512
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.178547    reg_loss: 0.067608    l2_loss: 0.021878    loss: 0.268033
steps 5800    v_Prec: 0.681513  v_Recall: 0.660159  v_F1: 0.670666  v_AUC: 0.899101
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.181382    reg_loss: 0.067553    l2_loss: 0.022611    loss: 0.271546
steps 6000    v_Prec: 0.717170  v_Recall: 0.639271  v_F1: 0.675983  v_AUC: 0.899096
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.182940    reg_loss: 0.067357    l2_loss: 0.023281    loss: 0.273578
steps 6200    v_Prec: 0.714816  v_Recall: 0.633727  v_F1: 0.671834  v_AUC: 0.897823
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.196995    reg_loss: 0.067596    l2_loss: 0.023855    loss: 0.288446
steps 6400    v_Prec: 0.710157  v_Recall: 0.641520  v_F1: 0.674096  v_AUC: 0.900214
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.191047    reg_loss: 0.067409    l2_loss: 0.024484    loss: 0.282940
steps 6600    v_Prec: 0.705980  v_Recall: 0.648751  v_F1: 0.676157  v_AUC: 0.899990
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.191270    reg_loss: 0.067286    l2_loss: 0.025062    loss: 0.283618
steps 6800    v_Prec: 0.688338  v_Recall: 0.664337  v_F1: 0.676124  v_AUC: 0.901842
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.183229    reg_loss: 0.067403    l2_loss: 0.025550    loss: 0.276182
steps 7000    v_Prec: 0.710843  v_Recall: 0.654134  v_F1: 0.681310  v_AUC: 0.902835
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.187490    reg_loss: 0.067381    l2_loss: 0.025907    loss: 0.280778
steps 7200    v_Prec: 0.714324  v_Recall: 0.650277  v_F1: 0.680797  v_AUC: 0.902153
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.189182    reg_loss: 0.067303    l2_loss: 0.026270    loss: 0.282755
steps 7400    v_Prec: 0.698824  v_Recall: 0.668113  v_F1: 0.683123  v_AUC: 0.904186
steps 7400    running time 275 seconds

steps 7600    base_loss: 0.188225    reg_loss: 0.067440    l2_loss: 0.026843    loss: 0.282508
steps 7600    v_Prec: 0.703794  v_Recall: 0.673656  v_F1: 0.688395  v_AUC: 0.905956
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.185618    reg_loss: 0.067301    l2_loss: 0.027042    loss: 0.279961
steps 7800    v_Prec: 0.718813  v_Recall: 0.663373  v_F1: 0.689981  v_AUC: 0.906250
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.186010    reg_loss: 0.067397    l2_loss: 0.027376    loss: 0.280783
steps 8000    v_Prec: 0.727232  v_Recall: 0.658874  v_F1: 0.691367  v_AUC: 0.906164
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.182201    reg_loss: 0.067195    l2_loss: 0.027709    loss: 0.277105
steps 8200    v_Prec: 0.714468  v_Recall: 0.675263  v_F1: 0.694313  v_AUC: 0.907898
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.187186    reg_loss: 0.067099    l2_loss: 0.027967    loss: 0.282252
steps 8400    v_Prec: 0.729965  v_Recall: 0.673255  v_F1: 0.700464  v_AUC: 0.909515
steps 8400    running time 308 seconds

steps 8600    base_loss: 0.189397    reg_loss: 0.067122    l2_loss: 0.028302    loss: 0.284820
steps 8600    v_Prec: 0.724916  v_Recall: 0.678557  v_F1: 0.700971  v_AUC: 0.911620
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.188254    reg_loss: 0.067010    l2_loss: 0.028485    loss: 0.283749
steps 8800    v_Prec: 0.721703  v_Recall: 0.682333  v_F1: 0.701466  v_AUC: 0.911288
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.183440    reg_loss: 0.067171    l2_loss: 0.028847    loss: 0.279459
steps 9000    v_Prec: 0.742635  v_Recall: 0.676468  v_F1: 0.708009  v_AUC: 0.914424
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.192889    reg_loss: 0.067168    l2_loss: 0.029263    loss: 0.289321
steps 9200    v_Prec: 0.745056  v_Recall: 0.671969  v_F1: 0.706628  v_AUC: 0.915046
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.189030    reg_loss: 0.066812    l2_loss: 0.029331    loss: 0.285174
steps 9400    v_Prec: 0.729580  v_Recall: 0.686029  v_F1: 0.707134  v_AUC: 0.915841
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.191331    reg_loss: 0.066966    l2_loss: 0.029637    loss: 0.287935
steps 9600    v_Prec: 0.733350  v_Recall: 0.691813  v_F1: 0.711977  v_AUC: 0.916376
steps 9600    running time 347 seconds

steps 9800    base_loss: 0.188904    reg_loss: 0.066791    l2_loss: 0.029846    loss: 0.285542
steps 9800    v_Prec: 0.735159  v_Recall: 0.696473  v_F1: 0.715294  v_AUC: 0.918661
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.192715    reg_loss: 0.066863    l2_loss: 0.029970    loss: 0.289548
steps 10000    v_Prec: 0.739523  v_Recall: 0.704587  v_F1: 0.721633  v_AUC: 0.921079
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.186662    reg_loss: 0.066846    l2_loss: 0.030313    loss: 0.283822
steps 10200    v_Prec: 0.753679  v_Recall: 0.691251  v_F1: 0.721116  v_AUC: 0.921741
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.186078    reg_loss: 0.066518    l2_loss: 0.030392    loss: 0.282988
steps 10400    v_Prec: 0.738791  v_Recall: 0.700329  v_F1: 0.719046  v_AUC: 0.921987
steps 10400    running time 372 seconds

steps 10600    base_loss: 0.188307    reg_loss: 0.066651    l2_loss: 0.030580    loss: 0.285537
steps 10600    v_Prec: 0.751844  v_Recall: 0.695911  v_F1: 0.722797  v_AUC: 0.923166
steps 10600    running time 378 seconds

steps 10800    base_loss: 0.179648    reg_loss: 0.066609    l2_loss: 0.030752    loss: 0.277009
steps 10800    v_Prec: 0.766891  v_Recall: 0.694866  v_F1: 0.729104  v_AUC: 0.923407
steps 10800    running time 385 seconds

steps 11000    base_loss: 0.079670    reg_loss: 0.065912    l2_loss: 0.031054    loss: 0.176636
steps 11000    v_Prec: 0.729275  v_Recall: 0.699687  v_F1: 0.714174  v_AUC: 0.916647
steps 11000    running time 392 seconds

steps 11200    base_loss: 0.073966    reg_loss: 0.065723    l2_loss: 0.031044    loss: 0.170732
steps 11200    v_Prec: 0.743206  v_Recall: 0.678959  v_F1: 0.709631  v_AUC: 0.911867
steps 11200    running time 398 seconds

steps 11400    base_loss: 0.075034    reg_loss: 0.065934    l2_loss: 0.031198    loss: 0.172166
steps 11400    v_Prec: 0.734408  v_Recall: 0.669800  v_F1: 0.700618  v_AUC: 0.909347
steps 11400    running time 404 seconds

steps 11600    base_loss: 0.082551    reg_loss: 0.065418    l2_loss: 0.031298    loss: 0.179267
steps 11600    v_Prec: 0.714880  v_Recall: 0.677031  v_F1: 0.695440  v_AUC: 0.904986
steps 11600    running time 410 seconds

steps 11800    base_loss: 0.084987    reg_loss: 0.065443    l2_loss: 0.031473    loss: 0.181903
steps 11800    v_Prec: 0.729405  v_Recall: 0.654455  v_F1: 0.689900  v_AUC: 0.903826
steps 11800    running time 416 seconds

steps 12000    base_loss: 0.081827    reg_loss: 0.065493    l2_loss: 0.031530    loss: 0.178849
steps 12000    v_Prec: 0.726336  v_Recall: 0.657186  v_F1: 0.690033  v_AUC: 0.902272
steps 12000    running time 422 seconds

steps 12200    base_loss: 0.082470    reg_loss: 0.065618    l2_loss: 0.031635    loss: 0.179722
steps 12200    v_Prec: 0.688805  v_Recall: 0.689082  v_F1: 0.688943  v_AUC: 0.903961
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.087926    reg_loss: 0.065677    l2_loss: 0.031821    loss: 0.185424
steps 12400    v_Prec: 0.721410  v_Recall: 0.665944  v_F1: 0.692568  v_AUC: 0.905395
steps 12400    running time 434 seconds

steps 12600    base_loss: 0.087871    reg_loss: 0.065404    l2_loss: 0.031935    loss: 0.185210
steps 12600    v_Prec: 0.697741  v_Recall: 0.682494  v_F1: 0.690033  v_AUC: 0.902885
steps 12600    running time 440 seconds

steps 12800    base_loss: 0.087126    reg_loss: 0.065588    l2_loss: 0.032123    loss: 0.184838
steps 12800    v_Prec: 0.722212  v_Recall: 0.648349  v_F1: 0.683290  v_AUC: 0.901453
steps 12800    running time 446 seconds

Early stop model F1: 0.729104
testing thre: 0.3962713
testing Prec: 0.5571961113953658
testing Recall: 0.740996354799514
testing F1: 0.6360848613805621
testing AUC: 0.8983537796020138
overall running time 449 seconds
(0.7048387096774194, 0.6159416767922236, 0.6573985215925301, 0.8983537796020138, 0.71467173)

2019-02-24 17:27:16.750543: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:27:17.665042: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:27:17.671601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:27:17.671655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.520000 seconds
loading data in 30.750000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.629016    reg_loss: 0.065174    l2_loss: 0.013337    loss: 0.707527
steps 200    v_Prec: 0.162593  v_Recall: 1.000000  v_F1: 0.279708  v_AUC: 0.502052
steps 200    running time 41 seconds

steps 400    base_loss: 0.514410    reg_loss: 0.064841    l2_loss: 0.013374    loss: 0.592624
steps 400    v_Prec: 0.162649  v_Recall: 0.999438  v_F1: 0.279768  v_AUC: 0.515649
steps 400    running time 48 seconds

steps 600    base_loss: 0.493008    reg_loss: 0.064748    l2_loss: 0.013254    loss: 0.571009
steps 600    v_Prec: 0.176437  v_Recall: 0.786213  v_F1: 0.288198  v_AUC: 0.560468
steps 600    running time 54 seconds

steps 800    base_loss: 0.466359    reg_loss: 0.064230    l2_loss: 0.013012    loss: 0.543601
steps 800    v_Prec: 0.214476  v_Recall: 0.554289  v_F1: 0.309280  v_AUC: 0.614589
steps 800    running time 61 seconds

steps 1000    base_loss: 0.438712    reg_loss: 0.063527    l2_loss: 0.012802    loss: 0.515041
steps 1000    v_Prec: 0.267998  v_Recall: 0.489046  v_F1: 0.346250  v_AUC: 0.662146
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.443276    reg_loss: 0.063194    l2_loss: 0.012693    loss: 0.519162
steps 1200    v_Prec: 0.345314  v_Recall: 0.441778  v_F1: 0.387635  v_AUC: 0.698611
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.415677    reg_loss: 0.062384    l2_loss: 0.012674    loss: 0.490735
steps 1400    v_Prec: 0.420294  v_Recall: 0.444748  v_F1: 0.432175  v_AUC: 0.734155
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.394155    reg_loss: 0.061948    l2_loss: 0.012672    loss: 0.468775
steps 1600    v_Prec: 0.430911  v_Recall: 0.502528  v_F1: 0.463972  v_AUC: 0.760837
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.378466    reg_loss: 0.061604    l2_loss: 0.012770    loss: 0.452841
steps 1800    v_Prec: 0.491165  v_Recall: 0.501886  v_F1: 0.496467  v_AUC: 0.784092
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.361846    reg_loss: 0.061280    l2_loss: 0.012849    loss: 0.435976
steps 2000    v_Prec: 0.495594  v_Recall: 0.546104  v_F1: 0.519624  v_AUC: 0.801488
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.358426    reg_loss: 0.061053    l2_loss: 0.013025    loss: 0.432504
steps 2200    v_Prec: 0.512076  v_Recall: 0.564882  v_F1: 0.537185  v_AUC: 0.814674
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.350462    reg_loss: 0.060656    l2_loss: 0.013231    loss: 0.424349
steps 2400    v_Prec: 0.538379  v_Recall: 0.564000  v_F1: 0.550892  v_AUC: 0.827025
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.339323    reg_loss: 0.060486    l2_loss: 0.013532    loss: 0.413342
steps 2600    v_Prec: 0.558469  v_Recall: 0.565685  v_F1: 0.562054  v_AUC: 0.838286
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.326600    reg_loss: 0.059963    l2_loss: 0.013970    loss: 0.400532
steps 2800    v_Prec: 0.545735  v_Recall: 0.597063  v_F1: 0.570246  v_AUC: 0.846695
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.324129    reg_loss: 0.059763    l2_loss: 0.014439    loss: 0.398332
steps 3000    v_Prec: 0.566898  v_Recall: 0.589600  v_F1: 0.578026  v_AUC: 0.852393
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.314877    reg_loss: 0.059573    l2_loss: 0.015096    loss: 0.389546
steps 3200    v_Prec: 0.573532  v_Recall: 0.587754  v_F1: 0.580556  v_AUC: 0.855968
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.323435    reg_loss: 0.059380    l2_loss: 0.015789    loss: 0.398604
steps 3400    v_Prec: 0.557671  v_Recall: 0.620416  v_F1: 0.587373  v_AUC: 0.858954
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.315347    reg_loss: 0.058839    l2_loss: 0.016435    loss: 0.390620
steps 3600    v_Prec: 0.561370  v_Recall: 0.620656  v_F1: 0.589527  v_AUC: 0.862813
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.316398    reg_loss: 0.058403    l2_loss: 0.017129    loss: 0.391931
steps 3800    v_Prec: 0.578289  v_Recall: 0.619453  v_F1: 0.598163  v_AUC: 0.865853
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.315083    reg_loss: 0.058013    l2_loss: 0.017823    loss: 0.390918
steps 4000    v_Prec: 0.588081  v_Recall: 0.611347  v_F1: 0.599488  v_AUC: 0.868282
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.306013    reg_loss: 0.057484    l2_loss: 0.018551    loss: 0.382048
steps 4200    v_Prec: 0.601282  v_Recall: 0.609582  v_F1: 0.605404  v_AUC: 0.870737
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.306189    reg_loss: 0.056992    l2_loss: 0.019369    loss: 0.382550
steps 4400    v_Prec: 0.578145  v_Recall: 0.648343  v_F1: 0.611235  v_AUC: 0.873695
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.312186    reg_loss: 0.056485    l2_loss: 0.020154    loss: 0.388824
steps 4600    v_Prec: 0.608436  v_Recall: 0.620496  v_F1: 0.614407  v_AUC: 0.876026
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.305152    reg_loss: 0.056009    l2_loss: 0.021015    loss: 0.382177
steps 4800    v_Prec: 0.619787  v_Recall: 0.615360  v_F1: 0.617565  v_AUC: 0.877317
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.298857    reg_loss: 0.055335    l2_loss: 0.021794    loss: 0.375985
steps 5000    v_Prec: 0.609548  v_Recall: 0.626033  v_F1: 0.617681  v_AUC: 0.876784
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.306573    reg_loss: 0.054902    l2_loss: 0.022594    loss: 0.384069
steps 5200    v_Prec: 0.626367  v_Recall: 0.611187  v_F1: 0.618684  v_AUC: 0.878445
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.306977    reg_loss: 0.054783    l2_loss: 0.023450    loss: 0.385210
steps 5400    v_Prec: 0.610246  v_Recall: 0.638552  v_F1: 0.624078  v_AUC: 0.882704
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.179747    reg_loss: 0.056909    l2_loss: 0.024286    loss: 0.260942
steps 5600    v_Prec: 0.588153  v_Recall: 0.642244  v_F1: 0.614010  v_AUC: 0.875947
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.179340    reg_loss: 0.057319    l2_loss: 0.024724    loss: 0.261382
steps 5800    v_Prec: 0.593831  v_Recall: 0.625712  v_F1: 0.609355  v_AUC: 0.873332
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.168250    reg_loss: 0.058073    l2_loss: 0.025121    loss: 0.251443
steps 6000    v_Prec: 0.592172  v_Recall: 0.615601  v_F1: 0.603659  v_AUC: 0.868366
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.169691    reg_loss: 0.058179    l2_loss: 0.025616    loss: 0.253487
steps 6200    v_Prec: 0.584326  v_Recall: 0.622261  v_F1: 0.602697  v_AUC: 0.868287
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.186173    reg_loss: 0.058294    l2_loss: 0.026179    loss: 0.270646
steps 6400    v_Prec: 0.564323  v_Recall: 0.638231  v_F1: 0.599006  v_AUC: 0.866712
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.194974    reg_loss: 0.057894    l2_loss: 0.026711    loss: 0.279579
steps 6600    v_Prec: 0.571936  v_Recall: 0.632614  v_F1: 0.600747  v_AUC: 0.868386
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.185478    reg_loss: 0.057813    l2_loss: 0.027141    loss: 0.270432
steps 6800    v_Prec: 0.563481  v_Recall: 0.654281  v_F1: 0.605496  v_AUC: 0.871803
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.184739    reg_loss: 0.057833    l2_loss: 0.027565    loss: 0.270137
steps 7000    v_Prec: 0.558680  v_Recall: 0.652115  v_F1: 0.601792  v_AUC: 0.869213
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.192075    reg_loss: 0.057366    l2_loss: 0.027915    loss: 0.277356
steps 7200    v_Prec: 0.578544  v_Recall: 0.636626  v_F1: 0.606197  v_AUC: 0.872037
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.187043    reg_loss: 0.057015    l2_loss: 0.028230    loss: 0.272288
steps 7400    v_Prec: 0.597213  v_Recall: 0.622422  v_F1: 0.609557  v_AUC: 0.873050
steps 7400    running time 275 seconds

Early stop model F1: 0.624078
testing thre: 0.39190155
testing Prec: 0.43197079885201595
testing Recall: 0.753487241798299
testing F1: 0.5491286483423067
testing AUC: 0.8638209371266024
overall running time 278 seconds
(0.5908408771844895, 0.5931956257594168, 0.5920159099728365, 0.8638209371266024, 0.6232801)

2019-02-24 17:30:24.115621: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:30:25.382695: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:30:25.384173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:30:25.384210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.740000 seconds
loading data in 30.930000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.750479    reg_loss: 0.064863    l2_loss: 0.013308    loss: 0.828651
steps 200    v_Prec: 0.162837  v_Recall: 1.000000  v_F1: 0.280069  v_AUC: 0.515977
steps 200    running time 41 seconds

steps 400    base_loss: 0.558812    reg_loss: 0.064665    l2_loss: 0.013136    loss: 0.636613
steps 400    v_Prec: 0.167123  v_Recall: 0.894872  v_F1: 0.281647  v_AUC: 0.541783
steps 400    running time 47 seconds

steps 600    base_loss: 0.494581    reg_loss: 0.064522    l2_loss: 0.012913    loss: 0.572016
steps 600    v_Prec: 0.188871  v_Recall: 0.662260  v_F1: 0.293919  v_AUC: 0.579590
steps 600    running time 54 seconds

steps 800    base_loss: 0.468949    reg_loss: 0.064137    l2_loss: 0.012739    loss: 0.545825
steps 800    v_Prec: 0.209092  v_Recall: 0.621394  v_F1: 0.312897  v_AUC: 0.619978
steps 800    running time 61 seconds

steps 1000    base_loss: 0.449599    reg_loss: 0.063971    l2_loss: 0.012536    loss: 0.526107
steps 1000    v_Prec: 0.279154  v_Recall: 0.471474  v_F1: 0.350676  v_AUC: 0.666523
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.430317    reg_loss: 0.063808    l2_loss: 0.012471    loss: 0.506597
steps 1200    v_Prec: 0.408401  v_Recall: 0.435497  v_F1: 0.421514  v_AUC: 0.729383
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.402640    reg_loss: 0.063623    l2_loss: 0.012424    loss: 0.478687
steps 1400    v_Prec: 0.521071  v_Recall: 0.442869  v_F1: 0.478798  v_AUC: 0.775960
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.378409    reg_loss: 0.064010    l2_loss: 0.012455    loss: 0.454874
steps 1600    v_Prec: 0.497481  v_Recall: 0.545913  v_F1: 0.520573  v_AUC: 0.806439
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.353818    reg_loss: 0.064753    l2_loss: 0.012596    loss: 0.431167
steps 1800    v_Prec: 0.561500  v_Recall: 0.534054  v_F1: 0.547433  v_AUC: 0.825774
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.333516    reg_loss: 0.065100    l2_loss: 0.012796    loss: 0.411412
steps 2000    v_Prec: 0.577511  v_Recall: 0.569551  v_F1: 0.573503  v_AUC: 0.840797
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.326138    reg_loss: 0.065632    l2_loss: 0.013032    loss: 0.404802
steps 2200    v_Prec: 0.623690  v_Recall: 0.562821  v_F1: 0.591694  v_AUC: 0.850539
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.316329    reg_loss: 0.065969    l2_loss: 0.013321    loss: 0.395619
steps 2400    v_Prec: 0.629499  v_Recall: 0.584455  v_F1: 0.606141  v_AUC: 0.859435
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.313116    reg_loss: 0.066364    l2_loss: 0.013622    loss: 0.393102
steps 2600    v_Prec: 0.635462  v_Recall: 0.595593  v_F1: 0.614882  v_AUC: 0.867442
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.306058    reg_loss: 0.066719    l2_loss: 0.013931    loss: 0.386708
steps 2800    v_Prec: 0.658828  v_Recall: 0.592628  v_F1: 0.623977  v_AUC: 0.871794
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.299433    reg_loss: 0.066835    l2_loss: 0.014270    loss: 0.380537
steps 3000    v_Prec: 0.648034  v_Recall: 0.614022  v_F1: 0.630570  v_AUC: 0.876515
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.295765    reg_loss: 0.066900    l2_loss: 0.014619    loss: 0.377284
steps 3200    v_Prec: 0.684682  v_Recall: 0.593830  v_F1: 0.636028  v_AUC: 0.880755
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.288519    reg_loss: 0.066887    l2_loss: 0.014980    loss: 0.370387
steps 3400    v_Prec: 0.685423  v_Recall: 0.608093  v_F1: 0.644446  v_AUC: 0.884538
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.286898    reg_loss: 0.067165    l2_loss: 0.015331    loss: 0.369395
steps 3600    v_Prec: 0.665024  v_Recall: 0.637901  v_F1: 0.651180  v_AUC: 0.885053
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.281634    reg_loss: 0.067256    l2_loss: 0.015788    loss: 0.364678
steps 3800    v_Prec: 0.670263  v_Recall: 0.637179  v_F1: 0.653303  v_AUC: 0.887759
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.287699    reg_loss: 0.067370    l2_loss: 0.016194    loss: 0.371263
steps 4000    v_Prec: 0.654819  v_Recall: 0.655449  v_F1: 0.655134  v_AUC: 0.890226
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.276981    reg_loss: 0.067184    l2_loss: 0.016728    loss: 0.360893
steps 4200    v_Prec: 0.694358  v_Recall: 0.624199  v_F1: 0.657412  v_AUC: 0.891110
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.275810    reg_loss: 0.067394    l2_loss: 0.017227    loss: 0.360432
steps 4400    v_Prec: 0.658832  v_Recall: 0.658093  v_F1: 0.658462  v_AUC: 0.892265
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.276441    reg_loss: 0.067443    l2_loss: 0.017781    loss: 0.361666
steps 4600    v_Prec: 0.672460  v_Recall: 0.647997  v_F1: 0.660002  v_AUC: 0.894139
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.274795    reg_loss: 0.067286    l2_loss: 0.018259    loss: 0.360340
steps 4800    v_Prec: 0.663289  v_Recall: 0.660897  v_F1: 0.662091  v_AUC: 0.897478
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.270789    reg_loss: 0.067393    l2_loss: 0.018850    loss: 0.357032
steps 5000    v_Prec: 0.656585  v_Recall: 0.671474  v_F1: 0.663946  v_AUC: 0.898192
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.271050    reg_loss: 0.067505    l2_loss: 0.019458    loss: 0.358013
steps 5200    v_Prec: 0.659657  v_Recall: 0.666106  v_F1: 0.662866  v_AUC: 0.899527
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.263312    reg_loss: 0.067507    l2_loss: 0.020065    loss: 0.350885
steps 5400    v_Prec: 0.680729  v_Recall: 0.655529  v_F1: 0.667891  v_AUC: 0.899782
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.184099    reg_loss: 0.068538    l2_loss: 0.020877    loss: 0.273514
steps 5600    v_Prec: 0.651423  v_Recall: 0.671154  v_F1: 0.661141  v_AUC: 0.894056
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.174504    reg_loss: 0.068155    l2_loss: 0.021709    loss: 0.264368
steps 5800    v_Prec: 0.657340  v_Recall: 0.664503  v_F1: 0.660902  v_AUC: 0.892651
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.187884    reg_loss: 0.068540    l2_loss: 0.022529    loss: 0.278954
steps 6000    v_Prec: 0.672178  v_Recall: 0.641747  v_F1: 0.656610  v_AUC: 0.892476
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.182404    reg_loss: 0.068267    l2_loss: 0.023132    loss: 0.273803
steps 6200    v_Prec: 0.687927  v_Recall: 0.629167  v_F1: 0.657236  v_AUC: 0.891385
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.180786    reg_loss: 0.068314    l2_loss: 0.023705    loss: 0.272805
steps 6400    v_Prec: 0.675117  v_Recall: 0.648718  v_F1: 0.661654  v_AUC: 0.893878
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.189107    reg_loss: 0.068168    l2_loss: 0.024296    loss: 0.281571
steps 6600    v_Prec: 0.657104  v_Recall: 0.660737  v_F1: 0.658916  v_AUC: 0.893245
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.190705    reg_loss: 0.068184    l2_loss: 0.024764    loss: 0.283654
steps 6800    v_Prec: 0.693514  v_Recall: 0.634054  v_F1: 0.662453  v_AUC: 0.893576
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.200459    reg_loss: 0.068134    l2_loss: 0.025320    loss: 0.293912
steps 7000    v_Prec: 0.684008  v_Recall: 0.656330  v_F1: 0.669883  v_AUC: 0.896463
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.200048    reg_loss: 0.068196    l2_loss: 0.025641    loss: 0.293885
steps 7200    v_Prec: 0.687532  v_Recall: 0.655689  v_F1: 0.671233  v_AUC: 0.896969
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.184439    reg_loss: 0.067998    l2_loss: 0.026129    loss: 0.278567
steps 7400    v_Prec: 0.693493  v_Recall: 0.660096  v_F1: 0.676382  v_AUC: 0.899410
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.192618    reg_loss: 0.068050    l2_loss: 0.026400    loss: 0.287067
steps 7600    v_Prec: 0.702218  v_Recall: 0.659455  v_F1: 0.680165  v_AUC: 0.900917
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.189779    reg_loss: 0.068064    l2_loss: 0.026830    loss: 0.284673
steps 7800    v_Prec: 0.711201  v_Recall: 0.659856  v_F1: 0.684567  v_AUC: 0.903441
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.196295    reg_loss: 0.068130    l2_loss: 0.027133    loss: 0.291558
steps 8000    v_Prec: 0.697924  v_Recall: 0.670913  v_F1: 0.684152  v_AUC: 0.904359
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.198467    reg_loss: 0.068031    l2_loss: 0.027538    loss: 0.294037
steps 8200    v_Prec: 0.703514  v_Recall: 0.672115  v_F1: 0.687456  v_AUC: 0.905641
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.197067    reg_loss: 0.067842    l2_loss: 0.027751    loss: 0.292659
steps 8400    v_Prec: 0.732201  v_Recall: 0.652644  v_F1: 0.690137  v_AUC: 0.906467
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.186002    reg_loss: 0.067919    l2_loss: 0.028149    loss: 0.282070
steps 8600    v_Prec: 0.716739  v_Recall: 0.672115  v_F1: 0.693710  v_AUC: 0.907756
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.193583    reg_loss: 0.067956    l2_loss: 0.028331    loss: 0.289870
steps 8800    v_Prec: 0.731189  v_Recall: 0.659535  v_F1: 0.693516  v_AUC: 0.909317
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.185842    reg_loss: 0.068025    l2_loss: 0.028539    loss: 0.282406
steps 9000    v_Prec: 0.704152  v_Recall: 0.684856  v_F1: 0.694370  v_AUC: 0.908414
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.197655    reg_loss: 0.067939    l2_loss: 0.028942    loss: 0.294536
steps 9200    v_Prec: 0.739278  v_Recall: 0.661619  v_F1: 0.698296  v_AUC: 0.911275
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.189269    reg_loss: 0.067520    l2_loss: 0.029118    loss: 0.285906
steps 9400    v_Prec: 0.717813  v_Recall: 0.694231  v_F1: 0.705825  v_AUC: 0.912837
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.188569    reg_loss: 0.067580    l2_loss: 0.029497    loss: 0.285646
steps 9600    v_Prec: 0.721447  v_Recall: 0.691907  v_F1: 0.706368  v_AUC: 0.914576
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.193855    reg_loss: 0.067581    l2_loss: 0.029577    loss: 0.291012
steps 9800    v_Prec: 0.741186  v_Recall: 0.677163  v_F1: 0.707730  v_AUC: 0.914634
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.196173    reg_loss: 0.067705    l2_loss: 0.029729    loss: 0.293607
steps 10000    v_Prec: 0.727623  v_Recall: 0.695673  v_F1: 0.711290  v_AUC: 0.916083
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.181200    reg_loss: 0.067374    l2_loss: 0.030001    loss: 0.278574
steps 10200    v_Prec: 0.755847  v_Recall: 0.670753  v_F1: 0.710762  v_AUC: 0.915666
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.191510    reg_loss: 0.067789    l2_loss: 0.030259    loss: 0.289557
steps 10400    v_Prec: 0.730252  v_Recall: 0.700000  v_F1: 0.714806  v_AUC: 0.916635
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.191758    reg_loss: 0.067443    l2_loss: 0.030335    loss: 0.289536
steps 10600    v_Prec: 0.720431  v_Recall: 0.712580  v_F1: 0.716484  v_AUC: 0.918569
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.176580    reg_loss: 0.067585    l2_loss: 0.030552    loss: 0.274717
steps 10800    v_Prec: 0.738985  v_Recall: 0.689423  v_F1: 0.713344  v_AUC: 0.918668
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.086823    reg_loss: 0.066988    l2_loss: 0.030625    loss: 0.184435
steps 11000    v_Prec: 0.714369  v_Recall: 0.684375  v_F1: 0.699051  v_AUC: 0.910270
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.083148    reg_loss: 0.066900    l2_loss: 0.030861    loss: 0.180910
steps 11200    v_Prec: 0.713798  v_Recall: 0.669872  v_F1: 0.691138  v_AUC: 0.906821
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.079997    reg_loss: 0.066741    l2_loss: 0.031021    loss: 0.177759
steps 11400    v_Prec: 0.743495  v_Recall: 0.643349  v_F1: 0.689806  v_AUC: 0.905844
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.085666    reg_loss: 0.066889    l2_loss: 0.031136    loss: 0.183691
steps 11600    v_Prec: 0.718647  v_Recall: 0.663942  v_F1: 0.690212  v_AUC: 0.905764
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.082291    reg_loss: 0.066718    l2_loss: 0.031315    loss: 0.180323
steps 11800    v_Prec: 0.709616  v_Recall: 0.655769  v_F1: 0.681631  v_AUC: 0.900489
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.088615    reg_loss: 0.066709    l2_loss: 0.031383    loss: 0.186708
steps 12000    v_Prec: 0.701792  v_Recall: 0.659054  v_F1: 0.679752  v_AUC: 0.900611
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.086483    reg_loss: 0.066628    l2_loss: 0.031568    loss: 0.184679
steps 12200    v_Prec: 0.690534  v_Recall: 0.662260  v_F1: 0.676101  v_AUC: 0.899129
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.083627    reg_loss: 0.066369    l2_loss: 0.031671    loss: 0.181667
steps 12400    v_Prec: 0.669926  v_Recall: 0.675240  v_F1: 0.672573  v_AUC: 0.898752
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.090607    reg_loss: 0.066316    l2_loss: 0.031799    loss: 0.188722
steps 12600    v_Prec: 0.682790  v_Recall: 0.670753  v_F1: 0.676718  v_AUC: 0.899562
steps 12600    running time 445 seconds

Early stop model F1: 0.716484
testing thre: 0.4000241
testing Prec: 0.5251863792061253
testing Recall: 0.760097205346294
testing F1: 0.6211745079737057
testing AUC: 0.8967089674759178
overall running time 448 seconds
(0.6987650291061422, 0.6242527339003645, 0.6594106171064791, 0.8967089674759178, 0.68966174)

2019-02-24 17:35:17.106770: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:35:18.147148: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:35:18.203256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:35:18.203344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.570000 seconds
loading data in 30.790000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.310303    reg_loss: 0.064440    l2_loss: 0.013333    loss: 1.388076
steps 200    v_Prec: 0.163761  v_Recall: 0.998724  v_F1: 0.281384  v_AUC: 0.535100
steps 200    running time 41 seconds

steps 400    base_loss: 0.836829    reg_loss: 0.064146    l2_loss: 0.013083    loss: 0.914058
steps 400    v_Prec: 0.165965  v_Recall: 0.972165  v_F1: 0.283528  v_AUC: 0.542294
steps 400    running time 48 seconds

steps 600    base_loss: 0.504938    reg_loss: 0.063828    l2_loss: 0.012877    loss: 0.581643
steps 600    v_Prec: 0.183341  v_Recall: 0.760488  v_F1: 0.295453  v_AUC: 0.582044
steps 600    running time 55 seconds

steps 800    base_loss: 0.480664    reg_loss: 0.063228    l2_loss: 0.012804    loss: 0.556695
steps 800    v_Prec: 0.205428  v_Recall: 0.630244  v_F1: 0.309858  v_AUC: 0.612149
steps 800    running time 62 seconds

steps 1000    base_loss: 0.459198    reg_loss: 0.062862    l2_loss: 0.012716    loss: 0.534776
steps 1000    v_Prec: 0.255782  v_Recall: 0.558383  v_F1: 0.350848  v_AUC: 0.677638
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.432380    reg_loss: 0.062130    l2_loss: 0.012665    loss: 0.507175
steps 1200    v_Prec: 0.324723  v_Recall: 0.507338  v_F1: 0.395991  v_AUC: 0.728030
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.405490    reg_loss: 0.061230    l2_loss: 0.012715    loss: 0.479435
steps 1400    v_Prec: 0.387881  v_Recall: 0.523289  v_F1: 0.445523  v_AUC: 0.766244
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.401566    reg_loss: 0.060661    l2_loss: 0.012869    loss: 0.475097
steps 1600    v_Prec: 0.448820  v_Recall: 0.517228  v_F1: 0.480602  v_AUC: 0.790386
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.381350    reg_loss: 0.059788    l2_loss: 0.013002    loss: 0.454141
steps 1800    v_Prec: 0.486828  v_Recall: 0.540916  v_F1: 0.512449  v_AUC: 0.815143
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.358448    reg_loss: 0.059040    l2_loss: 0.013286    loss: 0.430774
steps 2000    v_Prec: 0.519719  v_Recall: 0.566518  v_F1: 0.542110  v_AUC: 0.833037
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.341226    reg_loss: 0.058270    l2_loss: 0.013601    loss: 0.413096
steps 2200    v_Prec: 0.543617  v_Recall: 0.583506  v_F1: 0.562856  v_AUC: 0.845279
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.333738    reg_loss: 0.057659    l2_loss: 0.013926    loss: 0.405323
steps 2400    v_Prec: 0.564830  v_Recall: 0.595869  v_F1: 0.579934  v_AUC: 0.858448
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.320685    reg_loss: 0.056834    l2_loss: 0.014325    loss: 0.391844
steps 2600    v_Prec: 0.622723  v_Recall: 0.577923  v_F1: 0.599487  v_AUC: 0.864192
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.312446    reg_loss: 0.056266    l2_loss: 0.014794    loss: 0.383507
steps 2800    v_Prec: 0.615816  v_Recall: 0.603685  v_F1: 0.609690  v_AUC: 0.870984
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.312465    reg_loss: 0.055754    l2_loss: 0.015260    loss: 0.383479
steps 3000    v_Prec: 0.613127  v_Recall: 0.628091  v_F1: 0.620518  v_AUC: 0.876566
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.305588    reg_loss: 0.055197    l2_loss: 0.015753    loss: 0.376538
steps 3200    v_Prec: 0.633614  v_Recall: 0.618201  v_F1: 0.625812  v_AUC: 0.881781
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.294887    reg_loss: 0.054511    l2_loss: 0.016218    loss: 0.365616
steps 3400    v_Prec: 0.652203  v_Recall: 0.625778  v_F1: 0.638717  v_AUC: 0.884564
steps 3400    running time 152 seconds

steps 3600    base_loss: 0.301125    reg_loss: 0.054001    l2_loss: 0.016732    loss: 0.371857
steps 3600    v_Prec: 0.663031  v_Recall: 0.620514  v_F1: 0.641068  v_AUC: 0.886959
steps 3600    running time 159 seconds

steps 3800    base_loss: 0.291915    reg_loss: 0.053369    l2_loss: 0.017251    loss: 0.362535
steps 3800    v_Prec: 0.675218  v_Recall: 0.617164  v_F1: 0.644887  v_AUC: 0.888351
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.289132    reg_loss: 0.052804    l2_loss: 0.017790    loss: 0.359727
steps 4000    v_Prec: 0.653689  v_Recall: 0.650822  v_F1: 0.652252  v_AUC: 0.889977
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.285973    reg_loss: 0.052195    l2_loss: 0.018342    loss: 0.356510
steps 4200    v_Prec: 0.665400  v_Recall: 0.642367  v_F1: 0.653681  v_AUC: 0.890755
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.283581    reg_loss: 0.051580    l2_loss: 0.019006    loss: 0.354167
steps 4400    v_Prec: 0.660302  v_Recall: 0.656405  v_F1: 0.658347  v_AUC: 0.893135
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.281975    reg_loss: 0.051179    l2_loss: 0.019640    loss: 0.352793
steps 4600    v_Prec: 0.656428  v_Recall: 0.661349  v_F1: 0.658880  v_AUC: 0.893457
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.279618    reg_loss: 0.050555    l2_loss: 0.020294    loss: 0.350467
steps 4800    v_Prec: 0.677958  v_Recall: 0.641729  v_F1: 0.659346  v_AUC: 0.896281
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.280007    reg_loss: 0.049962    l2_loss: 0.020948    loss: 0.350917
steps 5000    v_Prec: 0.682044  v_Recall: 0.646196  v_F1: 0.663636  v_AUC: 0.897250
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.279560    reg_loss: 0.049600    l2_loss: 0.021635    loss: 0.350794
steps 5200    v_Prec: 0.696446  v_Recall: 0.639177  v_F1: 0.666583  v_AUC: 0.898278
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.275149    reg_loss: 0.048977    l2_loss: 0.022208    loss: 0.346333
steps 5400    v_Prec: 0.672661  v_Recall: 0.665258  v_F1: 0.668939  v_AUC: 0.897888
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.175998    reg_loss: 0.049773    l2_loss: 0.022968    loss: 0.248739
steps 5600    v_Prec: 0.676881  v_Recall: 0.646594  v_F1: 0.661391  v_AUC: 0.895799
steps 5600    running time 228 seconds

steps 5800    base_loss: 0.180646    reg_loss: 0.050275    l2_loss: 0.023389    loss: 0.254310
steps 5800    v_Prec: 0.666803  v_Recall: 0.648349  v_F1: 0.657447  v_AUC: 0.894564
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.178583    reg_loss: 0.050411    l2_loss: 0.024121    loss: 0.253115
steps 6000    v_Prec: 0.682616  v_Recall: 0.636066  v_F1: 0.658519  v_AUC: 0.893449
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.172077    reg_loss: 0.050196    l2_loss: 0.024718    loss: 0.246991
steps 6200    v_Prec: 0.663222  v_Recall: 0.644919  v_F1: 0.653943  v_AUC: 0.891574
steps 6200    running time 247 seconds

steps 6400    base_loss: 0.178335    reg_loss: 0.050401    l2_loss: 0.025347    loss: 0.254083
steps 6400    v_Prec: 0.670733  v_Recall: 0.635907  v_F1: 0.652856  v_AUC: 0.892108
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.170928    reg_loss: 0.050376    l2_loss: 0.025830    loss: 0.247134
steps 6600    v_Prec: 0.660906  v_Recall: 0.646674  v_F1: 0.653713  v_AUC: 0.890317
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.172388    reg_loss: 0.050275    l2_loss: 0.026440    loss: 0.249103
steps 6800    v_Prec: 0.679928  v_Recall: 0.628410  v_F1: 0.653154  v_AUC: 0.892569
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.186333    reg_loss: 0.049786    l2_loss: 0.027013    loss: 0.263132
steps 7000    v_Prec: 0.685692  v_Recall: 0.631440  v_F1: 0.657449  v_AUC: 0.894949
steps 7000    running time 273 seconds

steps 7200    base_loss: 0.185548    reg_loss: 0.049633    l2_loss: 0.027501    loss: 0.262682
steps 7200    v_Prec: 0.693985  v_Recall: 0.629446  v_F1: 0.660142  v_AUC: 0.895494
steps 7200    running time 279 seconds

steps 7400    base_loss: 0.177819    reg_loss: 0.049351    l2_loss: 0.027849    loss: 0.255018
steps 7400    v_Prec: 0.674282  v_Recall: 0.649705  v_F1: 0.661765  v_AUC: 0.895289
steps 7400    running time 286 seconds

Early stop model F1: 0.668939
testing thre: 0.36887836
testing Prec: 0.49813615852462234
testing Recall: 0.7404131227217498
testing F1: 0.5955783177277792
testing AUC: 0.8801568416103467
overall running time 288 seconds
(0.6735422662829122, 0.6141919805589308, 0.642499428019422, 0.8801568416103467, 0.6146857)

2019-02-24 17:38:35.904777: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:38:37.014802: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:38:37.017960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:38:37.018017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.150000 seconds
loading data in 30.360000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.496671    reg_loss: 0.065007    l2_loss: 0.013277    loss: 0.574955
steps 200    v_Prec: 0.165133  v_Recall: 0.997943  v_F1: 0.283375  v_AUC: 0.517097
steps 200    running time 41 seconds

steps 400    base_loss: 0.492209    reg_loss: 0.065004    l2_loss: 0.013231    loss: 0.570444
steps 400    v_Prec: 0.170053  v_Recall: 0.878709  v_F1: 0.284959  v_AUC: 0.537549
steps 400    running time 48 seconds

steps 600    base_loss: 0.474160    reg_loss: 0.064566    l2_loss: 0.013158    loss: 0.551884
steps 600    v_Prec: 0.177350  v_Recall: 0.813039  v_F1: 0.291183  v_AUC: 0.561871
steps 600    running time 55 seconds

steps 800    base_loss: 0.449003    reg_loss: 0.063996    l2_loss: 0.013065    loss: 0.526065
steps 800    v_Prec: 0.203364  v_Recall: 0.632249  v_F1: 0.307743  v_AUC: 0.604768
steps 800    running time 62 seconds

steps 1000    base_loss: 0.445036    reg_loss: 0.063743    l2_loss: 0.013066    loss: 0.521844
steps 1000    v_Prec: 0.308813  v_Recall: 0.427486  v_F1: 0.358586  v_AUC: 0.673067
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.413796    reg_loss: 0.063167    l2_loss: 0.013129    loss: 0.490092
steps 1200    v_Prec: 0.437092  v_Recall: 0.444735  v_F1: 0.440880  v_AUC: 0.739762
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.382098    reg_loss: 0.062551    l2_loss: 0.013273    loss: 0.457921
steps 1400    v_Prec: 0.524016  v_Recall: 0.487697  v_F1: 0.505204  v_AUC: 0.785151
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.357857    reg_loss: 0.062024    l2_loss: 0.013434    loss: 0.433314
steps 1600    v_Prec: 0.565952  v_Recall: 0.532637  v_F1: 0.548789  v_AUC: 0.815687
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.334170    reg_loss: 0.061372    l2_loss: 0.013595    loss: 0.409136
steps 1800    v_Prec: 0.633002  v_Recall: 0.539046  v_F1: 0.582258  v_AUC: 0.835110
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.323653    reg_loss: 0.060969    l2_loss: 0.013720    loss: 0.398342
steps 2000    v_Prec: 0.651929  v_Recall: 0.566975  v_F1: 0.606491  v_AUC: 0.850270
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.302662    reg_loss: 0.060525    l2_loss: 0.013882    loss: 0.377069
steps 2200    v_Prec: 0.674579  v_Recall: 0.586834  v_F1: 0.627655  v_AUC: 0.859475
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.298329    reg_loss: 0.060010    l2_loss: 0.014114    loss: 0.372453
steps 2400    v_Prec: 0.699126  v_Recall: 0.588496  v_F1: 0.639058  v_AUC: 0.867105
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.286829    reg_loss: 0.059736    l2_loss: 0.014300    loss: 0.360865
steps 2600    v_Prec: 0.696152  v_Recall: 0.608355  v_F1: 0.649299  v_AUC: 0.871217
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.286695    reg_loss: 0.059363    l2_loss: 0.014478    loss: 0.360537
steps 2800    v_Prec: 0.714086  v_Recall: 0.606061  v_F1: 0.655654  v_AUC: 0.875860
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.283941    reg_loss: 0.059122    l2_loss: 0.014724    loss: 0.357787
steps 3000    v_Prec: 0.705398  v_Recall: 0.623467  v_F1: 0.661907  v_AUC: 0.880509
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.276824    reg_loss: 0.058808    l2_loss: 0.014973    loss: 0.350606
steps 3200    v_Prec: 0.719710  v_Recall: 0.628372  v_F1: 0.670947  v_AUC: 0.884543
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.271342    reg_loss: 0.058517    l2_loss: 0.015269    loss: 0.345128
steps 3400    v_Prec: 0.696562  v_Recall: 0.650764  v_F1: 0.672884  v_AUC: 0.886211
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.269073    reg_loss: 0.058274    l2_loss: 0.015485    loss: 0.342832
steps 3600    v_Prec: 0.731819  v_Recall: 0.632170  v_F1: 0.678355  v_AUC: 0.888501
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.257250    reg_loss: 0.057766    l2_loss: 0.015744    loss: 0.330759
steps 3800    v_Prec: 0.725311  v_Recall: 0.646175  v_F1: 0.683460  v_AUC: 0.892060
steps 3800    running time 167 seconds

steps 4000    base_loss: 0.268127    reg_loss: 0.057738    l2_loss: 0.016100    loss: 0.341965
steps 4000    v_Prec: 0.753118  v_Recall: 0.630667  v_F1: 0.686475  v_AUC: 0.894592
steps 4000    running time 174 seconds

steps 4200    base_loss: 0.258768    reg_loss: 0.057404    l2_loss: 0.016341    loss: 0.332514
steps 4200    v_Prec: 0.755805  v_Recall: 0.633515  v_F1: 0.689278  v_AUC: 0.895691
steps 4200    running time 181 seconds

steps 4400    base_loss: 0.254395    reg_loss: 0.056945    l2_loss: 0.016686    loss: 0.328026
steps 4400    v_Prec: 0.736833  v_Recall: 0.658596  v_F1: 0.695521  v_AUC: 0.898545
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.262221    reg_loss: 0.056915    l2_loss: 0.017029    loss: 0.336166
steps 4600    v_Prec: 0.731434  v_Recall: 0.670148  v_F1: 0.699451  v_AUC: 0.900984
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.261101    reg_loss: 0.056692    l2_loss: 0.017401    loss: 0.335194
steps 4800    v_Prec: 0.727358  v_Recall: 0.672917  v_F1: 0.699079  v_AUC: 0.901988
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.257992    reg_loss: 0.056514    l2_loss: 0.017879    loss: 0.332385
steps 5000    v_Prec: 0.740621  v_Recall: 0.668486  v_F1: 0.702707  v_AUC: 0.904286
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.248419    reg_loss: 0.056018    l2_loss: 0.018209    loss: 0.322646
steps 5200    v_Prec: 0.736079  v_Recall: 0.670385  v_F1: 0.701698  v_AUC: 0.905010
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.246374    reg_loss: 0.055472    l2_loss: 0.018593    loss: 0.320439
steps 5400    v_Prec: 0.740068  v_Recall: 0.676478  v_F1: 0.706845  v_AUC: 0.906961
steps 5400    running time 221 seconds

steps 5600    base_loss: 0.164580    reg_loss: 0.051625    l2_loss: 0.019153    loss: 0.235358
steps 5600    v_Prec: 0.768201  v_Recall: 0.649498  v_F1: 0.703880  v_AUC: 0.903686
steps 5600    running time 228 seconds

steps 5800    base_loss: 0.153441    reg_loss: 0.051330    l2_loss: 0.019794    loss: 0.224564
steps 5800    v_Prec: 0.734721  v_Recall: 0.667695  v_F1: 0.699606  v_AUC: 0.898998
steps 5800    running time 234 seconds

steps 6000    base_loss: 0.166043    reg_loss: 0.051284    l2_loss: 0.020449    loss: 0.237776
steps 6000    v_Prec: 0.750911  v_Recall: 0.651871  v_F1: 0.697895  v_AUC: 0.899050
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.155418    reg_loss: 0.051031    l2_loss: 0.021070    loss: 0.227518
steps 6200    v_Prec: 0.753501  v_Recall: 0.651317  v_F1: 0.698693  v_AUC: 0.898062
steps 6200    running time 247 seconds

steps 6400    base_loss: 0.159838    reg_loss: 0.051193    l2_loss: 0.021579    loss: 0.232610
steps 6400    v_Prec: 0.748134  v_Recall: 0.666271  v_F1: 0.704834  v_AUC: 0.900466
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.172690    reg_loss: 0.051231    l2_loss: 0.022032    loss: 0.245954
steps 6600    v_Prec: 0.768391  v_Recall: 0.657014  v_F1: 0.708351  v_AUC: 0.900132
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.169985    reg_loss: 0.050766    l2_loss: 0.022489    loss: 0.243241
steps 6800    v_Prec: 0.753739  v_Recall: 0.669831  v_F1: 0.709313  v_AUC: 0.900808
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.168859    reg_loss: 0.050729    l2_loss: 0.022815    loss: 0.242403
steps 7000    v_Prec: 0.779101  v_Recall: 0.652425  v_F1: 0.710158  v_AUC: 0.903866
steps 7000    running time 274 seconds

steps 7200    base_loss: 0.174600    reg_loss: 0.050953    l2_loss: 0.023153    loss: 0.248706
steps 7200    v_Prec: 0.763186  v_Recall: 0.668566  v_F1: 0.712749  v_AUC: 0.904183
steps 7200    running time 281 seconds

steps 7400    base_loss: 0.178073    reg_loss: 0.050763    l2_loss: 0.023354    loss: 0.252190
steps 7400    v_Prec: 0.773709  v_Recall: 0.668724  v_F1: 0.717396  v_AUC: 0.905349
steps 7400    running time 288 seconds

steps 7600    base_loss: 0.176405    reg_loss: 0.050453    l2_loss: 0.023539    loss: 0.250398
steps 7600    v_Prec: 0.769960  v_Recall: 0.668407  v_F1: 0.715599  v_AUC: 0.905971
steps 7600    running time 295 seconds

steps 7800    base_loss: 0.174271    reg_loss: 0.050334    l2_loss: 0.023898    loss: 0.248502
steps 7800    v_Prec: 0.759444  v_Recall: 0.679168  v_F1: 0.717066  v_AUC: 0.906821
steps 7800    running time 301 seconds

steps 8000    base_loss: 0.175176    reg_loss: 0.050372    l2_loss: 0.023955    loss: 0.249503
steps 8000    v_Prec: 0.785327  v_Recall: 0.663977  v_F1: 0.719571  v_AUC: 0.908791
steps 8000    running time 308 seconds

steps 8200    base_loss: 0.170180    reg_loss: 0.050029    l2_loss: 0.024216    loss: 0.244426
steps 8200    v_Prec: 0.790522  v_Recall: 0.662552  v_F1: 0.720902  v_AUC: 0.910059
steps 8200    running time 315 seconds

steps 8400    base_loss: 0.176392    reg_loss: 0.049995    l2_loss: 0.024477    loss: 0.250863
steps 8400    v_Prec: 0.774675  v_Recall: 0.673787  v_F1: 0.720718  v_AUC: 0.910365
steps 8400    running time 322 seconds

steps 8600    base_loss: 0.172982    reg_loss: 0.049838    l2_loss: 0.024648    loss: 0.247469
steps 8600    v_Prec: 0.790759  v_Recall: 0.668882  v_F1: 0.724732  v_AUC: 0.910565
steps 8600    running time 328 seconds

steps 8800    base_loss: 0.172809    reg_loss: 0.049810    l2_loss: 0.024770    loss: 0.247389
steps 8800    v_Prec: 0.775616  v_Recall: 0.687554  v_F1: 0.728935  v_AUC: 0.912421
steps 8800    running time 335 seconds

steps 9000    base_loss: 0.177914    reg_loss: 0.049611    l2_loss: 0.024876    loss: 0.252400
steps 9000    v_Prec: 0.770602  v_Recall: 0.697682  v_F1: 0.732331  v_AUC: 0.914242
steps 9000    running time 342 seconds

steps 9200    base_loss: 0.164142    reg_loss: 0.049280    l2_loss: 0.025042    loss: 0.238464
steps 9200    v_Prec: 0.753268  v_Recall: 0.706781  v_F1: 0.729284  v_AUC: 0.914093
steps 9200    running time 349 seconds

steps 9400    base_loss: 0.173959    reg_loss: 0.049369    l2_loss: 0.025152    loss: 0.248480
steps 9400    v_Prec: 0.781054  v_Recall: 0.689532  v_F1: 0.732445  v_AUC: 0.914680
steps 9400    running time 355 seconds

steps 9600    base_loss: 0.175750    reg_loss: 0.049384    l2_loss: 0.025280    loss: 0.250414
steps 9600    v_Prec: 0.798769  v_Recall: 0.677427  v_F1: 0.733111  v_AUC: 0.916583
steps 9600    running time 363 seconds

steps 9800    base_loss: 0.185605    reg_loss: 0.049236    l2_loss: 0.025308    loss: 0.260149
steps 9800    v_Prec: 0.806458  v_Recall: 0.673867  v_F1: 0.734224  v_AUC: 0.918633
steps 9800    running time 370 seconds

steps 10000    base_loss: 0.180027    reg_loss: 0.048963    l2_loss: 0.025379    loss: 0.254369
steps 10000    v_Prec: 0.781560  v_Recall: 0.697524  v_F1: 0.737155  v_AUC: 0.919625
steps 10000    running time 377 seconds

steps 10200    base_loss: 0.178048    reg_loss: 0.048643    l2_loss: 0.025401    loss: 0.252092
steps 10200    v_Prec: 0.791301  v_Recall: 0.692381  v_F1: 0.738543  v_AUC: 0.920002
steps 10200    running time 383 seconds

steps 10400    base_loss: 0.175389    reg_loss: 0.048631    l2_loss: 0.025525    loss: 0.249545
steps 10400    v_Prec: 0.766796  v_Recall: 0.718807  v_F1: 0.742026  v_AUC: 0.921893
steps 10400    running time 390 seconds

steps 10600    base_loss: 0.174571    reg_loss: 0.048594    l2_loss: 0.025650    loss: 0.248815
steps 10600    v_Prec: 0.803051  v_Recall: 0.695546  v_F1: 0.745442  v_AUC: 0.922492
steps 10600    running time 397 seconds

steps 10800    base_loss: 0.157429    reg_loss: 0.047670    l2_loss: 0.025655    loss: 0.230754
steps 10800    v_Prec: 0.795608  v_Recall: 0.710816  v_F1: 0.750825  v_AUC: 0.924514
steps 10800    running time 404 seconds

steps 11000    base_loss: 0.056497    reg_loss: 0.043151    l2_loss: 0.025585    loss: 0.125233
steps 11000    v_Prec: 0.789713  v_Recall: 0.713110  v_F1: 0.749460  v_AUC: 0.922895
steps 11000    running time 411 seconds

steps 11200    base_loss: 0.055463    reg_loss: 0.043389    l2_loss: 0.025386    loss: 0.124238
steps 11200    v_Prec: 0.781101  v_Recall: 0.714851  v_F1: 0.746509  v_AUC: 0.919469
steps 11200    running time 417 seconds

steps 11400    base_loss: 0.060329    reg_loss: 0.043055    l2_loss: 0.025331    loss: 0.128715
steps 11400    v_Prec: 0.793311  v_Recall: 0.698156  v_F1: 0.742698  v_AUC: 0.919078
steps 11400    running time 424 seconds

steps 11600    base_loss: 0.059339    reg_loss: 0.043235    l2_loss: 0.025149    loss: 0.127723
steps 11600    v_Prec: 0.798281  v_Recall: 0.690719  v_F1: 0.740615  v_AUC: 0.918007
steps 11600    running time 430 seconds

steps 11800    base_loss: 0.061908    reg_loss: 0.043538    l2_loss: 0.025258    loss: 0.130704
steps 11800    v_Prec: 0.791413  v_Recall: 0.689849  v_F1: 0.737149  v_AUC: 0.915715
steps 11800    running time 436 seconds

steps 12000    base_loss: 0.061087    reg_loss: 0.043452    l2_loss: 0.025325    loss: 0.129864
steps 12000    v_Prec: 0.785644  v_Recall: 0.695387  v_F1: 0.737765  v_AUC: 0.916562
steps 12000    running time 443 seconds

steps 12200    base_loss: 0.061366    reg_loss: 0.043404    l2_loss: 0.025152    loss: 0.129922
steps 12200    v_Prec: 0.792296  v_Recall: 0.693251  v_F1: 0.739472  v_AUC: 0.916432
steps 12200    running time 449 seconds

steps 12400    base_loss: 0.064975    reg_loss: 0.043414    l2_loss: 0.025156    loss: 0.133545
steps 12400    v_Prec: 0.792194  v_Recall: 0.693726  v_F1: 0.739697  v_AUC: 0.917712
steps 12400    running time 456 seconds

steps 12600    base_loss: 0.064581    reg_loss: 0.043575    l2_loss: 0.025201    loss: 0.133357
steps 12600    v_Prec: 0.780147  v_Recall: 0.703299  v_F1: 0.739733  v_AUC: 0.917686
steps 12600    running time 462 seconds

steps 12800    base_loss: 0.069807    reg_loss: 0.043795    l2_loss: 0.025132    loss: 0.138733
steps 12800    v_Prec: 0.771579  v_Recall: 0.707967  v_F1: 0.738406  v_AUC: 0.917781
steps 12800    running time 468 seconds

Early stop model F1: 0.750825
testing thre: 0.5670117
testing Prec: 0.5803494270148413
testing Recall: 0.7507168894289186
testing F1: 0.6546302182665819
testing AUC: 0.9017695067447042
overall running time 471 seconds
(0.7176352281147454, 0.659003645200486, 0.6870708657427348, 0.9017695067447042, 0.8168571)

2019-02-24 17:43:53.121343: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:43:54.082480: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:43:54.088129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:43:54.088168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.770000 seconds
loading data in 30.880000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.513075    reg_loss: 0.064816    l2_loss: 0.013329    loss: 0.591221
steps 200    v_Prec: 0.164179  v_Recall: 0.998568  v_F1: 0.281994  v_AUC: 0.504121
steps 200    running time 41 seconds

steps 400    base_loss: 0.469774    reg_loss: 0.064785    l2_loss: 0.013188    loss: 0.547747
steps 400    v_Prec: 0.172443  v_Recall: 0.851209  v_F1: 0.286787  v_AUC: 0.550119
steps 400    running time 48 seconds

steps 600    base_loss: 0.474675    reg_loss: 0.064750    l2_loss: 0.013107    loss: 0.552532
steps 600    v_Prec: 0.200343  v_Recall: 0.669796  v_F1: 0.308431  v_AUC: 0.610673
steps 600    running time 55 seconds

steps 800    base_loss: 0.454649    reg_loss: 0.064422    l2_loss: 0.012895    loss: 0.531966
steps 800    v_Prec: 0.262499  v_Recall: 0.515516  v_F1: 0.347866  v_AUC: 0.666824
steps 800    running time 62 seconds

steps 1000    base_loss: 0.436357    reg_loss: 0.064172    l2_loss: 0.012726    loss: 0.513255
steps 1000    v_Prec: 0.346949  v_Recall: 0.506206  v_F1: 0.411713  v_AUC: 0.729159
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.409471    reg_loss: 0.064016    l2_loss: 0.012621    loss: 0.486108
steps 1200    v_Prec: 0.490610  v_Recall: 0.467696  v_F1: 0.478879  v_AUC: 0.776688
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.380848    reg_loss: 0.064189    l2_loss: 0.012595    loss: 0.457632
steps 1400    v_Prec: 0.535699  v_Recall: 0.500875  v_F1: 0.517702  v_AUC: 0.804743
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.355059    reg_loss: 0.064687    l2_loss: 0.012702    loss: 0.432449
steps 1600    v_Prec: 0.554026  v_Recall: 0.544239  v_F1: 0.549089  v_AUC: 0.827134
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.337478    reg_loss: 0.065143    l2_loss: 0.012872    loss: 0.415493
steps 1800    v_Prec: 0.593030  v_Recall: 0.555140  v_F1: 0.573460  v_AUC: 0.839348
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.330846    reg_loss: 0.065520    l2_loss: 0.013087    loss: 0.409454
steps 2000    v_Prec: 0.616593  v_Recall: 0.568269  v_F1: 0.591445  v_AUC: 0.852760
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.314483    reg_loss: 0.065941    l2_loss: 0.013297    loss: 0.393722
steps 2200    v_Prec: 0.626662  v_Recall: 0.588717  v_F1: 0.607097  v_AUC: 0.861009
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.309245    reg_loss: 0.066139    l2_loss: 0.013589    loss: 0.388973
steps 2400    v_Prec: 0.676799  v_Recall: 0.573997  v_F1: 0.621174  v_AUC: 0.868301
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.301282    reg_loss: 0.066355    l2_loss: 0.013856    loss: 0.381493
steps 2600    v_Prec: 0.663132  v_Recall: 0.597072  v_F1: 0.628370  v_AUC: 0.873941
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.294877    reg_loss: 0.066528    l2_loss: 0.014117    loss: 0.375521
steps 2800    v_Prec: 0.646758  v_Recall: 0.623806  v_F1: 0.635075  v_AUC: 0.877474
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.289778    reg_loss: 0.066618    l2_loss: 0.014460    loss: 0.370856
steps 3000    v_Prec: 0.657500  v_Recall: 0.627785  v_F1: 0.642299  v_AUC: 0.882670
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.288011    reg_loss: 0.067003    l2_loss: 0.014788    loss: 0.369802
steps 3200    v_Prec: 0.687815  v_Recall: 0.608132  v_F1: 0.645524  v_AUC: 0.885307
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.284463    reg_loss: 0.067232    l2_loss: 0.015190    loss: 0.366886
steps 3400    v_Prec: 0.670972  v_Recall: 0.628262  v_F1: 0.648915  v_AUC: 0.888199
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.279791    reg_loss: 0.067017    l2_loss: 0.015640    loss: 0.362448
steps 3600    v_Prec: 0.685982  v_Recall: 0.617919  v_F1: 0.650174  v_AUC: 0.889827
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.279059    reg_loss: 0.066991    l2_loss: 0.016002    loss: 0.362052
steps 3800    v_Prec: 0.657145  v_Recall: 0.646165  v_F1: 0.651609  v_AUC: 0.892745
steps 3800    running time 167 seconds

steps 4000    base_loss: 0.284102    reg_loss: 0.067440    l2_loss: 0.016412    loss: 0.367953
steps 4000    v_Prec: 0.661293  v_Recall: 0.639720  v_F1: 0.650328  v_AUC: 0.892604
steps 4000    running time 174 seconds

steps 4200    base_loss: 0.277474    reg_loss: 0.067414    l2_loss: 0.016937    loss: 0.361825
steps 4200    v_Prec: 0.673509  v_Recall: 0.639640  v_F1: 0.656138  v_AUC: 0.893257
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.270080    reg_loss: 0.067465    l2_loss: 0.017357    loss: 0.354903
steps 4400    v_Prec: 0.656524  v_Recall: 0.660964  v_F1: 0.658737  v_AUC: 0.894568
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.271251    reg_loss: 0.067404    l2_loss: 0.017956    loss: 0.356611
steps 4600    v_Prec: 0.716383  v_Recall: 0.617202  v_F1: 0.663105  v_AUC: 0.897744
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.268078    reg_loss: 0.067433    l2_loss: 0.018521    loss: 0.354032
steps 4800    v_Prec: 0.684731  v_Recall: 0.644414  v_F1: 0.663961  v_AUC: 0.897099
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.270859    reg_loss: 0.067606    l2_loss: 0.019061    loss: 0.357526
steps 5000    v_Prec: 0.690764  v_Recall: 0.646244  v_F1: 0.667763  v_AUC: 0.900257
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.270440    reg_loss: 0.067487    l2_loss: 0.019653    loss: 0.357580
steps 5200    v_Prec: 0.699105  v_Recall: 0.640197  v_F1: 0.668356  v_AUC: 0.900531
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.251793    reg_loss: 0.067473    l2_loss: 0.020324    loss: 0.339590
steps 5400    v_Prec: 0.669145  v_Recall: 0.673138  v_F1: 0.671136  v_AUC: 0.901292
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.166125    reg_loss: 0.068628    l2_loss: 0.021035    loss: 0.255788
steps 5600    v_Prec: 0.683602  v_Recall: 0.648791  v_F1: 0.665741  v_AUC: 0.895462
steps 5600    running time 229 seconds

steps 5800    base_loss: 0.185582    reg_loss: 0.068542    l2_loss: 0.021876    loss: 0.276000
steps 5800    v_Prec: 0.694632  v_Recall: 0.631127  v_F1: 0.661358  v_AUC: 0.893769
steps 5800    running time 236 seconds

steps 6000    base_loss: 0.177806    reg_loss: 0.067928    l2_loss: 0.022724    loss: 0.268459
steps 6000    v_Prec: 0.669940  v_Recall: 0.646006  v_F1: 0.657755  v_AUC: 0.893743
steps 6000    running time 242 seconds

steps 6200    base_loss: 0.183604    reg_loss: 0.068314    l2_loss: 0.023207    loss: 0.275125
steps 6200    v_Prec: 0.652987  v_Recall: 0.667171  v_F1: 0.660002  v_AUC: 0.894670
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.181357    reg_loss: 0.068375    l2_loss: 0.023806    loss: 0.273537
steps 6400    v_Prec: 0.680000  v_Recall: 0.647915  v_F1: 0.663570  v_AUC: 0.894928
steps 6400    running time 255 seconds

steps 6600    base_loss: 0.184552    reg_loss: 0.068239    l2_loss: 0.024402    loss: 0.277193
steps 6600    v_Prec: 0.651776  v_Recall: 0.662874  v_F1: 0.657278  v_AUC: 0.893501
steps 6600    running time 261 seconds

steps 6800    base_loss: 0.171754    reg_loss: 0.068090    l2_loss: 0.024958    loss: 0.264802
steps 6800    v_Prec: 0.666261  v_Recall: 0.653167  v_F1: 0.659649  v_AUC: 0.893956
steps 6800    running time 268 seconds

steps 7000    base_loss: 0.186698    reg_loss: 0.068193    l2_loss: 0.025484    loss: 0.280375
steps 7000    v_Prec: 0.682989  v_Recall: 0.639243  v_F1: 0.660392  v_AUC: 0.895306
steps 7000    running time 274 seconds

steps 7200    base_loss: 0.182643    reg_loss: 0.068162    l2_loss: 0.025983    loss: 0.276788
steps 7200    v_Prec: 0.687623  v_Recall: 0.640516  v_F1: 0.663234  v_AUC: 0.895697
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.184842    reg_loss: 0.068228    l2_loss: 0.026407    loss: 0.279477
steps 7400    v_Prec: 0.697816  v_Recall: 0.648234  v_F1: 0.672112  v_AUC: 0.899770
steps 7400    running time 287 seconds

steps 7600    base_loss: 0.185803    reg_loss: 0.068224    l2_loss: 0.026769    loss: 0.280796
steps 7600    v_Prec: 0.697093  v_Recall: 0.654440  v_F1: 0.675093  v_AUC: 0.902455
steps 7600    running time 294 seconds

steps 7800    base_loss: 0.181377    reg_loss: 0.067954    l2_loss: 0.027186    loss: 0.276518
steps 7800    v_Prec: 0.691633  v_Recall: 0.659055  v_F1: 0.674951  v_AUC: 0.901016
steps 7800    running time 301 seconds

steps 8000    base_loss: 0.183127    reg_loss: 0.067905    l2_loss: 0.027571    loss: 0.278603
steps 8000    v_Prec: 0.701312  v_Recall: 0.659293  v_F1: 0.679654  v_AUC: 0.901786
steps 8000    running time 307 seconds

steps 8200    base_loss: 0.186368    reg_loss: 0.068067    l2_loss: 0.027901    loss: 0.282336
steps 8200    v_Prec: 0.711626  v_Recall: 0.647756  v_F1: 0.678191  v_AUC: 0.901659
steps 8200    running time 314 seconds

steps 8400    base_loss: 0.186849    reg_loss: 0.068047    l2_loss: 0.028236    loss: 0.283132
steps 8400    v_Prec: 0.700983  v_Recall: 0.669637  v_F1: 0.684952  v_AUC: 0.903316
steps 8400    running time 320 seconds

steps 8600    base_loss: 0.187637    reg_loss: 0.067788    l2_loss: 0.028484    loss: 0.283909
steps 8600    v_Prec: 0.700375  v_Recall: 0.682766  v_F1: 0.691459  v_AUC: 0.905406
steps 8600    running time 327 seconds

steps 8800    base_loss: 0.191967    reg_loss: 0.067947    l2_loss: 0.028780    loss: 0.288694
steps 8800    v_Prec: 0.713437  v_Recall: 0.669160  v_F1: 0.690590  v_AUC: 0.907648
steps 8800    running time 334 seconds

steps 9000    base_loss: 0.185112    reg_loss: 0.067811    l2_loss: 0.029060    loss: 0.281984
steps 9000    v_Prec: 0.732655  v_Recall: 0.658736  v_F1: 0.693732  v_AUC: 0.908788
steps 9000    running time 340 seconds

steps 9200    base_loss: 0.192901    reg_loss: 0.067880    l2_loss: 0.029371    loss: 0.290151
steps 9200    v_Prec: 0.736360  v_Recall: 0.652928  v_F1: 0.692139  v_AUC: 0.908923
steps 9200    running time 347 seconds

steps 9400    base_loss: 0.184218    reg_loss: 0.067674    l2_loss: 0.029669    loss: 0.281562
steps 9400    v_Prec: 0.738410  v_Recall: 0.666614  v_F1: 0.700677  v_AUC: 0.911430
steps 9400    running time 353 seconds

steps 9600    base_loss: 0.179633    reg_loss: 0.067520    l2_loss: 0.029768    loss: 0.276921
steps 9600    v_Prec: 0.739460  v_Recall: 0.667091  v_F1: 0.701414  v_AUC: 0.912280
steps 9600    running time 360 seconds

steps 9800    base_loss: 0.185619    reg_loss: 0.067530    l2_loss: 0.029945    loss: 0.283093
steps 9800    v_Prec: 0.742437  v_Recall: 0.675684  v_F1: 0.707490  v_AUC: 0.914137
steps 9800    running time 367 seconds

steps 10000    base_loss: 0.187441    reg_loss: 0.067779    l2_loss: 0.030202    loss: 0.285422
steps 10000    v_Prec: 0.721034  v_Recall: 0.694701  v_F1: 0.707622  v_AUC: 0.915875
steps 10000    running time 374 seconds

steps 10200    base_loss: 0.189358    reg_loss: 0.067821    l2_loss: 0.030464    loss: 0.287643
steps 10200    v_Prec: 0.743170  v_Recall: 0.679663  v_F1: 0.709999  v_AUC: 0.917168
steps 10200    running time 382 seconds

steps 10400    base_loss: 0.197213    reg_loss: 0.067611    l2_loss: 0.030575    loss: 0.295400
steps 10400    v_Prec: 0.763432  v_Recall: 0.670433  v_F1: 0.713917  v_AUC: 0.918786
steps 10400    running time 389 seconds

steps 10600    base_loss: 0.191239    reg_loss: 0.067519    l2_loss: 0.030838    loss: 0.289596
steps 10600    v_Prec: 0.755944  v_Recall: 0.680458  v_F1: 0.716218  v_AUC: 0.919635
steps 10600    running time 396 seconds

steps 10800    base_loss: 0.171994    reg_loss: 0.067354    l2_loss: 0.030912    loss: 0.270261
steps 10800    v_Prec: 0.726945  v_Recall: 0.706875  v_F1: 0.716770  v_AUC: 0.918313
steps 10800    running time 403 seconds

steps 11000    base_loss: 0.074288    reg_loss: 0.066805    l2_loss: 0.031055    loss: 0.172148
steps 11000    v_Prec: 0.717633  v_Recall: 0.687142  v_F1: 0.702057  v_AUC: 0.912233
steps 11000    running time 409 seconds

steps 11200    base_loss: 0.076684    reg_loss: 0.067060    l2_loss: 0.031250    loss: 0.174993
steps 11200    v_Prec: 0.716002  v_Recall: 0.663988  v_F1: 0.689015  v_AUC: 0.904880
steps 11200    running time 416 seconds

steps 11400    base_loss: 0.076508    reg_loss: 0.066870    l2_loss: 0.031387    loss: 0.174765
steps 11400    v_Prec: 0.693818  v_Recall: 0.685869  v_F1: 0.689821  v_AUC: 0.905060
steps 11400    running time 422 seconds

steps 11600    base_loss: 0.073385    reg_loss: 0.066443    l2_loss: 0.031468    loss: 0.171295
steps 11600    v_Prec: 0.715188  v_Recall: 0.657543  v_F1: 0.685155  v_AUC: 0.902220
steps 11600    running time 429 seconds

steps 11800    base_loss: 0.079670    reg_loss: 0.066797    l2_loss: 0.031689    loss: 0.178157
steps 11800    v_Prec: 0.691150  v_Recall: 0.668603  v_F1: 0.679689  v_AUC: 0.898732
steps 11800    running time 435 seconds

steps 12000    base_loss: 0.078577    reg_loss: 0.066563    l2_loss: 0.031729    loss: 0.176869
steps 12000    v_Prec: 0.695656  v_Recall: 0.663829  v_F1: 0.679370  v_AUC: 0.897330
steps 12000    running time 441 seconds

steps 12200    base_loss: 0.081633    reg_loss: 0.066370    l2_loss: 0.031930    loss: 0.179933
steps 12200    v_Prec: 0.723479  v_Recall: 0.635980  v_F1: 0.676914  v_AUC: 0.898424
steps 12200    running time 448 seconds

steps 12400    base_loss: 0.084742    reg_loss: 0.066153    l2_loss: 0.032040    loss: 0.182935
steps 12400    v_Prec: 0.697728  v_Recall: 0.652371  v_F1: 0.674288  v_AUC: 0.896378
steps 12400    running time 454 seconds

steps 12600    base_loss: 0.079712    reg_loss: 0.066313    l2_loss: 0.032095    loss: 0.178120
steps 12600    v_Prec: 0.689900  v_Recall: 0.657623  v_F1: 0.673375  v_AUC: 0.895720
steps 12600    running time 461 seconds

steps 12800    base_loss: 0.083043    reg_loss: 0.066405    l2_loss: 0.032191    loss: 0.181639
steps 12800    v_Prec: 0.671442  v_Recall: 0.674968  v_F1: 0.673201  v_AUC: 0.897086
steps 12800    running time 467 seconds

Early stop model F1: 0.716770
testing thre: 0.39942008
testing Prec: 0.5216641231504213
testing Recall: 0.764228432563791
testing F1: 0.6200682217008103
testing AUC: 0.8983535256627608
overall running time 470 seconds
(0.7214306151645208, 0.61273390036452, 0.6626544021024968, 0.8983535256627608, 0.7816479)

2019-02-24 17:49:09.428369: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:49:10.897032: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:49:10.905337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:49:10.905388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.330000 seconds
loading data in 30.520000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 2.433886    reg_loss: 0.064829    l2_loss: 0.013233    loss: 2.511947
steps 200    v_Prec: 0.163116  v_Recall: 0.999360  v_F1: 0.280456  v_AUC: 0.515435
steps 200    running time 41 seconds

steps 400    base_loss: 1.422991    reg_loss: 0.064699    l2_loss: 0.012972    loss: 1.500663
steps 400    v_Prec: 0.164729  v_Recall: 0.992077  v_F1: 0.282543  v_AUC: 0.533139
steps 400    running time 48 seconds

steps 600    base_loss: 0.523003    reg_loss: 0.064160    l2_loss: 0.012676    loss: 0.599839
steps 600    v_Prec: 0.186130  v_Recall: 0.682378  v_F1: 0.292481  v_AUC: 0.575905
steps 600    running time 55 seconds

steps 800    base_loss: 0.450134    reg_loss: 0.063781    l2_loss: 0.012633    loss: 0.526547
steps 800    v_Prec: 0.221874  v_Recall: 0.538332  v_F1: 0.314236  v_AUC: 0.622552
steps 800    running time 62 seconds

steps 1000    base_loss: 0.446781    reg_loss: 0.063497    l2_loss: 0.012595    loss: 0.522872
steps 1000    v_Prec: 0.276344  v_Recall: 0.479113  v_F1: 0.350517  v_AUC: 0.672256
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.432905    reg_loss: 0.062970    l2_loss: 0.012610    loss: 0.508485
steps 1200    v_Prec: 0.321910  v_Recall: 0.473592  v_F1: 0.383290  v_AUC: 0.706306
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.422869    reg_loss: 0.062403    l2_loss: 0.012612    loss: 0.497885
steps 1400    v_Prec: 0.399631  v_Recall: 0.451024  v_F1: 0.423775  v_AUC: 0.743302
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.402700    reg_loss: 0.061955    l2_loss: 0.012699    loss: 0.477354
steps 1600    v_Prec: 0.432564  v_Recall: 0.484315  v_F1: 0.456979  v_AUC: 0.767739
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.391137    reg_loss: 0.061571    l2_loss: 0.012837    loss: 0.465545
steps 1800    v_Prec: 0.441838  v_Recall: 0.518566  v_F1: 0.477137  v_AUC: 0.790088
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.368526    reg_loss: 0.060981    l2_loss: 0.013037    loss: 0.442543
steps 2000    v_Prec: 0.505788  v_Recall: 0.517446  v_F1: 0.511551  v_AUC: 0.813077
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.356086    reg_loss: 0.060476    l2_loss: 0.013272    loss: 0.429834
steps 2200    v_Prec: 0.507234  v_Recall: 0.552737  v_F1: 0.529009  v_AUC: 0.827298
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.342416    reg_loss: 0.060176    l2_loss: 0.013596    loss: 0.416188
steps 2400    v_Prec: 0.545572  v_Recall: 0.573864  v_F1: 0.559360  v_AUC: 0.841610
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.328953    reg_loss: 0.059716    l2_loss: 0.013949    loss: 0.402617
steps 2600    v_Prec: 0.559107  v_Recall: 0.579465  v_F1: 0.569104  v_AUC: 0.848384
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.323222    reg_loss: 0.059526    l2_loss: 0.014337    loss: 0.397086
steps 2800    v_Prec: 0.582216  v_Recall: 0.583707  v_F1: 0.582960  v_AUC: 0.856803
steps 2800    running time 131 seconds

steps 3000    base_loss: 0.321485    reg_loss: 0.059095    l2_loss: 0.014791    loss: 0.395371
steps 3000    v_Prec: 0.581155  v_Recall: 0.608595  v_F1: 0.594559  v_AUC: 0.862597
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.313361    reg_loss: 0.058734    l2_loss: 0.015303    loss: 0.387398
steps 3200    v_Prec: 0.592468  v_Recall: 0.606834  v_F1: 0.599565  v_AUC: 0.866677
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.311369    reg_loss: 0.058421    l2_loss: 0.015833    loss: 0.385623
steps 3400    v_Prec: 0.583790  v_Recall: 0.631162  v_F1: 0.606552  v_AUC: 0.871250
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.301678    reg_loss: 0.057880    l2_loss: 0.016383    loss: 0.375941
steps 3600    v_Prec: 0.638757  v_Recall: 0.580586  v_F1: 0.608284  v_AUC: 0.873254
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.299848    reg_loss: 0.057421    l2_loss: 0.017050    loss: 0.374318
steps 3800    v_Prec: 0.633960  v_Recall: 0.596671  v_F1: 0.614750  v_AUC: 0.875231
steps 3800    running time 167 seconds

steps 4000    base_loss: 0.297647    reg_loss: 0.056850    l2_loss: 0.017651    loss: 0.372147
steps 4000    v_Prec: 0.633636  v_Recall: 0.608435  v_F1: 0.620780  v_AUC: 0.878780
steps 4000    running time 174 seconds

steps 4200    base_loss: 0.294515    reg_loss: 0.056330    l2_loss: 0.018350    loss: 0.369195
steps 4200    v_Prec: 0.631506  v_Recall: 0.620439  v_F1: 0.625923  v_AUC: 0.881089
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.292408    reg_loss: 0.055814    l2_loss: 0.019057    loss: 0.367280
steps 4400    v_Prec: 0.612597  v_Recall: 0.650688  v_F1: 0.631068  v_AUC: 0.883233
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.289321    reg_loss: 0.055040    l2_loss: 0.019837    loss: 0.364198
steps 4600    v_Prec: 0.640052  v_Recall: 0.627401  v_F1: 0.633663  v_AUC: 0.883948
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.287692    reg_loss: 0.054506    l2_loss: 0.020536    loss: 0.362734
steps 4800    v_Prec: 0.624554  v_Recall: 0.644846  v_F1: 0.634538  v_AUC: 0.885771
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.288671    reg_loss: 0.053965    l2_loss: 0.021310    loss: 0.363946
steps 5000    v_Prec: 0.661974  v_Recall: 0.613396  v_F1: 0.636760  v_AUC: 0.886416
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.297005    reg_loss: 0.053482    l2_loss: 0.022157    loss: 0.372644
steps 5200    v_Prec: 0.630136  v_Recall: 0.652929  v_F1: 0.641330  v_AUC: 0.886410
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.280290    reg_loss: 0.053101    l2_loss: 0.022930    loss: 0.356320
steps 5400    v_Prec: 0.673894  v_Recall: 0.619318  v_F1: 0.645455  v_AUC: 0.887184
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.173749    reg_loss: 0.054816    l2_loss: 0.023587    loss: 0.252153
steps 5600    v_Prec: 0.641371  v_Recall: 0.624280  v_F1: 0.632710  v_AUC: 0.884219
steps 5600    running time 230 seconds

steps 5800    base_loss: 0.175277    reg_loss: 0.055389    l2_loss: 0.024127    loss: 0.254794
steps 5800    v_Prec: 0.625820  v_Recall: 0.633483  v_F1: 0.629628  v_AUC: 0.881783
steps 5800    running time 236 seconds

steps 6000    base_loss: 0.179640    reg_loss: 0.055631    l2_loss: 0.024736    loss: 0.260008
steps 6000    v_Prec: 0.625484  v_Recall: 0.633243  v_F1: 0.629339  v_AUC: 0.880568
steps 6000    running time 242 seconds

steps 6200    base_loss: 0.168250    reg_loss: 0.055391    l2_loss: 0.025242    loss: 0.248882
steps 6200    v_Prec: 0.627702  v_Recall: 0.632122  v_F1: 0.629904  v_AUC: 0.879941
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.182329    reg_loss: 0.055633    l2_loss: 0.025775    loss: 0.263737
steps 6400    v_Prec: 0.633282  v_Recall: 0.621879  v_F1: 0.627529  v_AUC: 0.878995
steps 6400    running time 255 seconds

steps 6600    base_loss: 0.177765    reg_loss: 0.055349    l2_loss: 0.026268    loss: 0.259381
steps 6600    v_Prec: 0.635769  v_Recall: 0.621879  v_F1: 0.628747  v_AUC: 0.882249
steps 6600    running time 261 seconds

steps 6800    base_loss: 0.173525    reg_loss: 0.055297    l2_loss: 0.026684    loss: 0.255507
steps 6800    v_Prec: 0.629919  v_Recall: 0.631482  v_F1: 0.630700  v_AUC: 0.879730
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.172887    reg_loss: 0.055292    l2_loss: 0.027088    loss: 0.255267
steps 7000    v_Prec: 0.626596  v_Recall: 0.636124  v_F1: 0.631324  v_AUC: 0.880723
steps 7000    running time 274 seconds

steps 7200    base_loss: 0.177443    reg_loss: 0.055244    l2_loss: 0.027571    loss: 0.260258
steps 7200    v_Prec: 0.609709  v_Recall: 0.657330  v_F1: 0.632625  v_AUC: 0.880613
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.183840    reg_loss: 0.054943    l2_loss: 0.028022    loss: 0.266805
steps 7400    v_Prec: 0.618738  v_Recall: 0.646367  v_F1: 0.632250  v_AUC: 0.881108
steps 7400    running time 287 seconds

Early stop model F1: 0.645455
testing thre: 0.45855004
testing Prec: 0.5114415269429505
testing Recall: 0.707168894289186
testing F1: 0.5935868146214099
testing AUC: 0.872367372246011
overall running time 289 seconds
(0.6629342363993882, 0.5898906439854192, 0.6242831057274387, 0.872367372246011, 0.668245)

2019-02-24 17:52:29.377670: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:52:30.388515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:52:30.396055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:52:30.396108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.140000 seconds
loading data in 30.210000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.545095    reg_loss: 0.064626    l2_loss: 0.013322    loss: 0.623043
steps 200    v_Prec: 0.165408  v_Recall: 0.995257  v_F1: 0.283671  v_AUC: 0.516568
steps 200    running time 40 seconds

steps 400    base_loss: 0.500784    reg_loss: 0.064578    l2_loss: 0.013256    loss: 0.578618
steps 400    v_Prec: 0.167082  v_Recall: 0.954075  v_F1: 0.284365  v_AUC: 0.534921
steps 400    running time 47 seconds

steps 600    base_loss: 0.481452    reg_loss: 0.064127    l2_loss: 0.013120    loss: 0.558698
steps 600    v_Prec: 0.174056  v_Recall: 0.838432  v_F1: 0.288269  v_AUC: 0.554173
steps 600    running time 54 seconds

steps 800    base_loss: 0.462572    reg_loss: 0.063490    l2_loss: 0.012919    loss: 0.538980
steps 800    v_Prec: 0.192459  v_Recall: 0.658841  v_F1: 0.297897  v_AUC: 0.580725
steps 800    running time 61 seconds

steps 1000    base_loss: 0.448040    reg_loss: 0.062745    l2_loss: 0.012795    loss: 0.523580
steps 1000    v_Prec: 0.231343  v_Recall: 0.547150  v_F1: 0.325190  v_AUC: 0.639213
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.438933    reg_loss: 0.061859    l2_loss: 0.012651    loss: 0.513442
steps 1200    v_Prec: 0.308251  v_Recall: 0.456249  v_F1: 0.367925  v_AUC: 0.685845
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.424851    reg_loss: 0.061062    l2_loss: 0.012681    loss: 0.498594
steps 1400    v_Prec: 0.393125  v_Recall: 0.451980  v_F1: 0.420503  v_AUC: 0.731974
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.399356    reg_loss: 0.060399    l2_loss: 0.012794    loss: 0.472549
steps 1600    v_Prec: 0.449368  v_Recall: 0.494585  v_F1: 0.470894  v_AUC: 0.777651
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.376502    reg_loss: 0.059912    l2_loss: 0.013044    loss: 0.449458
steps 1800    v_Prec: 0.504493  v_Recall: 0.510315  v_F1: 0.507388  v_AUC: 0.804439
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.357774    reg_loss: 0.059294    l2_loss: 0.013312    loss: 0.430380
steps 2000    v_Prec: 0.541320  v_Recall: 0.544700  v_F1: 0.543005  v_AUC: 0.830085
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.335564    reg_loss: 0.058805    l2_loss: 0.013716    loss: 0.408085
steps 2200    v_Prec: 0.554476  v_Recall: 0.581693  v_F1: 0.567758  v_AUC: 0.842959
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.327144    reg_loss: 0.058389    l2_loss: 0.014132    loss: 0.399665
steps 2400    v_Prec: 0.602940  v_Recall: 0.570627  v_F1: 0.586339  v_AUC: 0.852210
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.324296    reg_loss: 0.057778    l2_loss: 0.014503    loss: 0.396577
steps 2600    v_Prec: 0.592008  v_Recall: 0.596079  v_F1: 0.594037  v_AUC: 0.859745
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.312740    reg_loss: 0.057249    l2_loss: 0.015017    loss: 0.385005
steps 2800    v_Prec: 0.604248  v_Recall: 0.613944  v_F1: 0.609057  v_AUC: 0.867228
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.311646    reg_loss: 0.056808    l2_loss: 0.015486    loss: 0.383940
steps 3000    v_Prec: 0.621064  v_Recall: 0.614339  v_F1: 0.617683  v_AUC: 0.871557
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.301759    reg_loss: 0.056129    l2_loss: 0.015964    loss: 0.373853
steps 3200    v_Prec: 0.628461  v_Recall: 0.615445  v_F1: 0.621885  v_AUC: 0.874694
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.308721    reg_loss: 0.055773    l2_loss: 0.016548    loss: 0.381042
steps 3400    v_Prec: 0.650713  v_Recall: 0.606118  v_F1: 0.627624  v_AUC: 0.879791
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.302483    reg_loss: 0.055149    l2_loss: 0.017107    loss: 0.374739
steps 3600    v_Prec: 0.629451  v_Recall: 0.628804  v_F1: 0.629127  v_AUC: 0.880437
steps 3600    running time 159 seconds

steps 3800    base_loss: 0.292644    reg_loss: 0.054609    l2_loss: 0.017698    loss: 0.364951
steps 3800    v_Prec: 0.645546  v_Recall: 0.620900  v_F1: 0.632983  v_AUC: 0.882676
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.295834    reg_loss: 0.054071    l2_loss: 0.018354    loss: 0.368259
steps 4000    v_Prec: 0.625325  v_Recall: 0.646826  v_F1: 0.635894  v_AUC: 0.884964
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.291377    reg_loss: 0.053298    l2_loss: 0.019022    loss: 0.363697
steps 4200    v_Prec: 0.664321  v_Recall: 0.619319  v_F1: 0.641031  v_AUC: 0.885799
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.291414    reg_loss: 0.052723    l2_loss: 0.019682    loss: 0.363819
steps 4400    v_Prec: 0.660409  v_Recall: 0.625642  v_F1: 0.642556  v_AUC: 0.887722
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.291699    reg_loss: 0.052156    l2_loss: 0.020326    loss: 0.364181
steps 4600    v_Prec: 0.652534  v_Recall: 0.647222  v_F1: 0.649867  v_AUC: 0.888332
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.290219    reg_loss: 0.051504    l2_loss: 0.021026    loss: 0.362749
steps 4800    v_Prec: 0.668968  v_Recall: 0.635760  v_F1: 0.651941  v_AUC: 0.890127
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.290337    reg_loss: 0.051037    l2_loss: 0.021723    loss: 0.363097
steps 5000    v_Prec: 0.680440  v_Recall: 0.631333  v_F1: 0.654967  v_AUC: 0.893070
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.288153    reg_loss: 0.050574    l2_loss: 0.022476    loss: 0.361203
steps 5200    v_Prec: 0.673719  v_Recall: 0.639317  v_F1: 0.656067  v_AUC: 0.893775
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.282849    reg_loss: 0.049927    l2_loss: 0.023182    loss: 0.355957
steps 5400    v_Prec: 0.691196  v_Recall: 0.627381  v_F1: 0.657744  v_AUC: 0.892184
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.167541    reg_loss: 0.051709    l2_loss: 0.023735    loss: 0.242985
steps 5600    v_Prec: 0.673891  v_Recall: 0.626749  v_F1: 0.649466  v_AUC: 0.888662
steps 5600    running time 229 seconds

steps 5800    base_loss: 0.161515    reg_loss: 0.052310    l2_loss: 0.024242    loss: 0.238068
steps 5800    v_Prec: 0.651066  v_Recall: 0.644376  v_F1: 0.647704  v_AUC: 0.884503
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.181537    reg_loss: 0.052557    l2_loss: 0.024865    loss: 0.258959
steps 6000    v_Prec: 0.648077  v_Recall: 0.642084  v_F1: 0.645067  v_AUC: 0.884282
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.165539    reg_loss: 0.052372    l2_loss: 0.025459    loss: 0.243369
steps 6200    v_Prec: 0.653824  v_Recall: 0.627776  v_F1: 0.640536  v_AUC: 0.881999
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.171944    reg_loss: 0.052541    l2_loss: 0.025986    loss: 0.250471
steps 6400    v_Prec: 0.648975  v_Recall: 0.633072  v_F1: 0.640925  v_AUC: 0.884899
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.185536    reg_loss: 0.052113    l2_loss: 0.026459    loss: 0.264109
steps 6600    v_Prec: 0.657727  v_Recall: 0.637815  v_F1: 0.647618  v_AUC: 0.885172
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.180443    reg_loss: 0.051876    l2_loss: 0.026817    loss: 0.259136
steps 6800    v_Prec: 0.652534  v_Recall: 0.648407  v_F1: 0.650464  v_AUC: 0.887192
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.163381    reg_loss: 0.051721    l2_loss: 0.027220    loss: 0.242322
steps 7000    v_Prec: 0.668241  v_Recall: 0.626196  v_F1: 0.646536  v_AUC: 0.884134
steps 7000    running time 273 seconds

steps 7200    base_loss: 0.178102    reg_loss: 0.051817    l2_loss: 0.027689    loss: 0.257608
steps 7200    v_Prec: 0.658804  v_Recall: 0.640266  v_F1: 0.649403  v_AUC: 0.887323
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.183497    reg_loss: 0.051324    l2_loss: 0.028109    loss: 0.262930
steps 7400    v_Prec: 0.649980  v_Recall: 0.651727  v_F1: 0.650853  v_AUC: 0.886857
steps 7400    running time 286 seconds

Early stop model F1: 0.657744
testing thre: 0.36179772
testing Prec: 0.5158570571841817
testing Recall: 0.7107168894289186
testing F1: 0.5978087567965332
testing AUC: 0.8761723146814758
overall running time 289 seconds
(0.6492138364779875, 0.6020413122721749, 0.6247383684276888, 0.8761723146814758, 0.5657722)

2019-02-24 17:55:49.108478: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 17:55:49.550901: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 17:55:49.551782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 17:55:49.551827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.610000 seconds
loading data in 30.960000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.561398    reg_loss: 0.064876    l2_loss: 0.013351    loss: 0.639625
steps 200    v_Prec: 0.163077  v_Recall: 0.999440  v_F1: 0.280401  v_AUC: 0.532417
steps 200    running time 41 seconds

steps 400    base_loss: 0.520106    reg_loss: 0.064665    l2_loss: 0.013270    loss: 0.598041
steps 400    v_Prec: 0.170587  v_Recall: 0.860379  v_F1: 0.284723  v_AUC: 0.552602
steps 400    running time 48 seconds

steps 600    base_loss: 0.493397    reg_loss: 0.064279    l2_loss: 0.013194    loss: 0.570870
steps 600    v_Prec: 0.203986  v_Recall: 0.590025  v_F1: 0.303161  v_AUC: 0.603363
steps 600    running time 55 seconds

steps 800    base_loss: 0.467509    reg_loss: 0.063838    l2_loss: 0.013095    loss: 0.544441
steps 800    v_Prec: 0.266001  v_Recall: 0.514050  v_F1: 0.350587  v_AUC: 0.670881
steps 800    running time 62 seconds

steps 1000    base_loss: 0.441321    reg_loss: 0.062911    l2_loss: 0.013041    loss: 0.517274
steps 1000    v_Prec: 0.379107  v_Recall: 0.423025  v_F1: 0.399864  v_AUC: 0.714317
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.410916    reg_loss: 0.061821    l2_loss: 0.013083    loss: 0.485820
steps 1200    v_Prec: 0.457979  v_Recall: 0.461132  v_F1: 0.459550  v_AUC: 0.756833
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.392144    reg_loss: 0.061173    l2_loss: 0.013177    loss: 0.466494
steps 1400    v_Prec: 0.544722  v_Recall: 0.492435  v_F1: 0.517260  v_AUC: 0.794908
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.363859    reg_loss: 0.060468    l2_loss: 0.013417    loss: 0.437744
steps 1600    v_Prec: 0.591756  v_Recall: 0.524057  v_F1: 0.555853  v_AUC: 0.820590
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.353795    reg_loss: 0.060010    l2_loss: 0.013611    loss: 0.427416
steps 1800    v_Prec: 0.622004  v_Recall: 0.548555  v_F1: 0.582975  v_AUC: 0.838499
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.329077    reg_loss: 0.059205    l2_loss: 0.013917    loss: 0.402200
steps 2000    v_Prec: 0.652089  v_Recall: 0.561044  v_F1: 0.603150  v_AUC: 0.851291
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.318210    reg_loss: 0.058499    l2_loss: 0.014212    loss: 0.390920
steps 2200    v_Prec: 0.693267  v_Recall: 0.565447  v_F1: 0.622867  v_AUC: 0.861205
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.316954    reg_loss: 0.058056    l2_loss: 0.014551    loss: 0.389561
steps 2400    v_Prec: 0.709696  v_Recall: 0.585381  v_F1: 0.641572  v_AUC: 0.869845
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.300610    reg_loss: 0.057387    l2_loss: 0.014856    loss: 0.372853
steps 2600    v_Prec: 0.734538  v_Recall: 0.579057  v_F1: 0.647596  v_AUC: 0.875309
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.286200    reg_loss: 0.057139    l2_loss: 0.015215    loss: 0.358554
steps 2800    v_Prec: 0.708024  v_Recall: 0.611720  v_F1: 0.656359  v_AUC: 0.879349
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.285293    reg_loss: 0.056645    l2_loss: 0.015507    loss: 0.357446
steps 3000    v_Prec: 0.689356  v_Recall: 0.642943  v_F1: 0.665341  v_AUC: 0.881408
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.286012    reg_loss: 0.056166    l2_loss: 0.015837    loss: 0.358015
steps 3200    v_Prec: 0.719109  v_Recall: 0.630854  v_F1: 0.672097  v_AUC: 0.884398
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.277303    reg_loss: 0.055532    l2_loss: 0.016214    loss: 0.349050
steps 3400    v_Prec: 0.713993  v_Recall: 0.641742  v_F1: 0.675942  v_AUC: 0.887543
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.271828    reg_loss: 0.055377    l2_loss: 0.016532    loss: 0.343736
steps 3600    v_Prec: 0.761251  v_Recall: 0.621568  v_F1: 0.684354  v_AUC: 0.890179
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.278323    reg_loss: 0.055271    l2_loss: 0.016894    loss: 0.350488
steps 3800    v_Prec: 0.729383  v_Recall: 0.646465  v_F1: 0.685426  v_AUC: 0.891365
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.271232    reg_loss: 0.055011    l2_loss: 0.017239    loss: 0.343481
steps 4000    v_Prec: 0.745844  v_Recall: 0.650068  v_F1: 0.694670  v_AUC: 0.895382
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.270063    reg_loss: 0.054889    l2_loss: 0.017610    loss: 0.342562
steps 4200    v_Prec: 0.739880  v_Recall: 0.662877  v_F1: 0.699265  v_AUC: 0.897169
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.258830    reg_loss: 0.054522    l2_loss: 0.017976    loss: 0.331328
steps 4400    v_Prec: 0.753109  v_Recall: 0.654471  v_F1: 0.700334  v_AUC: 0.898589
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.271059    reg_loss: 0.054576    l2_loss: 0.018396    loss: 0.344031
steps 4600    v_Prec: 0.760126  v_Recall: 0.655032  v_F1: 0.703677  v_AUC: 0.900520
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.256117    reg_loss: 0.054222    l2_loss: 0.018779    loss: 0.329119
steps 4800    v_Prec: 0.755745  v_Recall: 0.668802  v_F1: 0.709620  v_AUC: 0.901725
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.261058    reg_loss: 0.054298    l2_loss: 0.019207    loss: 0.334562
steps 5000    v_Prec: 0.761525  v_Recall: 0.671844  v_F1: 0.713879  v_AUC: 0.903933
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.253308    reg_loss: 0.054116    l2_loss: 0.019571    loss: 0.326995
steps 5200    v_Prec: 0.763117  v_Recall: 0.662557  v_F1: 0.709290  v_AUC: 0.905049
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.254664    reg_loss: 0.053845    l2_loss: 0.020075    loss: 0.328584
steps 5400    v_Prec: 0.766264  v_Recall: 0.669522  v_F1: 0.714634  v_AUC: 0.908058
steps 5400    running time 221 seconds

steps 5600    base_loss: 0.165759    reg_loss: 0.050550    l2_loss: 0.020427    loss: 0.236736
steps 5600    v_Prec: 0.767845  v_Recall: 0.658794  v_F1: 0.709152  v_AUC: 0.903544
steps 5600    running time 228 seconds

steps 5800    base_loss: 0.156863    reg_loss: 0.050161    l2_loss: 0.021086    loss: 0.228110
steps 5800    v_Prec: 0.742118  v_Recall: 0.672724  v_F1: 0.705719  v_AUC: 0.900583
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.163506    reg_loss: 0.050185    l2_loss: 0.021840    loss: 0.235531
steps 6000    v_Prec: 0.777522  v_Recall: 0.649107  v_F1: 0.707535  v_AUC: 0.900513
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.163756    reg_loss: 0.050196    l2_loss: 0.022426    loss: 0.236378
steps 6200    v_Prec: 0.762731  v_Recall: 0.665519  v_F1: 0.710817  v_AUC: 0.899964
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.172735    reg_loss: 0.049986    l2_loss: 0.023018    loss: 0.245740
steps 6400    v_Prec: 0.773108  v_Recall: 0.658234  v_F1: 0.711061  v_AUC: 0.900779
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.170562    reg_loss: 0.050076    l2_loss: 0.023365    loss: 0.244003
steps 6600    v_Prec: 0.770417  v_Recall: 0.663838  v_F1: 0.713168  v_AUC: 0.902265
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.173850    reg_loss: 0.049751    l2_loss: 0.023836    loss: 0.247437
steps 6800    v_Prec: 0.759201  v_Recall: 0.675446  v_F1: 0.714879  v_AUC: 0.901867
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.170847    reg_loss: 0.049582    l2_loss: 0.024326    loss: 0.244755
steps 7000    v_Prec: 0.787026  v_Recall: 0.658554  v_F1: 0.717081  v_AUC: 0.901574
steps 7000    running time 274 seconds

steps 7200    base_loss: 0.180005    reg_loss: 0.049597    l2_loss: 0.024647    loss: 0.254248
steps 7200    v_Prec: 0.774836  v_Recall: 0.670002  v_F1: 0.718616  v_AUC: 0.904609
steps 7200    running time 281 seconds

steps 7400    base_loss: 0.184345    reg_loss: 0.049245    l2_loss: 0.024867    loss: 0.258457
steps 7400    v_Prec: 0.779934  v_Recall: 0.665919  v_F1: 0.718432  v_AUC: 0.903675
steps 7400    running time 288 seconds

steps 7600    base_loss: 0.178782    reg_loss: 0.049048    l2_loss: 0.024990    loss: 0.252820
steps 7600    v_Prec: 0.794294  v_Recall: 0.657513  v_F1: 0.719460  v_AUC: 0.905293
steps 7600    running time 294 seconds

steps 7800    base_loss: 0.170209    reg_loss: 0.048552    l2_loss: 0.025370    loss: 0.244131
steps 7800    v_Prec: 0.766189  v_Recall: 0.681050  v_F1: 0.721116  v_AUC: 0.906476
steps 7800    running time 301 seconds

steps 8000    base_loss: 0.173169    reg_loss: 0.048486    l2_loss: 0.025546    loss: 0.247201
steps 8000    v_Prec: 0.762028  v_Recall: 0.683452  v_F1: 0.720604  v_AUC: 0.908120
steps 8000    running time 308 seconds

steps 8200    base_loss: 0.176154    reg_loss: 0.048194    l2_loss: 0.025779    loss: 0.250128
steps 8200    v_Prec: 0.774343  v_Recall: 0.681851  v_F1: 0.725160  v_AUC: 0.910765
steps 8200    running time 314 seconds

steps 8400    base_loss: 0.198941    reg_loss: 0.048348    l2_loss: 0.025879    loss: 0.273168
steps 8400    v_Prec: 0.795717  v_Recall: 0.672324  v_F1: 0.728835  v_AUC: 0.910741
steps 8400    running time 321 seconds

steps 8600    base_loss: 0.185444    reg_loss: 0.048118    l2_loss: 0.026023    loss: 0.259585
steps 8600    v_Prec: 0.780714  v_Recall: 0.688336  v_F1: 0.731620  v_AUC: 0.912761
steps 8600    running time 328 seconds

steps 8800    base_loss: 0.178361    reg_loss: 0.047821    l2_loss: 0.026273    loss: 0.252456
steps 8800    v_Prec: 0.776047  v_Recall: 0.689937  v_F1: 0.730463  v_AUC: 0.914086
steps 8800    running time 335 seconds

steps 9000    base_loss: 0.179174    reg_loss: 0.047659    l2_loss: 0.026367    loss: 0.253200
steps 9000    v_Prec: 0.770667  v_Recall: 0.697062  v_F1: 0.732019  v_AUC: 0.914402
steps 9000    running time 341 seconds

steps 9200    base_loss: 0.182034    reg_loss: 0.047755    l2_loss: 0.026381    loss: 0.256171
steps 9200    v_Prec: 0.765400  v_Recall: 0.706269  v_F1: 0.734646  v_AUC: 0.915734
steps 9200    running time 348 seconds

steps 9400    base_loss: 0.186117    reg_loss: 0.047938    l2_loss: 0.026592    loss: 0.260646
steps 9400    v_Prec: 0.777699  v_Recall: 0.698503  v_F1: 0.735976  v_AUC: 0.916652
steps 9400    running time 355 seconds

steps 9600    base_loss: 0.184517    reg_loss: 0.047647    l2_loss: 0.026595    loss: 0.258760
steps 9600    v_Prec: 0.773182  v_Recall: 0.712273  v_F1: 0.741478  v_AUC: 0.918005
steps 9600    running time 362 seconds

steps 9800    base_loss: 0.181879    reg_loss: 0.047451    l2_loss: 0.026686    loss: 0.256016
steps 9800    v_Prec: 0.798915  v_Recall: 0.695621  v_F1: 0.743698  v_AUC: 0.918563
steps 9800    running time 369 seconds

steps 10000    base_loss: 0.187011    reg_loss: 0.047304    l2_loss: 0.026746    loss: 0.261061
steps 10000    v_Prec: 0.775039  v_Recall: 0.712433  v_F1: 0.742419  v_AUC: 0.918719
steps 10000    running time 376 seconds

steps 10200    base_loss: 0.176676    reg_loss: 0.046933    l2_loss: 0.026655    loss: 0.250264
steps 10200    v_Prec: 0.786219  v_Recall: 0.704267  v_F1: 0.742990  v_AUC: 0.918861
steps 10200    running time 383 seconds

steps 10400    base_loss: 0.181207    reg_loss: 0.047426    l2_loss: 0.026952    loss: 0.255585
steps 10400    v_Prec: 0.782075  v_Recall: 0.713954  v_F1: 0.746464  v_AUC: 0.920605
steps 10400    running time 389 seconds

steps 10600    base_loss: 0.186284    reg_loss: 0.047329    l2_loss: 0.026971    loss: 0.260584
steps 10600    v_Prec: 0.798658  v_Recall: 0.695781  v_F1: 0.743679  v_AUC: 0.921058
steps 10600    running time 396 seconds

steps 10800    base_loss: 0.165924    reg_loss: 0.046477    l2_loss: 0.026986    loss: 0.239387
steps 10800    v_Prec: 0.782162  v_Recall: 0.712593  v_F1: 0.745758  v_AUC: 0.921806
steps 10800    running time 402 seconds

steps 11000    base_loss: 0.067065    reg_loss: 0.042292    l2_loss: 0.026920    loss: 0.136277
steps 11000    v_Prec: 0.808446  v_Recall: 0.686574  v_F1: 0.742543  v_AUC: 0.919657
steps 11000    running time 409 seconds

steps 11200    base_loss: 0.062475    reg_loss: 0.042438    l2_loss: 0.026760    loss: 0.131673
steps 11200    v_Prec: 0.799406  v_Recall: 0.690097  v_F1: 0.740741  v_AUC: 0.917788
steps 11200    running time 415 seconds

steps 11400    base_loss: 0.070811    reg_loss: 0.042680    l2_loss: 0.026708    loss: 0.140199
steps 11400    v_Prec: 0.808063  v_Recall: 0.677128  v_F1: 0.736824  v_AUC: 0.915770
steps 11400    running time 422 seconds

steps 11600    base_loss: 0.064746    reg_loss: 0.042459    l2_loss: 0.026594    loss: 0.133799
steps 11600    v_Prec: 0.789662  v_Recall: 0.689777  v_F1: 0.736347  v_AUC: 0.915467
steps 11600    running time 428 seconds

steps 11800    base_loss: 0.067920    reg_loss: 0.042735    l2_loss: 0.026722    loss: 0.137377
steps 11800    v_Prec: 0.786915  v_Recall: 0.693299  v_F1: 0.737147  v_AUC: 0.915775
steps 11800    running time 434 seconds

steps 12000    base_loss: 0.071667    reg_loss: 0.042749    l2_loss: 0.026604    loss: 0.141020
steps 12000    v_Prec: 0.796875  v_Recall: 0.681851  v_F1: 0.734889  v_AUC: 0.915298
steps 12000    running time 441 seconds

steps 12200    base_loss: 0.068682    reg_loss: 0.042799    l2_loss: 0.026643    loss: 0.138124
steps 12200    v_Prec: 0.782452  v_Recall: 0.693940  v_F1: 0.735542  v_AUC: 0.914146
steps 12200    running time 447 seconds

steps 12400    base_loss: 0.073396    reg_loss: 0.042986    l2_loss: 0.026660    loss: 0.143042
steps 12400    v_Prec: 0.778549  v_Recall: 0.700264  v_F1: 0.737335  v_AUC: 0.914163
steps 12400    running time 453 seconds

Early stop model F1: 0.746464
testing thre: 0.42250794
testing Prec: 0.5694742106015145
testing Recall: 0.7748724179829891
testing F1: 0.6564822630787919
testing AUC: 0.9063607335450816
overall running time 456 seconds
(0.7273015705145154, 0.6684811664641556, 0.6966519779162235, 0.9063607335450816, 0.7225013)

2019-02-24 18:00:56.336539: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:00:57.292210: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:00:57.293816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:00:57.293855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.730000 seconds
loading data in 30.700000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.044806    reg_loss: 0.064873    l2_loss: 0.013300    loss: 1.122979
steps 200    v_Prec: 0.162926  v_Recall: 1.000000  v_F1: 0.280201  v_AUC: 0.473812
steps 200    running time 41 seconds

steps 400    base_loss: 0.756394    reg_loss: 0.065181    l2_loss: 0.013067    loss: 0.834642
steps 400    v_Prec: 0.163426  v_Recall: 0.992953  v_F1: 0.280660  v_AUC: 0.490573
steps 400    running time 48 seconds

steps 600    base_loss: 0.484539    reg_loss: 0.065005    l2_loss: 0.012495    loss: 0.562039
steps 600    v_Prec: 0.170518  v_Recall: 0.900697  v_F1: 0.286749  v_AUC: 0.546950
steps 600    running time 55 seconds

steps 800    base_loss: 0.459029    reg_loss: 0.064740    l2_loss: 0.012255    loss: 0.536024
steps 800    v_Prec: 0.237151  v_Recall: 0.531353  v_F1: 0.327938  v_AUC: 0.639710
steps 800    running time 62 seconds

steps 1000    base_loss: 0.447959    reg_loss: 0.064850    l2_loss: 0.012059    loss: 0.524868
steps 1000    v_Prec: 0.350971  v_Recall: 0.457356  v_F1: 0.397163  v_AUC: 0.713417
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.424441    reg_loss: 0.064971    l2_loss: 0.012028    loss: 0.501441
steps 1200    v_Prec: 0.469796  v_Recall: 0.477697  v_F1: 0.473713  v_AUC: 0.770626
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.393701    reg_loss: 0.065135    l2_loss: 0.012101    loss: 0.470937
steps 1400    v_Prec: 0.525137  v_Recall: 0.521983  v_F1: 0.523555  v_AUC: 0.803066
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.362396    reg_loss: 0.065380    l2_loss: 0.012215    loss: 0.439992
steps 1600    v_Prec: 0.553769  v_Recall: 0.548891  v_F1: 0.551319  v_AUC: 0.823494
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.349089    reg_loss: 0.065882    l2_loss: 0.012357    loss: 0.427328
steps 1800    v_Prec: 0.617843  v_Recall: 0.549612  v_F1: 0.581733  v_AUC: 0.844149
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.323913    reg_loss: 0.066072    l2_loss: 0.012634    loss: 0.402620
steps 2000    v_Prec: 0.631047  v_Recall: 0.574598  v_F1: 0.601501  v_AUC: 0.854915
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.312029    reg_loss: 0.066475    l2_loss: 0.012913    loss: 0.391417
steps 2200    v_Prec: 0.671857  v_Recall: 0.573556  v_F1: 0.618827  v_AUC: 0.864548
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.300927    reg_loss: 0.066611    l2_loss: 0.013328    loss: 0.380866
steps 2400    v_Prec: 0.681856  v_Recall: 0.584768  v_F1: 0.629591  v_AUC: 0.871519
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.297436    reg_loss: 0.067044    l2_loss: 0.013673    loss: 0.378152
steps 2600    v_Prec: 0.670937  v_Recall: 0.616561  v_F1: 0.642601  v_AUC: 0.875969
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.288254    reg_loss: 0.066932    l2_loss: 0.014054    loss: 0.369241
steps 2800    v_Prec: 0.690591  v_Recall: 0.607191  v_F1: 0.646212  v_AUC: 0.881058
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.291421    reg_loss: 0.067264    l2_loss: 0.014432    loss: 0.373118
steps 3000    v_Prec: 0.676433  v_Recall: 0.628654  v_F1: 0.651669  v_AUC: 0.883381
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.285907    reg_loss: 0.067224    l2_loss: 0.014818    loss: 0.367949
steps 3200    v_Prec: 0.678472  v_Recall: 0.644350  v_F1: 0.660971  v_AUC: 0.888415
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.278452    reg_loss: 0.067088    l2_loss: 0.015225    loss: 0.360765
steps 3400    v_Prec: 0.716288  v_Recall: 0.618083  v_F1: 0.663571  v_AUC: 0.890694
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.279618    reg_loss: 0.067283    l2_loss: 0.015631    loss: 0.362532
steps 3600    v_Prec: 0.712127  v_Recall: 0.630175  v_F1: 0.668649  v_AUC: 0.893524
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.277948    reg_loss: 0.067211    l2_loss: 0.016089    loss: 0.361248
steps 3800    v_Prec: 0.691522  v_Recall: 0.661728  v_F1: 0.676297  v_AUC: 0.896886
steps 3800    running time 167 seconds

steps 4000    base_loss: 0.272731    reg_loss: 0.067283    l2_loss: 0.016565    loss: 0.356580
steps 4000    v_Prec: 0.727804  v_Recall: 0.628894  v_F1: 0.674743  v_AUC: 0.898837
steps 4000    running time 174 seconds

steps 4200    base_loss: 0.265839    reg_loss: 0.067445    l2_loss: 0.017028    loss: 0.350312
steps 4200    v_Prec: 0.711203  v_Recall: 0.646673  v_F1: 0.677404  v_AUC: 0.900203
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.267619    reg_loss: 0.067222    l2_loss: 0.017628    loss: 0.352468
steps 4400    v_Prec: 0.698293  v_Recall: 0.658365  v_F1: 0.677741  v_AUC: 0.901072
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.260701    reg_loss: 0.067111    l2_loss: 0.018160    loss: 0.345972
steps 4600    v_Prec: 0.724957  v_Recall: 0.640426  v_F1: 0.680075  v_AUC: 0.902767
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.270204    reg_loss: 0.067274    l2_loss: 0.018731    loss: 0.356208
steps 4800    v_Prec: 0.714098  v_Recall: 0.651878  v_F1: 0.681571  v_AUC: 0.903731
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.264449    reg_loss: 0.067047    l2_loss: 0.019296    loss: 0.350792
steps 5000    v_Prec: 0.700338  v_Recall: 0.664611  v_F1: 0.682007  v_AUC: 0.903422
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.268845    reg_loss: 0.067258    l2_loss: 0.019914    loss: 0.356017
steps 5200    v_Prec: 0.722451  v_Recall: 0.645792  v_F1: 0.681974  v_AUC: 0.904251
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.265924    reg_loss: 0.067229    l2_loss: 0.020598    loss: 0.353751
steps 5400    v_Prec: 0.710913  v_Recall: 0.658365  v_F1: 0.683631  v_AUC: 0.905395
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.171404    reg_loss: 0.067295    l2_loss: 0.021440    loss: 0.260139
steps 5600    v_Prec: 0.712556  v_Recall: 0.654921  v_F1: 0.682524  v_AUC: 0.903136
steps 5600    running time 229 seconds

steps 5800    base_loss: 0.180772    reg_loss: 0.067426    l2_loss: 0.022293    loss: 0.270491
steps 5800    v_Prec: 0.696486  v_Recall: 0.660287  v_F1: 0.677903  v_AUC: 0.901617
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.179338    reg_loss: 0.067195    l2_loss: 0.023144    loss: 0.269678
steps 6000    v_Prec: 0.707373  v_Recall: 0.646192  v_F1: 0.675400  v_AUC: 0.900311
steps 6000    running time 242 seconds

steps 6200    base_loss: 0.170986    reg_loss: 0.067013    l2_loss: 0.023892    loss: 0.261892
steps 6200    v_Prec: 0.706283  v_Recall: 0.648194  v_F1: 0.675993  v_AUC: 0.899178
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.178313    reg_loss: 0.067257    l2_loss: 0.024481    loss: 0.270050
steps 6400    v_Prec: 0.696328  v_Recall: 0.663650  v_F1: 0.679597  v_AUC: 0.899000
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.179991    reg_loss: 0.067294    l2_loss: 0.025121    loss: 0.272407
steps 6600    v_Prec: 0.697438  v_Recall: 0.664932  v_F1: 0.680797  v_AUC: 0.899000
steps 6600    running time 261 seconds

steps 6800    base_loss: 0.181834    reg_loss: 0.067188    l2_loss: 0.025595    loss: 0.274617
steps 6800    v_Prec: 0.683171  v_Recall: 0.683991  v_F1: 0.683581  v_AUC: 0.899664
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.186549    reg_loss: 0.067255    l2_loss: 0.026148    loss: 0.279952
steps 7000    v_Prec: 0.697136  v_Recall: 0.670617  v_F1: 0.683620  v_AUC: 0.900464
steps 7000    running time 273 seconds

steps 7200    base_loss: 0.180768    reg_loss: 0.067101    l2_loss: 0.026503    loss: 0.274372
steps 7200    v_Prec: 0.722523  v_Recall: 0.652278  v_F1: 0.685606  v_AUC: 0.900984
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.187299    reg_loss: 0.067313    l2_loss: 0.027100    loss: 0.281712
steps 7400    v_Prec: 0.702295  v_Recall: 0.674061  v_F1: 0.687888  v_AUC: 0.902939
steps 7400    running time 287 seconds

steps 7600    base_loss: 0.183160    reg_loss: 0.066881    l2_loss: 0.027563    loss: 0.277604
steps 7600    v_Prec: 0.690601  v_Recall: 0.685513  v_F1: 0.688048  v_AUC: 0.902831
steps 7600    running time 294 seconds

steps 7800    base_loss: 0.186868    reg_loss: 0.067030    l2_loss: 0.027821    loss: 0.281719
steps 7800    v_Prec: 0.697501  v_Recall: 0.681749  v_F1: 0.689535  v_AUC: 0.902825
steps 7800    running time 301 seconds

steps 8000    base_loss: 0.195379    reg_loss: 0.067082    l2_loss: 0.028171    loss: 0.290631
steps 8000    v_Prec: 0.737155  v_Recall: 0.654921  v_F1: 0.693609  v_AUC: 0.904754
steps 8000    running time 308 seconds

steps 8200    base_loss: 0.189256    reg_loss: 0.067097    l2_loss: 0.028375    loss: 0.284728
steps 8200    v_Prec: 0.737868  v_Recall: 0.655081  v_F1: 0.694014  v_AUC: 0.906521
steps 8200    running time 315 seconds

steps 8400    base_loss: 0.194904    reg_loss: 0.066936    l2_loss: 0.028665    loss: 0.290506
steps 8400    v_Prec: 0.717097  v_Recall: 0.682870  v_F1: 0.699565  v_AUC: 0.910617
steps 8400    running time 321 seconds

steps 8600    base_loss: 0.184681    reg_loss: 0.066969    l2_loss: 0.028995    loss: 0.280644
steps 8600    v_Prec: 0.736063  v_Recall: 0.669336  v_F1: 0.701116  v_AUC: 0.910230
steps 8600    running time 328 seconds

steps 8800    base_loss: 0.180639    reg_loss: 0.066558    l2_loss: 0.029278    loss: 0.276475
steps 8800    v_Prec: 0.734023  v_Recall: 0.676063  v_F1: 0.703852  v_AUC: 0.911159
steps 8800    running time 335 seconds

steps 9000    base_loss: 0.188089    reg_loss: 0.066972    l2_loss: 0.029669    loss: 0.284730
steps 9000    v_Prec: 0.738016  v_Recall: 0.678145  v_F1: 0.706815  v_AUC: 0.912119
steps 9000    running time 342 seconds

steps 9200    base_loss: 0.184650    reg_loss: 0.066925    l2_loss: 0.029843    loss: 0.281418
steps 9200    v_Prec: 0.751309  v_Recall: 0.666293  v_F1: 0.706252  v_AUC: 0.912977
steps 9200    running time 349 seconds

steps 9400    base_loss: 0.175996    reg_loss: 0.066717    l2_loss: 0.030123    loss: 0.272836
steps 9400    v_Prec: 0.714977  v_Recall: 0.697686  v_F1: 0.706226  v_AUC: 0.914391
steps 9400    running time 356 seconds

steps 9600    base_loss: 0.184205    reg_loss: 0.066729    l2_loss: 0.030437    loss: 0.281372
steps 9600    v_Prec: 0.729743  v_Recall: 0.692400  v_F1: 0.710581  v_AUC: 0.915929
steps 9600    running time 362 seconds

steps 9800    base_loss: 0.185271    reg_loss: 0.066818    l2_loss: 0.030543    loss: 0.282632
steps 9800    v_Prec: 0.752066  v_Recall: 0.677745  v_F1: 0.712974  v_AUC: 0.916529
steps 9800    running time 369 seconds

steps 10000    base_loss: 0.184570    reg_loss: 0.066508    l2_loss: 0.030716    loss: 0.281794
steps 10000    v_Prec: 0.752847  v_Recall: 0.683030  v_F1: 0.716241  v_AUC: 0.918403
steps 10000    running time 376 seconds

steps 10200    base_loss: 0.182280    reg_loss: 0.066224    l2_loss: 0.030986    loss: 0.279491
steps 10200    v_Prec: 0.756416  v_Recall: 0.682149  v_F1: 0.717366  v_AUC: 0.918702
steps 10200    running time 383 seconds

steps 10400    base_loss: 0.188206    reg_loss: 0.066265    l2_loss: 0.031158    loss: 0.285629
steps 10400    v_Prec: 0.769660  v_Recall: 0.685032  v_F1: 0.724885  v_AUC: 0.921732
steps 10400    running time 390 seconds

steps 10600    base_loss: 0.180924    reg_loss: 0.066225    l2_loss: 0.031226    loss: 0.278374
steps 10600    v_Prec: 0.746669  v_Recall: 0.704573  v_F1: 0.725010  v_AUC: 0.922143
steps 10600    running time 397 seconds

steps 10800    base_loss: 0.173112    reg_loss: 0.066212    l2_loss: 0.031418    loss: 0.270741
steps 10800    v_Prec: 0.738295  v_Recall: 0.710979  v_F1: 0.724380  v_AUC: 0.922337
steps 10800    running time 404 seconds

steps 11000    base_loss: 0.074547    reg_loss: 0.065594    l2_loss: 0.031681    loss: 0.171823
steps 11000    v_Prec: 0.719281  v_Recall: 0.711620  v_F1: 0.715430  v_AUC: 0.917413
steps 11000    running time 410 seconds

steps 11200    base_loss: 0.077406    reg_loss: 0.065581    l2_loss: 0.031783    loss: 0.174770
steps 11200    v_Prec: 0.727043  v_Recall: 0.691119  v_F1: 0.708626  v_AUC: 0.913488
steps 11200    running time 416 seconds

steps 11400    base_loss: 0.078667    reg_loss: 0.065220    l2_loss: 0.031878    loss: 0.175765
steps 11400    v_Prec: 0.725133  v_Recall: 0.678386  v_F1: 0.700981  v_AUC: 0.907778
steps 11400    running time 423 seconds

steps 11600    base_loss: 0.076190    reg_loss: 0.064900    l2_loss: 0.031875    loss: 0.172965
steps 11600    v_Prec: 0.726281  v_Recall: 0.682310  v_F1: 0.703609  v_AUC: 0.909187
steps 11600    running time 429 seconds

steps 11800    base_loss: 0.081501    reg_loss: 0.065027    l2_loss: 0.031988    loss: 0.178517
steps 11800    v_Prec: 0.735602  v_Recall: 0.669977  v_F1: 0.701257  v_AUC: 0.908050
steps 11800    running time 435 seconds

steps 12000    base_loss: 0.078361    reg_loss: 0.065019    l2_loss: 0.032216    loss: 0.175596
steps 12000    v_Prec: 0.711859  v_Recall: 0.684552  v_F1: 0.697938  v_AUC: 0.906940
steps 12000    running time 441 seconds

steps 12200    base_loss: 0.081145    reg_loss: 0.065173    l2_loss: 0.032240    loss: 0.178559
steps 12200    v_Prec: 0.736344  v_Recall: 0.660687  v_F1: 0.696467  v_AUC: 0.904615
steps 12200    running time 448 seconds

steps 12400    base_loss: 0.082664    reg_loss: 0.064908    l2_loss: 0.032421    loss: 0.179992
steps 12400    v_Prec: 0.729869  v_Recall: 0.667094  v_F1: 0.697071  v_AUC: 0.904990
steps 12400    running time 454 seconds

steps 12600    base_loss: 0.089049    reg_loss: 0.065328    l2_loss: 0.032661    loss: 0.187037
steps 12600    v_Prec: 0.732599  v_Recall: 0.660847  v_F1: 0.694876  v_AUC: 0.902832
steps 12600    running time 460 seconds

Early stop model F1: 0.725010
testing thre: 0.37662062
testing Prec: 0.534749298857651
testing Recall: 0.7599027946537059
testing F1: 0.6277477766848011
testing AUC: 0.9009731458195442
overall running time 463 seconds
(0.698286937901499, 0.6339732685297691, 0.6645777607948032, 0.9009731458195442, 0.68294895)

2019-02-24 18:06:09.272791: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:06:09.711598: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:06:09.823547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:06:09.823638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.040000 seconds
loading data in 30.130000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.302271    reg_loss: 0.065230    l2_loss: 0.013318    loss: 1.380819
steps 200    v_Prec: 0.164583  v_Recall: 1.000000  v_F1: 0.282648  v_AUC: 0.471502
steps 200    running time 40 seconds

steps 400    base_loss: 0.880343    reg_loss: 0.065711    l2_loss: 0.013244    loss: 0.959299
steps 400    v_Prec: 0.164594  v_Recall: 1.000000  v_F1: 0.282663  v_AUC: 0.488249
steps 400    running time 48 seconds

steps 600    base_loss: 0.517214    reg_loss: 0.066276    l2_loss: 0.013245    loss: 0.596735
steps 600    v_Prec: 0.166055  v_Recall: 0.960837  v_F1: 0.283171  v_AUC: 0.535542
steps 600    running time 55 seconds

steps 800    base_loss: 0.467121    reg_loss: 0.066121    l2_loss: 0.013023    loss: 0.546265
steps 800    v_Prec: 0.214997  v_Recall: 0.540511  v_F1: 0.307630  v_AUC: 0.608290
steps 800    running time 62 seconds

steps 1000    base_loss: 0.457910    reg_loss: 0.065948    l2_loss: 0.012834    loss: 0.536691
steps 1000    v_Prec: 0.297001  v_Recall: 0.480419  v_F1: 0.367073  v_AUC: 0.679599
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.422489    reg_loss: 0.065878    l2_loss: 0.012722    loss: 0.501090
steps 1200    v_Prec: 0.454513  v_Recall: 0.402806  v_F1: 0.427100  v_AUC: 0.734837
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.394700    reg_loss: 0.066219    l2_loss: 0.012759    loss: 0.473678
steps 1400    v_Prec: 0.512830  v_Recall: 0.451562  v_F1: 0.480250  v_AUC: 0.772957
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.376108    reg_loss: 0.066455    l2_loss: 0.012821    loss: 0.455384
steps 1600    v_Prec: 0.532151  v_Recall: 0.513715  v_F1: 0.522770  v_AUC: 0.802915
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.359787    reg_loss: 0.066854    l2_loss: 0.012900    loss: 0.439541
steps 1800    v_Prec: 0.595452  v_Recall: 0.510623  v_F1: 0.549784  v_AUC: 0.821972
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.337844    reg_loss: 0.067049    l2_loss: 0.013079    loss: 0.417972
steps 2000    v_Prec: 0.594663  v_Recall: 0.556524  v_F1: 0.574962  v_AUC: 0.839135
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.327955    reg_loss: 0.067456    l2_loss: 0.013259    loss: 0.408669
steps 2200    v_Prec: 0.615122  v_Recall: 0.571429  v_F1: 0.592471  v_AUC: 0.849999
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.312184    reg_loss: 0.067535    l2_loss: 0.013520    loss: 0.393239
steps 2400    v_Prec: 0.656043  v_Recall: 0.564611  v_F1: 0.606902  v_AUC: 0.858679
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.300707    reg_loss: 0.067563    l2_loss: 0.013855    loss: 0.382125
steps 2600    v_Prec: 0.670000  v_Recall: 0.578960  v_F1: 0.621162  v_AUC: 0.866885
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.303759    reg_loss: 0.067916    l2_loss: 0.014183    loss: 0.385858
steps 2800    v_Prec: 0.670034  v_Recall: 0.588870  v_F1: 0.626835  v_AUC: 0.871320
steps 2800    running time 131 seconds

steps 3000    base_loss: 0.297041    reg_loss: 0.068051    l2_loss: 0.014592    loss: 0.379684
steps 3000    v_Prec: 0.657723  v_Recall: 0.614080  v_F1: 0.635152  v_AUC: 0.877320
steps 3000    running time 138 seconds

steps 3200    base_loss: 0.292574    reg_loss: 0.068003    l2_loss: 0.014985    loss: 0.375563
steps 3200    v_Prec: 0.677845  v_Recall: 0.618519  v_F1: 0.646825  v_AUC: 0.881232
steps 3200    running time 145 seconds

steps 3400    base_loss: 0.285988    reg_loss: 0.067991    l2_loss: 0.015409    loss: 0.369388
steps 3400    v_Prec: 0.682057  v_Recall: 0.617171  v_F1: 0.647994  v_AUC: 0.883912
steps 3400    running time 152 seconds

steps 3600    base_loss: 0.280160    reg_loss: 0.068080    l2_loss: 0.015754    loss: 0.363994
steps 3600    v_Prec: 0.686875  v_Recall: 0.626050  v_F1: 0.655054  v_AUC: 0.887112
steps 3600    running time 159 seconds

steps 3800    base_loss: 0.276445    reg_loss: 0.068095    l2_loss: 0.016175    loss: 0.360714
steps 3800    v_Prec: 0.707837  v_Recall: 0.621532  v_F1: 0.661883  v_AUC: 0.890761
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.279816    reg_loss: 0.068198    l2_loss: 0.016681    loss: 0.364695
steps 4000    v_Prec: 0.692095  v_Recall: 0.633661  v_F1: 0.661590  v_AUC: 0.891574
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.268642    reg_loss: 0.068111    l2_loss: 0.017096    loss: 0.353849
steps 4200    v_Prec: 0.685184  v_Recall: 0.646345  v_F1: 0.665198  v_AUC: 0.894226
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.267854    reg_loss: 0.067874    l2_loss: 0.017565    loss: 0.353292
steps 4400    v_Prec: 0.689264  v_Recall: 0.650468  v_F1: 0.669304  v_AUC: 0.896026
steps 4400    running time 186 seconds

steps 4600    base_loss: 0.266345    reg_loss: 0.067825    l2_loss: 0.018147    loss: 0.352317
steps 4600    v_Prec: 0.727348  v_Recall: 0.623038  v_F1: 0.671164  v_AUC: 0.899516
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.274198    reg_loss: 0.067714    l2_loss: 0.018750    loss: 0.360662
steps 4800    v_Prec: 0.712498  v_Recall: 0.631838  v_F1: 0.669748  v_AUC: 0.898770
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.262299    reg_loss: 0.067901    l2_loss: 0.019406    loss: 0.349606
steps 5000    v_Prec: 0.679221  v_Recall: 0.663390  v_F1: 0.671212  v_AUC: 0.901778
steps 5000    running time 207 seconds

steps 5200    base_loss: 0.269504    reg_loss: 0.067701    l2_loss: 0.020034    loss: 0.357240
steps 5200    v_Prec: 0.717547  v_Recall: 0.635405  v_F1: 0.673983  v_AUC: 0.902294
steps 5200    running time 214 seconds

steps 5400    base_loss: 0.259529    reg_loss: 0.067513    l2_loss: 0.020718    loss: 0.347759
steps 5400    v_Prec: 0.713924  v_Recall: 0.647534  v_F1: 0.679110  v_AUC: 0.906047
steps 5400    running time 221 seconds

steps 5600    base_loss: 0.167890    reg_loss: 0.067759    l2_loss: 0.021508    loss: 0.257157
steps 5600    v_Prec: 0.709324  v_Recall: 0.641113  v_F1: 0.673496  v_AUC: 0.899658
steps 5600    running time 228 seconds

steps 5800    base_loss: 0.172215    reg_loss: 0.067725    l2_loss: 0.022366    loss: 0.262307
steps 5800    v_Prec: 0.681025  v_Recall: 0.661804  v_F1: 0.671277  v_AUC: 0.898444
steps 5800    running time 234 seconds

steps 6000    base_loss: 0.174069    reg_loss: 0.067565    l2_loss: 0.023103    loss: 0.264737
steps 6000    v_Prec: 0.701834  v_Recall: 0.646028  v_F1: 0.672776  v_AUC: 0.897989
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.177392    reg_loss: 0.067914    l2_loss: 0.023689    loss: 0.268995
steps 6200    v_Prec: 0.690553  v_Recall: 0.657761  v_F1: 0.673759  v_AUC: 0.896290
steps 6200    running time 247 seconds

steps 6400    base_loss: 0.179966    reg_loss: 0.067624    l2_loss: 0.024352    loss: 0.271941
steps 6400    v_Prec: 0.706111  v_Recall: 0.648565  v_F1: 0.676116  v_AUC: 0.898648
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.175862    reg_loss: 0.067734    l2_loss: 0.024962    loss: 0.268559
steps 6600    v_Prec: 0.706302  v_Recall: 0.644205  v_F1: 0.673826  v_AUC: 0.898698
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.183888    reg_loss: 0.067513    l2_loss: 0.025365    loss: 0.276766
steps 6800    v_Prec: 0.683038  v_Recall: 0.668147  v_F1: 0.675510  v_AUC: 0.898647
steps 6800    running time 266 seconds

steps 7000    base_loss: 0.176511    reg_loss: 0.067538    l2_loss: 0.025854    loss: 0.269903
steps 7000    v_Prec: 0.721888  v_Recall: 0.637704  v_F1: 0.677190  v_AUC: 0.898090
steps 7000    running time 273 seconds

steps 7200    base_loss: 0.177817    reg_loss: 0.067585    l2_loss: 0.026401    loss: 0.271804
steps 7200    v_Prec: 0.717449  v_Recall: 0.639528  v_F1: 0.676251  v_AUC: 0.898720
steps 7200    running time 279 seconds

steps 7400    base_loss: 0.171321    reg_loss: 0.067439    l2_loss: 0.026929    loss: 0.265689
steps 7400    v_Prec: 0.682255  v_Recall: 0.675440  v_F1: 0.678830  v_AUC: 0.901443
steps 7400    running time 286 seconds

Early stop model F1: 0.679110
testing thre: 0.29718518
testing Prec: 0.5338323240681536
testing Recall: 0.6898177399756986
testing F1: 0.6018828718035707
testing AUC: 0.8754625259186615
overall running time 288 seconds
(0.6651890921333183, 0.5761846901579587, 0.6174961585540537, 0.8754625259186615, 0.46772695)

2019-02-24 18:09:27.072640: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:09:27.498397: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:09:27.592274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:09:27.592359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.770000 seconds
loading data in 30.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.634627    reg_loss: 0.064969    l2_loss: 0.013346    loss: 0.712942
steps 200    v_Prec: 0.163400  v_Recall: 1.000000  v_F1: 0.280901  v_AUC: 0.488675
steps 200    running time 41 seconds

steps 400    base_loss: 0.535183    reg_loss: 0.065402    l2_loss: 0.013303    loss: 0.613889
steps 400    v_Prec: 0.163494  v_Recall: 0.999840  v_F1: 0.281033  v_AUC: 0.528228
steps 400    running time 48 seconds

steps 600    base_loss: 0.505479    reg_loss: 0.065418    l2_loss: 0.013208    loss: 0.584105
steps 600    v_Prec: 0.195454  v_Recall: 0.660624  v_F1: 0.301659  v_AUC: 0.596063
steps 600    running time 55 seconds

steps 800    base_loss: 0.470193    reg_loss: 0.065222    l2_loss: 0.013009    loss: 0.548424
steps 800    v_Prec: 0.281665  v_Recall: 0.468977  v_F1: 0.351951  v_AUC: 0.671703
steps 800    running time 62 seconds

steps 1000    base_loss: 0.427327    reg_loss: 0.065291    l2_loss: 0.012902    loss: 0.505520
steps 1000    v_Prec: 0.386621  v_Recall: 0.452288  v_F1: 0.416884  v_AUC: 0.731219
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.404629    reg_loss: 0.065347    l2_loss: 0.012854    loss: 0.482829
steps 1200    v_Prec: 0.453490  v_Recall: 0.480396  v_F1: 0.466556  v_AUC: 0.771838
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.373974    reg_loss: 0.065583    l2_loss: 0.012925    loss: 0.452483
steps 1400    v_Prec: 0.502039  v_Recall: 0.511140  v_F1: 0.506548  v_AUC: 0.795445
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.355963    reg_loss: 0.065795    l2_loss: 0.013001    loss: 0.434758
steps 1600    v_Prec: 0.551352  v_Recall: 0.525992  v_F1: 0.538374  v_AUC: 0.820387
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.343934    reg_loss: 0.066310    l2_loss: 0.013135    loss: 0.423379
steps 1800    v_Prec: 0.611405  v_Recall: 0.526551  v_F1: 0.565814  v_AUC: 0.836357
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.323809    reg_loss: 0.066448    l2_loss: 0.013414    loss: 0.403671
steps 2000    v_Prec: 0.597797  v_Recall: 0.567675  v_F1: 0.582347  v_AUC: 0.847802
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.313528    reg_loss: 0.066559    l2_loss: 0.013649    loss: 0.393735
steps 2200    v_Prec: 0.630108  v_Recall: 0.579893  v_F1: 0.603959  v_AUC: 0.856794
steps 2200    running time 112 seconds

steps 2400    base_loss: 0.304906    reg_loss: 0.066887    l2_loss: 0.013919    loss: 0.385712
steps 2400    v_Prec: 0.657262  v_Recall: 0.580372  v_F1: 0.616428  v_AUC: 0.863721
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.304599    reg_loss: 0.067096    l2_loss: 0.014196    loss: 0.385891
steps 2600    v_Prec: 0.649526  v_Recall: 0.602172  v_F1: 0.624953  v_AUC: 0.868665
steps 2600    running time 126 seconds

steps 2800    base_loss: 0.294931    reg_loss: 0.067142    l2_loss: 0.014506    loss: 0.376579
steps 2800    v_Prec: 0.642130  v_Recall: 0.629721  v_F1: 0.635865  v_AUC: 0.873836
steps 2800    running time 133 seconds

steps 3000    base_loss: 0.287421    reg_loss: 0.067275    l2_loss: 0.014785    loss: 0.369481
steps 3000    v_Prec: 0.690390  v_Recall: 0.605765  v_F1: 0.645315  v_AUC: 0.877771
steps 3000    running time 140 seconds

steps 3200    base_loss: 0.283983    reg_loss: 0.067514    l2_loss: 0.015110    loss: 0.366607
steps 3200    v_Prec: 0.684972  v_Recall: 0.616546  v_F1: 0.648960  v_AUC: 0.881806
steps 3200    running time 147 seconds

steps 3400    base_loss: 0.276348    reg_loss: 0.067530    l2_loss: 0.015527    loss: 0.359405
steps 3400    v_Prec: 0.675973  v_Recall: 0.628364  v_F1: 0.651299  v_AUC: 0.884293
steps 3400    running time 154 seconds

steps 3600    base_loss: 0.280761    reg_loss: 0.067611    l2_loss: 0.015873    loss: 0.364246
steps 3600    v_Prec: 0.674442  v_Recall: 0.639543  v_F1: 0.656529  v_AUC: 0.887791
steps 3600    running time 161 seconds

steps 3800    base_loss: 0.279864    reg_loss: 0.067744    l2_loss: 0.016236    loss: 0.363844
steps 3800    v_Prec: 0.672036  v_Recall: 0.646331  v_F1: 0.658933  v_AUC: 0.892387
steps 3800    running time 168 seconds

steps 4000    base_loss: 0.269842    reg_loss: 0.067529    l2_loss: 0.016818    loss: 0.354188
steps 4000    v_Prec: 0.698128  v_Recall: 0.628444  v_F1: 0.661456  v_AUC: 0.894105
steps 4000    running time 175 seconds

steps 4200    base_loss: 0.276457    reg_loss: 0.067577    l2_loss: 0.017159    loss: 0.361193
steps 4200    v_Prec: 0.681181  v_Recall: 0.652080  v_F1: 0.666313  v_AUC: 0.896733
steps 4200    running time 182 seconds

steps 4400    base_loss: 0.268338    reg_loss: 0.067551    l2_loss: 0.017675    loss: 0.353564
steps 4400    v_Prec: 0.662643  v_Recall: 0.666294  v_F1: 0.664463  v_AUC: 0.897612
steps 4400    running time 189 seconds

steps 4600    base_loss: 0.274915    reg_loss: 0.067544    l2_loss: 0.018120    loss: 0.360579
steps 4600    v_Prec: 0.681754  v_Recall: 0.657909  v_F1: 0.669620  v_AUC: 0.899189
steps 4600    running time 195 seconds

steps 4800    base_loss: 0.271357    reg_loss: 0.067604    l2_loss: 0.018658    loss: 0.357619
steps 4800    v_Prec: 0.683662  v_Recall: 0.654236  v_F1: 0.668625  v_AUC: 0.901693
steps 4800    running time 202 seconds

steps 5000    base_loss: 0.261997    reg_loss: 0.067512    l2_loss: 0.019295    loss: 0.348804
steps 5000    v_Prec: 0.690215  v_Recall: 0.638186  v_F1: 0.663181  v_AUC: 0.900558
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.263540    reg_loss: 0.067432    l2_loss: 0.019844    loss: 0.350815
steps 5200    v_Prec: 0.695250  v_Recall: 0.648726  v_F1: 0.671183  v_AUC: 0.902912
steps 5200    running time 214 seconds

steps 5400    base_loss: 0.263577    reg_loss: 0.067527    l2_loss: 0.020505    loss: 0.351610
steps 5400    v_Prec: 0.699056  v_Recall: 0.650323  v_F1: 0.673810  v_AUC: 0.903938
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.169736    reg_loss: 0.068118    l2_loss: 0.021345    loss: 0.259199
steps 5600    v_Prec: 0.697484  v_Recall: 0.633155  v_F1: 0.663765  v_AUC: 0.899016
steps 5600    running time 229 seconds

steps 5800    base_loss: 0.167144    reg_loss: 0.067801    l2_loss: 0.022167    loss: 0.257112
steps 5800    v_Prec: 0.672896  v_Recall: 0.646890  v_F1: 0.659637  v_AUC: 0.895952
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.177147    reg_loss: 0.068073    l2_loss: 0.022930    loss: 0.268150
steps 6000    v_Prec: 0.695814  v_Recall: 0.627805  v_F1: 0.660062  v_AUC: 0.893864
steps 6000    running time 242 seconds

steps 6200    base_loss: 0.178255    reg_loss: 0.068004    l2_loss: 0.023638    loss: 0.269897
steps 6200    v_Prec: 0.691419  v_Recall: 0.630520  v_F1: 0.659566  v_AUC: 0.894914
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.177549    reg_loss: 0.068318    l2_loss: 0.024274    loss: 0.270141
steps 6400    v_Prec: 0.673542  v_Recall: 0.651920  v_F1: 0.662555  v_AUC: 0.896367
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.184841    reg_loss: 0.067815    l2_loss: 0.024892    loss: 0.277548
steps 6600    v_Prec: 0.691948  v_Recall: 0.637467  v_F1: 0.663591  v_AUC: 0.894784
steps 6600    running time 261 seconds

steps 6800    base_loss: 0.176809    reg_loss: 0.067829    l2_loss: 0.025397    loss: 0.270035
steps 6800    v_Prec: 0.680938  v_Recall: 0.654076  v_F1: 0.667237  v_AUC: 0.895745
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.180780    reg_loss: 0.068041    l2_loss: 0.025745    loss: 0.274566
steps 7000    v_Prec: 0.680219  v_Recall: 0.663978  v_F1: 0.672001  v_AUC: 0.898228
steps 7000    running time 274 seconds

steps 7200    base_loss: 0.177236    reg_loss: 0.067849    l2_loss: 0.026347    loss: 0.271431
steps 7200    v_Prec: 0.688880  v_Recall: 0.660385  v_F1: 0.674331  v_AUC: 0.900690
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.179219    reg_loss: 0.067888    l2_loss: 0.026679    loss: 0.273786
steps 7400    v_Prec: 0.705766  v_Recall: 0.653917  v_F1: 0.678853  v_AUC: 0.900440
steps 7400    running time 287 seconds

steps 7600    base_loss: 0.181822    reg_loss: 0.067846    l2_loss: 0.027113    loss: 0.276781
steps 7600    v_Prec: 0.727380  v_Recall: 0.638106  v_F1: 0.679825  v_AUC: 0.901690
steps 7600    running time 294 seconds

steps 7800    base_loss: 0.179465    reg_loss: 0.067726    l2_loss: 0.027533    loss: 0.274724
steps 7800    v_Prec: 0.690400  v_Recall: 0.669009  v_F1: 0.679536  v_AUC: 0.901521
steps 7800    running time 301 seconds

steps 8000    base_loss: 0.179159    reg_loss: 0.067524    l2_loss: 0.027931    loss: 0.274614
steps 8000    v_Prec: 0.728105  v_Recall: 0.647928  v_F1: 0.685680  v_AUC: 0.902857
steps 8000    running time 307 seconds

steps 8200    base_loss: 0.187389    reg_loss: 0.067668    l2_loss: 0.028241    loss: 0.283298
steps 8200    v_Prec: 0.739083  v_Recall: 0.650084  v_F1: 0.691733  v_AUC: 0.904457
steps 8200    running time 314 seconds

steps 8400    base_loss: 0.187580    reg_loss: 0.067848    l2_loss: 0.028677    loss: 0.284104
steps 8400    v_Prec: 0.714692  v_Recall: 0.662701  v_F1: 0.687715  v_AUC: 0.904723
steps 8400    running time 321 seconds

steps 8600    base_loss: 0.180958    reg_loss: 0.067692    l2_loss: 0.028965    loss: 0.277614
steps 8600    v_Prec: 0.744544  v_Recall: 0.648407  v_F1: 0.693158  v_AUC: 0.906385
steps 8600    running time 328 seconds

steps 8800    base_loss: 0.197226    reg_loss: 0.067441    l2_loss: 0.029165    loss: 0.293832
steps 8800    v_Prec: 0.719294  v_Recall: 0.679949  v_F1: 0.699068  v_AUC: 0.908538
steps 8800    running time 335 seconds

steps 9000    base_loss: 0.182606    reg_loss: 0.067520    l2_loss: 0.029398    loss: 0.279524
steps 9000    v_Prec: 0.748870  v_Recall: 0.661742  v_F1: 0.702616  v_AUC: 0.910426
steps 9000    running time 342 seconds

steps 9200    base_loss: 0.177346    reg_loss: 0.067165    l2_loss: 0.029549    loss: 0.274060
steps 9200    v_Prec: 0.724764  v_Recall: 0.685698  v_F1: 0.704690  v_AUC: 0.911582
steps 9200    running time 349 seconds

steps 9400    base_loss: 0.179488    reg_loss: 0.067139    l2_loss: 0.029843    loss: 0.276470
steps 9400    v_Prec: 0.750835  v_Recall: 0.663898  v_F1: 0.704696  v_AUC: 0.911356
steps 9400    running time 356 seconds

steps 9600    base_loss: 0.191482    reg_loss: 0.067134    l2_loss: 0.030116    loss: 0.288732
steps 9600    v_Prec: 0.733189  v_Recall: 0.678272  v_F1: 0.704662  v_AUC: 0.912902
steps 9600    running time 362 seconds

steps 9800    base_loss: 0.182011    reg_loss: 0.067057    l2_loss: 0.030330    loss: 0.279397
steps 9800    v_Prec: 0.728462  v_Recall: 0.684660  v_F1: 0.705882  v_AUC: 0.913768
steps 9800    running time 369 seconds

steps 10000    base_loss: 0.186473    reg_loss: 0.067161    l2_loss: 0.030645    loss: 0.284279
steps 10000    v_Prec: 0.736111  v_Recall: 0.685618  v_F1: 0.709968  v_AUC: 0.915391
steps 10000    running time 376 seconds

steps 10200    base_loss: 0.185045    reg_loss: 0.067214    l2_loss: 0.030992    loss: 0.283250
steps 10200    v_Prec: 0.739049  v_Recall: 0.692486  v_F1: 0.715010  v_AUC: 0.918541
steps 10200    running time 383 seconds

steps 10400    base_loss: 0.181350    reg_loss: 0.066977    l2_loss: 0.031123    loss: 0.279450
steps 10400    v_Prec: 0.750898  v_Recall: 0.684101  v_F1: 0.715945  v_AUC: 0.917981
steps 10400    running time 390 seconds

steps 10600    base_loss: 0.175291    reg_loss: 0.067164    l2_loss: 0.031334    loss: 0.273790
steps 10600    v_Prec: 0.717996  v_Recall: 0.713008  v_F1: 0.715493  v_AUC: 0.920484
steps 10600    running time 397 seconds

steps 10800    base_loss: 0.171415    reg_loss: 0.066797    l2_loss: 0.031428    loss: 0.269641
steps 10800    v_Prec: 0.770318  v_Recall: 0.666054  v_F1: 0.714402  v_AUC: 0.920097
steps 10800    running time 403 seconds

steps 11000    base_loss: 0.074060    reg_loss: 0.066183    l2_loss: 0.031670    loss: 0.171913
steps 11000    v_Prec: 0.742457  v_Recall: 0.668051  v_F1: 0.703291  v_AUC: 0.913888
steps 11000    running time 410 seconds

steps 11200    base_loss: 0.073459    reg_loss: 0.066312    l2_loss: 0.031657    loss: 0.171428
steps 11200    v_Prec: 0.738781  v_Recall: 0.661263  v_F1: 0.697876  v_AUC: 0.908666
steps 11200    running time 416 seconds

steps 11400    base_loss: 0.066355    reg_loss: 0.065749    l2_loss: 0.031790    loss: 0.163894
steps 11400    v_Prec: 0.717612  v_Recall: 0.671884  v_F1: 0.693995  v_AUC: 0.906239
steps 11400    running time 422 seconds

steps 11600    base_loss: 0.072828    reg_loss: 0.065588    l2_loss: 0.031810    loss: 0.170227
steps 11600    v_Prec: 0.718547  v_Recall: 0.653997  v_F1: 0.684754  v_AUC: 0.902951
steps 11600    running time 429 seconds

steps 11800    base_loss: 0.077712    reg_loss: 0.066001    l2_loss: 0.031983    loss: 0.175696
steps 11800    v_Prec: 0.687632  v_Recall: 0.678352  v_F1: 0.682960  v_AUC: 0.901874
steps 11800    running time 435 seconds

steps 12000    base_loss: 0.082035    reg_loss: 0.065730    l2_loss: 0.032126    loss: 0.179890
steps 12000    v_Prec: 0.691324  v_Recall: 0.677633  v_F1: 0.684410  v_AUC: 0.903195
steps 12000    running time 442 seconds

steps 12200    base_loss: 0.082273    reg_loss: 0.065873    l2_loss: 0.032180    loss: 0.180325
steps 12200    v_Prec: 0.701388  v_Recall: 0.661902  v_F1: 0.681073  v_AUC: 0.901424
steps 12200    running time 448 seconds

steps 12400    base_loss: 0.085100    reg_loss: 0.065583    l2_loss: 0.032373    loss: 0.183056
steps 12400    v_Prec: 0.701553  v_Recall: 0.667492  v_F1: 0.684099  v_AUC: 0.902236
steps 12400    running time 455 seconds

Early stop model F1: 0.715945
testing thre: 0.43565214
testing Prec: 0.5406293706293707
testing Recall: 0.751494532199271
testing F1: 0.6288561260803254
testing AUC: 0.898536942689079
overall running time 458 seconds
(0.7034147938031857, 0.6267314702308627, 0.6628627239314263, 0.898536942689079, 0.73176587)

2019-02-24 18:14:35.008147: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:14:36.690080: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:14:36.692986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:14:36.693025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.640000 seconds
loading data in 29.680000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.180853    reg_loss: 0.064688    l2_loss: 0.013348    loss: 1.258889
steps 200    v_Prec: 0.164183  v_Recall: 1.000000  v_F1: 0.282057  v_AUC: 0.496058
steps 200    running time 40 seconds

steps 400    base_loss: 0.806086    reg_loss: 0.064586    l2_loss: 0.013413    loss: 0.884084
steps 400    v_Prec: 0.164198  v_Recall: 0.999762  v_F1: 0.282069  v_AUC: 0.509820
steps 400    running time 47 seconds

steps 600    base_loss: 0.489596    reg_loss: 0.064524    l2_loss: 0.013351    loss: 0.567471
steps 600    v_Prec: 0.186699  v_Recall: 0.697211  v_F1: 0.294529  v_AUC: 0.575456
steps 600    running time 54 seconds

steps 800    base_loss: 0.475897    reg_loss: 0.064057    l2_loss: 0.013070    loss: 0.553024
steps 800    v_Prec: 0.211654  v_Recall: 0.616864  v_F1: 0.315170  v_AUC: 0.618749
steps 800    running time 61 seconds

steps 1000    base_loss: 0.469272    reg_loss: 0.063524    l2_loss: 0.012835    loss: 0.545632
steps 1000    v_Prec: 0.241526  v_Recall: 0.504013  v_F1: 0.326562  v_AUC: 0.635624
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.450368    reg_loss: 0.062737    l2_loss: 0.012637    loss: 0.525741
steps 1200    v_Prec: 0.244847  v_Recall: 0.503219  v_F1: 0.329414  v_AUC: 0.638031
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.434394    reg_loss: 0.062301    l2_loss: 0.012618    loss: 0.509314
steps 1400    v_Prec: 0.333704  v_Recall: 0.429389  v_F1: 0.375547  v_AUC: 0.685932
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.422570    reg_loss: 0.061698    l2_loss: 0.012736    loss: 0.497004
steps 1600    v_Prec: 0.453111  v_Recall: 0.431217  v_F1: 0.441893  v_AUC: 0.733161
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.391380    reg_loss: 0.060731    l2_loss: 0.012925    loss: 0.465036
steps 1800    v_Prec: 0.512775  v_Recall: 0.480092  v_F1: 0.495896  v_AUC: 0.770377
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.372934    reg_loss: 0.060178    l2_loss: 0.013164    loss: 0.446277
steps 2000    v_Prec: 0.577464  v_Recall: 0.506239  v_F1: 0.539510  v_AUC: 0.801901
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.345948    reg_loss: 0.059132    l2_loss: 0.013427    loss: 0.418507
steps 2200    v_Prec: 0.623253  v_Recall: 0.535087  v_F1: 0.575815  v_AUC: 0.825994
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.334575    reg_loss: 0.058706    l2_loss: 0.013772    loss: 0.407053
steps 2400    v_Prec: 0.634157  v_Recall: 0.558611  v_F1: 0.593992  v_AUC: 0.839009
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.320128    reg_loss: 0.058223    l2_loss: 0.014099    loss: 0.392450
steps 2600    v_Prec: 0.653928  v_Recall: 0.586108  v_F1: 0.618164  v_AUC: 0.852797
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.317179    reg_loss: 0.057778    l2_loss: 0.014441    loss: 0.389398
steps 2800    v_Prec: 0.691032  v_Recall: 0.583009  v_F1: 0.632441  v_AUC: 0.862208
steps 2800    running time 131 seconds

steps 3000    base_loss: 0.301255    reg_loss: 0.057289    l2_loss: 0.014845    loss: 0.373390
steps 3000    v_Prec: 0.667258  v_Recall: 0.627911  v_F1: 0.646987  v_AUC: 0.868775
steps 3000    running time 138 seconds

steps 3200    base_loss: 0.294031    reg_loss: 0.057023    l2_loss: 0.015267    loss: 0.366321
steps 3200    v_Prec: 0.683866  v_Recall: 0.630931  v_F1: 0.656333  v_AUC: 0.875404
steps 3200    running time 144 seconds

steps 3400    base_loss: 0.284786    reg_loss: 0.056831    l2_loss: 0.015719    loss: 0.357335
steps 3400    v_Prec: 0.696498  v_Recall: 0.637050  v_F1: 0.665449  v_AUC: 0.879520
steps 3400    running time 151 seconds

steps 3600    base_loss: 0.282710    reg_loss: 0.056562    l2_loss: 0.016146    loss: 0.355418
steps 3600    v_Prec: 0.722701  v_Recall: 0.626957  v_F1: 0.671433  v_AUC: 0.883217
steps 3600    running time 158 seconds

steps 3800    base_loss: 0.278001    reg_loss: 0.056368    l2_loss: 0.016586    loss: 0.350956
steps 3800    v_Prec: 0.717784  v_Recall: 0.640547  v_F1: 0.676970  v_AUC: 0.884715
steps 3800    running time 165 seconds

steps 4000    base_loss: 0.269000    reg_loss: 0.056277    l2_loss: 0.016972    loss: 0.342248
steps 4000    v_Prec: 0.728124  v_Recall: 0.642772  v_F1: 0.682791  v_AUC: 0.888164
steps 4000    running time 171 seconds

steps 4200    base_loss: 0.269893    reg_loss: 0.056248    l2_loss: 0.017448    loss: 0.343589
steps 4200    v_Prec: 0.723798  v_Recall: 0.647063  v_F1: 0.683283  v_AUC: 0.890160
steps 4200    running time 178 seconds

steps 4400    base_loss: 0.264686    reg_loss: 0.055786    l2_loss: 0.017949    loss: 0.338420
steps 4400    v_Prec: 0.765039  v_Recall: 0.632679  v_F1: 0.692592  v_AUC: 0.893409
steps 4400    running time 185 seconds

steps 4600    base_loss: 0.262412    reg_loss: 0.055657    l2_loss: 0.018406    loss: 0.336475
steps 4600    v_Prec: 0.744046  v_Recall: 0.657951  v_F1: 0.698355  v_AUC: 0.896905
steps 4600    running time 192 seconds

steps 4800    base_loss: 0.262058    reg_loss: 0.055544    l2_loss: 0.018924    loss: 0.336526
steps 4800    v_Prec: 0.734050  v_Recall: 0.667488  v_F1: 0.699188  v_AUC: 0.898372
steps 4800    running time 199 seconds

steps 5000    base_loss: 0.255630    reg_loss: 0.055109    l2_loss: 0.019316    loss: 0.330056
steps 5000    v_Prec: 0.734440  v_Recall: 0.671461  v_F1: 0.701540  v_AUC: 0.900379
steps 5000    running time 206 seconds

steps 5200    base_loss: 0.258388    reg_loss: 0.055151    l2_loss: 0.019782    loss: 0.333321
steps 5200    v_Prec: 0.761774  v_Recall: 0.660733  v_F1: 0.707665  v_AUC: 0.902561
steps 5200    running time 213 seconds

steps 5400    base_loss: 0.249573    reg_loss: 0.054672    l2_loss: 0.020232    loss: 0.324476
steps 5400    v_Prec: 0.744346  v_Recall: 0.677501  v_F1: 0.709353  v_AUC: 0.905172
steps 5400    running time 220 seconds

steps 5600    base_loss: 0.168705    reg_loss: 0.050972    l2_loss: 0.020714    loss: 0.240392
steps 5600    v_Prec: 0.752548  v_Recall: 0.668998  v_F1: 0.708318  v_AUC: 0.901811
steps 5600    running time 227 seconds

steps 5800    base_loss: 0.170612    reg_loss: 0.050632    l2_loss: 0.021254    loss: 0.242498
steps 5800    v_Prec: 0.768773  v_Recall: 0.657395  v_F1: 0.708735  v_AUC: 0.901337
steps 5800    running time 233 seconds

steps 6000    base_loss: 0.171979    reg_loss: 0.050595    l2_loss: 0.021782    loss: 0.244356
steps 6000    v_Prec: 0.766750  v_Recall: 0.655726  v_F1: 0.706905  v_AUC: 0.900812
steps 6000    running time 240 seconds

steps 6200    base_loss: 0.167921    reg_loss: 0.050507    l2_loss: 0.022264    loss: 0.240692
steps 6200    v_Prec: 0.759597  v_Recall: 0.665183  v_F1: 0.709262  v_AUC: 0.900229
steps 6200    running time 246 seconds

steps 6400    base_loss: 0.181287    reg_loss: 0.050363    l2_loss: 0.022788    loss: 0.254437
steps 6400    v_Prec: 0.776478  v_Recall: 0.654295  v_F1: 0.710170  v_AUC: 0.901326
steps 6400    running time 253 seconds

steps 6600    base_loss: 0.176431    reg_loss: 0.050091    l2_loss: 0.023228    loss: 0.249750
steps 6600    v_Prec: 0.770064  v_Recall: 0.661130  v_F1: 0.711451  v_AUC: 0.901630
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.179136    reg_loss: 0.050122    l2_loss: 0.023741    loss: 0.252998
steps 6800    v_Prec: 0.750441  v_Recall: 0.675832  v_F1: 0.711185  v_AUC: 0.901618
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.180219    reg_loss: 0.049952    l2_loss: 0.024144    loss: 0.254315
steps 7000    v_Prec: 0.768155  v_Recall: 0.672495  v_F1: 0.717149  v_AUC: 0.902744
steps 7000    running time 273 seconds

steps 7200    base_loss: 0.171331    reg_loss: 0.049476    l2_loss: 0.024522    loss: 0.245329
steps 7200    v_Prec: 0.778689  v_Recall: 0.663832  v_F1: 0.716688  v_AUC: 0.903432
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.187002    reg_loss: 0.049666    l2_loss: 0.024794    loss: 0.261462
steps 7400    v_Prec: 0.778829  v_Recall: 0.673607  v_F1: 0.722407  v_AUC: 0.906041
steps 7400    running time 286 seconds

steps 7600    base_loss: 0.190741    reg_loss: 0.049680    l2_loss: 0.024974    loss: 0.265395
steps 7600    v_Prec: 0.774907  v_Recall: 0.676866  v_F1: 0.722576  v_AUC: 0.906443
steps 7600    running time 293 seconds

steps 7800    base_loss: 0.180725    reg_loss: 0.049066    l2_loss: 0.025194    loss: 0.254985
steps 7800    v_Prec: 0.767432  v_Recall: 0.691012  v_F1: 0.727220  v_AUC: 0.908510
steps 7800    running time 300 seconds

steps 8000    base_loss: 0.185630    reg_loss: 0.048978    l2_loss: 0.025323    loss: 0.259931
steps 8000    v_Prec: 0.782343  v_Recall: 0.682429  v_F1: 0.728978  v_AUC: 0.910022
steps 8000    running time 307 seconds

steps 8200    base_loss: 0.179282    reg_loss: 0.048783    l2_loss: 0.025480    loss: 0.253545
steps 8200    v_Prec: 0.768059  v_Recall: 0.689502  v_F1: 0.726664  v_AUC: 0.909192
steps 8200    running time 314 seconds

steps 8400    base_loss: 0.183299    reg_loss: 0.048450    l2_loss: 0.025565    loss: 0.257314
steps 8400    v_Prec: 0.756884  v_Recall: 0.703409  v_F1: 0.729168  v_AUC: 0.911696
steps 8400    running time 320 seconds

steps 8600    base_loss: 0.188962    reg_loss: 0.048544    l2_loss: 0.025803    loss: 0.263309
steps 8600    v_Prec: 0.765690  v_Recall: 0.701979  v_F1: 0.732452  v_AUC: 0.913175
steps 8600    running time 327 seconds

steps 8800    base_loss: 0.190093    reg_loss: 0.048263    l2_loss: 0.025946    loss: 0.264301
steps 8800    v_Prec: 0.777698  v_Recall: 0.688945  v_F1: 0.730636  v_AUC: 0.913448
steps 8800    running time 334 seconds

steps 9000    base_loss: 0.189651    reg_loss: 0.048427    l2_loss: 0.025970    loss: 0.264049
steps 9000    v_Prec: 0.770473  v_Recall: 0.705078  v_F1: 0.736327  v_AUC: 0.915293
steps 9000    running time 340 seconds

steps 9200    base_loss: 0.170972    reg_loss: 0.047840    l2_loss: 0.026052    loss: 0.244863
steps 9200    v_Prec: 0.767270  v_Recall: 0.707939  v_F1: 0.736411  v_AUC: 0.916258
steps 9200    running time 347 seconds

steps 9400    base_loss: 0.184669    reg_loss: 0.047998    l2_loss: 0.026163    loss: 0.258831
steps 9400    v_Prec: 0.788198  v_Recall: 0.695303  v_F1: 0.738842  v_AUC: 0.916541
steps 9400    running time 354 seconds

steps 9600    base_loss: 0.184544    reg_loss: 0.047920    l2_loss: 0.026368    loss: 0.258832
steps 9600    v_Prec: 0.783404  v_Recall: 0.700787  v_F1: 0.739796  v_AUC: 0.918093
steps 9600    running time 361 seconds

steps 9800    base_loss: 0.188625    reg_loss: 0.047813    l2_loss: 0.026419    loss: 0.262857
steps 9800    v_Prec: 0.764412  v_Recall: 0.717635  v_F1: 0.740285  v_AUC: 0.918573
steps 9800    running time 368 seconds

steps 10000    base_loss: 0.178831    reg_loss: 0.047658    l2_loss: 0.026384    loss: 0.252873
steps 10000    v_Prec: 0.782267  v_Recall: 0.712390  v_F1: 0.745695  v_AUC: 0.921061
steps 10000    running time 375 seconds

steps 10200    base_loss: 0.185727    reg_loss: 0.047600    l2_loss: 0.026430    loss: 0.259757
steps 10200    v_Prec: 0.806283  v_Recall: 0.697608  v_F1: 0.748019  v_AUC: 0.922174
steps 10200    running time 382 seconds

steps 10400    base_loss: 0.181757    reg_loss: 0.047243    l2_loss: 0.026442    loss: 0.255442
steps 10400    v_Prec: 0.799838  v_Recall: 0.706906  v_F1: 0.750506  v_AUC: 0.922241
steps 10400    running time 388 seconds

steps 10600    base_loss: 0.180379    reg_loss: 0.047253    l2_loss: 0.026495    loss: 0.254127
steps 10600    v_Prec: 0.793736  v_Recall: 0.708893  v_F1: 0.748919  v_AUC: 0.923510
steps 10600    running time 395 seconds

steps 10800    base_loss: 0.170709    reg_loss: 0.046567    l2_loss: 0.026584    loss: 0.243860
steps 10800    v_Prec: 0.777531  v_Recall: 0.722721  v_F1: 0.749125  v_AUC: 0.923191
steps 10800    running time 402 seconds

steps 11000    base_loss: 0.070001    reg_loss: 0.042370    l2_loss: 0.026392    loss: 0.138763
steps 11000    v_Prec: 0.810768  v_Recall: 0.692919  v_F1: 0.747225  v_AUC: 0.920941
steps 11000    running time 408 seconds

steps 11200    base_loss: 0.065931    reg_loss: 0.042657    l2_loss: 0.026353    loss: 0.134941
steps 11200    v_Prec: 0.787650  v_Recall: 0.704522  v_F1: 0.743770  v_AUC: 0.918847
steps 11200    running time 414 seconds

steps 11400    base_loss: 0.070193    reg_loss: 0.042624    l2_loss: 0.026363    loss: 0.139180
steps 11400    v_Prec: 0.785632  v_Recall: 0.708337  v_F1: 0.744985  v_AUC: 0.919489
steps 11400    running time 421 seconds

steps 11600    base_loss: 0.065122    reg_loss: 0.042437    l2_loss: 0.026391    loss: 0.133950
steps 11600    v_Prec: 0.788602  v_Recall: 0.703807  v_F1: 0.743795  v_AUC: 0.917908
steps 11600    running time 427 seconds

steps 11800    base_loss: 0.070455    reg_loss: 0.042557    l2_loss: 0.026432    loss: 0.139444
steps 11800    v_Prec: 0.798694  v_Recall: 0.690217  v_F1: 0.740504  v_AUC: 0.916939
steps 11800    running time 433 seconds

steps 12000    base_loss: 0.071440    reg_loss: 0.042690    l2_loss: 0.026274    loss: 0.140404
steps 12000    v_Prec: 0.775933  v_Recall: 0.709211  v_F1: 0.741073  v_AUC: 0.917445
steps 12000    running time 440 seconds

steps 12200    base_loss: 0.073849    reg_loss: 0.042766    l2_loss: 0.026270    loss: 0.142886
steps 12200    v_Prec: 0.794755  v_Recall: 0.693634  v_F1: 0.740760  v_AUC: 0.917589
steps 12200    running time 446 seconds

steps 12400    base_loss: 0.073274    reg_loss: 0.042749    l2_loss: 0.026297    loss: 0.142321
steps 12400    v_Prec: 0.784322  v_Recall: 0.697369  v_F1: 0.738295  v_AUC: 0.917227
steps 12400    running time 452 seconds

Early stop model F1: 0.750506
testing thre: 0.59762496
testing Prec: 0.5902228337728854
testing Recall: 0.7505224787363305
testing F1: 0.6607899353844837
testing AUC: 0.9033738401646687
overall running time 455 seconds
(0.7340588428305808, 0.6523936816524909, 0.6908211317258949, 0.9033738401646687, 0.81194687)

2019-02-24 18:19:46.497174: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:19:46.782626: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:19:46.785161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:19:46.785204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.550000 seconds
loading data in 29.660000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.538845    reg_loss: 0.064584    l2_loss: 0.013291    loss: 0.616719
steps 200    v_Prec: 0.164487  v_Recall: 0.953945  v_F1: 0.280592  v_AUC: 0.537974
steps 200    running time 40 seconds

steps 400    base_loss: 0.517141    reg_loss: 0.064637    l2_loss: 0.013213    loss: 0.594992
steps 400    v_Prec: 0.165962  v_Recall: 0.939447  v_F1: 0.282090  v_AUC: 0.545273
steps 400    running time 47 seconds

steps 600    base_loss: 0.492352    reg_loss: 0.064509    l2_loss: 0.013035    loss: 0.569896
steps 600    v_Prec: 0.188454  v_Recall: 0.666239  v_F1: 0.293803  v_AUC: 0.577537
steps 600    running time 54 seconds

steps 800    base_loss: 0.470090    reg_loss: 0.064312    l2_loss: 0.012903    loss: 0.547304
steps 800    v_Prec: 0.191419  v_Recall: 0.673608  v_F1: 0.298121  v_AUC: 0.588585
steps 800    running time 61 seconds

steps 1000    base_loss: 0.452594    reg_loss: 0.064005    l2_loss: 0.012844    loss: 0.529443
steps 1000    v_Prec: 0.250269  v_Recall: 0.484902  v_F1: 0.330143  v_AUC: 0.644060
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.447649    reg_loss: 0.063774    l2_loss: 0.012781    loss: 0.524204
steps 1200    v_Prec: 0.304204  v_Recall: 0.455587  v_F1: 0.364814  v_AUC: 0.680625
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.431305    reg_loss: 0.063626    l2_loss: 0.012693    loss: 0.507624
steps 1400    v_Prec: 0.365702  v_Recall: 0.447337  v_F1: 0.402421  v_AUC: 0.714134
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.411001    reg_loss: 0.063542    l2_loss: 0.012773    loss: 0.487317
steps 1600    v_Prec: 0.404002  v_Recall: 0.496516  v_F1: 0.445506  v_AUC: 0.756684
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.389457    reg_loss: 0.063658    l2_loss: 0.012901    loss: 0.466016
steps 1800    v_Prec: 0.476041  v_Recall: 0.497317  v_F1: 0.486446  v_AUC: 0.788297
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.378549    reg_loss: 0.064445    l2_loss: 0.013098    loss: 0.456092
steps 2000    v_Prec: 0.530966  v_Recall: 0.528074  v_F1: 0.529516  v_AUC: 0.816267
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.350485    reg_loss: 0.065113    l2_loss: 0.013363    loss: 0.428961
steps 2200    v_Prec: 0.579550  v_Recall: 0.542972  v_F1: 0.560665  v_AUC: 0.835308
steps 2200    running time 112 seconds

steps 2400    base_loss: 0.331429    reg_loss: 0.065280    l2_loss: 0.013665    loss: 0.410374
steps 2400    v_Prec: 0.620294  v_Recall: 0.544974  v_F1: 0.580200  v_AUC: 0.848113
steps 2400    running time 119 seconds

steps 2600    base_loss: 0.330967    reg_loss: 0.065952    l2_loss: 0.013924    loss: 0.410843
steps 2600    v_Prec: 0.612032  v_Recall: 0.576932  v_F1: 0.593964  v_AUC: 0.856022
steps 2600    running time 126 seconds

steps 2800    base_loss: 0.318645    reg_loss: 0.066598    l2_loss: 0.014221    loss: 0.399464
steps 2800    v_Prec: 0.624895  v_Recall: 0.593913  v_F1: 0.609010  v_AUC: 0.862237
steps 2800    running time 133 seconds

steps 3000    base_loss: 0.308426    reg_loss: 0.066759    l2_loss: 0.014581    loss: 0.389766
steps 3000    v_Prec: 0.632693  v_Recall: 0.596155  v_F1: 0.613881  v_AUC: 0.868645
steps 3000    running time 140 seconds

steps 3200    base_loss: 0.308790    reg_loss: 0.066931    l2_loss: 0.014940    loss: 0.390661
steps 3200    v_Prec: 0.662790  v_Recall: 0.602483  v_F1: 0.631199  v_AUC: 0.874216
steps 3200    running time 148 seconds

steps 3400    base_loss: 0.294457    reg_loss: 0.067370    l2_loss: 0.015273    loss: 0.377099
steps 3400    v_Prec: 0.661272  v_Recall: 0.618582  v_F1: 0.639215  v_AUC: 0.878180
steps 3400    running time 155 seconds

steps 3600    base_loss: 0.294940    reg_loss: 0.067605    l2_loss: 0.015760    loss: 0.378306
steps 3600    v_Prec: 0.659281  v_Recall: 0.631558  v_F1: 0.645122  v_AUC: 0.881520
steps 3600    running time 162 seconds

steps 3800    base_loss: 0.291813    reg_loss: 0.067593    l2_loss: 0.016144    loss: 0.375550
steps 3800    v_Prec: 0.681368  v_Recall: 0.617461  v_F1: 0.647842  v_AUC: 0.884927
steps 3800    running time 169 seconds

steps 4000    base_loss: 0.281769    reg_loss: 0.067576    l2_loss: 0.016622    loss: 0.365967
steps 4000    v_Prec: 0.678499  v_Recall: 0.620024  v_F1: 0.647945  v_AUC: 0.887330
steps 4000    running time 176 seconds

steps 4200    base_loss: 0.278383    reg_loss: 0.067754    l2_loss: 0.017135    loss: 0.363273
steps 4200    v_Prec: 0.673323  v_Recall: 0.637405  v_F1: 0.654872  v_AUC: 0.890220
steps 4200    running time 184 seconds

steps 4400    base_loss: 0.283060    reg_loss: 0.067815    l2_loss: 0.017757    loss: 0.368633
steps 4400    v_Prec: 0.687132  v_Recall: 0.636444  v_F1: 0.660817  v_AUC: 0.892716
steps 4400    running time 191 seconds

steps 4600    base_loss: 0.268053    reg_loss: 0.067658    l2_loss: 0.018232    loss: 0.353944
steps 4600    v_Prec: 0.681247  v_Recall: 0.651181  v_F1: 0.665875  v_AUC: 0.895734
steps 4600    running time 198 seconds

steps 4800    base_loss: 0.276067    reg_loss: 0.067759    l2_loss: 0.018881    loss: 0.362707
steps 4800    v_Prec: 0.698594  v_Recall: 0.636764  v_F1: 0.666248  v_AUC: 0.897615
steps 4800    running time 206 seconds

steps 5000    base_loss: 0.275536    reg_loss: 0.067503    l2_loss: 0.019559    loss: 0.362597
steps 5000    v_Prec: 0.702049  v_Recall: 0.636764  v_F1: 0.667815  v_AUC: 0.899616
steps 5000    running time 213 seconds

steps 5200    base_loss: 0.273743    reg_loss: 0.067715    l2_loss: 0.020232    loss: 0.361689
steps 5200    v_Prec: 0.709349  v_Recall: 0.624750  v_F1: 0.664367  v_AUC: 0.897930
steps 5200    running time 220 seconds

steps 5400    base_loss: 0.264487    reg_loss: 0.067633    l2_loss: 0.020895    loss: 0.353016
steps 5400    v_Prec: 0.698826  v_Recall: 0.634121  v_F1: 0.664903  v_AUC: 0.899496
steps 5400    running time 227 seconds

steps 5600    base_loss: 0.182815    reg_loss: 0.068372    l2_loss: 0.021681    loss: 0.272868
steps 5600    v_Prec: 0.673474  v_Recall: 0.649740  v_F1: 0.661394  v_AUC: 0.895837
steps 5600    running time 233 seconds

steps 5800    base_loss: 0.186846    reg_loss: 0.068151    l2_loss: 0.022555    loss: 0.277551
steps 5800    v_Prec: 0.682270  v_Recall: 0.643252  v_F1: 0.662187  v_AUC: 0.894819
steps 5800    running time 240 seconds

steps 6000    base_loss: 0.178847    reg_loss: 0.068370    l2_loss: 0.023272    loss: 0.270488
steps 6000    v_Prec: 0.702036  v_Recall: 0.624269  v_F1: 0.660873  v_AUC: 0.892582
steps 6000    running time 247 seconds

steps 6200    base_loss: 0.195546    reg_loss: 0.068192    l2_loss: 0.023991    loss: 0.287729
steps 6200    v_Prec: 0.696185  v_Recall: 0.632839  v_F1: 0.663002  v_AUC: 0.893616
steps 6200    running time 253 seconds

steps 6400    base_loss: 0.191876    reg_loss: 0.068188    l2_loss: 0.024572    loss: 0.284636
steps 6400    v_Prec: 0.693712  v_Recall: 0.638927  v_F1: 0.665193  v_AUC: 0.894234
steps 6400    running time 260 seconds

steps 6600    base_loss: 0.191169    reg_loss: 0.068253    l2_loss: 0.025098    loss: 0.284519
steps 6600    v_Prec: 0.695164  v_Recall: 0.644774  v_F1: 0.669021  v_AUC: 0.895757
steps 6600    running time 266 seconds

steps 6800    base_loss: 0.179420    reg_loss: 0.067947    l2_loss: 0.025558    loss: 0.272925
steps 6800    v_Prec: 0.695290  v_Recall: 0.649179  v_F1: 0.671444  v_AUC: 0.897218
steps 6800    running time 274 seconds

steps 7000    base_loss: 0.188356    reg_loss: 0.067782    l2_loss: 0.026022    loss: 0.282159
steps 7000    v_Prec: 0.700886  v_Recall: 0.652944  v_F1: 0.676066  v_AUC: 0.898995
steps 7000    running time 281 seconds

steps 7200    base_loss: 0.197645    reg_loss: 0.067883    l2_loss: 0.026610    loss: 0.292138
steps 7200    v_Prec: 0.694197  v_Recall: 0.661113  v_F1: 0.677251  v_AUC: 0.901003
steps 7200    running time 288 seconds

steps 7400    base_loss: 0.192427    reg_loss: 0.068031    l2_loss: 0.026998    loss: 0.287456
steps 7400    v_Prec: 0.701685  v_Recall: 0.667121  v_F1: 0.683966  v_AUC: 0.902990
steps 7400    running time 296 seconds

steps 7600    base_loss: 0.183445    reg_loss: 0.067949    l2_loss: 0.027513    loss: 0.278906
steps 7600    v_Prec: 0.707843  v_Recall: 0.654946  v_F1: 0.680368  v_AUC: 0.901388
steps 7600    running time 303 seconds

steps 7800    base_loss: 0.190959    reg_loss: 0.068021    l2_loss: 0.027967    loss: 0.286947
steps 7800    v_Prec: 0.713457  v_Recall: 0.660312  v_F1: 0.685857  v_AUC: 0.904743
steps 7800    running time 310 seconds

steps 8000    base_loss: 0.193045    reg_loss: 0.067929    l2_loss: 0.028342    loss: 0.289315
steps 8000    v_Prec: 0.720920  v_Recall: 0.662715  v_F1: 0.690593  v_AUC: 0.906124
steps 8000    running time 317 seconds

steps 8200    base_loss: 0.191304    reg_loss: 0.067884    l2_loss: 0.028533    loss: 0.287721
steps 8200    v_Prec: 0.707953  v_Recall: 0.676652  v_F1: 0.691949  v_AUC: 0.907628
steps 8200    running time 324 seconds

steps 8400    base_loss: 0.193170    reg_loss: 0.067953    l2_loss: 0.029028    loss: 0.290151
steps 8400    v_Prec: 0.749977  v_Recall: 0.644373  v_F1: 0.693176  v_AUC: 0.908426
steps 8400    running time 331 seconds

steps 8600    base_loss: 0.194074    reg_loss: 0.067599    l2_loss: 0.029237    loss: 0.290910
steps 8600    v_Prec: 0.726328  v_Recall: 0.671526  v_F1: 0.697853  v_AUC: 0.908975
steps 8600    running time 339 seconds

steps 8800    base_loss: 0.187439    reg_loss: 0.067750    l2_loss: 0.029460    loss: 0.284649
steps 8800    v_Prec: 0.734483  v_Recall: 0.665358  v_F1: 0.698214  v_AUC: 0.910676
steps 8800    running time 346 seconds

steps 9000    base_loss: 0.187449    reg_loss: 0.067474    l2_loss: 0.029791    loss: 0.284714
steps 9000    v_Prec: 0.732578  v_Recall: 0.673608  v_F1: 0.701857  v_AUC: 0.912882
steps 9000    running time 353 seconds

steps 9200    base_loss: 0.193181    reg_loss: 0.067495    l2_loss: 0.030065    loss: 0.290741
steps 9200    v_Prec: 0.723490  v_Recall: 0.690749  v_F1: 0.706740  v_AUC: 0.913297
steps 9200    running time 360 seconds

steps 9400    base_loss: 0.191840    reg_loss: 0.067505    l2_loss: 0.030213    loss: 0.289557
steps 9400    v_Prec: 0.749755  v_Recall: 0.673128  v_F1: 0.709378  v_AUC: 0.914721
steps 9400    running time 368 seconds

steps 9600    base_loss: 0.184304    reg_loss: 0.067577    l2_loss: 0.030527    loss: 0.282408
steps 9600    v_Prec: 0.744318  v_Recall: 0.684581  v_F1: 0.713201  v_AUC: 0.916710
steps 9600    running time 375 seconds

steps 9800    base_loss: 0.189442    reg_loss: 0.067471    l2_loss: 0.030920    loss: 0.287833
steps 9800    v_Prec: 0.747220  v_Recall: 0.688987  v_F1: 0.716923  v_AUC: 0.918275
steps 9800    running time 382 seconds

steps 10000    base_loss: 0.180546    reg_loss: 0.067256    l2_loss: 0.031053    loss: 0.278855
steps 10000    v_Prec: 0.748781  v_Recall: 0.688987  v_F1: 0.717641  v_AUC: 0.918454
steps 10000    running time 389 seconds

steps 10200    base_loss: 0.192124    reg_loss: 0.067311    l2_loss: 0.031204    loss: 0.290639
steps 10200    v_Prec: 0.770047  v_Recall: 0.679936  v_F1: 0.722192  v_AUC: 0.919418
steps 10200    running time 397 seconds

steps 10400    base_loss: 0.186852    reg_loss: 0.067323    l2_loss: 0.031396    loss: 0.285570
steps 10400    v_Prec: 0.762318  v_Recall: 0.688987  v_F1: 0.723800  v_AUC: 0.919916
steps 10400    running time 404 seconds

steps 10600    base_loss: 0.177265    reg_loss: 0.066995    l2_loss: 0.031566    loss: 0.275826
steps 10600    v_Prec: 0.765845  v_Recall: 0.684261  v_F1: 0.722758  v_AUC: 0.921089
steps 10600    running time 411 seconds

steps 10800    base_loss: 0.177810    reg_loss: 0.066970    l2_loss: 0.031823    loss: 0.276603
steps 10800    v_Prec: 0.766673  v_Recall: 0.681378  v_F1: 0.721513  v_AUC: 0.920957
steps 10800    running time 418 seconds

steps 11000    base_loss: 0.077316    reg_loss: 0.066553    l2_loss: 0.031925    loss: 0.175794
steps 11000    v_Prec: 0.750708  v_Recall: 0.679696  v_F1: 0.713439  v_AUC: 0.915571
steps 11000    running time 424 seconds

steps 11200    base_loss: 0.080228    reg_loss: 0.066463    l2_loss: 0.031956    loss: 0.178646
steps 11200    v_Prec: 0.752286  v_Recall: 0.658951  v_F1: 0.702532  v_AUC: 0.910225
steps 11200    running time 431 seconds

steps 11400    base_loss: 0.076193    reg_loss: 0.066169    l2_loss: 0.032042    loss: 0.174403
steps 11400    v_Prec: 0.716153  v_Recall: 0.688907  v_F1: 0.702266  v_AUC: 0.909738
steps 11400    running time 437 seconds

steps 11600    base_loss: 0.076676    reg_loss: 0.066292    l2_loss: 0.032179    loss: 0.175147
steps 11600    v_Prec: 0.721568  v_Recall: 0.676892  v_F1: 0.698516  v_AUC: 0.906350
steps 11600    running time 444 seconds

steps 11800    base_loss: 0.079822    reg_loss: 0.066000    l2_loss: 0.032315    loss: 0.178137
steps 11800    v_Prec: 0.735206  v_Recall: 0.666720  v_F1: 0.699290  v_AUC: 0.906828
steps 11800    running time 451 seconds

steps 12000    base_loss: 0.088057    reg_loss: 0.066099    l2_loss: 0.032547    loss: 0.186703
steps 12000    v_Prec: 0.723800  v_Recall: 0.663276  v_F1: 0.692218  v_AUC: 0.903316
steps 12000    running time 457 seconds

steps 12200    base_loss: 0.080414    reg_loss: 0.066058    l2_loss: 0.032591    loss: 0.179063
steps 12200    v_Prec: 0.731878  v_Recall: 0.660713  v_F1: 0.694477  v_AUC: 0.903475
steps 12200    running time 464 seconds

steps 12400    base_loss: 0.085932    reg_loss: 0.066240    l2_loss: 0.032666    loss: 0.184838
steps 12400    v_Prec: 0.720329  v_Recall: 0.666960  v_F1: 0.692618  v_AUC: 0.902661
steps 12400    running time 471 seconds

Early stop model F1: 0.723800
testing thre: 0.47473085
testing Prec: 0.5483503171096701
testing Recall: 0.7479951397326853
testing F1: 0.6327994901420613
testing AUC: 0.9000906841677081
overall running time 474 seconds
(0.7187693346082457, 0.621093560145808, 0.6663711738019502, 0.9000906841677081, 0.7448213)

2019-02-24 18:25:18.226677: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:25:19.364892: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:25:19.367090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:25:19.367128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.790000 seconds
loading data in 30.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.544654    reg_loss: 0.064769    l2_loss: 0.013298    loss: 0.622720
steps 200    v_Prec: 0.162362  v_Recall: 0.998229  v_F1: 0.279297  v_AUC: 0.544763
steps 200    running time 41 seconds

steps 400    base_loss: 0.498196    reg_loss: 0.064398    l2_loss: 0.013162    loss: 0.575756
steps 400    v_Prec: 0.177206  v_Recall: 0.713400  v_F1: 0.283893  v_AUC: 0.560131
steps 400    running time 48 seconds

steps 600    base_loss: 0.481971    reg_loss: 0.064032    l2_loss: 0.012948    loss: 0.558951
steps 600    v_Prec: 0.189574  v_Recall: 0.677586  v_F1: 0.296261  v_AUC: 0.587508
steps 600    running time 56 seconds

steps 800    base_loss: 0.460525    reg_loss: 0.063256    l2_loss: 0.012670    loss: 0.536451
steps 800    v_Prec: 0.215994  v_Recall: 0.582133  v_F1: 0.315081  v_AUC: 0.623718
steps 800    running time 63 seconds

steps 1000    base_loss: 0.450983    reg_loss: 0.062626    l2_loss: 0.012432    loss: 0.526041
steps 1000    v_Prec: 0.282556  v_Recall: 0.494728  v_F1: 0.359684  v_AUC: 0.687085
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.423766    reg_loss: 0.061759    l2_loss: 0.012444    loss: 0.497970
steps 1200    v_Prec: 0.428059  v_Recall: 0.432193  v_F1: 0.430116  v_AUC: 0.746530
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.391918    reg_loss: 0.061333    l2_loss: 0.012546    loss: 0.465796
steps 1400    v_Prec: 0.488263  v_Recall: 0.493843  v_F1: 0.491037  v_AUC: 0.791570
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.356292    reg_loss: 0.060966    l2_loss: 0.012840    loss: 0.430097
steps 1600    v_Prec: 0.535744  v_Recall: 0.515091  v_F1: 0.525214  v_AUC: 0.812470
steps 1600    running time 91 seconds

steps 1800    base_loss: 0.347064    reg_loss: 0.060718    l2_loss: 0.013109    loss: 0.420890
steps 1800    v_Prec: 0.560988  v_Recall: 0.535614  v_F1: 0.548007  v_AUC: 0.829940
steps 1800    running time 98 seconds

steps 2000    base_loss: 0.332629    reg_loss: 0.060304    l2_loss: 0.013416    loss: 0.406349
steps 2000    v_Prec: 0.533028  v_Recall: 0.598793  v_F1: 0.564000  v_AUC: 0.840632
steps 2000    running time 106 seconds

steps 2200    base_loss: 0.323603    reg_loss: 0.060151    l2_loss: 0.013801    loss: 0.397555
steps 2200    v_Prec: 0.571687  v_Recall: 0.585030  v_F1: 0.578282  v_AUC: 0.849881
steps 2200    running time 113 seconds

steps 2400    base_loss: 0.325250    reg_loss: 0.060078    l2_loss: 0.014179    loss: 0.399506
steps 2400    v_Prec: 0.579546  v_Recall: 0.586076  v_F1: 0.582793  v_AUC: 0.854501
steps 2400    running time 120 seconds

steps 2600    base_loss: 0.315799    reg_loss: 0.059745    l2_loss: 0.014610    loss: 0.390154
steps 2600    v_Prec: 0.605206  v_Recall: 0.583823  v_F1: 0.594322  v_AUC: 0.860429
steps 2600    running time 128 seconds

steps 2800    base_loss: 0.313125    reg_loss: 0.059343    l2_loss: 0.015070    loss: 0.387538
steps 2800    v_Prec: 0.586488  v_Recall: 0.608531  v_F1: 0.597306  v_AUC: 0.863192
steps 2800    running time 135 seconds

steps 3000    base_loss: 0.318789    reg_loss: 0.059087    l2_loss: 0.015535    loss: 0.393411
steps 3000    v_Prec: 0.625810  v_Recall: 0.583099  v_F1: 0.603700  v_AUC: 0.869738
steps 3000    running time 142 seconds

steps 3200    base_loss: 0.310780    reg_loss: 0.058602    l2_loss: 0.016062    loss: 0.385445
steps 3200    v_Prec: 0.611740  v_Recall: 0.608934  v_F1: 0.610334  v_AUC: 0.871179
steps 3200    running time 149 seconds

steps 3400    base_loss: 0.305575    reg_loss: 0.058106    l2_loss: 0.016587    loss: 0.380268
steps 3400    v_Prec: 0.632939  v_Recall: 0.593561  v_F1: 0.612618  v_AUC: 0.873079
steps 3400    running time 156 seconds

steps 3600    base_loss: 0.308847    reg_loss: 0.057656    l2_loss: 0.017153    loss: 0.383656
steps 3600    v_Prec: 0.593400  v_Recall: 0.644024  v_F1: 0.617677  v_AUC: 0.876101
steps 3600    running time 163 seconds

steps 3800    base_loss: 0.307957    reg_loss: 0.057262    l2_loss: 0.017724    loss: 0.382943
steps 3800    v_Prec: 0.637488  v_Recall: 0.609577  v_F1: 0.623221  v_AUC: 0.878477
steps 3800    running time 170 seconds

steps 4000    base_loss: 0.299384    reg_loss: 0.056594    l2_loss: 0.018446    loss: 0.374424
steps 4000    v_Prec: 0.615080  v_Recall: 0.637505  v_F1: 0.626092  v_AUC: 0.881087
steps 4000    running time 177 seconds

steps 4200    base_loss: 0.291922    reg_loss: 0.056066    l2_loss: 0.019105    loss: 0.367093
steps 4200    v_Prec: 0.623561  v_Recall: 0.636459  v_F1: 0.629944  v_AUC: 0.882378
steps 4200    running time 185 seconds

steps 4400    base_loss: 0.295782    reg_loss: 0.055567    l2_loss: 0.019845    loss: 0.371194
steps 4400    v_Prec: 0.635745  v_Recall: 0.623823  v_F1: 0.629727  v_AUC: 0.882469
steps 4400    running time 192 seconds

steps 4600    base_loss: 0.293294    reg_loss: 0.054972    l2_loss: 0.020592    loss: 0.368858
steps 4600    v_Prec: 0.616342  v_Recall: 0.649577  v_F1: 0.632524  v_AUC: 0.884314
steps 4600    running time 198 seconds

steps 4800    base_loss: 0.295705    reg_loss: 0.054363    l2_loss: 0.021324    loss: 0.371392
steps 4800    v_Prec: 0.642816  v_Recall: 0.629779  v_F1: 0.636231  v_AUC: 0.885270
steps 4800    running time 206 seconds

steps 5000    base_loss: 0.294914    reg_loss: 0.054044    l2_loss: 0.022108    loss: 0.371067
steps 5000    v_Prec: 0.631858  v_Recall: 0.642334  v_F1: 0.637053  v_AUC: 0.886081
steps 5000    running time 213 seconds

steps 5200    base_loss: 0.294957    reg_loss: 0.053337    l2_loss: 0.022957    loss: 0.371251
steps 5200    v_Prec: 0.650177  v_Recall: 0.634688  v_F1: 0.642339  v_AUC: 0.887172
steps 5200    running time 220 seconds

steps 5400    base_loss: 0.286278    reg_loss: 0.053057    l2_loss: 0.023657    loss: 0.362993
steps 5400    v_Prec: 0.658243  v_Recall: 0.637264  v_F1: 0.647583  v_AUC: 0.888128
steps 5400    running time 227 seconds

steps 5600    base_loss: 0.157420    reg_loss: 0.054965    l2_loss: 0.024221    loss: 0.236607
steps 5600    v_Prec: 0.651721  v_Recall: 0.618833  v_F1: 0.634851  v_AUC: 0.883941
steps 5600    running time 235 seconds

steps 5800    base_loss: 0.156000    reg_loss: 0.055656    l2_loss: 0.024720    loss: 0.236377
steps 5800    v_Prec: 0.615420  v_Recall: 0.647565  v_F1: 0.631084  v_AUC: 0.879831
steps 5800    running time 241 seconds

steps 6000    base_loss: 0.168916    reg_loss: 0.055983    l2_loss: 0.025251    loss: 0.250150
steps 6000    v_Prec: 0.619852  v_Recall: 0.632274  v_F1: 0.626001  v_AUC: 0.878286
steps 6000    running time 248 seconds

steps 6200    base_loss: 0.165836    reg_loss: 0.055925    l2_loss: 0.025699    loss: 0.247460
steps 6200    v_Prec: 0.617577  v_Recall: 0.627767  v_F1: 0.622630  v_AUC: 0.876019
steps 6200    running time 255 seconds

steps 6400    base_loss: 0.165061    reg_loss: 0.056194    l2_loss: 0.026134    loss: 0.247390
steps 6400    v_Prec: 0.617984  v_Recall: 0.625594  v_F1: 0.621765  v_AUC: 0.874897
steps 6400    running time 261 seconds

steps 6600    base_loss: 0.172048    reg_loss: 0.055878    l2_loss: 0.026768    loss: 0.254694
steps 6600    v_Prec: 0.611492  v_Recall: 0.638954  v_F1: 0.624921  v_AUC: 0.876768
steps 6600    running time 268 seconds

steps 6800    base_loss: 0.171403    reg_loss: 0.055812    l2_loss: 0.027385    loss: 0.254600
steps 6800    v_Prec: 0.614069  v_Recall: 0.641449  v_F1: 0.627460  v_AUC: 0.876162
steps 6800    running time 274 seconds

steps 7000    base_loss: 0.170669    reg_loss: 0.055655    l2_loss: 0.027744    loss: 0.254069
steps 7000    v_Prec: 0.631252  v_Recall: 0.629779  v_F1: 0.630514  v_AUC: 0.878237
steps 7000    running time 281 seconds

steps 7200    base_loss: 0.179061    reg_loss: 0.055750    l2_loss: 0.028205    loss: 0.263016
steps 7200    v_Prec: 0.623460  v_Recall: 0.631388  v_F1: 0.627399  v_AUC: 0.878404
steps 7200    running time 287 seconds

steps 7400    base_loss: 0.169407    reg_loss: 0.055367    l2_loss: 0.028667    loss: 0.253442
steps 7400    v_Prec: 0.622855  v_Recall: 0.645714  v_F1: 0.634079  v_AUC: 0.880603
steps 7400    running time 294 seconds

Early stop model F1: 0.647583
testing thre: 0.42922756
testing Prec: 0.4846090639024082
testing Recall: 0.745273390036452
testing F1: 0.587318306298715
testing AUC: 0.8767212466226109
overall running time 297 seconds
(0.6522283686462791, 0.6074362089914945, 0.629035911115585, 0.8767212466226109, 0.66885465)

2019-02-24 18:28:47.634681: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:28:48.779242: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:28:48.780196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:28:48.780231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.260000 seconds
loading data in 29.330000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.541247    reg_loss: 0.064752    l2_loss: 0.013321    loss: 0.619321
steps 200    v_Prec: 0.163096  v_Recall: 1.000000  v_F1: 0.280451  v_AUC: 0.471628
steps 200    running time 40 seconds

steps 400    base_loss: 0.521615    reg_loss: 0.064767    l2_loss: 0.013281    loss: 0.599664
steps 400    v_Prec: 0.163096  v_Recall: 1.000000  v_F1: 0.280451  v_AUC: 0.511874
steps 400    running time 47 seconds

steps 600    base_loss: 0.490841    reg_loss: 0.064744    l2_loss: 0.013102    loss: 0.568686
steps 600    v_Prec: 0.181827  v_Recall: 0.711760  v_F1: 0.289658  v_AUC: 0.574591
steps 600    running time 54 seconds

steps 800    base_loss: 0.455923    reg_loss: 0.064584    l2_loss: 0.012980    loss: 0.533487
steps 800    v_Prec: 0.234049  v_Recall: 0.543200  v_F1: 0.327142  v_AUC: 0.644324
steps 800    running time 61 seconds

steps 1000    base_loss: 0.438349    reg_loss: 0.064332    l2_loss: 0.012920    loss: 0.515601
steps 1000    v_Prec: 0.338540  v_Recall: 0.440400  v_F1: 0.382810  v_AUC: 0.701336
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.422869    reg_loss: 0.064354    l2_loss: 0.012839    loss: 0.500062
steps 1200    v_Prec: 0.408230  v_Recall: 0.450000  v_F1: 0.428098  v_AUC: 0.743022
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.398781    reg_loss: 0.064441    l2_loss: 0.012911    loss: 0.476132
steps 1400    v_Prec: 0.466495  v_Recall: 0.492320  v_F1: 0.479060  v_AUC: 0.780344
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.379545    reg_loss: 0.064898    l2_loss: 0.012999    loss: 0.457442
steps 1600    v_Prec: 0.538389  v_Recall: 0.503200  v_F1: 0.520200  v_AUC: 0.809484
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.354847    reg_loss: 0.065318    l2_loss: 0.013198    loss: 0.433363
steps 1800    v_Prec: 0.583013  v_Recall: 0.522240  v_F1: 0.550956  v_AUC: 0.825105
steps 1800    running time 98 seconds

steps 2000    base_loss: 0.336763    reg_loss: 0.065556    l2_loss: 0.013472    loss: 0.415790
steps 2000    v_Prec: 0.612962  v_Recall: 0.540240  v_F1: 0.574308  v_AUC: 0.839924
steps 2000    running time 105 seconds

steps 2200    base_loss: 0.329039    reg_loss: 0.066058    l2_loss: 0.013695    loss: 0.408791
steps 2200    v_Prec: 0.628846  v_Recall: 0.560880  v_F1: 0.592921  v_AUC: 0.851273
steps 2200    running time 112 seconds

steps 2400    base_loss: 0.315615    reg_loss: 0.066168    l2_loss: 0.014014    loss: 0.395798
steps 2400    v_Prec: 0.630138  v_Recall: 0.587440  v_F1: 0.608040  v_AUC: 0.857600
steps 2400    running time 119 seconds

steps 2600    base_loss: 0.311601    reg_loss: 0.066709    l2_loss: 0.014274    loss: 0.392584
steps 2600    v_Prec: 0.653601  v_Recall: 0.582960  v_F1: 0.616263  v_AUC: 0.863849
steps 2600    running time 127 seconds

steps 2800    base_loss: 0.301356    reg_loss: 0.066894    l2_loss: 0.014586    loss: 0.382836
steps 2800    v_Prec: 0.662678  v_Recall: 0.598160  v_F1: 0.628768  v_AUC: 0.867719
steps 2800    running time 134 seconds

steps 3000    base_loss: 0.303764    reg_loss: 0.067063    l2_loss: 0.014863    loss: 0.385690
steps 3000    v_Prec: 0.659947  v_Recall: 0.615440  v_F1: 0.636917  v_AUC: 0.872429
steps 3000    running time 141 seconds

steps 3200    base_loss: 0.292313    reg_loss: 0.067183    l2_loss: 0.015220    loss: 0.374716
steps 3200    v_Prec: 0.669439  v_Recall: 0.618240  v_F1: 0.642821  v_AUC: 0.876753
steps 3200    running time 149 seconds

steps 3400    base_loss: 0.293856    reg_loss: 0.067476    l2_loss: 0.015559    loss: 0.376890
steps 3400    v_Prec: 0.668827  v_Recall: 0.627520  v_F1: 0.647515  v_AUC: 0.879877
steps 3400    running time 156 seconds

steps 3600    base_loss: 0.285827    reg_loss: 0.067557    l2_loss: 0.015938    loss: 0.369321
steps 3600    v_Prec: 0.714802  v_Recall: 0.601520  v_F1: 0.653286  v_AUC: 0.883498
steps 3600    running time 163 seconds

steps 3800    base_loss: 0.283397    reg_loss: 0.067570    l2_loss: 0.016272    loss: 0.367239
steps 3800    v_Prec: 0.692193  v_Recall: 0.630560  v_F1: 0.659941  v_AUC: 0.888445
steps 3800    running time 170 seconds

steps 4000    base_loss: 0.280104    reg_loss: 0.067777    l2_loss: 0.016800    loss: 0.364681
steps 4000    v_Prec: 0.703583  v_Recall: 0.623600  v_F1: 0.661182  v_AUC: 0.891184
steps 4000    running time 178 seconds

steps 4200    base_loss: 0.281180    reg_loss: 0.067576    l2_loss: 0.017327    loss: 0.366083
steps 4200    v_Prec: 0.695227  v_Recall: 0.637440  v_F1: 0.665081  v_AUC: 0.893113
steps 4200    running time 185 seconds

steps 4400    base_loss: 0.274758    reg_loss: 0.067693    l2_loss: 0.017808    loss: 0.360260
steps 4400    v_Prec: 0.699270  v_Recall: 0.643440  v_F1: 0.670194  v_AUC: 0.894920
steps 4400    running time 193 seconds

steps 4600    base_loss: 0.273874    reg_loss: 0.067539    l2_loss: 0.018355    loss: 0.359768
steps 4600    v_Prec: 0.702522  v_Recall: 0.637440  v_F1: 0.668400  v_AUC: 0.895677
steps 4600    running time 200 seconds

steps 4800    base_loss: 0.276991    reg_loss: 0.067555    l2_loss: 0.018929    loss: 0.363475
steps 4800    v_Prec: 0.707336  v_Recall: 0.640960  v_F1: 0.672514  v_AUC: 0.899344
steps 4800    running time 207 seconds

steps 5000    base_loss: 0.267907    reg_loss: 0.067501    l2_loss: 0.019477    loss: 0.354886
steps 5000    v_Prec: 0.697226  v_Recall: 0.645520  v_F1: 0.670378  v_AUC: 0.900363
steps 5000    running time 214 seconds

steps 5200    base_loss: 0.274962    reg_loss: 0.067634    l2_loss: 0.020065    loss: 0.362662
steps 5200    v_Prec: 0.701085  v_Recall: 0.651280  v_F1: 0.675265  v_AUC: 0.901454
steps 5200    running time 221 seconds

steps 5400    base_loss: 0.261325    reg_loss: 0.067367    l2_loss: 0.020783    loss: 0.349475
steps 5400    v_Prec: 0.695174  v_Recall: 0.656800  v_F1: 0.675442  v_AUC: 0.903251
steps 5400    running time 228 seconds

steps 5600    base_loss: 0.165368    reg_loss: 0.068257    l2_loss: 0.021699    loss: 0.255325
steps 5600    v_Prec: 0.698411  v_Recall: 0.640080  v_F1: 0.667975  v_AUC: 0.898467
steps 5600    running time 236 seconds

steps 5800    base_loss: 0.186431    reg_loss: 0.068097    l2_loss: 0.022512    loss: 0.277040
steps 5800    v_Prec: 0.697203  v_Recall: 0.644160  v_F1: 0.669633  v_AUC: 0.897833
steps 5800    running time 242 seconds

steps 6000    base_loss: 0.179720    reg_loss: 0.068028    l2_loss: 0.023239    loss: 0.270987
steps 6000    v_Prec: 0.693796  v_Recall: 0.642400  v_F1: 0.667110  v_AUC: 0.894739
steps 6000    running time 249 seconds

steps 6200    base_loss: 0.183578    reg_loss: 0.067917    l2_loss: 0.023940    loss: 0.275435
steps 6200    v_Prec: 0.697155  v_Recall: 0.648800  v_F1: 0.672109  v_AUC: 0.897492
steps 6200    running time 255 seconds

steps 6400    base_loss: 0.185382    reg_loss: 0.067878    l2_loss: 0.024488    loss: 0.277748
steps 6400    v_Prec: 0.706624  v_Recall: 0.640880  v_F1: 0.672148  v_AUC: 0.896761
steps 6400    running time 262 seconds

steps 6600    base_loss: 0.184392    reg_loss: 0.067868    l2_loss: 0.025151    loss: 0.277411
steps 6600    v_Prec: 0.721035  v_Recall: 0.637280  v_F1: 0.676576  v_AUC: 0.896284
steps 6600    running time 268 seconds

steps 6800    base_loss: 0.184880    reg_loss: 0.067800    l2_loss: 0.025694    loss: 0.278374
steps 6800    v_Prec: 0.694265  v_Recall: 0.654720  v_F1: 0.673913  v_AUC: 0.896038
steps 6800    running time 276 seconds

steps 7000    base_loss: 0.189484    reg_loss: 0.067885    l2_loss: 0.026198    loss: 0.283567
steps 7000    v_Prec: 0.716070  v_Recall: 0.642000  v_F1: 0.677015  v_AUC: 0.897742
steps 7000    running time 282 seconds

steps 7200    base_loss: 0.181951    reg_loss: 0.067707    l2_loss: 0.026685    loss: 0.276343
steps 7200    v_Prec: 0.712870  v_Recall: 0.656240  v_F1: 0.683384  v_AUC: 0.898462
steps 7200    running time 290 seconds

steps 7400    base_loss: 0.189667    reg_loss: 0.067936    l2_loss: 0.027117    loss: 0.284720
steps 7400    v_Prec: 0.732041  v_Recall: 0.646480  v_F1: 0.686605  v_AUC: 0.902098
steps 7400    running time 297 seconds

steps 7600    base_loss: 0.185736    reg_loss: 0.067709    l2_loss: 0.027493    loss: 0.280938
steps 7600    v_Prec: 0.727087  v_Recall: 0.655600  v_F1: 0.689496  v_AUC: 0.902169
steps 7600    running time 304 seconds

steps 7800    base_loss: 0.186682    reg_loss: 0.067799    l2_loss: 0.027918    loss: 0.282400
steps 7800    v_Prec: 0.714395  v_Recall: 0.674160  v_F1: 0.693694  v_AUC: 0.903743
steps 7800    running time 311 seconds

steps 8000    base_loss: 0.198323    reg_loss: 0.067733    l2_loss: 0.028187    loss: 0.294243
steps 8000    v_Prec: 0.737889  v_Recall: 0.655600  v_F1: 0.694315  v_AUC: 0.904751
steps 8000    running time 319 seconds

steps 8200    base_loss: 0.182322    reg_loss: 0.067558    l2_loss: 0.028496    loss: 0.278376
steps 8200    v_Prec: 0.726302  v_Recall: 0.669360  v_F1: 0.696669  v_AUC: 0.906182
steps 8200    running time 326 seconds

steps 8400    base_loss: 0.193530    reg_loss: 0.067605    l2_loss: 0.028763    loss: 0.289899
steps 8400    v_Prec: 0.726018  v_Recall: 0.677520  v_F1: 0.700931  v_AUC: 0.907909
steps 8400    running time 333 seconds

steps 8600    base_loss: 0.180973    reg_loss: 0.067495    l2_loss: 0.029166    loss: 0.277634
steps 8600    v_Prec: 0.744647  v_Recall: 0.664880  v_F1: 0.702506  v_AUC: 0.908785
steps 8600    running time 340 seconds

steps 8800    base_loss: 0.186719    reg_loss: 0.067321    l2_loss: 0.029460    loss: 0.283499
steps 8800    v_Prec: 0.754101  v_Recall: 0.658240  v_F1: 0.702917  v_AUC: 0.910559
steps 8800    running time 347 seconds

steps 9000    base_loss: 0.178959    reg_loss: 0.067395    l2_loss: 0.029673    loss: 0.276026
steps 9000    v_Prec: 0.742546  v_Recall: 0.671440  v_F1: 0.705205  v_AUC: 0.910486
steps 9000    running time 355 seconds

steps 9200    base_loss: 0.188006    reg_loss: 0.067490    l2_loss: 0.029906    loss: 0.285402
steps 9200    v_Prec: 0.745624  v_Recall: 0.678160  v_F1: 0.710294  v_AUC: 0.912674
steps 9200    running time 362 seconds

steps 9400    base_loss: 0.187089    reg_loss: 0.067549    l2_loss: 0.030228    loss: 0.284867
steps 9400    v_Prec: 0.764205  v_Recall: 0.667120  v_F1: 0.712370  v_AUC: 0.913568
steps 9400    running time 369 seconds

steps 9600    base_loss: 0.185347    reg_loss: 0.067437    l2_loss: 0.030412    loss: 0.283195
steps 9600    v_Prec: 0.761160  v_Recall: 0.673840  v_F1: 0.714843  v_AUC: 0.914309
steps 9600    running time 377 seconds

steps 9800    base_loss: 0.182609    reg_loss: 0.067230    l2_loss: 0.030651    loss: 0.280490
steps 9800    v_Prec: 0.747119  v_Recall: 0.689920  v_F1: 0.717381  v_AUC: 0.916587
steps 9800    running time 384 seconds

steps 10000    base_loss: 0.180941    reg_loss: 0.067320    l2_loss: 0.030855    loss: 0.279116
steps 10000    v_Prec: 0.757535  v_Recall: 0.679600  v_F1: 0.716454  v_AUC: 0.916176
steps 10000    running time 391 seconds

steps 10200    base_loss: 0.182082    reg_loss: 0.067025    l2_loss: 0.031040    loss: 0.280147
steps 10200    v_Prec: 0.759116  v_Recall: 0.684480  v_F1: 0.719869  v_AUC: 0.917199
steps 10200    running time 398 seconds

steps 10400    base_loss: 0.184687    reg_loss: 0.067481    l2_loss: 0.031198    loss: 0.283366
steps 10400    v_Prec: 0.765682  v_Recall: 0.682560  v_F1: 0.721736  v_AUC: 0.919017
steps 10400    running time 405 seconds

steps 10600    base_loss: 0.175721    reg_loss: 0.066996    l2_loss: 0.031440    loss: 0.274157
steps 10600    v_Prec: 0.768802  v_Recall: 0.683680  v_F1: 0.723747  v_AUC: 0.919141
steps 10600    running time 413 seconds

steps 10800    base_loss: 0.175321    reg_loss: 0.066751    l2_loss: 0.031585    loss: 0.273657
steps 10800    v_Prec: 0.777404  v_Recall: 0.684800  v_F1: 0.728170  v_AUC: 0.920091
steps 10800    running time 420 seconds

steps 11000    base_loss: 0.078365    reg_loss: 0.066257    l2_loss: 0.031766    loss: 0.176388
steps 11000    v_Prec: 0.769188  v_Recall: 0.669440  v_F1: 0.715856  v_AUC: 0.914323
steps 11000    running time 427 seconds

steps 11200    base_loss: 0.073813    reg_loss: 0.066104    l2_loss: 0.031810    loss: 0.171727
steps 11200    v_Prec: 0.752084  v_Recall: 0.671280  v_F1: 0.709388  v_AUC: 0.910447
steps 11200    running time 434 seconds

steps 11400    base_loss: 0.071866    reg_loss: 0.066114    l2_loss: 0.031796    loss: 0.169777
steps 11400    v_Prec: 0.758840  v_Recall: 0.659280  v_F1: 0.705565  v_AUC: 0.906533
steps 11400    running time 440 seconds

steps 11600    base_loss: 0.078916    reg_loss: 0.066270    l2_loss: 0.031960    loss: 0.177146
steps 11600    v_Prec: 0.750685  v_Recall: 0.657120  v_F1: 0.700793  v_AUC: 0.905855
steps 11600    running time 447 seconds

steps 11800    base_loss: 0.077823    reg_loss: 0.066066    l2_loss: 0.032142    loss: 0.176031
steps 11800    v_Prec: 0.739331  v_Recall: 0.665280  v_F1: 0.700354  v_AUC: 0.905245
steps 11800    running time 453 seconds

steps 12000    base_loss: 0.076417    reg_loss: 0.065908    l2_loss: 0.032253    loss: 0.174578
steps 12000    v_Prec: 0.753092  v_Recall: 0.652720  v_F1: 0.699323  v_AUC: 0.904573
steps 12000    running time 460 seconds

steps 12200    base_loss: 0.078078    reg_loss: 0.065937    l2_loss: 0.032317    loss: 0.176332
steps 12200    v_Prec: 0.742824  v_Recall: 0.658320  v_F1: 0.698024  v_AUC: 0.903209
steps 12200    running time 467 seconds

steps 12400    base_loss: 0.085812    reg_loss: 0.066033    l2_loss: 0.032474    loss: 0.184319
steps 12400    v_Prec: 0.743262  v_Recall: 0.655200  v_F1: 0.696458  v_AUC: 0.901272
steps 12400    running time 473 seconds

steps 12600    base_loss: 0.082096    reg_loss: 0.065876    l2_loss: 0.032569    loss: 0.180541
steps 12600    v_Prec: 0.731092  v_Recall: 0.661200  v_F1: 0.694392  v_AUC: 0.900779
steps 12600    running time 479 seconds

steps 12800    base_loss: 0.088848    reg_loss: 0.065802    l2_loss: 0.032734    loss: 0.187385
steps 12800    v_Prec: 0.714189  v_Recall: 0.677280  v_F1: 0.695245  v_AUC: 0.899776
steps 12800    running time 486 seconds

Early stop model F1: 0.728170
testing thre: 0.42329141
testing Prec: 0.5624243313644202
testing Recall: 0.7450789793438639
testing F1: 0.6409934771700954
testing AUC: 0.9024805029956301
overall running time 488 seconds
(0.7224813170759117, 0.6249331713244228, 0.6701761701240487, 0.9024805029956301, 0.7157817)

2019-02-24 18:34:28.079655: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:34:28.529475: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:34:28.531128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:34:28.531167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.470000 seconds
loading data in 30.440000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.776674    reg_loss: 0.064957    l2_loss: 0.013288    loss: 0.854920
steps 200    v_Prec: 0.160820  v_Recall: 0.999189  v_F1: 0.277048  v_AUC: 0.511606
steps 200    running time 41 seconds

steps 400    base_loss: 0.584181    reg_loss: 0.064920    l2_loss: 0.013115    loss: 0.662216
steps 400    v_Prec: 0.167375  v_Recall: 0.847196  v_F1: 0.279526  v_AUC: 0.545208
steps 400    running time 48 seconds

steps 600    base_loss: 0.495867    reg_loss: 0.064486    l2_loss: 0.013003    loss: 0.573356
steps 600    v_Prec: 0.180441  v_Recall: 0.753713  v_F1: 0.291174  v_AUC: 0.580093
steps 600    running time 55 seconds

steps 800    base_loss: 0.477129    reg_loss: 0.064160    l2_loss: 0.012949    loss: 0.554238
steps 800    v_Prec: 0.227424  v_Recall: 0.578349  v_F1: 0.326470  v_AUC: 0.642164
steps 800    running time 62 seconds

steps 1000    base_loss: 0.445241    reg_loss: 0.063567    l2_loss: 0.012855    loss: 0.521664
steps 1000    v_Prec: 0.270626  v_Recall: 0.561389  v_F1: 0.365201  v_AUC: 0.694128
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.431528    reg_loss: 0.062825    l2_loss: 0.012785    loss: 0.507138
steps 1200    v_Prec: 0.321751  v_Recall: 0.515459  v_F1: 0.396195  v_AUC: 0.725305
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.419968    reg_loss: 0.062101    l2_loss: 0.012821    loss: 0.494890
steps 1400    v_Prec: 0.356443  v_Recall: 0.513998  v_F1: 0.420962  v_AUC: 0.748511
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.408076    reg_loss: 0.061666    l2_loss: 0.012930    loss: 0.482672
steps 1600    v_Prec: 0.425445  v_Recall: 0.489004  v_F1: 0.455016  v_AUC: 0.780177
steps 1600    running time 91 seconds

steps 1800    base_loss: 0.391077    reg_loss: 0.061125    l2_loss: 0.013154    loss: 0.465355
steps 1800    v_Prec: 0.446199  v_Recall: 0.543455  v_F1: 0.490048  v_AUC: 0.805316
steps 1800    running time 98 seconds

steps 2000    base_loss: 0.371369    reg_loss: 0.060358    l2_loss: 0.013395    loss: 0.445122
steps 2000    v_Prec: 0.500446  v_Recall: 0.546701  v_F1: 0.522552  v_AUC: 0.827719
steps 2000    running time 105 seconds

steps 2200    base_loss: 0.348109    reg_loss: 0.059550    l2_loss: 0.013692    loss: 0.421351
steps 2200    v_Prec: 0.549695  v_Recall: 0.555628  v_F1: 0.552645  v_AUC: 0.841897
steps 2200    running time 112 seconds

steps 2400    base_loss: 0.336055    reg_loss: 0.059011    l2_loss: 0.014090    loss: 0.409156
steps 2400    v_Prec: 0.588211  v_Recall: 0.574130  v_F1: 0.581085  v_AUC: 0.857079
steps 2400    running time 119 seconds

steps 2600    base_loss: 0.324443    reg_loss: 0.058512    l2_loss: 0.014468    loss: 0.397423
steps 2600    v_Prec: 0.552273  v_Recall: 0.628013  v_F1: 0.587713  v_AUC: 0.863010
steps 2600    running time 127 seconds

steps 2800    base_loss: 0.315663    reg_loss: 0.057776    l2_loss: 0.014932    loss: 0.388371
steps 2800    v_Prec: 0.602043  v_Recall: 0.612107  v_F1: 0.607034  v_AUC: 0.870719
steps 2800    running time 134 seconds

steps 3000    base_loss: 0.313275    reg_loss: 0.057482    l2_loss: 0.015423    loss: 0.386180
steps 3000    v_Prec: 0.626458  v_Recall: 0.601396  v_F1: 0.613671  v_AUC: 0.874926
steps 3000    running time 141 seconds

steps 3200    base_loss: 0.307635    reg_loss: 0.056848    l2_loss: 0.015916    loss: 0.380400
steps 3200    v_Prec: 0.608876  v_Recall: 0.642376  v_F1: 0.625178  v_AUC: 0.879674
steps 3200    running time 148 seconds

steps 3400    base_loss: 0.298429    reg_loss: 0.056201    l2_loss: 0.016442    loss: 0.371073
steps 3400    v_Prec: 0.651739  v_Recall: 0.618843  v_F1: 0.634865  v_AUC: 0.882955
steps 3400    running time 155 seconds

steps 3600    base_loss: 0.308416    reg_loss: 0.055887    l2_loss: 0.017024    loss: 0.381327
steps 3600    v_Prec: 0.653758  v_Recall: 0.623306  v_F1: 0.638169  v_AUC: 0.885107
steps 3600    running time 162 seconds

steps 3800    base_loss: 0.306892    reg_loss: 0.055274    l2_loss: 0.017573    loss: 0.379739
steps 3800    v_Prec: 0.654039  v_Recall: 0.634667  v_F1: 0.644207  v_AUC: 0.888193
steps 3800    running time 170 seconds

steps 4000    base_loss: 0.291970    reg_loss: 0.054572    l2_loss: 0.018181    loss: 0.364722
steps 4000    v_Prec: 0.679462  v_Recall: 0.614785  v_F1: 0.645508  v_AUC: 0.888378
steps 4000    running time 177 seconds

steps 4200    base_loss: 0.286253    reg_loss: 0.053852    l2_loss: 0.018791    loss: 0.358896
steps 4200    v_Prec: 0.661883  v_Recall: 0.640023  v_F1: 0.650769  v_AUC: 0.891540
steps 4200    running time 184 seconds

steps 4400    base_loss: 0.287498    reg_loss: 0.053402    l2_loss: 0.019454    loss: 0.360354
steps 4400    v_Prec: 0.642150  v_Recall: 0.663150  v_F1: 0.652481  v_AUC: 0.892145
steps 4400    running time 191 seconds

steps 4600    base_loss: 0.288771    reg_loss: 0.052878    l2_loss: 0.020059    loss: 0.361707
steps 4600    v_Prec: 0.656996  v_Recall: 0.652357  v_F1: 0.654668  v_AUC: 0.894154
steps 4600    running time 199 seconds

steps 4800    base_loss: 0.288536    reg_loss: 0.052448    l2_loss: 0.020774    loss: 0.361759
steps 4800    v_Prec: 0.660201  v_Recall: 0.654630  v_F1: 0.657404  v_AUC: 0.895637
steps 4800    running time 206 seconds

steps 5000    base_loss: 0.285264    reg_loss: 0.051815    l2_loss: 0.021486    loss: 0.358565
steps 5000    v_Prec: 0.698147  v_Recall: 0.626877  v_F1: 0.660595  v_AUC: 0.895265
steps 5000    running time 213 seconds

steps 5200    base_loss: 0.285751    reg_loss: 0.051285    l2_loss: 0.022182    loss: 0.359217
steps 5200    v_Prec: 0.664452  v_Recall: 0.665585  v_F1: 0.665018  v_AUC: 0.898377
steps 5200    running time 221 seconds

steps 5400    base_loss: 0.282006    reg_loss: 0.050909    l2_loss: 0.022991    loss: 0.355906
steps 5400    v_Prec: 0.677792  v_Recall: 0.657551  v_F1: 0.667518  v_AUC: 0.898597
steps 5400    running time 228 seconds

steps 5600    base_loss: 0.185831    reg_loss: 0.051879    l2_loss: 0.023651    loss: 0.261361
steps 5600    v_Prec: 0.694594  v_Recall: 0.637101  v_F1: 0.664607  v_AUC: 0.895656
steps 5600    running time 235 seconds

steps 5800    base_loss: 0.171146    reg_loss: 0.052522    l2_loss: 0.024102    loss: 0.247770
steps 5800    v_Prec: 0.662693  v_Recall: 0.658606  v_F1: 0.660643  v_AUC: 0.894373
steps 5800    running time 242 seconds

steps 6000    base_loss: 0.169481    reg_loss: 0.052868    l2_loss: 0.024725    loss: 0.247074
steps 6000    v_Prec: 0.671305  v_Recall: 0.630285  v_F1: 0.650149  v_AUC: 0.889005
steps 6000    running time 248 seconds

steps 6200    base_loss: 0.181112    reg_loss: 0.052983    l2_loss: 0.025244    loss: 0.259339
steps 6200    v_Prec: 0.661919  v_Recall: 0.644892  v_F1: 0.653294  v_AUC: 0.890373
steps 6200    running time 255 seconds

steps 6400    base_loss: 0.175718    reg_loss: 0.052876    l2_loss: 0.025847    loss: 0.254441
steps 6400    v_Prec: 0.641169  v_Recall: 0.669318  v_F1: 0.654941  v_AUC: 0.893179
steps 6400    running time 262 seconds

steps 6600    base_loss: 0.178475    reg_loss: 0.052586    l2_loss: 0.026395    loss: 0.257456
steps 6600    v_Prec: 0.656909  v_Recall: 0.651952  v_F1: 0.654421  v_AUC: 0.891567
steps 6600    running time 268 seconds

steps 6800    base_loss: 0.167265    reg_loss: 0.052547    l2_loss: 0.026883    loss: 0.246695
steps 6800    v_Prec: 0.668537  v_Recall: 0.638156  v_F1: 0.652993  v_AUC: 0.890414
steps 6800    running time 275 seconds

steps 7000    base_loss: 0.184062    reg_loss: 0.052433    l2_loss: 0.027364    loss: 0.263859
steps 7000    v_Prec: 0.666497  v_Recall: 0.637183  v_F1: 0.651510  v_AUC: 0.890286
steps 7000    running time 282 seconds

steps 7200    base_loss: 0.186278    reg_loss: 0.052393    l2_loss: 0.027794    loss: 0.266465
steps 7200    v_Prec: 0.654424  v_Recall: 0.660797  v_F1: 0.657595  v_AUC: 0.893396
steps 7200    running time 288 seconds

steps 7400    base_loss: 0.179773    reg_loss: 0.052136    l2_loss: 0.028227    loss: 0.260136
steps 7400    v_Prec: 0.664811  v_Recall: 0.649274  v_F1: 0.656950  v_AUC: 0.892096
steps 7400    running time 295 seconds

Early stop model F1: 0.667518
testing thre: 0.35536155
testing Prec: 0.5052222817354044
testing Recall: 0.7335115431348724
testing F1: 0.5983309215612425
testing AUC: 0.8778138369711621
overall running time 298 seconds
(0.6604636492666772, 0.6106439854191981, 0.6345775039143392, 0.8778138369711621, 0.583636)

2019-02-24 18:37:59.705144: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:38:00.433555: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:38:00.437085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:38:00.437142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.290000 seconds
loading data in 30.480000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.569164    reg_loss: 0.064858    l2_loss: 0.013327    loss: 0.647349
steps 200    v_Prec: 0.163299  v_Recall: 0.996481  v_F1: 0.280612  v_AUC: 0.526398
steps 200    running time 41 seconds

steps 400    base_loss: 0.543274    reg_loss: 0.064531    l2_loss: 0.013225    loss: 0.621030
steps 400    v_Prec: 0.169581  v_Recall: 0.874130  v_F1: 0.284055  v_AUC: 0.557538
steps 400    running time 48 seconds

steps 600    base_loss: 0.510043    reg_loss: 0.063958    l2_loss: 0.013049    loss: 0.587050
steps 600    v_Prec: 0.211309  v_Recall: 0.568413  v_F1: 0.308086  v_AUC: 0.612203
steps 600    running time 56 seconds

steps 800    base_loss: 0.459682    reg_loss: 0.063252    l2_loss: 0.012885    loss: 0.535819
steps 800    v_Prec: 0.243288  v_Recall: 0.520992  v_F1: 0.331687  v_AUC: 0.645199
steps 800    running time 63 seconds

steps 1000    base_loss: 0.434786    reg_loss: 0.062363    l2_loss: 0.012870    loss: 0.510019
steps 1000    v_Prec: 0.330541  v_Recall: 0.454458  v_F1: 0.382719  v_AUC: 0.703908
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.418433    reg_loss: 0.061712    l2_loss: 0.012910    loss: 0.493055
steps 1200    v_Prec: 0.451728  v_Recall: 0.445262  v_F1: 0.448472  v_AUC: 0.753130
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.388058    reg_loss: 0.060778    l2_loss: 0.013029    loss: 0.461864
steps 1400    v_Prec: 0.519725  v_Recall: 0.483567  v_F1: 0.500994  v_AUC: 0.790275
steps 1400    running time 85 seconds

steps 1600    base_loss: 0.373432    reg_loss: 0.060192    l2_loss: 0.013203    loss: 0.446826
steps 1600    v_Prec: 0.583697  v_Recall: 0.513075  v_F1: 0.546112  v_AUC: 0.820403
steps 1600    running time 92 seconds

steps 1800    base_loss: 0.336356    reg_loss: 0.059343    l2_loss: 0.013363    loss: 0.409062
steps 1800    v_Prec: 0.624660  v_Recall: 0.531947  v_F1: 0.574588  v_AUC: 0.836619
steps 1800    running time 99 seconds

steps 2000    base_loss: 0.326282    reg_loss: 0.058778    l2_loss: 0.013674    loss: 0.398734
steps 2000    v_Prec: 0.636323  v_Recall: 0.563455  v_F1: 0.597676  v_AUC: 0.848666
steps 2000    running time 106 seconds

steps 2200    base_loss: 0.318542    reg_loss: 0.058180    l2_loss: 0.013977    loss: 0.390699
steps 2200    v_Prec: 0.696449  v_Recall: 0.544182  v_F1: 0.610971  v_AUC: 0.858346
steps 2200    running time 113 seconds

steps 2400    base_loss: 0.298024    reg_loss: 0.057530    l2_loss: 0.014314    loss: 0.369869
steps 2400    v_Prec: 0.682640  v_Recall: 0.579848  v_F1: 0.627059  v_AUC: 0.865046
steps 2400    running time 120 seconds

steps 2600    base_loss: 0.310285    reg_loss: 0.057245    l2_loss: 0.014643    loss: 0.382173
steps 2600    v_Prec: 0.731282  v_Recall: 0.566253  v_F1: 0.638273  v_AUC: 0.870360
steps 2600    running time 128 seconds

steps 2800    base_loss: 0.290772    reg_loss: 0.056309    l2_loss: 0.014980    loss: 0.362060
steps 2800    v_Prec: 0.745451  v_Recall: 0.573291  v_F1: 0.648133  v_AUC: 0.874815
steps 2800    running time 135 seconds

steps 3000    base_loss: 0.287118    reg_loss: 0.055812    l2_loss: 0.015253    loss: 0.358183
steps 3000    v_Prec: 0.720977  v_Recall: 0.596961  v_F1: 0.653134  v_AUC: 0.878109
steps 3000    running time 142 seconds

steps 3200    base_loss: 0.287245    reg_loss: 0.055478    l2_loss: 0.015657    loss: 0.358380
steps 3200    v_Prec: 0.718269  v_Recall: 0.611835  v_F1: 0.660794  v_AUC: 0.881696
steps 3200    running time 150 seconds

steps 3400    base_loss: 0.281755    reg_loss: 0.055060    l2_loss: 0.016042    loss: 0.352858
steps 3400    v_Prec: 0.743053  v_Recall: 0.598721  v_F1: 0.663124  v_AUC: 0.883655
steps 3400    running time 157 seconds

steps 3600    base_loss: 0.283806    reg_loss: 0.054631    l2_loss: 0.016407    loss: 0.354845
steps 3600    v_Prec: 0.698432  v_Recall: 0.644702  v_F1: 0.670492  v_AUC: 0.885005
steps 3600    running time 164 seconds

steps 3800    base_loss: 0.279687    reg_loss: 0.054059    l2_loss: 0.016837    loss: 0.350583
steps 3800    v_Prec: 0.723728  v_Recall: 0.638305  v_F1: 0.678338  v_AUC: 0.887244
steps 3800    running time 172 seconds

steps 4000    base_loss: 0.279758    reg_loss: 0.053686    l2_loss: 0.017334    loss: 0.350778
steps 4000    v_Prec: 0.717333  v_Recall: 0.645342  v_F1: 0.679436  v_AUC: 0.889072
steps 4000    running time 179 seconds

steps 4200    base_loss: 0.272684    reg_loss: 0.053228    l2_loss: 0.017677    loss: 0.343590
steps 4200    v_Prec: 0.705857  v_Recall: 0.663974  v_F1: 0.684276  v_AUC: 0.891809
steps 4200    running time 186 seconds

steps 4400    base_loss: 0.267011    reg_loss: 0.052879    l2_loss: 0.018079    loss: 0.337969
steps 4400    v_Prec: 0.730697  v_Recall: 0.653099  v_F1: 0.689722  v_AUC: 0.893976
steps 4400    running time 194 seconds

steps 4600    base_loss: 0.261282    reg_loss: 0.052535    l2_loss: 0.018500    loss: 0.332317
steps 4600    v_Prec: 0.739047  v_Recall: 0.647501  v_F1: 0.690252  v_AUC: 0.893946
steps 4600    running time 201 seconds

steps 4800    base_loss: 0.269993    reg_loss: 0.052237    l2_loss: 0.018943    loss: 0.341174
steps 4800    v_Prec: 0.738690  v_Recall: 0.652859  v_F1: 0.693127  v_AUC: 0.897093
steps 4800    running time 208 seconds

steps 5000    base_loss: 0.263699    reg_loss: 0.052165    l2_loss: 0.019470    loss: 0.335335
steps 5000    v_Prec: 0.736679  v_Recall: 0.665574  v_F1: 0.699324  v_AUC: 0.899247
steps 5000    running time 216 seconds

steps 5200    base_loss: 0.267142    reg_loss: 0.052173    l2_loss: 0.019858    loss: 0.339173
steps 5200    v_Prec: 0.702317  v_Recall: 0.695802  v_F1: 0.699044  v_AUC: 0.900928
steps 5200    running time 223 seconds

steps 5400    base_loss: 0.253905    reg_loss: 0.052040    l2_loss: 0.020352    loss: 0.326297
steps 5400    v_Prec: 0.731049  v_Recall: 0.684046  v_F1: 0.706767  v_AUC: 0.901440
steps 5400    running time 229 seconds

steps 5600    base_loss: 0.165424    reg_loss: 0.049496    l2_loss: 0.020900    loss: 0.235820
steps 5600    v_Prec: 0.735965  v_Recall: 0.670932  v_F1: 0.701945  v_AUC: 0.896254
steps 5600    running time 237 seconds

steps 5800    base_loss: 0.164778    reg_loss: 0.049499    l2_loss: 0.021532    loss: 0.235809
steps 5800    v_Prec: 0.765949  v_Recall: 0.643263  v_F1: 0.699265  v_AUC: 0.893295
steps 5800    running time 243 seconds

steps 6000    base_loss: 0.157294    reg_loss: 0.049165    l2_loss: 0.022234    loss: 0.228693
steps 6000    v_Prec: 0.755392  v_Recall: 0.649740  v_F1: 0.698594  v_AUC: 0.891806
steps 6000    running time 250 seconds

steps 6200    base_loss: 0.165551    reg_loss: 0.049352    l2_loss: 0.022745    loss: 0.237647
steps 6200    v_Prec: 0.747996  v_Recall: 0.656537  v_F1: 0.699289  v_AUC: 0.892707
steps 6200    running time 256 seconds

steps 6400    base_loss: 0.168826    reg_loss: 0.049644    l2_loss: 0.023321    loss: 0.241790
steps 6400    v_Prec: 0.772346  v_Recall: 0.640544  v_F1: 0.700297  v_AUC: 0.894393
steps 6400    running time 263 seconds

steps 6600    base_loss: 0.172748    reg_loss: 0.049182    l2_loss: 0.023774    loss: 0.245704
steps 6600    v_Prec: 0.753316  v_Recall: 0.658617  v_F1: 0.702790  v_AUC: 0.893065
steps 6600    running time 270 seconds

steps 6800    base_loss: 0.173872    reg_loss: 0.049165    l2_loss: 0.024313    loss: 0.247351
steps 6800    v_Prec: 0.762121  v_Recall: 0.656138  v_F1: 0.705170  v_AUC: 0.895705
steps 6800    running time 276 seconds

steps 7000    base_loss: 0.171561    reg_loss: 0.049019    l2_loss: 0.024694    loss: 0.245275
steps 7000    v_Prec: 0.751034  v_Recall: 0.668213  v_F1: 0.707207  v_AUC: 0.898198
steps 7000    running time 283 seconds

steps 7200    base_loss: 0.185719    reg_loss: 0.048869    l2_loss: 0.025054    loss: 0.259642
steps 7200    v_Prec: 0.752795  v_Recall: 0.673091  v_F1: 0.710715  v_AUC: 0.899339
steps 7200    running time 290 seconds

steps 7400    base_loss: 0.179136    reg_loss: 0.048562    l2_loss: 0.025406    loss: 0.253104
steps 7400    v_Prec: 0.776209  v_Recall: 0.659576  v_F1: 0.713156  v_AUC: 0.899955
steps 7400    running time 297 seconds

steps 7600    base_loss: 0.183465    reg_loss: 0.048479    l2_loss: 0.025580    loss: 0.257525
steps 7600    v_Prec: 0.766356  v_Recall: 0.670692  v_F1: 0.715340  v_AUC: 0.901112
steps 7600    running time 304 seconds

steps 7800    base_loss: 0.171297    reg_loss: 0.048257    l2_loss: 0.025904    loss: 0.245458
steps 7800    v_Prec: 0.763274  v_Recall: 0.679408  v_F1: 0.718903  v_AUC: 0.903351
steps 7800    running time 312 seconds

steps 8000    base_loss: 0.174803    reg_loss: 0.048037    l2_loss: 0.026132    loss: 0.248972
steps 8000    v_Prec: 0.776706  v_Recall: 0.663415  v_F1: 0.715604  v_AUC: 0.901761
steps 8000    running time 319 seconds

steps 8200    base_loss: 0.181820    reg_loss: 0.047978    l2_loss: 0.026453    loss: 0.256251
steps 8200    v_Prec: 0.787289  v_Recall: 0.659736  v_F1: 0.717891  v_AUC: 0.903397
steps 8200    running time 326 seconds

steps 8400    base_loss: 0.176325    reg_loss: 0.047661    l2_loss: 0.026765    loss: 0.250751
steps 8400    v_Prec: 0.770351  v_Recall: 0.676529  v_F1: 0.720399  v_AUC: 0.903836
steps 8400    running time 332 seconds

steps 8600    base_loss: 0.175191    reg_loss: 0.047505    l2_loss: 0.026870    loss: 0.249566
steps 8600    v_Prec: 0.780291  v_Recall: 0.673091  v_F1: 0.722737  v_AUC: 0.906236
steps 8600    running time 340 seconds

steps 8800    base_loss: 0.183126    reg_loss: 0.047364    l2_loss: 0.027042    loss: 0.257532
steps 8800    v_Prec: 0.760919  v_Recall: 0.691004  v_F1: 0.724278  v_AUC: 0.907521
steps 8800    running time 347 seconds

steps 9000    base_loss: 0.182513    reg_loss: 0.047388    l2_loss: 0.027145    loss: 0.257046
steps 9000    v_Prec: 0.776029  v_Recall: 0.678289  v_F1: 0.723875  v_AUC: 0.907768
steps 9000    running time 354 seconds

steps 9200    base_loss: 0.187468    reg_loss: 0.047118    l2_loss: 0.027172    loss: 0.261758
steps 9200    v_Prec: 0.781514  v_Recall: 0.680208  v_F1: 0.727350  v_AUC: 0.909342
steps 9200    running time 361 seconds

steps 9400    base_loss: 0.181439    reg_loss: 0.046902    l2_loss: 0.027391    loss: 0.255732
steps 9400    v_Prec: 0.784837  v_Recall: 0.684606  v_F1: 0.731303  v_AUC: 0.911695
steps 9400    running time 368 seconds

steps 9600    base_loss: 0.180411    reg_loss: 0.046594    l2_loss: 0.027559    loss: 0.254564
steps 9600    v_Prec: 0.779154  v_Recall: 0.689244  v_F1: 0.731447  v_AUC: 0.912847
steps 9600    running time 375 seconds

steps 9800    base_loss: 0.185247    reg_loss: 0.046717    l2_loss: 0.027515    loss: 0.259479
steps 9800    v_Prec: 0.784819  v_Recall: 0.691244  v_F1: 0.735065  v_AUC: 0.914285
steps 9800    running time 382 seconds

steps 10000    base_loss: 0.185431    reg_loss: 0.046474    l2_loss: 0.027680    loss: 0.259586
steps 10000    v_Prec: 0.786259  v_Recall: 0.692763  v_F1: 0.736556  v_AUC: 0.914248
steps 10000    running time 390 seconds

steps 10200    base_loss: 0.185244    reg_loss: 0.046092    l2_loss: 0.027717    loss: 0.259053
steps 10200    v_Prec: 0.766348  v_Recall: 0.711315  v_F1: 0.737807  v_AUC: 0.914466
steps 10200    running time 397 seconds

steps 10400    base_loss: 0.187980    reg_loss: 0.046226    l2_loss: 0.027680    loss: 0.261886
steps 10400    v_Prec: 0.787356  v_Recall: 0.701160  v_F1: 0.741762  v_AUC: 0.915497
steps 10400    running time 404 seconds

steps 10600    base_loss: 0.179594    reg_loss: 0.046221    l2_loss: 0.027892    loss: 0.253707
steps 10600    v_Prec: 0.772527  v_Recall: 0.715074  v_F1: 0.742691  v_AUC: 0.917137
steps 10600    running time 411 seconds

steps 10800    base_loss: 0.179967    reg_loss: 0.045629    l2_loss: 0.027935    loss: 0.253531
steps 10800    v_Prec: 0.783591  v_Recall: 0.712595  v_F1: 0.746409  v_AUC: 0.918072
steps 10800    running time 419 seconds

steps 11000    base_loss: 0.071662    reg_loss: 0.042311    l2_loss: 0.027769    loss: 0.141743
steps 11000    v_Prec: 0.792194  v_Recall: 0.696281  v_F1: 0.741147  v_AUC: 0.914745
steps 11000    running time 426 seconds

steps 11200    base_loss: 0.068178    reg_loss: 0.042405    l2_loss: 0.027717    loss: 0.138301
steps 11200    v_Prec: 0.793838  v_Recall: 0.688205  v_F1: 0.737257  v_AUC: 0.911629
steps 11200    running time 433 seconds

steps 11400    base_loss: 0.066407    reg_loss: 0.042160    l2_loss: 0.027536    loss: 0.136102
steps 11400    v_Prec: 0.800037  v_Recall: 0.683727  v_F1: 0.737323  v_AUC: 0.912411
steps 11400    running time 439 seconds

steps 11600    base_loss: 0.064487    reg_loss: 0.042421    l2_loss: 0.027579    loss: 0.134487
steps 11600    v_Prec: 0.780135  v_Recall: 0.690924  v_F1: 0.732824  v_AUC: 0.910630
steps 11600    running time 446 seconds

steps 11800    base_loss: 0.067375    reg_loss: 0.042326    l2_loss: 0.027430    loss: 0.137131
steps 11800    v_Prec: 0.799736  v_Recall: 0.677969  v_F1: 0.733835  v_AUC: 0.910716
steps 11800    running time 453 seconds

steps 12000    base_loss: 0.076430    reg_loss: 0.042666    l2_loss: 0.027451    loss: 0.146547
steps 12000    v_Prec: 0.755622  v_Recall: 0.706677  v_F1: 0.730331  v_AUC: 0.910903
steps 12000    running time 459 seconds

steps 12200    base_loss: 0.075729    reg_loss: 0.042654    l2_loss: 0.027435    loss: 0.145818
steps 12200    v_Prec: 0.811745  v_Recall: 0.666533  v_F1: 0.732007  v_AUC: 0.909426
steps 12200    running time 466 seconds

steps 12400    base_loss: 0.074564    reg_loss: 0.042558    l2_loss: 0.027525    loss: 0.144648
steps 12400    v_Prec: 0.776874  v_Recall: 0.695242  v_F1: 0.733795  v_AUC: 0.909212
steps 12400    running time 473 seconds

steps 12600    base_loss: 0.076779    reg_loss: 0.042502    l2_loss: 0.027605    loss: 0.146886
steps 12600    v_Prec: 0.790888  v_Recall: 0.680208  v_F1: 0.731384  v_AUC: 0.907263
steps 12600    running time 479 seconds

steps 12800    base_loss: 0.073364    reg_loss: 0.042414    l2_loss: 0.027553    loss: 0.143332
steps 12800    v_Prec: 0.788889  v_Recall: 0.692683  v_F1: 0.737662  v_AUC: 0.911389
steps 12800    running time 486 seconds

Early stop model F1: 0.746409
testing thre: 0.55450976
testing Prec: 0.5600838135149293
testing Recall: 0.7794896719319563
testing F1: 0.6518187360292624
testing AUC: 0.9079722406328825
overall running time 489 seconds
(0.7542250389148321, 0.6593924665856622, 0.703627829785027, 0.9079722406328825, 0.8477597)

2019-02-24 18:43:39.632827: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:43:40.454364: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:43:40.459864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:43:40.459921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.390000 seconds
loading data in 30.670000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.570381    reg_loss: 0.064678    l2_loss: 0.013355    loss: 0.648414
steps 200    v_Prec: 0.162854  v_Recall: 0.999679  v_F1: 0.280081  v_AUC: 0.515789
steps 200    running time 41 seconds

steps 400    base_loss: 0.529479    reg_loss: 0.064243    l2_loss: 0.013203    loss: 0.606925
steps 400    v_Prec: 0.162947  v_Recall: 0.997916  v_F1: 0.280150  v_AUC: 0.503131
steps 400    running time 48 seconds

steps 600    base_loss: 0.499619    reg_loss: 0.063890    l2_loss: 0.012833    loss: 0.576342
steps 600    v_Prec: 0.162787  v_Recall: 1.000000  v_F1: 0.279995  v_AUC: 0.484552
steps 600    running time 55 seconds

steps 800    base_loss: 0.462397    reg_loss: 0.063984    l2_loss: 0.012576    loss: 0.538958
steps 800    v_Prec: 0.196657  v_Recall: 0.498878  v_F1: 0.282108  v_AUC: 0.571528
steps 800    running time 62 seconds

steps 1000    base_loss: 0.445414    reg_loss: 0.064320    l2_loss: 0.012495    loss: 0.522229
steps 1000    v_Prec: 0.303268  v_Recall: 0.412071  v_F1: 0.349395  v_AUC: 0.655565
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.429964    reg_loss: 0.064794    l2_loss: 0.012424    loss: 0.507183
steps 1200    v_Prec: 0.402375  v_Recall: 0.440045  v_F1: 0.420368  v_AUC: 0.729148
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.414468    reg_loss: 0.065350    l2_loss: 0.012471    loss: 0.492289
steps 1400    v_Prec: 0.491295  v_Recall: 0.465935  v_F1: 0.478279  v_AUC: 0.771931
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.390023    reg_loss: 0.065534    l2_loss: 0.012526    loss: 0.468084
steps 1600    v_Prec: 0.519964  v_Recall: 0.511462  v_F1: 0.515678  v_AUC: 0.801284
steps 1600    running time 92 seconds

steps 1800    base_loss: 0.366681    reg_loss: 0.066105    l2_loss: 0.012673    loss: 0.445459
steps 1800    v_Prec: 0.544485  v_Recall: 0.544004  v_F1: 0.544244  v_AUC: 0.821331
steps 1800    running time 99 seconds

steps 2000    base_loss: 0.343745    reg_loss: 0.066416    l2_loss: 0.012857    loss: 0.423018
steps 2000    v_Prec: 0.593696  v_Recall: 0.554104  v_F1: 0.573217  v_AUC: 0.838737
steps 2000    running time 106 seconds

steps 2200    base_loss: 0.326911    reg_loss: 0.066810    l2_loss: 0.013190    loss: 0.406912
steps 2200    v_Prec: 0.674731  v_Recall: 0.538714  v_F1: 0.599100  v_AUC: 0.852816
steps 2200    running time 114 seconds

steps 2400    base_loss: 0.314618    reg_loss: 0.067028    l2_loss: 0.013512    loss: 0.395158
steps 2400    v_Prec: 0.677510  v_Recall: 0.559234  v_F1: 0.612716  v_AUC: 0.861758
steps 2400    running time 121 seconds

steps 2600    base_loss: 0.305326    reg_loss: 0.067239    l2_loss: 0.013875    loss: 0.386441
steps 2600    v_Prec: 0.672351  v_Recall: 0.581436  v_F1: 0.623598  v_AUC: 0.866999
steps 2600    running time 128 seconds

steps 2800    base_loss: 0.302562    reg_loss: 0.067361    l2_loss: 0.014261    loss: 0.384184
steps 2800    v_Prec: 0.681827  v_Recall: 0.593620  v_F1: 0.634673  v_AUC: 0.872366
steps 2800    running time 135 seconds

steps 3000    base_loss: 0.291999    reg_loss: 0.067550    l2_loss: 0.014642    loss: 0.374192
steps 3000    v_Prec: 0.685576  v_Recall: 0.599631  v_F1: 0.639730  v_AUC: 0.876963
steps 3000    running time 143 seconds

steps 3200    base_loss: 0.295393    reg_loss: 0.067703    l2_loss: 0.015058    loss: 0.378154
steps 3200    v_Prec: 0.724568  v_Recall: 0.591456  v_F1: 0.651280  v_AUC: 0.882197
steps 3200    running time 150 seconds

steps 3400    base_loss: 0.284028    reg_loss: 0.067696    l2_loss: 0.015430    loss: 0.367154
steps 3400    v_Prec: 0.671984  v_Recall: 0.631372  v_F1: 0.651046  v_AUC: 0.884938
steps 3400    running time 157 seconds

steps 3600    base_loss: 0.282822    reg_loss: 0.067789    l2_loss: 0.015857    loss: 0.366469
steps 3600    v_Prec: 0.688637  v_Recall: 0.628086  v_F1: 0.656969  v_AUC: 0.890992
steps 3600    running time 164 seconds

steps 3800    base_loss: 0.272803    reg_loss: 0.067813    l2_loss: 0.016334    loss: 0.356949
steps 3800    v_Prec: 0.699575  v_Recall: 0.633857  v_F1: 0.665097  v_AUC: 0.894279
steps 3800    running time 171 seconds

steps 4000    base_loss: 0.272727    reg_loss: 0.067856    l2_loss: 0.016785    loss: 0.357368
steps 4000    v_Prec: 0.670637  v_Recall: 0.658865  v_F1: 0.664699  v_AUC: 0.896261
steps 4000    running time 179 seconds

steps 4200    base_loss: 0.274963    reg_loss: 0.068129    l2_loss: 0.017223    loss: 0.360315
steps 4200    v_Prec: 0.697590  v_Recall: 0.644918  v_F1: 0.670221  v_AUC: 0.899035
steps 4200    running time 185 seconds

steps 4400    base_loss: 0.267733    reg_loss: 0.067698    l2_loss: 0.017726    loss: 0.353158
steps 4400    v_Prec: 0.719289  v_Recall: 0.635460  v_F1: 0.674781  v_AUC: 0.901677
steps 4400    running time 192 seconds

steps 4600    base_loss: 0.269087    reg_loss: 0.067923    l2_loss: 0.018282    loss: 0.355293
steps 4600    v_Prec: 0.711208  v_Recall: 0.642914  v_F1: 0.675339  v_AUC: 0.903203
steps 4600    running time 200 seconds

steps 4800    base_loss: 0.265500    reg_loss: 0.067869    l2_loss: 0.018815    loss: 0.352184
steps 4800    v_Prec: 0.695700  v_Recall: 0.665197  v_F1: 0.680107  v_AUC: 0.905785
steps 4800    running time 207 seconds

steps 5000    base_loss: 0.263726    reg_loss: 0.067630    l2_loss: 0.019390    loss: 0.350746
steps 5000    v_Prec: 0.691530  v_Recall: 0.663594  v_F1: 0.677274  v_AUC: 0.907074
steps 5000    running time 215 seconds

steps 5200    base_loss: 0.260842    reg_loss: 0.067777    l2_loss: 0.020036    loss: 0.348656
steps 5200    v_Prec: 0.709274  v_Recall: 0.659586  v_F1: 0.683529  v_AUC: 0.908887
steps 5200    running time 221 seconds

steps 5400    base_loss: 0.253481    reg_loss: 0.067576    l2_loss: 0.020714    loss: 0.341771
steps 5400    v_Prec: 0.693994  v_Recall: 0.672411  v_F1: 0.683032  v_AUC: 0.910051
steps 5400    running time 229 seconds

steps 5600    base_loss: 0.169523    reg_loss: 0.067403    l2_loss: 0.021574    loss: 0.258500
steps 5600    v_Prec: 0.696766  v_Recall: 0.664877  v_F1: 0.680448  v_AUC: 0.904683
steps 5600    running time 235 seconds

steps 5800    base_loss: 0.159764    reg_loss: 0.067156    l2_loss: 0.022473    loss: 0.249393
steps 5800    v_Prec: 0.716573  v_Recall: 0.634899  v_F1: 0.673268  v_AUC: 0.898353
steps 5800    running time 242 seconds

steps 6000    base_loss: 0.164985    reg_loss: 0.067378    l2_loss: 0.023211    loss: 0.255574
steps 6000    v_Prec: 0.709909  v_Recall: 0.640830  v_F1: 0.673604  v_AUC: 0.898135
steps 6000    running time 249 seconds

steps 6200    base_loss: 0.183792    reg_loss: 0.067690    l2_loss: 0.023944    loss: 0.275426
steps 6200    v_Prec: 0.711931  v_Recall: 0.640430  v_F1: 0.674290  v_AUC: 0.898273
steps 6200    running time 256 seconds

steps 6400    base_loss: 0.183816    reg_loss: 0.067503    l2_loss: 0.024568    loss: 0.275886
steps 6400    v_Prec: 0.703300  v_Recall: 0.650930  v_F1: 0.676102  v_AUC: 0.900239
steps 6400    running time 262 seconds

steps 6600    base_loss: 0.184512    reg_loss: 0.067379    l2_loss: 0.025216    loss: 0.277107
steps 6600    v_Prec: 0.704506  v_Recall: 0.651651  v_F1: 0.677049  v_AUC: 0.899545
steps 6600    running time 269 seconds

steps 6800    base_loss: 0.174530    reg_loss: 0.067294    l2_loss: 0.025688    loss: 0.267512
steps 6800    v_Prec: 0.728222  v_Recall: 0.637223  v_F1: 0.679691  v_AUC: 0.901537
steps 6800    running time 275 seconds

steps 7000    base_loss: 0.175469    reg_loss: 0.067080    l2_loss: 0.026154    loss: 0.268703
steps 7000    v_Prec: 0.726996  v_Recall: 0.650369  v_F1: 0.686551  v_AUC: 0.903902
steps 7000    running time 282 seconds

steps 7200    base_loss: 0.188102    reg_loss: 0.067137    l2_loss: 0.026610    loss: 0.281849
steps 7200    v_Prec: 0.738794  v_Recall: 0.642033  v_F1: 0.687023  v_AUC: 0.904619
steps 7200    running time 289 seconds

steps 7400    base_loss: 0.176790    reg_loss: 0.067149    l2_loss: 0.027084    loss: 0.271024
steps 7400    v_Prec: 0.728634  v_Recall: 0.666961  v_F1: 0.696435  v_AUC: 0.907315
steps 7400    running time 297 seconds

steps 7600    base_loss: 0.181619    reg_loss: 0.067024    l2_loss: 0.027524    loss: 0.276166
steps 7600    v_Prec: 0.729801  v_Recall: 0.662472  v_F1: 0.694509  v_AUC: 0.906746
steps 7600    running time 304 seconds

steps 7800    base_loss: 0.186603    reg_loss: 0.066978    l2_loss: 0.027842    loss: 0.281423
steps 7800    v_Prec: 0.739667  v_Recall: 0.658384  v_F1: 0.696663  v_AUC: 0.908158
steps 7800    running time 311 seconds

steps 8000    base_loss: 0.181769    reg_loss: 0.067109    l2_loss: 0.028229    loss: 0.277108
steps 8000    v_Prec: 0.742295  v_Recall: 0.656380  v_F1: 0.696699  v_AUC: 0.907565
steps 8000    running time 318 seconds

steps 8200    base_loss: 0.181803    reg_loss: 0.067285    l2_loss: 0.028479    loss: 0.277566
steps 8200    v_Prec: 0.763664  v_Recall: 0.649567  v_F1: 0.702010  v_AUC: 0.910212
steps 8200    running time 325 seconds

steps 8400    base_loss: 0.183914    reg_loss: 0.066904    l2_loss: 0.028846    loss: 0.279664
steps 8400    v_Prec: 0.755492  v_Recall: 0.661510  v_F1: 0.705385  v_AUC: 0.910145
steps 8400    running time 332 seconds

steps 8600    base_loss: 0.194682    reg_loss: 0.066808    l2_loss: 0.029157    loss: 0.290648
steps 8600    v_Prec: 0.753946  v_Recall: 0.670006  v_F1: 0.709502  v_AUC: 0.913779
steps 8600    running time 340 seconds

steps 8800    base_loss: 0.185330    reg_loss: 0.066996    l2_loss: 0.029491    loss: 0.281817
steps 8800    v_Prec: 0.764219  v_Recall: 0.666640  v_F1: 0.712102  v_AUC: 0.914036
steps 8800    running time 347 seconds

steps 9000    base_loss: 0.189757    reg_loss: 0.066739    l2_loss: 0.029778    loss: 0.286274
steps 9000    v_Prec: 0.767241  v_Recall: 0.670567  v_F1: 0.715654  v_AUC: 0.915882
steps 9000    running time 354 seconds

steps 9200    base_loss: 0.179827    reg_loss: 0.066765    l2_loss: 0.029988    loss: 0.276580
steps 9200    v_Prec: 0.753863  v_Recall: 0.676579  v_F1: 0.713133  v_AUC: 0.915598
steps 9200    running time 361 seconds

steps 9400    base_loss: 0.180955    reg_loss: 0.066456    l2_loss: 0.030189    loss: 0.277600
steps 9400    v_Prec: 0.756947  v_Recall: 0.681228  v_F1: 0.717094  v_AUC: 0.916562
steps 9400    running time 368 seconds

steps 9600    base_loss: 0.180596    reg_loss: 0.066531    l2_loss: 0.030453    loss: 0.277580
steps 9600    v_Prec: 0.764727  v_Recall: 0.678423  v_F1: 0.718994  v_AUC: 0.918368
steps 9600    running time 375 seconds

steps 9800    base_loss: 0.179651    reg_loss: 0.066532    l2_loss: 0.030596    loss: 0.276780
steps 9800    v_Prec: 0.752039  v_Recall: 0.687239  v_F1: 0.718181  v_AUC: 0.917880
steps 9800    running time 382 seconds

steps 10000    base_loss: 0.177710    reg_loss: 0.066404    l2_loss: 0.030906    loss: 0.275021
steps 10000    v_Prec: 0.762967  v_Recall: 0.682671  v_F1: 0.720589  v_AUC: 0.919909
steps 10000    running time 389 seconds

steps 10200    base_loss: 0.171803    reg_loss: 0.066505    l2_loss: 0.031179    loss: 0.269488
steps 10200    v_Prec: 0.772266  v_Recall: 0.682510  v_F1: 0.724619  v_AUC: 0.921605
steps 10200    running time 396 seconds

steps 10400    base_loss: 0.177616    reg_loss: 0.066462    l2_loss: 0.031414    loss: 0.275493
steps 10400    v_Prec: 0.778302  v_Recall: 0.687720  v_F1: 0.730213  v_AUC: 0.922141
steps 10400    running time 403 seconds

steps 10600    base_loss: 0.182345    reg_loss: 0.066103    l2_loss: 0.031511    loss: 0.279959
steps 10600    v_Prec: 0.776164  v_Recall: 0.681228  v_F1: 0.725604  v_AUC: 0.922590
steps 10600    running time 410 seconds

steps 10800    base_loss: 0.174943    reg_loss: 0.066386    l2_loss: 0.031724    loss: 0.273053
steps 10800    v_Prec: 0.769900  v_Recall: 0.695415  v_F1: 0.730764  v_AUC: 0.925248
steps 10800    running time 417 seconds

steps 11000    base_loss: 0.073864    reg_loss: 0.065321    l2_loss: 0.031916    loss: 0.171101
steps 11000    v_Prec: 0.772461  v_Recall: 0.675377  v_F1: 0.720664  v_AUC: 0.920158
steps 11000    running time 424 seconds

steps 11200    base_loss: 0.067386    reg_loss: 0.064862    l2_loss: 0.031928    loss: 0.164176
steps 11200    v_Prec: 0.737310  v_Recall: 0.698541  v_F1: 0.717402  v_AUC: 0.915979
steps 11200    running time 431 seconds

steps 11400    base_loss: 0.069753    reg_loss: 0.064641    l2_loss: 0.031901    loss: 0.166294
steps 11400    v_Prec: 0.729071  v_Recall: 0.697339  v_F1: 0.712852  v_AUC: 0.912482
steps 11400    running time 437 seconds

steps 11600    base_loss: 0.074432    reg_loss: 0.064833    l2_loss: 0.031997    loss: 0.171263
steps 11600    v_Prec: 0.752511  v_Recall: 0.672651  v_F1: 0.710344  v_AUC: 0.910622
steps 11600    running time 444 seconds

steps 11800    base_loss: 0.083978    reg_loss: 0.064899    l2_loss: 0.032178    loss: 0.181055
steps 11800    v_Prec: 0.744893  v_Recall: 0.669365  v_F1: 0.705113  v_AUC: 0.906477
steps 11800    running time 450 seconds

steps 12000    base_loss: 0.076416    reg_loss: 0.064571    l2_loss: 0.032259    loss: 0.173246
steps 12000    v_Prec: 0.747263  v_Recall: 0.667361  v_F1: 0.705055  v_AUC: 0.908612
steps 12000    running time 457 seconds

steps 12200    base_loss: 0.082361    reg_loss: 0.064690    l2_loss: 0.032414    loss: 0.179465
steps 12200    v_Prec: 0.748745  v_Recall: 0.669525  v_F1: 0.706923  v_AUC: 0.909034
steps 12200    running time 464 seconds

steps 12400    base_loss: 0.087565    reg_loss: 0.064857    l2_loss: 0.032471    loss: 0.184892
steps 12400    v_Prec: 0.762220  v_Recall: 0.663674  v_F1: 0.709542  v_AUC: 0.908683
steps 12400    running time 470 seconds

steps 12600    base_loss: 0.085256    reg_loss: 0.064445    l2_loss: 0.032485    loss: 0.182186
steps 12600    v_Prec: 0.764232  v_Recall: 0.661751  v_F1: 0.709309  v_AUC: 0.908440
steps 12600    running time 477 seconds

steps 12800    base_loss: 0.082631    reg_loss: 0.064669    l2_loss: 0.032671    loss: 0.179970
steps 12800    v_Prec: 0.754591  v_Recall: 0.661991  v_F1: 0.705265  v_AUC: 0.907164
steps 12800    running time 483 seconds

Early stop model F1: 0.730764
testing thre: 0.3633055
testing Prec: 0.5503194051733166
testing Recall: 0.766221142162819
testing F1: 0.6405672260371379
testing AUC: 0.9063145309924793
overall running time 486 seconds
(0.7286528585134602, 0.627509113001215, 0.6743092912727843, 0.9063145309924793, 0.71860975)

2019-02-24 18:49:13.922769: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:49:14.610467: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:49:14.612839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:49:14.612884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.740000 seconds
loading data in 30.980000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.683460    reg_loss: 0.064805    l2_loss: 0.013361    loss: 0.761627
steps 200    v_Prec: 0.164918  v_Recall: 0.999842  v_F1: 0.283134  v_AUC: 0.487731
steps 200    running time 42 seconds

steps 400    base_loss: 0.530724    reg_loss: 0.064818    l2_loss: 0.013456    loss: 0.608998
steps 400    v_Prec: 0.164885  v_Recall: 1.000000  v_F1: 0.283093  v_AUC: 0.496065
steps 400    running time 49 seconds

steps 600    base_loss: 0.494891    reg_loss: 0.064835    l2_loss: 0.013362    loss: 0.573089
steps 600    v_Prec: 0.166814  v_Recall: 0.955207  v_F1: 0.284027  v_AUC: 0.513788
steps 600    running time 56 seconds

steps 800    base_loss: 0.475655    reg_loss: 0.064606    l2_loss: 0.013215    loss: 0.553476
steps 800    v_Prec: 0.169358  v_Recall: 0.930516  v_F1: 0.286560  v_AUC: 0.537809
steps 800    running time 63 seconds

steps 1000    base_loss: 0.465130    reg_loss: 0.064414    l2_loss: 0.012977    loss: 0.542521
steps 1000    v_Prec: 0.188279  v_Recall: 0.696106  v_F1: 0.296391  v_AUC: 0.578163
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.449569    reg_loss: 0.064122    l2_loss: 0.012804    loss: 0.526495
steps 1200    v_Prec: 0.250964  v_Recall: 0.504748  v_F1: 0.335243  v_AUC: 0.647516
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.435654    reg_loss: 0.063852    l2_loss: 0.012714    loss: 0.512220
steps 1400    v_Prec: 0.456434  v_Recall: 0.413739  v_F1: 0.434039  v_AUC: 0.734034
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.415762    reg_loss: 0.063813    l2_loss: 0.012678    loss: 0.492253
steps 1600    v_Prec: 0.488176  v_Recall: 0.477050  v_F1: 0.482549  v_AUC: 0.773966
steps 1600    running time 92 seconds

steps 1800    base_loss: 0.380928    reg_loss: 0.063681    l2_loss: 0.012726    loss: 0.457335
steps 1800    v_Prec: 0.528360  v_Recall: 0.516777  v_F1: 0.522505  v_AUC: 0.803793
steps 1800    running time 99 seconds

steps 2000    base_loss: 0.356529    reg_loss: 0.064185    l2_loss: 0.012891    loss: 0.433605
steps 2000    v_Prec: 0.537709  v_Recall: 0.556901  v_F1: 0.547137  v_AUC: 0.821278
steps 2000    running time 107 seconds

steps 2200    base_loss: 0.345005    reg_loss: 0.064623    l2_loss: 0.013073    loss: 0.422701
steps 2200    v_Prec: 0.588845  v_Recall: 0.548908  v_F1: 0.568175  v_AUC: 0.833848
steps 2200    running time 114 seconds

steps 2400    base_loss: 0.334684    reg_loss: 0.065226    l2_loss: 0.013342    loss: 0.413252
steps 2400    v_Prec: 0.594608  v_Recall: 0.579456  v_F1: 0.586934  v_AUC: 0.846378
steps 2400    running time 121 seconds

steps 2600    base_loss: 0.318459    reg_loss: 0.065799    l2_loss: 0.013640    loss: 0.397898
steps 2600    v_Prec: 0.611423  v_Recall: 0.576923  v_F1: 0.593672  v_AUC: 0.854018
steps 2600    running time 129 seconds

steps 2800    base_loss: 0.319503    reg_loss: 0.066333    l2_loss: 0.014038    loss: 0.399874
steps 2800    v_Prec: 0.637767  v_Recall: 0.588557  v_F1: 0.612174  v_AUC: 0.861218
steps 2800    running time 136 seconds

steps 3000    base_loss: 0.305121    reg_loss: 0.066443    l2_loss: 0.014423    loss: 0.385987
steps 3000    v_Prec: 0.620173  v_Recall: 0.618946  v_F1: 0.619559  v_AUC: 0.867468
steps 3000    running time 143 seconds

steps 3200    base_loss: 0.300248    reg_loss: 0.066821    l2_loss: 0.014797    loss: 0.381866
steps 3200    v_Prec: 0.645056  v_Recall: 0.610241  v_F1: 0.627166  v_AUC: 0.871448
steps 3200    running time 151 seconds

steps 3400    base_loss: 0.296184    reg_loss: 0.067065    l2_loss: 0.015171    loss: 0.378420
steps 3400    v_Prec: 0.654376  v_Recall: 0.612377  v_F1: 0.632681  v_AUC: 0.875741
steps 3400    running time 158 seconds

steps 3600    base_loss: 0.302138    reg_loss: 0.067412    l2_loss: 0.015628    loss: 0.385178
steps 3600    v_Prec: 0.640772  v_Recall: 0.630579  v_F1: 0.635635  v_AUC: 0.877813
steps 3600    running time 165 seconds

steps 3800    base_loss: 0.292630    reg_loss: 0.067571    l2_loss: 0.016048    loss: 0.376249
steps 3800    v_Prec: 0.629960  v_Recall: 0.653292  v_F1: 0.641414  v_AUC: 0.881550
steps 3800    running time 173 seconds

steps 4000    base_loss: 0.278762    reg_loss: 0.067459    l2_loss: 0.016533    loss: 0.362755
steps 4000    v_Prec: 0.657365  v_Recall: 0.635723  v_F1: 0.646363  v_AUC: 0.884726
steps 4000    running time 180 seconds

steps 4200    base_loss: 0.280515    reg_loss: 0.067598    l2_loss: 0.017022    loss: 0.365134
steps 4200    v_Prec: 0.657945  v_Recall: 0.648781  v_F1: 0.653331  v_AUC: 0.887031
steps 4200    running time 188 seconds

steps 4400    base_loss: 0.280645    reg_loss: 0.067619    l2_loss: 0.017605    loss: 0.365869
steps 4400    v_Prec: 0.684098  v_Recall: 0.635644  v_F1: 0.658982  v_AUC: 0.889090
steps 4400    running time 195 seconds

steps 4600    base_loss: 0.282331    reg_loss: 0.067805    l2_loss: 0.018220    loss: 0.368356
steps 4600    v_Prec: 0.678532  v_Recall: 0.639601  v_F1: 0.658492  v_AUC: 0.890614
steps 4600    running time 202 seconds

steps 4800    base_loss: 0.279752    reg_loss: 0.067815    l2_loss: 0.018793    loss: 0.366360
steps 4800    v_Prec: 0.675155  v_Recall: 0.654638  v_F1: 0.664738  v_AUC: 0.893662
steps 4800    running time 209 seconds

steps 5000    base_loss: 0.268799    reg_loss: 0.067581    l2_loss: 0.019506    loss: 0.355886
steps 5000    v_Prec: 0.695708  v_Recall: 0.640155  v_F1: 0.666777  v_AUC: 0.895947
steps 5000    running time 216 seconds

steps 5200    base_loss: 0.274597    reg_loss: 0.067724    l2_loss: 0.020053    loss: 0.362374
steps 5200    v_Prec: 0.682204  v_Recall: 0.654400  v_F1: 0.668013  v_AUC: 0.897013
steps 5200    running time 223 seconds

steps 5400    base_loss: 0.263713    reg_loss: 0.067397    l2_loss: 0.020682    loss: 0.351792
steps 5400    v_Prec: 0.682643  v_Recall: 0.658278  v_F1: 0.670239  v_AUC: 0.898431
steps 5400    running time 230 seconds

steps 5600    base_loss: 0.171124    reg_loss: 0.068608    l2_loss: 0.021673    loss: 0.261405
steps 5600    v_Prec: 0.693980  v_Recall: 0.634061  v_F1: 0.662669  v_AUC: 0.893911
steps 5600    running time 238 seconds

steps 5800    base_loss: 0.186767    reg_loss: 0.068582    l2_loss: 0.022439    loss: 0.277788
steps 5800    v_Prec: 0.696135  v_Recall: 0.630025  v_F1: 0.661432  v_AUC: 0.891947
steps 5800    running time 244 seconds

steps 6000    base_loss: 0.185497    reg_loss: 0.068731    l2_loss: 0.023304    loss: 0.277533
steps 6000    v_Prec: 0.676943  v_Recall: 0.646407  v_F1: 0.661323  v_AUC: 0.891028
steps 6000    running time 251 seconds

steps 6200    base_loss: 0.196547    reg_loss: 0.068482    l2_loss: 0.023863    loss: 0.288892
steps 6200    v_Prec: 0.683055  v_Recall: 0.639918  v_F1: 0.660783  v_AUC: 0.891445
steps 6200    running time 258 seconds

steps 6400    base_loss: 0.173553    reg_loss: 0.068353    l2_loss: 0.024552    loss: 0.266458
steps 6400    v_Prec: 0.690872  v_Recall: 0.635486  v_F1: 0.662022  v_AUC: 0.892890
steps 6400    running time 265 seconds

steps 6600    base_loss: 0.192313    reg_loss: 0.068436    l2_loss: 0.025008    loss: 0.285757
steps 6600    v_Prec: 0.671402  v_Recall: 0.654558  v_F1: 0.662873  v_AUC: 0.892833
steps 6600    running time 271 seconds

steps 6800    base_loss: 0.194969    reg_loss: 0.068402    l2_loss: 0.025517    loss: 0.288888
steps 6800    v_Prec: 0.701926  v_Recall: 0.643321  v_F1: 0.671347  v_AUC: 0.895910
steps 6800    running time 278 seconds

steps 7000    base_loss: 0.202530    reg_loss: 0.068393    l2_loss: 0.025971    loss: 0.296894
steps 7000    v_Prec: 0.679747  v_Recall: 0.662156  v_F1: 0.670836  v_AUC: 0.895566
steps 7000    running time 285 seconds

steps 7200    base_loss: 0.198276    reg_loss: 0.068304    l2_loss: 0.026467    loss: 0.293047
steps 7200    v_Prec: 0.692192  v_Recall: 0.653846  v_F1: 0.672473  v_AUC: 0.896792
steps 7200    running time 292 seconds

steps 7400    base_loss: 0.183474    reg_loss: 0.068275    l2_loss: 0.026808    loss: 0.278557
steps 7400    v_Prec: 0.692087  v_Recall: 0.667933  v_F1: 0.679795  v_AUC: 0.900409
steps 7400    running time 299 seconds

steps 7600    base_loss: 0.192328    reg_loss: 0.068489    l2_loss: 0.027211    loss: 0.288028
steps 7600    v_Prec: 0.701352  v_Recall: 0.660890  v_F1: 0.680520  v_AUC: 0.900078
steps 7600    running time 306 seconds

steps 7800    base_loss: 0.190126    reg_loss: 0.068366    l2_loss: 0.027595    loss: 0.286087
steps 7800    v_Prec: 0.710689  v_Recall: 0.656695  v_F1: 0.682626  v_AUC: 0.901970
steps 7800    running time 313 seconds

steps 8000    base_loss: 0.197091    reg_loss: 0.068298    l2_loss: 0.027996    loss: 0.293384
steps 8000    v_Prec: 0.726765  v_Recall: 0.648544  v_F1: 0.685430  v_AUC: 0.904017
steps 8000    running time 321 seconds

steps 8200    base_loss: 0.187221    reg_loss: 0.068162    l2_loss: 0.028291    loss: 0.283674
steps 8200    v_Prec: 0.723386  v_Recall: 0.653371  v_F1: 0.686598  v_AUC: 0.904241
steps 8200    running time 328 seconds

steps 8400    base_loss: 0.196037    reg_loss: 0.068234    l2_loss: 0.028548    loss: 0.292819
steps 8400    v_Prec: 0.731370  v_Recall: 0.652422  v_F1: 0.689644  v_AUC: 0.905333
steps 8400    running time 335 seconds

steps 8600    base_loss: 0.193620    reg_loss: 0.068221    l2_loss: 0.028843    loss: 0.290684
steps 8600    v_Prec: 0.726882  v_Recall: 0.669357  v_F1: 0.696935  v_AUC: 0.908241
steps 8600    running time 343 seconds

steps 8800    base_loss: 0.195967    reg_loss: 0.068319    l2_loss: 0.029133    loss: 0.293418
steps 8800    v_Prec: 0.710780  v_Recall: 0.683048  v_F1: 0.696638  v_AUC: 0.909234
steps 8800    running time 350 seconds

steps 9000    base_loss: 0.183968    reg_loss: 0.068124    l2_loss: 0.029398    loss: 0.281490
steps 9000    v_Prec: 0.727211  v_Recall: 0.675530  v_F1: 0.700418  v_AUC: 0.910760
steps 9000    running time 356 seconds

steps 9200    base_loss: 0.187780    reg_loss: 0.068154    l2_loss: 0.029721    loss: 0.285655
steps 9200    v_Prec: 0.731533  v_Recall: 0.681861  v_F1: 0.705825  v_AUC: 0.912225
steps 9200    running time 363 seconds

steps 9400    base_loss: 0.192318    reg_loss: 0.067892    l2_loss: 0.029960    loss: 0.290170
steps 9400    v_Prec: 0.747282  v_Recall: 0.669041  v_F1: 0.706000  v_AUC: 0.911786
steps 9400    running time 370 seconds

steps 9600    base_loss: 0.192557    reg_loss: 0.067991    l2_loss: 0.030233    loss: 0.290782
steps 9600    v_Prec: 0.734086  v_Recall: 0.684473  v_F1: 0.708412  v_AUC: 0.913705
steps 9600    running time 377 seconds

steps 9800    base_loss: 0.186211    reg_loss: 0.068076    l2_loss: 0.030434    loss: 0.284721
steps 9800    v_Prec: 0.770334  v_Recall: 0.658832  v_F1: 0.710233  v_AUC: 0.914975
steps 9800    running time 384 seconds

steps 10000    base_loss: 0.192695    reg_loss: 0.067866    l2_loss: 0.030692    loss: 0.291254
steps 10000    v_Prec: 0.769301  v_Recall: 0.663185  v_F1: 0.712312  v_AUC: 0.917620
steps 10000    running time 392 seconds

steps 10200    base_loss: 0.184938    reg_loss: 0.067964    l2_loss: 0.030928    loss: 0.283830
steps 10200    v_Prec: 0.749870  v_Recall: 0.687322  v_F1: 0.717235  v_AUC: 0.917906
steps 10200    running time 399 seconds

steps 10400    base_loss: 0.183979    reg_loss: 0.067962    l2_loss: 0.031142    loss: 0.283082
steps 10400    v_Prec: 0.752135  v_Recall: 0.682969  v_F1: 0.715886  v_AUC: 0.917939
steps 10400    running time 406 seconds

steps 10600    base_loss: 0.188561    reg_loss: 0.067804    l2_loss: 0.031396    loss: 0.287761
steps 10600    v_Prec: 0.771887  v_Recall: 0.677509  v_F1: 0.721625  v_AUC: 0.920089
steps 10600    running time 412 seconds

steps 10800    base_loss: 0.176213    reg_loss: 0.067766    l2_loss: 0.031485    loss: 0.275465
steps 10800    v_Prec: 0.768618  v_Recall: 0.687718  v_F1: 0.725921  v_AUC: 0.920299
steps 10800    running time 419 seconds

steps 11000    base_loss: 0.078244    reg_loss: 0.067380    l2_loss: 0.031826    loss: 0.177450
steps 11000    v_Prec: 0.731709  v_Recall: 0.691754  v_F1: 0.711171  v_AUC: 0.912884
steps 11000    running time 426 seconds

steps 11200    base_loss: 0.073666    reg_loss: 0.067398    l2_loss: 0.031888    loss: 0.172952
steps 11200    v_Prec: 0.720413  v_Recall: 0.689854  v_F1: 0.704803  v_AUC: 0.908389
steps 11200    running time 433 seconds

steps 11400    base_loss: 0.075584    reg_loss: 0.067065    l2_loss: 0.031944    loss: 0.174593
steps 11400    v_Prec: 0.738503  v_Recall: 0.655745  v_F1: 0.694668  v_AUC: 0.903934
steps 11400    running time 439 seconds

steps 11600    base_loss: 0.074486    reg_loss: 0.067135    l2_loss: 0.032046    loss: 0.173666
steps 11600    v_Prec: 0.721562  v_Recall: 0.662631  v_F1: 0.690842  v_AUC: 0.901045
steps 11600    running time 446 seconds

steps 11800    base_loss: 0.075753    reg_loss: 0.067030    l2_loss: 0.032146    loss: 0.174930
steps 11800    v_Prec: 0.716548  v_Recall: 0.658990  v_F1: 0.686565  v_AUC: 0.901690
steps 11800    running time 452 seconds

steps 12000    base_loss: 0.078707    reg_loss: 0.067093    l2_loss: 0.032319    loss: 0.178119
steps 12000    v_Prec: 0.723590  v_Recall: 0.655904  v_F1: 0.688086  v_AUC: 0.900463
steps 12000    running time 459 seconds

steps 12200    base_loss: 0.085088    reg_loss: 0.066896    l2_loss: 0.032328    loss: 0.184312
steps 12200    v_Prec: 0.718997  v_Recall: 0.653846  v_F1: 0.684876  v_AUC: 0.901554
steps 12200    running time 466 seconds

steps 12400    base_loss: 0.084948    reg_loss: 0.066910    l2_loss: 0.032479    loss: 0.184337
steps 12400    v_Prec: 0.697860  v_Recall: 0.671019  v_F1: 0.684177  v_AUC: 0.900244
steps 12400    running time 472 seconds

steps 12600    base_loss: 0.080299    reg_loss: 0.066833    l2_loss: 0.032626    loss: 0.179758
steps 12600    v_Prec: 0.676768  v_Recall: 0.683998  v_F1: 0.680364  v_AUC: 0.898521
steps 12600    running time 479 seconds

steps 12800    base_loss: 0.087440    reg_loss: 0.066613    l2_loss: 0.032676    loss: 0.186729
steps 12800    v_Prec: 0.692910  v_Recall: 0.672840  v_F1: 0.682727  v_AUC: 0.898971
steps 12800    running time 485 seconds

Early stop model F1: 0.725921
testing thre: 0.3925825
testing Prec: 0.5515083959584337
testing Recall: 0.7454678007290401
testing F1: 0.6339850369941719
testing AUC: 0.8996281431032183
overall running time 488 seconds
(0.7196631144723272, 0.610498177399757, 0.6606011201977438, 0.8996281431032183, 0.72022724)

2019-02-24 18:54:49.915225: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 18:54:51.351584: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 18:54:51.354171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 18:54:51.354223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.220000 seconds
loading data in 29.240000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.817386    reg_loss: 0.064937    l2_loss: 0.013341    loss: 0.895665
steps 200    v_Prec: 0.164727  v_Recall: 1.000000  v_F1: 0.282859  v_AUC: 0.485894
steps 200    running time 40 seconds

steps 400    base_loss: 0.613620    reg_loss: 0.065472    l2_loss: 0.013422    loss: 0.692513
steps 400    v_Prec: 0.164727  v_Recall: 1.000000  v_F1: 0.282859  v_AUC: 0.505160
steps 400    running time 47 seconds

steps 600    base_loss: 0.506201    reg_loss: 0.065446    l2_loss: 0.013388    loss: 0.585034
steps 600    v_Prec: 0.164729  v_Recall: 1.000000  v_F1: 0.282862  v_AUC: 0.528313
steps 600    running time 54 seconds

steps 800    base_loss: 0.485780    reg_loss: 0.065201    l2_loss: 0.013205    loss: 0.564186
steps 800    v_Prec: 0.164729  v_Recall: 1.000000  v_F1: 0.282862  v_AUC: 0.553854
steps 800    running time 61 seconds

steps 1000    base_loss: 0.461323    reg_loss: 0.065182    l2_loss: 0.012991    loss: 0.539496
steps 1000    v_Prec: 0.222168  v_Recall: 0.502337  v_F1: 0.308081  v_AUC: 0.606699
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.441179    reg_loss: 0.065247    l2_loss: 0.012912    loss: 0.519338
steps 1200    v_Prec: 0.331270  v_Recall: 0.394139  v_F1: 0.359980  v_AUC: 0.654733
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.421015    reg_loss: 0.065223    l2_loss: 0.012841    loss: 0.499079
steps 1400    v_Prec: 0.385016  v_Recall: 0.433505  v_F1: 0.407824  v_AUC: 0.709527
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.411678    reg_loss: 0.065803    l2_loss: 0.012917    loss: 0.490397
steps 1600    v_Prec: 0.477474  v_Recall: 0.434851  v_F1: 0.455167  v_AUC: 0.749949
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.388519    reg_loss: 0.066141    l2_loss: 0.012960    loss: 0.467621
steps 1800    v_Prec: 0.517133  v_Recall: 0.481743  v_F1: 0.498811  v_AUC: 0.783621
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.372900    reg_loss: 0.066822    l2_loss: 0.013095    loss: 0.452817
steps 2000    v_Prec: 0.609613  v_Recall: 0.478178  v_F1: 0.535955  v_AUC: 0.807041
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.351277    reg_loss: 0.067019    l2_loss: 0.013292    loss: 0.431588
steps 2200    v_Prec: 0.655506  v_Recall: 0.493149  v_F1: 0.562853  v_AUC: 0.825741
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.331991    reg_loss: 0.067406    l2_loss: 0.013588    loss: 0.412985
steps 2400    v_Prec: 0.679863  v_Recall: 0.519604  v_F1: 0.589028  v_AUC: 0.839268
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.318991    reg_loss: 0.067663    l2_loss: 0.013899    loss: 0.400552
steps 2600    v_Prec: 0.689108  v_Recall: 0.536713  v_F1: 0.603438  v_AUC: 0.849369
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.307527    reg_loss: 0.067793    l2_loss: 0.014270    loss: 0.389590
steps 2800    v_Prec: 0.681288  v_Recall: 0.554851  v_F1: 0.611603  v_AUC: 0.856582
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.298694    reg_loss: 0.067978    l2_loss: 0.014655    loss: 0.381327
steps 3000    v_Prec: 0.732403  v_Recall: 0.548911  v_F1: 0.627518  v_AUC: 0.863986
steps 3000    running time 140 seconds

steps 3200    base_loss: 0.295689    reg_loss: 0.068054    l2_loss: 0.015078    loss: 0.378822
steps 3200    v_Prec: 0.716633  v_Recall: 0.566495  v_F1: 0.632780  v_AUC: 0.869294
steps 3200    running time 147 seconds

steps 3400    base_loss: 0.292328    reg_loss: 0.068260    l2_loss: 0.015486    loss: 0.376074
steps 3400    v_Prec: 0.702836  v_Recall: 0.588990  v_F1: 0.640896  v_AUC: 0.872628
steps 3400    running time 154 seconds

steps 3600    base_loss: 0.281412    reg_loss: 0.068326    l2_loss: 0.015877    loss: 0.365615
steps 3600    v_Prec: 0.706618  v_Recall: 0.595406  v_F1: 0.646262  v_AUC: 0.876603
steps 3600    running time 161 seconds

steps 3800    base_loss: 0.288671    reg_loss: 0.068542    l2_loss: 0.016335    loss: 0.373548
steps 3800    v_Prec: 0.738897  v_Recall: 0.589069  v_F1: 0.655531  v_AUC: 0.880836
steps 3800    running time 168 seconds

steps 4000    base_loss: 0.275147    reg_loss: 0.068319    l2_loss: 0.016735    loss: 0.360201
steps 4000    v_Prec: 0.717678  v_Recall: 0.612911  v_F1: 0.661170  v_AUC: 0.884245
steps 4000    running time 176 seconds

steps 4200    base_loss: 0.272061    reg_loss: 0.068310    l2_loss: 0.017149    loss: 0.357520
steps 4200    v_Prec: 0.756821  v_Recall: 0.601980  v_F1: 0.670578  v_AUC: 0.883688
steps 4200    running time 183 seconds

steps 4400    base_loss: 0.270312    reg_loss: 0.068336    l2_loss: 0.017641    loss: 0.356290
steps 4400    v_Prec: 0.765893  v_Recall: 0.601188  v_F1: 0.673619  v_AUC: 0.888963
steps 4400    running time 190 seconds

steps 4600    base_loss: 0.268622    reg_loss: 0.068332    l2_loss: 0.018097    loss: 0.355051
steps 4600    v_Prec: 0.760489  v_Recall: 0.615921  v_F1: 0.680613  v_AUC: 0.890735
steps 4600    running time 197 seconds

steps 4800    base_loss: 0.259470    reg_loss: 0.068084    l2_loss: 0.018564    loss: 0.346117
steps 4800    v_Prec: 0.770397  v_Recall: 0.611802  v_F1: 0.682001  v_AUC: 0.891637
steps 4800    running time 204 seconds

steps 5000    base_loss: 0.259561    reg_loss: 0.068190    l2_loss: 0.019163    loss: 0.346913
steps 5000    v_Prec: 0.731571  v_Recall: 0.644594  v_F1: 0.685334  v_AUC: 0.894749
steps 5000    running time 211 seconds

steps 5200    base_loss: 0.259561    reg_loss: 0.068186    l2_loss: 0.019691    loss: 0.347438
steps 5200    v_Prec: 0.772278  v_Recall: 0.625347  v_F1: 0.691089  v_AUC: 0.897427
steps 5200    running time 218 seconds

steps 5400    base_loss: 0.256035    reg_loss: 0.067705    l2_loss: 0.020287    loss: 0.344027
steps 5400    v_Prec: 0.760282  v_Recall: 0.639842  v_F1: 0.694882  v_AUC: 0.898115
steps 5400    running time 225 seconds

steps 5600    base_loss: 0.171669    reg_loss: 0.066422    l2_loss: 0.020847    loss: 0.258937
steps 5600    v_Prec: 0.761478  v_Recall: 0.631921  v_F1: 0.690676  v_AUC: 0.894319
steps 5600    running time 233 seconds

steps 5800    base_loss: 0.169499    reg_loss: 0.066197    l2_loss: 0.021590    loss: 0.257287
steps 5800    v_Prec: 0.784609  v_Recall: 0.614574  v_F1: 0.689260  v_AUC: 0.892231
steps 5800    running time 239 seconds

steps 6000    base_loss: 0.173164    reg_loss: 0.066136    l2_loss: 0.022232    loss: 0.261532
steps 6000    v_Prec: 0.773404  v_Recall: 0.625584  v_F1: 0.691685  v_AUC: 0.889963
steps 6000    running time 246 seconds

steps 6200    base_loss: 0.170706    reg_loss: 0.066077    l2_loss: 0.022917    loss: 0.259700
steps 6200    v_Prec: 0.785528  v_Recall: 0.619960  v_F1: 0.692992  v_AUC: 0.890490
steps 6200    running time 252 seconds

steps 6400    base_loss: 0.181415    reg_loss: 0.066381    l2_loss: 0.023574    loss: 0.271370
steps 6400    v_Prec: 0.779978  v_Recall: 0.627010  v_F1: 0.695179  v_AUC: 0.892269
steps 6400    running time 259 seconds

steps 6600    base_loss: 0.179481    reg_loss: 0.066120    l2_loss: 0.023974    loss: 0.269575
steps 6600    v_Prec: 0.810453  v_Recall: 0.615366  v_F1: 0.699563  v_AUC: 0.892778
steps 6600    running time 266 seconds

steps 6800    base_loss: 0.167333    reg_loss: 0.066223    l2_loss: 0.024415    loss: 0.257971
steps 6800    v_Prec: 0.800919  v_Recall: 0.621386  v_F1: 0.699822  v_AUC: 0.892099
steps 6800    running time 274 seconds

steps 7000    base_loss: 0.170331    reg_loss: 0.066186    l2_loss: 0.024838    loss: 0.261356
steps 7000    v_Prec: 0.806120  v_Recall: 0.621782  v_F1: 0.702052  v_AUC: 0.891990
steps 7000    running time 281 seconds

steps 7200    base_loss: 0.174004    reg_loss: 0.066030    l2_loss: 0.025176    loss: 0.265209
steps 7200    v_Prec: 0.799717  v_Recall: 0.626535  v_F1: 0.702611  v_AUC: 0.892362
steps 7200    running time 288 seconds

steps 7400    base_loss: 0.179755    reg_loss: 0.066433    l2_loss: 0.025476    loss: 0.271664
steps 7400    v_Prec: 0.794801  v_Recall: 0.639366  v_F1: 0.708661  v_AUC: 0.895237
steps 7400    running time 296 seconds

steps 7600    base_loss: 0.182102    reg_loss: 0.066065    l2_loss: 0.025700    loss: 0.273867
steps 7600    v_Prec: 0.823778  v_Recall: 0.632792  v_F1: 0.715764  v_AUC: 0.896560
steps 7600    running time 303 seconds

steps 7800    base_loss: 0.179282    reg_loss: 0.065873    l2_loss: 0.025926    loss: 0.271081
steps 7800    v_Prec: 0.810763  v_Recall: 0.646812  v_F1: 0.719566  v_AUC: 0.899212
steps 7800    running time 310 seconds

steps 8000    base_loss: 0.176464    reg_loss: 0.066119    l2_loss: 0.026108    loss: 0.268692
steps 8000    v_Prec: 0.804432  v_Recall: 0.655525  v_F1: 0.722385  v_AUC: 0.899275
steps 8000    running time 317 seconds

steps 8200    base_loss: 0.175373    reg_loss: 0.066210    l2_loss: 0.026345    loss: 0.267928
steps 8200    v_Prec: 0.820348  v_Recall: 0.648871  v_F1: 0.724603  v_AUC: 0.901430
steps 8200    running time 325 seconds

steps 8400    base_loss: 0.180227    reg_loss: 0.066150    l2_loss: 0.026554    loss: 0.272932
steps 8400    v_Prec: 0.826074  v_Recall: 0.653465  v_F1: 0.729701  v_AUC: 0.902121
steps 8400    running time 332 seconds

steps 8600    base_loss: 0.180078    reg_loss: 0.066101    l2_loss: 0.026804    loss: 0.272983
steps 8600    v_Prec: 0.819026  v_Recall: 0.656713  v_F1: 0.728943  v_AUC: 0.902907
steps 8600    running time 339 seconds

steps 8800    base_loss: 0.183305    reg_loss: 0.066009    l2_loss: 0.026937    loss: 0.276252
steps 8800    v_Prec: 0.815733  v_Recall: 0.662020  v_F1: 0.730882  v_AUC: 0.904007
steps 8800    running time 345 seconds

steps 9000    base_loss: 0.177783    reg_loss: 0.066314    l2_loss: 0.027194    loss: 0.271290
steps 9000    v_Prec: 0.832103  v_Recall: 0.660673  v_F1: 0.736545  v_AUC: 0.905807
steps 9000    running time 352 seconds

steps 9200    base_loss: 0.168714    reg_loss: 0.065862    l2_loss: 0.027269    loss: 0.261845
steps 9200    v_Prec: 0.832481  v_Recall: 0.670337  v_F1: 0.742662  v_AUC: 0.909719
steps 9200    running time 359 seconds

steps 9400    base_loss: 0.178738    reg_loss: 0.065858    l2_loss: 0.027382    loss: 0.271979
steps 9400    v_Prec: 0.812594  v_Recall: 0.682772  v_F1: 0.742048  v_AUC: 0.907588
steps 9400    running time 366 seconds

steps 9600    base_loss: 0.167767    reg_loss: 0.065921    l2_loss: 0.027509    loss: 0.261196
steps 9600    v_Prec: 0.839218  v_Recall: 0.670178  v_F1: 0.745233  v_AUC: 0.909252
steps 9600    running time 373 seconds

steps 9800    base_loss: 0.172124    reg_loss: 0.065912    l2_loss: 0.027614    loss: 0.265650
steps 9800    v_Prec: 0.843023  v_Recall: 0.666139  v_F1: 0.744215  v_AUC: 0.908638
steps 9800    running time 380 seconds

steps 10000    base_loss: 0.179567    reg_loss: 0.065671    l2_loss: 0.027773    loss: 0.273011
steps 10000    v_Prec: 0.819996  v_Recall: 0.686653  v_F1: 0.747424  v_AUC: 0.910456
steps 10000    running time 386 seconds

steps 10200    base_loss: 0.174950    reg_loss: 0.065589    l2_loss: 0.027895    loss: 0.268434
steps 10200    v_Prec: 0.824945  v_Recall: 0.686812  v_F1: 0.749568  v_AUC: 0.911845
steps 10200    running time 393 seconds

steps 10400    base_loss: 0.175133    reg_loss: 0.065588    l2_loss: 0.027933    loss: 0.268655
steps 10400    v_Prec: 0.836308  v_Recall: 0.686733  v_F1: 0.754175  v_AUC: 0.914362
steps 10400    running time 400 seconds

steps 10600    base_loss: 0.170233    reg_loss: 0.065880    l2_loss: 0.027945    loss: 0.264058
steps 10600    v_Prec: 0.828641  v_Recall: 0.697109  v_F1: 0.757206  v_AUC: 0.915402
steps 10600    running time 408 seconds

steps 10800    base_loss: 0.164738    reg_loss: 0.065424    l2_loss: 0.028086    loss: 0.258248
steps 10800    v_Prec: 0.829453  v_Recall: 0.694178  v_F1: 0.755810  v_AUC: 0.915884
steps 10800    running time 415 seconds

steps 11000    base_loss: 0.063221    reg_loss: 0.062778    l2_loss: 0.028032    loss: 0.154031
steps 11000    v_Prec: 0.820701  v_Recall: 0.689584  v_F1: 0.749451  v_AUC: 0.910211
steps 11000    running time 422 seconds

steps 11200    base_loss: 0.055741    reg_loss: 0.062322    l2_loss: 0.027668    loss: 0.145732
steps 11200    v_Prec: 0.818684  v_Recall: 0.680950  v_F1: 0.743492  v_AUC: 0.905626
steps 11200    running time 428 seconds

steps 11400    base_loss: 0.065526    reg_loss: 0.062467    l2_loss: 0.027495    loss: 0.155489
steps 11400    v_Prec: 0.820017  v_Recall: 0.672317  v_F1: 0.738858  v_AUC: 0.902317
steps 11400    running time 435 seconds

steps 11600    base_loss: 0.063435    reg_loss: 0.062181    l2_loss: 0.027335    loss: 0.152951
steps 11600    v_Prec: 0.822760  v_Recall: 0.667723  v_F1: 0.737178  v_AUC: 0.902418
steps 11600    running time 441 seconds

steps 11800    base_loss: 0.063144    reg_loss: 0.062341    l2_loss: 0.027227    loss: 0.152712
steps 11800    v_Prec: 0.817902  v_Recall: 0.674535  v_F1: 0.739332  v_AUC: 0.901034
steps 11800    running time 448 seconds

steps 12000    base_loss: 0.063965    reg_loss: 0.062347    l2_loss: 0.027082    loss: 0.153395
steps 12000    v_Prec: 0.834395  v_Recall: 0.664079  v_F1: 0.739558  v_AUC: 0.902011
steps 12000    running time 454 seconds

steps 12200    base_loss: 0.065973    reg_loss: 0.062237    l2_loss: 0.026909    loss: 0.155119
steps 12200    v_Prec: 0.824613  v_Recall: 0.666614  v_F1: 0.737243  v_AUC: 0.901210
steps 12200    running time 461 seconds

steps 12400    base_loss: 0.066031    reg_loss: 0.062046    l2_loss: 0.026773    loss: 0.154850
steps 12400    v_Prec: 0.835405  v_Recall: 0.660119  v_F1: 0.737489  v_AUC: 0.901064
steps 12400    running time 468 seconds

steps 12600    base_loss: 0.061667    reg_loss: 0.062152    l2_loss: 0.026591    loss: 0.150410
steps 12600    v_Prec: 0.820448  v_Recall: 0.669941  v_F1: 0.737595  v_AUC: 0.899105
steps 12600    running time 474 seconds

Early stop model F1: 0.757206
testing thre: 0.6069073
testing Prec: 0.6683092371344893
testing Recall: 0.6987120291616039
testing F1: 0.6831725514422848
testing AUC: 0.8960961229244252
overall running time 477 seconds
(0.7539416016847857, 0.6437910085054678, 0.6945260067114095, 0.8960961229244252, 0.7596463)

2019-02-24 19:00:22.225394: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:00:23.569052: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:00:23.570393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:00:23.570430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.710000 seconds
loading data in 29.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.637524    reg_loss: 0.064929    l2_loss: 0.013325    loss: 0.715777
steps 200    v_Prec: 0.166033  v_Recall: 0.964104  v_F1: 0.283281  v_AUC: 0.537924
steps 200    running time 40 seconds

steps 400    base_loss: 0.521718    reg_loss: 0.064404    l2_loss: 0.013320    loss: 0.599441
steps 400    v_Prec: 0.170083  v_Recall: 0.862452  v_F1: 0.284133  v_AUC: 0.544792
steps 400    running time 47 seconds

steps 600    base_loss: 0.476549    reg_loss: 0.064100    l2_loss: 0.013269    loss: 0.553919
steps 600    v_Prec: 0.167369  v_Recall: 0.911690  v_F1: 0.282818  v_AUC: 0.538149
steps 600    running time 55 seconds

steps 800    base_loss: 0.464352    reg_loss: 0.063848    l2_loss: 0.013132    loss: 0.541332
steps 800    v_Prec: 0.176912  v_Recall: 0.750556  v_F1: 0.286333  v_AUC: 0.558127
steps 800    running time 61 seconds

steps 1000    base_loss: 0.458665    reg_loss: 0.063624    l2_loss: 0.012933    loss: 0.535222
steps 1000    v_Prec: 0.186570  v_Recall: 0.699651  v_F1: 0.294585  v_AUC: 0.582324
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.450681    reg_loss: 0.063177    l2_loss: 0.012822    loss: 0.526681
steps 1200    v_Prec: 0.225892  v_Recall: 0.533910  v_F1: 0.317467  v_AUC: 0.620727
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.440205    reg_loss: 0.062660    l2_loss: 0.012783    loss: 0.515648
steps 1400    v_Prec: 0.302543  v_Recall: 0.458307  v_F1: 0.364480  v_AUC: 0.674851
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.421118    reg_loss: 0.061950    l2_loss: 0.012904    loss: 0.495972
steps 1600    v_Prec: 0.442789  v_Recall: 0.431782  v_F1: 0.437216  v_AUC: 0.732926
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.393198    reg_loss: 0.061082    l2_loss: 0.013068    loss: 0.467348
steps 1800    v_Prec: 0.533848  v_Recall: 0.483482  v_F1: 0.507418  v_AUC: 0.778870
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.370982    reg_loss: 0.060402    l2_loss: 0.013478    loss: 0.444862
steps 2000    v_Prec: 0.583280  v_Recall: 0.510880  v_F1: 0.544685  v_AUC: 0.811691
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.352965    reg_loss: 0.059680    l2_loss: 0.013783    loss: 0.426428
steps 2200    v_Prec: 0.616130  v_Recall: 0.550270  v_F1: 0.581341  v_AUC: 0.833247
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.329170    reg_loss: 0.058853    l2_loss: 0.014223    loss: 0.402247
steps 2400    v_Prec: 0.687456  v_Recall: 0.547967  v_F1: 0.609837  v_AUC: 0.851473
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.315202    reg_loss: 0.058268    l2_loss: 0.014594    loss: 0.388064
steps 2600    v_Prec: 0.683274  v_Recall: 0.576159  v_F1: 0.625162  v_AUC: 0.858916
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.306232    reg_loss: 0.057959    l2_loss: 0.014922    loss: 0.379114
steps 2800    v_Prec: 0.712007  v_Recall: 0.577827  v_F1: 0.637938  v_AUC: 0.864051
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.298204    reg_loss: 0.057447    l2_loss: 0.015312    loss: 0.370962
steps 3000    v_Prec: 0.705915  v_Recall: 0.604670  v_F1: 0.651382  v_AUC: 0.869945
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.295625    reg_loss: 0.057289    l2_loss: 0.015678    loss: 0.368593
steps 3200    v_Prec: 0.730594  v_Recall: 0.598713  v_F1: 0.658112  v_AUC: 0.875948
steps 3200    running time 147 seconds

steps 3400    base_loss: 0.290483    reg_loss: 0.056885    l2_loss: 0.016066    loss: 0.363433
steps 3400    v_Prec: 0.702434  v_Recall: 0.623332  v_F1: 0.660523  v_AUC: 0.878235
steps 3400    running time 154 seconds

steps 3600    base_loss: 0.279681    reg_loss: 0.056619    l2_loss: 0.016437    loss: 0.352737
steps 3600    v_Prec: 0.725035  v_Recall: 0.624444  v_F1: 0.670990  v_AUC: 0.882081
steps 3600    running time 161 seconds

steps 3800    base_loss: 0.285533    reg_loss: 0.056422    l2_loss: 0.016801    loss: 0.358755
steps 3800    v_Prec: 0.735688  v_Recall: 0.628653  v_F1: 0.677972  v_AUC: 0.886102
steps 3800    running time 168 seconds

steps 4000    base_loss: 0.272005    reg_loss: 0.056152    l2_loss: 0.017185    loss: 0.345343
steps 4000    v_Prec: 0.714597  v_Recall: 0.650413  v_F1: 0.680996  v_AUC: 0.889156
steps 4000    running time 175 seconds

steps 4200    base_loss: 0.277964    reg_loss: 0.056025    l2_loss: 0.017580    loss: 0.351568
steps 4200    v_Prec: 0.740680  v_Recall: 0.640565  v_F1: 0.686994  v_AUC: 0.893281
steps 4200    running time 182 seconds

steps 4400    base_loss: 0.271785    reg_loss: 0.055827    l2_loss: 0.017965    loss: 0.345577
steps 4400    v_Prec: 0.755445  v_Recall: 0.636356  v_F1: 0.690806  v_AUC: 0.896099
steps 4400    running time 190 seconds

steps 4600    base_loss: 0.268842    reg_loss: 0.055744    l2_loss: 0.018357    loss: 0.342943
steps 4600    v_Prec: 0.772214  v_Recall: 0.635642  v_F1: 0.697304  v_AUC: 0.899353
steps 4600    running time 197 seconds

steps 4800    base_loss: 0.260326    reg_loss: 0.055913    l2_loss: 0.018780    loss: 0.335019
steps 4800    v_Prec: 0.753981  v_Recall: 0.650572  v_F1: 0.698470  v_AUC: 0.899716
steps 4800    running time 204 seconds

steps 5000    base_loss: 0.261303    reg_loss: 0.055659    l2_loss: 0.019163    loss: 0.336125
steps 5000    v_Prec: 0.748144  v_Recall: 0.664072  v_F1: 0.703606  v_AUC: 0.903789
steps 5000    running time 211 seconds

steps 5200    base_loss: 0.258285    reg_loss: 0.055495    l2_loss: 0.019643    loss: 0.333424
steps 5200    v_Prec: 0.759708  v_Recall: 0.661849  v_F1: 0.707410  v_AUC: 0.904612
steps 5200    running time 218 seconds

steps 5400    base_loss: 0.257289    reg_loss: 0.055190    l2_loss: 0.020128    loss: 0.332608
steps 5400    v_Prec: 0.745064  v_Recall: 0.680273  v_F1: 0.711196  v_AUC: 0.905728
steps 5400    running time 225 seconds

steps 5600    base_loss: 0.176954    reg_loss: 0.051432    l2_loss: 0.020746    loss: 0.249132
steps 5600    v_Prec: 0.748194  v_Recall: 0.674396  v_F1: 0.709381  v_AUC: 0.902939
steps 5600    running time 233 seconds

steps 5800    base_loss: 0.166139    reg_loss: 0.050961    l2_loss: 0.021371    loss: 0.238471
steps 5800    v_Prec: 0.749777  v_Recall: 0.667964  v_F1: 0.706510  v_AUC: 0.901004
steps 5800    running time 239 seconds

steps 6000    base_loss: 0.172603    reg_loss: 0.050782    l2_loss: 0.021920    loss: 0.245305
steps 6000    v_Prec: 0.759523  v_Recall: 0.661928  v_F1: 0.707375  v_AUC: 0.901219
steps 6000    running time 246 seconds

steps 6200    base_loss: 0.178679    reg_loss: 0.050961    l2_loss: 0.022527    loss: 0.252166
steps 6200    v_Prec: 0.758269  v_Recall: 0.668123  v_F1: 0.710347  v_AUC: 0.903558
steps 6200    running time 252 seconds

steps 6400    base_loss: 0.177336    reg_loss: 0.050775    l2_loss: 0.022961    loss: 0.251072
steps 6400    v_Prec: 0.780527  v_Recall: 0.656369  v_F1: 0.713084  v_AUC: 0.903691
steps 6400    running time 258 seconds

steps 6600    base_loss: 0.168452    reg_loss: 0.050158    l2_loss: 0.023402    loss: 0.242012
steps 6600    v_Prec: 0.744990  v_Recall: 0.679082  v_F1: 0.710511  v_AUC: 0.904158
steps 6600    running time 265 seconds

steps 6800    base_loss: 0.178915    reg_loss: 0.050184    l2_loss: 0.023749    loss: 0.252847
steps 6800    v_Prec: 0.771533  v_Recall: 0.669393  v_F1: 0.716843  v_AUC: 0.905832
steps 6800    running time 272 seconds

steps 7000    base_loss: 0.183981    reg_loss: 0.050220    l2_loss: 0.024184    loss: 0.258385
steps 7000    v_Prec: 0.756462  v_Recall: 0.683291  v_F1: 0.718017  v_AUC: 0.906283
steps 7000    running time 280 seconds

steps 7200    base_loss: 0.178174    reg_loss: 0.049768    l2_loss: 0.024513    loss: 0.252455
steps 7200    v_Prec: 0.769939  v_Recall: 0.676938  v_F1: 0.720450  v_AUC: 0.908713
steps 7200    running time 287 seconds

steps 7400    base_loss: 0.187289    reg_loss: 0.049788    l2_loss: 0.024733    loss: 0.261809
steps 7400    v_Prec: 0.781264  v_Recall: 0.670267  v_F1: 0.721522  v_AUC: 0.909939
steps 7400    running time 294 seconds

steps 7600    base_loss: 0.181950    reg_loss: 0.049684    l2_loss: 0.024944    loss: 0.256578
steps 7600    v_Prec: 0.780029  v_Recall: 0.675588  v_F1: 0.724062  v_AUC: 0.911880
steps 7600    running time 301 seconds

steps 7800    base_loss: 0.181357    reg_loss: 0.049391    l2_loss: 0.025219    loss: 0.255967
steps 7800    v_Prec: 0.776304  v_Recall: 0.678526  v_F1: 0.724129  v_AUC: 0.910738
steps 7800    running time 308 seconds

steps 8000    base_loss: 0.184314    reg_loss: 0.049392    l2_loss: 0.025438    loss: 0.259144
steps 8000    v_Prec: 0.760402  v_Recall: 0.690835  v_F1: 0.723951  v_AUC: 0.910584
steps 8000    running time 315 seconds

steps 8200    base_loss: 0.185220    reg_loss: 0.049246    l2_loss: 0.025501    loss: 0.259966
steps 8200    v_Prec: 0.754104  v_Recall: 0.700445  v_F1: 0.726285  v_AUC: 0.911779
steps 8200    running time 322 seconds

steps 8400    base_loss: 0.178148    reg_loss: 0.049192    l2_loss: 0.025618    loss: 0.252958
steps 8400    v_Prec: 0.765451  v_Recall: 0.691471  v_F1: 0.726582  v_AUC: 0.912397
steps 8400    running time 329 seconds

steps 8600    base_loss: 0.178497    reg_loss: 0.048803    l2_loss: 0.025701    loss: 0.253001
steps 8600    v_Prec: 0.796664  v_Recall: 0.675191  v_F1: 0.730915  v_AUC: 0.914220
steps 8600    running time 336 seconds

steps 8800    base_loss: 0.180585    reg_loss: 0.048798    l2_loss: 0.025906    loss: 0.255289
steps 8800    v_Prec: 0.778951  v_Recall: 0.697109  v_F1: 0.735761  v_AUC: 0.916270
steps 8800    running time 343 seconds

steps 9000    base_loss: 0.186116    reg_loss: 0.048736    l2_loss: 0.026049    loss: 0.260900
steps 9000    v_Prec: 0.789126  v_Recall: 0.691550  v_F1: 0.737123  v_AUC: 0.916445
steps 9000    running time 351 seconds

steps 9200    base_loss: 0.190118    reg_loss: 0.048854    l2_loss: 0.026155    loss: 0.265126
steps 9200    v_Prec: 0.775727  v_Recall: 0.701001  v_F1: 0.736473  v_AUC: 0.918189
steps 9200    running time 358 seconds

steps 9400    base_loss: 0.181109    reg_loss: 0.048416    l2_loss: 0.026249    loss: 0.255774
steps 9400    v_Prec: 0.783375  v_Recall: 0.695283  v_F1: 0.736705  v_AUC: 0.918910
steps 9400    running time 364 seconds

steps 9600    base_loss: 0.179939    reg_loss: 0.048526    l2_loss: 0.026329    loss: 0.254793
steps 9600    v_Prec: 0.781178  v_Recall: 0.695442  v_F1: 0.735821  v_AUC: 0.919001
steps 9600    running time 371 seconds

steps 9800    base_loss: 0.183457    reg_loss: 0.048110    l2_loss: 0.026341    loss: 0.257908
steps 9800    v_Prec: 0.782277  v_Recall: 0.701080  v_F1: 0.739456  v_AUC: 0.920521
steps 9800    running time 377 seconds

steps 10000    base_loss: 0.189281    reg_loss: 0.048452    l2_loss: 0.026516    loss: 0.264248
steps 10000    v_Prec: 0.804224  v_Recall: 0.686388  v_F1: 0.740649  v_AUC: 0.922172
steps 10000    running time 385 seconds

steps 10200    base_loss: 0.183244    reg_loss: 0.048191    l2_loss: 0.026565    loss: 0.258000
steps 10200    v_Prec: 0.774663  v_Recall: 0.710928  v_F1: 0.741428  v_AUC: 0.922399
steps 10200    running time 392 seconds

steps 10400    base_loss: 0.181655    reg_loss: 0.048031    l2_loss: 0.026453    loss: 0.256139
steps 10400    v_Prec: 0.785480  v_Recall: 0.704574  v_F1: 0.742831  v_AUC: 0.923562
steps 10400    running time 399 seconds

steps 10600    base_loss: 0.180318    reg_loss: 0.047868    l2_loss: 0.026574    loss: 0.254761
steps 10600    v_Prec: 0.789909  v_Recall: 0.706163  v_F1: 0.745692  v_AUC: 0.924035
steps 10600    running time 406 seconds

steps 10800    base_loss: 0.176060    reg_loss: 0.047371    l2_loss: 0.026653    loss: 0.250084
steps 10800    v_Prec: 0.789553  v_Recall: 0.705845  v_F1: 0.745356  v_AUC: 0.923975
steps 10800    running time 413 seconds

steps 11000    base_loss: 0.066463    reg_loss: 0.042884    l2_loss: 0.026552    loss: 0.135899
steps 11000    v_Prec: 0.801405  v_Recall: 0.697348  v_F1: 0.745764  v_AUC: 0.923284
steps 11000    running time 420 seconds

steps 11200    base_loss: 0.065361    reg_loss: 0.042949    l2_loss: 0.026385    loss: 0.134696
steps 11200    v_Prec: 0.779975  v_Recall: 0.707751  v_F1: 0.742110  v_AUC: 0.920940
steps 11200    running time 427 seconds

steps 11400    base_loss: 0.063983    reg_loss: 0.042955    l2_loss: 0.026385    loss: 0.133322
steps 11400    v_Prec: 0.803174  v_Recall: 0.687341  v_F1: 0.740757  v_AUC: 0.919790
steps 11400    running time 434 seconds

steps 11600    base_loss: 0.065733    reg_loss: 0.043034    l2_loss: 0.026355    loss: 0.135122
steps 11600    v_Prec: 0.797232  v_Recall: 0.690677  v_F1: 0.740139  v_AUC: 0.920455
steps 11600    running time 440 seconds

steps 11800    base_loss: 0.068106    reg_loss: 0.042973    l2_loss: 0.026337    loss: 0.137416
steps 11800    v_Prec: 0.774410  v_Recall: 0.706083  v_F1: 0.738670  v_AUC: 0.917691
steps 11800    running time 446 seconds

steps 12000    base_loss: 0.066461    reg_loss: 0.042913    l2_loss: 0.026223    loss: 0.135598
steps 12000    v_Prec: 0.767600  v_Recall: 0.710054  v_F1: 0.737706  v_AUC: 0.917845
steps 12000    running time 453 seconds

steps 12200    base_loss: 0.071102    reg_loss: 0.043223    l2_loss: 0.026296    loss: 0.140622
steps 12200    v_Prec: 0.785561  v_Recall: 0.698221  v_F1: 0.739321  v_AUC: 0.919327
steps 12200    running time 459 seconds

steps 12400    base_loss: 0.074182    reg_loss: 0.043040    l2_loss: 0.026164    loss: 0.143385
steps 12400    v_Prec: 0.778552  v_Recall: 0.701080  v_F1: 0.737788  v_AUC: 0.919030
steps 12400    running time 466 seconds

steps 12600    base_loss: 0.080419    reg_loss: 0.043324    l2_loss: 0.026421    loss: 0.150163
steps 12600    v_Prec: 0.768531  v_Recall: 0.711404  v_F1: 0.738865  v_AUC: 0.919255
steps 12600    running time 473 seconds

steps 12800    base_loss: 0.076765    reg_loss: 0.043177    l2_loss: 0.026357    loss: 0.146299
steps 12800    v_Prec: 0.767878  v_Recall: 0.717996  v_F1: 0.742100  v_AUC: 0.919619
steps 12800    running time 479 seconds

steps 13000    base_loss: 0.069357    reg_loss: 0.043043    l2_loss: 0.026260    loss: 0.138659
steps 13000    v_Prec: 0.797918  v_Recall: 0.693933  v_F1: 0.742301  v_AUC: 0.919846
steps 13000    running time 486 seconds

Early stop model F1: 0.745764
testing thre: 0.7148301
testing Prec: 0.5951138428234567
testing Recall: 0.7482381530984205
testing F1: 0.6629489277409354
testing AUC: 0.9038816014500255
overall running time 488 seconds
(0.7382446011214123, 0.646318347509113, 0.6892298123769047, 0.9038816014500255, 0.92851216)

2019-02-24 19:06:03.024695: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:06:04.323027: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:06:04.324984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:06:04.325022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.740000 seconds
loading data in 30.970000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.516309    reg_loss: 0.064742    l2_loss: 0.013320    loss: 0.594371
steps 200    v_Prec: 0.165254  v_Recall: 0.996760  v_F1: 0.283505  v_AUC: 0.498418
steps 200    running time 41 seconds

steps 400    base_loss: 0.492269    reg_loss: 0.064547    l2_loss: 0.013239    loss: 0.570056
steps 400    v_Prec: 0.167891  v_Recall: 0.941042  v_F1: 0.284945  v_AUC: 0.528153
steps 400    running time 48 seconds

steps 600    base_loss: 0.479523    reg_loss: 0.064518    l2_loss: 0.013185    loss: 0.557226
steps 600    v_Prec: 0.182845  v_Recall: 0.769936  v_F1: 0.295512  v_AUC: 0.566546
steps 600    running time 56 seconds

steps 800    base_loss: 0.457299    reg_loss: 0.064159    l2_loss: 0.012990    loss: 0.534448
steps 800    v_Prec: 0.178238  v_Recall: 0.854975  v_F1: 0.294981  v_AUC: 0.576705
steps 800    running time 63 seconds

steps 1000    base_loss: 0.451300    reg_loss: 0.064056    l2_loss: 0.012952    loss: 0.528309
steps 1000    v_Prec: 0.234216  v_Recall: 0.491978  v_F1: 0.317351  v_AUC: 0.621116
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.428418    reg_loss: 0.063531    l2_loss: 0.012972    loss: 0.504921
steps 1200    v_Prec: 0.298807  v_Recall: 0.471035  v_F1: 0.365655  v_AUC: 0.675008
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.409296    reg_loss: 0.063217    l2_loss: 0.012995    loss: 0.485507
steps 1400    v_Prec: 0.393077  v_Recall: 0.453252  v_F1: 0.421026  v_AUC: 0.717424
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.395326    reg_loss: 0.062954    l2_loss: 0.013021    loss: 0.471301
steps 1600    v_Prec: 0.468301  v_Recall: 0.474038  v_F1: 0.471152  v_AUC: 0.754879
steps 1600    running time 91 seconds

steps 1800    base_loss: 0.376047    reg_loss: 0.062385    l2_loss: 0.013136    loss: 0.451567
steps 1800    v_Prec: 0.502864  v_Recall: 0.499644  v_F1: 0.501249  v_AUC: 0.777296
steps 1800    running time 98 seconds

steps 2000    base_loss: 0.363688    reg_loss: 0.062017    l2_loss: 0.013197    loss: 0.438903
steps 2000    v_Prec: 0.531638  v_Recall: 0.503991  v_F1: 0.517446  v_AUC: 0.795136
steps 2000    running time 105 seconds

steps 2200    base_loss: 0.361895    reg_loss: 0.061455    l2_loss: 0.013281    loss: 0.436630
steps 2200    v_Prec: 0.543384  v_Recall: 0.526120  v_F1: 0.534613  v_AUC: 0.808150
steps 2200    running time 112 seconds

steps 2400    base_loss: 0.352398    reg_loss: 0.061055    l2_loss: 0.013238    loss: 0.426692
steps 2400    v_Prec: 0.530847  v_Recall: 0.569193  v_F1: 0.549352  v_AUC: 0.815372
steps 2400    running time 119 seconds

steps 2600    base_loss: 0.346069    reg_loss: 0.060620    l2_loss: 0.013293    loss: 0.419981
steps 2600    v_Prec: 0.569592  v_Recall: 0.546274  v_F1: 0.557689  v_AUC: 0.821537
steps 2600    running time 127 seconds

steps 2800    base_loss: 0.344311    reg_loss: 0.059894    l2_loss: 0.013270    loss: 0.417475
steps 2800    v_Prec: 0.557385  v_Recall: 0.575358  v_F1: 0.566229  v_AUC: 0.827083
steps 2800    running time 134 seconds

steps 3000    base_loss: 0.341299    reg_loss: 0.059377    l2_loss: 0.013233    loss: 0.413910
steps 3000    v_Prec: 0.570504  v_Recall: 0.564372  v_F1: 0.567422  v_AUC: 0.829018
steps 3000    running time 141 seconds

steps 3200    base_loss: 0.338741    reg_loss: 0.058392    l2_loss: 0.013186    loss: 0.410319
steps 3200    v_Prec: 0.560918  v_Recall: 0.583261  v_F1: 0.571871  v_AUC: 0.831469
steps 3200    running time 148 seconds

steps 3400    base_loss: 0.341776    reg_loss: 0.058045    l2_loss: 0.013082    loss: 0.412903
steps 3400    v_Prec: 0.542085  v_Recall: 0.605706  v_F1: 0.572132  v_AUC: 0.834381
steps 3400    running time 156 seconds

steps 3600    base_loss: 0.336240    reg_loss: 0.057247    l2_loss: 0.013027    loss: 0.406514
steps 3600    v_Prec: 0.544907  v_Recall: 0.615190  v_F1: 0.577920  v_AUC: 0.836482
steps 3600    running time 163 seconds

steps 3800    base_loss: 0.330460    reg_loss: 0.056187    l2_loss: 0.012973    loss: 0.399620
steps 3800    v_Prec: 0.550169  v_Recall: 0.604521  v_F1: 0.576066  v_AUC: 0.836725
steps 3800    running time 170 seconds

steps 4000    base_loss: 0.335937    reg_loss: 0.055706    l2_loss: 0.012859    loss: 0.404502
steps 4000    v_Prec: 0.564271  v_Recall: 0.610606  v_F1: 0.586525  v_AUC: 0.841132
steps 4000    running time 177 seconds

steps 4200    base_loss: 0.329816    reg_loss: 0.055348    l2_loss: 0.012936    loss: 0.398101
steps 4200    v_Prec: 0.573838  v_Recall: 0.623726  v_F1: 0.597743  v_AUC: 0.849018
steps 4200    running time 184 seconds

steps 4400    base_loss: 0.320756    reg_loss: 0.055303    l2_loss: 0.013295    loss: 0.389353
steps 4400    v_Prec: 0.604320  v_Recall: 0.627914  v_F1: 0.615891  v_AUC: 0.860488
steps 4400    running time 191 seconds

steps 4600    base_loss: 0.316823    reg_loss: 0.055536    l2_loss: 0.013982    loss: 0.386341
steps 4600    v_Prec: 0.628849  v_Recall: 0.624674  v_F1: 0.626754  v_AUC: 0.868853
steps 4600    running time 198 seconds

steps 4800    base_loss: 0.295483    reg_loss: 0.055835    l2_loss: 0.015020    loss: 0.366339
steps 4800    v_Prec: 0.648763  v_Recall: 0.631945  v_F1: 0.640243  v_AUC: 0.876249
steps 4800    running time 205 seconds

steps 5000    base_loss: 0.297858    reg_loss: 0.056555    l2_loss: 0.016124    loss: 0.370537
steps 5000    v_Prec: 0.663420  v_Recall: 0.640560  v_F1: 0.651789  v_AUC: 0.881882
steps 5000    running time 212 seconds

steps 5200    base_loss: 0.286390    reg_loss: 0.057216    l2_loss: 0.017205    loss: 0.360810
steps 5200    v_Prec: 0.696219  v_Recall: 0.637398  v_F1: 0.665511  v_AUC: 0.888007
steps 5200    running time 219 seconds

steps 5400    base_loss: 0.283840    reg_loss: 0.057249    l2_loss: 0.018383    loss: 0.359471
steps 5400    v_Prec: 0.707975  v_Recall: 0.643405  v_F1: 0.674147  v_AUC: 0.891209
steps 5400    running time 226 seconds

steps 5600    base_loss: 0.213811    reg_loss: 0.052588    l2_loss: 0.019079    loss: 0.285479
steps 5600    v_Prec: 0.722328  v_Recall: 0.628705  v_F1: 0.672272  v_AUC: 0.888894
steps 5600    running time 233 seconds

steps 5800    base_loss: 0.219674    reg_loss: 0.052542    l2_loss: 0.019656    loss: 0.291872
steps 5800    v_Prec: 0.697490  v_Recall: 0.658737  v_F1: 0.677560  v_AUC: 0.892291
steps 5800    running time 240 seconds

steps 6000    base_loss: 0.213927    reg_loss: 0.052188    l2_loss: 0.020113    loss: 0.286228
steps 6000    v_Prec: 0.702773  v_Recall: 0.658895  v_F1: 0.680127  v_AUC: 0.891936
steps 6000    running time 246 seconds

steps 6200    base_loss: 0.206121    reg_loss: 0.051311    l2_loss: 0.020533    loss: 0.277965
steps 6200    v_Prec: 0.705528  v_Recall: 0.657631  v_F1: 0.680738  v_AUC: 0.893984
steps 6200    running time 253 seconds

steps 6400    base_loss: 0.218385    reg_loss: 0.051480    l2_loss: 0.021063    loss: 0.290928
steps 6400    v_Prec: 0.718422  v_Recall: 0.649095  v_F1: 0.682001  v_AUC: 0.894317
steps 6400    running time 261 seconds

steps 6600    base_loss: 0.213340    reg_loss: 0.051107    l2_loss: 0.021353    loss: 0.285800
steps 6600    v_Prec: 0.720283  v_Recall: 0.658974  v_F1: 0.688266  v_AUC: 0.896193
steps 6600    running time 268 seconds

steps 6800    base_loss: 0.205332    reg_loss: 0.050820    l2_loss: 0.021631    loss: 0.277782
steps 6800    v_Prec: 0.695992  v_Recall: 0.683395  v_F1: 0.689636  v_AUC: 0.899019
steps 6800    running time 275 seconds

steps 7000    base_loss: 0.209839    reg_loss: 0.050844    l2_loss: 0.022052    loss: 0.282736
steps 7000    v_Prec: 0.746502  v_Recall: 0.653521  v_F1: 0.696924  v_AUC: 0.900431
steps 7000    running time 282 seconds

steps 7200    base_loss: 0.212165    reg_loss: 0.050805    l2_loss: 0.022215    loss: 0.285185
steps 7200    v_Prec: 0.734284  v_Recall: 0.671145  v_F1: 0.701297  v_AUC: 0.902180
steps 7200    running time 289 seconds

steps 7400    base_loss: 0.209854    reg_loss: 0.050123    l2_loss: 0.022438    loss: 0.282416
steps 7400    v_Prec: 0.761521  v_Recall: 0.656919  v_F1: 0.705363  v_AUC: 0.903595
steps 7400    running time 296 seconds

steps 7600    base_loss: 0.221697    reg_loss: 0.050603    l2_loss: 0.022710    loss: 0.295009
steps 7600    v_Prec: 0.730156  v_Recall: 0.687742  v_F1: 0.708315  v_AUC: 0.906208
steps 7600    running time 303 seconds

steps 7800    base_loss: 0.213212    reg_loss: 0.050153    l2_loss: 0.022831    loss: 0.286195
steps 7800    v_Prec: 0.739876  v_Recall: 0.681577  v_F1: 0.709531  v_AUC: 0.907058
steps 7800    running time 310 seconds

steps 8000    base_loss: 0.225481    reg_loss: 0.050140    l2_loss: 0.023035    loss: 0.298656
steps 8000    v_Prec: 0.748053  v_Recall: 0.683316  v_F1: 0.714221  v_AUC: 0.908901
steps 8000    running time 317 seconds

steps 8200    base_loss: 0.210986    reg_loss: 0.049883    l2_loss: 0.023135    loss: 0.284004
steps 8200    v_Prec: 0.739820  v_Recall: 0.689244  v_F1: 0.713637  v_AUC: 0.909535
steps 8200    running time 324 seconds

steps 8400    base_loss: 0.218019    reg_loss: 0.049786    l2_loss: 0.023281    loss: 0.291086
steps 8400    v_Prec: 0.759018  v_Recall: 0.676836  v_F1: 0.715575  v_AUC: 0.911739
steps 8400    running time 331 seconds

steps 8600    base_loss: 0.210074    reg_loss: 0.049496    l2_loss: 0.023308    loss: 0.282878
steps 8600    v_Prec: 0.752178  v_Recall: 0.689165  v_F1: 0.719294  v_AUC: 0.913185
steps 8600    running time 338 seconds

steps 8800    base_loss: 0.204369    reg_loss: 0.049498    l2_loss: 0.023275    loss: 0.277141
steps 8800    v_Prec: 0.735734  v_Recall: 0.704102  v_F1: 0.719570  v_AUC: 0.914640
steps 8800    running time 345 seconds

steps 9000    base_loss: 0.209690    reg_loss: 0.049515    l2_loss: 0.023536    loss: 0.282741
steps 9000    v_Prec: 0.768003  v_Recall: 0.676836  v_F1: 0.719543  v_AUC: 0.914451
steps 9000    running time 352 seconds

steps 9200    base_loss: 0.207263    reg_loss: 0.049429    l2_loss: 0.023629    loss: 0.280320
steps 9200    v_Prec: 0.761677  v_Recall: 0.692089  v_F1: 0.725217  v_AUC: 0.915957
steps 9200    running time 358 seconds

steps 9400    base_loss: 0.212133    reg_loss: 0.049224    l2_loss: 0.023673    loss: 0.285030
steps 9400    v_Prec: 0.761542  v_Recall: 0.702679  v_F1: 0.730927  v_AUC: 0.918071
steps 9400    running time 366 seconds

steps 9600    base_loss: 0.201339    reg_loss: 0.048811    l2_loss: 0.023657    loss: 0.273807
steps 9600    v_Prec: 0.751018  v_Recall: 0.714218  v_F1: 0.732156  v_AUC: 0.918712
steps 9600    running time 372 seconds

steps 9800    base_loss: 0.207405    reg_loss: 0.049126    l2_loss: 0.023738    loss: 0.280269
steps 9800    v_Prec: 0.772568  v_Recall: 0.696673  v_F1: 0.732660  v_AUC: 0.920653
steps 9800    running time 380 seconds

steps 10000    base_loss: 0.210582    reg_loss: 0.048772    l2_loss: 0.023856    loss: 0.283210
steps 10000    v_Prec: 0.779231  v_Recall: 0.696831  v_F1: 0.735731  v_AUC: 0.920142
steps 10000    running time 387 seconds

steps 10200    base_loss: 0.207099    reg_loss: 0.048877    l2_loss: 0.023996    loss: 0.279971
steps 10200    v_Prec: 0.785158  v_Recall: 0.693195  v_F1: 0.736316  v_AUC: 0.921121
steps 10200    running time 394 seconds

steps 10400    base_loss: 0.202862    reg_loss: 0.048900    l2_loss: 0.024107    loss: 0.275869
steps 10400    v_Prec: 0.783793  v_Recall: 0.695645  v_F1: 0.737093  v_AUC: 0.921720
steps 10400    running time 401 seconds

steps 10600    base_loss: 0.204958    reg_loss: 0.048682    l2_loss: 0.024205    loss: 0.277845
steps 10600    v_Prec: 0.785234  v_Recall: 0.692642  v_F1: 0.736038  v_AUC: 0.922330
steps 10600    running time 408 seconds

steps 10800    base_loss: 0.195667    reg_loss: 0.048037    l2_loss: 0.024282    loss: 0.267986
steps 10800    v_Prec: 0.759843  v_Recall: 0.718407  v_F1: 0.738544  v_AUC: 0.923485
steps 10800    running time 414 seconds

steps 11000    base_loss: 0.089149    reg_loss: 0.043062    l2_loss: 0.024240    loss: 0.156452
steps 11000    v_Prec: 0.763619  v_Recall: 0.715641  v_F1: 0.738852  v_AUC: 0.922252
steps 11000    running time 421 seconds

steps 11200    base_loss: 0.080417    reg_loss: 0.042962    l2_loss: 0.024270    loss: 0.147649
steps 11200    v_Prec: 0.769237  v_Recall: 0.708686  v_F1: 0.737721  v_AUC: 0.920448
steps 11200    running time 429 seconds

steps 11400    base_loss: 0.080662    reg_loss: 0.043030    l2_loss: 0.024395    loss: 0.148087
steps 11400    v_Prec: 0.778387  v_Recall: 0.695645  v_F1: 0.734694  v_AUC: 0.919434
steps 11400    running time 435 seconds

steps 11600    base_loss: 0.083410    reg_loss: 0.042968    l2_loss: 0.024421    loss: 0.150799
steps 11600    v_Prec: 0.758659  v_Recall: 0.708053  v_F1: 0.732483  v_AUC: 0.918958
steps 11600    running time 441 seconds

steps 11800    base_loss: 0.081972    reg_loss: 0.043123    l2_loss: 0.024629    loss: 0.149724
steps 11800    v_Prec: 0.739860  v_Recall: 0.720857  v_F1: 0.730235  v_AUC: 0.918227
steps 11800    running time 448 seconds

steps 12000    base_loss: 0.078269    reg_loss: 0.043026    l2_loss: 0.024543    loss: 0.145839
steps 12000    v_Prec: 0.757836  v_Recall: 0.710820  v_F1: 0.733575  v_AUC: 0.918490
steps 12000    running time 454 seconds

steps 12200    base_loss: 0.083633    reg_loss: 0.043220    l2_loss: 0.024635    loss: 0.151489
steps 12200    v_Prec: 0.753483  v_Recall: 0.709476  v_F1: 0.730818  v_AUC: 0.918232
steps 12200    running time 460 seconds

steps 12400    base_loss: 0.081684    reg_loss: 0.042939    l2_loss: 0.024701    loss: 0.149323
steps 12400    v_Prec: 0.764228  v_Recall: 0.698332  v_F1: 0.729796  v_AUC: 0.918400
steps 12400    running time 467 seconds

steps 12600    base_loss: 0.086714    reg_loss: 0.043187    l2_loss: 0.024706    loss: 0.154607
steps 12600    v_Prec: 0.762993  v_Recall: 0.693828  v_F1: 0.726768  v_AUC: 0.917792
steps 12600    running time 473 seconds

steps 12800    base_loss: 0.083336    reg_loss: 0.043208    l2_loss: 0.024746    loss: 0.151290
steps 12800    v_Prec: 0.758154  v_Recall: 0.703628  v_F1: 0.729874  v_AUC: 0.918516
steps 12800    running time 479 seconds

steps 13000    base_loss: 0.084023    reg_loss: 0.043373    l2_loss: 0.024711    loss: 0.152106
steps 13000    v_Prec: 0.770049  v_Recall: 0.692089  v_F1: 0.728991  v_AUC: 0.919081
steps 13000    running time 486 seconds

Early stop model F1: 0.738852
testing thre: 0.42893824
testing Prec: 0.5567343676198089
testing Recall: 0.7447387606318348
testing F1: 0.6371574701650796
testing AUC: 0.8962814781525372
overall running time 489 seconds
(0.68826160728058, 0.650595382746051, 0.6688986608035179, 0.8962814781525372, 0.7555633)

2019-02-24 19:11:45.400683: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:11:46.301050: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:11:46.363956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:11:46.364041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.650000 seconds
loading data in 30.620000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.541891    reg_loss: 0.064781    l2_loss: 0.013330    loss: 0.620002
steps 200    v_Prec: 0.165415  v_Recall: 0.964402  v_F1: 0.282393  v_AUC: 0.545820
steps 200    running time 41 seconds

steps 400    base_loss: 0.507385    reg_loss: 0.064506    l2_loss: 0.013290    loss: 0.585181
steps 400    v_Prec: 0.181540  v_Recall: 0.718324  v_F1: 0.289832  v_AUC: 0.574444
steps 400    running time 49 seconds

steps 600    base_loss: 0.500901    reg_loss: 0.064141    l2_loss: 0.013154    loss: 0.578196
steps 600    v_Prec: 0.216130  v_Recall: 0.555308  v_F1: 0.311156  v_AUC: 0.616228
steps 600    running time 56 seconds

steps 800    base_loss: 0.470047    reg_loss: 0.063519    l2_loss: 0.013004    loss: 0.546571
steps 800    v_Prec: 0.209934  v_Recall: 0.637493  v_F1: 0.315854  v_AUC: 0.622332
steps 800    running time 64 seconds

steps 1000    base_loss: 0.441126    reg_loss: 0.062810    l2_loss: 0.012962    loss: 0.516898
steps 1000    v_Prec: 0.282096  v_Recall: 0.486979  v_F1: 0.357247  v_AUC: 0.677852
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.429072    reg_loss: 0.062202    l2_loss: 0.012952    loss: 0.504227
steps 1200    v_Prec: 0.395134  v_Recall: 0.443657  v_F1: 0.417992  v_AUC: 0.730246
steps 1200    running time 78 seconds

steps 1400    base_loss: 0.406041    reg_loss: 0.061296    l2_loss: 0.013101    loss: 0.480437
steps 1400    v_Prec: 0.525882  v_Recall: 0.452258  v_F1: 0.486299  v_AUC: 0.778640
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.379472    reg_loss: 0.060539    l2_loss: 0.013185    loss: 0.453195
steps 1600    v_Prec: 0.571609  v_Recall: 0.504738  v_F1: 0.536096  v_AUC: 0.811871
steps 1600    running time 93 seconds

steps 1800    base_loss: 0.350736    reg_loss: 0.059821    l2_loss: 0.013469    loss: 0.424026
steps 1800    v_Prec: 0.593948  v_Recall: 0.545512  v_F1: 0.568701  v_AUC: 0.834815
steps 1800    running time 100 seconds

steps 2000    base_loss: 0.330782    reg_loss: 0.059183    l2_loss: 0.013738    loss: 0.403703
steps 2000    v_Prec: 0.647983  v_Recall: 0.555149  v_F1: 0.597984  v_AUC: 0.853676
steps 2000    running time 108 seconds

steps 2200    base_loss: 0.309381    reg_loss: 0.058467    l2_loss: 0.014038    loss: 0.381886
steps 2200    v_Prec: 0.665350  v_Recall: 0.576650  v_F1: 0.617833  v_AUC: 0.862728
steps 2200    running time 115 seconds

steps 2400    base_loss: 0.304818    reg_loss: 0.058167    l2_loss: 0.014363    loss: 0.377348
steps 2400    v_Prec: 0.685974  v_Recall: 0.588516  v_F1: 0.633519  v_AUC: 0.871449
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.303980    reg_loss: 0.057831    l2_loss: 0.014687    loss: 0.376498
steps 2600    v_Prec: 0.689605  v_Recall: 0.606514  v_F1: 0.645396  v_AUC: 0.877142
steps 2600    running time 130 seconds

steps 2800    base_loss: 0.289117    reg_loss: 0.057358    l2_loss: 0.015063    loss: 0.361537
steps 2800    v_Prec: 0.719140  v_Recall: 0.596639  v_F1: 0.652187  v_AUC: 0.880800
steps 2800    running time 137 seconds

steps 3000    base_loss: 0.286991    reg_loss: 0.057022    l2_loss: 0.015452    loss: 0.359466
steps 3000    v_Prec: 0.694548  v_Recall: 0.636139  v_F1: 0.664062  v_AUC: 0.884640
steps 3000    running time 145 seconds

steps 3200    base_loss: 0.287926    reg_loss: 0.056618    l2_loss: 0.015806    loss: 0.360350
steps 3200    v_Prec: 0.734694  v_Recall: 0.622123  v_F1: 0.673739  v_AUC: 0.887014
steps 3200    running time 152 seconds

steps 3400    base_loss: 0.279299    reg_loss: 0.056112    l2_loss: 0.016225    loss: 0.351636
steps 3400    v_Prec: 0.721960  v_Recall: 0.633591  v_F1: 0.674895  v_AUC: 0.888848
steps 3400    running time 160 seconds

steps 3600    base_loss: 0.280131    reg_loss: 0.055863    l2_loss: 0.016574    loss: 0.352568
steps 3600    v_Prec: 0.724073  v_Recall: 0.640519  v_F1: 0.679738  v_AUC: 0.890652
steps 3600    running time 167 seconds

steps 3800    base_loss: 0.276895    reg_loss: 0.055685    l2_loss: 0.016955    loss: 0.349535
steps 3800    v_Prec: 0.737661  v_Recall: 0.634387  v_F1: 0.682137  v_AUC: 0.893587
steps 3800    running time 175 seconds

steps 4000    base_loss: 0.265900    reg_loss: 0.055297    l2_loss: 0.017366    loss: 0.338563
steps 4000    v_Prec: 0.740370  v_Recall: 0.647448  v_F1: 0.690798  v_AUC: 0.896426
steps 4000    running time 182 seconds

steps 4200    base_loss: 0.268191    reg_loss: 0.055029    l2_loss: 0.017762    loss: 0.340983
steps 4200    v_Prec: 0.751002  v_Recall: 0.641793  v_F1: 0.692116  v_AUC: 0.897566
steps 4200    running time 189 seconds

steps 4400    base_loss: 0.267945    reg_loss: 0.054763    l2_loss: 0.018275    loss: 0.340983
steps 4400    v_Prec: 0.730980  v_Recall: 0.667994  v_F1: 0.698069  v_AUC: 0.900320
steps 4400    running time 197 seconds

steps 4600    base_loss: 0.262982    reg_loss: 0.054535    l2_loss: 0.018679    loss: 0.336197
steps 4600    v_Prec: 0.741558  v_Recall: 0.671578  v_F1: 0.704835  v_AUC: 0.901072
steps 4600    running time 204 seconds

steps 4800    base_loss: 0.258532    reg_loss: 0.054510    l2_loss: 0.019095    loss: 0.332137
steps 4800    v_Prec: 0.774560  v_Recall: 0.645457  v_F1: 0.704140  v_AUC: 0.902430
steps 4800    running time 212 seconds

steps 5000    base_loss: 0.254943    reg_loss: 0.054108    l2_loss: 0.019635    loss: 0.328686
steps 5000    v_Prec: 0.741665  v_Recall: 0.676754  v_F1: 0.707724  v_AUC: 0.903899
steps 5000    running time 219 seconds

steps 5200    base_loss: 0.260524    reg_loss: 0.054014    l2_loss: 0.020064    loss: 0.334601
steps 5200    v_Prec: 0.761874  v_Recall: 0.662977  v_F1: 0.708993  v_AUC: 0.907321
steps 5200    running time 226 seconds

steps 5400    base_loss: 0.256051    reg_loss: 0.053715    l2_loss: 0.020440    loss: 0.330206
steps 5400    v_Prec: 0.749847  v_Recall: 0.682966  v_F1: 0.714845  v_AUC: 0.908410
steps 5400    running time 234 seconds

steps 5600    base_loss: 0.168970    reg_loss: 0.050801    l2_loss: 0.020947    loss: 0.240717
steps 5600    v_Prec: 0.746445  v_Recall: 0.677311  v_F1: 0.710200  v_AUC: 0.903631
steps 5600    running time 242 seconds

steps 5800    base_loss: 0.164639    reg_loss: 0.050336    l2_loss: 0.021423    loss: 0.236399
steps 5800    v_Prec: 0.744470  v_Recall: 0.670065  v_F1: 0.705310  v_AUC: 0.900561
steps 5800    running time 248 seconds

steps 6000    base_loss: 0.159293    reg_loss: 0.050177    l2_loss: 0.022010    loss: 0.231480
steps 6000    v_Prec: 0.778722  v_Recall: 0.642351  v_F1: 0.703993  v_AUC: 0.900281
steps 6000    running time 255 seconds

steps 6200    base_loss: 0.165715    reg_loss: 0.050203    l2_loss: 0.022641    loss: 0.238559
steps 6200    v_Prec: 0.748330  v_Recall: 0.668950  v_F1: 0.706417  v_AUC: 0.899387
steps 6200    running time 262 seconds

steps 6400    base_loss: 0.180185    reg_loss: 0.050434    l2_loss: 0.023217    loss: 0.253837
steps 6400    v_Prec: 0.763722  v_Recall: 0.661543  v_F1: 0.708970  v_AUC: 0.901484
steps 6400    running time 269 seconds

steps 6600    base_loss: 0.180731    reg_loss: 0.050309    l2_loss: 0.023790    loss: 0.254829
steps 6600    v_Prec: 0.747717  v_Recall: 0.671498  v_F1: 0.707561  v_AUC: 0.901021
steps 6600    running time 275 seconds

steps 6800    base_loss: 0.170517    reg_loss: 0.049853    l2_loss: 0.024180    loss: 0.244551
steps 6800    v_Prec: 0.768473  v_Recall: 0.665047  v_F1: 0.713029  v_AUC: 0.904007
steps 6800    running time 282 seconds

steps 7000    base_loss: 0.174590    reg_loss: 0.049744    l2_loss: 0.024576    loss: 0.248910
steps 7000    v_Prec: 0.781906  v_Recall: 0.655252  v_F1: 0.712998  v_AUC: 0.904571
steps 7000    running time 289 seconds

steps 7200    base_loss: 0.177766    reg_loss: 0.049515    l2_loss: 0.024886    loss: 0.252167
steps 7200    v_Prec: 0.766131  v_Recall: 0.672294  v_F1: 0.716152  v_AUC: 0.907219
steps 7200    running time 296 seconds

steps 7400    base_loss: 0.180807    reg_loss: 0.049521    l2_loss: 0.025220    loss: 0.255547
steps 7400    v_Prec: 0.763649  v_Recall: 0.673887  v_F1: 0.715966  v_AUC: 0.906219
steps 7400    running time 304 seconds

steps 7600    base_loss: 0.175781    reg_loss: 0.049127    l2_loss: 0.025573    loss: 0.250480
steps 7600    v_Prec: 0.764764  v_Recall: 0.675480  v_F1: 0.717355  v_AUC: 0.907631
steps 7600    running time 310 seconds

steps 7800    base_loss: 0.180833    reg_loss: 0.049216    l2_loss: 0.025906    loss: 0.255955
steps 7800    v_Prec: 0.785019  v_Recall: 0.667675  v_F1: 0.721608  v_AUC: 0.909494
steps 7800    running time 318 seconds

steps 8000    base_loss: 0.174553    reg_loss: 0.048802    l2_loss: 0.026072    loss: 0.249427
steps 8000    v_Prec: 0.784845  v_Recall: 0.667277  v_F1: 0.721302  v_AUC: 0.909643
steps 8000    running time 325 seconds

steps 8200    base_loss: 0.182766    reg_loss: 0.048762    l2_loss: 0.026348    loss: 0.257876
steps 8200    v_Prec: 0.778220  v_Recall: 0.685196  v_F1: 0.728751  v_AUC: 0.911863
steps 8200    running time 332 seconds

steps 8400    base_loss: 0.170256    reg_loss: 0.048210    l2_loss: 0.026410    loss: 0.244876
steps 8400    v_Prec: 0.754649  v_Recall: 0.701282  v_F1: 0.726988  v_AUC: 0.911545
steps 8400    running time 340 seconds

steps 8600    base_loss: 0.178908    reg_loss: 0.048283    l2_loss: 0.026512    loss: 0.253703
steps 8600    v_Prec: 0.770666  v_Recall: 0.687505  v_F1: 0.726714  v_AUC: 0.911466
steps 8600    running time 346 seconds

steps 8800    base_loss: 0.171058    reg_loss: 0.047978    l2_loss: 0.026719    loss: 0.245755
steps 8800    v_Prec: 0.797395  v_Recall: 0.672931  v_F1: 0.729895  v_AUC: 0.913440
steps 8800    running time 353 seconds

steps 9000    base_loss: 0.180272    reg_loss: 0.048172    l2_loss: 0.026809    loss: 0.255252
steps 9000    v_Prec: 0.789028  v_Recall: 0.682647  v_F1: 0.731993  v_AUC: 0.912770
steps 9000    running time 361 seconds

steps 9200    base_loss: 0.166996    reg_loss: 0.047731    l2_loss: 0.027062    loss: 0.241790
steps 9200    v_Prec: 0.773825  v_Recall: 0.696424  v_F1: 0.733087  v_AUC: 0.913944
steps 9200    running time 368 seconds

steps 9400    base_loss: 0.169115    reg_loss: 0.047854    l2_loss: 0.027174    loss: 0.244143
steps 9400    v_Prec: 0.771647  v_Recall: 0.698336  v_F1: 0.733163  v_AUC: 0.914758
steps 9400    running time 376 seconds

steps 9600    base_loss: 0.185766    reg_loss: 0.047916    l2_loss: 0.027127    loss: 0.260809
steps 9600    v_Prec: 0.794131  v_Recall: 0.689655  v_F1: 0.738215  v_AUC: 0.917244
steps 9600    running time 383 seconds

steps 9800    base_loss: 0.173674    reg_loss: 0.047739    l2_loss: 0.027351    loss: 0.248764
steps 9800    v_Prec: 0.784979  v_Recall: 0.704149  v_F1: 0.742370  v_AUC: 0.918928
steps 9800    running time 391 seconds

steps 10000    base_loss: 0.178750    reg_loss: 0.047638    l2_loss: 0.027315    loss: 0.253703
steps 10000    v_Prec: 0.791501  v_Recall: 0.698654  v_F1: 0.742185  v_AUC: 0.920050
steps 10000    running time 398 seconds

steps 10200    base_loss: 0.177538    reg_loss: 0.047642    l2_loss: 0.027517    loss: 0.252698
steps 10200    v_Prec: 0.796059  v_Recall: 0.698176  v_F1: 0.743912  v_AUC: 0.919979
steps 10200    running time 405 seconds

steps 10400    base_loss: 0.180076    reg_loss: 0.047533    l2_loss: 0.027516    loss: 0.255125
steps 10400    v_Prec: 0.790363  v_Recall: 0.704069  v_F1: 0.744725  v_AUC: 0.921069
steps 10400    running time 413 seconds

steps 10600    base_loss: 0.173724    reg_loss: 0.047332    l2_loss: 0.027592    loss: 0.248648
steps 10600    v_Prec: 0.792159  v_Recall: 0.704786  v_F1: 0.745923  v_AUC: 0.922056
steps 10600    running time 420 seconds

steps 10800    base_loss: 0.162818    reg_loss: 0.046671    l2_loss: 0.027582    loss: 0.237071
steps 10800    v_Prec: 0.803256  v_Recall: 0.699371  v_F1: 0.747722  v_AUC: 0.922311
steps 10800    running time 427 seconds

steps 11000    base_loss: 0.070651    reg_loss: 0.042721    l2_loss: 0.027594    loss: 0.140966
steps 11000    v_Prec: 0.785645  v_Recall: 0.706936  v_F1: 0.744215  v_AUC: 0.919142
steps 11000    running time 435 seconds

steps 11200    base_loss: 0.060306    reg_loss: 0.042883    l2_loss: 0.027369    loss: 0.130558
steps 11200    v_Prec: 0.781817  v_Recall: 0.707414  v_F1: 0.742757  v_AUC: 0.919352
steps 11200    running time 442 seconds

steps 11400    base_loss: 0.057791    reg_loss: 0.042713    l2_loss: 0.027222    loss: 0.127727
steps 11400    v_Prec: 0.776599  v_Recall: 0.705662  v_F1: 0.739433  v_AUC: 0.916892
steps 11400    running time 448 seconds

steps 11600    base_loss: 0.067125    reg_loss: 0.042903    l2_loss: 0.027008    loss: 0.137036
steps 11600    v_Prec: 0.800965  v_Recall: 0.687107  v_F1: 0.739680  v_AUC: 0.915859
steps 11600    running time 455 seconds

steps 11800    base_loss: 0.063238    reg_loss: 0.042809    l2_loss: 0.027101    loss: 0.133148
steps 11800    v_Prec: 0.798129  v_Recall: 0.686390  v_F1: 0.738054  v_AUC: 0.913696
steps 11800    running time 462 seconds

steps 12000    base_loss: 0.069100    reg_loss: 0.043117    l2_loss: 0.027088    loss: 0.139306
steps 12000    v_Prec: 0.795020  v_Recall: 0.681373  v_F1: 0.733822  v_AUC: 0.912241
steps 12000    running time 468 seconds

steps 12200    base_loss: 0.068556    reg_loss: 0.043157    l2_loss: 0.026928    loss: 0.138641
steps 12200    v_Prec: 0.780177  v_Recall: 0.696424  v_F1: 0.735925  v_AUC: 0.914540
steps 12200    running time 475 seconds

steps 12400    base_loss: 0.072341    reg_loss: 0.042941    l2_loss: 0.026955    loss: 0.142237
steps 12400    v_Prec: 0.775260  v_Recall: 0.694752  v_F1: 0.732801  v_AUC: 0.912918
steps 12400    running time 482 seconds

steps 12600    base_loss: 0.065851    reg_loss: 0.043098    l2_loss: 0.026963    loss: 0.135912
steps 12600    v_Prec: 0.789459  v_Recall: 0.685912  v_F1: 0.734052  v_AUC: 0.913639
steps 12600    running time 489 seconds

steps 12800    base_loss: 0.076751    reg_loss: 0.043347    l2_loss: 0.026979    loss: 0.147076
steps 12800    v_Prec: 0.795697  v_Recall: 0.683284  v_F1: 0.735219  v_AUC: 0.915761
steps 12800    running time 495 seconds

Early stop model F1: 0.747722
testing thre: 0.5570235
testing Prec: 0.5860866985574962
testing Recall: 0.7681652490886999
testing F1: 0.6648857852004544
testing AUC: 0.9076966891532505
overall running time 498 seconds
(0.749819233550253, 0.6552126366950183, 0.6993308087357991, 0.9076966891532505, 0.83727366)

2019-02-24 19:17:38.825737: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:17:39.283420: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:17:39.285932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:17:39.285975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.670000 seconds
loading data in 30.880000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.749733    reg_loss: 0.064817    l2_loss: 0.013324    loss: 0.827873
steps 200    v_Prec: 0.164017  v_Recall: 0.999761  v_F1: 0.281802  v_AUC: 0.493793
steps 200    running time 41 seconds

steps 400    base_loss: 0.562342    reg_loss: 0.064790    l2_loss: 0.013488    loss: 0.640620
steps 400    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.498389
steps 400    running time 49 seconds

steps 600    base_loss: 0.493297    reg_loss: 0.064669    l2_loss: 0.013425    loss: 0.571391
steps 600    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.478036
steps 600    running time 56 seconds

steps 800    base_loss: 0.483801    reg_loss: 0.064517    l2_loss: 0.013232    loss: 0.561550
steps 800    v_Prec: 0.163985  v_Recall: 1.000000  v_F1: 0.281765  v_AUC: 0.494807
steps 800    running time 62 seconds

steps 1000    base_loss: 0.467377    reg_loss: 0.064173    l2_loss: 0.012948    loss: 0.544498
steps 1000    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.511124
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.457180    reg_loss: 0.063905    l2_loss: 0.012753    loss: 0.533839
steps 1200    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.525838
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.460640    reg_loss: 0.063673    l2_loss: 0.012610    loss: 0.536923
steps 1400    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.552969
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.448370    reg_loss: 0.063369    l2_loss: 0.012495    loss: 0.524235
steps 1600    v_Prec: 0.256791  v_Recall: 0.400939  v_F1: 0.313069  v_AUC: 0.609856
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.433286    reg_loss: 0.063787    l2_loss: 0.012429    loss: 0.509502
steps 1800    v_Prec: 0.390362  v_Recall: 0.431174  v_F1: 0.409754  v_AUC: 0.704175
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.413801    reg_loss: 0.064655    l2_loss: 0.012495    loss: 0.490951
steps 2000    v_Prec: 0.497189  v_Recall: 0.464433  v_F1: 0.480253  v_AUC: 0.759743
steps 2000    running time 105 seconds

steps 2200    base_loss: 0.378796    reg_loss: 0.065231    l2_loss: 0.012732    loss: 0.456758
steps 2200    v_Prec: 0.552162  v_Recall: 0.501989  v_F1: 0.525881  v_AUC: 0.796972
steps 2200    running time 112 seconds

steps 2400    base_loss: 0.352070    reg_loss: 0.065835    l2_loss: 0.013012    loss: 0.430917
steps 2400    v_Prec: 0.591314  v_Recall: 0.527610  v_F1: 0.557649  v_AUC: 0.820664
steps 2400    running time 120 seconds

steps 2600    base_loss: 0.333025    reg_loss: 0.066502    l2_loss: 0.013479    loss: 0.413005
steps 2600    v_Prec: 0.620342  v_Recall: 0.539147  v_F1: 0.576902  v_AUC: 0.835689
steps 2600    running time 127 seconds

steps 2800    base_loss: 0.317803    reg_loss: 0.066903    l2_loss: 0.014010    loss: 0.398716
steps 2800    v_Prec: 0.661151  v_Recall: 0.546785  v_F1: 0.598554  v_AUC: 0.847872
steps 2800    running time 134 seconds

steps 3000    base_loss: 0.312466    reg_loss: 0.067239    l2_loss: 0.014483    loss: 0.394188
steps 3000    v_Prec: 0.669763  v_Recall: 0.556572  v_F1: 0.607944  v_AUC: 0.853966
steps 3000    running time 142 seconds

steps 3200    base_loss: 0.302784    reg_loss: 0.067719    l2_loss: 0.015034    loss: 0.385537
steps 3200    v_Prec: 0.686702  v_Recall: 0.564529  v_F1: 0.619651  v_AUC: 0.861236
steps 3200    running time 150 seconds

steps 3400    base_loss: 0.299543    reg_loss: 0.067796    l2_loss: 0.015611    loss: 0.382950
steps 3400    v_Prec: 0.668220  v_Recall: 0.593412  v_F1: 0.628598  v_AUC: 0.865160
steps 3400    running time 157 seconds

steps 3600    base_loss: 0.289595    reg_loss: 0.068047    l2_loss: 0.016138    loss: 0.373780
steps 3600    v_Prec: 0.706116  v_Recall: 0.579647  v_F1: 0.636662  v_AUC: 0.869906
steps 3600    running time 165 seconds

steps 3800    base_loss: 0.285132    reg_loss: 0.067929    l2_loss: 0.016652    loss: 0.369712
steps 3800    v_Prec: 0.705229  v_Recall: 0.591264  v_F1: 0.643237  v_AUC: 0.873993
steps 3800    running time 172 seconds

steps 4000    base_loss: 0.284626    reg_loss: 0.068303    l2_loss: 0.017192    loss: 0.370121
steps 4000    v_Prec: 0.701711  v_Recall: 0.607018  v_F1: 0.650939  v_AUC: 0.879793
steps 4000    running time 179 seconds

steps 4200    base_loss: 0.279899    reg_loss: 0.068293    l2_loss: 0.017741    loss: 0.365933
steps 4200    v_Prec: 0.695047  v_Recall: 0.624204  v_F1: 0.657724  v_AUC: 0.883491
steps 4200    running time 187 seconds

steps 4400    base_loss: 0.283199    reg_loss: 0.068302    l2_loss: 0.018176    loss: 0.369678
steps 4400    v_Prec: 0.740333  v_Recall: 0.598663  v_F1: 0.662003  v_AUC: 0.886077
steps 4400    running time 194 seconds

steps 4600    base_loss: 0.267415    reg_loss: 0.068066    l2_loss: 0.018790    loss: 0.354272
steps 4600    v_Prec: 0.739080  v_Recall: 0.611235  v_F1: 0.669105  v_AUC: 0.887918
steps 4600    running time 202 seconds

steps 4800    base_loss: 0.268759    reg_loss: 0.068100    l2_loss: 0.019415    loss: 0.356274
steps 4800    v_Prec: 0.751063  v_Recall: 0.604472  v_F1: 0.669841  v_AUC: 0.890825
steps 4800    running time 209 seconds

steps 5000    base_loss: 0.268685    reg_loss: 0.068305    l2_loss: 0.019966    loss: 0.356956
steps 5000    v_Prec: 0.759818  v_Recall: 0.611155  v_F1: 0.677426  v_AUC: 0.894205
steps 5000    running time 216 seconds

steps 5200    base_loss: 0.259063    reg_loss: 0.068069    l2_loss: 0.020525    loss: 0.347657
steps 5200    v_Prec: 0.762276  v_Recall: 0.613861  v_F1: 0.680065  v_AUC: 0.893436
steps 5200    running time 224 seconds

steps 5400    base_loss: 0.260941    reg_loss: 0.068000    l2_loss: 0.021179    loss: 0.350119
steps 5400    v_Prec: 0.747093  v_Recall: 0.628740  v_F1: 0.682826  v_AUC: 0.894654
steps 5400    running time 232 seconds

steps 5600    base_loss: 0.170153    reg_loss: 0.067052    l2_loss: 0.021958    loss: 0.259163
steps 5600    v_Prec: 0.722496  v_Recall: 0.641152  v_F1: 0.679398  v_AUC: 0.891933
steps 5600    running time 239 seconds

steps 5800    base_loss: 0.179698    reg_loss: 0.066900    l2_loss: 0.022800    loss: 0.269399
steps 5800    v_Prec: 0.736056  v_Recall: 0.623727  v_F1: 0.675252  v_AUC: 0.888995
steps 5800    running time 246 seconds

steps 6000    base_loss: 0.177615    reg_loss: 0.066538    l2_loss: 0.023549    loss: 0.267702
steps 6000    v_Prec: 0.768316  v_Recall: 0.601607  v_F1: 0.674818  v_AUC: 0.888722
steps 6000    running time 253 seconds

steps 6200    base_loss: 0.183623    reg_loss: 0.066959    l2_loss: 0.024223    loss: 0.274806
steps 6200    v_Prec: 0.748214  v_Recall: 0.625159  v_F1: 0.681174  v_AUC: 0.890491
steps 6200    running time 259 seconds

steps 6400    base_loss: 0.175098    reg_loss: 0.066564    l2_loss: 0.024798    loss: 0.266460
steps 6400    v_Prec: 0.742174  v_Recall: 0.622533  v_F1: 0.677109  v_AUC: 0.891042
steps 6400    running time 266 seconds

steps 6600    base_loss: 0.179146    reg_loss: 0.066579    l2_loss: 0.025284    loss: 0.271009
steps 6600    v_Prec: 0.762053  v_Recall: 0.621260  v_F1: 0.684492  v_AUC: 0.892045
steps 6600    running time 273 seconds

steps 6800    base_loss: 0.183040    reg_loss: 0.066686    l2_loss: 0.025834    loss: 0.275559
steps 6800    v_Prec: 0.752716  v_Recall: 0.639402  v_F1: 0.691447  v_AUC: 0.893600
steps 6800    running time 280 seconds

steps 7000    base_loss: 0.182626    reg_loss: 0.066761    l2_loss: 0.026215    loss: 0.275602
steps 7000    v_Prec: 0.738195  v_Recall: 0.644335  v_F1: 0.688079  v_AUC: 0.894049
steps 7000    running time 288 seconds

steps 7200    base_loss: 0.190386    reg_loss: 0.066939    l2_loss: 0.026529    loss: 0.283854
steps 7200    v_Prec: 0.755903  v_Recall: 0.639402  v_F1: 0.692788  v_AUC: 0.895598
steps 7200    running time 295 seconds

steps 7400    base_loss: 0.184351    reg_loss: 0.066624    l2_loss: 0.026966    loss: 0.277942
steps 7400    v_Prec: 0.788711  v_Recall: 0.619271  v_F1: 0.693796  v_AUC: 0.897071
steps 7400    running time 302 seconds

steps 7600    base_loss: 0.187766    reg_loss: 0.066652    l2_loss: 0.027308    loss: 0.281726
steps 7600    v_Prec: 0.780766  v_Recall: 0.637572  v_F1: 0.701940  v_AUC: 0.897858
steps 7600    running time 309 seconds

steps 7800    base_loss: 0.190470    reg_loss: 0.066704    l2_loss: 0.027622    loss: 0.284797
steps 7800    v_Prec: 0.774142  v_Recall: 0.651257  v_F1: 0.707402  v_AUC: 0.899666
steps 7800    running time 317 seconds

steps 8000    base_loss: 0.189226    reg_loss: 0.066810    l2_loss: 0.027910    loss: 0.283946
steps 8000    v_Prec: 0.778709  v_Recall: 0.643141  v_F1: 0.704462  v_AUC: 0.901304
steps 8000    running time 324 seconds

steps 8200    base_loss: 0.190994    reg_loss: 0.066682    l2_loss: 0.028221    loss: 0.285898
steps 8200    v_Prec: 0.784660  v_Recall: 0.647120  v_F1: 0.709284  v_AUC: 0.902882
steps 8200    running time 331 seconds

steps 8400    base_loss: 0.185309    reg_loss: 0.066594    l2_loss: 0.028367    loss: 0.280269
steps 8400    v_Prec: 0.793404  v_Recall: 0.650859  v_F1: 0.715097  v_AUC: 0.904532
steps 8400    running time 339 seconds

steps 8600    base_loss: 0.185013    reg_loss: 0.066478    l2_loss: 0.028549    loss: 0.280040
steps 8600    v_Prec: 0.794357  v_Recall: 0.651894  v_F1: 0.716109  v_AUC: 0.905765
steps 8600    running time 346 seconds

steps 8800    base_loss: 0.181475    reg_loss: 0.066525    l2_loss: 0.028850    loss: 0.276851
steps 8800    v_Prec: 0.811467  v_Recall: 0.648631  v_F1: 0.720969  v_AUC: 0.905253
steps 8800    running time 353 seconds

steps 9000    base_loss: 0.184818    reg_loss: 0.066642    l2_loss: 0.029095    loss: 0.280555
steps 9000    v_Prec: 0.780315  v_Recall: 0.674332  v_F1: 0.723462  v_AUC: 0.906579
steps 9000    running time 360 seconds

steps 9200    base_loss: 0.183516    reg_loss: 0.066335    l2_loss: 0.029246    loss: 0.279098
steps 9200    v_Prec: 0.810994  v_Recall: 0.656190  v_F1: 0.725426  v_AUC: 0.907435
steps 9200    running time 368 seconds

steps 9400    base_loss: 0.178627    reg_loss: 0.066236    l2_loss: 0.029372    loss: 0.274235
steps 9400    v_Prec: 0.782736  v_Recall: 0.681095  v_F1: 0.728387  v_AUC: 0.908755
steps 9400    running time 376 seconds

steps 9600    base_loss: 0.174030    reg_loss: 0.066465    l2_loss: 0.029573    loss: 0.270068
steps 9600    v_Prec: 0.777557  v_Recall: 0.685869  v_F1: 0.728841  v_AUC: 0.908384
steps 9600    running time 383 seconds

steps 9800    base_loss: 0.188673    reg_loss: 0.066463    l2_loss: 0.029683    loss: 0.284820
steps 9800    v_Prec: 0.819756  v_Recall: 0.662954  v_F1: 0.733064  v_AUC: 0.911736
steps 9800    running time 391 seconds

steps 10000    base_loss: 0.190756    reg_loss: 0.065984    l2_loss: 0.029893    loss: 0.286632
steps 10000    v_Prec: 0.805173  v_Recall: 0.678708  v_F1: 0.736551  v_AUC: 0.913739
steps 10000    running time 398 seconds

steps 10200    base_loss: 0.171633    reg_loss: 0.066381    l2_loss: 0.030042    loss: 0.268057
steps 10200    v_Prec: 0.829418  v_Recall: 0.668523  v_F1: 0.740330  v_AUC: 0.914126
steps 10200    running time 405 seconds

steps 10400    base_loss: 0.188852    reg_loss: 0.066454    l2_loss: 0.030088    loss: 0.285394
steps 10400    v_Prec: 0.813998  v_Recall: 0.683880  v_F1: 0.743287  v_AUC: 0.914264
steps 10400    running time 413 seconds

steps 10600    base_loss: 0.178966    reg_loss: 0.066092    l2_loss: 0.030296    loss: 0.275355
steps 10600    v_Prec: 0.808616  v_Recall: 0.691518  v_F1: 0.745497  v_AUC: 0.916068
steps 10600    running time 420 seconds

steps 10800    base_loss: 0.164562    reg_loss: 0.065870    l2_loss: 0.030405    loss: 0.260838
steps 10800    v_Prec: 0.820260  v_Recall: 0.682288  v_F1: 0.744940  v_AUC: 0.915259
steps 10800    running time 428 seconds

steps 11000    base_loss: 0.071951    reg_loss: 0.063556    l2_loss: 0.030409    loss: 0.165916
steps 11000    v_Prec: 0.824779  v_Recall: 0.667409  v_F1: 0.737796  v_AUC: 0.912573
steps 11000    running time 434 seconds

steps 11200    base_loss: 0.069008    reg_loss: 0.063415    l2_loss: 0.030234    loss: 0.162658
steps 11200    v_Prec: 0.806554  v_Recall: 0.667807  v_F1: 0.730652  v_AUC: 0.908739
steps 11200    running time 441 seconds

steps 11400    base_loss: 0.068225    reg_loss: 0.063353    l2_loss: 0.030107    loss: 0.161685
steps 11400    v_Prec: 0.793463  v_Recall: 0.672183  v_F1: 0.727805  v_AUC: 0.905585
steps 11400    running time 448 seconds

steps 11600    base_loss: 0.071663    reg_loss: 0.063303    l2_loss: 0.030183    loss: 0.165149
steps 11600    v_Prec: 0.813120  v_Recall: 0.651894  v_F1: 0.723635  v_AUC: 0.904322
steps 11600    running time 455 seconds

steps 11800    base_loss: 0.069167    reg_loss: 0.063064    l2_loss: 0.030088    loss: 0.162320
steps 11800    v_Prec: 0.801098  v_Recall: 0.673297  v_F1: 0.731659  v_AUC: 0.904134
steps 11800    running time 462 seconds

steps 12000    base_loss: 0.074985    reg_loss: 0.063108    l2_loss: 0.030104    loss: 0.168197
steps 12000    v_Prec: 0.810236  v_Recall: 0.663829  v_F1: 0.729762  v_AUC: 0.902493
steps 12000    running time 469 seconds

steps 12200    base_loss: 0.074738    reg_loss: 0.063421    l2_loss: 0.030041    loss: 0.168200
steps 12200    v_Prec: 0.815701  v_Recall: 0.658896  v_F1: 0.728961  v_AUC: 0.902869
steps 12200    running time 476 seconds

steps 12400    base_loss: 0.076519    reg_loss: 0.063108    l2_loss: 0.030050    loss: 0.169677
steps 12400    v_Prec: 0.808452  v_Recall: 0.654519  v_F1: 0.723387  v_AUC: 0.901600
steps 12400    running time 482 seconds

steps 12600    base_loss: 0.078869    reg_loss: 0.063438    l2_loss: 0.030046    loss: 0.172353
steps 12600    v_Prec: 0.795647  v_Recall: 0.666057  v_F1: 0.725107  v_AUC: 0.901687
steps 12600    running time 489 seconds

Early stop model F1: 0.745497
testing thre: 0.402433
testing Prec: 0.6313548496976923
testing Recall: 0.7206804374240583
testing F1: 0.6730668845464242
testing AUC: 0.902518058847033
overall running time 492 seconds
(0.7535399488200171, 0.644034021871203, 0.694496855345912, 0.902518058847033, 0.63070315)

2019-02-24 19:23:24.630995: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:23:26.818591: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:23:26.823455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:23:26.823504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.660000 seconds
loading data in 30.780000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.647125    reg_loss: 0.065022    l2_loss: 0.013375    loss: 0.725522
steps 200    v_Prec: 0.163494  v_Recall: 0.999920  v_F1: 0.281036  v_AUC: 0.514007
steps 200    running time 42 seconds

steps 400    base_loss: 0.535883    reg_loss: 0.064690    l2_loss: 0.013478    loss: 0.614051
steps 400    v_Prec: 0.164082  v_Recall: 0.984597  v_F1: 0.281288  v_AUC: 0.520885
steps 400    running time 50 seconds

steps 600    base_loss: 0.488836    reg_loss: 0.064436    l2_loss: 0.013411    loss: 0.566682
steps 600    v_Prec: 0.164446  v_Recall: 0.986752  v_F1: 0.281910  v_AUC: 0.518790
steps 600    running time 57 seconds

steps 800    base_loss: 0.480313    reg_loss: 0.064140    l2_loss: 0.013209    loss: 0.557662
steps 800    v_Prec: 0.163793  v_Recall: 0.996249  v_F1: 0.281332  v_AUC: 0.499466
steps 800    running time 65 seconds

steps 1000    base_loss: 0.473423    reg_loss: 0.064068    l2_loss: 0.012850    loss: 0.550341
steps 1000    v_Prec: 0.163514  v_Recall: 0.999681  v_F1: 0.281057  v_AUC: 0.520177
steps 1000    running time 72 seconds

steps 1200    base_loss: 0.458918    reg_loss: 0.063842    l2_loss: 0.012530    loss: 0.535290
steps 1200    v_Prec: 0.293219  v_Recall: 0.407582  v_F1: 0.341069  v_AUC: 0.637447
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.429416    reg_loss: 0.063656    l2_loss: 0.012371    loss: 0.505444
steps 1400    v_Prec: 0.435485  v_Recall: 0.466800  v_F1: 0.450599  v_AUC: 0.749946
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.391075    reg_loss: 0.063803    l2_loss: 0.012391    loss: 0.467269
steps 1600    v_Prec: 0.521008  v_Recall: 0.504709  v_F1: 0.512729  v_AUC: 0.796452
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.362865    reg_loss: 0.064583    l2_loss: 0.012504    loss: 0.439953
steps 1800    v_Prec: 0.587032  v_Recall: 0.528891  v_F1: 0.556447  v_AUC: 0.824128
steps 1800    running time 101 seconds

steps 2000    base_loss: 0.335298    reg_loss: 0.065025    l2_loss: 0.012749    loss: 0.413072
steps 2000    v_Prec: 0.624455  v_Recall: 0.548204  v_F1: 0.583850  v_AUC: 0.842646
steps 2000    running time 109 seconds

steps 2200    base_loss: 0.323823    reg_loss: 0.065302    l2_loss: 0.013068    loss: 0.402193
steps 2200    v_Prec: 0.626333  v_Recall: 0.581245  v_F1: 0.602947  v_AUC: 0.852826
steps 2200    running time 116 seconds

steps 2400    base_loss: 0.307424    reg_loss: 0.065723    l2_loss: 0.013389    loss: 0.386536
steps 2400    v_Prec: 0.643221  v_Recall: 0.594812  v_F1: 0.618070  v_AUC: 0.860773
steps 2400    running time 124 seconds

steps 2600    base_loss: 0.302904    reg_loss: 0.066145    l2_loss: 0.013719    loss: 0.382768
steps 2600    v_Prec: 0.656535  v_Recall: 0.596488  v_F1: 0.625073  v_AUC: 0.868557
steps 2600    running time 131 seconds

steps 2800    base_loss: 0.298262    reg_loss: 0.066465    l2_loss: 0.014119    loss: 0.378845
steps 2800    v_Prec: 0.658368  v_Recall: 0.614126  v_F1: 0.635478  v_AUC: 0.874138
steps 2800    running time 139 seconds

steps 3000    base_loss: 0.297717    reg_loss: 0.066796    l2_loss: 0.014515    loss: 0.379028
steps 3000    v_Prec: 0.651898  v_Recall: 0.631764  v_F1: 0.641673  v_AUC: 0.878964
steps 3000    running time 146 seconds

steps 3200    base_loss: 0.284188    reg_loss: 0.066869    l2_loss: 0.014898    loss: 0.365956
steps 3200    v_Prec: 0.700889  v_Recall: 0.604230  v_F1: 0.648980  v_AUC: 0.884479
steps 3200    running time 153 seconds

steps 3400    base_loss: 0.289251    reg_loss: 0.067082    l2_loss: 0.015280    loss: 0.371612
steps 3400    v_Prec: 0.672313  v_Recall: 0.643017  v_F1: 0.657339  v_AUC: 0.888062
steps 3400    running time 161 seconds

steps 3600    base_loss: 0.282121    reg_loss: 0.067217    l2_loss: 0.015717    loss: 0.365055
steps 3600    v_Prec: 0.699397  v_Recall: 0.629848  v_F1: 0.662803  v_AUC: 0.891217
steps 3600    running time 168 seconds

steps 3800    base_loss: 0.273660    reg_loss: 0.067111    l2_loss: 0.016164    loss: 0.356935
steps 3800    v_Prec: 0.692100  v_Recall: 0.635595  v_F1: 0.662645  v_AUC: 0.891060
steps 3800    running time 176 seconds

steps 4000    base_loss: 0.275790    reg_loss: 0.067243    l2_loss: 0.016697    loss: 0.359730
steps 4000    v_Prec: 0.698763  v_Recall: 0.635914  v_F1: 0.665859  v_AUC: 0.894589
steps 4000    running time 183 seconds

steps 4200    base_loss: 0.271964    reg_loss: 0.067386    l2_loss: 0.017185    loss: 0.356534
steps 4200    v_Prec: 0.689471  v_Recall: 0.649082  v_F1: 0.668667  v_AUC: 0.896504
steps 4200    running time 190 seconds

steps 4400    base_loss: 0.272234    reg_loss: 0.067282    l2_loss: 0.017702    loss: 0.357218
steps 4400    v_Prec: 0.690155  v_Recall: 0.649561  v_F1: 0.669243  v_AUC: 0.896928
steps 4400    running time 198 seconds

steps 4600    base_loss: 0.269307    reg_loss: 0.067359    l2_loss: 0.018273    loss: 0.354939
steps 4600    v_Prec: 0.705484  v_Recall: 0.648843  v_F1: 0.675979  v_AUC: 0.900505
steps 4600    running time 205 seconds

steps 4800    base_loss: 0.268447    reg_loss: 0.067298    l2_loss: 0.018946    loss: 0.354690
steps 4800    v_Prec: 0.697006  v_Recall: 0.653951  v_F1: 0.674792  v_AUC: 0.901831
steps 4800    running time 213 seconds

steps 5000    base_loss: 0.269641    reg_loss: 0.067188    l2_loss: 0.019568    loss: 0.356397
steps 5000    v_Prec: 0.714937  v_Recall: 0.638707  v_F1: 0.674675  v_AUC: 0.901847
steps 5000    running time 220 seconds

steps 5200    base_loss: 0.268289    reg_loss: 0.067421    l2_loss: 0.020117    loss: 0.355827
steps 5200    v_Prec: 0.690506  v_Recall: 0.668077  v_F1: 0.679106  v_AUC: 0.904308
steps 5200    running time 226 seconds

steps 5400    base_loss: 0.256859    reg_loss: 0.067360    l2_loss: 0.020854    loss: 0.345073
steps 5400    v_Prec: 0.731113  v_Recall: 0.634078  v_F1: 0.679147  v_AUC: 0.905731
steps 5400    running time 234 seconds

steps 5600    base_loss: 0.184359    reg_loss: 0.068053    l2_loss: 0.021623    loss: 0.274035
steps 5600    v_Prec: 0.705607  v_Recall: 0.649800  v_F1: 0.676555  v_AUC: 0.902083
steps 5600    running time 241 seconds

steps 5800    base_loss: 0.176133    reg_loss: 0.068141    l2_loss: 0.022537    loss: 0.266811
steps 5800    v_Prec: 0.700224  v_Recall: 0.647247  v_F1: 0.672694  v_AUC: 0.901456
steps 5800    running time 248 seconds

steps 6000    base_loss: 0.168155    reg_loss: 0.067879    l2_loss: 0.023332    loss: 0.259367
steps 6000    v_Prec: 0.701447  v_Recall: 0.645970  v_F1: 0.672566  v_AUC: 0.898400
steps 6000    running time 255 seconds

steps 6200    base_loss: 0.183962    reg_loss: 0.067865    l2_loss: 0.024035    loss: 0.275862
steps 6200    v_Prec: 0.687691  v_Recall: 0.663927  v_F1: 0.675600  v_AUC: 0.898643
steps 6200    running time 261 seconds

steps 6400    base_loss: 0.176101    reg_loss: 0.067984    l2_loss: 0.024632    loss: 0.268717
steps 6400    v_Prec: 0.708735  v_Recall: 0.644932  v_F1: 0.675330  v_AUC: 0.898696
steps 6400    running time 268 seconds

steps 6600    base_loss: 0.174002    reg_loss: 0.067839    l2_loss: 0.025157    loss: 0.266998
steps 6600    v_Prec: 0.702367  v_Recall: 0.658420  v_F1: 0.679684  v_AUC: 0.900001
steps 6600    running time 275 seconds

steps 6800    base_loss: 0.186506    reg_loss: 0.067796    l2_loss: 0.025745    loss: 0.280046
steps 6800    v_Prec: 0.722978  v_Recall: 0.640064  v_F1: 0.678999  v_AUC: 0.901040
steps 6800    running time 282 seconds

steps 7000    base_loss: 0.186777    reg_loss: 0.067852    l2_loss: 0.026251    loss: 0.280880
steps 7000    v_Prec: 0.708895  v_Recall: 0.650678  v_F1: 0.678540  v_AUC: 0.900865
steps 7000    running time 289 seconds

steps 7200    base_loss: 0.181305    reg_loss: 0.067811    l2_loss: 0.026704    loss: 0.275821
steps 7200    v_Prec: 0.710886  v_Recall: 0.655626  v_F1: 0.682139  v_AUC: 0.901654
steps 7200    running time 296 seconds

steps 7400    base_loss: 0.189189    reg_loss: 0.067727    l2_loss: 0.027079    loss: 0.283995
steps 7400    v_Prec: 0.711395  v_Recall: 0.662171  v_F1: 0.685901  v_AUC: 0.902681
steps 7400    running time 304 seconds

steps 7600    base_loss: 0.182399    reg_loss: 0.067858    l2_loss: 0.027589    loss: 0.277846
steps 7600    v_Prec: 0.719736  v_Recall: 0.653392  v_F1: 0.684961  v_AUC: 0.902245
steps 7600    running time 311 seconds

steps 7800    base_loss: 0.185740    reg_loss: 0.067494    l2_loss: 0.027982    loss: 0.281215
steps 7800    v_Prec: 0.710848  v_Recall: 0.667279  v_F1: 0.688375  v_AUC: 0.904394
steps 7800    running time 318 seconds

steps 8000    base_loss: 0.190006    reg_loss: 0.067655    l2_loss: 0.028244    loss: 0.285905
steps 8000    v_Prec: 0.736723  v_Recall: 0.650998  v_F1: 0.691213  v_AUC: 0.906515
steps 8000    running time 326 seconds

steps 8200    base_loss: 0.183358    reg_loss: 0.067528    l2_loss: 0.028429    loss: 0.279315
steps 8200    v_Prec: 0.734972  v_Recall: 0.658659  v_F1: 0.694726  v_AUC: 0.907991
steps 8200    running time 333 seconds

steps 8400    base_loss: 0.182140    reg_loss: 0.067571    l2_loss: 0.028864    loss: 0.278576
steps 8400    v_Prec: 0.743446  v_Recall: 0.654030  v_F1: 0.695877  v_AUC: 0.909137
steps 8400    running time 341 seconds

steps 8600    base_loss: 0.185900    reg_loss: 0.067710    l2_loss: 0.029068    loss: 0.282679
steps 8600    v_Prec: 0.736763  v_Recall: 0.662969  v_F1: 0.697921  v_AUC: 0.910644
steps 8600    running time 348 seconds

steps 8800    base_loss: 0.185355    reg_loss: 0.067435    l2_loss: 0.029381    loss: 0.282171
steps 8800    v_Prec: 0.725725  v_Recall: 0.673424  v_F1: 0.698597  v_AUC: 0.911510
steps 8800    running time 356 seconds

steps 9000    base_loss: 0.191044    reg_loss: 0.067494    l2_loss: 0.029625    loss: 0.288163
steps 9000    v_Prec: 0.732106  v_Recall: 0.675898  v_F1: 0.702880  v_AUC: 0.913178
steps 9000    running time 363 seconds

steps 9200    base_loss: 0.187416    reg_loss: 0.067718    l2_loss: 0.029970    loss: 0.285103
steps 9200    v_Prec: 0.734917  v_Recall: 0.681484  v_F1: 0.707193  v_AUC: 0.915001
steps 9200    running time 370 seconds

steps 9400    base_loss: 0.186635    reg_loss: 0.067450    l2_loss: 0.030243    loss: 0.284328
steps 9400    v_Prec: 0.716437  v_Recall: 0.698484  v_F1: 0.707347  v_AUC: 0.915731
steps 9400    running time 378 seconds

steps 9600    base_loss: 0.186136    reg_loss: 0.067437    l2_loss: 0.030452    loss: 0.284024
steps 9600    v_Prec: 0.744504  v_Recall: 0.686512  v_F1: 0.714333  v_AUC: 0.917299
steps 9600    running time 386 seconds

steps 9800    base_loss: 0.197278    reg_loss: 0.067411    l2_loss: 0.030601    loss: 0.295289
steps 9800    v_Prec: 0.734736  v_Recall: 0.702075  v_F1: 0.718035  v_AUC: 0.918986
steps 9800    running time 393 seconds

steps 10000    base_loss: 0.188269    reg_loss: 0.067250    l2_loss: 0.030896    loss: 0.286416
steps 10000    v_Prec: 0.745029  v_Recall: 0.696808  v_F1: 0.720112  v_AUC: 0.920913
steps 10000    running time 401 seconds

steps 10200    base_loss: 0.181547    reg_loss: 0.067272    l2_loss: 0.031067    loss: 0.279887
steps 10200    v_Prec: 0.728313  v_Recall: 0.716281  v_F1: 0.722247  v_AUC: 0.921897
steps 10200    running time 408 seconds

steps 10400    base_loss: 0.183785    reg_loss: 0.067244    l2_loss: 0.031295    loss: 0.282324
steps 10400    v_Prec: 0.773064  v_Recall: 0.683480  v_F1: 0.725517  v_AUC: 0.923670
steps 10400    running time 416 seconds

steps 10600    base_loss: 0.180238    reg_loss: 0.067261    l2_loss: 0.031517    loss: 0.279016
steps 10600    v_Prec: 0.766095  v_Recall: 0.691381  v_F1: 0.726823  v_AUC: 0.923606
steps 10600    running time 423 seconds

steps 10800    base_loss: 0.166399    reg_loss: 0.067148    l2_loss: 0.031744    loss: 0.265291
steps 10800    v_Prec: 0.761194  v_Recall: 0.696010  v_F1: 0.727144  v_AUC: 0.924129
steps 10800    running time 431 seconds

steps 11000    base_loss: 0.069875    reg_loss: 0.066906    l2_loss: 0.031941    loss: 0.168722
steps 11000    v_Prec: 0.742250  v_Recall: 0.686034  v_F1: 0.713036  v_AUC: 0.917389
steps 11000    running time 438 seconds

steps 11200    base_loss: 0.067034    reg_loss: 0.066525    l2_loss: 0.031903    loss: 0.165462
steps 11200    v_Prec: 0.746037  v_Recall: 0.672386  v_F1: 0.707300  v_AUC: 0.914215
steps 11200    running time 445 seconds

steps 11400    base_loss: 0.071826    reg_loss: 0.066454    l2_loss: 0.031952    loss: 0.170233
steps 11400    v_Prec: 0.739031  v_Recall: 0.673504  v_F1: 0.704748  v_AUC: 0.911922
steps 11400    running time 452 seconds

steps 11600    base_loss: 0.076042    reg_loss: 0.066290    l2_loss: 0.032000    loss: 0.174332
steps 11600    v_Prec: 0.729487  v_Recall: 0.674062  v_F1: 0.700680  v_AUC: 0.907708
steps 11600    running time 459 seconds

steps 11800    base_loss: 0.071861    reg_loss: 0.066247    l2_loss: 0.032086    loss: 0.170195
steps 11800    v_Prec: 0.719026  v_Recall: 0.676217  v_F1: 0.696965  v_AUC: 0.907063
steps 11800    running time 465 seconds

steps 12000    base_loss: 0.080540    reg_loss: 0.066408    l2_loss: 0.032196    loss: 0.179144
steps 12000    v_Prec: 0.737817  v_Recall: 0.660974  v_F1: 0.697285  v_AUC: 0.904727
steps 12000    running time 472 seconds

steps 12200    base_loss: 0.074584    reg_loss: 0.066065    l2_loss: 0.032385    loss: 0.173034
steps 12200    v_Prec: 0.745272  v_Recall: 0.650998  v_F1: 0.694952  v_AUC: 0.904222
steps 12200    running time 479 seconds

steps 12400    base_loss: 0.075806    reg_loss: 0.066054    l2_loss: 0.032432    loss: 0.174292
steps 12400    v_Prec: 0.717949  v_Recall: 0.670391  v_F1: 0.693355  v_AUC: 0.905000
steps 12400    running time 485 seconds

steps 12600    base_loss: 0.085571    reg_loss: 0.066196    l2_loss: 0.032490    loss: 0.184257
steps 12600    v_Prec: 0.722814  v_Recall: 0.665762  v_F1: 0.693116  v_AUC: 0.904464
steps 12600    running time 492 seconds

steps 12800    base_loss: 0.083614    reg_loss: 0.066037    l2_loss: 0.032641    loss: 0.182292
steps 12800    v_Prec: 0.714165  v_Recall: 0.671987  v_F1: 0.692434  v_AUC: 0.903450
steps 12800    running time 499 seconds

Early stop model F1: 0.727144
testing thre: 0.32152557
testing Prec: 0.5516971186380312
testing Recall: 0.7528554070473876
testing F1: 0.6367672449231275
testing AUC: 0.9014698171088416
overall running time 502 seconds
(0.720631013649586, 0.6260996354799514, 0.6700475930404931, 0.9014698171088416, 0.6723601)

2019-02-24 19:29:19.712815: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:29:21.477247: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:29:21.480077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:29:21.480122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.470000 seconds
loading data in 29.670000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.416383    reg_loss: 0.064830    l2_loss: 0.013290    loss: 1.494503
steps 200    v_Prec: 0.163487  v_Recall: 1.000000  v_F1: 0.281030  v_AUC: 0.488262
steps 200    running time 40 seconds

steps 400    base_loss: 0.935423    reg_loss: 0.064935    l2_loss: 0.013099    loss: 1.013457
steps 400    v_Prec: 0.163487  v_Recall: 1.000000  v_F1: 0.281030  v_AUC: 0.463831
steps 400    running time 48 seconds

steps 600    base_loss: 0.507863    reg_loss: 0.065370    l2_loss: 0.013003    loss: 0.586237
steps 600    v_Prec: 0.163487  v_Recall: 1.000000  v_F1: 0.281030  v_AUC: 0.497251
steps 600    running time 55 seconds

steps 800    base_loss: 0.465626    reg_loss: 0.065242    l2_loss: 0.012979    loss: 0.543847
steps 800    v_Prec: 0.163500  v_Recall: 1.000000  v_F1: 0.281049  v_AUC: 0.536659
steps 800    running time 62 seconds

steps 1000    base_loss: 0.462587    reg_loss: 0.065049    l2_loss: 0.012834    loss: 0.540470
steps 1000    v_Prec: 0.205550  v_Recall: 0.507821  v_F1: 0.292646  v_AUC: 0.580207
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.449571    reg_loss: 0.064834    l2_loss: 0.012686    loss: 0.527091
steps 1200    v_Prec: 0.302815  v_Recall: 0.414685  v_F1: 0.350029  v_AUC: 0.655634
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.444679    reg_loss: 0.064958    l2_loss: 0.012606    loss: 0.522243
steps 1400    v_Prec: 0.437107  v_Recall: 0.415722  v_F1: 0.426146  v_AUC: 0.726760
steps 1400    running time 85 seconds

steps 1600    base_loss: 0.430026    reg_loss: 0.065215    l2_loss: 0.012544    loss: 0.507784
steps 1600    v_Prec: 0.509385  v_Recall: 0.452674  v_F1: 0.479358  v_AUC: 0.766043
steps 1600    running time 93 seconds

steps 1800    base_loss: 0.409467    reg_loss: 0.065461    l2_loss: 0.012581    loss: 0.487509
steps 1800    v_Prec: 0.530710  v_Recall: 0.512370  v_F1: 0.521379  v_AUC: 0.793764
steps 1800    running time 100 seconds

steps 2000    base_loss: 0.391269    reg_loss: 0.065891    l2_loss: 0.012634    loss: 0.469794
steps 2000    v_Prec: 0.563423  v_Recall: 0.520750  v_F1: 0.541247  v_AUC: 0.814881
steps 2000    running time 108 seconds

steps 2200    base_loss: 0.372070    reg_loss: 0.066328    l2_loss: 0.012823    loss: 0.451221
steps 2200    v_Prec: 0.595795  v_Recall: 0.538308  v_F1: 0.565595  v_AUC: 0.835369
steps 2200    running time 115 seconds

steps 2400    base_loss: 0.353621    reg_loss: 0.066689    l2_loss: 0.013143    loss: 0.433452
steps 2400    v_Prec: 0.572350  v_Recall: 0.601995  v_F1: 0.586798  v_AUC: 0.850181
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.328135    reg_loss: 0.066884    l2_loss: 0.013485    loss: 0.408504
steps 2600    v_Prec: 0.633249  v_Recall: 0.578212  v_F1: 0.604480  v_AUC: 0.860577
steps 2600    running time 130 seconds

steps 2800    base_loss: 0.318328    reg_loss: 0.067409    l2_loss: 0.013993    loss: 0.399730
steps 2800    v_Prec: 0.661241  v_Recall: 0.573903  v_F1: 0.614484  v_AUC: 0.866404
steps 2800    running time 138 seconds

steps 3000    base_loss: 0.302671    reg_loss: 0.067364    l2_loss: 0.014509    loss: 0.384545
steps 3000    v_Prec: 0.676031  v_Recall: 0.574222  v_F1: 0.620981  v_AUC: 0.870005
steps 3000    running time 145 seconds

steps 3200    base_loss: 0.296918    reg_loss: 0.067430    l2_loss: 0.014986    loss: 0.379335
steps 3200    v_Prec: 0.641889  v_Recall: 0.616121  v_F1: 0.628741  v_AUC: 0.873312
steps 3200    running time 153 seconds

steps 3400    base_loss: 0.289917    reg_loss: 0.067727    l2_loss: 0.015551    loss: 0.373195
steps 3400    v_Prec: 0.696232  v_Recall: 0.595770  v_F1: 0.642095  v_AUC: 0.878101
steps 3400    running time 160 seconds

steps 3600    base_loss: 0.288606    reg_loss: 0.067773    l2_loss: 0.016111    loss: 0.372490
steps 3600    v_Prec: 0.668815  v_Recall: 0.629370  v_F1: 0.648493  v_AUC: 0.880981
steps 3600    running time 168 seconds

steps 3800    base_loss: 0.286746    reg_loss: 0.067905    l2_loss: 0.016645    loss: 0.371296
steps 3800    v_Prec: 0.697319  v_Recall: 0.618516  v_F1: 0.655557  v_AUC: 0.883677
steps 3800    running time 176 seconds

steps 4000    base_loss: 0.282986    reg_loss: 0.067852    l2_loss: 0.017230    loss: 0.368068
steps 4000    v_Prec: 0.705414  v_Recall: 0.615563  v_F1: 0.657433  v_AUC: 0.887028
steps 4000    running time 183 seconds

steps 4200    base_loss: 0.290117    reg_loss: 0.068225    l2_loss: 0.017829    loss: 0.376172
steps 4200    v_Prec: 0.689631  v_Recall: 0.634318  v_F1: 0.660819  v_AUC: 0.889795
steps 4200    running time 191 seconds

steps 4400    base_loss: 0.274011    reg_loss: 0.068203    l2_loss: 0.018442    loss: 0.360655
steps 4400    v_Prec: 0.695927  v_Recall: 0.640942  v_F1: 0.667304  v_AUC: 0.892662
steps 4400    running time 198 seconds

steps 4600    base_loss: 0.277741    reg_loss: 0.068156    l2_loss: 0.019061    loss: 0.364957
steps 4600    v_Prec: 0.733812  v_Recall: 0.612291  v_F1: 0.667566  v_AUC: 0.894628
steps 4600    running time 205 seconds

steps 4800    base_loss: 0.268715    reg_loss: 0.068025    l2_loss: 0.019686    loss: 0.356427
steps 4800    v_Prec: 0.722946  v_Recall: 0.624342  v_F1: 0.670036  v_AUC: 0.896400
steps 4800    running time 213 seconds

steps 5000    base_loss: 0.272392    reg_loss: 0.067858    l2_loss: 0.020253    loss: 0.360504
steps 5000    v_Prec: 0.718962  v_Recall: 0.634557  v_F1: 0.674128  v_AUC: 0.898767
steps 5000    running time 220 seconds

steps 5200    base_loss: 0.264206    reg_loss: 0.067790    l2_loss: 0.020890    loss: 0.352885
steps 5200    v_Prec: 0.742977  v_Recall: 0.622666  v_F1: 0.677522  v_AUC: 0.899701
steps 5200    running time 228 seconds

steps 5400    base_loss: 0.259137    reg_loss: 0.067887    l2_loss: 0.021641    loss: 0.348665
steps 5400    v_Prec: 0.705580  v_Recall: 0.657941  v_F1: 0.680928  v_AUC: 0.901731
steps 5400    running time 235 seconds

steps 5600    base_loss: 0.172674    reg_loss: 0.067791    l2_loss: 0.022390    loss: 0.262855
steps 5600    v_Prec: 0.694261  v_Recall: 0.654589  v_F1: 0.673842  v_AUC: 0.898944
steps 5600    running time 243 seconds

steps 5800    base_loss: 0.176754    reg_loss: 0.067484    l2_loss: 0.023231    loss: 0.267468
steps 5800    v_Prec: 0.733017  v_Recall: 0.629529  v_F1: 0.677343  v_AUC: 0.895588
steps 5800    running time 249 seconds

steps 6000    base_loss: 0.184901    reg_loss: 0.067437    l2_loss: 0.023955    loss: 0.276294
steps 6000    v_Prec: 0.742506  v_Recall: 0.616760  v_F1: 0.673816  v_AUC: 0.896725
steps 6000    running time 256 seconds

steps 6200    base_loss: 0.184203    reg_loss: 0.067365    l2_loss: 0.024765    loss: 0.276334
steps 6200    v_Prec: 0.719378  v_Recall: 0.634637  v_F1: 0.674355  v_AUC: 0.898084
steps 6200    running time 263 seconds

steps 6400    base_loss: 0.189159    reg_loss: 0.067382    l2_loss: 0.025430    loss: 0.281972
steps 6400    v_Prec: 0.736064  v_Recall: 0.628093  v_F1: 0.677806  v_AUC: 0.898640
steps 6400    running time 270 seconds

steps 6600    base_loss: 0.189206    reg_loss: 0.067367    l2_loss: 0.026017    loss: 0.282590
steps 6600    v_Prec: 0.735888  v_Recall: 0.631524  v_F1: 0.679723  v_AUC: 0.899337
steps 6600    running time 277 seconds

steps 6800    base_loss: 0.184351    reg_loss: 0.067102    l2_loss: 0.026477    loss: 0.277931
steps 6800    v_Prec: 0.733149  v_Recall: 0.635435  v_F1: 0.680804  v_AUC: 0.900397
steps 6800    running time 284 seconds

steps 7000    base_loss: 0.188182    reg_loss: 0.067251    l2_loss: 0.026878    loss: 0.282311
steps 7000    v_Prec: 0.726792  v_Recall: 0.647326  v_F1: 0.684762  v_AUC: 0.901694
steps 7000    running time 290 seconds

steps 7200    base_loss: 0.193690    reg_loss: 0.067265    l2_loss: 0.027381    loss: 0.288336
steps 7200    v_Prec: 0.726295  v_Recall: 0.657781  v_F1: 0.690343  v_AUC: 0.903859
steps 7200    running time 297 seconds

steps 7400    base_loss: 0.187296    reg_loss: 0.067158    l2_loss: 0.027857    loss: 0.282311
steps 7400    v_Prec: 0.740114  v_Recall: 0.652753  v_F1: 0.693694  v_AUC: 0.904581
steps 7400    running time 305 seconds

steps 7600    base_loss: 0.194804    reg_loss: 0.067286    l2_loss: 0.028201    loss: 0.290291
steps 7600    v_Prec: 0.735871  v_Recall: 0.661931  v_F1: 0.696946  v_AUC: 0.906710
steps 7600    running time 313 seconds

steps 7800    base_loss: 0.185392    reg_loss: 0.066859    l2_loss: 0.028467    loss: 0.280718
steps 7800    v_Prec: 0.747798  v_Recall: 0.657382  v_F1: 0.699681  v_AUC: 0.907556
steps 7800    running time 320 seconds

steps 8000    base_loss: 0.181009    reg_loss: 0.066792    l2_loss: 0.028883    loss: 0.276683
steps 8000    v_Prec: 0.751354  v_Recall: 0.653073  v_F1: 0.698775  v_AUC: 0.907885
steps 8000    running time 328 seconds

steps 8200    base_loss: 0.191943    reg_loss: 0.066891    l2_loss: 0.029230    loss: 0.288064
steps 8200    v_Prec: 0.748214  v_Recall: 0.660255  v_F1: 0.701488  v_AUC: 0.909129
steps 8200    running time 334 seconds

steps 8400    base_loss: 0.182849    reg_loss: 0.066805    l2_loss: 0.029519    loss: 0.279173
steps 8400    v_Prec: 0.755935  v_Recall: 0.653073  v_F1: 0.700749  v_AUC: 0.908917
steps 8400    running time 342 seconds

steps 8600    base_loss: 0.181563    reg_loss: 0.066749    l2_loss: 0.030001    loss: 0.278313
steps 8600    v_Prec: 0.750134  v_Recall: 0.672306  v_F1: 0.709091  v_AUC: 0.912488
steps 8600    running time 348 seconds

steps 8800    base_loss: 0.189528    reg_loss: 0.066522    l2_loss: 0.030223    loss: 0.286273
steps 8800    v_Prec: 0.755095  v_Recall: 0.665363  v_F1: 0.707395  v_AUC: 0.912395
steps 8800    running time 356 seconds

steps 9000    base_loss: 0.188473    reg_loss: 0.066469    l2_loss: 0.030386    loss: 0.285328
steps 9000    v_Prec: 0.754422  v_Recall: 0.670551  v_F1: 0.710018  v_AUC: 0.914013
steps 9000    running time 363 seconds

steps 9200    base_loss: 0.184842    reg_loss: 0.066628    l2_loss: 0.030640    loss: 0.282109
steps 9200    v_Prec: 0.758448  v_Recall: 0.677095  v_F1: 0.715466  v_AUC: 0.914750
steps 9200    running time 370 seconds

steps 9400    base_loss: 0.188322    reg_loss: 0.066796    l2_loss: 0.030930    loss: 0.286048
steps 9400    v_Prec: 0.787026  v_Recall: 0.667119  v_F1: 0.722129  v_AUC: 0.917342
steps 9400    running time 378 seconds

steps 9600    base_loss: 0.178438    reg_loss: 0.066526    l2_loss: 0.031181    loss: 0.276144
steps 9600    v_Prec: 0.787244  v_Recall: 0.668875  v_F1: 0.723248  v_AUC: 0.918007
steps 9600    running time 386 seconds

steps 9800    base_loss: 0.180675    reg_loss: 0.066240    l2_loss: 0.031340    loss: 0.278254
steps 9800    v_Prec: 0.777900  v_Recall: 0.674781  v_F1: 0.722680  v_AUC: 0.918002
steps 9800    running time 393 seconds

steps 10000    base_loss: 0.192265    reg_loss: 0.066584    l2_loss: 0.031429    loss: 0.290279
steps 10000    v_Prec: 0.759661  v_Recall: 0.701277  v_F1: 0.729302  v_AUC: 0.920811
steps 10000    running time 400 seconds

steps 10200    base_loss: 0.178895    reg_loss: 0.066562    l2_loss: 0.031579    loss: 0.277036
steps 10200    v_Prec: 0.799465  v_Recall: 0.668476  v_F1: 0.728126  v_AUC: 0.921095
steps 10200    running time 407 seconds

steps 10400    base_loss: 0.176686    reg_loss: 0.066445    l2_loss: 0.031796    loss: 0.274927
steps 10400    v_Prec: 0.786794  v_Recall: 0.685634  v_F1: 0.732739  v_AUC: 0.922375
steps 10400    running time 414 seconds

steps 10600    base_loss: 0.188669    reg_loss: 0.066357    l2_loss: 0.032041    loss: 0.287067
steps 10600    v_Prec: 0.759563  v_Recall: 0.705188  v_F1: 0.731366  v_AUC: 0.923467
steps 10600    running time 422 seconds

steps 10800    base_loss: 0.167239    reg_loss: 0.066116    l2_loss: 0.032185    loss: 0.265540
steps 10800    v_Prec: 0.779982  v_Recall: 0.696568  v_F1: 0.735919  v_AUC: 0.925034
steps 10800    running time 428 seconds

steps 11000    base_loss: 0.077692    reg_loss: 0.065011    l2_loss: 0.032400    loss: 0.175103
steps 11000    v_Prec: 0.774726  v_Recall: 0.693296  v_F1: 0.731753  v_AUC: 0.922150
steps 11000    running time 436 seconds

steps 11200    base_loss: 0.074207    reg_loss: 0.064532    l2_loss: 0.032315    loss: 0.171054
steps 11200    v_Prec: 0.768046  v_Recall: 0.684437  v_F1: 0.723835  v_AUC: 0.917515
steps 11200    running time 443 seconds

steps 11400    base_loss: 0.077466    reg_loss: 0.064645    l2_loss: 0.032462    loss: 0.174574
steps 11400    v_Prec: 0.768488  v_Recall: 0.679250  v_F1: 0.721118  v_AUC: 0.915423
steps 11400    running time 449 seconds

steps 11600    base_loss: 0.081852    reg_loss: 0.064437    l2_loss: 0.032483    loss: 0.178772
steps 11600    v_Prec: 0.784222  v_Recall: 0.656105  v_F1: 0.714466  v_AUC: 0.911293
steps 11600    running time 456 seconds

steps 11800    base_loss: 0.078511    reg_loss: 0.064285    l2_loss: 0.032557    loss: 0.175353
steps 11800    v_Prec: 0.761120  v_Recall: 0.674621  v_F1: 0.715265  v_AUC: 0.910649
steps 11800    running time 463 seconds

steps 12000    base_loss: 0.083320    reg_loss: 0.064661    l2_loss: 0.032660    loss: 0.180640
steps 12000    v_Prec: 0.768312  v_Recall: 0.667199  v_F1: 0.714194  v_AUC: 0.909157
steps 12000    running time 470 seconds

steps 12200    base_loss: 0.080906    reg_loss: 0.064321    l2_loss: 0.032689    loss: 0.177916
steps 12200    v_Prec: 0.757002  v_Recall: 0.679489  v_F1: 0.716154  v_AUC: 0.910715
steps 12200    running time 477 seconds

steps 12400    base_loss: 0.084957    reg_loss: 0.064337    l2_loss: 0.032812    loss: 0.182105
steps 12400    v_Prec: 0.761406  v_Recall: 0.672626  v_F1: 0.714268  v_AUC: 0.907853
steps 12400    running time 483 seconds

steps 12600    base_loss: 0.082881    reg_loss: 0.064313    l2_loss: 0.032896    loss: 0.180090
steps 12600    v_Prec: 0.764173  v_Recall: 0.665922  v_F1: 0.711672  v_AUC: 0.908309
steps 12600    running time 490 seconds

steps 12800    base_loss: 0.087645    reg_loss: 0.064362    l2_loss: 0.032930    loss: 0.184937
steps 12800    v_Prec: 0.748107  v_Recall: 0.678132  v_F1: 0.711403  v_AUC: 0.907246
steps 12800    running time 497 seconds

Early stop model F1: 0.735919
testing thre: 0.3567508
testing Prec: 0.565926301677597
testing Recall: 0.7591251518833536
testing F1: 0.6484410677959065
testing AUC: 0.9066127067418632
overall running time 499 seconds
(0.7205509046718876, 0.648408262454435, 0.6825786646201074, 0.9066127067418632, 0.6448292)

2019-02-24 19:35:17.523696: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:35:18.780980: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:35:18.781907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:35:18.781941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.220000 seconds
loading data in 31.480000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.869651    reg_loss: 0.064805    l2_loss: 0.013291    loss: 0.947747
steps 200    v_Prec: 0.162691  v_Recall: 1.000000  v_F1: 0.279853  v_AUC: 0.483572
steps 200    running time 42 seconds

steps 400    base_loss: 0.628348    reg_loss: 0.064922    l2_loss: 0.013127    loss: 0.706397
steps 400    v_Prec: 0.162759  v_Recall: 0.999759  v_F1: 0.279943  v_AUC: 0.499959
steps 400    running time 50 seconds

steps 600    base_loss: 0.482543    reg_loss: 0.064639    l2_loss: 0.013145    loss: 0.560327
steps 600    v_Prec: 0.162704  v_Recall: 0.999920  v_F1: 0.279868  v_AUC: 0.513938
steps 600    running time 57 seconds

steps 800    base_loss: 0.467133    reg_loss: 0.064556    l2_loss: 0.013089    loss: 0.544778
steps 800    v_Prec: 0.163701  v_Recall: 0.981875  v_F1: 0.280616  v_AUC: 0.521407
steps 800    running time 64 seconds

steps 1000    base_loss: 0.467105    reg_loss: 0.064201    l2_loss: 0.012944    loss: 0.544250
steps 1000    v_Prec: 0.168913  v_Recall: 0.843211  v_F1: 0.281447  v_AUC: 0.538251
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.467322    reg_loss: 0.064040    l2_loss: 0.012760    loss: 0.544122
steps 1200    v_Prec: 0.174078  v_Recall: 0.799984  v_F1: 0.285935  v_AUC: 0.563631
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.460345    reg_loss: 0.063589    l2_loss: 0.012689    loss: 0.536623
steps 1400    v_Prec: 0.205424  v_Recall: 0.585612  v_F1: 0.304155  v_AUC: 0.604384
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.444203    reg_loss: 0.063249    l2_loss: 0.012676    loss: 0.520128
steps 1600    v_Prec: 0.320052  v_Recall: 0.415510  v_F1: 0.361587  v_AUC: 0.669398
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.419274    reg_loss: 0.063015    l2_loss: 0.012815    loss: 0.495105
steps 1800    v_Prec: 0.462676  v_Recall: 0.419039  v_F1: 0.439778  v_AUC: 0.730819
steps 1800    running time 101 seconds

steps 2000    base_loss: 0.386059    reg_loss: 0.062766    l2_loss: 0.013029    loss: 0.461854
steps 2000    v_Prec: 0.538898  v_Recall: 0.464993  v_F1: 0.499225  v_AUC: 0.766642
steps 2000    running time 108 seconds

steps 2200    base_loss: 0.370743    reg_loss: 0.062626    l2_loss: 0.013277    loss: 0.446647
steps 2200    v_Prec: 0.541926  v_Recall: 0.522977  v_F1: 0.532283  v_AUC: 0.795512
steps 2200    running time 116 seconds

steps 2400    base_loss: 0.350291    reg_loss: 0.062707    l2_loss: 0.013512    loss: 0.426510
steps 2400    v_Prec: 0.568325  v_Recall: 0.543348  v_F1: 0.555556  v_AUC: 0.812716
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.341971    reg_loss: 0.063040    l2_loss: 0.013728    loss: 0.418740
steps 2600    v_Prec: 0.590614  v_Recall: 0.555137  v_F1: 0.572326  v_AUC: 0.823929
steps 2600    running time 131 seconds

steps 2800    base_loss: 0.327686    reg_loss: 0.062959    l2_loss: 0.013983    loss: 0.404628
steps 2800    v_Prec: 0.599682  v_Recall: 0.574144  v_F1: 0.586635  v_AUC: 0.833611
steps 2800    running time 138 seconds

steps 3000    base_loss: 0.329913    reg_loss: 0.063207    l2_loss: 0.014254    loss: 0.407375
steps 3000    v_Prec: 0.657870  v_Recall: 0.551768  v_F1: 0.600166  v_AUC: 0.844422
steps 3000    running time 146 seconds

steps 3200    base_loss: 0.323186    reg_loss: 0.063539    l2_loss: 0.014719    loss: 0.401445
steps 3200    v_Prec: 0.694765  v_Recall: 0.545994  v_F1: 0.611460  v_AUC: 0.851154
steps 3200    running time 153 seconds

steps 3400    base_loss: 0.313346    reg_loss: 0.063764    l2_loss: 0.015043    loss: 0.392152
steps 3400    v_Prec: 0.670058  v_Recall: 0.580961  v_F1: 0.622337  v_AUC: 0.855932
steps 3400    running time 161 seconds

steps 3600    base_loss: 0.304047    reg_loss: 0.063824    l2_loss: 0.015551    loss: 0.383422
steps 3600    v_Prec: 0.675380  v_Recall: 0.584329  v_F1: 0.626564  v_AUC: 0.858439
steps 3600    running time 168 seconds

steps 3800    base_loss: 0.292445    reg_loss: 0.063818    l2_loss: 0.015968    loss: 0.372230
steps 3800    v_Prec: 0.707908  v_Recall: 0.583688  v_F1: 0.639824  v_AUC: 0.862944
steps 3800    running time 176 seconds

steps 4000    base_loss: 0.298076    reg_loss: 0.064273    l2_loss: 0.016551    loss: 0.378899
steps 4000    v_Prec: 0.709815  v_Recall: 0.598524  v_F1: 0.649437  v_AUC: 0.869139
steps 4000    running time 183 seconds

steps 4200    base_loss: 0.290077    reg_loss: 0.064200    l2_loss: 0.017016    loss: 0.371293
steps 4200    v_Prec: 0.724732  v_Recall: 0.596920  v_F1: 0.654646  v_AUC: 0.871285
steps 4200    running time 191 seconds

steps 4400    base_loss: 0.288360    reg_loss: 0.064300    l2_loss: 0.017529    loss: 0.370188
steps 4400    v_Prec: 0.712357  v_Recall: 0.613522  v_F1: 0.659255  v_AUC: 0.874325
steps 4400    running time 198 seconds

steps 4600    base_loss: 0.287056    reg_loss: 0.064552    l2_loss: 0.018034    loss: 0.369643
steps 4600    v_Prec: 0.728558  v_Recall: 0.615847  v_F1: 0.667478  v_AUC: 0.876276
steps 4600    running time 206 seconds

steps 4800    base_loss: 0.284081    reg_loss: 0.064402    l2_loss: 0.018589    loss: 0.367073
steps 4800    v_Prec: 0.741735  v_Recall: 0.613602  v_F1: 0.671612  v_AUC: 0.879883
steps 4800    running time 213 seconds

steps 5000    base_loss: 0.279127    reg_loss: 0.064643    l2_loss: 0.019074    loss: 0.362844
steps 5000    v_Prec: 0.739787  v_Recall: 0.624509  v_F1: 0.677278  v_AUC: 0.882599
steps 5000    running time 221 seconds

steps 5200    base_loss: 0.269163    reg_loss: 0.064176    l2_loss: 0.019624    loss: 0.352963
steps 5200    v_Prec: 0.722162  v_Recall: 0.639747  v_F1: 0.678461  v_AUC: 0.884066
steps 5200    running time 228 seconds

steps 5400    base_loss: 0.261885    reg_loss: 0.064130    l2_loss: 0.020122    loss: 0.346137
steps 5400    v_Prec: 0.745895  v_Recall: 0.633972  v_F1: 0.685395  v_AUC: 0.885930
steps 5400    running time 236 seconds

steps 5600    base_loss: 0.176120    reg_loss: 0.060767    l2_loss: 0.020443    loss: 0.257331
steps 5600    v_Prec: 0.753870  v_Recall: 0.624910  v_F1: 0.683359  v_AUC: 0.884245
steps 5600    running time 243 seconds

steps 5800    base_loss: 0.179172    reg_loss: 0.060891    l2_loss: 0.020700    loss: 0.260763
steps 5800    v_Prec: 0.756430  v_Recall: 0.617932  v_F1: 0.680203  v_AUC: 0.880336
steps 5800    running time 250 seconds

steps 6000    base_loss: 0.172608    reg_loss: 0.061083    l2_loss: 0.020913    loss: 0.254605
steps 6000    v_Prec: 0.732740  v_Recall: 0.634133  v_F1: 0.679880  v_AUC: 0.881180
steps 6000    running time 257 seconds

steps 6200    base_loss: 0.180149    reg_loss: 0.061181    l2_loss: 0.021257    loss: 0.262587
steps 6200    v_Prec: 0.727096  v_Recall: 0.630764  v_F1: 0.675513  v_AUC: 0.880957
steps 6200    running time 264 seconds

steps 6400    base_loss: 0.183753    reg_loss: 0.061563    l2_loss: 0.021449    loss: 0.266765
steps 6400    v_Prec: 0.734584  v_Recall: 0.637260  v_F1: 0.682470  v_AUC: 0.881326
steps 6400    running time 271 seconds

steps 6600    base_loss: 0.175485    reg_loss: 0.061423    l2_loss: 0.021813    loss: 0.258721
steps 6600    v_Prec: 0.750983  v_Recall: 0.627877  v_F1: 0.683935  v_AUC: 0.883312
steps 6600    running time 277 seconds

steps 6800    base_loss: 0.176583    reg_loss: 0.061397    l2_loss: 0.021942    loss: 0.259922
steps 6800    v_Prec: 0.766155  v_Recall: 0.620900  v_F1: 0.685922  v_AUC: 0.885165
steps 6800    running time 284 seconds

steps 7000    base_loss: 0.190126    reg_loss: 0.061642    l2_loss: 0.022120    loss: 0.273888
steps 7000    v_Prec: 0.746283  v_Recall: 0.643997  v_F1: 0.691377  v_AUC: 0.886946
steps 7000    running time 292 seconds

steps 7200    base_loss: 0.181305    reg_loss: 0.061646    l2_loss: 0.022258    loss: 0.265208
steps 7200    v_Prec: 0.761292  v_Recall: 0.640709  v_F1: 0.695815  v_AUC: 0.887807
steps 7200    running time 299 seconds

steps 7400    base_loss: 0.198622    reg_loss: 0.062168    l2_loss: 0.022458    loss: 0.283248
steps 7400    v_Prec: 0.757894  v_Recall: 0.642955  v_F1: 0.695709  v_AUC: 0.889287
steps 7400    running time 307 seconds

steps 7600    base_loss: 0.191746    reg_loss: 0.062165    l2_loss: 0.022529    loss: 0.276440
steps 7600    v_Prec: 0.773999  v_Recall: 0.636940  v_F1: 0.698812  v_AUC: 0.891840
steps 7600    running time 314 seconds

steps 7800    base_loss: 0.187342    reg_loss: 0.062029    l2_loss: 0.022739    loss: 0.272111
steps 7800    v_Prec: 0.762639  v_Recall: 0.650894  v_F1: 0.702350  v_AUC: 0.890350
steps 7800    running time 321 seconds

steps 8000    base_loss: 0.189297    reg_loss: 0.061963    l2_loss: 0.022884    loss: 0.274144
steps 8000    v_Prec: 0.772914  v_Recall: 0.649932  v_F1: 0.706108  v_AUC: 0.892952
steps 8000    running time 328 seconds

steps 8200    base_loss: 0.179189    reg_loss: 0.061440    l2_loss: 0.022922    loss: 0.263551
steps 8200    v_Prec: 0.807280  v_Recall: 0.627877  v_F1: 0.706365  v_AUC: 0.892187
steps 8200    running time 336 seconds

steps 8400    base_loss: 0.180466    reg_loss: 0.061807    l2_loss: 0.023024    loss: 0.265296
steps 8400    v_Prec: 0.778439  v_Recall: 0.650894  v_F1: 0.708976  v_AUC: 0.893457
steps 8400    running time 343 seconds

steps 8600    base_loss: 0.186147    reg_loss: 0.061912    l2_loss: 0.023084    loss: 0.271143
steps 8600    v_Prec: 0.773535  v_Recall: 0.659636  v_F1: 0.712060  v_AUC: 0.894558
steps 8600    running time 351 seconds

steps 8800    base_loss: 0.183005    reg_loss: 0.061968    l2_loss: 0.023265    loss: 0.268238
steps 8800    v_Prec: 0.783203  v_Recall: 0.657390  v_F1: 0.714803  v_AUC: 0.896276
steps 8800    running time 358 seconds

steps 9000    base_loss: 0.188286    reg_loss: 0.062233    l2_loss: 0.023358    loss: 0.273876
steps 9000    v_Prec: 0.805834  v_Recall: 0.644719  v_F1: 0.716329  v_AUC: 0.898950
steps 9000    running time 366 seconds

steps 9200    base_loss: 0.182911    reg_loss: 0.061919    l2_loss: 0.023398    loss: 0.268228
steps 9200    v_Prec: 0.770463  v_Recall: 0.674874  v_F1: 0.719508  v_AUC: 0.901463
steps 9200    running time 373 seconds

steps 9400    base_loss: 0.193353    reg_loss: 0.062215    l2_loss: 0.023462    loss: 0.279030
steps 9400    v_Prec: 0.770875  v_Recall: 0.679686  v_F1: 0.722414  v_AUC: 0.900910
steps 9400    running time 381 seconds

steps 9600    base_loss: 0.180868    reg_loss: 0.061935    l2_loss: 0.023449    loss: 0.266252
steps 9600    v_Prec: 0.779579  v_Recall: 0.674793  v_F1: 0.723412  v_AUC: 0.901347
steps 9600    running time 389 seconds

steps 9800    base_loss: 0.196896    reg_loss: 0.062167    l2_loss: 0.023522    loss: 0.282585
steps 9800    v_Prec: 0.795781  v_Recall: 0.665651  v_F1: 0.724922  v_AUC: 0.903039
steps 9800    running time 396 seconds

steps 10000    base_loss: 0.183654    reg_loss: 0.061693    l2_loss: 0.023433    loss: 0.268779
steps 10000    v_Prec: 0.797456  v_Recall: 0.673831  v_F1: 0.730450  v_AUC: 0.904852
steps 10000    running time 404 seconds

steps 10200    base_loss: 0.180117    reg_loss: 0.061850    l2_loss: 0.023498    loss: 0.265465
steps 10200    v_Prec: 0.797216  v_Recall: 0.679766  v_F1: 0.733821  v_AUC: 0.904083
steps 10200    running time 411 seconds

steps 10400    base_loss: 0.188049    reg_loss: 0.062125    l2_loss: 0.023412    loss: 0.273587
steps 10400    v_Prec: 0.796550  v_Recall: 0.685139  v_F1: 0.736656  v_AUC: 0.907432
steps 10400    running time 419 seconds

steps 10600    base_loss: 0.188326    reg_loss: 0.062085    l2_loss: 0.023626    loss: 0.274037
steps 10600    v_Prec: 0.790034  v_Recall: 0.690432  v_F1: 0.736883  v_AUC: 0.908424
steps 10600    running time 426 seconds

steps 10800    base_loss: 0.176051    reg_loss: 0.061748    l2_loss: 0.023635    loss: 0.261434
steps 10800    v_Prec: 0.804082  v_Recall: 0.676077  v_F1: 0.734545  v_AUC: 0.909303
steps 10800    running time 433 seconds

steps 11000    base_loss: 0.049370    reg_loss: 0.057183    l2_loss: 0.023486    loss: 0.130040
steps 11000    v_Prec: 0.797419  v_Recall: 0.679044  v_F1: 0.733486  v_AUC: 0.906479
steps 11000    running time 440 seconds

steps 11200    base_loss: 0.049325    reg_loss: 0.057033    l2_loss: 0.022869    loss: 0.129228
steps 11200    v_Prec: 0.783033  v_Recall: 0.682493  v_F1: 0.729314  v_AUC: 0.901926
steps 11200    running time 447 seconds

steps 11400    base_loss: 0.047499    reg_loss: 0.057209    l2_loss: 0.022508    loss: 0.127216
steps 11400    v_Prec: 0.809147  v_Recall: 0.664047  v_F1: 0.729451  v_AUC: 0.900905
steps 11400    running time 454 seconds

steps 11600    base_loss: 0.051409    reg_loss: 0.056976    l2_loss: 0.022200    loss: 0.130585
steps 11600    v_Prec: 0.791189  v_Recall: 0.669741  v_F1: 0.725417  v_AUC: 0.898734
steps 11600    running time 461 seconds

steps 11800    base_loss: 0.053900    reg_loss: 0.057125    l2_loss: 0.021817    loss: 0.132843
steps 11800    v_Prec: 0.782413  v_Recall: 0.669340  v_F1: 0.721473  v_AUC: 0.895833
steps 11800    running time 467 seconds

steps 12000    base_loss: 0.053167    reg_loss: 0.056851    l2_loss: 0.021470    loss: 0.131489
steps 12000    v_Prec: 0.774879  v_Recall: 0.669420  v_F1: 0.718300  v_AUC: 0.895360
steps 12000    running time 474 seconds

steps 12200    base_loss: 0.052950    reg_loss: 0.056909    l2_loss: 0.021264    loss: 0.131123
steps 12200    v_Prec: 0.768141  v_Recall: 0.674072  v_F1: 0.718039  v_AUC: 0.895556
steps 12200    running time 481 seconds

steps 12400    base_loss: 0.057027    reg_loss: 0.056948    l2_loss: 0.020982    loss: 0.134957
steps 12400    v_Prec: 0.774523  v_Recall: 0.669982  v_F1: 0.718469  v_AUC: 0.895017
steps 12400    running time 487 seconds

steps 12600    base_loss: 0.050002    reg_loss: 0.056755    l2_loss: 0.020806    loss: 0.127563
steps 12600    v_Prec: 0.783596  v_Recall: 0.658914  v_F1: 0.715867  v_AUC: 0.895415
steps 12600    running time 494 seconds

Early stop model F1: 0.736883
testing thre: 0.47103512
testing Prec: 0.628918547421629
testing Recall: 0.6893803159173755
testing F1: 0.657762938230384
testing AUC: 0.885511931610863
overall running time 497 seconds
(0.7248728094968909, 0.623232077764277, 0.6702208284332941, 0.885511931610863, 0.6402339)

2019-02-24 19:41:11.123073: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:41:12.397129: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:41:12.408269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:41:12.408322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.590000 seconds
loading data in 29.650000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.557093    reg_loss: 0.064824    l2_loss: 0.013355    loss: 0.635272
steps 200    v_Prec: 0.164203  v_Recall: 0.967571  v_F1: 0.280759  v_AUC: 0.535273
steps 200    running time 41 seconds

steps 400    base_loss: 0.500130    reg_loss: 0.064607    l2_loss: 0.013327    loss: 0.578064
steps 400    v_Prec: 0.173468  v_Recall: 0.772280  v_F1: 0.283302  v_AUC: 0.548055
steps 400    running time 49 seconds

steps 600    base_loss: 0.477579    reg_loss: 0.064470    l2_loss: 0.013248    loss: 0.555296
steps 600    v_Prec: 0.180069  v_Recall: 0.785331  v_F1: 0.292964  v_AUC: 0.578390
steps 600    running time 56 seconds

steps 800    base_loss: 0.454633    reg_loss: 0.064107    l2_loss: 0.013120    loss: 0.531859
steps 800    v_Prec: 0.201401  v_Recall: 0.630635  v_F1: 0.305301  v_AUC: 0.608795
steps 800    running time 64 seconds

steps 1000    base_loss: 0.452684    reg_loss: 0.063595    l2_loss: 0.013094    loss: 0.529373
steps 1000    v_Prec: 0.267084  v_Recall: 0.475378  v_F1: 0.342013  v_AUC: 0.659599
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.439671    reg_loss: 0.062817    l2_loss: 0.013093    loss: 0.515581
steps 1200    v_Prec: 0.396429  v_Recall: 0.416046  v_F1: 0.406001  v_AUC: 0.712948
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.420728    reg_loss: 0.061961    l2_loss: 0.013116    loss: 0.495805
steps 1400    v_Prec: 0.490797  v_Recall: 0.469693  v_F1: 0.480013  v_AUC: 0.767616
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.394152    reg_loss: 0.060972    l2_loss: 0.013273    loss: 0.468396
steps 1600    v_Prec: 0.555556  v_Recall: 0.512451  v_F1: 0.533133  v_AUC: 0.803710
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.354544    reg_loss: 0.059805    l2_loss: 0.013544    loss: 0.427893
steps 1800    v_Prec: 0.612480  v_Recall: 0.523421  v_F1: 0.564459  v_AUC: 0.829060
steps 1800    running time 102 seconds

steps 2000    base_loss: 0.338440    reg_loss: 0.059347    l2_loss: 0.013792    loss: 0.411579
steps 2000    v_Prec: 0.662317  v_Recall: 0.536472  v_F1: 0.592789  v_AUC: 0.846705
steps 2000    running time 110 seconds

steps 2200    base_loss: 0.316572    reg_loss: 0.058524    l2_loss: 0.014161    loss: 0.389258
steps 2200    v_Prec: 0.682792  v_Recall: 0.561694  v_F1: 0.616351  v_AUC: 0.857921
steps 2200    running time 117 seconds

steps 2400    base_loss: 0.315467    reg_loss: 0.058135    l2_loss: 0.014498    loss: 0.388100
steps 2400    v_Prec: 0.673323  v_Recall: 0.599407  v_F1: 0.634219  v_AUC: 0.867477
steps 2400    running time 125 seconds

steps 2600    base_loss: 0.295994    reg_loss: 0.057653    l2_loss: 0.014902    loss: 0.368550
steps 2600    v_Prec: 0.669357  v_Recall: 0.624229  v_F1: 0.646006  v_AUC: 0.873720
steps 2600    running time 132 seconds

steps 2800    base_loss: 0.292795    reg_loss: 0.057358    l2_loss: 0.015254    loss: 0.365408
steps 2800    v_Prec: 0.712623  v_Recall: 0.612939  v_F1: 0.659033  v_AUC: 0.878417
steps 2800    running time 140 seconds

steps 3000    base_loss: 0.291630    reg_loss: 0.057163    l2_loss: 0.015678    loss: 0.364471
steps 3000    v_Prec: 0.690328  v_Recall: 0.640083  v_F1: 0.664257  v_AUC: 0.882259
steps 3000    running time 147 seconds

steps 3200    base_loss: 0.289287    reg_loss: 0.056690    l2_loss: 0.015996    loss: 0.361973
steps 3200    v_Prec: 0.741587  v_Recall: 0.610537  v_F1: 0.669711  v_AUC: 0.885776
steps 3200    running time 155 seconds

steps 3400    base_loss: 0.287573    reg_loss: 0.056400    l2_loss: 0.016454    loss: 0.360427
steps 3400    v_Prec: 0.744497  v_Recall: 0.620146  v_F1: 0.676656  v_AUC: 0.887468
steps 3400    running time 163 seconds

steps 3600    base_loss: 0.277438    reg_loss: 0.056003    l2_loss: 0.016795    loss: 0.350236
steps 3600    v_Prec: 0.738264  v_Recall: 0.634638  v_F1: 0.682540  v_AUC: 0.890272
steps 3600    running time 170 seconds

steps 3800    base_loss: 0.269998    reg_loss: 0.055859    l2_loss: 0.017125    loss: 0.342981
steps 3800    v_Prec: 0.756597  v_Recall: 0.635920  v_F1: 0.691029  v_AUC: 0.892629
steps 3800    running time 178 seconds

steps 4000    base_loss: 0.278289    reg_loss: 0.055754    l2_loss: 0.017461    loss: 0.351504
steps 4000    v_Prec: 0.738123  v_Recall: 0.658099  v_F1: 0.695818  v_AUC: 0.894827
steps 4000    running time 185 seconds

steps 4200    base_loss: 0.270934    reg_loss: 0.055373    l2_loss: 0.017824    loss: 0.344131
steps 4200    v_Prec: 0.736370  v_Recall: 0.664024  v_F1: 0.698328  v_AUC: 0.897262
steps 4200    running time 193 seconds

steps 4400    base_loss: 0.271149    reg_loss: 0.055348    l2_loss: 0.018249    loss: 0.344745
steps 4400    v_Prec: 0.757356  v_Recall: 0.653295  v_F1: 0.701487  v_AUC: 0.899292
steps 4400    running time 200 seconds

steps 4600    base_loss: 0.265343    reg_loss: 0.055035    l2_loss: 0.018576    loss: 0.338954
steps 4600    v_Prec: 0.751721  v_Recall: 0.664505  v_F1: 0.705427  v_AUC: 0.902858
steps 4600    running time 208 seconds

steps 4800    base_loss: 0.253084    reg_loss: 0.054759    l2_loss: 0.018921    loss: 0.326764
steps 4800    v_Prec: 0.756762  v_Recall: 0.667628  v_F1: 0.709406  v_AUC: 0.904338
steps 4800    running time 216 seconds

steps 5000    base_loss: 0.258464    reg_loss: 0.054696    l2_loss: 0.019358    loss: 0.332518
steps 5000    v_Prec: 0.753566  v_Recall: 0.672592  v_F1: 0.710780  v_AUC: 0.906144
steps 5000    running time 223 seconds

steps 5200    base_loss: 0.259268    reg_loss: 0.054531    l2_loss: 0.019762    loss: 0.333561
steps 5200    v_Prec: 0.743767  v_Recall: 0.690287  v_F1: 0.716030  v_AUC: 0.908719
steps 5200    running time 230 seconds

steps 5400    base_loss: 0.252563    reg_loss: 0.054199    l2_loss: 0.020148    loss: 0.326910
steps 5400    v_Prec: 0.759686  v_Recall: 0.681400  v_F1: 0.718416  v_AUC: 0.910530
steps 5400    running time 238 seconds

steps 5600    base_loss: 0.169140    reg_loss: 0.050701    l2_loss: 0.020536    loss: 0.240377
steps 5600    v_Prec: 0.736018  v_Recall: 0.696533  v_F1: 0.715731  v_AUC: 0.907519
steps 5600    running time 246 seconds

steps 5800    base_loss: 0.164490    reg_loss: 0.050514    l2_loss: 0.021151    loss: 0.236155
steps 5800    v_Prec: 0.742102  v_Recall: 0.692129  v_F1: 0.716245  v_AUC: 0.904475
steps 5800    running time 252 seconds

steps 6000    base_loss: 0.168304    reg_loss: 0.050645    l2_loss: 0.021887    loss: 0.240837
steps 6000    v_Prec: 0.770623  v_Recall: 0.664985  v_F1: 0.713917  v_AUC: 0.904226
steps 6000    running time 259 seconds

steps 6200    base_loss: 0.169501    reg_loss: 0.050554    l2_loss: 0.022704    loss: 0.242760
steps 6200    v_Prec: 0.731256  v_Recall: 0.693490  v_F1: 0.711873  v_AUC: 0.903931
steps 6200    running time 266 seconds

steps 6400    base_loss: 0.158057    reg_loss: 0.050338    l2_loss: 0.023301    loss: 0.231696
steps 6400    v_Prec: 0.764890  v_Recall: 0.664265  v_F1: 0.711035  v_AUC: 0.902235
steps 6400    running time 273 seconds

steps 6600    base_loss: 0.180424    reg_loss: 0.050527    l2_loss: 0.023788    loss: 0.254739
steps 6600    v_Prec: 0.762459  v_Recall: 0.671311  v_F1: 0.713988  v_AUC: 0.903544
steps 6600    running time 279 seconds

steps 6800    base_loss: 0.178607    reg_loss: 0.050265    l2_loss: 0.024248    loss: 0.253121
steps 6800    v_Prec: 0.776278  v_Recall: 0.667628  v_F1: 0.717865  v_AUC: 0.905806
steps 6800    running time 286 seconds

steps 7000    base_loss: 0.172620    reg_loss: 0.049915    l2_loss: 0.024600    loss: 0.247135
steps 7000    v_Prec: 0.773552  v_Recall: 0.672592  v_F1: 0.719548  v_AUC: 0.907278
steps 7000    running time 293 seconds

steps 7200    base_loss: 0.169654    reg_loss: 0.049646    l2_loss: 0.024785    loss: 0.244085
steps 7200    v_Prec: 0.761812  v_Recall: 0.688126  v_F1: 0.723096  v_AUC: 0.909244
steps 7200    running time 301 seconds

steps 7400    base_loss: 0.173570    reg_loss: 0.049739    l2_loss: 0.025007    loss: 0.248316
steps 7400    v_Prec: 0.757984  v_Recall: 0.693650  v_F1: 0.724392  v_AUC: 0.910835
steps 7400    running time 308 seconds

steps 7600    base_loss: 0.178948    reg_loss: 0.049733    l2_loss: 0.025264    loss: 0.253945
steps 7600    v_Prec: 0.778335  v_Recall: 0.684042  v_F1: 0.728148  v_AUC: 0.911246
steps 7600    running time 315 seconds

steps 7800    base_loss: 0.179097    reg_loss: 0.049307    l2_loss: 0.025503    loss: 0.253908
steps 7800    v_Prec: 0.755249  v_Recall: 0.705661  v_F1: 0.729613  v_AUC: 0.913616
steps 7800    running time 323 seconds

steps 8000    base_loss: 0.185708    reg_loss: 0.049482    l2_loss: 0.025733    loss: 0.260923
steps 8000    v_Prec: 0.796208  v_Recall: 0.682601  v_F1: 0.735041  v_AUC: 0.914800
steps 8000    running time 330 seconds

steps 8200    base_loss: 0.176293    reg_loss: 0.049079    l2_loss: 0.025900    loss: 0.251273
steps 8200    v_Prec: 0.766919  v_Recall: 0.706862  v_F1: 0.735667  v_AUC: 0.914190
steps 8200    running time 338 seconds

steps 8400    base_loss: 0.182230    reg_loss: 0.049082    l2_loss: 0.026111    loss: 0.257423
steps 8400    v_Prec: 0.764518  v_Recall: 0.710465  v_F1: 0.736501  v_AUC: 0.915005
steps 8400    running time 345 seconds

steps 8600    base_loss: 0.176710    reg_loss: 0.049061    l2_loss: 0.026261    loss: 0.252031
steps 8600    v_Prec: 0.786183  v_Recall: 0.700697  v_F1: 0.740982  v_AUC: 0.917134
steps 8600    running time 353 seconds

steps 8800    base_loss: 0.171170    reg_loss: 0.048430    l2_loss: 0.026381    loss: 0.245981
steps 8800    v_Prec: 0.798525  v_Recall: 0.693730  v_F1: 0.742448  v_AUC: 0.917881
steps 8800    running time 360 seconds

steps 9000    base_loss: 0.175883    reg_loss: 0.048383    l2_loss: 0.026554    loss: 0.250820
steps 9000    v_Prec: 0.784349  v_Recall: 0.706221  v_F1: 0.743238  v_AUC: 0.917873
steps 9000    running time 368 seconds

steps 9200    base_loss: 0.171921    reg_loss: 0.048214    l2_loss: 0.026612    loss: 0.246747
steps 9200    v_Prec: 0.769845  v_Recall: 0.717511  v_F1: 0.742758  v_AUC: 0.918936
steps 9200    running time 376 seconds

steps 9400    base_loss: 0.178111    reg_loss: 0.048229    l2_loss: 0.026804    loss: 0.253145
steps 9400    v_Prec: 0.787787  v_Recall: 0.708624  v_F1: 0.746111  v_AUC: 0.919889
steps 9400    running time 382 seconds

steps 9600    base_loss: 0.173443    reg_loss: 0.048141    l2_loss: 0.026920    loss: 0.248504
steps 9600    v_Prec: 0.789930  v_Recall: 0.707262  v_F1: 0.746314  v_AUC: 0.920518
steps 9600    running time 390 seconds

steps 9800    base_loss: 0.184249    reg_loss: 0.048049    l2_loss: 0.026918    loss: 0.259216
steps 9800    v_Prec: 0.792574  v_Recall: 0.711026  v_F1: 0.749588  v_AUC: 0.923675
steps 9800    running time 397 seconds

steps 10000    base_loss: 0.177815    reg_loss: 0.047630    l2_loss: 0.026955    loss: 0.252400
steps 10000    v_Prec: 0.798086  v_Recall: 0.707663  v_F1: 0.750159  v_AUC: 0.924408
steps 10000    running time 405 seconds

steps 10200    base_loss: 0.177144    reg_loss: 0.047545    l2_loss: 0.027051    loss: 0.251741
steps 10200    v_Prec: 0.796813  v_Recall: 0.712787  v_F1: 0.752462  v_AUC: 0.924140
steps 10200    running time 412 seconds

steps 10400    base_loss: 0.170783    reg_loss: 0.047506    l2_loss: 0.027082    loss: 0.245372
steps 10400    v_Prec: 0.780408  v_Recall: 0.723357  v_F1: 0.750800  v_AUC: 0.925490
steps 10400    running time 420 seconds

steps 10600    base_loss: 0.180457    reg_loss: 0.047676    l2_loss: 0.027116    loss: 0.255249
steps 10600    v_Prec: 0.799353  v_Recall: 0.712627  v_F1: 0.753503  v_AUC: 0.926703
steps 10600    running time 426 seconds

steps 10800    base_loss: 0.161145    reg_loss: 0.046863    l2_loss: 0.027073    loss: 0.235081
steps 10800    v_Prec: 0.800125  v_Recall: 0.717351  v_F1: 0.756481  v_AUC: 0.927047
steps 10800    running time 434 seconds

steps 11000    base_loss: 0.064021    reg_loss: 0.042782    l2_loss: 0.026921    loss: 0.133724
steps 11000    v_Prec: 0.799551  v_Recall: 0.713508  v_F1: 0.754083  v_AUC: 0.925819
steps 11000    running time 442 seconds

steps 11200    base_loss: 0.058515    reg_loss: 0.042774    l2_loss: 0.026851    loss: 0.128140
steps 11200    v_Prec: 0.796867  v_Recall: 0.708624  v_F1: 0.750159  v_AUC: 0.924194
steps 11200    running time 449 seconds

steps 11400    base_loss: 0.059669    reg_loss: 0.042831    l2_loss: 0.026717    loss: 0.129218
steps 11400    v_Prec: 0.794500  v_Recall: 0.710145  v_F1: 0.749958  v_AUC: 0.922078
steps 11400    running time 455 seconds

steps 11600    base_loss: 0.063919    reg_loss: 0.043184    l2_loss: 0.026607    loss: 0.133710
steps 11600    v_Prec: 0.809759  v_Recall: 0.694932  v_F1: 0.747964  v_AUC: 0.921098
steps 11600    running time 462 seconds

steps 11800    base_loss: 0.066046    reg_loss: 0.043319    l2_loss: 0.026563    loss: 0.135928
steps 11800    v_Prec: 0.812801  v_Recall: 0.688366  v_F1: 0.745426  v_AUC: 0.920164
steps 11800    running time 469 seconds

steps 12000    base_loss: 0.063821    reg_loss: 0.043056    l2_loss: 0.026570    loss: 0.133447
steps 12000    v_Prec: 0.815735  v_Recall: 0.691569  v_F1: 0.748538  v_AUC: 0.921277
steps 12000    running time 476 seconds

steps 12200    base_loss: 0.066658    reg_loss: 0.042899    l2_loss: 0.026516    loss: 0.136072
steps 12200    v_Prec: 0.803594  v_Recall: 0.698134  v_F1: 0.747161  v_AUC: 0.919694
steps 12200    running time 482 seconds

steps 12400    base_loss: 0.068110    reg_loss: 0.043091    l2_loss: 0.026546    loss: 0.137747
steps 12400    v_Prec: 0.802049  v_Recall: 0.702058  v_F1: 0.748730  v_AUC: 0.920703
steps 12400    running time 489 seconds

steps 12600    base_loss: 0.072224    reg_loss: 0.043260    l2_loss: 0.026541    loss: 0.142025
steps 12600    v_Prec: 0.815767  v_Recall: 0.691008  v_F1: 0.748223  v_AUC: 0.920907
steps 12600    running time 496 seconds

steps 12800    base_loss: 0.068207    reg_loss: 0.043072    l2_loss: 0.026518    loss: 0.137797
steps 12800    v_Prec: 0.784606  v_Recall: 0.712547  v_F1: 0.746842  v_AUC: 0.920996
steps 12800    running time 503 seconds

Early stop model F1: 0.756481
testing thre: 0.55029327
testing Prec: 0.5813625394468164
testing Recall: 0.7610692588092345
testing F1: 0.6591875394653757
testing AUC: 0.9059275071443917
overall running time 505 seconds
(0.7343340611353711, 0.6538517618469015, 0.6917598663067233, 0.9059275071443917, 0.8207085)

2019-02-24 19:47:09.696369: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:47:10.980492: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:47:10.984295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:47:10.984347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.690000 seconds
loading data in 29.740000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.543887    reg_loss: 0.065025    l2_loss: 0.013341    loss: 0.622254
steps 200    v_Prec: 0.164244  v_Recall: 1.000000  v_F1: 0.282147  v_AUC: 0.474668
steps 200    running time 41 seconds

steps 400    base_loss: 0.508957    reg_loss: 0.065225    l2_loss: 0.013365    loss: 0.587546
steps 400    v_Prec: 0.164244  v_Recall: 1.000000  v_F1: 0.282147  v_AUC: 0.502340
steps 400    running time 48 seconds

steps 600    base_loss: 0.489007    reg_loss: 0.065150    l2_loss: 0.013244    loss: 0.567402
steps 600    v_Prec: 0.164244  v_Recall: 1.000000  v_F1: 0.282147  v_AUC: 0.540423
steps 600    running time 55 seconds

steps 800    base_loss: 0.459765    reg_loss: 0.064961    l2_loss: 0.013135    loss: 0.537862
steps 800    v_Prec: 0.177863  v_Recall: 0.748967  v_F1: 0.287461  v_AUC: 0.567675
steps 800    running time 62 seconds

steps 1000    base_loss: 0.446012    reg_loss: 0.065012    l2_loss: 0.013078    loss: 0.524102
steps 1000    v_Prec: 0.236175  v_Recall: 0.467509  v_F1: 0.313816  v_AUC: 0.612784
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.437233    reg_loss: 0.065290    l2_loss: 0.013069    loss: 0.515593
steps 1200    v_Prec: 0.349789  v_Recall: 0.394582  v_F1: 0.370838  v_AUC: 0.673137
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.424078    reg_loss: 0.065720    l2_loss: 0.013037    loss: 0.502835
steps 1400    v_Prec: 0.437805  v_Recall: 0.420241  v_F1: 0.428844  v_AUC: 0.724983
steps 1400    running time 85 seconds

steps 1600    base_loss: 0.401679    reg_loss: 0.066075    l2_loss: 0.013072    loss: 0.480826
steps 1600    v_Prec: 0.516387  v_Recall: 0.441849  v_F1: 0.476219  v_AUC: 0.763586
steps 1600    running time 92 seconds

steps 1800    base_loss: 0.378030    reg_loss: 0.066504    l2_loss: 0.013191    loss: 0.457725
steps 1800    v_Prec: 0.572747  v_Recall: 0.468462  v_F1: 0.515382  v_AUC: 0.792074
steps 1800    running time 99 seconds

steps 2000    base_loss: 0.352830    reg_loss: 0.066948    l2_loss: 0.013387    loss: 0.433164
steps 2000    v_Prec: 0.626521  v_Recall: 0.482682  v_F1: 0.545275  v_AUC: 0.812982
steps 2000    running time 107 seconds

steps 2200    base_loss: 0.340646    reg_loss: 0.067368    l2_loss: 0.013675    loss: 0.421689
steps 2200    v_Prec: 0.655416  v_Recall: 0.509056  v_F1: 0.573038  v_AUC: 0.831614
steps 2200    running time 115 seconds

steps 2400    base_loss: 0.327724    reg_loss: 0.067420    l2_loss: 0.014006    loss: 0.409149
steps 2400    v_Prec: 0.683840  v_Recall: 0.525103  v_F1: 0.594051  v_AUC: 0.842954
steps 2400    running time 122 seconds

steps 2600    base_loss: 0.316258    reg_loss: 0.067785    l2_loss: 0.014297    loss: 0.398340
steps 2600    v_Prec: 0.661807  v_Recall: 0.562599  v_F1: 0.608184  v_AUC: 0.852941
steps 2600    running time 130 seconds

steps 2800    base_loss: 0.305104    reg_loss: 0.067970    l2_loss: 0.014616    loss: 0.387690
steps 2800    v_Prec: 0.692642  v_Recall: 0.557118  v_F1: 0.617532  v_AUC: 0.859430
steps 2800    running time 137 seconds

steps 3000    base_loss: 0.291569    reg_loss: 0.068156    l2_loss: 0.014915    loss: 0.374641
steps 3000    v_Prec: 0.698473  v_Recall: 0.570464  v_F1: 0.628012  v_AUC: 0.864077
steps 3000    running time 145 seconds

steps 3200    base_loss: 0.293679    reg_loss: 0.068340    l2_loss: 0.015285    loss: 0.377305
steps 3200    v_Prec: 0.720581  v_Recall: 0.579361  v_F1: 0.642300  v_AUC: 0.869034
steps 3200    running time 153 seconds

steps 3400    base_loss: 0.289582    reg_loss: 0.068343    l2_loss: 0.015634    loss: 0.373560
steps 3400    v_Prec: 0.759271  v_Recall: 0.562758  v_F1: 0.646409  v_AUC: 0.872861
steps 3400    running time 160 seconds

steps 3600    base_loss: 0.290436    reg_loss: 0.068339    l2_loss: 0.015982    loss: 0.374757
steps 3600    v_Prec: 0.732298  v_Recall: 0.588259  v_F1: 0.652423  v_AUC: 0.875772
steps 3600    running time 167 seconds

steps 3800    base_loss: 0.279973    reg_loss: 0.068495    l2_loss: 0.016404    loss: 0.364871
steps 3800    v_Prec: 0.721655  v_Recall: 0.606768  v_F1: 0.659244  v_AUC: 0.879960
steps 3800    running time 175 seconds

steps 4000    base_loss: 0.274014    reg_loss: 0.068301    l2_loss: 0.016777    loss: 0.359092
steps 4000    v_Prec: 0.755296  v_Recall: 0.600493  v_F1: 0.669056  v_AUC: 0.885527
steps 4000    running time 182 seconds

steps 4200    base_loss: 0.270525    reg_loss: 0.068499    l2_loss: 0.017168    loss: 0.356191
steps 4200    v_Prec: 0.738068  v_Recall: 0.616698  v_F1: 0.671947  v_AUC: 0.887330
steps 4200    running time 190 seconds

steps 4400    base_loss: 0.271449    reg_loss: 0.068329    l2_loss: 0.017696    loss: 0.357474
steps 4400    v_Prec: 0.735540  v_Recall: 0.628376  v_F1: 0.677748  v_AUC: 0.888569
steps 4400    running time 197 seconds

steps 4600    base_loss: 0.268189    reg_loss: 0.068522    l2_loss: 0.018107    loss: 0.354817
steps 4600    v_Prec: 0.762770  v_Recall: 0.620432  v_F1: 0.684277  v_AUC: 0.892649
steps 4600    running time 205 seconds

steps 4800    base_loss: 0.255252    reg_loss: 0.068334    l2_loss: 0.018746    loss: 0.342332
steps 4800    v_Prec: 0.753887  v_Recall: 0.635605  v_F1: 0.689712  v_AUC: 0.892901
steps 4800    running time 212 seconds

steps 5000    base_loss: 0.257234    reg_loss: 0.068248    l2_loss: 0.019292    loss: 0.344774
steps 5000    v_Prec: 0.780230  v_Recall: 0.620750  v_F1: 0.691413  v_AUC: 0.895400
steps 5000    running time 220 seconds

steps 5200    base_loss: 0.261850    reg_loss: 0.068270    l2_loss: 0.019675    loss: 0.349795
steps 5200    v_Prec: 0.739394  v_Recall: 0.657690  v_F1: 0.696153  v_AUC: 0.897948
steps 5200    running time 227 seconds

steps 5400    base_loss: 0.250875    reg_loss: 0.067897    l2_loss: 0.020267    loss: 0.339040
steps 5400    v_Prec: 0.779552  v_Recall: 0.636003  v_F1: 0.700499  v_AUC: 0.898139
steps 5400    running time 235 seconds

steps 5600    base_loss: 0.171600    reg_loss: 0.066195    l2_loss: 0.020797    loss: 0.258592
steps 5600    v_Prec: 0.775000  v_Recall: 0.635367  v_F1: 0.698271  v_AUC: 0.895391
steps 5600    running time 243 seconds

steps 5800    base_loss: 0.174458    reg_loss: 0.066329    l2_loss: 0.021441    loss: 0.262228
steps 5800    v_Prec: 0.762966  v_Recall: 0.641563  v_F1: 0.697018  v_AUC: 0.890695
steps 5800    running time 249 seconds

steps 6000    base_loss: 0.160253    reg_loss: 0.066068    l2_loss: 0.022118    loss: 0.248439
steps 6000    v_Prec: 0.773905  v_Recall: 0.633302  v_F1: 0.696579  v_AUC: 0.892443
steps 6000    running time 256 seconds

steps 6200    base_loss: 0.170250    reg_loss: 0.066184    l2_loss: 0.022758    loss: 0.259192
steps 6200    v_Prec: 0.782851  v_Recall: 0.625199  v_F1: 0.695199  v_AUC: 0.892458
steps 6200    running time 263 seconds

steps 6400    base_loss: 0.173101    reg_loss: 0.066216    l2_loss: 0.023306    loss: 0.262623
steps 6400    v_Prec: 0.805085  v_Recall: 0.618843  v_F1: 0.699784  v_AUC: 0.894378
steps 6400    running time 269 seconds

steps 6600    base_loss: 0.173621    reg_loss: 0.066307    l2_loss: 0.023860    loss: 0.263788
steps 6600    v_Prec: 0.796925  v_Recall: 0.630044  v_F1: 0.703727  v_AUC: 0.893425
steps 6600    running time 276 seconds

steps 6800    base_loss: 0.167559    reg_loss: 0.066100    l2_loss: 0.024248    loss: 0.257907
steps 6800    v_Prec: 0.809085  v_Recall: 0.628217  v_F1: 0.707271  v_AUC: 0.894645
steps 6800    running time 284 seconds

steps 7000    base_loss: 0.165074    reg_loss: 0.065933    l2_loss: 0.024573    loss: 0.255580
steps 7000    v_Prec: 0.800478  v_Recall: 0.638704  v_F1: 0.710498  v_AUC: 0.895017
steps 7000    running time 292 seconds

steps 7200    base_loss: 0.173711    reg_loss: 0.065773    l2_loss: 0.024933    loss: 0.264416
steps 7200    v_Prec: 0.824060  v_Recall: 0.631792  v_F1: 0.715230  v_AUC: 0.896497
steps 7200    running time 299 seconds

steps 7400    base_loss: 0.180662    reg_loss: 0.066120    l2_loss: 0.025175    loss: 0.271956
steps 7400    v_Prec: 0.797450  v_Recall: 0.650858  v_F1: 0.716735  v_AUC: 0.899168
steps 7400    running time 307 seconds

steps 7600    base_loss: 0.171785    reg_loss: 0.066190    l2_loss: 0.025456    loss: 0.263431
steps 7600    v_Prec: 0.841876  v_Recall: 0.628932  v_F1: 0.719989  v_AUC: 0.898098
steps 7600    running time 314 seconds

steps 7800    base_loss: 0.179238    reg_loss: 0.066129    l2_loss: 0.025754    loss: 0.271122
steps 7800    v_Prec: 0.801917  v_Recall: 0.658008  v_F1: 0.722869  v_AUC: 0.899450
steps 7800    running time 322 seconds

steps 8000    base_loss: 0.182276    reg_loss: 0.065995    l2_loss: 0.026073    loss: 0.274344
steps 8000    v_Prec: 0.817172  v_Recall: 0.654751  v_F1: 0.727000  v_AUC: 0.902848
steps 8000    running time 329 seconds

steps 8200    base_loss: 0.174676    reg_loss: 0.066044    l2_loss: 0.026162    loss: 0.266883
steps 8200    v_Prec: 0.809020  v_Recall: 0.668335  v_F1: 0.731979  v_AUC: 0.904384
steps 8200    running time 337 seconds

steps 8400    base_loss: 0.175756    reg_loss: 0.066035    l2_loss: 0.026411    loss: 0.268202
steps 8400    v_Prec: 0.810724  v_Recall: 0.661821  v_F1: 0.728744  v_AUC: 0.903844
steps 8400    running time 344 seconds

steps 8600    base_loss: 0.179436    reg_loss: 0.066034    l2_loss: 0.026580    loss: 0.272049
steps 8600    v_Prec: 0.803778  v_Recall: 0.672625  v_F1: 0.732376  v_AUC: 0.905759
steps 8600    running time 351 seconds

steps 8800    base_loss: 0.165007    reg_loss: 0.065608    l2_loss: 0.026786    loss: 0.257401
steps 8800    v_Prec: 0.825898  v_Recall: 0.664760  v_F1: 0.736620  v_AUC: 0.906803
steps 8800    running time 358 seconds

steps 9000    base_loss: 0.171089    reg_loss: 0.066059    l2_loss: 0.026870    loss: 0.264017
steps 9000    v_Prec: 0.824350  v_Recall: 0.666984  v_F1: 0.737364  v_AUC: 0.906981
steps 9000    running time 366 seconds

steps 9200    base_loss: 0.175829    reg_loss: 0.065992    l2_loss: 0.027099    loss: 0.268920
steps 9200    v_Prec: 0.837570  v_Recall: 0.664840  v_F1: 0.741275  v_AUC: 0.907584
steps 9200    running time 373 seconds

steps 9400    base_loss: 0.171721    reg_loss: 0.065827    l2_loss: 0.027169    loss: 0.264717
steps 9400    v_Prec: 0.821102  v_Recall: 0.678186  v_F1: 0.742832  v_AUC: 0.906431
steps 9400    running time 381 seconds

steps 9600    base_loss: 0.171033    reg_loss: 0.065716    l2_loss: 0.027265    loss: 0.264014
steps 9600    v_Prec: 0.849771  v_Recall: 0.664601  v_F1: 0.745865  v_AUC: 0.908556
steps 9600    running time 388 seconds

steps 9800    base_loss: 0.168220    reg_loss: 0.065647    l2_loss: 0.027396    loss: 0.261263
steps 9800    v_Prec: 0.823400  v_Recall: 0.685971  v_F1: 0.748429  v_AUC: 0.909263
steps 9800    running time 396 seconds

steps 10000    base_loss: 0.167223    reg_loss: 0.065602    l2_loss: 0.027373    loss: 0.260197
steps 10000    v_Prec: 0.836339  v_Recall: 0.681602  v_F1: 0.751083  v_AUC: 0.910946
steps 10000    running time 404 seconds

steps 10200    base_loss: 0.168146    reg_loss: 0.065418    l2_loss: 0.027579    loss: 0.261143
steps 10200    v_Prec: 0.824258  v_Recall: 0.692644  v_F1: 0.752741  v_AUC: 0.911488
steps 10200    running time 411 seconds

steps 10400    base_loss: 0.175933    reg_loss: 0.065418    l2_loss: 0.027604    loss: 0.268955
steps 10400    v_Prec: 0.833174  v_Recall: 0.692723  v_F1: 0.756485  v_AUC: 0.912396
steps 10400    running time 419 seconds

steps 10600    base_loss: 0.167376    reg_loss: 0.065409    l2_loss: 0.027748    loss: 0.260533
steps 10600    v_Prec: 0.825699  v_Recall: 0.698840  v_F1: 0.756992  v_AUC: 0.914527
steps 10600    running time 426 seconds

steps 10800    base_loss: 0.162857    reg_loss: 0.065358    l2_loss: 0.027805    loss: 0.256020
steps 10800    v_Prec: 0.823803  v_Recall: 0.703845  v_F1: 0.759114  v_AUC: 0.914630
steps 10800    running time 434 seconds

steps 11000    base_loss: 0.058639    reg_loss: 0.062367    l2_loss: 0.027638    loss: 0.148644
steps 11000    v_Prec: 0.850761  v_Recall: 0.679298  v_F1: 0.755422  v_AUC: 0.911990
steps 11000    running time 441 seconds

steps 11200    base_loss: 0.058928    reg_loss: 0.062149    l2_loss: 0.027400    loss: 0.148478
steps 11200    v_Prec: 0.829750  v_Recall: 0.683746  v_F1: 0.749706  v_AUC: 0.907133
steps 11200    running time 448 seconds

steps 11400    base_loss: 0.053163    reg_loss: 0.062035    l2_loss: 0.027133    loss: 0.142332
steps 11400    v_Prec: 0.831324  v_Recall: 0.679298  v_F1: 0.747661  v_AUC: 0.904780
steps 11400    running time 454 seconds

steps 11600    base_loss: 0.055359    reg_loss: 0.062076    l2_loss: 0.026960    loss: 0.144396
steps 11600    v_Prec: 0.831443  v_Recall: 0.681443  v_F1: 0.749007  v_AUC: 0.903830
steps 11600    running time 461 seconds

steps 11800    base_loss: 0.060306    reg_loss: 0.061956    l2_loss: 0.026680    loss: 0.148941
steps 11800    v_Prec: 0.828391  v_Recall: 0.679139  v_F1: 0.746377  v_AUC: 0.902419
steps 11800    running time 468 seconds

steps 12000    base_loss: 0.058331    reg_loss: 0.061897    l2_loss: 0.026500    loss: 0.146728
steps 12000    v_Prec: 0.834073  v_Recall: 0.671671  v_F1: 0.744114  v_AUC: 0.899968
steps 12000    running time 475 seconds

steps 12200    base_loss: 0.059498    reg_loss: 0.061596    l2_loss: 0.026402    loss: 0.147496
steps 12200    v_Prec: 0.835876  v_Recall: 0.670400  v_F1: 0.744049  v_AUC: 0.901103
steps 12200    running time 481 seconds

steps 12400    base_loss: 0.063879    reg_loss: 0.061806    l2_loss: 0.026132    loss: 0.151818
steps 12400    v_Prec: 0.842589  v_Recall: 0.670162  v_F1: 0.746549  v_AUC: 0.902626
steps 12400    running time 488 seconds

steps 12600    base_loss: 0.061329    reg_loss: 0.061696    l2_loss: 0.026077    loss: 0.149102
steps 12600    v_Prec: 0.821295  v_Recall: 0.681999  v_F1: 0.745193  v_AUC: 0.901656
steps 12600    running time 495 seconds

steps 12800    base_loss: 0.058493    reg_loss: 0.061493    l2_loss: 0.025982    loss: 0.145968
steps 12800    v_Prec: 0.827345  v_Recall: 0.676835  v_F1: 0.744560  v_AUC: 0.900506
steps 12800    running time 502 seconds

Early stop model F1: 0.759114
testing thre: 0.5784568
testing Prec: 0.6652433425160698
testing Recall: 0.7042041312272175
testing F1: 0.6841695195372446
testing AUC: 0.8966709729177615
overall running time 505 seconds
(0.7717603839544943, 0.6330498177399757, 0.6955569796005554, 0.8966709729177615, 0.7684924)

2019-02-24 19:53:09.666929: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:53:10.515457: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:53:10.521688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:53:10.521759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.300000 seconds
loading data in 30.280000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.402634    reg_loss: 0.064653    l2_loss: 0.013314    loss: 1.480600
steps 200    v_Prec: 0.163455  v_Recall: 1.000000  v_F1: 0.280982  v_AUC: 0.501370
steps 200    running time 41 seconds

steps 400    base_loss: 0.919670    reg_loss: 0.064725    l2_loss: 0.013002    loss: 0.997396
steps 400    v_Prec: 0.165824  v_Recall: 0.979564  v_F1: 0.283634  v_AUC: 0.534042
steps 400    running time 49 seconds

steps 600    base_loss: 0.492604    reg_loss: 0.064503    l2_loss: 0.012582    loss: 0.569690
steps 600    v_Prec: 0.188800  v_Recall: 0.644288  v_F1: 0.292025  v_AUC: 0.576639
steps 600    running time 56 seconds

steps 800    base_loss: 0.454756    reg_loss: 0.064162    l2_loss: 0.012535    loss: 0.531452
steps 800    v_Prec: 0.230012  v_Recall: 0.516963  v_F1: 0.318372  v_AUC: 0.618585
steps 800    running time 64 seconds

steps 1000    base_loss: 0.450992    reg_loss: 0.063729    l2_loss: 0.012422    loss: 0.527142
steps 1000    v_Prec: 0.297768  v_Recall: 0.449349  v_F1: 0.358181  v_AUC: 0.658014
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.432746    reg_loss: 0.063161    l2_loss: 0.012397    loss: 0.508304
steps 1200    v_Prec: 0.368342  v_Recall: 0.449349  v_F1: 0.404833  v_AUC: 0.705087
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.420874    reg_loss: 0.062900    l2_loss: 0.012357    loss: 0.496131
steps 1400    v_Prec: 0.419547  v_Recall: 0.472899  v_F1: 0.444628  v_AUC: 0.745428
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.402215    reg_loss: 0.062780    l2_loss: 0.012403    loss: 0.477397
steps 1600    v_Prec: 0.478418  v_Recall: 0.474256  v_F1: 0.476328  v_AUC: 0.769892
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.386647    reg_loss: 0.062570    l2_loss: 0.012484    loss: 0.461700
steps 1800    v_Prec: 0.469450  v_Recall: 0.538517  v_F1: 0.501617  v_AUC: 0.790024
steps 1800    running time 101 seconds

steps 2000    base_loss: 0.373103    reg_loss: 0.062885    l2_loss: 0.012578    loss: 0.448567
steps 2000    v_Prec: 0.514353  v_Recall: 0.542109  v_F1: 0.527866  v_AUC: 0.810002
steps 2000    running time 109 seconds

steps 2200    base_loss: 0.356622    reg_loss: 0.062865    l2_loss: 0.012738    loss: 0.432224
steps 2200    v_Prec: 0.545146  v_Recall: 0.551369  v_F1: 0.548240  v_AUC: 0.823545
steps 2200    running time 116 seconds

steps 2400    base_loss: 0.344125    reg_loss: 0.063644    l2_loss: 0.012945    loss: 0.420714
steps 2400    v_Prec: 0.553135  v_Recall: 0.583779  v_F1: 0.568044  v_AUC: 0.838528
steps 2400    running time 124 seconds

steps 2600    base_loss: 0.331349    reg_loss: 0.064093    l2_loss: 0.013174    loss: 0.408616
steps 2600    v_Prec: 0.569005  v_Recall: 0.599665  v_F1: 0.583933  v_AUC: 0.850643
steps 2600    running time 131 seconds

steps 2800    base_loss: 0.325567    reg_loss: 0.064634    l2_loss: 0.013421    loss: 0.403622
steps 2800    v_Prec: 0.609931  v_Recall: 0.584418  v_F1: 0.596902  v_AUC: 0.859903
steps 2800    running time 139 seconds

steps 3000    base_loss: 0.323252    reg_loss: 0.065566    l2_loss: 0.013751    loss: 0.402569
steps 3000    v_Prec: 0.590180  v_Recall: 0.628482  v_F1: 0.608729  v_AUC: 0.867148
steps 3000    running time 146 seconds

steps 3200    base_loss: 0.308811    reg_loss: 0.066078    l2_loss: 0.014172    loss: 0.389062
steps 3200    v_Prec: 0.587195  v_Recall: 0.649397  v_F1: 0.616732  v_AUC: 0.872524
steps 3200    running time 154 seconds

steps 3400    base_loss: 0.303504    reg_loss: 0.066361    l2_loss: 0.014535    loss: 0.384401
steps 3400    v_Prec: 0.608752  v_Recall: 0.643011  v_F1: 0.625412  v_AUC: 0.877679
steps 3400    running time 162 seconds

steps 3600    base_loss: 0.296999    reg_loss: 0.066861    l2_loss: 0.015012    loss: 0.378871
steps 3600    v_Prec: 0.615466  v_Recall: 0.647402  v_F1: 0.631030  v_AUC: 0.880362
steps 3600    running time 169 seconds

steps 3800    base_loss: 0.289211    reg_loss: 0.067038    l2_loss: 0.015492    loss: 0.371741
steps 3800    v_Prec: 0.662154  v_Recall: 0.616907  v_F1: 0.638730  v_AUC: 0.884010
steps 3800    running time 177 seconds

steps 4000    base_loss: 0.289983    reg_loss: 0.067214    l2_loss: 0.016112    loss: 0.373309
steps 4000    v_Prec: 0.650097  v_Recall: 0.645166  v_F1: 0.647622  v_AUC: 0.888502
steps 4000    running time 184 seconds

steps 4200    base_loss: 0.277457    reg_loss: 0.067685    l2_loss: 0.016740    loss: 0.361882
steps 4200    v_Prec: 0.685318  v_Recall: 0.623773  v_F1: 0.653099  v_AUC: 0.890815
steps 4200    running time 192 seconds

steps 4400    base_loss: 0.284553    reg_loss: 0.067710    l2_loss: 0.017387    loss: 0.369650
steps 4400    v_Prec: 0.672711  v_Recall: 0.645645  v_F1: 0.658900  v_AUC: 0.893528
steps 4400    running time 200 seconds

steps 4600    base_loss: 0.284186    reg_loss: 0.067730    l2_loss: 0.018013    loss: 0.369928
steps 4600    v_Prec: 0.700018  v_Recall: 0.632234  v_F1: 0.664402  v_AUC: 0.896491
steps 4600    running time 207 seconds

steps 4800    base_loss: 0.278898    reg_loss: 0.067878    l2_loss: 0.018638    loss: 0.365415
steps 4800    v_Prec: 0.663334  v_Recall: 0.667359  v_F1: 0.665340  v_AUC: 0.898406
steps 4800    running time 215 seconds

steps 5000    base_loss: 0.276981    reg_loss: 0.068053    l2_loss: 0.019294    loss: 0.364329
steps 5000    v_Prec: 0.681653  v_Recall: 0.660813  v_F1: 0.671071  v_AUC: 0.899605
steps 5000    running time 223 seconds

steps 5200    base_loss: 0.268816    reg_loss: 0.067769    l2_loss: 0.020021    loss: 0.356607
steps 5200    v_Prec: 0.696201  v_Recall: 0.646683  v_F1: 0.670529  v_AUC: 0.900683
steps 5200    running time 230 seconds

steps 5400    base_loss: 0.266824    reg_loss: 0.067915    l2_loss: 0.020816    loss: 0.355554
steps 5400    v_Prec: 0.674677  v_Recall: 0.670152  v_F1: 0.672407  v_AUC: 0.901575
steps 5400    running time 237 seconds

steps 5600    base_loss: 0.188984    reg_loss: 0.068922    l2_loss: 0.021665    loss: 0.279570
steps 5600    v_Prec: 0.697693  v_Recall: 0.637264  v_F1: 0.666110  v_AUC: 0.896588
steps 5600    running time 244 seconds

steps 5800    base_loss: 0.189166    reg_loss: 0.068933    l2_loss: 0.022421    loss: 0.280520
steps 5800    v_Prec: 0.689353  v_Recall: 0.646045  v_F1: 0.666996  v_AUC: 0.895275
steps 5800    running time 251 seconds

steps 6000    base_loss: 0.181431    reg_loss: 0.068804    l2_loss: 0.023163    loss: 0.273397
steps 6000    v_Prec: 0.698439  v_Recall: 0.635827  v_F1: 0.665664  v_AUC: 0.893883
steps 6000    running time 258 seconds

steps 6200    base_loss: 0.197640    reg_loss: 0.068456    l2_loss: 0.023892    loss: 0.289988
steps 6200    v_Prec: 0.692872  v_Recall: 0.648679  v_F1: 0.670047  v_AUC: 0.896559
steps 6200    running time 265 seconds

steps 6400    base_loss: 0.183800    reg_loss: 0.068550    l2_loss: 0.024531    loss: 0.276882
steps 6400    v_Prec: 0.660670  v_Recall: 0.674224  v_F1: 0.667378  v_AUC: 0.895291
steps 6400    running time 271 seconds

steps 6600    base_loss: 0.195255    reg_loss: 0.068351    l2_loss: 0.025011    loss: 0.288617
steps 6600    v_Prec: 0.688350  v_Recall: 0.650435  v_F1: 0.668856  v_AUC: 0.895539
steps 6600    running time 278 seconds

steps 6800    base_loss: 0.210014    reg_loss: 0.068436    l2_loss: 0.025562    loss: 0.304012
steps 6800    v_Prec: 0.699550  v_Recall: 0.645885  v_F1: 0.671647  v_AUC: 0.898605
steps 6800    running time 285 seconds

steps 7000    base_loss: 0.195150    reg_loss: 0.068266    l2_loss: 0.026051    loss: 0.289467
steps 7000    v_Prec: 0.673029  v_Recall: 0.669913  v_F1: 0.671467  v_AUC: 0.900627
steps 7000    running time 292 seconds

steps 7200    base_loss: 0.195273    reg_loss: 0.068377    l2_loss: 0.026481    loss: 0.290130
steps 7200    v_Prec: 0.698813  v_Recall: 0.662888  v_F1: 0.680377  v_AUC: 0.901385
steps 7200    running time 298 seconds

steps 7400    base_loss: 0.189437    reg_loss: 0.068147    l2_loss: 0.027020    loss: 0.284604
steps 7400    v_Prec: 0.707554  v_Recall: 0.661691  v_F1: 0.683854  v_AUC: 0.902163
steps 7400    running time 306 seconds

steps 7600    base_loss: 0.202610    reg_loss: 0.068369    l2_loss: 0.027273    loss: 0.298252
steps 7600    v_Prec: 0.698336  v_Recall: 0.670073  v_F1: 0.683912  v_AUC: 0.903110
steps 7600    running time 313 seconds

steps 7800    base_loss: 0.195331    reg_loss: 0.068352    l2_loss: 0.027708    loss: 0.291391
steps 7800    v_Prec: 0.710201  v_Recall: 0.656342  v_F1: 0.682210  v_AUC: 0.903965
steps 7800    running time 321 seconds

steps 8000    base_loss: 0.195918    reg_loss: 0.067915    l2_loss: 0.028068    loss: 0.291901
steps 8000    v_Prec: 0.700329  v_Recall: 0.678694  v_F1: 0.689342  v_AUC: 0.906943
steps 8000    running time 327 seconds

steps 8200    base_loss: 0.190986    reg_loss: 0.068130    l2_loss: 0.028357    loss: 0.287472
steps 8200    v_Prec: 0.730180  v_Recall: 0.650675  v_F1: 0.688138  v_AUC: 0.906039
steps 8200    running time 335 seconds

steps 8400    base_loss: 0.197307    reg_loss: 0.068168    l2_loss: 0.028692    loss: 0.294167
steps 8400    v_Prec: 0.732176  v_Recall: 0.659935  v_F1: 0.694181  v_AUC: 0.907740
steps 8400    running time 341 seconds

steps 8600    base_loss: 0.201222    reg_loss: 0.068057    l2_loss: 0.029107    loss: 0.298387
steps 8600    v_Prec: 0.720751  v_Recall: 0.673745  v_F1: 0.696456  v_AUC: 0.909939
steps 8600    running time 349 seconds

steps 8800    base_loss: 0.193296    reg_loss: 0.067889    l2_loss: 0.029280    loss: 0.290465
steps 8800    v_Prec: 0.711681  v_Recall: 0.682366  v_F1: 0.696715  v_AUC: 0.909853
steps 8800    running time 356 seconds

steps 9000    base_loss: 0.189153    reg_loss: 0.067888    l2_loss: 0.029602    loss: 0.286644
steps 9000    v_Prec: 0.744698  v_Recall: 0.658737  v_F1: 0.699085  v_AUC: 0.911646
steps 9000    running time 364 seconds

steps 9200    base_loss: 0.191389    reg_loss: 0.067947    l2_loss: 0.029783    loss: 0.289118
steps 9200    v_Prec: 0.718086  v_Recall: 0.687475  v_F1: 0.702447  v_AUC: 0.912619
steps 9200    running time 371 seconds

steps 9400    base_loss: 0.198970    reg_loss: 0.068004    l2_loss: 0.030077    loss: 0.297052
steps 9400    v_Prec: 0.734791  v_Recall: 0.678774  v_F1: 0.705672  v_AUC: 0.913979
steps 9400    running time 379 seconds

steps 9600    base_loss: 0.189107    reg_loss: 0.067822    l2_loss: 0.030198    loss: 0.287128
steps 9600    v_Prec: 0.701852  v_Recall: 0.708071  v_F1: 0.704947  v_AUC: 0.915119
steps 9600    running time 386 seconds

steps 9800    base_loss: 0.187735    reg_loss: 0.067756    l2_loss: 0.030470    loss: 0.285960
steps 9800    v_Prec: 0.752627  v_Recall: 0.668875  v_F1: 0.708284  v_AUC: 0.916501
steps 9800    running time 393 seconds

steps 10000    base_loss: 0.198985    reg_loss: 0.067753    l2_loss: 0.030662    loss: 0.297399
steps 10000    v_Prec: 0.748662  v_Recall: 0.681249  v_F1: 0.713366  v_AUC: 0.918050
steps 10000    running time 400 seconds

steps 10200    base_loss: 0.187555    reg_loss: 0.067555    l2_loss: 0.030906    loss: 0.286016
steps 10200    v_Prec: 0.721587  v_Recall: 0.710066  v_F1: 0.715780  v_AUC: 0.920006
steps 10200    running time 408 seconds

steps 10400    base_loss: 0.195996    reg_loss: 0.067688    l2_loss: 0.031010    loss: 0.294694
steps 10400    v_Prec: 0.734984  v_Recall: 0.701365  v_F1: 0.717781  v_AUC: 0.920888
steps 10400    running time 415 seconds

steps 10600    base_loss: 0.192317    reg_loss: 0.067837    l2_loss: 0.031137    loss: 0.291291
steps 10600    v_Prec: 0.748619  v_Recall: 0.692504  v_F1: 0.719469  v_AUC: 0.922234
steps 10600    running time 423 seconds

steps 10800    base_loss: 0.180275    reg_loss: 0.067578    l2_loss: 0.031383    loss: 0.279236
steps 10800    v_Prec: 0.759615  v_Recall: 0.687395  v_F1: 0.721703  v_AUC: 0.923023
steps 10800    running time 431 seconds

steps 11000    base_loss: 0.081946    reg_loss: 0.067558    l2_loss: 0.031580    loss: 0.181085
steps 11000    v_Prec: 0.743234  v_Recall: 0.679572  v_F1: 0.709979  v_AUC: 0.916781
steps 11000    running time 438 seconds

steps 11200    base_loss: 0.075763    reg_loss: 0.067194    l2_loss: 0.031704    loss: 0.174661
steps 11200    v_Prec: 0.726931  v_Recall: 0.679173  v_F1: 0.702241  v_AUC: 0.912380
steps 11200    running time 445 seconds

steps 11400    base_loss: 0.076803    reg_loss: 0.066961    l2_loss: 0.031889    loss: 0.175652
steps 11400    v_Prec: 0.711469  v_Recall: 0.679891  v_F1: 0.695322  v_AUC: 0.908699
steps 11400    running time 452 seconds

steps 11600    base_loss: 0.083117    reg_loss: 0.067019    l2_loss: 0.032003    loss: 0.182138
steps 11600    v_Prec: 0.729703  v_Recall: 0.660094  v_F1: 0.693156  v_AUC: 0.905927
steps 11600    running time 459 seconds

steps 11800    base_loss: 0.083769    reg_loss: 0.066806    l2_loss: 0.032211    loss: 0.182787
steps 11800    v_Prec: 0.730856  v_Recall: 0.646843  v_F1: 0.686288  v_AUC: 0.903649
steps 11800    running time 465 seconds

steps 12000    base_loss: 0.080061    reg_loss: 0.066577    l2_loss: 0.032204    loss: 0.178842
steps 12000    v_Prec: 0.705043  v_Recall: 0.662888  v_F1: 0.683316  v_AUC: 0.901776
steps 12000    running time 472 seconds

steps 12200    base_loss: 0.084404    reg_loss: 0.066733    l2_loss: 0.032390    loss: 0.183528
steps 12200    v_Prec: 0.729809  v_Recall: 0.651393  v_F1: 0.688375  v_AUC: 0.902541
steps 12200    running time 479 seconds

steps 12400    base_loss: 0.082895    reg_loss: 0.066370    l2_loss: 0.032446    loss: 0.181711
steps 12400    v_Prec: 0.701986  v_Recall: 0.671669  v_F1: 0.686493  v_AUC: 0.901789
steps 12400    running time 486 seconds

steps 12600    base_loss: 0.086582    reg_loss: 0.066428    l2_loss: 0.032616    loss: 0.185626
steps 12600    v_Prec: 0.704050  v_Recall: 0.667518  v_F1: 0.685297  v_AUC: 0.902308
steps 12600    running time 493 seconds

steps 12800    base_loss: 0.086806    reg_loss: 0.066479    l2_loss: 0.032629    loss: 0.185914
steps 12800    v_Prec: 0.697588  v_Recall: 0.674144  v_F1: 0.685666  v_AUC: 0.901663
steps 12800    running time 499 seconds

Early stop model F1: 0.721703
testing thre: 0.4742945
testing Prec: 0.5467394796016705
testing Recall: 0.7444957472660997
testing F1: 0.6304741521238064
testing AUC: 0.8975579465176775
overall running time 502 seconds
(0.6942770281081657, 0.6326609963547996, 0.6620384498016478, 0.8975579465176775, 0.75192815)

2019-02-24 19:59:04.320525: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 19:59:05.001754: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 19:59:05.004612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 19:59:05.004654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.760000 seconds
loading data in 30.990000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.518597    reg_loss: 0.064834    l2_loss: 0.013350    loss: 0.596781
steps 200    v_Prec: 0.162770  v_Recall: 1.000000  v_F1: 0.279969  v_AUC: 0.494746
steps 200    running time 42 seconds

steps 400    base_loss: 0.482914    reg_loss: 0.064864    l2_loss: 0.013405    loss: 0.561183
steps 400    v_Prec: 0.163261  v_Recall: 0.983808  v_F1: 0.280049  v_AUC: 0.525473
steps 400    running time 49 seconds

steps 600    base_loss: 0.485573    reg_loss: 0.065023    l2_loss: 0.013341    loss: 0.563937
steps 600    v_Prec: 0.176305  v_Recall: 0.748778  v_F1: 0.285409  v_AUC: 0.562442
steps 600    running time 57 seconds

steps 800    base_loss: 0.463906    reg_loss: 0.064854    l2_loss: 0.013299    loss: 0.542059
steps 800    v_Prec: 0.201636  v_Recall: 0.572906  v_F1: 0.298289  v_AUC: 0.589866
steps 800    running time 64 seconds

steps 1000    base_loss: 0.450442    reg_loss: 0.064683    l2_loss: 0.013211    loss: 0.528335
steps 1000    v_Prec: 0.210315  v_Recall: 0.631182  v_F1: 0.315503  v_AUC: 0.623785
steps 1000    running time 72 seconds

steps 1200    base_loss: 0.440283    reg_loss: 0.064554    l2_loss: 0.013225    loss: 0.518061
steps 1200    v_Prec: 0.271586  v_Recall: 0.494188  v_F1: 0.350533  v_AUC: 0.663596
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.421519    reg_loss: 0.064320    l2_loss: 0.013283    loss: 0.499122
steps 1400    v_Prec: 0.389459  v_Recall: 0.434790  v_F1: 0.410878  v_AUC: 0.711221
steps 1400    running time 87 seconds

steps 1600    base_loss: 0.398580    reg_loss: 0.064117    l2_loss: 0.013365    loss: 0.476062
steps 1600    v_Prec: 0.474933  v_Recall: 0.455631  v_F1: 0.465082  v_AUC: 0.750402
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.381520    reg_loss: 0.063934    l2_loss: 0.013528    loss: 0.458982
steps 1800    v_Prec: 0.516588  v_Recall: 0.500521  v_F1: 0.508428  v_AUC: 0.783026
steps 1800    running time 102 seconds

steps 2000    base_loss: 0.357152    reg_loss: 0.063610    l2_loss: 0.013725    loss: 0.434487
steps 2000    v_Prec: 0.567563  v_Recall: 0.501002  v_F1: 0.532209  v_AUC: 0.801240
steps 2000    running time 109 seconds

steps 2200    base_loss: 0.358746    reg_loss: 0.063827    l2_loss: 0.013852    loss: 0.436424
steps 2200    v_Prec: 0.573884  v_Recall: 0.537956  v_F1: 0.555339  v_AUC: 0.815389
steps 2200    running time 116 seconds

steps 2400    base_loss: 0.336458    reg_loss: 0.063611    l2_loss: 0.013984    loss: 0.414053
steps 2400    v_Prec: 0.587992  v_Recall: 0.558958  v_F1: 0.573108  v_AUC: 0.828623
steps 2400    running time 124 seconds

steps 2600    base_loss: 0.329302    reg_loss: 0.063817    l2_loss: 0.014203    loss: 0.407323
steps 2600    v_Prec: 0.627762  v_Recall: 0.557916  v_F1: 0.590782  v_AUC: 0.837850
steps 2600    running time 131 seconds

steps 2800    base_loss: 0.325865    reg_loss: 0.064106    l2_loss: 0.014423    loss: 0.404394
steps 2800    v_Prec: 0.642589  v_Recall: 0.563367  v_F1: 0.600376  v_AUC: 0.847078
steps 2800    running time 138 seconds

steps 3000    base_loss: 0.315114    reg_loss: 0.064032    l2_loss: 0.014693    loss: 0.393839
steps 3000    v_Prec: 0.613331  v_Recall: 0.611463  v_F1: 0.612396  v_AUC: 0.853727
steps 3000    running time 146 seconds

steps 3200    base_loss: 0.313146    reg_loss: 0.064383    l2_loss: 0.015046    loss: 0.392575
steps 3200    v_Prec: 0.660583  v_Recall: 0.597675  v_F1: 0.627557  v_AUC: 0.860028
steps 3200    running time 153 seconds

steps 3400    base_loss: 0.300241    reg_loss: 0.064278    l2_loss: 0.015410    loss: 0.379930
steps 3400    v_Prec: 0.669801  v_Recall: 0.599519  v_F1: 0.632714  v_AUC: 0.864627
steps 3400    running time 161 seconds

steps 3600    base_loss: 0.299438    reg_loss: 0.064601    l2_loss: 0.015774    loss: 0.379813
steps 3600    v_Prec: 0.669065  v_Recall: 0.611303  v_F1: 0.638881  v_AUC: 0.868273
steps 3600    running time 169 seconds

steps 3800    base_loss: 0.291630    reg_loss: 0.064475    l2_loss: 0.016177    loss: 0.372282
steps 3800    v_Prec: 0.707095  v_Recall: 0.591182  v_F1: 0.643964  v_AUC: 0.871107
steps 3800    running time 176 seconds

steps 4000    base_loss: 0.295346    reg_loss: 0.064648    l2_loss: 0.016590    loss: 0.376584
steps 4000    v_Prec: 0.710069  v_Recall: 0.599760  v_F1: 0.650269  v_AUC: 0.872974
steps 4000    running time 183 seconds

steps 4200    base_loss: 0.284526    reg_loss: 0.064725    l2_loss: 0.017024    loss: 0.366275
steps 4200    v_Prec: 0.702227  v_Recall: 0.616834  v_F1: 0.656766  v_AUC: 0.876705
steps 4200    running time 191 seconds

steps 4400    base_loss: 0.284689    reg_loss: 0.064782    l2_loss: 0.017538    loss: 0.367009
steps 4400    v_Prec: 0.695431  v_Recall: 0.636954  v_F1: 0.664909  v_AUC: 0.878171
steps 4400    running time 199 seconds

steps 4600    base_loss: 0.285342    reg_loss: 0.064972    l2_loss: 0.018058    loss: 0.368372
steps 4600    v_Prec: 0.738628  v_Recall: 0.614349  v_F1: 0.670780  v_AUC: 0.880483
steps 4600    running time 206 seconds

steps 4800    base_loss: 0.277949    reg_loss: 0.065263    l2_loss: 0.018461    loss: 0.361673
steps 4800    v_Prec: 0.723514  v_Recall: 0.631182  v_F1: 0.674202  v_AUC: 0.882291
steps 4800    running time 214 seconds

steps 5000    base_loss: 0.273504    reg_loss: 0.064878    l2_loss: 0.019025    loss: 0.357407
steps 5000    v_Prec: 0.731741  v_Recall: 0.633667  v_F1: 0.679182  v_AUC: 0.884984
steps 5000    running time 222 seconds

steps 5200    base_loss: 0.266815    reg_loss: 0.065045    l2_loss: 0.019670    loss: 0.351530
steps 5200    v_Prec: 0.742486  v_Recall: 0.631663  v_F1: 0.682606  v_AUC: 0.886922
steps 5200    running time 229 seconds

steps 5400    base_loss: 0.264699    reg_loss: 0.064938    l2_loss: 0.020011    loss: 0.349648
steps 5400    v_Prec: 0.758827  v_Recall: 0.620200  v_F1: 0.682546  v_AUC: 0.886342
steps 5400    running time 236 seconds

steps 5600    base_loss: 0.159501    reg_loss: 0.060978    l2_loss: 0.020399    loss: 0.240878
steps 5600    v_Prec: 0.771891  v_Recall: 0.611944  v_F1: 0.682674  v_AUC: 0.883987
steps 5600    running time 243 seconds

steps 5800    base_loss: 0.164595    reg_loss: 0.061530    l2_loss: 0.020521    loss: 0.246646
steps 5800    v_Prec: 0.736759  v_Recall: 0.634469  v_F1: 0.681799  v_AUC: 0.881103
steps 5800    running time 250 seconds

steps 6000    base_loss: 0.164768    reg_loss: 0.061649    l2_loss: 0.020629    loss: 0.247046
steps 6000    v_Prec: 0.763036  v_Recall: 0.618196  v_F1: 0.683022  v_AUC: 0.881629
steps 6000    running time 257 seconds

steps 6200    base_loss: 0.166901    reg_loss: 0.061547    l2_loss: 0.020935    loss: 0.249384
steps 6200    v_Prec: 0.743233  v_Recall: 0.625090  v_F1: 0.679061  v_AUC: 0.881186
steps 6200    running time 265 seconds

steps 6400    base_loss: 0.172586    reg_loss: 0.061655    l2_loss: 0.021220    loss: 0.255462
steps 6400    v_Prec: 0.754000  v_Recall: 0.623327  v_F1: 0.682464  v_AUC: 0.882236
steps 6400    running time 272 seconds

steps 6600    base_loss: 0.180204    reg_loss: 0.061805    l2_loss: 0.021456    loss: 0.263465
steps 6600    v_Prec: 0.745835  v_Recall: 0.631583  v_F1: 0.683971  v_AUC: 0.883260
steps 6600    running time 278 seconds

steps 6800    base_loss: 0.176737    reg_loss: 0.061995    l2_loss: 0.021801    loss: 0.260533
steps 6800    v_Prec: 0.733783  v_Recall: 0.645611  v_F1: 0.686879  v_AUC: 0.885251
steps 6800    running time 286 seconds

steps 7000    base_loss: 0.176983    reg_loss: 0.061872    l2_loss: 0.021954    loss: 0.260809
steps 7000    v_Prec: 0.747197  v_Recall: 0.641122  v_F1: 0.690107  v_AUC: 0.885890
steps 7000    running time 293 seconds

steps 7200    base_loss: 0.172741    reg_loss: 0.061971    l2_loss: 0.022183    loss: 0.256896
steps 7200    v_Prec: 0.763821  v_Recall: 0.634629  v_F1: 0.693257  v_AUC: 0.886803
steps 7200    running time 300 seconds

steps 7400    base_loss: 0.175136    reg_loss: 0.061980    l2_loss: 0.022289    loss: 0.259405
steps 7400    v_Prec: 0.770698  v_Recall: 0.637996  v_F1: 0.698097  v_AUC: 0.888925
steps 7400    running time 308 seconds

steps 7600    base_loss: 0.174191    reg_loss: 0.061976    l2_loss: 0.022318    loss: 0.258485
steps 7600    v_Prec: 0.789426  v_Recall: 0.630782  v_F1: 0.701243  v_AUC: 0.889923
steps 7600    running time 316 seconds

steps 7800    base_loss: 0.176323    reg_loss: 0.062188    l2_loss: 0.022412    loss: 0.260924
steps 7800    v_Prec: 0.775015  v_Recall: 0.642004  v_F1: 0.702267  v_AUC: 0.890821
steps 7800    running time 323 seconds

steps 8000    base_loss: 0.168365    reg_loss: 0.061782    l2_loss: 0.022615    loss: 0.252762
steps 8000    v_Prec: 0.768998  v_Recall: 0.652986  v_F1: 0.706260  v_AUC: 0.891823
steps 8000    running time 331 seconds

steps 8200    base_loss: 0.179728    reg_loss: 0.062149    l2_loss: 0.022764    loss: 0.264641
steps 8200    v_Prec: 0.771981  v_Recall: 0.652425  v_F1: 0.707186  v_AUC: 0.892735
steps 8200    running time 338 seconds

steps 8400    base_loss: 0.175927    reg_loss: 0.062089    l2_loss: 0.022845    loss: 0.260861
steps 8400    v_Prec: 0.753076  v_Recall: 0.672064  v_F1: 0.710268  v_AUC: 0.894320
steps 8400    running time 346 seconds

steps 8600    base_loss: 0.179281    reg_loss: 0.062320    l2_loss: 0.022897    loss: 0.264498
steps 8600    v_Prec: 0.770715  v_Recall: 0.665812  v_F1: 0.714433  v_AUC: 0.896625
steps 8600    running time 353 seconds

steps 8800    base_loss: 0.183134    reg_loss: 0.062234    l2_loss: 0.023032    loss: 0.268401
steps 8800    v_Prec: 0.783422  v_Recall: 0.657635  v_F1: 0.715039  v_AUC: 0.897089
steps 8800    running time 360 seconds

steps 9000    base_loss: 0.189957    reg_loss: 0.062253    l2_loss: 0.023162    loss: 0.275372
steps 9000    v_Prec: 0.783281  v_Recall: 0.661723  v_F1: 0.717389  v_AUC: 0.899665
steps 9000    running time 368 seconds

steps 9200    base_loss: 0.179711    reg_loss: 0.062024    l2_loss: 0.023139    loss: 0.264873
steps 9200    v_Prec: 0.802646  v_Recall: 0.651703  v_F1: 0.719342  v_AUC: 0.899882
steps 9200    running time 375 seconds

steps 9400    base_loss: 0.175847    reg_loss: 0.062179    l2_loss: 0.023205    loss: 0.261231
steps 9400    v_Prec: 0.798065  v_Recall: 0.661162  v_F1: 0.723192  v_AUC: 0.901566
steps 9400    running time 383 seconds

steps 9600    base_loss: 0.172683    reg_loss: 0.061797    l2_loss: 0.023154    loss: 0.257634
steps 9600    v_Prec: 0.785701  v_Recall: 0.673026  v_F1: 0.725012  v_AUC: 0.902541
steps 9600    running time 390 seconds

steps 9800    base_loss: 0.176781    reg_loss: 0.062280    l2_loss: 0.023335    loss: 0.262396
steps 9800    v_Prec: 0.782101  v_Recall: 0.676713  v_F1: 0.725601  v_AUC: 0.904474
steps 9800    running time 398 seconds

steps 10000    base_loss: 0.187921    reg_loss: 0.062272    l2_loss: 0.023431    loss: 0.273624
steps 10000    v_Prec: 0.775601  v_Recall: 0.685451  v_F1: 0.727745  v_AUC: 0.906077
steps 10000    running time 405 seconds

steps 10200    base_loss: 0.173402    reg_loss: 0.062237    l2_loss: 0.023458    loss: 0.259097
steps 10200    v_Prec: 0.785218  v_Recall: 0.688096  v_F1: 0.733456  v_AUC: 0.906976
steps 10200    running time 413 seconds

steps 10400    base_loss: 0.173148    reg_loss: 0.062043    l2_loss: 0.023462    loss: 0.258653
steps 10400    v_Prec: 0.817384  v_Recall: 0.664128  v_F1: 0.732829  v_AUC: 0.907441
steps 10400    running time 421 seconds

steps 10600    base_loss: 0.180664    reg_loss: 0.062223    l2_loss: 0.023516    loss: 0.266403
steps 10600    v_Prec: 0.798034  v_Recall: 0.676874  v_F1: 0.732477  v_AUC: 0.908224
steps 10600    running time 428 seconds

steps 10800    base_loss: 0.167567    reg_loss: 0.061463    l2_loss: 0.023571    loss: 0.252602
steps 10800    v_Prec: 0.794725  v_Recall: 0.688337  v_F1: 0.737715  v_AUC: 0.909854
steps 10800    running time 435 seconds

steps 11000    base_loss: 0.047659    reg_loss: 0.057338    l2_loss: 0.023303    loss: 0.128299
steps 11000    v_Prec: 0.804406  v_Recall: 0.679118  v_F1: 0.736472  v_AUC: 0.907094
steps 11000    running time 442 seconds

steps 11200    base_loss: 0.048926    reg_loss: 0.057340    l2_loss: 0.022666    loss: 0.128932
steps 11200    v_Prec: 0.788898  v_Recall: 0.682405  v_F1: 0.731797  v_AUC: 0.903724
steps 11200    running time 449 seconds

steps 11400    base_loss: 0.045652    reg_loss: 0.057246    l2_loss: 0.022346    loss: 0.125243
steps 11400    v_Prec: 0.780833  v_Recall: 0.685130  v_F1: 0.729858  v_AUC: 0.901261
steps 11400    running time 456 seconds

steps 11600    base_loss: 0.045898    reg_loss: 0.057318    l2_loss: 0.021895    loss: 0.125110
steps 11600    v_Prec: 0.778276  v_Recall: 0.681764  v_F1: 0.726830  v_AUC: 0.900438
steps 11600    running time 463 seconds

steps 11800    base_loss: 0.043681    reg_loss: 0.057361    l2_loss: 0.021613    loss: 0.122656
steps 11800    v_Prec: 0.756783  v_Recall: 0.693146  v_F1: 0.723568  v_AUC: 0.898918
steps 11800    running time 470 seconds

steps 12000    base_loss: 0.049857    reg_loss: 0.056926    l2_loss: 0.021386    loss: 0.128169
steps 12000    v_Prec: 0.766576  v_Recall: 0.678397  v_F1: 0.719796  v_AUC: 0.897192
steps 12000    running time 476 seconds

steps 12200    base_loss: 0.053523    reg_loss: 0.057101    l2_loss: 0.021042    loss: 0.131666
steps 12200    v_Prec: 0.782555  v_Recall: 0.663808  v_F1: 0.718307  v_AUC: 0.897114
steps 12200    running time 483 seconds

steps 12400    base_loss: 0.047194    reg_loss: 0.056889    l2_loss: 0.020826    loss: 0.124909
steps 12400    v_Prec: 0.777218  v_Recall: 0.667255  v_F1: 0.718050  v_AUC: 0.896469
steps 12400    running time 490 seconds

steps 12600    base_loss: 0.048731    reg_loss: 0.056770    l2_loss: 0.020575    loss: 0.126076
steps 12600    v_Prec: 0.776869  v_Recall: 0.662285  v_F1: 0.715015  v_AUC: 0.895374
steps 12600    running time 496 seconds

steps 12800    base_loss: 0.049671    reg_loss: 0.056661    l2_loss: 0.020394    loss: 0.126726
steps 12800    v_Prec: 0.763000  v_Recall: 0.672786  v_F1: 0.715059  v_AUC: 0.896227
steps 12800    running time 503 seconds

Early stop model F1: 0.737715
testing thre: 0.5272135
testing Prec: 0.644118734973183
testing Recall: 0.6770838396111786
testing F1: 0.6601900338838472
testing AUC: 0.8855849031674964
overall running time 506 seconds
(0.7361793079544798, 0.6193924665856622, 0.6727551074275457, 0.8855849031674964, 0.70573896)

2019-02-24 20:05:06.295021: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 20:05:06.750964: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 20:05:06.752566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 20:05:06.752606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.290000 seconds
loading data in 29.320000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.765037    reg_loss: 0.064771    l2_loss: 0.013358    loss: 1.843166
steps 200    v_Prec: 0.164491  v_Recall: 0.988443  v_F1: 0.282046  v_AUC: 0.503197
steps 200    running time 40 seconds

steps 400    base_loss: 1.259387    reg_loss: 0.064738    l2_loss: 0.013400    loss: 1.337525
steps 400    v_Prec: 0.170983  v_Recall: 0.909931  v_F1: 0.287872  v_AUC: 0.548763
steps 400    running time 48 seconds

steps 600    base_loss: 0.645578    reg_loss: 0.064310    l2_loss: 0.013502    loss: 0.723391
steps 600    v_Prec: 0.180228  v_Recall: 0.766380  v_F1: 0.291828  v_AUC: 0.570532
steps 600    running time 56 seconds

steps 800    base_loss: 0.503808    reg_loss: 0.064013    l2_loss: 0.013322    loss: 0.581143
steps 800    v_Prec: 0.208673  v_Recall: 0.536187  v_F1: 0.300427  v_AUC: 0.595592
steps 800    running time 63 seconds

steps 1000    base_loss: 0.480139    reg_loss: 0.063640    l2_loss: 0.012976    loss: 0.556755
steps 1000    v_Prec: 0.195749  v_Recall: 0.612944  v_F1: 0.296734  v_AUC: 0.591428
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.479483    reg_loss: 0.063389    l2_loss: 0.012612    loss: 0.555484
steps 1200    v_Prec: 0.230337  v_Recall: 0.503029  v_F1: 0.315984  v_AUC: 0.623650
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.472786    reg_loss: 0.062895    l2_loss: 0.012324    loss: 0.548005
steps 1400    v_Prec: 0.224850  v_Recall: 0.597162  v_F1: 0.326691  v_AUC: 0.630945
steps 1400    running time 85 seconds

steps 1600    base_loss: 0.453388    reg_loss: 0.062018    l2_loss: 0.012075    loss: 0.527481
steps 1600    v_Prec: 0.228664  v_Recall: 0.566794  v_F1: 0.325864  v_AUC: 0.638764
steps 1600    running time 92 seconds

steps 1800    base_loss: 0.445731    reg_loss: 0.060924    l2_loss: 0.012036    loss: 0.518692
steps 1800    v_Prec: 0.388567  v_Recall: 0.422047  v_F1: 0.404615  v_AUC: 0.723252
steps 1800    running time 99 seconds

steps 2000    base_loss: 0.417959    reg_loss: 0.059469    l2_loss: 0.012172    loss: 0.489600
steps 2000    v_Prec: 0.472924  v_Recall: 0.477523  v_F1: 0.475212  v_AUC: 0.773446
steps 2000    running time 106 seconds

steps 2200    base_loss: 0.386527    reg_loss: 0.058156    l2_loss: 0.012458    loss: 0.457141
steps 2200    v_Prec: 0.567257  v_Recall: 0.484696  v_F1: 0.522737  v_AUC: 0.805936
steps 2200    running time 114 seconds

steps 2400    base_loss: 0.358870    reg_loss: 0.057074    l2_loss: 0.012929    loss: 0.428873
steps 2400    v_Prec: 0.604696  v_Recall: 0.523434  v_F1: 0.561138  v_AUC: 0.830907
steps 2400    running time 121 seconds

steps 2600    base_loss: 0.339336    reg_loss: 0.056165    l2_loss: 0.013397    loss: 0.408899
steps 2600    v_Prec: 0.616647  v_Recall: 0.572214  v_F1: 0.593600  v_AUC: 0.849075
steps 2600    running time 129 seconds

steps 2800    base_loss: 0.316265    reg_loss: 0.055262    l2_loss: 0.013903    loss: 0.385429
steps 2800    v_Prec: 0.642724  v_Recall: 0.579149  v_F1: 0.609283  v_AUC: 0.859387
steps 2800    running time 136 seconds

steps 3000    base_loss: 0.312542    reg_loss: 0.054507    l2_loss: 0.014408    loss: 0.381458
steps 3000    v_Prec: 0.684699  v_Recall: 0.569982  v_F1: 0.622097  v_AUC: 0.866114
steps 3000    running time 144 seconds

steps 3200    base_loss: 0.303654    reg_loss: 0.053964    l2_loss: 0.015058    loss: 0.372676
steps 3200    v_Prec: 0.688669  v_Recall: 0.587119  v_F1: 0.633853  v_AUC: 0.871191
steps 3200    running time 152 seconds

steps 3400    base_loss: 0.295413    reg_loss: 0.053322    l2_loss: 0.015580    loss: 0.364316
steps 3400    v_Prec: 0.705286  v_Recall: 0.598757  v_F1: 0.647670  v_AUC: 0.877134
steps 3400    running time 159 seconds

steps 3600    base_loss: 0.296979    reg_loss: 0.052869    l2_loss: 0.016131    loss: 0.365979
steps 3600    v_Prec: 0.696318  v_Recall: 0.619560  v_F1: 0.655700  v_AUC: 0.882383
steps 3600    running time 167 seconds

steps 3800    base_loss: 0.284174    reg_loss: 0.052248    l2_loss: 0.016726    loss: 0.353147
steps 3800    v_Prec: 0.739982  v_Recall: 0.590228  v_F1: 0.656675  v_AUC: 0.885591
steps 3800    running time 174 seconds

steps 4000    base_loss: 0.283737    reg_loss: 0.051792    l2_loss: 0.017289    loss: 0.352818
steps 4000    v_Prec: 0.692761  v_Recall: 0.636936  v_F1: 0.663677  v_AUC: 0.887904
steps 4000    running time 181 seconds

steps 4200    base_loss: 0.284935    reg_loss: 0.051405    l2_loss: 0.017926    loss: 0.354266
steps 4200    v_Prec: 0.710053  v_Recall: 0.636139  v_F1: 0.671067  v_AUC: 0.893099
steps 4200    running time 189 seconds

steps 4400    base_loss: 0.281007    reg_loss: 0.050879    l2_loss: 0.018484    loss: 0.350370
steps 4400    v_Prec: 0.718589  v_Recall: 0.633190  v_F1: 0.673192  v_AUC: 0.893275
steps 4400    running time 196 seconds

steps 4600    base_loss: 0.269164    reg_loss: 0.050442    l2_loss: 0.019038    loss: 0.338644
steps 4600    v_Prec: 0.711716  v_Recall: 0.646421  v_F1: 0.677499  v_AUC: 0.894125
steps 4600    running time 204 seconds

steps 4800    base_loss: 0.274577    reg_loss: 0.050165    l2_loss: 0.019619    loss: 0.344362
steps 4800    v_Prec: 0.730724  v_Recall: 0.642834  v_F1: 0.683967  v_AUC: 0.896698
steps 4800    running time 212 seconds

steps 5000    base_loss: 0.266932    reg_loss: 0.049529    l2_loss: 0.020212    loss: 0.336673
steps 5000    v_Prec: 0.755627  v_Recall: 0.636856  v_F1: 0.691176  v_AUC: 0.900501
steps 5000    running time 219 seconds

steps 5200    base_loss: 0.262253    reg_loss: 0.049347    l2_loss: 0.020686    loss: 0.332285
steps 5200    v_Prec: 0.733716  v_Recall: 0.661725  v_F1: 0.695864  v_AUC: 0.899889
steps 5200    running time 226 seconds

steps 5400    base_loss: 0.262055    reg_loss: 0.048857    l2_loss: 0.021298    loss: 0.332210
steps 5400    v_Prec: 0.760780  v_Recall: 0.649689  v_F1: 0.700860  v_AUC: 0.900881
steps 5400    running time 234 seconds

steps 5600    base_loss: 0.185292    reg_loss: 0.047624    l2_loss: 0.021914    loss: 0.254830
steps 5600    v_Prec: 0.740978  v_Recall: 0.654631  v_F1: 0.695133  v_AUC: 0.901175
steps 5600    running time 242 seconds

steps 5800    base_loss: 0.185299    reg_loss: 0.047856    l2_loss: 0.022553    loss: 0.255709
steps 5800    v_Prec: 0.730072  v_Recall: 0.648254  v_F1: 0.686735  v_AUC: 0.899138
steps 5800    running time 248 seconds

steps 6000    base_loss: 0.177963    reg_loss: 0.047639    l2_loss: 0.023251    loss: 0.248853
steps 6000    v_Prec: 0.723868  v_Recall: 0.664036  v_F1: 0.692663  v_AUC: 0.899998
steps 6000    running time 255 seconds

steps 6200    base_loss: 0.177319    reg_loss: 0.047620    l2_loss: 0.023912    loss: 0.248851
steps 6200    v_Prec: 0.727265  v_Recall: 0.655269  v_F1: 0.689392  v_AUC: 0.896594
steps 6200    running time 262 seconds

steps 6400    base_loss: 0.176548    reg_loss: 0.047251    l2_loss: 0.024550    loss: 0.248349
steps 6400    v_Prec: 0.741764  v_Recall: 0.656863  v_F1: 0.696737  v_AUC: 0.899044
steps 6400    running time 268 seconds

steps 6600    base_loss: 0.172112    reg_loss: 0.047288    l2_loss: 0.025019    loss: 0.244419
steps 6600    v_Prec: 0.727391  v_Recall: 0.667384  v_F1: 0.696097  v_AUC: 0.899181
steps 6600    running time 275 seconds

steps 6800    base_loss: 0.192686    reg_loss: 0.047363    l2_loss: 0.025478    loss: 0.265527
steps 6800    v_Prec: 0.741220  v_Recall: 0.657740  v_F1: 0.696989  v_AUC: 0.899922
steps 6800    running time 282 seconds

steps 7000    base_loss: 0.181276    reg_loss: 0.046933    l2_loss: 0.025916    loss: 0.254125
steps 7000    v_Prec: 0.734534  v_Recall: 0.663399  v_F1: 0.697156  v_AUC: 0.897707
steps 7000    running time 289 seconds

steps 7200    base_loss: 0.185250    reg_loss: 0.046675    l2_loss: 0.026373    loss: 0.258297
steps 7200    v_Prec: 0.742104  v_Recall: 0.655508  v_F1: 0.696123  v_AUC: 0.899423
steps 7200    running time 295 seconds

steps 7400    base_loss: 0.190811    reg_loss: 0.046593    l2_loss: 0.026778    loss: 0.264181
steps 7400    v_Prec: 0.748425  v_Recall: 0.662761  v_F1: 0.702993  v_AUC: 0.901241
steps 7400    running time 302 seconds

steps 7600    base_loss: 0.190787    reg_loss: 0.046116    l2_loss: 0.027024    loss: 0.263927
steps 7600    v_Prec: 0.754296  v_Recall: 0.664833  v_F1: 0.706745  v_AUC: 0.902630
steps 7600    running time 309 seconds

steps 7800    base_loss: 0.183562    reg_loss: 0.045908    l2_loss: 0.027360    loss: 0.256830
steps 7800    v_Prec: 0.762962  v_Recall: 0.668580  v_F1: 0.712659  v_AUC: 0.903394
steps 7800    running time 317 seconds

steps 8000    base_loss: 0.195384    reg_loss: 0.045802    l2_loss: 0.027613    loss: 0.268800
steps 8000    v_Prec: 0.765493  v_Recall: 0.670493  v_F1: 0.714850  v_AUC: 0.905068
steps 8000    running time 324 seconds

steps 8200    base_loss: 0.191328    reg_loss: 0.045704    l2_loss: 0.027738    loss: 0.264770
steps 8200    v_Prec: 0.740506  v_Recall: 0.690100  v_F1: 0.714415  v_AUC: 0.905159
steps 8200    running time 332 seconds

steps 8400    base_loss: 0.188925    reg_loss: 0.045076    l2_loss: 0.027889    loss: 0.261891
steps 8400    v_Prec: 0.762156  v_Recall: 0.679659  v_F1: 0.718547  v_AUC: 0.907616
steps 8400    running time 338 seconds

steps 8600    base_loss: 0.181984    reg_loss: 0.045003    l2_loss: 0.028086    loss: 0.255074
steps 8600    v_Prec: 0.752680  v_Recall: 0.694006  v_F1: 0.722153  v_AUC: 0.909012
steps 8600    running time 346 seconds

steps 8800    base_loss: 0.188087    reg_loss: 0.044881    l2_loss: 0.028280    loss: 0.261247
steps 8800    v_Prec: 0.771186  v_Recall: 0.674558  v_F1: 0.719643  v_AUC: 0.911091
steps 8800    running time 353 seconds

steps 9000    base_loss: 0.194193    reg_loss: 0.044767    l2_loss: 0.028513    loss: 0.267472
steps 9000    v_Prec: 0.748633  v_Recall: 0.698629  v_F1: 0.722767  v_AUC: 0.909796
steps 9000    running time 360 seconds

steps 9200    base_loss: 0.190309    reg_loss: 0.044446    l2_loss: 0.028604    loss: 0.263359
steps 9200    v_Prec: 0.787952  v_Recall: 0.675594  v_F1: 0.727460  v_AUC: 0.911509
steps 9200    running time 367 seconds

steps 9400    base_loss: 0.195350    reg_loss: 0.044215    l2_loss: 0.028786    loss: 0.268351
steps 9400    v_Prec: 0.785728  v_Recall: 0.675753  v_F1: 0.726603  v_AUC: 0.912319
steps 9400    running time 375 seconds

steps 9600    base_loss: 0.187562    reg_loss: 0.044198    l2_loss: 0.028970    loss: 0.260730
steps 9600    v_Prec: 0.764525  v_Recall: 0.695361  v_F1: 0.728305  v_AUC: 0.912092
steps 9600    running time 382 seconds

steps 9800    base_loss: 0.191333    reg_loss: 0.043761    l2_loss: 0.029117    loss: 0.264211
steps 9800    v_Prec: 0.783550  v_Recall: 0.686434  v_F1: 0.731784  v_AUC: 0.913944
steps 9800    running time 389 seconds

steps 10000    base_loss: 0.193556    reg_loss: 0.043788    l2_loss: 0.029189    loss: 0.266532
steps 10000    v_Prec: 0.775085  v_Recall: 0.690818  v_F1: 0.730529  v_AUC: 0.914448
steps 10000    running time 396 seconds

steps 10200    base_loss: 0.182664    reg_loss: 0.043163    l2_loss: 0.029303    loss: 0.255131
steps 10200    v_Prec: 0.763304  v_Recall: 0.701977  v_F1: 0.731357  v_AUC: 0.914872
steps 10200    running time 403 seconds

steps 10400    base_loss: 0.185114    reg_loss: 0.043243    l2_loss: 0.029523    loss: 0.257880
steps 10400    v_Prec: 0.794990  v_Recall: 0.685557  v_F1: 0.736229  v_AUC: 0.915739
steps 10400    running time 409 seconds

steps 10600    base_loss: 0.189826    reg_loss: 0.043277    l2_loss: 0.029476    loss: 0.262579
steps 10600    v_Prec: 0.786638  v_Recall: 0.698231  v_F1: 0.739802  v_AUC: 0.916369
steps 10600    running time 417 seconds

steps 10800    base_loss: 0.172259    reg_loss: 0.042869    l2_loss: 0.029549    loss: 0.244678
steps 10800    v_Prec: 0.781409  v_Recall: 0.699506  v_F1: 0.738192  v_AUC: 0.917083
steps 10800    running time 424 seconds

steps 11000    base_loss: 0.077038    reg_loss: 0.040677    l2_loss: 0.029554    loss: 0.147270
steps 11000    v_Prec: 0.795958  v_Recall: 0.681253  v_F1: 0.734152  v_AUC: 0.912718
steps 11000    running time 431 seconds

steps 11200    base_loss: 0.073143    reg_loss: 0.040860    l2_loss: 0.029571    loss: 0.143574
steps 11200    v_Prec: 0.760573  v_Recall: 0.693767  v_F1: 0.725636  v_AUC: 0.909477
steps 11200    running time 438 seconds

steps 11400    base_loss: 0.068979    reg_loss: 0.040627    l2_loss: 0.029434    loss: 0.139039
steps 11400    v_Prec: 0.796509  v_Recall: 0.662044  v_F1: 0.723078  v_AUC: 0.907952
steps 11400    running time 444 seconds

steps 11600    base_loss: 0.069289    reg_loss: 0.040836    l2_loss: 0.029352    loss: 0.139478
steps 11600    v_Prec: 0.777788  v_Recall: 0.674876  v_F1: 0.722687  v_AUC: 0.905927
steps 11600    running time 451 seconds

steps 11800    base_loss: 0.068961    reg_loss: 0.040830    l2_loss: 0.029403    loss: 0.139195
steps 11800    v_Prec: 0.783139  v_Recall: 0.670094  v_F1: 0.722220  v_AUC: 0.905776
steps 11800    running time 458 seconds

steps 12000    base_loss: 0.072161    reg_loss: 0.040897    l2_loss: 0.029318    loss: 0.142375
steps 12000    v_Prec: 0.765115  v_Recall: 0.683883  v_F1: 0.722222  v_AUC: 0.907087
steps 12000    running time 465 seconds

steps 12200    base_loss: 0.073169    reg_loss: 0.040849    l2_loss: 0.029485    loss: 0.143503
steps 12200    v_Prec: 0.777131  v_Recall: 0.670652  v_F1: 0.719976  v_AUC: 0.903954
steps 12200    running time 471 seconds

steps 12400    base_loss: 0.076154    reg_loss: 0.041071    l2_loss: 0.029482    loss: 0.146708
steps 12400    v_Prec: 0.767237  v_Recall: 0.667862  v_F1: 0.714109  v_AUC: 0.900535
steps 12400    running time 478 seconds

steps 12600    base_loss: 0.076732    reg_loss: 0.040955    l2_loss: 0.029434    loss: 0.147121
steps 12600    v_Prec: 0.786165  v_Recall: 0.664913  v_F1: 0.720473  v_AUC: 0.903610
steps 12600    running time 485 seconds

Early stop model F1: 0.739802
testing thre: 0.44456118
testing Prec: 0.5723621463138931
testing Recall: 0.7875091130012151
testing F1: 0.662916291629163
testing AUC: 0.9113559064361054
overall running time 488 seconds
(0.7611163408826623, 0.6680437424058323, 0.711549412434643, 0.9113559064361054, 0.77829814)

