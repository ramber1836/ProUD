2019-02-17 00:10:31.567516: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 00:10:31.880530: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 00:10:31.881480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 00:10:31.881516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.200000 seconds
loading data in 110.370000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.001
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.637160    reg_loss: 0.216965    l2_loss: 1.477530    loss: 2.331656
steps 200    v_Prec: 0.156441  v_Recall: 0.998466  v_F1: 0.270499  v_AUC: 0.494785
steps 200    running time 127 seconds

steps 400    base_loss: 0.591149    reg_loss: 0.216656    l2_loss: 1.450841    loss: 2.258647
steps 400    v_Prec: 0.156498  v_Recall: 0.997378  v_F1: 0.270544  v_AUC: 0.498901
steps 400    running time 139 seconds

steps 600    base_loss: 0.530965    reg_loss: 0.215802    l2_loss: 1.398015    loss: 2.144782
steps 600    v_Prec: 0.156633  v_Recall: 0.994929  v_F1: 0.270656  v_AUC: 0.511445
steps 600    running time 151 seconds

steps 800    base_loss: 0.479504    reg_loss: 0.213525    l2_loss: 1.329026    loss: 2.022055
steps 800    v_Prec: 0.159061  v_Recall: 0.929333  v_F1: 0.271631  v_AUC: 0.526498
steps 800    running time 162 seconds

steps 1000    base_loss: 0.466016    reg_loss: 0.209615    l2_loss: 1.241072    loss: 1.916703
steps 1000    v_Prec: 0.162207  v_Recall: 0.855747  v_F1: 0.272720  v_AUC: 0.539082
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.460293    reg_loss: 0.202825    l2_loss: 1.142936    loss: 1.806054
steps 1200    v_Prec: 0.164971  v_Recall: 0.821465  v_F1: 0.274763  v_AUC: 0.552951
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.455636    reg_loss: 0.192187    l2_loss: 1.042366    loss: 1.690188
steps 1400    v_Prec: 0.190476  v_Recall: 0.611615  v_F1: 0.290486  v_AUC: 0.589451
steps 1400    running time 197 seconds

steps 1600    base_loss: 0.449041    reg_loss: 0.178654    l2_loss: 0.943260    loss: 1.570955
steps 1600    v_Prec: 0.241597  v_Recall: 0.530362  v_F1: 0.331971  v_AUC: 0.643980
steps 1600    running time 209 seconds

steps 1800    base_loss: 0.438697    reg_loss: 0.163554    l2_loss: 0.851671    loss: 1.453922
steps 1800    v_Prec: 0.311704  v_Recall: 0.523634  v_F1: 0.390785  v_AUC: 0.696201
steps 1800    running time 220 seconds

steps 2000    base_loss: 0.420116    reg_loss: 0.149534    l2_loss: 0.768282    loss: 1.337932
steps 2000    v_Prec: 0.360308  v_Recall: 0.548666  v_F1: 0.434971  v_AUC: 0.727191
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.398994    reg_loss: 0.137376    l2_loss: 0.696507    loss: 1.232877
steps 2200    v_Prec: 0.399498  v_Recall: 0.539588  v_F1: 0.459094  v_AUC: 0.746903
steps 2200    running time 243 seconds

steps 2400    base_loss: 0.383204    reg_loss: 0.128028    l2_loss: 0.632338    loss: 1.143569
steps 2400    v_Prec: 0.405326  v_Recall: 0.582057  v_F1: 0.477875  v_AUC: 0.763731
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.380697    reg_loss: 0.122153    l2_loss: 0.579259    loss: 1.082108
steps 2600    v_Prec: 0.423245  v_Recall: 0.578718  v_F1: 0.488920  v_AUC: 0.777266
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.366115    reg_loss: 0.115142    l2_loss: 0.529715    loss: 1.010972
steps 2800    v_Prec: 0.431912  v_Recall: 0.596230  v_F1: 0.500940  v_AUC: 0.790568
steps 2800    running time 279 seconds

steps 3000    base_loss: 0.358015    reg_loss: 0.112744    l2_loss: 0.488268    loss: 0.959027
steps 3000    v_Prec: 0.446628  v_Recall: 0.606990  v_F1: 0.514606  v_AUC: 0.803462
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.350462    reg_loss: 0.110317    l2_loss: 0.451552    loss: 0.912332
steps 3200    v_Prec: 0.460276  v_Recall: 0.621064  v_F1: 0.528716  v_AUC: 0.816786
steps 3200    running time 302 seconds

steps 3400    base_loss: 0.346647    reg_loss: 0.107696    l2_loss: 0.419027    loss: 0.873370
steps 3400    v_Prec: 0.476268  v_Recall: 0.649781  v_F1: 0.549656  v_AUC: 0.831776
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.337492    reg_loss: 0.105746    l2_loss: 0.389843    loss: 0.833081
steps 3600    v_Prec: 0.518113  v_Recall: 0.623340  v_F1: 0.565876  v_AUC: 0.845158
steps 3600    running time 325 seconds

steps 3800    base_loss: 0.324240    reg_loss: 0.103054    l2_loss: 0.366120    loss: 0.793413
steps 3800    v_Prec: 0.532239  v_Recall: 0.652131  v_F1: 0.586117  v_AUC: 0.857105
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.313628    reg_loss: 0.101355    l2_loss: 0.340397    loss: 0.755379
steps 4000    v_Prec: 0.521688  v_Recall: 0.695837  v_F1: 0.596308  v_AUC: 0.867459
steps 4000    running time 348 seconds

steps 4200    base_loss: 0.309158    reg_loss: 0.098978    l2_loss: 0.321457    loss: 0.729593
steps 4200    v_Prec: 0.548881  v_Recall: 0.696307  v_F1: 0.613867  v_AUC: 0.877166
steps 4200    running time 360 seconds

steps 4400    base_loss: 0.303725    reg_loss: 0.098786    l2_loss: 0.304285    loss: 0.706796
steps 4400    v_Prec: 0.558981  v_Recall: 0.709590  v_F1: 0.625345  v_AUC: 0.884433
steps 4400    running time 371 seconds

steps 4600    base_loss: 0.295059    reg_loss: 0.097179    l2_loss: 0.288433    loss: 0.680672
steps 4600    v_Prec: 0.558502  v_Recall: 0.726112  v_F1: 0.631373  v_AUC: 0.890313
steps 4600    running time 383 seconds

steps 4800    base_loss: 0.285497    reg_loss: 0.094827    l2_loss: 0.273085    loss: 0.653409
steps 4800    v_Prec: 0.569972  v_Recall: 0.727448  v_F1: 0.639153  v_AUC: 0.895090
steps 4800    running time 395 seconds

steps 5000    base_loss: 0.278994    reg_loss: 0.093894    l2_loss: 0.260858    loss: 0.633746
steps 5000    v_Prec: 0.575407  v_Recall: 0.741102  v_F1: 0.647827  v_AUC: 0.899694
steps 5000    running time 406 seconds

steps 5200    base_loss: 0.277127    reg_loss: 0.093145    l2_loss: 0.248756    loss: 0.619028
steps 5200    v_Prec: 0.584884  v_Recall: 0.735240  v_F1: 0.651500  v_AUC: 0.902522
steps 5200    running time 418 seconds

steps 5400    base_loss: 0.267835    reg_loss: 0.090723    l2_loss: 0.236092    loss: 0.594651
steps 5400    v_Prec: 0.572808  v_Recall: 0.761260  v_F1: 0.653724  v_AUC: 0.905740
steps 5400    running time 429 seconds

steps 5600    base_loss: 0.273189    reg_loss: 0.090552    l2_loss: 0.225679    loss: 0.589419
steps 5600    v_Prec: 0.582316  v_Recall: 0.762200  v_F1: 0.660225  v_AUC: 0.908601
steps 5600    running time 441 seconds

steps 5800    base_loss: 0.270129    reg_loss: 0.091328    l2_loss: 0.218499    loss: 0.579957
steps 5800    v_Prec: 0.577008  v_Recall: 0.785723  v_F1: 0.665382  v_AUC: 0.911396
steps 5800    running time 452 seconds

steps 6000    base_loss: 0.261663    reg_loss: 0.087585    l2_loss: 0.207996    loss: 0.557244
steps 6000    v_Prec: 0.574945  v_Recall: 0.792030  v_F1: 0.666251  v_AUC: 0.912112
steps 6000    running time 464 seconds

steps 6200    base_loss: 0.263025    reg_loss: 0.087652    l2_loss: 0.197243    loss: 0.547920
steps 6200    v_Prec: 0.582249  v_Recall: 0.791363  v_F1: 0.670888  v_AUC: 0.914408
steps 6200    running time 475 seconds

steps 6400    base_loss: 0.258241    reg_loss: 0.086102    l2_loss: 0.190455    loss: 0.534798
steps 6400    v_Prec: 0.583057  v_Recall: 0.795172  v_F1: 0.672792  v_AUC: 0.916685
steps 6400    running time 487 seconds

steps 6600    base_loss: 0.264500    reg_loss: 0.084832    l2_loss: 0.182057    loss: 0.531389
steps 6600    v_Prec: 0.586023  v_Recall: 0.797522  v_F1: 0.675607  v_AUC: 0.918435
steps 6600    running time 499 seconds

steps 6800    base_loss: 0.260156    reg_loss: 0.085593    l2_loss: 0.176965    loss: 0.522714
steps 6800    v_Prec: 0.587822  v_Recall: 0.797076  v_F1: 0.676640  v_AUC: 0.919077
steps 6800    running time 510 seconds

steps 7000    base_loss: 0.256181    reg_loss: 0.084816    l2_loss: 0.169053    loss: 0.510049
steps 7000    v_Prec: 0.581767  v_Recall: 0.810680  v_F1: 0.677407  v_AUC: 0.920624
steps 7000    running time 522 seconds

steps 7200    base_loss: 0.253906    reg_loss: 0.083785    l2_loss: 0.163862    loss: 0.501553
steps 7200    v_Prec: 0.580008  v_Recall: 0.820352  v_F1: 0.679555  v_AUC: 0.921404
steps 7200    running time 533 seconds

steps 7400    base_loss: 0.249310    reg_loss: 0.083018    l2_loss: 0.158964    loss: 0.491292
steps 7400    v_Prec: 0.592324  v_Recall: 0.802023  v_F1: 0.681405  v_AUC: 0.922671
steps 7400    running time 545 seconds

steps 7600    base_loss: 0.246658    reg_loss: 0.082853    l2_loss: 0.153613    loss: 0.483125
steps 7600    v_Prec: 0.592623  v_Recall: 0.807119  v_F1: 0.683436  v_AUC: 0.922745
steps 7600    running time 556 seconds

steps 7800    base_loss: 0.249265    reg_loss: 0.080339    l2_loss: 0.146995    loss: 0.476599
steps 7800    v_Prec: 0.591103  v_Recall: 0.811175  v_F1: 0.683870  v_AUC: 0.923451
steps 7800    running time 568 seconds

steps 8000    base_loss: 0.257999    reg_loss: 0.081899    l2_loss: 0.145461    loss: 0.485359
steps 8000    v_Prec: 0.591719  v_Recall: 0.815504  v_F1: 0.685818  v_AUC: 0.925147
steps 8000    running time 579 seconds

steps 8200    base_loss: 0.250971    reg_loss: 0.080232    l2_loss: 0.140665    loss: 0.471868
steps 8200    v_Prec: 0.593148  v_Recall: 0.811546  v_F1: 0.685369  v_AUC: 0.925420
steps 8200    running time 591 seconds

steps 8400    base_loss: 0.244723    reg_loss: 0.079917    l2_loss: 0.136764    loss: 0.461404
steps 8400    v_Prec: 0.586334  v_Recall: 0.826065  v_F1: 0.685855  v_AUC: 0.925085
steps 8400    running time 602 seconds

steps 8600    base_loss: 0.247063    reg_loss: 0.080124    l2_loss: 0.133312    loss: 0.460498
steps 8600    v_Prec: 0.587617  v_Recall: 0.826535  v_F1: 0.686894  v_AUC: 0.925598
steps 8600    running time 613 seconds

steps 8800    base_loss: 0.242061    reg_loss: 0.077180    l2_loss: 0.128934    loss: 0.448175
steps 8800    v_Prec: 0.594263  v_Recall: 0.811175  v_F1: 0.685980  v_AUC: 0.925822
steps 8800    running time 625 seconds

steps 9000    base_loss: 0.247247    reg_loss: 0.079130    l2_loss: 0.128122    loss: 0.454498
steps 9000    v_Prec: 0.586447  v_Recall: 0.830097  v_F1: 0.687318  v_AUC: 0.927418
steps 9000    running time 636 seconds

steps 9200    base_loss: 0.242724    reg_loss: 0.077646    l2_loss: 0.124730    loss: 0.445101
steps 9200    v_Prec: 0.587141  v_Recall: 0.831210  v_F1: 0.688176  v_AUC: 0.926845
steps 9200    running time 647 seconds

steps 9400    base_loss: 0.245954    reg_loss: 0.077250    l2_loss: 0.120854    loss: 0.444058
steps 9400    v_Prec: 0.589473  v_Recall: 0.828242  v_F1: 0.688751  v_AUC: 0.927126
steps 9400    running time 659 seconds

steps 9600    base_loss: 0.245981    reg_loss: 0.078586    l2_loss: 0.119789    loss: 0.444355
steps 9600    v_Prec: 0.593194  v_Recall: 0.816567  v_F1: 0.687184  v_AUC: 0.927444
steps 9600    running time 670 seconds

steps 9800    base_loss: 0.248247    reg_loss: 0.078781    l2_loss: 0.118060    loss: 0.445088
steps 9800    v_Prec: 0.585779  v_Recall: 0.828935  v_F1: 0.686460  v_AUC: 0.926697
steps 9800    running time 681 seconds

steps 10000    base_loss: 0.236012    reg_loss: 0.075130    l2_loss: 0.116542    loss: 0.427683
steps 10000    v_Prec: 0.594813  v_Recall: 0.814044  v_F1: 0.687371  v_AUC: 0.927439
steps 10000    running time 692 seconds

steps 10200    base_loss: 0.247392    reg_loss: 0.076465    l2_loss: 0.113928    loss: 0.437785
steps 10200    v_Prec: 0.593191  v_Recall: 0.824062  v_F1: 0.689822  v_AUC: 0.927931
steps 10200    running time 703 seconds

steps 10400    base_loss: 0.243483    reg_loss: 0.075621    l2_loss: 0.112630    loss: 0.431734
steps 10400    v_Prec: 0.592348  v_Recall: 0.830641  v_F1: 0.691543  v_AUC: 0.927896
steps 10400    running time 715 seconds

steps 10600    base_loss: 0.240827    reg_loss: 0.076693    l2_loss: 0.111342    loss: 0.428862
steps 10600    v_Prec: 0.589081  v_Recall: 0.834525  v_F1: 0.690644  v_AUC: 0.928766
steps 10600    running time 726 seconds

steps 10800    base_loss: 0.240925    reg_loss: 0.075003    l2_loss: 0.109116    loss: 0.425043
steps 10800    v_Prec: 0.594246  v_Recall: 0.827673  v_F1: 0.691800  v_AUC: 0.928735
steps 10800    running time 737 seconds

steps 11000    base_loss: 0.236792    reg_loss: 0.073888    l2_loss: 0.107444    loss: 0.418124
steps 11000    v_Prec: 0.585312  v_Recall: 0.838235  v_F1: 0.689305  v_AUC: 0.928590
steps 11000    running time 749 seconds

steps 11200    base_loss: 0.240448    reg_loss: 0.073783    l2_loss: 0.105666    loss: 0.419897
steps 11200    v_Prec: 0.584369  v_Recall: 0.839818  v_F1: 0.689184  v_AUC: 0.928957
steps 11200    running time 760 seconds

steps 11400    base_loss: 0.245179    reg_loss: 0.074434    l2_loss: 0.105133    loss: 0.424745
steps 11400    v_Prec: 0.591666  v_Recall: 0.822207  v_F1: 0.688141  v_AUC: 0.928360
steps 11400    running time 771 seconds

steps 11600    base_loss: 0.240470    reg_loss: 0.073148    l2_loss: 0.103565    loss: 0.417183
steps 11600    v_Prec: 0.594978  v_Recall: 0.829899  v_F1: 0.693073  v_AUC: 0.929533
steps 11600    running time 781 seconds

steps 11800    base_loss: 0.245410    reg_loss: 0.073830    l2_loss: 0.103645    loss: 0.422885
steps 11800    v_Prec: 0.599313  v_Recall: 0.815949  v_F1: 0.691051  v_AUC: 0.929882
steps 11800    running time 793 seconds

steps 12000    base_loss: 0.237964    reg_loss: 0.071331    l2_loss: 0.101436    loss: 0.410731
steps 12000    v_Prec: 0.586611  v_Recall: 0.832274  v_F1: 0.688176  v_AUC: 0.929422
steps 12000    running time 804 seconds

steps 12200    base_loss: 0.238917    reg_loss: 0.071785    l2_loss: 0.101399    loss: 0.412102
steps 12200    v_Prec: 0.596218  v_Recall: 0.819535  v_F1: 0.690264  v_AUC: 0.929570
steps 12200    running time 815 seconds

steps 12400    base_loss: 0.238039    reg_loss: 0.071738    l2_loss: 0.101781    loss: 0.411559
steps 12400    v_Prec: 0.599294  v_Recall: 0.819066  v_F1: 0.692153  v_AUC: 0.929625
steps 12400    running time 826 seconds

steps 12600    base_loss: 0.242871    reg_loss: 0.072497    l2_loss: 0.101407    loss: 0.416775
steps 12600    v_Prec: 0.598443  v_Recall: 0.815504  v_F1: 0.690312  v_AUC: 0.929627
steps 12600    running time 837 seconds

steps 12800    base_loss: 0.240154    reg_loss: 0.070155    l2_loss: 0.099033    loss: 0.409342
steps 12800    v_Prec: 0.594347  v_Recall: 0.825917  v_F1: 0.691253  v_AUC: 0.930247
steps 12800    running time 848 seconds

steps 13000    base_loss: 0.241628    reg_loss: 0.071869    l2_loss: 0.099112    loss: 0.412609
steps 13000    v_Prec: 0.593083  v_Recall: 0.823691  v_F1: 0.689619  v_AUC: 0.929795
steps 13000    running time 859 seconds

steps 13200    base_loss: 0.238360    reg_loss: 0.070025    l2_loss: 0.098365    loss: 0.406750
steps 13200    v_Prec: 0.597516  v_Recall: 0.814020  v_F1: 0.689164  v_AUC: 0.929445
steps 13200    running time 869 seconds

steps 13400    base_loss: 0.240929    reg_loss: 0.069650    l2_loss: 0.099003    loss: 0.409582
steps 13400    v_Prec: 0.595830  v_Recall: 0.822702  v_F1: 0.691123  v_AUC: 0.929673
steps 13400    running time 880 seconds

steps 13600    base_loss: 0.236472    reg_loss: 0.069466    l2_loss: 0.098043    loss: 0.403981
steps 13600    v_Prec: 0.593815  v_Recall: 0.824458  v_F1: 0.690382  v_AUC: 0.929704
steps 13600    running time 891 seconds

Early stop model F1: 0.693073
testing thre: 0.2371058
testing Prec: 0.4886756997329641
testing Recall: 0.788598540357801
testing F1: 0.6034239655382976
testing AUC: 0.8744895466908126
overall running time 900 seconds
(0.5656494540753907, 0.7110895082775932, 0.630085560191048, 0.8744895466908126, 0.36263645)
2019-02-17 00:20:58.957765: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 00:20:59.242077: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 00:20:59.243082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 00:20:59.243122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.360000 seconds
loading data in 110.340000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.477697    reg_loss: 0.214019    l2_loss: 0.883651    loss: 1.575366
steps 200    v_Prec: 0.157776  v_Recall: 0.999926  v_F1: 0.272547  v_AUC: 0.504631
steps 200    running time 127 seconds

steps 400    base_loss: 0.465931    reg_loss: 0.212714    l2_loss: 0.872144    loss: 1.550790
steps 400    v_Prec: 0.157771  v_Recall: 0.999975  v_F1: 0.272541  v_AUC: 0.505263
steps 400    running time 139 seconds

steps 600    base_loss: 0.474198    reg_loss: 0.211808    l2_loss: 0.846753    loss: 1.532758
steps 600    v_Prec: 0.157780  v_Recall: 0.999951  v_F1: 0.272554  v_AUC: 0.509252
steps 600    running time 150 seconds

steps 800    base_loss: 0.461618    reg_loss: 0.207858    l2_loss: 0.808475    loss: 1.477951
steps 800    v_Prec: 0.157778  v_Recall: 0.999902  v_F1: 0.272550  v_AUC: 0.519627
steps 800    running time 162 seconds

steps 1000    base_loss: 0.452520    reg_loss: 0.202516    l2_loss: 0.766895    loss: 1.421931
steps 1000    v_Prec: 0.165941  v_Recall: 0.809748  v_F1: 0.275436  v_AUC: 0.552649
steps 1000    running time 173 seconds

steps 1200    base_loss: 0.450060    reg_loss: 0.195472    l2_loss: 0.715293    loss: 1.360825
steps 1200    v_Prec: 0.222151  v_Recall: 0.562960  v_F1: 0.318585  v_AUC: 0.631816
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.435342    reg_loss: 0.186981    l2_loss: 0.668784    loss: 1.291107
steps 1400    v_Prec: 0.326378  v_Recall: 0.506963  v_F1: 0.397104  v_AUC: 0.704720
steps 1400    running time 196 seconds

steps 1600    base_loss: 0.407795    reg_loss: 0.176891    l2_loss: 0.619605    loss: 1.204290
steps 1600    v_Prec: 0.392247  v_Recall: 0.516745  v_F1: 0.445970  v_AUC: 0.736941
steps 1600    running time 208 seconds

steps 1800    base_loss: 0.391489    reg_loss: 0.167539    l2_loss: 0.576341    loss: 1.135370
steps 1800    v_Prec: 0.401883  v_Recall: 0.538859  v_F1: 0.460399  v_AUC: 0.752728
steps 1800    running time 219 seconds

steps 2000    base_loss: 0.379775    reg_loss: 0.158271    l2_loss: 0.536131    loss: 1.074177
steps 2000    v_Prec: 0.415464  v_Recall: 0.548544  v_F1: 0.472818  v_AUC: 0.766821
steps 2000    running time 231 seconds

steps 2200    base_loss: 0.376131    reg_loss: 0.150992    l2_loss: 0.497142    loss: 1.024265
steps 2200    v_Prec: 0.423346  v_Recall: 0.576542  v_F1: 0.488208  v_AUC: 0.781416
steps 2200    running time 242 seconds

steps 2400    base_loss: 0.365560    reg_loss: 0.144268    l2_loss: 0.463585    loss: 0.973412
steps 2400    v_Prec: 0.436664  v_Recall: 0.592110  v_F1: 0.502643  v_AUC: 0.794842
steps 2400    running time 254 seconds

steps 2600    base_loss: 0.358566    reg_loss: 0.138499    l2_loss: 0.432690    loss: 0.929755
steps 2600    v_Prec: 0.465915  v_Recall: 0.587992  v_F1: 0.519883  v_AUC: 0.811740
steps 2600    running time 265 seconds

steps 2800    base_loss: 0.348024    reg_loss: 0.132936    l2_loss: 0.401685    loss: 0.882645
steps 2800    v_Prec: 0.468750  v_Recall: 0.628861  v_F1: 0.537128  v_AUC: 0.826434
steps 2800    running time 277 seconds

steps 3000    base_loss: 0.338674    reg_loss: 0.127492    l2_loss: 0.374624    loss: 0.840789
steps 3000    v_Prec: 0.487660  v_Recall: 0.642836  v_F1: 0.554598  v_AUC: 0.841530
steps 3000    running time 289 seconds

steps 3200    base_loss: 0.327183    reg_loss: 0.122959    l2_loss: 0.351255    loss: 0.801397
steps 3200    v_Prec: 0.505473  v_Recall: 0.654408  v_F1: 0.570378  v_AUC: 0.854078
steps 3200    running time 300 seconds

steps 3400    base_loss: 0.312039    reg_loss: 0.118436    l2_loss: 0.330965    loss: 0.761439
steps 3400    v_Prec: 0.522049  v_Recall: 0.665220  v_F1: 0.585002  v_AUC: 0.865704
steps 3400    running time 312 seconds

steps 3600    base_loss: 0.312609    reg_loss: 0.115375    l2_loss: 0.311491    loss: 0.739474
steps 3600    v_Prec: 0.526389  v_Recall: 0.696161  v_F1: 0.599487  v_AUC: 0.876852
steps 3600    running time 323 seconds

steps 3800    base_loss: 0.303696    reg_loss: 0.112822    l2_loss: 0.294750    loss: 0.711267
steps 3800    v_Prec: 0.537321  v_Recall: 0.711435  v_F1: 0.612239  v_AUC: 0.886014
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.299550    reg_loss: 0.110265    l2_loss: 0.279518    loss: 0.689332
steps 4000    v_Prec: 0.547372  v_Recall: 0.721683  v_F1: 0.622556  v_AUC: 0.893282
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.297161    reg_loss: 0.108125    l2_loss: 0.265495    loss: 0.670782
steps 4200    v_Prec: 0.546533  v_Recall: 0.746666  v_F1: 0.631113  v_AUC: 0.898710
steps 4200    running time 358 seconds

steps 4400    base_loss: 0.280290    reg_loss: 0.104083    l2_loss: 0.251291    loss: 0.635664
steps 4400    v_Prec: 0.557824  v_Recall: 0.748333  v_F1: 0.639185  v_AUC: 0.903700
steps 4400    running time 369 seconds

steps 4600    base_loss: 0.270396    reg_loss: 0.101035    l2_loss: 0.237908    loss: 0.609339
steps 4600    v_Prec: 0.566779  v_Recall: 0.747965  v_F1: 0.644887  v_AUC: 0.907617
steps 4600    running time 381 seconds

steps 4800    base_loss: 0.268800    reg_loss: 0.099352    l2_loss: 0.227877    loss: 0.596030
steps 4800    v_Prec: 0.565111  v_Recall: 0.758483  v_F1: 0.647671  v_AUC: 0.910643
steps 4800    running time 393 seconds

steps 5000    base_loss: 0.259932    reg_loss: 0.096652    l2_loss: 0.216841    loss: 0.573426
steps 5000    v_Prec: 0.565013  v_Recall: 0.767383  v_F1: 0.650829  v_AUC: 0.912592
steps 5000    running time 404 seconds

steps 5200    base_loss: 0.258024    reg_loss: 0.094616    l2_loss: 0.206283    loss: 0.558923
steps 5200    v_Prec: 0.568850  v_Recall: 0.772776  v_F1: 0.655315  v_AUC: 0.915162
steps 5200    running time 416 seconds

steps 5400    base_loss: 0.256594    reg_loss: 0.092730    l2_loss: 0.196390    loss: 0.545713
steps 5400    v_Prec: 0.566377  v_Recall: 0.786579  v_F1: 0.658559  v_AUC: 0.917205
steps 5400    running time 427 seconds

steps 5600    base_loss: 0.254304    reg_loss: 0.090244    l2_loss: 0.187356    loss: 0.531905
steps 5600    v_Prec: 0.569930  v_Recall: 0.796362  v_F1: 0.664383  v_AUC: 0.919668
steps 5600    running time 439 seconds

steps 5800    base_loss: 0.250679    reg_loss: 0.088768    l2_loss: 0.178974    loss: 0.518422
steps 5800    v_Prec: 0.573069  v_Recall: 0.797588  v_F1: 0.666940  v_AUC: 0.921933
steps 5800    running time 451 seconds

steps 6000    base_loss: 0.249988    reg_loss: 0.088111    l2_loss: 0.171164    loss: 0.509263
steps 6000    v_Prec: 0.573039  v_Recall: 0.804894  v_F1: 0.669460  v_AUC: 0.922993
steps 6000    running time 462 seconds

steps 6200    base_loss: 0.247209    reg_loss: 0.087452    l2_loss: 0.164831    loss: 0.499491
steps 6200    v_Prec: 0.581812  v_Recall: 0.795406  v_F1: 0.672046  v_AUC: 0.924193
steps 6200    running time 473 seconds

steps 6400    base_loss: 0.250108    reg_loss: 0.085557    l2_loss: 0.157316    loss: 0.492982
steps 6400    v_Prec: 0.576597  v_Recall: 0.813156  v_F1: 0.674743  v_AUC: 0.925400
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.245324    reg_loss: 0.085199    l2_loss: 0.152366    loss: 0.482890
steps 6600    v_Prec: 0.575531  v_Recall: 0.819555  v_F1: 0.676201  v_AUC: 0.926395
steps 6600    running time 496 seconds

steps 6800    base_loss: 0.251526    reg_loss: 0.084919    l2_loss: 0.147618    loss: 0.484063
steps 6800    v_Prec: 0.579368  v_Recall: 0.814848  v_F1: 0.677222  v_AUC: 0.927496
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.241045    reg_loss: 0.082895    l2_loss: 0.141024    loss: 0.464964
steps 7000    v_Prec: 0.572538  v_Recall: 0.831617  v_F1: 0.678176  v_AUC: 0.928152
steps 7000    running time 519 seconds

steps 7200    base_loss: 0.243107    reg_loss: 0.082459    l2_loss: 0.135902    loss: 0.461468
steps 7200    v_Prec: 0.584965  v_Recall: 0.810214  v_F1: 0.679406  v_AUC: 0.928970
steps 7200    running time 531 seconds

steps 7400    base_loss: 0.237245    reg_loss: 0.080683    l2_loss: 0.130579    loss: 0.448507
steps 7400    v_Prec: 0.589912  v_Recall: 0.810631  v_F1: 0.682879  v_AUC: 0.930331
steps 7400    running time 542 seconds

steps 7600    base_loss: 0.239924    reg_loss: 0.080820    l2_loss: 0.126464    loss: 0.447208
steps 7600    v_Prec: 0.590623  v_Recall: 0.808914  v_F1: 0.682745  v_AUC: 0.930628
steps 7600    running time 554 seconds

steps 7800    base_loss: 0.239260    reg_loss: 0.079949    l2_loss: 0.122651    loss: 0.441860
steps 7800    v_Prec: 0.578758  v_Recall: 0.829925  v_F1: 0.681951  v_AUC: 0.931148
steps 7800    running time 565 seconds

steps 8000    base_loss: 0.236706    reg_loss: 0.079252    l2_loss: 0.119428    loss: 0.435386
steps 8000    v_Prec: 0.592450  v_Recall: 0.812592  v_F1: 0.685275  v_AUC: 0.932119
steps 8000    running time 576 seconds

steps 8200    base_loss: 0.235231    reg_loss: 0.077892    l2_loss: 0.114648    loss: 0.427771
steps 8200    v_Prec: 0.582597  v_Recall: 0.829460  v_F1: 0.684450  v_AUC: 0.932363
steps 8200    running time 588 seconds

steps 8400    base_loss: 0.242602    reg_loss: 0.078114    l2_loss: 0.111231    loss: 0.431947
steps 8400    v_Prec: 0.582222  v_Recall: 0.832622  v_F1: 0.685264  v_AUC: 0.932710
steps 8400    running time 599 seconds

steps 8600    base_loss: 0.233540    reg_loss: 0.077138    l2_loss: 0.109297    loss: 0.419975
steps 8600    v_Prec: 0.585503  v_Recall: 0.831372  v_F1: 0.687105  v_AUC: 0.933059
steps 8600    running time 610 seconds

steps 8800    base_loss: 0.230151    reg_loss: 0.075513    l2_loss: 0.105619    loss: 0.411283
steps 8800    v_Prec: 0.584063  v_Recall: 0.836888  v_F1: 0.687984  v_AUC: 0.933007
steps 8800    running time 621 seconds

steps 9000    base_loss: 0.236068    reg_loss: 0.076412    l2_loss: 0.103708    loss: 0.416188
steps 9000    v_Prec: 0.595238  v_Recall: 0.813352  v_F1: 0.687408  v_AUC: 0.933270
steps 9000    running time 633 seconds

steps 9200    base_loss: 0.237443    reg_loss: 0.076239    l2_loss: 0.100729    loss: 0.414410
steps 9200    v_Prec: 0.591933  v_Recall: 0.825684  v_F1: 0.689537  v_AUC: 0.933695
steps 9200    running time 644 seconds

steps 9400    base_loss: 0.235750    reg_loss: 0.075499    l2_loss: 0.097914    loss: 0.409164
steps 9400    v_Prec: 0.592399  v_Recall: 0.827032  v_F1: 0.690323  v_AUC: 0.933943
steps 9400    running time 655 seconds

steps 9600    base_loss: 0.224032    reg_loss: 0.074040    l2_loss: 0.095677    loss: 0.393749
steps 9600    v_Prec: 0.585546  v_Recall: 0.842429  v_F1: 0.690882  v_AUC: 0.934022
steps 9600    running time 667 seconds

steps 9800    base_loss: 0.234527    reg_loss: 0.074461    l2_loss: 0.094425    loss: 0.403413
steps 9800    v_Prec: 0.590659  v_Recall: 0.830612  v_F1: 0.690380  v_AUC: 0.934362
steps 9800    running time 679 seconds

steps 10000    base_loss: 0.231375    reg_loss: 0.074415    l2_loss: 0.093284    loss: 0.399073
steps 10000    v_Prec: 0.588388  v_Recall: 0.835540  v_F1: 0.690515  v_AUC: 0.934339
steps 10000    running time 690 seconds

steps 10200    base_loss: 0.238619    reg_loss: 0.074525    l2_loss: 0.091803    loss: 0.404947
steps 10200    v_Prec: 0.587685  v_Recall: 0.832769  v_F1: 0.689084  v_AUC: 0.934128
steps 10200    running time 701 seconds

steps 10400    base_loss: 0.231825    reg_loss: 0.072340    l2_loss: 0.089794    loss: 0.393958
steps 10400    v_Prec: 0.591884  v_Recall: 0.830710  v_F1: 0.691250  v_AUC: 0.935071
steps 10400    running time 712 seconds

steps 10600    base_loss: 0.236638    reg_loss: 0.073327    l2_loss: 0.088391    loss: 0.398356
steps 10600    v_Prec: 0.592186  v_Recall: 0.834633  v_F1: 0.692811  v_AUC: 0.935233
steps 10600    running time 723 seconds

steps 10800    base_loss: 0.225291    reg_loss: 0.070710    l2_loss: 0.085672    loss: 0.381672
steps 10800    v_Prec: 0.590885  v_Recall: 0.833799  v_F1: 0.691633  v_AUC: 0.935155
steps 10800    running time 735 seconds

steps 11000    base_loss: 0.230978    reg_loss: 0.072294    l2_loss: 0.086184    loss: 0.389457
steps 11000    v_Prec: 0.596900  v_Recall: 0.823306  v_F1: 0.692056  v_AUC: 0.935351
steps 11000    running time 746 seconds

steps 11200    base_loss: 0.235059    reg_loss: 0.072829    l2_loss: 0.084688    loss: 0.392577
steps 11200    v_Prec: 0.588816  v_Recall: 0.835613  v_F1: 0.690834  v_AUC: 0.934958
steps 11200    running time 756 seconds

steps 11400    base_loss: 0.232491    reg_loss: 0.071239    l2_loss: 0.083372    loss: 0.387101
steps 11400    v_Prec: 0.594274  v_Recall: 0.832622  v_F1: 0.693542  v_AUC: 0.935247
steps 11400    running time 767 seconds

steps 11600    base_loss: 0.231896    reg_loss: 0.070754    l2_loss: 0.081904    loss: 0.384554
steps 11600    v_Prec: 0.590830  v_Recall: 0.841645  v_F1: 0.694280  v_AUC: 0.935364
steps 11600    running time 779 seconds

steps 11800    base_loss: 0.231522    reg_loss: 0.070744    l2_loss: 0.081732    loss: 0.383999
steps 11800    v_Prec: 0.593224  v_Recall: 0.838335  v_F1: 0.694795  v_AUC: 0.935483
steps 11800    running time 791 seconds

steps 12000    base_loss: 0.229759    reg_loss: 0.069389    l2_loss: 0.079951    loss: 0.379099
steps 12000    v_Prec: 0.591167  v_Recall: 0.843067  v_F1: 0.694996  v_AUC: 0.935230
steps 12000    running time 802 seconds

steps 12200    base_loss: 0.223368    reg_loss: 0.069274    l2_loss: 0.079271    loss: 0.371913
steps 12200    v_Prec: 0.589017  v_Recall: 0.842846  v_F1: 0.693433  v_AUC: 0.934870
steps 12200    running time 814 seconds

steps 12400    base_loss: 0.231194    reg_loss: 0.069389    l2_loss: 0.078650    loss: 0.379233
steps 12400    v_Prec: 0.593889  v_Recall: 0.835810  v_F1: 0.694381  v_AUC: 0.935252
steps 12400    running time 825 seconds

steps 12600    base_loss: 0.231385    reg_loss: 0.069510    l2_loss: 0.078071    loss: 0.378967
steps 12600    v_Prec: 0.592953  v_Recall: 0.836717  v_F1: 0.694054  v_AUC: 0.934962
steps 12600    running time 836 seconds

steps 12800    base_loss: 0.233517    reg_loss: 0.068971    l2_loss: 0.077587    loss: 0.380074
steps 12800    v_Prec: 0.592371  v_Recall: 0.841473  v_F1: 0.695284  v_AUC: 0.935253
steps 12800    running time 846 seconds

steps 13000    base_loss: 0.230593    reg_loss: 0.068871    l2_loss: 0.077125    loss: 0.376590
steps 13000    v_Prec: 0.592630  v_Recall: 0.845763  v_F1: 0.696923  v_AUC: 0.935397
steps 13000    running time 858 seconds

steps 13200    base_loss: 0.229107    reg_loss: 0.069122    l2_loss: 0.076663    loss: 0.374892
steps 13200    v_Prec: 0.600175  v_Recall: 0.825807  v_F1: 0.695140  v_AUC: 0.934798
steps 13200    running time 870 seconds

steps 13400    base_loss: 0.227137    reg_loss: 0.067855    l2_loss: 0.075971    loss: 0.370963
steps 13400    v_Prec: 0.587573  v_Recall: 0.849956  v_F1: 0.694819  v_AUC: 0.934612
steps 13400    running time 880 seconds

steps 13600    base_loss: 0.228293    reg_loss: 0.068014    l2_loss: 0.074625    loss: 0.370933
steps 13600    v_Prec: 0.594577  v_Recall: 0.837624  v_F1: 0.695478  v_AUC: 0.934778
steps 13600    running time 891 seconds

steps 13800    base_loss: 0.234156    reg_loss: 0.067660    l2_loss: 0.074408    loss: 0.376224
steps 13800    v_Prec: 0.590907  v_Recall: 0.840885  v_F1: 0.694074  v_AUC: 0.934400
steps 13800    running time 902 seconds

steps 14000    base_loss: 0.236336    reg_loss: 0.068729    l2_loss: 0.074239    loss: 0.379305
steps 14000    v_Prec: 0.586955  v_Recall: 0.851206  v_F1: 0.694804  v_AUC: 0.934822
steps 14000    running time 913 seconds

steps 14200    base_loss: 0.229816    reg_loss: 0.067274    l2_loss: 0.073770    loss: 0.370859
steps 14200    v_Prec: 0.590874  v_Recall: 0.841620  v_F1: 0.694301  v_AUC: 0.934601
steps 14200    running time 924 seconds

steps 14400    base_loss: 0.231839    reg_loss: 0.068883    l2_loss: 0.073608    loss: 0.374330
steps 14400    v_Prec: 0.592468  v_Recall: 0.836177  v_F1: 0.693536  v_AUC: 0.935027
steps 14400    running time 935 seconds

steps 14600    base_loss: 0.231535    reg_loss: 0.068073    l2_loss: 0.072539    loss: 0.372146
steps 14600    v_Prec: 0.597801  v_Recall: 0.834486  v_F1: 0.696587  v_AUC: 0.935276
steps 14600    running time 946 seconds

steps 14800    base_loss: 0.233035    reg_loss: 0.067238    l2_loss: 0.072491    loss: 0.372763
steps 14800    v_Prec: 0.592744  v_Recall: 0.843165  v_F1: 0.696118  v_AUC: 0.934891
steps 14800    running time 957 seconds

steps 15000    base_loss: 0.229949    reg_loss: 0.067149    l2_loss: 0.073943    loss: 0.371040
steps 15000    v_Prec: 0.591279  v_Recall: 0.847112  v_F1: 0.696444  v_AUC: 0.934743
steps 15000    running time 968 seconds

Early stop model F1: 0.696923
testing thre: 0.23753168
testing Prec: 0.44719907663604597
testing Recall: 0.8207658043266929
testing F1: 0.5789524857354861
testing AUC: 0.8828678448426239
overall running time 977 seconds
(0.46894401779381245, 0.7770055570870997, 0.5848906169792156, 0.8828678448426239, 0.30080554)
2019-02-17 00:32:15.471049: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 00:32:16.103428: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 00:32:16.104580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 00:32:16.104617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 87.680000 seconds
loading data in 109.700000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0003
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 2.603419    reg_loss: 0.214791    l2_loss: 0.443203    loss: 3.261413
steps 200    v_Prec: 0.156027  v_Recall: 1.000000  v_F1: 0.269936  v_AUC: 0.481131
steps 200    running time 127 seconds

steps 400    base_loss: 2.470427    reg_loss: 0.214169    l2_loss: 0.436449    loss: 3.121045
steps 400    v_Prec: 0.156027  v_Recall: 1.000000  v_F1: 0.269936  v_AUC: 0.487259
steps 400    running time 139 seconds

steps 600    base_loss: 2.160243    reg_loss: 0.214148    l2_loss: 0.425718    loss: 2.800109
steps 600    v_Prec: 0.156027  v_Recall: 1.000000  v_F1: 0.269936  v_AUC: 0.502212
steps 600    running time 150 seconds

steps 800    base_loss: 1.650506    reg_loss: 0.214434    l2_loss: 0.410004    loss: 2.274944
steps 800    v_Prec: 0.164790  v_Recall: 0.844047  v_F1: 0.275744  v_AUC: 0.555877
steps 800    running time 161 seconds

steps 1000    base_loss: 0.901447    reg_loss: 0.217774    l2_loss: 0.392778    loss: 1.512000
steps 1000    v_Prec: 0.229633  v_Recall: 0.574035  v_F1: 0.328040  v_AUC: 0.647299
steps 1000    running time 172 seconds

steps 1200    base_loss: 0.520876    reg_loss: 0.216104    l2_loss: 0.379930    loss: 1.116910
steps 1200    v_Prec: 0.164551  v_Recall: 0.862689  v_F1: 0.276384  v_AUC: 0.554488
steps 1200    running time 184 seconds

steps 1400    base_loss: 0.446131    reg_loss: 0.207103    l2_loss: 0.363261    loss: 1.016495
steps 1400    v_Prec: 0.206878  v_Recall: 0.630085  v_F1: 0.311485  v_AUC: 0.620581
steps 1400    running time 195 seconds

steps 1600    base_loss: 0.438893    reg_loss: 0.196598    l2_loss: 0.344094    loss: 0.979584
steps 1600    v_Prec: 0.265374  v_Recall: 0.545799  v_F1: 0.357114  v_AUC: 0.673784
steps 1600    running time 206 seconds

steps 1800    base_loss: 0.427703    reg_loss: 0.184495    l2_loss: 0.324653    loss: 0.936852
steps 1800    v_Prec: 0.308212  v_Recall: 0.515432  v_F1: 0.385755  v_AUC: 0.695641
steps 1800    running time 218 seconds

steps 2000    base_loss: 0.428201    reg_loss: 0.171627    l2_loss: 0.304381    loss: 0.904209
steps 2000    v_Prec: 0.325656  v_Recall: 0.535239  v_F1: 0.404936  v_AUC: 0.708313
steps 2000    running time 230 seconds

steps 2200    base_loss: 0.428482    reg_loss: 0.159836    l2_loss: 0.285436    loss: 0.873754
steps 2200    v_Prec: 0.343036  v_Recall: 0.537842  v_F1: 0.418898  v_AUC: 0.719517
steps 2200    running time 241 seconds

steps 2400    base_loss: 0.412321    reg_loss: 0.145336    l2_loss: 0.265234    loss: 0.822891
steps 2400    v_Prec: 0.359771  v_Recall: 0.536825  v_F1: 0.430817  v_AUC: 0.728630
steps 2400    running time 253 seconds

steps 2600    base_loss: 0.407267    reg_loss: 0.133263    l2_loss: 0.246549    loss: 0.787079
steps 2600    v_Prec: 0.367360  v_Recall: 0.546518  v_F1: 0.439378  v_AUC: 0.738138
steps 2600    running time 265 seconds

steps 2800    base_loss: 0.398624    reg_loss: 0.122556    l2_loss: 0.229856    loss: 0.751035
steps 2800    v_Prec: 0.374632  v_Recall: 0.555666  v_F1: 0.447535  v_AUC: 0.747243
steps 2800    running time 276 seconds

steps 3000    base_loss: 0.394457    reg_loss: 0.113744    l2_loss: 0.213435    loss: 0.721636
steps 3000    v_Prec: 0.381364  v_Recall: 0.554476  v_F1: 0.451909  v_AUC: 0.757728
steps 3000    running time 288 seconds

steps 3200    base_loss: 0.383651    reg_loss: 0.104896    l2_loss: 0.199972    loss: 0.688519
steps 3200    v_Prec: 0.382238  v_Recall: 0.577208  v_F1: 0.459913  v_AUC: 0.768361
steps 3200    running time 299 seconds

steps 3400    base_loss: 0.382968    reg_loss: 0.100573    l2_loss: 0.187625    loss: 0.671167
steps 3400    v_Prec: 0.393113  v_Recall: 0.580133  v_F1: 0.468654  v_AUC: 0.780516
steps 3400    running time 311 seconds

steps 3600    base_loss: 0.371914    reg_loss: 0.095710    l2_loss: 0.175905    loss: 0.643530
steps 3600    v_Prec: 0.398004  v_Recall: 0.600188  v_F1: 0.478620  v_AUC: 0.792521
steps 3600    running time 323 seconds

steps 3800    base_loss: 0.365817    reg_loss: 0.092534    l2_loss: 0.166013    loss: 0.624364
steps 3800    v_Prec: 0.417563  v_Recall: 0.599519  v_F1: 0.492265  v_AUC: 0.804864
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.358919    reg_loss: 0.089065    l2_loss: 0.156577    loss: 0.604561
steps 4000    v_Prec: 0.427487  v_Recall: 0.627110  v_F1: 0.508406  v_AUC: 0.819500
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.347780    reg_loss: 0.086824    l2_loss: 0.149431    loss: 0.584035
steps 4200    v_Prec: 0.449612  v_Recall: 0.637051  v_F1: 0.527165  v_AUC: 0.832805
steps 4200    running time 357 seconds

steps 4400    base_loss: 0.338267    reg_loss: 0.084485    l2_loss: 0.142456    loss: 0.565209
steps 4400    v_Prec: 0.466404  v_Recall: 0.662485  v_F1: 0.547415  v_AUC: 0.844886
steps 4400    running time 369 seconds

steps 4600    base_loss: 0.329703    reg_loss: 0.083190    l2_loss: 0.136420    loss: 0.549313
steps 4600    v_Prec: 0.479346  v_Recall: 0.680904  v_F1: 0.562618  v_AUC: 0.857432
steps 4600    running time 381 seconds

steps 4800    base_loss: 0.319327    reg_loss: 0.082057    l2_loss: 0.131061    loss: 0.532445
steps 4800    v_Prec: 0.494942  v_Recall: 0.702323  v_F1: 0.580672  v_AUC: 0.869225
steps 4800    running time 392 seconds

steps 5000    base_loss: 0.313667    reg_loss: 0.081724    l2_loss: 0.125851    loss: 0.521241
steps 5000    v_Prec: 0.513090  v_Recall: 0.721014  v_F1: 0.599536  v_AUC: 0.880029
steps 5000    running time 404 seconds

steps 5200    base_loss: 0.302767    reg_loss: 0.080974    l2_loss: 0.121374    loss: 0.505115
steps 5200    v_Prec: 0.513408  v_Recall: 0.745631  v_F1: 0.608103  v_AUC: 0.886082
steps 5200    running time 415 seconds

steps 5400    base_loss: 0.290655    reg_loss: 0.079668    l2_loss: 0.117431    loss: 0.487753
steps 5400    v_Prec: 0.541197  v_Recall: 0.730459  v_F1: 0.621744  v_AUC: 0.893498
steps 5400    running time 427 seconds

steps 5600    base_loss: 0.283449    reg_loss: 0.078346    l2_loss: 0.113249    loss: 0.475044
steps 5600    v_Prec: 0.537443  v_Recall: 0.753811  v_F1: 0.627500  v_AUC: 0.898297
steps 5600    running time 438 seconds

steps 5800    base_loss: 0.277959    reg_loss: 0.077244    l2_loss: 0.110522    loss: 0.465725
steps 5800    v_Prec: 0.551412  v_Recall: 0.744466  v_F1: 0.633559  v_AUC: 0.902349
steps 5800    running time 450 seconds

steps 6000    base_loss: 0.278077    reg_loss: 0.077234    l2_loss: 0.107373    loss: 0.462684
steps 6000    v_Prec: 0.555688  v_Recall: 0.761769  v_F1: 0.642611  v_AUC: 0.907155
steps 6000    running time 462 seconds

steps 6200    base_loss: 0.272162    reg_loss: 0.076690    l2_loss: 0.104546    loss: 0.453398
steps 6200    v_Prec: 0.564975  v_Recall: 0.760802  v_F1: 0.648426  v_AUC: 0.910998
steps 6200    running time 474 seconds

steps 6400    base_loss: 0.269346    reg_loss: 0.075586    l2_loss: 0.101159    loss: 0.446091
steps 6400    v_Prec: 0.563900  v_Recall: 0.778577  v_F1: 0.654074  v_AUC: 0.914525
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.263296    reg_loss: 0.074542    l2_loss: 0.098365    loss: 0.436203
steps 6600    v_Prec: 0.572373  v_Recall: 0.774709  v_F1: 0.658345  v_AUC: 0.916921
steps 6600    running time 497 seconds

steps 6800    base_loss: 0.264138    reg_loss: 0.074685    l2_loss: 0.096154    loss: 0.434978
steps 6800    v_Prec: 0.569957  v_Recall: 0.788493  v_F1: 0.661646  v_AUC: 0.919092
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.254205    reg_loss: 0.073564    l2_loss: 0.093624    loss: 0.421392
steps 7000    v_Prec: 0.572122  v_Recall: 0.791814  v_F1: 0.664275  v_AUC: 0.920663
steps 7000    running time 520 seconds

steps 7200    base_loss: 0.254224    reg_loss: 0.072701    l2_loss: 0.092054    loss: 0.418978
steps 7200    v_Prec: 0.578864  v_Recall: 0.790153  v_F1: 0.668204  v_AUC: 0.922552
steps 7200    running time 531 seconds

steps 7400    base_loss: 0.254618    reg_loss: 0.072472    l2_loss: 0.090147    loss: 0.417237
steps 7400    v_Prec: 0.572646  v_Recall: 0.804507  v_F1: 0.669058  v_AUC: 0.923507
steps 7400    running time 543 seconds

steps 7600    base_loss: 0.252070    reg_loss: 0.072144    l2_loss: 0.087903    loss: 0.412118
steps 7600    v_Prec: 0.584165  v_Recall: 0.790872  v_F1: 0.671982  v_AUC: 0.925187
steps 7600    running time 555 seconds

steps 7800    base_loss: 0.250014    reg_loss: 0.071432    l2_loss: 0.085689    loss: 0.407135
steps 7800    v_Prec: 0.581467  v_Recall: 0.810109  v_F1: 0.677004  v_AUC: 0.927184
steps 7800    running time 566 seconds

steps 8000    base_loss: 0.241635    reg_loss: 0.069551    l2_loss: 0.084082    loss: 0.395269
steps 8000    v_Prec: 0.590753  v_Recall: 0.799822  v_F1: 0.679571  v_AUC: 0.927865
steps 8000    running time 577 seconds

steps 8200    base_loss: 0.245895    reg_loss: 0.070315    l2_loss: 0.083161    loss: 0.399371
steps 8200    v_Prec: 0.590656  v_Recall: 0.809514  v_F1: 0.682980  v_AUC: 0.929195
steps 8200    running time 589 seconds

steps 8400    base_loss: 0.241324    reg_loss: 0.068423    l2_loss: 0.080656    loss: 0.390403
steps 8400    v_Prec: 0.589364  v_Recall: 0.810754  v_F1: 0.682556  v_AUC: 0.929135
steps 8400    running time 601 seconds

steps 8600    base_loss: 0.244508    reg_loss: 0.069545    l2_loss: 0.080087    loss: 0.394140
steps 8600    v_Prec: 0.597410  v_Recall: 0.803813  v_F1: 0.685409  v_AUC: 0.930442
steps 8600    running time 612 seconds

steps 8800    base_loss: 0.233040    reg_loss: 0.066957    l2_loss: 0.077819    loss: 0.377816
steps 8800    v_Prec: 0.592333  v_Recall: 0.815514  v_F1: 0.686233  v_AUC: 0.931225
steps 8800    running time 623 seconds

steps 9000    base_loss: 0.236793    reg_loss: 0.067397    l2_loss: 0.076990    loss: 0.381181
steps 9000    v_Prec: 0.597485  v_Recall: 0.805722  v_F1: 0.686152  v_AUC: 0.931727
steps 9000    running time 635 seconds

steps 9200    base_loss: 0.241078    reg_loss: 0.068463    l2_loss: 0.076122    loss: 0.385663
steps 9200    v_Prec: 0.598892  v_Recall: 0.806564  v_F1: 0.687385  v_AUC: 0.932386
steps 9200    running time 646 seconds

steps 9400    base_loss: 0.239255    reg_loss: 0.066956    l2_loss: 0.074241    loss: 0.380452
steps 9400    v_Prec: 0.595103  v_Recall: 0.817026  v_F1: 0.688626  v_AUC: 0.932488
steps 9400    running time 658 seconds

steps 9600    base_loss: 0.236390    reg_loss: 0.065990    l2_loss: 0.073105    loss: 0.375485
steps 9600    v_Prec: 0.599140  v_Recall: 0.814993  v_F1: 0.690592  v_AUC: 0.933173
steps 9600    running time 669 seconds

steps 9800    base_loss: 0.235021    reg_loss: 0.066337    l2_loss: 0.072654    loss: 0.374012
steps 9800    v_Prec: 0.597918  v_Recall: 0.815687  v_F1: 0.690028  v_AUC: 0.933855
steps 9800    running time 680 seconds

steps 10000    base_loss: 0.233023    reg_loss: 0.065515    l2_loss: 0.071710    loss: 0.370248
steps 10000    v_Prec: 0.590527  v_Recall: 0.832321  v_F1: 0.690879  v_AUC: 0.933547
steps 10000    running time 691 seconds

steps 10200    base_loss: 0.232736    reg_loss: 0.064776    l2_loss: 0.070595    loss: 0.368107
steps 10200    v_Prec: 0.600964  v_Recall: 0.816356  v_F1: 0.692293  v_AUC: 0.934441
steps 10200    running time 703 seconds

steps 10400    base_loss: 0.241424    reg_loss: 0.065505    l2_loss: 0.069852    loss: 0.376782
steps 10400    v_Prec: 0.598022  v_Recall: 0.824562  v_F1: 0.693254  v_AUC: 0.934714
steps 10400    running time 715 seconds

steps 10600    base_loss: 0.239820    reg_loss: 0.064676    l2_loss: 0.069186    loss: 0.373682
steps 10600    v_Prec: 0.608802  v_Recall: 0.804804  v_F1: 0.693215  v_AUC: 0.935329
steps 10600    running time 726 seconds

steps 10800    base_loss: 0.235725    reg_loss: 0.064945    l2_loss: 0.068607    loss: 0.369278
steps 10800    v_Prec: 0.604233  v_Recall: 0.814522  v_F1: 0.693793  v_AUC: 0.935533
steps 10800    running time 737 seconds

steps 11000    base_loss: 0.232088    reg_loss: 0.063640    l2_loss: 0.067858    loss: 0.363586
steps 11000    v_Prec: 0.604446  v_Recall: 0.822405  v_F1: 0.696778  v_AUC: 0.935619
steps 11000    running time 749 seconds

steps 11200    base_loss: 0.235081    reg_loss: 0.063587    l2_loss: 0.067641    loss: 0.366309
steps 11200    v_Prec: 0.606769  v_Recall: 0.816406  v_F1: 0.696148  v_AUC: 0.935926
steps 11200    running time 760 seconds

steps 11400    base_loss: 0.234048    reg_loss: 0.063253    l2_loss: 0.066963    loss: 0.364264
steps 11400    v_Prec: 0.606629  v_Recall: 0.823074  v_F1: 0.698467  v_AUC: 0.935884
steps 11400    running time 771 seconds

steps 11600    base_loss: 0.234050    reg_loss: 0.062875    l2_loss: 0.066332    loss: 0.363257
steps 11600    v_Prec: 0.611327  v_Recall: 0.814795  v_F1: 0.698546  v_AUC: 0.935980
steps 11600    running time 783 seconds

steps 11800    base_loss: 0.234382    reg_loss: 0.062828    l2_loss: 0.065467    loss: 0.362677
steps 11800    v_Prec: 0.606066  v_Recall: 0.825256  v_F1: 0.698878  v_AUC: 0.936346
steps 11800    running time 795 seconds

steps 12000    base_loss: 0.232655    reg_loss: 0.062072    l2_loss: 0.065319    loss: 0.360045
steps 12000    v_Prec: 0.608280  v_Recall: 0.819480  v_F1: 0.698259  v_AUC: 0.936465
steps 12000    running time 806 seconds

steps 12200    base_loss: 0.231804    reg_loss: 0.062012    l2_loss: 0.064888    loss: 0.358704
steps 12200    v_Prec: 0.600025  v_Recall: 0.839609  v_F1: 0.699881  v_AUC: 0.936808
steps 12200    running time 817 seconds

steps 12400    base_loss: 0.232199    reg_loss: 0.061257    l2_loss: 0.064713    loss: 0.358169
steps 12400    v_Prec: 0.602507  v_Recall: 0.831701  v_F1: 0.698791  v_AUC: 0.935855
steps 12400    running time 829 seconds

steps 12600    base_loss: 0.232414    reg_loss: 0.060902    l2_loss: 0.063727    loss: 0.357043
steps 12600    v_Prec: 0.602999  v_Recall: 0.832470  v_F1: 0.699393  v_AUC: 0.936592
steps 12600    running time 840 seconds

steps 12800    base_loss: 0.229419    reg_loss: 0.060746    l2_loss: 0.063173    loss: 0.353339
steps 12800    v_Prec: 0.596931  v_Recall: 0.840874  v_F1: 0.698208  v_AUC: 0.936386
steps 12800    running time 851 seconds

steps 13000    base_loss: 0.230357    reg_loss: 0.060191    l2_loss: 0.062949    loss: 0.353498
steps 13000    v_Prec: 0.607913  v_Recall: 0.823868  v_F1: 0.699604  v_AUC: 0.937106
steps 13000    running time 862 seconds

steps 13200    base_loss: 0.230877    reg_loss: 0.060271    l2_loss: 0.063098    loss: 0.354245
steps 13200    v_Prec: 0.605014  v_Recall: 0.829718  v_F1: 0.699770  v_AUC: 0.936903
steps 13200    running time 872 seconds

steps 13400    base_loss: 0.227210    reg_loss: 0.059830    l2_loss: 0.063032    loss: 0.350071
steps 13400    v_Prec: 0.606676  v_Recall: 0.825454  v_F1: 0.699354  v_AUC: 0.936646
steps 13400    running time 883 seconds

steps 13600    base_loss: 0.229813    reg_loss: 0.059997    l2_loss: 0.063406    loss: 0.353216
steps 13600    v_Prec: 0.600816  v_Recall: 0.839882  v_F1: 0.700514  v_AUC: 0.936091
steps 13600    running time 894 seconds

steps 13800    base_loss: 0.226161    reg_loss: 0.059214    l2_loss: 0.062841    loss: 0.348215
steps 13800    v_Prec: 0.594057  v_Recall: 0.850418  v_F1: 0.699488  v_AUC: 0.936342
steps 13800    running time 906 seconds

steps 14000    base_loss: 0.233710    reg_loss: 0.059867    l2_loss: 0.062641    loss: 0.356217
steps 14000    v_Prec: 0.601772  v_Recall: 0.843724  v_F1: 0.702499  v_AUC: 0.936749
steps 14000    running time 917 seconds

steps 14200    base_loss: 0.228658    reg_loss: 0.058257    l2_loss: 0.061498    loss: 0.348413
steps 14200    v_Prec: 0.602184  v_Recall: 0.840898  v_F1: 0.701797  v_AUC: 0.937166
steps 14200    running time 928 seconds

steps 14400    base_loss: 0.232935    reg_loss: 0.059564    l2_loss: 0.061523    loss: 0.354023
steps 14400    v_Prec: 0.607620  v_Recall: 0.827115  v_F1: 0.700577  v_AUC: 0.936711
steps 14400    running time 939 seconds

steps 14600    base_loss: 0.231087    reg_loss: 0.059153    l2_loss: 0.061869    loss: 0.352109
steps 14600    v_Prec: 0.598387  v_Recall: 0.840774  v_F1: 0.699169  v_AUC: 0.935645
steps 14600    running time 950 seconds

steps 14800    base_loss: 0.227759    reg_loss: 0.057590    l2_loss: 0.061164    loss: 0.346513
steps 14800    v_Prec: 0.605907  v_Recall: 0.827413  v_F1: 0.699544  v_AUC: 0.936191
steps 14800    running time 961 seconds

steps 15000    base_loss: 0.226099    reg_loss: 0.058085    l2_loss: 0.061155    loss: 0.345338
steps 15000    v_Prec: 0.606014  v_Recall: 0.833313  v_F1: 0.701716  v_AUC: 0.935995
steps 15000    running time 972 seconds

steps 15200    base_loss: 0.224829    reg_loss: 0.056790    l2_loss: 0.060659    loss: 0.342279
steps 15200    v_Prec: 0.606592  v_Recall: 0.829371  v_F1: 0.700701  v_AUC: 0.936389
steps 15200    running time 983 seconds

steps 15400    base_loss: 0.232503    reg_loss: 0.059195    l2_loss: 0.061192    loss: 0.352889
steps 15400    v_Prec: 0.605870  v_Recall: 0.828008  v_F1: 0.699732  v_AUC: 0.935651
steps 15400    running time 994 seconds

steps 15600    base_loss: 0.229359    reg_loss: 0.057982    l2_loss: 0.061396    loss: 0.348738
steps 15600    v_Prec: 0.596587  v_Recall: 0.838866  v_F1: 0.697280  v_AUC: 0.935424
steps 15600    running time 1005 seconds

steps 15800    base_loss: 0.230765    reg_loss: 0.057351    l2_loss: 0.061613    loss: 0.349729
steps 15800    v_Prec: 0.603149  v_Recall: 0.831032  v_F1: 0.698986  v_AUC: 0.935341
steps 15800    running time 1016 seconds

steps 16000    base_loss: 0.228628    reg_loss: 0.057519    l2_loss: 0.061338    loss: 0.347485
steps 16000    v_Prec: 0.604674  v_Recall: 0.828008  v_F1: 0.698934  v_AUC: 0.935361
steps 16000    running time 1027 seconds

Early stop model F1: 0.702499
testing thre: 0.22191733
testing Prec: 0.41715601177447353
testing Recall: 0.8019181381581811
testing F1: 0.5488180883864336
testing AUC: 0.8671029387016207
overall running time 1036 seconds
(0.5064415911707837, 0.6764556521234457, 0.5792308313506732, 0.8671029387016207, 0.38365847)
2019-02-17 00:44:12.242046: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 00:44:12.802089: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 00:44:12.803027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 00:44:12.803065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.430000 seconds
loading data in 110.640000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0001
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 1.179222    reg_loss: 0.214716    l2_loss: 0.147776    loss: 1.541715
steps 200    v_Prec: 0.157641  v_Recall: 1.000000  v_F1: 0.272349  v_AUC: 0.484022
steps 200    running time 127 seconds

steps 400    base_loss: 1.076177    reg_loss: 0.215096    l2_loss: 0.146908    loss: 1.438181
steps 400    v_Prec: 0.157702  v_Recall: 0.998479  v_F1: 0.272383  v_AUC: 0.500104
steps 400    running time 139 seconds

steps 600    base_loss: 0.910883    reg_loss: 0.214467    l2_loss: 0.145753    loss: 1.271103
steps 600    v_Prec: 0.160434  v_Recall: 0.916896  v_F1: 0.273084  v_AUC: 0.530604
steps 600    running time 151 seconds

steps 800    base_loss: 0.714078    reg_loss: 0.213387    l2_loss: 0.143561    loss: 1.071026
steps 800    v_Prec: 0.177006  v_Recall: 0.729169  v_F1: 0.284861  v_AUC: 0.574691
steps 800    running time 162 seconds

steps 1000    base_loss: 0.544640    reg_loss: 0.211612    l2_loss: 0.141545    loss: 0.897797
steps 1000    v_Prec: 0.215825  v_Recall: 0.539283  v_F1: 0.308276  v_AUC: 0.617107
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.455158    reg_loss: 0.206915    l2_loss: 0.138812    loss: 0.800885
steps 1200    v_Prec: 0.235434  v_Recall: 0.544803  v_F1: 0.328785  v_AUC: 0.642473
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.442875    reg_loss: 0.198767    l2_loss: 0.136436    loss: 0.778078
steps 1400    v_Prec: 0.271263  v_Recall: 0.515556  v_F1: 0.355485  v_AUC: 0.670238
steps 1400    running time 197 seconds

steps 1600    base_loss: 0.443486    reg_loss: 0.188706    l2_loss: 0.132896    loss: 0.765088
steps 1600    v_Prec: 0.309405  v_Recall: 0.494406  v_F1: 0.380616  v_AUC: 0.692832
steps 1600    running time 208 seconds

steps 1800    base_loss: 0.427920    reg_loss: 0.176433    l2_loss: 0.129468    loss: 0.733821
steps 1800    v_Prec: 0.332509  v_Recall: 0.504539  v_F1: 0.400846  v_AUC: 0.710337
steps 1800    running time 220 seconds

steps 2000    base_loss: 0.427132    reg_loss: 0.164768    l2_loss: 0.125746    loss: 0.717646
steps 2000    v_Prec: 0.346970  v_Recall: 0.525444  v_F1: 0.417952  v_AUC: 0.724997
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.418197    reg_loss: 0.151726    l2_loss: 0.121703    loss: 0.691625
steps 2200    v_Prec: 0.366387  v_Recall: 0.529174  v_F1: 0.432985  v_AUC: 0.737962
steps 2200    running time 243 seconds

steps 2400    base_loss: 0.405742    reg_loss: 0.139983    l2_loss: 0.117743    loss: 0.663469
steps 2400    v_Prec: 0.370184  v_Recall: 0.557292  v_F1: 0.444864  v_AUC: 0.748660
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.400662    reg_loss: 0.129637    l2_loss: 0.113581    loss: 0.643880
steps 2600    v_Prec: 0.381286  v_Recall: 0.560310  v_F1: 0.453780  v_AUC: 0.757796
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.395843    reg_loss: 0.119661    l2_loss: 0.109235    loss: 0.624739
steps 2800    v_Prec: 0.387868  v_Recall: 0.576700  v_F1: 0.463800  v_AUC: 0.767373
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.384953    reg_loss: 0.111844    l2_loss: 0.105198    loss: 0.601995
steps 3000    v_Prec: 0.399814  v_Recall: 0.580209  v_F1: 0.473409  v_AUC: 0.779764
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.375765    reg_loss: 0.105123    l2_loss: 0.101599    loss: 0.582487
steps 3200    v_Prec: 0.404423  v_Recall: 0.601752  v_F1: 0.483737  v_AUC: 0.791451
steps 3200    running time 301 seconds

steps 3400    base_loss: 0.368510    reg_loss: 0.100230    l2_loss: 0.097837    loss: 0.566577
steps 3400    v_Prec: 0.415631  v_Recall: 0.620080  v_F1: 0.497676  v_AUC: 0.803651
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.360051    reg_loss: 0.095042    l2_loss: 0.094486    loss: 0.549578
steps 3600    v_Prec: 0.421977  v_Recall: 0.649107  v_F1: 0.511460  v_AUC: 0.815198
steps 3600    running time 324 seconds

steps 3800    base_loss: 0.361845    reg_loss: 0.093199    l2_loss: 0.091298    loss: 0.546341
steps 3800    v_Prec: 0.444294  v_Recall: 0.642654  v_F1: 0.525374  v_AUC: 0.826514
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.347073    reg_loss: 0.090623    l2_loss: 0.088384    loss: 0.526080
steps 4000    v_Prec: 0.453629  v_Recall: 0.672318  v_F1: 0.541736  v_AUC: 0.837996
steps 4000    running time 347 seconds

steps 4200    base_loss: 0.336496    reg_loss: 0.088472    l2_loss: 0.085635    loss: 0.510602
steps 4200    v_Prec: 0.470189  v_Recall: 0.686328  v_F1: 0.558062  v_AUC: 0.849885
steps 4200    running time 358 seconds

steps 4400    base_loss: 0.328122    reg_loss: 0.087867    l2_loss: 0.083296    loss: 0.499285
steps 4400    v_Prec: 0.486040  v_Recall: 0.704338  v_F1: 0.575173  v_AUC: 0.860709
steps 4400    running time 370 seconds

steps 4600    base_loss: 0.319792    reg_loss: 0.086295    l2_loss: 0.080858    loss: 0.486945
steps 4600    v_Prec: 0.505944  v_Recall: 0.705884  v_F1: 0.589420  v_AUC: 0.870877
steps 4600    running time 382 seconds

steps 4800    base_loss: 0.311755    reg_loss: 0.085339    l2_loss: 0.078723    loss: 0.475817
steps 4800    v_Prec: 0.511394  v_Recall: 0.731770  v_F1: 0.602049  v_AUC: 0.879552
steps 4800    running time 393 seconds

steps 5000    base_loss: 0.298634    reg_loss: 0.083972    l2_loss: 0.076764    loss: 0.459370
steps 5000    v_Prec: 0.533884  v_Recall: 0.713858  v_F1: 0.610891  v_AUC: 0.885325
steps 5000    running time 404 seconds

steps 5200    base_loss: 0.295048    reg_loss: 0.083296    l2_loss: 0.074725    loss: 0.453068
steps 5200    v_Prec: 0.529539  v_Recall: 0.744896  v_F1: 0.619022  v_AUC: 0.891837
steps 5200    running time 416 seconds

steps 5400    base_loss: 0.286451    reg_loss: 0.081804    l2_loss: 0.073572    loss: 0.441826
steps 5400    v_Prec: 0.535735  v_Recall: 0.761802  v_F1: 0.629075  v_AUC: 0.896981
steps 5400    running time 428 seconds

steps 5600    base_loss: 0.282505    reg_loss: 0.081770    l2_loss: 0.071611    loss: 0.435885
steps 5600    v_Prec: 0.548243  v_Recall: 0.757729  v_F1: 0.636185  v_AUC: 0.902158
steps 5600    running time 439 seconds

steps 5800    base_loss: 0.275637    reg_loss: 0.080719    l2_loss: 0.070177    loss: 0.426533
steps 5800    v_Prec: 0.553230  v_Recall: 0.767200  v_F1: 0.642878  v_AUC: 0.905944
steps 5800    running time 451 seconds

steps 6000    base_loss: 0.271044    reg_loss: 0.078634    l2_loss: 0.068621    loss: 0.418300
steps 6000    v_Prec: 0.561547  v_Recall: 0.762931  v_F1: 0.646929  v_AUC: 0.909503
steps 6000    running time 462 seconds

steps 6200    base_loss: 0.268893    reg_loss: 0.079494    l2_loss: 0.067381    loss: 0.415768
steps 6200    v_Prec: 0.565505  v_Recall: 0.769654  v_F1: 0.651972  v_AUC: 0.912935
steps 6200    running time 474 seconds

steps 6400    base_loss: 0.263110    reg_loss: 0.078729    l2_loss: 0.066069    loss: 0.407909
steps 6400    v_Prec: 0.569874  v_Recall: 0.777235  v_F1: 0.657595  v_AUC: 0.915945
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.261378    reg_loss: 0.077949    l2_loss: 0.065105    loss: 0.404432
steps 6600    v_Prec: 0.567235  v_Recall: 0.795613  v_F1: 0.662289  v_AUC: 0.918123
steps 6600    running time 497 seconds

steps 6800    base_loss: 0.264659    reg_loss: 0.077915    l2_loss: 0.063902    loss: 0.406476
steps 6800    v_Prec: 0.570467  v_Recall: 0.800299  v_F1: 0.666115  v_AUC: 0.920162
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.256051    reg_loss: 0.077189    l2_loss: 0.062664    loss: 0.395904
steps 7000    v_Prec: 0.572897  v_Recall: 0.805256  v_F1: 0.669489  v_AUC: 0.922331
steps 7000    running time 520 seconds

steps 7200    base_loss: 0.247046    reg_loss: 0.074076    l2_loss: 0.061403    loss: 0.382525
steps 7200    v_Prec: 0.576842  v_Recall: 0.808323  v_F1: 0.673240  v_AUC: 0.923982
steps 7200    running time 532 seconds

steps 7400    base_loss: 0.245065    reg_loss: 0.074235    l2_loss: 0.060547    loss: 0.379847
steps 7400    v_Prec: 0.584061  v_Recall: 0.800913  v_F1: 0.675510  v_AUC: 0.925503
steps 7400    running time 543 seconds

steps 7600    base_loss: 0.250011    reg_loss: 0.073893    l2_loss: 0.059486    loss: 0.383390
steps 7600    v_Prec: 0.575942  v_Recall: 0.823879  v_F1: 0.677953  v_AUC: 0.927160
steps 7600    running time 555 seconds

steps 7800    base_loss: 0.256506    reg_loss: 0.075723    l2_loss: 0.058823    loss: 0.391052
steps 7800    v_Prec: 0.581782  v_Recall: 0.818015  v_F1: 0.679965  v_AUC: 0.928417
steps 7800    running time 567 seconds

steps 8000    base_loss: 0.254726    reg_loss: 0.075980    l2_loss: 0.057932    loss: 0.388638
steps 8000    v_Prec: 0.589983  v_Recall: 0.812739  v_F1: 0.683674  v_AUC: 0.930336
steps 8000    running time 578 seconds

steps 8200    base_loss: 0.242038    reg_loss: 0.072382    l2_loss: 0.056479    loss: 0.370899
steps 8200    v_Prec: 0.587577  v_Recall: 0.818162  v_F1: 0.683958  v_AUC: 0.930697
steps 8200    running time 590 seconds

steps 8400    base_loss: 0.242791    reg_loss: 0.072919    l2_loss: 0.055882    loss: 0.371592
steps 8400    v_Prec: 0.587232  v_Recall: 0.825130  v_F1: 0.686145  v_AUC: 0.931770
steps 8400    running time 602 seconds

steps 8600    base_loss: 0.248112    reg_loss: 0.073524    l2_loss: 0.055229    loss: 0.376865
steps 8600    v_Prec: 0.594397  v_Recall: 0.816223  v_F1: 0.687868  v_AUC: 0.932967
steps 8600    running time 614 seconds

steps 8800    base_loss: 0.238284    reg_loss: 0.070557    l2_loss: 0.054253    loss: 0.363095
steps 8800    v_Prec: 0.592293  v_Recall: 0.825106  v_F1: 0.689579  v_AUC: 0.933781
steps 8800    running time 625 seconds

steps 9000    base_loss: 0.236229    reg_loss: 0.070399    l2_loss: 0.053639    loss: 0.360267
steps 9000    v_Prec: 0.593583  v_Recall: 0.827559  v_F1: 0.691310  v_AUC: 0.934417
steps 9000    running time 637 seconds

steps 9200    base_loss: 0.227552    reg_loss: 0.068903    l2_loss: 0.052596    loss: 0.349052
steps 9200    v_Prec: 0.600575  v_Recall: 0.819977  v_F1: 0.693333  v_AUC: 0.934655
steps 9200    running time 648 seconds

steps 9400    base_loss: 0.232950    reg_loss: 0.068539    l2_loss: 0.051864    loss: 0.353353
steps 9400    v_Prec: 0.604354  v_Recall: 0.815365  v_F1: 0.694178  v_AUC: 0.935934
steps 9400    running time 660 seconds

steps 9600    base_loss: 0.235894    reg_loss: 0.068969    l2_loss: 0.051430    loss: 0.356293
steps 9600    v_Prec: 0.600238  v_Recall: 0.830062  v_F1: 0.696685  v_AUC: 0.936499
steps 9600    running time 671 seconds

steps 9800    base_loss: 0.227844    reg_loss: 0.067988    l2_loss: 0.050588    loss: 0.346420
steps 9800    v_Prec: 0.607694  v_Recall: 0.819708  v_F1: 0.697956  v_AUC: 0.937208
steps 9800    running time 683 seconds

steps 10000    base_loss: 0.227674    reg_loss: 0.067280    l2_loss: 0.049895    loss: 0.344849
steps 10000    v_Prec: 0.604941  v_Recall: 0.829694  v_F1: 0.699712  v_AUC: 0.937612
steps 10000    running time 695 seconds

steps 10200    base_loss: 0.233646    reg_loss: 0.067748    l2_loss: 0.049364    loss: 0.350759
steps 10200    v_Prec: 0.602987  v_Recall: 0.841054  v_F1: 0.702396  v_AUC: 0.938463
steps 10200    running time 706 seconds

steps 10400    base_loss: 0.227525    reg_loss: 0.067017    l2_loss: 0.048837    loss: 0.343378
steps 10400    v_Prec: 0.610015  v_Recall: 0.826774  v_F1: 0.702044  v_AUC: 0.938794
steps 10400    running time 718 seconds

steps 10600    base_loss: 0.229510    reg_loss: 0.066969    l2_loss: 0.048217    loss: 0.344697
steps 10600    v_Prec: 0.611258  v_Recall: 0.823584  v_F1: 0.701711  v_AUC: 0.938882
steps 10600    running time 729 seconds

steps 10800    base_loss: 0.229365    reg_loss: 0.066340    l2_loss: 0.047457    loss: 0.343163
steps 10800    v_Prec: 0.606221  v_Recall: 0.840686  v_F1: 0.704456  v_AUC: 0.939328
steps 10800    running time 740 seconds

steps 11000    base_loss: 0.229489    reg_loss: 0.065998    l2_loss: 0.047186    loss: 0.342673
steps 11000    v_Prec: 0.605747  v_Recall: 0.838453  v_F1: 0.703352  v_AUC: 0.940002
steps 11000    running time 751 seconds

steps 11200    base_loss: 0.226009    reg_loss: 0.064885    l2_loss: 0.046536    loss: 0.337430
steps 11200    v_Prec: 0.607159  v_Recall: 0.836907  v_F1: 0.703757  v_AUC: 0.940291
steps 11200    running time 762 seconds

steps 11400    base_loss: 0.224511    reg_loss: 0.064887    l2_loss: 0.046128    loss: 0.335526
steps 11400    v_Prec: 0.605914  v_Recall: 0.841643  v_F1: 0.704585  v_AUC: 0.939819
steps 11400    running time 773 seconds

steps 11600    base_loss: 0.227073    reg_loss: 0.065163    l2_loss: 0.045775    loss: 0.338011
steps 11600    v_Prec: 0.612394  v_Recall: 0.834822  v_F1: 0.706515  v_AUC: 0.940206
steps 11600    running time 784 seconds

steps 11800    base_loss: 0.228817    reg_loss: 0.065146    l2_loss: 0.045568    loss: 0.339531
steps 11800    v_Prec: 0.611033  v_Recall: 0.840612  v_F1: 0.707668  v_AUC: 0.940185
steps 11800    running time 796 seconds

steps 12000    base_loss: 0.223261    reg_loss: 0.063651    l2_loss: 0.045216    loss: 0.332128
steps 12000    v_Prec: 0.610507  v_Recall: 0.837987  v_F1: 0.706385  v_AUC: 0.940608
steps 12000    running time 808 seconds

steps 12200    base_loss: 0.231873    reg_loss: 0.065147    l2_loss: 0.044943    loss: 0.341964
steps 12200    v_Prec: 0.607628  v_Recall: 0.844784  v_F1: 0.706844  v_AUC: 0.940784
steps 12200    running time 819 seconds

steps 12400    base_loss: 0.222306    reg_loss: 0.062875    l2_loss: 0.044472    loss: 0.329653
steps 12400    v_Prec: 0.606046  v_Recall: 0.850942  v_F1: 0.707913  v_AUC: 0.941038
steps 12400    running time 830 seconds

steps 12600    base_loss: 0.216331    reg_loss: 0.062738    l2_loss: 0.044244    loss: 0.323313
steps 12600    v_Prec: 0.605951  v_Recall: 0.847016  v_F1: 0.706485  v_AUC: 0.940618
steps 12600    running time 841 seconds

steps 12800    base_loss: 0.224626    reg_loss: 0.062793    l2_loss: 0.043557    loss: 0.330977
steps 12800    v_Prec: 0.611153  v_Recall: 0.844661  v_F1: 0.709180  v_AUC: 0.941015
steps 12800    running time 853 seconds

steps 13000    base_loss: 0.220872    reg_loss: 0.062006    l2_loss: 0.043323    loss: 0.326201
steps 13000    v_Prec: 0.609564  v_Recall: 0.848808  v_F1: 0.709562  v_AUC: 0.941091
steps 13000    running time 864 seconds

steps 13200    base_loss: 0.225122    reg_loss: 0.061847    l2_loss: 0.043049    loss: 0.330018
steps 13200    v_Prec: 0.607955  v_Recall: 0.851727  v_F1: 0.709486  v_AUC: 0.941402
steps 13200    running time 876 seconds

steps 13400    base_loss: 0.226423    reg_loss: 0.062570    l2_loss: 0.043003    loss: 0.331996
steps 13400    v_Prec: 0.611554  v_Recall: 0.842845  v_F1: 0.708809  v_AUC: 0.940868
steps 13400    running time 887 seconds

steps 13600    base_loss: 0.224417    reg_loss: 0.062168    l2_loss: 0.042944    loss: 0.329529
steps 13600    v_Prec: 0.605967  v_Recall: 0.853641  v_F1: 0.708791  v_AUC: 0.941169
steps 13600    running time 898 seconds

steps 13800    base_loss: 0.225736    reg_loss: 0.061397    l2_loss: 0.042334    loss: 0.329468
steps 13800    v_Prec: 0.610489  v_Recall: 0.850844  v_F1: 0.710900  v_AUC: 0.941929
steps 13800    running time 909 seconds

steps 14000    base_loss: 0.219143    reg_loss: 0.060075    l2_loss: 0.042329    loss: 0.321547
steps 14000    v_Prec: 0.611190  v_Recall: 0.851237  v_F1: 0.711513  v_AUC: 0.942322
steps 14000    running time 920 seconds

steps 14200    base_loss: 0.226357    reg_loss: 0.061862    l2_loss: 0.042232    loss: 0.330451
steps 14200    v_Prec: 0.611905  v_Recall: 0.854034  v_F1: 0.712973  v_AUC: 0.941796
steps 14200    running time 932 seconds

steps 14400    base_loss: 0.223230    reg_loss: 0.061047    l2_loss: 0.042152    loss: 0.326429
steps 14400    v_Prec: 0.608921  v_Recall: 0.856144  v_F1: 0.711674  v_AUC: 0.941685
steps 14400    running time 943 seconds

steps 14600    base_loss: 0.221868    reg_loss: 0.061263    l2_loss: 0.042021    loss: 0.325151
steps 14600    v_Prec: 0.609988  v_Recall: 0.846673  v_F1: 0.709101  v_AUC: 0.941657
steps 14600    running time 954 seconds

steps 14800    base_loss: 0.223556    reg_loss: 0.060549    l2_loss: 0.042062    loss: 0.326166
steps 14800    v_Prec: 0.613631  v_Recall: 0.844759  v_F1: 0.710880  v_AUC: 0.941723
steps 14800    running time 966 seconds

steps 15000    base_loss: 0.227445    reg_loss: 0.060083    l2_loss: 0.041704    loss: 0.329232
steps 15000    v_Prec: 0.608565  v_Recall: 0.851433  v_F1: 0.709799  v_AUC: 0.941845
steps 15000    running time 977 seconds

steps 15200    base_loss: 0.216212    reg_loss: 0.058663    l2_loss: 0.041566    loss: 0.316441
steps 15200    v_Prec: 0.613062  v_Recall: 0.850820  v_F1: 0.712633  v_AUC: 0.941908
steps 15200    running time 988 seconds

steps 15400    base_loss: 0.220011    reg_loss: 0.058874    l2_loss: 0.041168    loss: 0.320054
steps 15400    v_Prec: 0.613514  v_Recall: 0.841422  v_F1: 0.709618  v_AUC: 0.941993
steps 15400    running time 999 seconds

steps 15600    base_loss: 0.225965    reg_loss: 0.059209    l2_loss: 0.041292    loss: 0.326466
steps 15600    v_Prec: 0.610221  v_Recall: 0.850501  v_F1: 0.710599  v_AUC: 0.942240
steps 15600    running time 1010 seconds

steps 15800    base_loss: 0.220642    reg_loss: 0.058792    l2_loss: 0.041306    loss: 0.320740
steps 15800    v_Prec: 0.608680  v_Recall: 0.854132  v_F1: 0.710813  v_AUC: 0.941706
steps 15800    running time 1021 seconds

steps 16000    base_loss: 0.222653    reg_loss: 0.058386    l2_loss: 0.041187    loss: 0.322226
steps 16000    v_Prec: 0.616673  v_Recall: 0.841079  v_F1: 0.711603  v_AUC: 0.941918
steps 16000    running time 1031 seconds

steps 16200    base_loss: 0.216861    reg_loss: 0.057010    l2_loss: 0.041140    loss: 0.315011
steps 16200    v_Prec: 0.607610  v_Recall: 0.854181  v_F1: 0.710100  v_AUC: 0.941459
steps 16200    running time 1042 seconds

Early stop model F1: 0.712973
testing thre: 0.2546869
testing Prec: 0.45047230848861286
testing Recall: 0.8081716748160938
testing F1: 0.5784939424310247
testing AUC: 0.8809980990746705
overall running time 1051 seconds
(0.5370527964053511, 0.686742792472541, 0.6027430405216105, 0.8809980990746705, 0.4188714)
2019-02-17 00:56:22.026571: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 00:56:22.538495: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 00:56:22.539435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 00:56:22.539481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.590000 seconds
loading data in 110.490000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	6e-05
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.866938    reg_loss: 0.212952    l2_loss: 0.088337    loss: 1.168227
steps 200    v_Prec: 0.157722  v_Recall: 0.986092  v_F1: 0.271947  v_AUC: 0.523430
steps 200    running time 127 seconds

steps 400    base_loss: 0.776117    reg_loss: 0.212161    l2_loss: 0.088314    loss: 1.076592
steps 400    v_Prec: 0.159633  v_Recall: 0.934103  v_F1: 0.272668  v_AUC: 0.532260
steps 400    running time 139 seconds

steps 600    base_loss: 0.646112    reg_loss: 0.209464    l2_loss: 0.088315    loss: 0.943891
steps 600    v_Prec: 0.160775  v_Recall: 0.883099  v_F1: 0.272026  v_AUC: 0.535969
steps 600    running time 150 seconds

steps 800    base_loss: 0.540887    reg_loss: 0.206347    l2_loss: 0.087963    loss: 0.835197
steps 800    v_Prec: 0.157130  v_Recall: 1.000000  v_F1: 0.271585  v_AUC: 0.535436
steps 800    running time 161 seconds

steps 1000    base_loss: 0.482551    reg_loss: 0.202468    l2_loss: 0.087379    loss: 0.772399
steps 1000    v_Prec: 0.157130  v_Recall: 1.000000  v_F1: 0.271585  v_AUC: 0.540066
steps 1000    running time 172 seconds

steps 1200    base_loss: 0.462136    reg_loss: 0.196728    l2_loss: 0.086424    loss: 0.745289
steps 1200    v_Prec: 0.168870  v_Recall: 0.750492  v_F1: 0.275704  v_AUC: 0.553903
steps 1200    running time 183 seconds

steps 1400    base_loss: 0.460536    reg_loss: 0.190010    l2_loss: 0.084965    loss: 0.735511
steps 1400    v_Prec: 0.176418  v_Recall: 0.727526  v_F1: 0.283975  v_AUC: 0.577382
steps 1400    running time 195 seconds

steps 1600    base_loss: 0.450160    reg_loss: 0.181006    l2_loss: 0.083214    loss: 0.714380
steps 1600    v_Prec: 0.198836  v_Recall: 0.607203  v_F1: 0.299573  v_AUC: 0.610792
steps 1600    running time 207 seconds

steps 1800    base_loss: 0.438888    reg_loss: 0.170706    l2_loss: 0.081328    loss: 0.690922
steps 1800    v_Prec: 0.240586  v_Recall: 0.534389  v_F1: 0.331795  v_AUC: 0.656055
steps 1800    running time 218 seconds

steps 2000    base_loss: 0.433100    reg_loss: 0.161103    l2_loss: 0.079224    loss: 0.673427
steps 2000    v_Prec: 0.314184  v_Recall: 0.518585  v_F1: 0.391300  v_AUC: 0.710372
steps 2000    running time 230 seconds

steps 2200    base_loss: 0.410381    reg_loss: 0.150858    l2_loss: 0.076968    loss: 0.638207
steps 2200    v_Prec: 0.386888  v_Recall: 0.516714  v_F1: 0.442475  v_AUC: 0.739933
steps 2200    running time 241 seconds

steps 2400    base_loss: 0.394692    reg_loss: 0.142940    l2_loss: 0.075062    loss: 0.612694
steps 2400    v_Prec: 0.412689  v_Recall: 0.531435  v_F1: 0.464594  v_AUC: 0.756599
steps 2400    running time 253 seconds

steps 2600    base_loss: 0.378250    reg_loss: 0.134892    l2_loss: 0.072872    loss: 0.586014
steps 2600    v_Prec: 0.427851  v_Recall: 0.545072  v_F1: 0.479400  v_AUC: 0.770301
steps 2600    running time 265 seconds

steps 2800    base_loss: 0.373368    reg_loss: 0.129350    l2_loss: 0.071490    loss: 0.574207
steps 2800    v_Prec: 0.445803  v_Recall: 0.549429  v_F1: 0.492221  v_AUC: 0.784090
steps 2800    running time 276 seconds

steps 3000    base_loss: 0.356112    reg_loss: 0.122158    l2_loss: 0.069403    loss: 0.547673
steps 3000    v_Prec: 0.454726  v_Recall: 0.562475  v_F1: 0.502894  v_AUC: 0.796643
steps 3000    running time 288 seconds

steps 3200    base_loss: 0.364438    reg_loss: 0.120259    l2_loss: 0.067462    loss: 0.552159
steps 3200    v_Prec: 0.481732  v_Recall: 0.560211  v_F1: 0.518016  v_AUC: 0.811593
steps 3200    running time 299 seconds

steps 3400    base_loss: 0.342001    reg_loss: 0.114076    l2_loss: 0.065433    loss: 0.521510
steps 3400    v_Prec: 0.496457  v_Recall: 0.582956  v_F1: 0.536241  v_AUC: 0.824113
steps 3400    running time 311 seconds

steps 3600    base_loss: 0.338109    reg_loss: 0.112421    l2_loss: 0.063974    loss: 0.514504
steps 3600    v_Prec: 0.508664  v_Recall: 0.614957  v_F1: 0.556783  v_AUC: 0.838391
steps 3600    running time 322 seconds

steps 3800    base_loss: 0.326407    reg_loss: 0.108468    l2_loss: 0.062287    loss: 0.497162
steps 3800    v_Prec: 0.509368  v_Recall: 0.653136  v_F1: 0.572362  v_AUC: 0.851043
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.322984    reg_loss: 0.106659    l2_loss: 0.060996    loss: 0.490639
steps 4000    v_Prec: 0.525448  v_Recall: 0.672189  v_F1: 0.589829  v_AUC: 0.864036
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.302038    reg_loss: 0.101139    l2_loss: 0.059395    loss: 0.462572
steps 4200    v_Prec: 0.537577  v_Recall: 0.683709  v_F1: 0.601901  v_AUC: 0.874168
steps 4200    running time 357 seconds

steps 4400    base_loss: 0.294646    reg_loss: 0.099852    l2_loss: 0.058159    loss: 0.452657
steps 4400    v_Prec: 0.557886  v_Recall: 0.688952  v_F1: 0.616530  v_AUC: 0.883857
steps 4400    running time 369 seconds

steps 4600    base_loss: 0.288874    reg_loss: 0.096475    l2_loss: 0.056442    loss: 0.441792
steps 4600    v_Prec: 0.564445  v_Recall: 0.701999  v_F1: 0.625752  v_AUC: 0.891171
steps 4600    running time 380 seconds

steps 4800    base_loss: 0.283795    reg_loss: 0.094724    l2_loss: 0.055052    loss: 0.433571
steps 4800    v_Prec: 0.561790  v_Recall: 0.731735  v_F1: 0.635599  v_AUC: 0.897633
steps 4800    running time 392 seconds

steps 5000    base_loss: 0.285028    reg_loss: 0.093385    l2_loss: 0.053635    loss: 0.432048
steps 5000    v_Prec: 0.563474  v_Recall: 0.753028  v_F1: 0.644605  v_AUC: 0.903997
steps 5000    running time 403 seconds

steps 5200    base_loss: 0.275792    reg_loss: 0.091764    l2_loss: 0.052208    loss: 0.419763
steps 5200    v_Prec: 0.568647  v_Recall: 0.762628  v_F1: 0.651505  v_AUC: 0.908562
steps 5200    running time 415 seconds

steps 5400    base_loss: 0.271415    reg_loss: 0.089806    l2_loss: 0.051246    loss: 0.412467
steps 5400    v_Prec: 0.577847  v_Recall: 0.757656  v_F1: 0.655647  v_AUC: 0.912214
steps 5400    running time 426 seconds

steps 5600    base_loss: 0.267059    reg_loss: 0.087521    l2_loss: 0.049758    loss: 0.404338
steps 5600    v_Prec: 0.581804  v_Recall: 0.765680  v_F1: 0.661197  v_AUC: 0.915352
steps 5600    running time 438 seconds

steps 5800    base_loss: 0.262150    reg_loss: 0.086110    l2_loss: 0.048740    loss: 0.397000
steps 5800    v_Prec: 0.578340  v_Recall: 0.783970  v_F1: 0.665636  v_AUC: 0.918592
steps 5800    running time 449 seconds

steps 6000    base_loss: 0.255619    reg_loss: 0.083427    l2_loss: 0.047393    loss: 0.386439
steps 6000    v_Prec: 0.579570  v_Recall: 0.794112  v_F1: 0.670087  v_AUC: 0.920339
steps 6000    running time 461 seconds

steps 6200    base_loss: 0.255375    reg_loss: 0.082182    l2_loss: 0.046353    loss: 0.383910
steps 6200    v_Prec: 0.587997  v_Recall: 0.787219  v_F1: 0.673178  v_AUC: 0.922479
steps 6200    running time 472 seconds

steps 6400    base_loss: 0.251185    reg_loss: 0.081343    l2_loss: 0.044898    loss: 0.377426
steps 6400    v_Prec: 0.583112  v_Recall: 0.804032  v_F1: 0.675980  v_AUC: 0.924498
steps 6400    running time 484 seconds

steps 6600    base_loss: 0.249872    reg_loss: 0.080652    l2_loss: 0.044070    loss: 0.374594
steps 6600    v_Prec: 0.595934  v_Recall: 0.793078  v_F1: 0.680516  v_AUC: 0.926432
steps 6600    running time 495 seconds

steps 6800    base_loss: 0.245188    reg_loss: 0.078225    l2_loss: 0.042712    loss: 0.366125
steps 6800    v_Prec: 0.592554  v_Recall: 0.807921  v_F1: 0.683678  v_AUC: 0.928065
steps 6800    running time 507 seconds

steps 7000    base_loss: 0.245582    reg_loss: 0.078065    l2_loss: 0.041642    loss: 0.365288
steps 7000    v_Prec: 0.589144  v_Recall: 0.816759  v_F1: 0.684526  v_AUC: 0.929139
steps 7000    running time 518 seconds

steps 7200    base_loss: 0.247853    reg_loss: 0.078974    l2_loss: 0.040676    loss: 0.367502
steps 7200    v_Prec: 0.595162  v_Recall: 0.807946  v_F1: 0.685420  v_AUC: 0.929917
steps 7200    running time 530 seconds

steps 7400    base_loss: 0.238916    reg_loss: 0.075880    l2_loss: 0.039572    loss: 0.354368
steps 7400    v_Prec: 0.591663  v_Recall: 0.820673  v_F1: 0.687601  v_AUC: 0.930920
steps 7400    running time 541 seconds

steps 7600    base_loss: 0.241837    reg_loss: 0.075405    l2_loss: 0.038652    loss: 0.355895
steps 7600    v_Prec: 0.596763  v_Recall: 0.811368  v_F1: 0.687712  v_AUC: 0.931619
steps 7600    running time 553 seconds

steps 7800    base_loss: 0.235654    reg_loss: 0.074748    l2_loss: 0.037606    loss: 0.348009
steps 7800    v_Prec: 0.598820  v_Recall: 0.817054  v_F1: 0.691118  v_AUC: 0.932293
steps 7800    running time 565 seconds

steps 8000    base_loss: 0.238714    reg_loss: 0.074645    l2_loss: 0.036607    loss: 0.349966
steps 8000    v_Prec: 0.597438  v_Recall: 0.822125  v_F1: 0.692000  v_AUC: 0.933339
steps 8000    running time 576 seconds

steps 8200    base_loss: 0.231361    reg_loss: 0.073072    l2_loss: 0.036004    loss: 0.340438
steps 8200    v_Prec: 0.594375  v_Recall: 0.831356  v_F1: 0.693171  v_AUC: 0.933878
steps 8200    running time 588 seconds

steps 8400    base_loss: 0.230858    reg_loss: 0.072227    l2_loss: 0.035045    loss: 0.338129
steps 8400    v_Prec: 0.600519  v_Recall: 0.819860  v_F1: 0.693254  v_AUC: 0.934471
steps 8400    running time 599 seconds

steps 8600    base_loss: 0.240423    reg_loss: 0.072513    l2_loss: 0.034268    loss: 0.347203
steps 8600    v_Prec: 0.603214  v_Recall: 0.815922  v_F1: 0.693627  v_AUC: 0.934891
steps 8600    running time 611 seconds

steps 8800    base_loss: 0.236820    reg_loss: 0.071867    l2_loss: 0.033729    loss: 0.342417
steps 8800    v_Prec: 0.599465  v_Recall: 0.832808  v_F1: 0.697129  v_AUC: 0.935897
steps 8800    running time 622 seconds

steps 9000    base_loss: 0.230204    reg_loss: 0.071503    l2_loss: 0.033068    loss: 0.334774
steps 9000    v_Prec: 0.599787  v_Recall: 0.833079  v_F1: 0.697441  v_AUC: 0.936616
steps 9000    running time 634 seconds

steps 9200    base_loss: 0.225247    reg_loss: 0.070202    l2_loss: 0.032444    loss: 0.327893
steps 9200    v_Prec: 0.598542  v_Recall: 0.834901  v_F1: 0.697235  v_AUC: 0.937094
steps 9200    running time 646 seconds

steps 9400    base_loss: 0.230046    reg_loss: 0.070378    l2_loss: 0.032005    loss: 0.332429
steps 9400    v_Prec: 0.605796  v_Recall: 0.825350  v_F1: 0.698732  v_AUC: 0.937575
steps 9400    running time 656 seconds

steps 9600    base_loss: 0.227756    reg_loss: 0.069937    l2_loss: 0.031402    loss: 0.329095
steps 9600    v_Prec: 0.602849  v_Recall: 0.832464  v_F1: 0.699290  v_AUC: 0.937825
steps 9600    running time 668 seconds

steps 9800    base_loss: 0.232899    reg_loss: 0.070891    l2_loss: 0.031128    loss: 0.334917
steps 9800    v_Prec: 0.600215  v_Recall: 0.839553  v_F1: 0.699991  v_AUC: 0.938285
steps 9800    running time 679 seconds

steps 10000    base_loss: 0.225746    reg_loss: 0.069017    l2_loss: 0.030516    loss: 0.325279
steps 10000    v_Prec: 0.607193  v_Recall: 0.829091  v_F1: 0.701001  v_AUC: 0.938870
steps 10000    running time 691 seconds

steps 10200    base_loss: 0.228334    reg_loss: 0.070055    l2_loss: 0.030109    loss: 0.328498
steps 10200    v_Prec: 0.607999  v_Recall: 0.829608  v_F1: 0.701723  v_AUC: 0.939056
steps 10200    running time 703 seconds

steps 10400    base_loss: 0.228627    reg_loss: 0.069587    l2_loss: 0.029835    loss: 0.328049
steps 10400    v_Prec: 0.607541  v_Recall: 0.832094  v_F1: 0.702305  v_AUC: 0.939345
steps 10400    running time 714 seconds

steps 10600    base_loss: 0.223321    reg_loss: 0.067737    l2_loss: 0.029306    loss: 0.320364
steps 10600    v_Prec: 0.604460  v_Recall: 0.837411  v_F1: 0.702118  v_AUC: 0.939794
steps 10600    running time 725 seconds

steps 10800    base_loss: 0.228248    reg_loss: 0.069131    l2_loss: 0.029191    loss: 0.326570
steps 10800    v_Prec: 0.602143  v_Recall: 0.845215  v_F1: 0.703268  v_AUC: 0.940021
steps 10800    running time 736 seconds

steps 11000    base_loss: 0.219589    reg_loss: 0.066583    l2_loss: 0.028722    loss: 0.314894
steps 11000    v_Prec: 0.604223  v_Recall: 0.839701  v_F1: 0.702761  v_AUC: 0.940142
steps 11000    running time 748 seconds

steps 11200    base_loss: 0.220161    reg_loss: 0.066390    l2_loss: 0.028545    loss: 0.315096
steps 11200    v_Prec: 0.607242  v_Recall: 0.840070  v_F1: 0.704929  v_AUC: 0.940711
steps 11200    running time 759 seconds

steps 11400    base_loss: 0.221445    reg_loss: 0.067273    l2_loss: 0.028372    loss: 0.317089
steps 11400    v_Prec: 0.601056  v_Recall: 0.849178  v_F1: 0.703891  v_AUC: 0.940358
steps 11400    running time 770 seconds

steps 11600    base_loss: 0.222915    reg_loss: 0.066670    l2_loss: 0.028097    loss: 0.317682
steps 11600    v_Prec: 0.604009  v_Recall: 0.848562  v_F1: 0.705699  v_AUC: 0.940993
steps 11600    running time 782 seconds

steps 11800    base_loss: 0.223726    reg_loss: 0.067331    l2_loss: 0.027876    loss: 0.318933
steps 11800    v_Prec: 0.607416  v_Recall: 0.843196  v_F1: 0.706144  v_AUC: 0.941198
steps 11800    running time 793 seconds

steps 12000    base_loss: 0.221324    reg_loss: 0.065914    l2_loss: 0.027742    loss: 0.314980
steps 12000    v_Prec: 0.603372  v_Recall: 0.856267  v_F1: 0.707911  v_AUC: 0.941152
steps 12000    running time 805 seconds

steps 12200    base_loss: 0.226679    reg_loss: 0.066587    l2_loss: 0.027575    loss: 0.320842
steps 12200    v_Prec: 0.603347  v_Recall: 0.856513  v_F1: 0.707978  v_AUC: 0.941229
steps 12200    running time 816 seconds

steps 12400    base_loss: 0.217601    reg_loss: 0.066281    l2_loss: 0.027398    loss: 0.311280
steps 12400    v_Prec: 0.602196  v_Recall: 0.858704  v_F1: 0.707931  v_AUC: 0.941596
steps 12400    running time 828 seconds

steps 12600    base_loss: 0.222663    reg_loss: 0.065907    l2_loss: 0.027367    loss: 0.315937
steps 12600    v_Prec: 0.599637  v_Recall: 0.861830  v_F1: 0.707214  v_AUC: 0.941500
steps 12600    running time 839 seconds

steps 12800    base_loss: 0.220254    reg_loss: 0.064863    l2_loss: 0.026941    loss: 0.312058
steps 12800    v_Prec: 0.598735  v_Recall: 0.868994  v_F1: 0.708982  v_AUC: 0.941651
steps 12800    running time 850 seconds

steps 13000    base_loss: 0.221275    reg_loss: 0.065313    l2_loss: 0.026778    loss: 0.313366
steps 13000    v_Prec: 0.609447  v_Recall: 0.848612  v_F1: 0.709415  v_AUC: 0.942067
steps 13000    running time 861 seconds

steps 13200    base_loss: 0.218739    reg_loss: 0.064956    l2_loss: 0.026456    loss: 0.310151
steps 13200    v_Prec: 0.602668  v_Recall: 0.858680  v_F1: 0.708248  v_AUC: 0.941777
steps 13200    running time 873 seconds

steps 13400    base_loss: 0.221026    reg_loss: 0.064729    l2_loss: 0.026347    loss: 0.312102
steps 13400    v_Prec: 0.607236  v_Recall: 0.850704  v_F1: 0.708641  v_AUC: 0.941843
steps 13400    running time 884 seconds

steps 13600    base_loss: 0.219236    reg_loss: 0.063589    l2_loss: 0.026314    loss: 0.309139
steps 13600    v_Prec: 0.603063  v_Recall: 0.856956  v_F1: 0.707934  v_AUC: 0.941975
steps 13600    running time 895 seconds

steps 13800    base_loss: 0.221516    reg_loss: 0.064291    l2_loss: 0.026225    loss: 0.312033
steps 13800    v_Prec: 0.608711  v_Recall: 0.854224  v_F1: 0.710866  v_AUC: 0.942065
steps 13800    running time 906 seconds

steps 14000    base_loss: 0.222816    reg_loss: 0.064300    l2_loss: 0.026191    loss: 0.313308
steps 14000    v_Prec: 0.605019  v_Recall: 0.858680  v_F1: 0.709870  v_AUC: 0.941766
steps 14000    running time 918 seconds

steps 14200    base_loss: 0.216406    reg_loss: 0.062695    l2_loss: 0.026042    loss: 0.305144
steps 14200    v_Prec: 0.605534  v_Recall: 0.857129  v_F1: 0.709693  v_AUC: 0.942221
steps 14200    running time 929 seconds

steps 14400    base_loss: 0.219805    reg_loss: 0.063272    l2_loss: 0.026185    loss: 0.309262
steps 14400    v_Prec: 0.598697  v_Recall: 0.871209  v_F1: 0.709692  v_AUC: 0.942026
steps 14400    running time 939 seconds

steps 14600    base_loss: 0.219758    reg_loss: 0.063446    l2_loss: 0.025921    loss: 0.309126
steps 14600    v_Prec: 0.610764  v_Recall: 0.850581  v_F1: 0.710995  v_AUC: 0.942151
steps 14600    running time 950 seconds

steps 14800    base_loss: 0.219099    reg_loss: 0.063676    l2_loss: 0.025840    loss: 0.308615
steps 14800    v_Prec: 0.603886  v_Recall: 0.862200  v_F1: 0.710286  v_AUC: 0.941658
steps 14800    running time 962 seconds

steps 15000    base_loss: 0.219499    reg_loss: 0.062948    l2_loss: 0.025668    loss: 0.308115
steps 15000    v_Prec: 0.605212  v_Recall: 0.863824  v_F1: 0.711755  v_AUC: 0.941499
steps 15000    running time 973 seconds

steps 15200    base_loss: 0.217632    reg_loss: 0.062836    l2_loss: 0.025846    loss: 0.306314
steps 15200    v_Prec: 0.605084  v_Recall: 0.864907  v_F1: 0.712033  v_AUC: 0.941983
steps 15200    running time 985 seconds

steps 15400    base_loss: 0.218442    reg_loss: 0.062171    l2_loss: 0.025731    loss: 0.306345
steps 15400    v_Prec: 0.605352  v_Recall: 0.860403  v_F1: 0.710687  v_AUC: 0.942059
steps 15400    running time 996 seconds

steps 15600    base_loss: 0.221368    reg_loss: 0.063089    l2_loss: 0.025760    loss: 0.310217
steps 15600    v_Prec: 0.603360  v_Recall: 0.866335  v_F1: 0.711320  v_AUC: 0.941895
steps 15600    running time 1007 seconds

steps 15800    base_loss: 0.220503    reg_loss: 0.062962    l2_loss: 0.025762    loss: 0.309227
steps 15800    v_Prec: 0.602632  v_Recall: 0.863332  v_F1: 0.709801  v_AUC: 0.941894
steps 15800    running time 1018 seconds

steps 16000    base_loss: 0.218910    reg_loss: 0.062267    l2_loss: 0.025567    loss: 0.306744
steps 16000    v_Prec: 0.602290  v_Recall: 0.866089  v_F1: 0.710494  v_AUC: 0.942371
steps 16000    running time 1029 seconds

steps 16200    base_loss: 0.223058    reg_loss: 0.062257    l2_loss: 0.025511    loss: 0.310826
steps 16200    v_Prec: 0.608989  v_Recall: 0.855529  v_F1: 0.711507  v_AUC: 0.942389
steps 16200    running time 1040 seconds

steps 16400    base_loss: 0.215479    reg_loss: 0.060778    l2_loss: 0.025438    loss: 0.301695
steps 16400    v_Prec: 0.605877  v_Recall: 0.864907  v_F1: 0.712582  v_AUC: 0.941989
steps 16400    running time 1051 seconds

steps 16600    base_loss: 0.222350    reg_loss: 0.061822    l2_loss: 0.025538    loss: 0.309709
steps 16600    v_Prec: 0.607309  v_Recall: 0.862766  v_F1: 0.712842  v_AUC: 0.941973
steps 16600    running time 1062 seconds

steps 16800    base_loss: 0.216220    reg_loss: 0.060243    l2_loss: 0.025422    loss: 0.301886
steps 16800    v_Prec: 0.608854  v_Recall: 0.856538  v_F1: 0.711764  v_AUC: 0.942194
steps 16800    running time 1074 seconds

steps 17000    base_loss: 0.216949    reg_loss: 0.060217    l2_loss: 0.025561    loss: 0.302727
steps 17000    v_Prec: 0.612983  v_Recall: 0.851935  v_F1: 0.712970  v_AUC: 0.942224
steps 17000    running time 1085 seconds

steps 17200    base_loss: 0.216970    reg_loss: 0.060862    l2_loss: 0.025381    loss: 0.303213
steps 17200    v_Prec: 0.608061  v_Recall: 0.862741  v_F1: 0.713351  v_AUC: 0.942098
steps 17200    running time 1096 seconds

steps 17400    base_loss: 0.225576    reg_loss: 0.061130    l2_loss: 0.025609    loss: 0.312316
steps 17400    v_Prec: 0.609408  v_Recall: 0.857843  v_F1: 0.712593  v_AUC: 0.942058
steps 17400    running time 1108 seconds

steps 17600    base_loss: 0.226399    reg_loss: 0.061519    l2_loss: 0.025632    loss: 0.313549
steps 17600    v_Prec: 0.605694  v_Recall: 0.862544  v_F1: 0.711653  v_AUC: 0.942154
steps 17600    running time 1119 seconds

steps 17800    base_loss: 0.216122    reg_loss: 0.060175    l2_loss: 0.025606    loss: 0.301903
steps 17800    v_Prec: 0.607414  v_Recall: 0.863184  v_F1: 0.713057  v_AUC: 0.942236
steps 17800    running time 1130 seconds

steps 18000    base_loss: 0.215040    reg_loss: 0.059414    l2_loss: 0.025668    loss: 0.300122
steps 18000    v_Prec: 0.607984  v_Recall: 0.858877  v_F1: 0.711974  v_AUC: 0.942006
steps 18000    running time 1141 seconds

steps 18200    base_loss: 0.213578    reg_loss: 0.059757    l2_loss: 0.025505    loss: 0.298840
steps 18200    v_Prec: 0.601896  v_Recall: 0.870471  v_F1: 0.711688  v_AUC: 0.941951
steps 18200    running time 1152 seconds

steps 18400    base_loss: 0.203599    reg_loss: 0.059776    l2_loss: 0.025676    loss: 0.289050
steps 18400    v_Prec: 0.608997  v_Recall: 0.854101  v_F1: 0.711019  v_AUC: 0.941762
steps 18400    running time 1163 seconds

steps 18600    base_loss: 0.204376    reg_loss: 0.059049    l2_loss: 0.025600    loss: 0.289024
steps 18600    v_Prec: 0.607405  v_Recall: 0.858507  v_F1: 0.711450  v_AUC: 0.941023
steps 18600    running time 1174 seconds

steps 18800    base_loss: 0.201946    reg_loss: 0.058857    l2_loss: 0.025896    loss: 0.286699
steps 18800    v_Prec: 0.606085  v_Recall: 0.864563  v_F1: 0.712609  v_AUC: 0.941610
steps 18800    running time 1185 seconds

steps 19000    base_loss: 0.207446    reg_loss: 0.058694    l2_loss: 0.025702    loss: 0.291842
steps 19000    v_Prec: 0.601800  v_Recall: 0.869117  v_F1: 0.711168  v_AUC: 0.941533
steps 19000    running time 1196 seconds

steps 19200    base_loss: 0.204879    reg_loss: 0.058216    l2_loss: 0.025698    loss: 0.288794
steps 19200    v_Prec: 0.614391  v_Recall: 0.846421  v_F1: 0.711978  v_AUC: 0.941458
steps 19200    running time 1207 seconds

Early stop model F1: 0.713351
testing thre: 0.2790583
testing Prec: 0.4880415518784327
testing Recall: 0.8070979817472178
testing F1: 0.6082701381636859
testing AUC: 0.8952544158184794
overall running time 1216 seconds
(0.5628306801060512, 0.6991918283251839, 0.6236443639187266, 0.8952544158184794, 0.4139529)
2019-02-17 01:10:15.396444: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 01:10:16.065964: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 01:10:16.066951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 01:10:16.066989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.000000 seconds
loading data in 110.660000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	1e-05
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.844169    reg_loss: 0.214427    l2_loss: 0.014773    loss: 1.073370
steps 200    v_Prec: 0.157822  v_Recall: 0.992981  v_F1: 0.272356  v_AUC: 0.516310
steps 200    running time 128 seconds

steps 400    base_loss: 0.748981    reg_loss: 0.213544    l2_loss: 0.014787    loss: 0.977313
steps 400    v_Prec: 0.159770  v_Recall: 0.945496  v_F1: 0.273349  v_AUC: 0.531799
steps 400    running time 140 seconds

steps 600    base_loss: 0.619103    reg_loss: 0.214089    l2_loss: 0.014806    loss: 0.847999
steps 600    v_Prec: 0.168018  v_Recall: 0.809026  v_F1: 0.278249  v_AUC: 0.555367
steps 600    running time 151 seconds

steps 800    base_loss: 0.515685    reg_loss: 0.213470    l2_loss: 0.014818    loss: 0.743973
steps 800    v_Prec: 0.181011  v_Recall: 0.712631  v_F1: 0.288692  v_AUC: 0.583726
steps 800    running time 163 seconds

steps 1000    base_loss: 0.461697    reg_loss: 0.212337    l2_loss: 0.014854    loss: 0.688888
steps 1000    v_Prec: 0.207342  v_Recall: 0.563179  v_F1: 0.303095  v_AUC: 0.610876
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.449622    reg_loss: 0.210696    l2_loss: 0.014829    loss: 0.675147
steps 1200    v_Prec: 0.226990  v_Recall: 0.566247  v_F1: 0.324071  v_AUC: 0.639201
steps 1200    running time 186 seconds

steps 1400    base_loss: 0.442969    reg_loss: 0.207044    l2_loss: 0.014805    loss: 0.664818
steps 1400    v_Prec: 0.267425  v_Recall: 0.488871  v_F1: 0.345728  v_AUC: 0.665155
steps 1400    running time 198 seconds

steps 1600    base_loss: 0.433621    reg_loss: 0.202306    l2_loss: 0.014798    loss: 0.650724
steps 1600    v_Prec: 0.296822  v_Recall: 0.509068  v_F1: 0.374995  v_AUC: 0.691654
steps 1600    running time 210 seconds

steps 1800    base_loss: 0.434789    reg_loss: 0.198036    l2_loss: 0.014718    loss: 0.647543
steps 1800    v_Prec: 0.337519  v_Recall: 0.519154  v_F1: 0.409081  v_AUC: 0.717360
steps 1800    running time 221 seconds

steps 2000    base_loss: 0.415997    reg_loss: 0.192220    l2_loss: 0.014658    loss: 0.622876
steps 2000    v_Prec: 0.371650  v_Recall: 0.533265  v_F1: 0.438025  v_AUC: 0.736112
steps 2000    running time 233 seconds

steps 2200    base_loss: 0.402360    reg_loss: 0.187491    l2_loss: 0.014608    loss: 0.604460
steps 2200    v_Prec: 0.393593  v_Recall: 0.545093  v_F1: 0.457117  v_AUC: 0.749831
steps 2200    running time 244 seconds

steps 2400    base_loss: 0.388721    reg_loss: 0.182054    l2_loss: 0.014615    loss: 0.585390
steps 2400    v_Prec: 0.408871  v_Recall: 0.552406  v_F1: 0.469923  v_AUC: 0.761007
steps 2400    running time 256 seconds

steps 2600    base_loss: 0.378306    reg_loss: 0.175351    l2_loss: 0.014592    loss: 0.568248
steps 2600    v_Prec: 0.408994  v_Recall: 0.580726  v_F1: 0.479961  v_AUC: 0.771731
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.370961    reg_loss: 0.168817    l2_loss: 0.014545    loss: 0.554323
steps 2800    v_Prec: 0.416067  v_Recall: 0.592677  v_F1: 0.488911  v_AUC: 0.781587
steps 2800    running time 279 seconds

steps 3000    base_loss: 0.361199    reg_loss: 0.162630    l2_loss: 0.014618    loss: 0.538448
steps 3000    v_Prec: 0.429553  v_Recall: 0.595180  v_F1: 0.498982  v_AUC: 0.791589
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.363349    reg_loss: 0.158329    l2_loss: 0.014545    loss: 0.536223
steps 3200    v_Prec: 0.446106  v_Recall: 0.598027  v_F1: 0.511014  v_AUC: 0.801711
steps 3200    running time 302 seconds

steps 3400    base_loss: 0.356085    reg_loss: 0.153042    l2_loss: 0.014567    loss: 0.523694
steps 3400    v_Prec: 0.449379  v_Recall: 0.622077  v_F1: 0.521810  v_AUC: 0.811192
steps 3400    running time 314 seconds

steps 3600    base_loss: 0.344455    reg_loss: 0.146987    l2_loss: 0.014578    loss: 0.506021
steps 3600    v_Prec: 0.458347  v_Recall: 0.636899  v_F1: 0.533069  v_AUC: 0.821338
steps 3600    running time 325 seconds

steps 3800    base_loss: 0.345350    reg_loss: 0.143481    l2_loss: 0.014618    loss: 0.503449
steps 3800    v_Prec: 0.480900  v_Recall: 0.631181  v_F1: 0.545887  v_AUC: 0.832026
steps 3800    running time 337 seconds

steps 4000    base_loss: 0.334681    reg_loss: 0.138604    l2_loss: 0.014547    loss: 0.487832
steps 4000    v_Prec: 0.483996  v_Recall: 0.655329  v_F1: 0.556780  v_AUC: 0.841696
steps 4000    running time 349 seconds

steps 4200    base_loss: 0.326952    reg_loss: 0.135498    l2_loss: 0.014585    loss: 0.477035
steps 4200    v_Prec: 0.499291  v_Recall: 0.665685  v_F1: 0.570605  v_AUC: 0.851955
steps 4200    running time 360 seconds

steps 4400    base_loss: 0.326112    reg_loss: 0.132643    l2_loss: 0.014595    loss: 0.473350
steps 4400    v_Prec: 0.504823  v_Recall: 0.684557  v_F1: 0.581110  v_AUC: 0.860241
steps 4400    running time 372 seconds

steps 4600    base_loss: 0.310266    reg_loss: 0.127457    l2_loss: 0.014586    loss: 0.452310
steps 4600    v_Prec: 0.518243  v_Recall: 0.686324  v_F1: 0.590557  v_AUC: 0.868068
steps 4600    running time 383 seconds

steps 4800    base_loss: 0.309141    reg_loss: 0.125476    l2_loss: 0.014613    loss: 0.449230
steps 4800    v_Prec: 0.528442  v_Recall: 0.688483  v_F1: 0.597939  v_AUC: 0.874387
steps 4800    running time 395 seconds

steps 5000    base_loss: 0.295615    reg_loss: 0.121246    l2_loss: 0.014619    loss: 0.431480
steps 5000    v_Prec: 0.528041  v_Recall: 0.716754  v_F1: 0.608093  v_AUC: 0.880762
steps 5000    running time 407 seconds

steps 5200    base_loss: 0.295346    reg_loss: 0.119164    l2_loss: 0.014646    loss: 0.429155
steps 5200    v_Prec: 0.538121  v_Recall: 0.721245  v_F1: 0.616369  v_AUC: 0.887401
steps 5200    running time 418 seconds

steps 5400    base_loss: 0.287800    reg_loss: 0.115921    l2_loss: 0.014599    loss: 0.418320
steps 5400    v_Prec: 0.549815  v_Recall: 0.721834  v_F1: 0.624190  v_AUC: 0.892762
steps 5400    running time 430 seconds

steps 5600    base_loss: 0.280074    reg_loss: 0.113461    l2_loss: 0.014591    loss: 0.408125
steps 5600    v_Prec: 0.550047  v_Recall: 0.738079  v_F1: 0.630339  v_AUC: 0.897062
steps 5600    running time 441 seconds

steps 5800    base_loss: 0.285215    reg_loss: 0.111690    l2_loss: 0.014600    loss: 0.411505
steps 5800    v_Prec: 0.550460  v_Recall: 0.762031  v_F1: 0.639193  v_AUC: 0.902257
steps 5800    running time 453 seconds

steps 6000    base_loss: 0.268696    reg_loss: 0.109158    l2_loss: 0.014657    loss: 0.392511
steps 6000    v_Prec: 0.556940  v_Recall: 0.764755  v_F1: 0.644509  v_AUC: 0.906165
steps 6000    running time 464 seconds

steps 6200    base_loss: 0.273095    reg_loss: 0.107473    l2_loss: 0.014666    loss: 0.395233
steps 6200    v_Prec: 0.562636  v_Recall: 0.770547  v_F1: 0.650379  v_AUC: 0.909598
steps 6200    running time 476 seconds

steps 6400    base_loss: 0.266405    reg_loss: 0.105274    l2_loss: 0.014610    loss: 0.386289
steps 6400    v_Prec: 0.569927  v_Recall: 0.777050  v_F1: 0.657564  v_AUC: 0.913409
steps 6400    running time 488 seconds

steps 6600    base_loss: 0.258328    reg_loss: 0.104193    l2_loss: 0.014658    loss: 0.377179
steps 6600    v_Prec: 0.574155  v_Recall: 0.779700  v_F1: 0.661324  v_AUC: 0.915258
steps 6600    running time 499 seconds

steps 6800    base_loss: 0.264736    reg_loss: 0.102872    l2_loss: 0.014636    loss: 0.382244
steps 6800    v_Prec: 0.577980  v_Recall: 0.786866  v_F1: 0.666438  v_AUC: 0.918189
steps 6800    running time 511 seconds

steps 7000    base_loss: 0.257032    reg_loss: 0.099253    l2_loss: 0.014634    loss: 0.370918
steps 7000    v_Prec: 0.585129  v_Recall: 0.788142  v_F1: 0.671630  v_AUC: 0.921255
steps 7000    running time 523 seconds

steps 7200    base_loss: 0.250513    reg_loss: 0.098271    l2_loss: 0.014655    loss: 0.363439
steps 7200    v_Prec: 0.579792  v_Recall: 0.804928  v_F1: 0.674058  v_AUC: 0.922892
steps 7200    running time 534 seconds

steps 7400    base_loss: 0.255620    reg_loss: 0.097581    l2_loss: 0.014639    loss: 0.367839
steps 7400    v_Prec: 0.580755  v_Recall: 0.811038  v_F1: 0.676845  v_AUC: 0.924852
steps 7400    running time 546 seconds

steps 7600    base_loss: 0.251204    reg_loss: 0.095599    l2_loss: 0.014630    loss: 0.361433
steps 7600    v_Prec: 0.588400  v_Recall: 0.810351  v_F1: 0.681766  v_AUC: 0.927313
steps 7600    running time 557 seconds

steps 7800    base_loss: 0.245708    reg_loss: 0.093882    l2_loss: 0.014619    loss: 0.354208
steps 7800    v_Prec: 0.593477  v_Recall: 0.805517  v_F1: 0.683428  v_AUC: 0.928418
steps 7800    running time 569 seconds

steps 8000    base_loss: 0.248128    reg_loss: 0.092542    l2_loss: 0.014627    loss: 0.355297
steps 8000    v_Prec: 0.594427  v_Recall: 0.814597  v_F1: 0.687310  v_AUC: 0.929823
steps 8000    running time 581 seconds

steps 8200    base_loss: 0.239908    reg_loss: 0.090244    l2_loss: 0.014635    loss: 0.344787
steps 8200    v_Prec: 0.602925  v_Recall: 0.799283  v_F1: 0.687356  v_AUC: 0.930697
steps 8200    running time 592 seconds

steps 8400    base_loss: 0.242173    reg_loss: 0.088953    l2_loss: 0.014607    loss: 0.345733
steps 8400    v_Prec: 0.601148  v_Recall: 0.809909  v_F1: 0.690086  v_AUC: 0.932172
steps 8400    running time 604 seconds

steps 8600    base_loss: 0.245395    reg_loss: 0.086765    l2_loss: 0.014574    loss: 0.346734
steps 8600    v_Prec: 0.595133  v_Recall: 0.826401  v_F1: 0.691954  v_AUC: 0.933039
steps 8600    running time 615 seconds

steps 8800    base_loss: 0.244561    reg_loss: 0.087945    l2_loss: 0.014541    loss: 0.347047
steps 8800    v_Prec: 0.599943  v_Recall: 0.826499  v_F1: 0.695229  v_AUC: 0.934472
steps 8800    running time 627 seconds

steps 9000    base_loss: 0.238680    reg_loss: 0.086708    l2_loss: 0.014505    loss: 0.339894
steps 9000    v_Prec: 0.600391  v_Recall: 0.829517  v_F1: 0.696597  v_AUC: 0.935310
steps 9000    running time 639 seconds

steps 9200    base_loss: 0.239624    reg_loss: 0.086007    l2_loss: 0.014500    loss: 0.340130
steps 9200    v_Prec: 0.607118  v_Recall: 0.822572  v_F1: 0.698611  v_AUC: 0.936477
steps 9200    running time 650 seconds

steps 9400    base_loss: 0.231626    reg_loss: 0.084431    l2_loss: 0.014484    loss: 0.330541
steps 9400    v_Prec: 0.607853  v_Recall: 0.820585  v_F1: 0.698378  v_AUC: 0.936597
steps 9400    running time 662 seconds

steps 9600    base_loss: 0.229254    reg_loss: 0.083372    l2_loss: 0.014454    loss: 0.327080
steps 9600    v_Prec: 0.606640  v_Recall: 0.825051  v_F1: 0.699186  v_AUC: 0.937047
steps 9600    running time 673 seconds

steps 9800    base_loss: 0.237395    reg_loss: 0.082435    l2_loss: 0.014414    loss: 0.334244
steps 9800    v_Prec: 0.612117  v_Recall: 0.825125  v_F1: 0.702837  v_AUC: 0.938357
steps 9800    running time 684 seconds

steps 10000    base_loss: 0.232446    reg_loss: 0.081795    l2_loss: 0.014384    loss: 0.328624
steps 10000    v_Prec: 0.607872  v_Recall: 0.831873  v_F1: 0.702447  v_AUC: 0.938832
steps 10000    running time 696 seconds

steps 10200    base_loss: 0.231437    reg_loss: 0.080428    l2_loss: 0.014332    loss: 0.326196
steps 10200    v_Prec: 0.607535  v_Recall: 0.836168  v_F1: 0.703748  v_AUC: 0.939547
steps 10200    running time 707 seconds

steps 10400    base_loss: 0.233327    reg_loss: 0.080741    l2_loss: 0.014281    loss: 0.328349
steps 10400    v_Prec: 0.607619  v_Recall: 0.840757  v_F1: 0.705425  v_AUC: 0.940320
steps 10400    running time 718 seconds

steps 10600    base_loss: 0.222767    reg_loss: 0.079278    l2_loss: 0.014222    loss: 0.316267
steps 10600    v_Prec: 0.603749  v_Recall: 0.844855  v_F1: 0.704237  v_AUC: 0.940298
steps 10600    running time 730 seconds

steps 10800    base_loss: 0.224357    reg_loss: 0.079018    l2_loss: 0.014197    loss: 0.317572
steps 10800    v_Prec: 0.595083  v_Recall: 0.859555  v_F1: 0.703277  v_AUC: 0.940673
steps 10800    running time 741 seconds

steps 11000    base_loss: 0.227605    reg_loss: 0.077886    l2_loss: 0.014174    loss: 0.319664
steps 11000    v_Prec: 0.608252  v_Recall: 0.840021  v_F1: 0.705591  v_AUC: 0.940776
steps 11000    running time 752 seconds

steps 11200    base_loss: 0.229206    reg_loss: 0.078749    l2_loss: 0.014151    loss: 0.322106
steps 11200    v_Prec: 0.608678  v_Recall: 0.838278  v_F1: 0.705262  v_AUC: 0.941464
steps 11200    running time 763 seconds

steps 11400    base_loss: 0.222052    reg_loss: 0.076334    l2_loss: 0.014077    loss: 0.312463
steps 11400    v_Prec: 0.611555  v_Recall: 0.836732  v_F1: 0.706638  v_AUC: 0.941379
steps 11400    running time 774 seconds

steps 11600    base_loss: 0.221739    reg_loss: 0.076225    l2_loss: 0.014066    loss: 0.312030
steps 11600    v_Prec: 0.610989  v_Recall: 0.840757  v_F1: 0.707690  v_AUC: 0.941595
steps 11600    running time 786 seconds

steps 11800    base_loss: 0.222156    reg_loss: 0.075716    l2_loss: 0.013987    loss: 0.311859
steps 11800    v_Prec: 0.614777  v_Recall: 0.834744  v_F1: 0.708071  v_AUC: 0.941934
steps 11800    running time 798 seconds

steps 12000    base_loss: 0.227175    reg_loss: 0.076243    l2_loss: 0.013941    loss: 0.317358
steps 12000    v_Prec: 0.607570  v_Recall: 0.845788  v_F1: 0.707156  v_AUC: 0.942306
steps 12000    running time 810 seconds

steps 12200    base_loss: 0.223653    reg_loss: 0.075435    l2_loss: 0.013904    loss: 0.312993
steps 12200    v_Prec: 0.615293  v_Recall: 0.835505  v_F1: 0.708686  v_AUC: 0.942793
steps 12200    running time 821 seconds

steps 12400    base_loss: 0.220203    reg_loss: 0.074452    l2_loss: 0.013889    loss: 0.308544
steps 12400    v_Prec: 0.612626  v_Recall: 0.840634  v_F1: 0.708744  v_AUC: 0.942534
steps 12400    running time 832 seconds

steps 12600    base_loss: 0.219179    reg_loss: 0.074407    l2_loss: 0.013865    loss: 0.307451
steps 12600    v_Prec: 0.611612  v_Recall: 0.841959  v_F1: 0.708534  v_AUC: 0.942909
steps 12600    running time 843 seconds

steps 12800    base_loss: 0.223480    reg_loss: 0.073657    l2_loss: 0.013813    loss: 0.310950
steps 12800    v_Prec: 0.607820  v_Recall: 0.853371  v_F1: 0.709963  v_AUC: 0.943195
steps 12800    running time 854 seconds

steps 13000    base_loss: 0.220306    reg_loss: 0.075202    l2_loss: 0.013829    loss: 0.309337
steps 13000    v_Prec: 0.610019  v_Recall: 0.847162  v_F1: 0.709294  v_AUC: 0.943649
steps 13000    running time 866 seconds

steps 13200    base_loss: 0.218086    reg_loss: 0.071301    l2_loss: 0.013717    loss: 0.303103
steps 13200    v_Prec: 0.606261  v_Recall: 0.855407  v_F1: 0.709601  v_AUC: 0.943780
steps 13200    running time 877 seconds

steps 13400    base_loss: 0.221031    reg_loss: 0.074033    l2_loss: 0.013613    loss: 0.308677
steps 13400    v_Prec: 0.612702  v_Recall: 0.845174  v_F1: 0.710403  v_AUC: 0.943838
steps 13400    running time 888 seconds

steps 13600    base_loss: 0.217491    reg_loss: 0.072805    l2_loss: 0.013625    loss: 0.303922
steps 13600    v_Prec: 0.609781  v_Recall: 0.854328  v_F1: 0.711631  v_AUC: 0.944173
steps 13600    running time 900 seconds

steps 13800    base_loss: 0.215129    reg_loss: 0.071997    l2_loss: 0.013531    loss: 0.300657
steps 13800    v_Prec: 0.617133  v_Recall: 0.844364  v_F1: 0.713084  v_AUC: 0.944482
steps 13800    running time 911 seconds

steps 14000    base_loss: 0.219489    reg_loss: 0.071953    l2_loss: 0.013500    loss: 0.304943
steps 14000    v_Prec: 0.610259  v_Recall: 0.853665  v_F1: 0.711727  v_AUC: 0.944331
steps 14000    running time 923 seconds

steps 14200    base_loss: 0.219143    reg_loss: 0.071526    l2_loss: 0.013535    loss: 0.304204
steps 14200    v_Prec: 0.611014  v_Recall: 0.853567  v_F1: 0.712206  v_AUC: 0.944723
steps 14200    running time 934 seconds

steps 14400    base_loss: 0.219058    reg_loss: 0.071734    l2_loss: 0.013485    loss: 0.304277
steps 14400    v_Prec: 0.613877  v_Recall: 0.852414  v_F1: 0.713743  v_AUC: 0.944964
steps 14400    running time 944 seconds

steps 14600    base_loss: 0.209930    reg_loss: 0.069385    l2_loss: 0.013380    loss: 0.292695
steps 14600    v_Prec: 0.607612  v_Recall: 0.864291  v_F1: 0.713571  v_AUC: 0.945458
steps 14600    running time 956 seconds

steps 14800    base_loss: 0.214550    reg_loss: 0.070916    l2_loss: 0.013420    loss: 0.298886
steps 14800    v_Prec: 0.613708  v_Recall: 0.851064  v_F1: 0.713155  v_AUC: 0.945575
steps 14800    running time 967 seconds

steps 15000    base_loss: 0.219956    reg_loss: 0.072417    l2_loss: 0.013455    loss: 0.305828
steps 15000    v_Prec: 0.612331  v_Recall: 0.854279  v_F1: 0.713347  v_AUC: 0.945796
steps 15000    running time 978 seconds

steps 15200    base_loss: 0.217020    reg_loss: 0.070327    l2_loss: 0.013372    loss: 0.300720
steps 15200    v_Prec: 0.612503  v_Recall: 0.856684  v_F1: 0.714302  v_AUC: 0.945790
steps 15200    running time 989 seconds

steps 15400    base_loss: 0.218498    reg_loss: 0.070414    l2_loss: 0.013356    loss: 0.302268
steps 15400    v_Prec: 0.605886  v_Recall: 0.870549  v_F1: 0.714496  v_AUC: 0.945820
steps 15400    running time 1001 seconds

steps 15600    base_loss: 0.221207    reg_loss: 0.071741    l2_loss: 0.013407    loss: 0.306355
steps 15600    v_Prec: 0.612087  v_Recall: 0.861224  v_F1: 0.715591  v_AUC: 0.945970
steps 15600    running time 1012 seconds

steps 15800    base_loss: 0.217332    reg_loss: 0.070625    l2_loss: 0.013394    loss: 0.301351
steps 15800    v_Prec: 0.608046  v_Recall: 0.864610  v_F1: 0.713979  v_AUC: 0.946256
steps 15800    running time 1024 seconds

steps 16000    base_loss: 0.212588    reg_loss: 0.070299    l2_loss: 0.013448    loss: 0.296334
steps 16000    v_Prec: 0.607680  v_Recall: 0.864880  v_F1: 0.713818  v_AUC: 0.946222
steps 16000    running time 1035 seconds

steps 16200    base_loss: 0.213768    reg_loss: 0.070654    l2_loss: 0.013441    loss: 0.297863
steps 16200    v_Prec: 0.611944  v_Recall: 0.860242  v_F1: 0.715154  v_AUC: 0.945949
steps 16200    running time 1046 seconds

steps 16400    base_loss: 0.211702    reg_loss: 0.070333    l2_loss: 0.013529    loss: 0.295565
steps 16400    v_Prec: 0.612976  v_Recall: 0.861543  v_F1: 0.716309  v_AUC: 0.946374
steps 16400    running time 1057 seconds

steps 16600    base_loss: 0.213529    reg_loss: 0.069545    l2_loss: 0.013531    loss: 0.296605
steps 16600    v_Prec: 0.616291  v_Recall: 0.854647  v_F1: 0.716157  v_AUC: 0.946207
steps 16600    running time 1068 seconds

steps 16800    base_loss: 0.213990    reg_loss: 0.069173    l2_loss: 0.013463    loss: 0.296626
steps 16800    v_Prec: 0.614452  v_Recall: 0.859727  v_F1: 0.716685  v_AUC: 0.946649
steps 16800    running time 1079 seconds

steps 17000    base_loss: 0.210285    reg_loss: 0.068626    l2_loss: 0.013418    loss: 0.292329
steps 17000    v_Prec: 0.613652  v_Recall: 0.861935  v_F1: 0.716906  v_AUC: 0.946637
steps 17000    running time 1091 seconds

steps 17200    base_loss: 0.213901    reg_loss: 0.069943    l2_loss: 0.013499    loss: 0.297343
steps 17200    v_Prec: 0.617013  v_Recall: 0.853542  v_F1: 0.716255  v_AUC: 0.946917
steps 17200    running time 1103 seconds

steps 17400    base_loss: 0.217985    reg_loss: 0.069759    l2_loss: 0.013584    loss: 0.301328
steps 17400    v_Prec: 0.615659  v_Recall: 0.855039  v_F1: 0.715868  v_AUC: 0.946659
steps 17400    running time 1113 seconds

steps 17600    base_loss: 0.215111    reg_loss: 0.069216    l2_loss: 0.013605    loss: 0.297931
steps 17600    v_Prec: 0.612287  v_Recall: 0.861911  v_F1: 0.715965  v_AUC: 0.946997
steps 17600    running time 1124 seconds

steps 17800    base_loss: 0.218289    reg_loss: 0.070440    l2_loss: 0.013644    loss: 0.302373
steps 17800    v_Prec: 0.610358  v_Recall: 0.868512  v_F1: 0.716903  v_AUC: 0.947134
steps 17800    running time 1135 seconds

steps 18000    base_loss: 0.218281    reg_loss: 0.068798    l2_loss: 0.013646    loss: 0.300724
steps 18000    v_Prec: 0.620163  v_Recall: 0.853076  v_F1: 0.718208  v_AUC: 0.947397
steps 18000    running time 1146 seconds

steps 18200    base_loss: 0.208743    reg_loss: 0.068256    l2_loss: 0.013672    loss: 0.290671
steps 18200    v_Prec: 0.608459  v_Recall: 0.868095  v_F1: 0.715450  v_AUC: 0.947149
steps 18200    running time 1158 seconds

steps 18400    base_loss: 0.195839    reg_loss: 0.069472    l2_loss: 0.013878    loss: 0.279188
steps 18400    v_Prec: 0.606217  v_Recall: 0.870966  v_F1: 0.714867  v_AUC: 0.946634
steps 18400    running time 1169 seconds

steps 18600    base_loss: 0.193642    reg_loss: 0.069012    l2_loss: 0.013916    loss: 0.276571
steps 18600    v_Prec: 0.612714  v_Recall: 0.859113  v_F1: 0.715288  v_AUC: 0.946724
steps 18600    running time 1180 seconds

steps 18800    base_loss: 0.195489    reg_loss: 0.068991    l2_loss: 0.013938    loss: 0.278418
steps 18800    v_Prec: 0.613564  v_Recall: 0.862745  v_F1: 0.717125  v_AUC: 0.946717
steps 18800    running time 1191 seconds

steps 19000    base_loss: 0.199329    reg_loss: 0.067189    l2_loss: 0.014053    loss: 0.280570
steps 19000    v_Prec: 0.608422  v_Recall: 0.867653  v_F1: 0.715274  v_AUC: 0.946480
steps 19000    running time 1202 seconds

steps 19200    base_loss: 0.201625    reg_loss: 0.070295    l2_loss: 0.014248    loss: 0.286167
steps 19200    v_Prec: 0.613429  v_Recall: 0.855088  v_F1: 0.714375  v_AUC: 0.946902
steps 19200    running time 1213 seconds

steps 19400    base_loss: 0.192692    reg_loss: 0.067528    l2_loss: 0.014329    loss: 0.274550
steps 19400    v_Prec: 0.611868  v_Recall: 0.859849  v_F1: 0.714966  v_AUC: 0.946647
steps 19400    running time 1224 seconds

steps 19600    base_loss: 0.196520    reg_loss: 0.068075    l2_loss: 0.014321    loss: 0.278916
steps 19600    v_Prec: 0.617665  v_Recall: 0.854475  v_F1: 0.717023  v_AUC: 0.947051
steps 19600    running time 1235 seconds

steps 19800    base_loss: 0.192873    reg_loss: 0.068172    l2_loss: 0.014378    loss: 0.275422
steps 19800    v_Prec: 0.620436  v_Recall: 0.849812  v_F1: 0.717231  v_AUC: 0.946989
steps 19800    running time 1246 seconds

steps 20000    base_loss: 0.205811    reg_loss: 0.070272    l2_loss: 0.014490    loss: 0.290573
steps 20000    v_Prec: 0.618543  v_Recall: 0.853322  v_F1: 0.717207  v_AUC: 0.946886
steps 20000    running time 1257 seconds

Early stop model F1: 0.718208
testing thre: 0.33548114
testing Prec: 0.5567206963047897
testing Recall: 0.7749307177783259
testing F1: 0.647947299461348
testing AUC: 0.9045381299729864
overall running time 1266 seconds
(0.5843830758711801, 0.7316637889757839, 0.6497822333324743, 0.9045381299729864, 0.3906378)
2019-02-17 01:24:39.921087: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 01:24:40.311507: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 01:24:40.312447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 01:24:40.312482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 87.550000 seconds
loading data in 109.530000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.1
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 1.095720    reg_loss: 0.216744    l2_loss: 0.882294    loss: 2.194758
steps 200    v_Prec: 0.157335  v_Recall: 1.000000  v_F1: 0.271892  v_AUC: 0.503072
steps 200    running time 126 seconds

steps 400    base_loss: 0.988547    reg_loss: 0.216097    l2_loss: 0.871393    loss: 2.076037
steps 400    v_Prec: 0.158577  v_Recall: 0.964796  v_F1: 0.272383  v_AUC: 0.521593
steps 400    running time 138 seconds

steps 600    base_loss: 0.815485    reg_loss: 0.214080    l2_loss: 0.848704    loss: 1.878270
steps 600    v_Prec: 0.163390  v_Recall: 0.886644  v_F1: 0.275931  v_AUC: 0.546886
steps 600    running time 150 seconds

steps 800    base_loss: 0.641702    reg_loss: 0.211619    l2_loss: 0.812750    loss: 1.666071
steps 800    v_Prec: 0.179812  v_Recall: 0.709492  v_F1: 0.286910  v_AUC: 0.576660
steps 800    running time 161 seconds

steps 1000    base_loss: 0.519626    reg_loss: 0.208456    l2_loss: 0.768140    loss: 1.496222
steps 1000    v_Prec: 0.195615  v_Recall: 0.668043  v_F1: 0.302618  v_AUC: 0.607755
steps 1000    running time 173 seconds

steps 1200    base_loss: 0.459850    reg_loss: 0.203984    l2_loss: 0.720088    loss: 1.383922
steps 1200    v_Prec: 0.220530  v_Recall: 0.601470  v_F1: 0.322730  v_AUC: 0.638657
steps 1200    running time 184 seconds

steps 1400    base_loss: 0.436837    reg_loss: 0.197550    l2_loss: 0.664211    loss: 1.298598
steps 1400    v_Prec: 0.247460  v_Recall: 0.588514  v_F1: 0.348416  v_AUC: 0.671390
steps 1400    running time 196 seconds

steps 1600    base_loss: 0.422198    reg_loss: 0.189888    l2_loss: 0.613230    loss: 1.225316
steps 1600    v_Prec: 0.294664  v_Recall: 0.535511  v_F1: 0.380150  v_AUC: 0.702870
steps 1600    running time 207 seconds

steps 1800    base_loss: 0.411666    reg_loss: 0.180948    l2_loss: 0.559996    loss: 1.152610
steps 1800    v_Prec: 0.350288  v_Recall: 0.507068  v_F1: 0.414343  v_AUC: 0.728436
steps 1800    running time 219 seconds

steps 2000    base_loss: 0.405281    reg_loss: 0.171993    l2_loss: 0.514664    loss: 1.091938
steps 2000    v_Prec: 0.377904  v_Recall: 0.539101  v_F1: 0.444334  v_AUC: 0.749357
steps 2000    running time 230 seconds

steps 2200    base_loss: 0.389497    reg_loss: 0.161249    l2_loss: 0.473430    loss: 1.024175
steps 2200    v_Prec: 0.399431  v_Recall: 0.548688  v_F1: 0.462311  v_AUC: 0.762552
steps 2200    running time 242 seconds

steps 2400    base_loss: 0.383174    reg_loss: 0.151362    l2_loss: 0.435850    loss: 0.970386
steps 2400    v_Prec: 0.405919  v_Recall: 0.575903  v_F1: 0.476196  v_AUC: 0.775647
steps 2400    running time 254 seconds

steps 2600    base_loss: 0.370460    reg_loss: 0.141827    l2_loss: 0.404078    loss: 0.916364
steps 2600    v_Prec: 0.414112  v_Recall: 0.592546  v_F1: 0.487515  v_AUC: 0.787054
steps 2600    running time 265 seconds

steps 2800    base_loss: 0.368628    reg_loss: 0.134466    l2_loss: 0.373555    loss: 0.876649
steps 2800    v_Prec: 0.429065  v_Recall: 0.607149  v_F1: 0.502804  v_AUC: 0.802223
steps 2800    running time 276 seconds

steps 3000    base_loss: 0.356614    reg_loss: 0.127302    l2_loss: 0.348657    loss: 0.832573
steps 3000    v_Prec: 0.461125  v_Recall: 0.588465  v_F1: 0.517070  v_AUC: 0.816995
steps 3000    running time 288 seconds

steps 3200    base_loss: 0.348906    reg_loss: 0.122017    l2_loss: 0.325749    loss: 0.796672
steps 3200    v_Prec: 0.478728  v_Recall: 0.610247  v_F1: 0.536545  v_AUC: 0.832213
steps 3200    running time 300 seconds

steps 3400    base_loss: 0.332301    reg_loss: 0.116238    l2_loss: 0.303130    loss: 0.751669
steps 3400    v_Prec: 0.493019  v_Recall: 0.638911  v_F1: 0.556563  v_AUC: 0.847656
steps 3400    running time 311 seconds

steps 3600    base_loss: 0.324834    reg_loss: 0.112729    l2_loss: 0.286304    loss: 0.723867
steps 3600    v_Prec: 0.493406  v_Recall: 0.686113  v_F1: 0.574017  v_AUC: 0.861547
steps 3600    running time 323 seconds

steps 3800    base_loss: 0.312897    reg_loss: 0.108889    l2_loss: 0.268663    loss: 0.690449
steps 3800    v_Prec: 0.526552  v_Recall: 0.677902  v_F1: 0.592718  v_AUC: 0.872964
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.301218    reg_loss: 0.105457    l2_loss: 0.254764    loss: 0.661439
steps 4000    v_Prec: 0.536057  v_Recall: 0.697716  v_F1: 0.606296  v_AUC: 0.881663
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.291247    reg_loss: 0.103653    l2_loss: 0.243236    loss: 0.638136
steps 4200    v_Prec: 0.555040  v_Recall: 0.696880  v_F1: 0.617925  v_AUC: 0.890046
steps 4200    running time 357 seconds

steps 4400    base_loss: 0.285992    reg_loss: 0.101675    l2_loss: 0.229938    loss: 0.617605
steps 4400    v_Prec: 0.546055  v_Recall: 0.735403  v_F1: 0.626740  v_AUC: 0.896227
steps 4400    running time 369 seconds

steps 4600    base_loss: 0.282928    reg_loss: 0.099281    l2_loss: 0.218638    loss: 0.600846
steps 4600    v_Prec: 0.562693  v_Recall: 0.734764  v_F1: 0.637318  v_AUC: 0.901691
steps 4600    running time 380 seconds

steps 4800    base_loss: 0.271075    reg_loss: 0.096087    l2_loss: 0.207302    loss: 0.574465
steps 4800    v_Prec: 0.562202  v_Recall: 0.758807  v_F1: 0.645874  v_AUC: 0.907263
steps 4800    running time 392 seconds

steps 5000    base_loss: 0.268996    reg_loss: 0.095098    l2_loss: 0.199374    loss: 0.563468
steps 5000    v_Prec: 0.573591  v_Recall: 0.751899  v_F1: 0.650752  v_AUC: 0.910396
steps 5000    running time 403 seconds

steps 5200    base_loss: 0.255824    reg_loss: 0.092279    l2_loss: 0.189724    loss: 0.537826
steps 5200    v_Prec: 0.569533  v_Recall: 0.769108  v_F1: 0.654443  v_AUC: 0.913368
steps 5200    running time 415 seconds

steps 5400    base_loss: 0.262176    reg_loss: 0.091667    l2_loss: 0.182195    loss: 0.536037
steps 5400    v_Prec: 0.572855  v_Recall: 0.779876  v_F1: 0.660524  v_AUC: 0.916231
steps 5400    running time 427 seconds

steps 5600    base_loss: 0.254478    reg_loss: 0.088816    l2_loss: 0.173428    loss: 0.516723
steps 5600    v_Prec: 0.572273  v_Recall: 0.792168  v_F1: 0.664501  v_AUC: 0.918172
steps 5600    running time 438 seconds

steps 5800    base_loss: 0.252358    reg_loss: 0.087173    l2_loss: 0.165938    loss: 0.505469
steps 5800    v_Prec: 0.568422  v_Recall: 0.808147  v_F1: 0.667411  v_AUC: 0.920163
steps 5800    running time 450 seconds

steps 6000    base_loss: 0.253316    reg_loss: 0.085806    l2_loss: 0.158377    loss: 0.497499
steps 6000    v_Prec: 0.582933  v_Recall: 0.789611  v_F1: 0.670711  v_AUC: 0.922259
steps 6000    running time 461 seconds

steps 6200    base_loss: 0.240689    reg_loss: 0.084710    l2_loss: 0.152544    loss: 0.477943
steps 6200    v_Prec: 0.578942  v_Recall: 0.800231  v_F1: 0.671833  v_AUC: 0.923604
steps 6200    running time 473 seconds

steps 6400    base_loss: 0.250593    reg_loss: 0.085291    l2_loss: 0.147179    loss: 0.483063
steps 6400    v_Prec: 0.578024  v_Recall: 0.805541  v_F1: 0.673076  v_AUC: 0.925332
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.245085    reg_loss: 0.083076    l2_loss: 0.140915    loss: 0.469076
steps 6600    v_Prec: 0.583076  v_Recall: 0.803968  v_F1: 0.675933  v_AUC: 0.926284
steps 6600    running time 496 seconds

steps 6800    base_loss: 0.241807    reg_loss: 0.082038    l2_loss: 0.135273    loss: 0.459118
steps 6800    v_Prec: 0.581630  v_Recall: 0.810925  v_F1: 0.677400  v_AUC: 0.926994
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.237989    reg_loss: 0.080747    l2_loss: 0.130017    loss: 0.448754
steps 7000    v_Prec: 0.578006  v_Recall: 0.821275  v_F1: 0.678494  v_AUC: 0.927988
steps 7000    running time 520 seconds

steps 7200    base_loss: 0.244948    reg_loss: 0.080914    l2_loss: 0.126033    loss: 0.451895
steps 7200    v_Prec: 0.575883  v_Recall: 0.830986  v_F1: 0.680306  v_AUC: 0.929246
steps 7200    running time 531 seconds

steps 7400    base_loss: 0.238885    reg_loss: 0.080197    l2_loss: 0.122053    loss: 0.441134
steps 7400    v_Prec: 0.581699  v_Recall: 0.819702  v_F1: 0.680490  v_AUC: 0.930094
steps 7400    running time 543 seconds

steps 7600    base_loss: 0.242582    reg_loss: 0.079820    l2_loss: 0.118517    loss: 0.440919
steps 7600    v_Prec: 0.584444  v_Recall: 0.819431  v_F1: 0.682271  v_AUC: 0.930750
steps 7600    running time 554 seconds

steps 7800    base_loss: 0.236723    reg_loss: 0.078328    l2_loss: 0.113678    loss: 0.428729
steps 7800    v_Prec: 0.589460  v_Recall: 0.812523  v_F1: 0.683246  v_AUC: 0.931208
steps 7800    running time 566 seconds

steps 8000    base_loss: 0.233686    reg_loss: 0.078353    l2_loss: 0.111710    loss: 0.423749
steps 8000    v_Prec: 0.587790  v_Recall: 0.820365  v_F1: 0.684871  v_AUC: 0.931734
steps 8000    running time 578 seconds

steps 8200    base_loss: 0.234697    reg_loss: 0.077060    l2_loss: 0.108585    loss: 0.420342
steps 8200    v_Prec: 0.583440  v_Recall: 0.831649  v_F1: 0.685776  v_AUC: 0.932065
steps 8200    running time 589 seconds

steps 8400    base_loss: 0.233793    reg_loss: 0.077046    l2_loss: 0.105053    loss: 0.415893
steps 8400    v_Prec: 0.583519  v_Recall: 0.832264  v_F1: 0.686040  v_AUC: 0.932088
steps 8400    running time 601 seconds

steps 8600    base_loss: 0.237939    reg_loss: 0.078220    l2_loss: 0.102718    loss: 0.418878
steps 8600    v_Prec: 0.588211  v_Recall: 0.826216  v_F1: 0.687189  v_AUC: 0.932965
steps 8600    running time 612 seconds

steps 8800    base_loss: 0.231006    reg_loss: 0.075388    l2_loss: 0.099823    loss: 0.406216
steps 8800    v_Prec: 0.586564  v_Recall: 0.828748  v_F1: 0.686935  v_AUC: 0.933342
steps 8800    running time 624 seconds

steps 9000    base_loss: 0.231686    reg_loss: 0.075075    l2_loss: 0.097397    loss: 0.404158
steps 9000    v_Prec: 0.589369  v_Recall: 0.828945  v_F1: 0.688923  v_AUC: 0.933763
steps 9000    running time 635 seconds

steps 9200    base_loss: 0.228670    reg_loss: 0.075976    l2_loss: 0.096039    loss: 0.400684
steps 9200    v_Prec: 0.581579  v_Recall: 0.842909  v_F1: 0.688273  v_AUC: 0.933947
steps 9200    running time 646 seconds

steps 9400    base_loss: 0.236923    reg_loss: 0.075923    l2_loss: 0.094491    loss: 0.407336
steps 9400    v_Prec: 0.585679  v_Recall: 0.838484  v_F1: 0.689643  v_AUC: 0.934068
steps 9400    running time 657 seconds

steps 9600    base_loss: 0.230090    reg_loss: 0.074223    l2_loss: 0.091797    loss: 0.396110
steps 9600    v_Prec: 0.585010  v_Recall: 0.842589  v_F1: 0.690563  v_AUC: 0.934895
steps 9600    running time 669 seconds

steps 9800    base_loss: 0.231542    reg_loss: 0.074463    l2_loss: 0.090479    loss: 0.396484
steps 9800    v_Prec: 0.587673  v_Recall: 0.835878  v_F1: 0.690137  v_AUC: 0.934855
steps 9800    running time 680 seconds

steps 10000    base_loss: 0.229344    reg_loss: 0.074134    l2_loss: 0.088556    loss: 0.392035
steps 10000    v_Prec: 0.595504  v_Recall: 0.825085  v_F1: 0.691743  v_AUC: 0.934974
steps 10000    running time 691 seconds

steps 10200    base_loss: 0.230344    reg_loss: 0.073742    l2_loss: 0.087779    loss: 0.391864
steps 10200    v_Prec: 0.592388  v_Recall: 0.828429  v_F1: 0.690802  v_AUC: 0.934883
steps 10200    running time 702 seconds

steps 10400    base_loss: 0.227955    reg_loss: 0.073130    l2_loss: 0.085533    loss: 0.386618
steps 10400    v_Prec: 0.595168  v_Recall: 0.830371  v_F1: 0.693366  v_AUC: 0.935509
steps 10400    running time 714 seconds

steps 10600    base_loss: 0.232177    reg_loss: 0.073433    l2_loss: 0.085214    loss: 0.390824
steps 10600    v_Prec: 0.589311  v_Recall: 0.840598  v_F1: 0.692874  v_AUC: 0.935398
steps 10600    running time 725 seconds

steps 10800    base_loss: 0.230390    reg_loss: 0.073083    l2_loss: 0.083997    loss: 0.387470
steps 10800    v_Prec: 0.596919  v_Recall: 0.824889  v_F1: 0.692628  v_AUC: 0.935585
steps 10800    running time 736 seconds

steps 11000    base_loss: 0.225636    reg_loss: 0.071340    l2_loss: 0.082389    loss: 0.379365
steps 11000    v_Prec: 0.591790  v_Recall: 0.832510  v_F1: 0.691808  v_AUC: 0.935242
steps 11000    running time 747 seconds

steps 11200    base_loss: 0.227867    reg_loss: 0.071418    l2_loss: 0.081864    loss: 0.381149
steps 11200    v_Prec: 0.592747  v_Recall: 0.835779  v_F1: 0.693590  v_AUC: 0.935093
steps 11200    running time 758 seconds

steps 11400    base_loss: 0.230548    reg_loss: 0.071767    l2_loss: 0.080329    loss: 0.382643
steps 11400    v_Prec: 0.586374  v_Recall: 0.843818  v_F1: 0.691925  v_AUC: 0.935383
steps 11400    running time 770 seconds

steps 11600    base_loss: 0.229634    reg_loss: 0.071521    l2_loss: 0.079489    loss: 0.380644
steps 11600    v_Prec: 0.586329  v_Recall: 0.844113  v_F1: 0.691993  v_AUC: 0.935614
steps 11600    running time 781 seconds

steps 11800    base_loss: 0.226561    reg_loss: 0.070067    l2_loss: 0.078079    loss: 0.374707
steps 11800    v_Prec: 0.591688  v_Recall: 0.838213  v_F1: 0.693699  v_AUC: 0.935430
steps 11800    running time 791 seconds

steps 12000    base_loss: 0.221182    reg_loss: 0.069802    l2_loss: 0.077443    loss: 0.368428
steps 12000    v_Prec: 0.594778  v_Recall: 0.828306  v_F1: 0.692381  v_AUC: 0.935265
steps 12000    running time 803 seconds

steps 12200    base_loss: 0.221841    reg_loss: 0.068713    l2_loss: 0.076678    loss: 0.367233
steps 12200    v_Prec: 0.584992  v_Recall: 0.853234  v_F1: 0.694098  v_AUC: 0.935328
steps 12200    running time 814 seconds

steps 12400    base_loss: 0.227098    reg_loss: 0.069906    l2_loss: 0.075697    loss: 0.372700
steps 12400    v_Prec: 0.594124  v_Recall: 0.831281  v_F1: 0.692974  v_AUC: 0.935317
steps 12400    running time 826 seconds

steps 12600    base_loss: 0.225338    reg_loss: 0.069917    l2_loss: 0.075842    loss: 0.371097
steps 12600    v_Prec: 0.594685  v_Recall: 0.832854  v_F1: 0.693901  v_AUC: 0.935552
steps 12600    running time 837 seconds

steps 12800    base_loss: 0.228194    reg_loss: 0.070267    l2_loss: 0.075291    loss: 0.373753
steps 12800    v_Prec: 0.587567  v_Recall: 0.848612  v_F1: 0.694366  v_AUC: 0.935169
steps 12800    running time 848 seconds

steps 13000    base_loss: 0.227586    reg_loss: 0.069248    l2_loss: 0.074904    loss: 0.371738
steps 13000    v_Prec: 0.596401  v_Recall: 0.829437  v_F1: 0.693875  v_AUC: 0.934977
steps 13000    running time 859 seconds

steps 13200    base_loss: 0.232482    reg_loss: 0.069909    l2_loss: 0.074901    loss: 0.377292
steps 13200    v_Prec: 0.596543  v_Recall: 0.828035  v_F1: 0.693480  v_AUC: 0.935287
steps 13200    running time 871 seconds

steps 13400    base_loss: 0.228435    reg_loss: 0.069402    l2_loss: 0.074972    loss: 0.372809
steps 13400    v_Prec: 0.592792  v_Recall: 0.837009  v_F1: 0.694044  v_AUC: 0.934972
steps 13400    running time 881 seconds

steps 13600    base_loss: 0.226900    reg_loss: 0.067577    l2_loss: 0.073653    loss: 0.368131
steps 13600    v_Prec: 0.594717  v_Recall: 0.832928  v_F1: 0.693949  v_AUC: 0.934440
steps 13600    running time 893 seconds

steps 13800    base_loss: 0.232639    reg_loss: 0.070077    l2_loss: 0.074392    loss: 0.377107
steps 13800    v_Prec: 0.590116  v_Recall: 0.845982  v_F1: 0.695255  v_AUC: 0.934868
steps 13800    running time 904 seconds

steps 14000    base_loss: 0.227204    reg_loss: 0.068223    l2_loss: 0.072577    loss: 0.368003
steps 14000    v_Prec: 0.588956  v_Recall: 0.844580  v_F1: 0.693977  v_AUC: 0.934492
steps 14000    running time 915 seconds

steps 14200    base_loss: 0.229326    reg_loss: 0.068315    l2_loss: 0.072547    loss: 0.370189
steps 14200    v_Prec: 0.591947  v_Recall: 0.840254  v_F1: 0.694575  v_AUC: 0.934884
steps 14200    running time 927 seconds

steps 14400    base_loss: 0.226161    reg_loss: 0.067025    l2_loss: 0.072156    loss: 0.365342
steps 14400    v_Prec: 0.584932  v_Recall: 0.850874  v_F1: 0.693274  v_AUC: 0.934737
steps 14400    running time 937 seconds

steps 14600    base_loss: 0.231307    reg_loss: 0.067426    l2_loss: 0.071617    loss: 0.370351
steps 14600    v_Prec: 0.590135  v_Recall: 0.840032  v_F1: 0.693251  v_AUC: 0.935177
steps 14600    running time 948 seconds

steps 14800    base_loss: 0.230937    reg_loss: 0.067585    l2_loss: 0.070665    loss: 0.369187
steps 14800    v_Prec: 0.592534  v_Recall: 0.834255  v_F1: 0.692919  v_AUC: 0.935190
steps 14800    running time 959 seconds

steps 15000    base_loss: 0.225586    reg_loss: 0.067218    l2_loss: 0.071371    loss: 0.364175
steps 15000    v_Prec: 0.588874  v_Recall: 0.833764  v_F1: 0.690241  v_AUC: 0.934652
steps 15000    running time 970 seconds

steps 15200    base_loss: 0.228073    reg_loss: 0.066591    l2_loss: 0.071043    loss: 0.365707
steps 15200    v_Prec: 0.594634  v_Recall: 0.836320  v_F1: 0.695067  v_AUC: 0.934678
steps 15200    running time 981 seconds

steps 15400    base_loss: 0.230354    reg_loss: 0.067956    l2_loss: 0.071350    loss: 0.369661
steps 15400    v_Prec: 0.588128  v_Recall: 0.845170  v_F1: 0.693600  v_AUC: 0.934177
steps 15400    running time 992 seconds

steps 15600    base_loss: 0.228194    reg_loss: 0.066326    l2_loss: 0.070644    loss: 0.365163
steps 15600    v_Prec: 0.598821  v_Recall: 0.824102  v_F1: 0.693628  v_AUC: 0.934339
steps 15600    running time 1003 seconds

steps 15800    base_loss: 0.227048    reg_loss: 0.066390    l2_loss: 0.070039    loss: 0.363477
steps 15800    v_Prec: 0.586632  v_Recall: 0.845170  v_F1: 0.692560  v_AUC: 0.933675
steps 15800    running time 1014 seconds

Early stop model F1: 0.695255
testing thre: 0.31422007
testing Prec: 0.45036241783320746
testing Recall: 0.8131628966497875
testing F1: 0.5796765668716352
testing AUC: 0.8813415814735074
overall running time 1023 seconds
(0.47032430383540635, 0.7741472120253624, 0.5851483845495822, 0.8813415814735074, 0.37643316)
2019-02-17 01:36:25.918133: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 01:36:26.575359: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 01:36:26.576297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 01:36:26.576333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.020000 seconds
loading data in 110.890000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.998063    reg_loss: 0.215030    l2_loss: 0.883386    loss: 2.096479
steps 200    v_Prec: 0.157502  v_Recall: 1.000000  v_F1: 0.272141  v_AUC: 0.472404
steps 200    running time 128 seconds

steps 400    base_loss: 0.939819    reg_loss: 0.214499    l2_loss: 0.867561    loss: 2.021880
steps 400    v_Prec: 0.157502  v_Recall: 1.000000  v_F1: 0.272141  v_AUC: 0.478734
steps 400    running time 140 seconds

steps 600    base_loss: 0.829176    reg_loss: 0.214325    l2_loss: 0.841097    loss: 1.884599
steps 600    v_Prec: 0.157501  v_Recall: 1.000000  v_F1: 0.272140  v_AUC: 0.493784
steps 600    running time 151 seconds

steps 800    base_loss: 0.687419    reg_loss: 0.213443    l2_loss: 0.800155    loss: 1.701017
steps 800    v_Prec: 0.157991  v_Recall: 0.984357  v_F1: 0.272281  v_AUC: 0.529115
steps 800    running time 162 seconds

steps 1000    base_loss: 0.519637    reg_loss: 0.212639    l2_loss: 0.753720    loss: 1.485996
steps 1000    v_Prec: 0.210157  v_Recall: 0.556704  v_F1: 0.305128  v_AUC: 0.612966
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.438948    reg_loss: 0.209777    l2_loss: 0.703809    loss: 1.352533
steps 1200    v_Prec: 0.293961  v_Recall: 0.468836  v_F1: 0.361353  v_AUC: 0.676214
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.425531    reg_loss: 0.201984    l2_loss: 0.658578    loss: 1.286093
steps 1400    v_Prec: 0.344460  v_Recall: 0.502284  v_F1: 0.408664  v_AUC: 0.712714
steps 1400    running time 197 seconds

steps 1600    base_loss: 0.406960    reg_loss: 0.193092    l2_loss: 0.612533    loss: 1.212584
steps 1600    v_Prec: 0.381182  v_Recall: 0.546095  v_F1: 0.448974  v_AUC: 0.740288
steps 1600    running time 208 seconds

steps 1800    base_loss: 0.403939    reg_loss: 0.184411    l2_loss: 0.568133    loss: 1.156483
steps 1800    v_Prec: 0.402766  v_Recall: 0.550688  v_F1: 0.465252  v_AUC: 0.753085
steps 1800    running time 220 seconds

steps 2000    base_loss: 0.391081    reg_loss: 0.173573    l2_loss: 0.527331    loss: 1.091985
steps 2000    v_Prec: 0.407413  v_Recall: 0.567706  v_F1: 0.474385  v_AUC: 0.762116
steps 2000    running time 231 seconds

steps 2200    base_loss: 0.378890    reg_loss: 0.160424    l2_loss: 0.486186    loss: 1.025500
steps 2200    v_Prec: 0.413874  v_Recall: 0.582981  v_F1: 0.484084  v_AUC: 0.770076
steps 2200    running time 243 seconds

steps 2400    base_loss: 0.377693    reg_loss: 0.149449    l2_loss: 0.451826    loss: 0.978968
steps 2400    v_Prec: 0.421147  v_Recall: 0.594818  v_F1: 0.493139  v_AUC: 0.781367
steps 2400    running time 254 seconds

steps 2600    base_loss: 0.374789    reg_loss: 0.139752    l2_loss: 0.418674    loss: 0.933214
steps 2600    v_Prec: 0.439135  v_Recall: 0.586567  v_F1: 0.502255  v_AUC: 0.791762
steps 2600    running time 266 seconds

steps 2800    base_loss: 0.358641    reg_loss: 0.129561    l2_loss: 0.387390    loss: 0.875591
steps 2800    v_Prec: 0.438184  v_Recall: 0.619892  v_F1: 0.513435  v_AUC: 0.801185
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.350152    reg_loss: 0.122155    l2_loss: 0.361129    loss: 0.833436
steps 3000    v_Prec: 0.456003  v_Recall: 0.627922  v_F1: 0.528329  v_AUC: 0.810663
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.346900    reg_loss: 0.117433    l2_loss: 0.337518    loss: 0.801851
steps 3200    v_Prec: 0.474018  v_Recall: 0.629494  v_F1: 0.540803  v_AUC: 0.823337
steps 3200    running time 301 seconds

steps 3400    base_loss: 0.334747    reg_loss: 0.112988    l2_loss: 0.314873    loss: 0.762607
steps 3400    v_Prec: 0.485704  v_Recall: 0.644941  v_F1: 0.554109  v_AUC: 0.832959
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.325801    reg_loss: 0.109495    l2_loss: 0.294173    loss: 0.729469
steps 3600    v_Prec: 0.500605  v_Recall: 0.650737  v_F1: 0.565882  v_AUC: 0.842803
steps 3600    running time 324 seconds

steps 3800    base_loss: 0.318305    reg_loss: 0.106260    l2_loss: 0.278126    loss: 0.702691
steps 3800    v_Prec: 0.523977  v_Recall: 0.642657  v_F1: 0.577281  v_AUC: 0.849719
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.321950    reg_loss: 0.105121    l2_loss: 0.263195    loss: 0.690266
steps 4000    v_Prec: 0.528382  v_Recall: 0.670015  v_F1: 0.590829  v_AUC: 0.859797
steps 4000    running time 348 seconds

steps 4200    base_loss: 0.314175    reg_loss: 0.102903    l2_loss: 0.248996    loss: 0.666074
steps 4200    v_Prec: 0.535504  v_Recall: 0.687844  v_F1: 0.602189  v_AUC: 0.867722
steps 4200    running time 359 seconds

steps 4400    base_loss: 0.303894    reg_loss: 0.099616    l2_loss: 0.237446    loss: 0.640956
steps 4400    v_Prec: 0.536278  v_Recall: 0.706090  v_F1: 0.609579  v_AUC: 0.873091
steps 4400    running time 371 seconds

steps 4600    base_loss: 0.299768    reg_loss: 0.098063    l2_loss: 0.225947    loss: 0.623778
steps 4600    v_Prec: 0.542864  v_Recall: 0.718934  v_F1: 0.618614  v_AUC: 0.879654
steps 4600    running time 382 seconds

steps 4800    base_loss: 0.289794    reg_loss: 0.095415    l2_loss: 0.215073    loss: 0.600282
steps 4800    v_Prec: 0.563630  v_Recall: 0.702087  v_F1: 0.625286  v_AUC: 0.884863
steps 4800    running time 394 seconds

steps 5000    base_loss: 0.285840    reg_loss: 0.093750    l2_loss: 0.204526    loss: 0.584116
steps 5000    v_Prec: 0.552074  v_Recall: 0.734725  v_F1: 0.630437  v_AUC: 0.887634
steps 5000    running time 405 seconds

steps 5200    base_loss: 0.285111    reg_loss: 0.093277    l2_loss: 0.197210    loss: 0.575598
steps 5200    v_Prec: 0.563567  v_Recall: 0.730354  v_F1: 0.636211  v_AUC: 0.891500
steps 5200    running time 417 seconds

steps 5400    base_loss: 0.283536    reg_loss: 0.092371    l2_loss: 0.189405    loss: 0.565312
steps 5400    v_Prec: 0.570078  v_Recall: 0.736076  v_F1: 0.642529  v_AUC: 0.895812
steps 5400    running time 428 seconds

steps 5600    base_loss: 0.277042    reg_loss: 0.089262    l2_loss: 0.180934    loss: 0.547239
steps 5600    v_Prec: 0.569870  v_Recall: 0.751523  v_F1: 0.648210  v_AUC: 0.899953
steps 5600    running time 440 seconds

steps 5800    base_loss: 0.281183    reg_loss: 0.091038    l2_loss: 0.175016    loss: 0.547237
steps 5800    v_Prec: 0.573825  v_Recall: 0.753610  v_F1: 0.651542  v_AUC: 0.902334
steps 5800    running time 451 seconds

steps 6000    base_loss: 0.272077    reg_loss: 0.088622    l2_loss: 0.169331    loss: 0.530030
steps 6000    v_Prec: 0.572437  v_Recall: 0.760953  v_F1: 0.653368  v_AUC: 0.905056
steps 6000    running time 463 seconds

steps 6200    base_loss: 0.274125    reg_loss: 0.087751    l2_loss: 0.162891    loss: 0.524766
steps 6200    v_Prec: 0.584707  v_Recall: 0.749853  v_F1: 0.657062  v_AUC: 0.908327
steps 6200    running time 474 seconds

steps 6400    base_loss: 0.263624    reg_loss: 0.086766    l2_loss: 0.157081    loss: 0.507472
steps 6400    v_Prec: 0.579389  v_Recall: 0.767805  v_F1: 0.660421  v_AUC: 0.909482
steps 6400    running time 486 seconds

steps 6600    base_loss: 0.257409    reg_loss: 0.084795    l2_loss: 0.150409    loss: 0.492612
steps 6600    v_Prec: 0.578730  v_Recall: 0.781925  v_F1: 0.665156  v_AUC: 0.911895
steps 6600    running time 497 seconds

steps 6800    base_loss: 0.264196    reg_loss: 0.084768    l2_loss: 0.146296    loss: 0.495260
steps 6800    v_Prec: 0.582741  v_Recall: 0.781262  v_F1: 0.667555  v_AUC: 0.914241
steps 6800    running time 509 seconds

steps 7000    base_loss: 0.253427    reg_loss: 0.083119    l2_loss: 0.142606    loss: 0.479153
steps 7000    v_Prec: 0.587818  v_Recall: 0.783276  v_F1: 0.671615  v_AUC: 0.916367
steps 7000    running time 520 seconds

steps 7200    base_loss: 0.259991    reg_loss: 0.083136    l2_loss: 0.136442    loss: 0.479569
steps 7200    v_Prec: 0.578313  v_Recall: 0.804298  v_F1: 0.672837  v_AUC: 0.918150
steps 7200    running time 531 seconds

steps 7400    base_loss: 0.253739    reg_loss: 0.082556    l2_loss: 0.132897    loss: 0.469192
steps 7400    v_Prec: 0.584896  v_Recall: 0.802063  v_F1: 0.676478  v_AUC: 0.919595
steps 7400    running time 543 seconds

steps 7600    base_loss: 0.253206    reg_loss: 0.082353    l2_loss: 0.128263    loss: 0.463823
steps 7600    v_Prec: 0.576629  v_Recall: 0.821979  v_F1: 0.677784  v_AUC: 0.921226
steps 7600    running time 555 seconds

steps 7800    base_loss: 0.252508    reg_loss: 0.081806    l2_loss: 0.124630    loss: 0.458944
steps 7800    v_Prec: 0.588784  v_Recall: 0.806729  v_F1: 0.680737  v_AUC: 0.923487
steps 7800    running time 566 seconds

steps 8000    base_loss: 0.252171    reg_loss: 0.081430    l2_loss: 0.121891    loss: 0.455493
steps 8000    v_Prec: 0.582819  v_Recall: 0.826252  v_F1: 0.683508  v_AUC: 0.925144
steps 8000    running time 577 seconds

steps 8200    base_loss: 0.245071    reg_loss: 0.079796    l2_loss: 0.116791    loss: 0.441658
steps 8200    v_Prec: 0.586039  v_Recall: 0.823232  v_F1: 0.684674  v_AUC: 0.924973
steps 8200    running time 589 seconds

steps 8400    base_loss: 0.246112    reg_loss: 0.078541    l2_loss: 0.114033    loss: 0.438686
steps 8400    v_Prec: 0.593876  v_Recall: 0.812525  v_F1: 0.686204  v_AUC: 0.926597
steps 8400    running time 600 seconds

steps 8600    base_loss: 0.249641    reg_loss: 0.080069    l2_loss: 0.110509    loss: 0.440219
steps 8600    v_Prec: 0.586697  v_Recall: 0.828119  v_F1: 0.686810  v_AUC: 0.926320
steps 8600    running time 612 seconds

steps 8800    base_loss: 0.245672    reg_loss: 0.079387    l2_loss: 0.108494    loss: 0.433553
steps 8800    v_Prec: 0.597333  v_Recall: 0.816257  v_F1: 0.689843  v_AUC: 0.926916
steps 8800    running time 623 seconds

steps 9000    base_loss: 0.239663    reg_loss: 0.079050    l2_loss: 0.106204    loss: 0.424917
steps 9000    v_Prec: 0.586834  v_Recall: 0.839538  v_F1: 0.690801  v_AUC: 0.927854
steps 9000    running time 635 seconds

steps 9200    base_loss: 0.242818    reg_loss: 0.079393    l2_loss: 0.102778    loss: 0.424988
steps 9200    v_Prec: 0.594055  v_Recall: 0.824091  v_F1: 0.690416  v_AUC: 0.928427
steps 9200    running time 646 seconds

steps 9400    base_loss: 0.248970    reg_loss: 0.078218    l2_loss: 0.101037    loss: 0.428225
steps 9400    v_Prec: 0.593797  v_Recall: 0.825221  v_F1: 0.690638  v_AUC: 0.928374
steps 9400    running time 657 seconds

steps 9600    base_loss: 0.241621    reg_loss: 0.078143    l2_loss: 0.098953    loss: 0.418718
steps 9600    v_Prec: 0.585553  v_Recall: 0.843689  v_F1: 0.691310  v_AUC: 0.928934
steps 9600    running time 668 seconds

steps 9800    base_loss: 0.242067    reg_loss: 0.079306    l2_loss: 0.096926    loss: 0.418299
steps 9800    v_Prec: 0.593134  v_Recall: 0.829543  v_F1: 0.691697  v_AUC: 0.928336
steps 9800    running time 679 seconds

steps 10000    base_loss: 0.238848    reg_loss: 0.077011    l2_loss: 0.095236    loss: 0.411095
steps 10000    v_Prec: 0.589082  v_Recall: 0.840889  v_F1: 0.692815  v_AUC: 0.929597
steps 10000    running time 691 seconds

steps 10200    base_loss: 0.240957    reg_loss: 0.076247    l2_loss: 0.093077    loss: 0.410281
steps 10200    v_Prec: 0.588354  v_Recall: 0.844892  v_F1: 0.693664  v_AUC: 0.930310
steps 10200    running time 702 seconds

steps 10400    base_loss: 0.239697    reg_loss: 0.075597    l2_loss: 0.091376    loss: 0.406670
steps 10400    v_Prec: 0.593429  v_Recall: 0.833423  v_F1: 0.693243  v_AUC: 0.930911
steps 10400    running time 714 seconds

steps 10600    base_loss: 0.242203    reg_loss: 0.076495    l2_loss: 0.090080    loss: 0.408779
steps 10600    v_Prec: 0.592025  v_Recall: 0.838998  v_F1: 0.694200  v_AUC: 0.930416
steps 10600    running time 725 seconds

steps 10800    base_loss: 0.241160    reg_loss: 0.076950    l2_loss: 0.088553    loss: 0.406663
steps 10800    v_Prec: 0.596500  v_Recall: 0.826179  v_F1: 0.692800  v_AUC: 0.930059
steps 10800    running time 736 seconds

steps 11000    base_loss: 0.240690    reg_loss: 0.075479    l2_loss: 0.088037    loss: 0.404206
steps 11000    v_Prec: 0.592008  v_Recall: 0.833522  v_F1: 0.692306  v_AUC: 0.930247
steps 11000    running time 747 seconds

steps 11200    base_loss: 0.240424    reg_loss: 0.075569    l2_loss: 0.086757    loss: 0.402749
steps 11200    v_Prec: 0.592210  v_Recall: 0.834504  v_F1: 0.692783  v_AUC: 0.930119
steps 11200    running time 758 seconds

steps 11400    base_loss: 0.238174    reg_loss: 0.074911    l2_loss: 0.086462    loss: 0.399547
steps 11400    v_Prec: 0.595706  v_Recall: 0.822520  v_F1: 0.690976  v_AUC: 0.929970
steps 11400    running time 769 seconds

steps 11600    base_loss: 0.234665    reg_loss: 0.074522    l2_loss: 0.085109    loss: 0.394296
steps 11600    v_Prec: 0.597212  v_Recall: 0.828954  v_F1: 0.694254  v_AUC: 0.929860
steps 11600    running time 780 seconds

steps 11800    base_loss: 0.240074    reg_loss: 0.073766    l2_loss: 0.084512    loss: 0.398352
steps 11800    v_Prec: 0.602550  v_Recall: 0.817068  v_F1: 0.693601  v_AUC: 0.929582
steps 11800    running time 791 seconds

steps 12000    base_loss: 0.238924    reg_loss: 0.073951    l2_loss: 0.082880    loss: 0.395755
steps 12000    v_Prec: 0.593903  v_Recall: 0.830501  v_F1: 0.692552  v_AUC: 0.930174
steps 12000    running time 802 seconds

steps 12200    base_loss: 0.234414    reg_loss: 0.074008    l2_loss: 0.082336    loss: 0.390758
steps 12200    v_Prec: 0.599507  v_Recall: 0.824705  v_F1: 0.694302  v_AUC: 0.930339
steps 12200    running time 813 seconds

steps 12400    base_loss: 0.236318    reg_loss: 0.073175    l2_loss: 0.081814    loss: 0.391308
steps 12400    v_Prec: 0.591323  v_Recall: 0.838482  v_F1: 0.693541  v_AUC: 0.930330
steps 12400    running time 825 seconds

steps 12600    base_loss: 0.237575    reg_loss: 0.073510    l2_loss: 0.081347    loss: 0.392432
steps 12600    v_Prec: 0.595932  v_Recall: 0.830354  v_F1: 0.693878  v_AUC: 0.930470
steps 12600    running time 835 seconds

steps 12800    base_loss: 0.239143    reg_loss: 0.072790    l2_loss: 0.080601    loss: 0.392534
steps 12800    v_Prec: 0.595809  v_Recall: 0.829568  v_F1: 0.693521  v_AUC: 0.930432
steps 12800    running time 846 seconds

steps 13000    base_loss: 0.237067    reg_loss: 0.073822    l2_loss: 0.080589    loss: 0.391479
steps 13000    v_Prec: 0.598583  v_Recall: 0.830108  v_F1: 0.695586  v_AUC: 0.930579
steps 13000    running time 857 seconds

steps 13200    base_loss: 0.238759    reg_loss: 0.071941    l2_loss: 0.079696    loss: 0.390396
steps 13200    v_Prec: 0.594420  v_Recall: 0.836640  v_F1: 0.695031  v_AUC: 0.931580
steps 13200    running time 869 seconds

steps 13400    base_loss: 0.239200    reg_loss: 0.071642    l2_loss: 0.079516    loss: 0.390357
steps 13400    v_Prec: 0.600748  v_Recall: 0.816233  v_F1: 0.692106  v_AUC: 0.931071
steps 13400    running time 880 seconds

steps 13600    base_loss: 0.231973    reg_loss: 0.070206    l2_loss: 0.078704    loss: 0.380883
steps 13600    v_Prec: 0.593474  v_Recall: 0.833472  v_F1: 0.693291  v_AUC: 0.930758
steps 13600    running time 891 seconds

steps 13800    base_loss: 0.240004    reg_loss: 0.071124    l2_loss: 0.078396    loss: 0.389523
steps 13800    v_Prec: 0.587240  v_Recall: 0.845629  v_F1: 0.693137  v_AUC: 0.930799
steps 13800    running time 902 seconds

steps 14000    base_loss: 0.236660    reg_loss: 0.071002    l2_loss: 0.078597    loss: 0.386259
steps 14000    v_Prec: 0.596146  v_Recall: 0.829715  v_F1: 0.693800  v_AUC: 0.930585
steps 14000    running time 912 seconds

steps 14200    base_loss: 0.238604    reg_loss: 0.070498    l2_loss: 0.078850    loss: 0.387952
steps 14200    v_Prec: 0.598166  v_Recall: 0.828340  v_F1: 0.694683  v_AUC: 0.931112
steps 14200    running time 924 seconds

steps 14400    base_loss: 0.240144    reg_loss: 0.069409    l2_loss: 0.077883    loss: 0.387437
steps 14400    v_Prec: 0.595295  v_Recall: 0.831557  v_F1: 0.693866  v_AUC: 0.931254
steps 14400    running time 935 seconds

steps 14600    base_loss: 0.242219    reg_loss: 0.070144    l2_loss: 0.077876    loss: 0.390239
steps 14600    v_Prec: 0.585325  v_Recall: 0.844941  v_F1: 0.691571  v_AUC: 0.930933
steps 14600    running time 946 seconds

steps 14800    base_loss: 0.238910    reg_loss: 0.068557    l2_loss: 0.077817    loss: 0.385283
steps 14800    v_Prec: 0.588035  v_Recall: 0.844622  v_F1: 0.693351  v_AUC: 0.930947
steps 14800    running time 956 seconds

steps 15000    base_loss: 0.245409    reg_loss: 0.070496    l2_loss: 0.078490    loss: 0.394396
steps 15000    v_Prec: 0.590817  v_Recall: 0.837721  v_F1: 0.692932  v_AUC: 0.931019
steps 15000    running time 967 seconds

Early stop model F1: 0.695586
testing thre: 0.20771667
testing Prec: 0.521084047366901
testing Recall: 0.7853194236879906
testing F1: 0.6264793883940715
testing AUC: 0.8807440253078197
overall running time 976 seconds
(0.5620479129338377, 0.7373224416360761, 0.637863620673424, 0.8807440253078197, 0.2816975)
2019-02-17 01:47:40.656578: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 01:47:41.118603: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 01:47:41.119647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 01:47:41.119686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.470000 seconds
loading data in 110.550000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.3
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.503764    reg_loss: 0.217405    l2_loss: 0.881649    loss: 1.602819
steps 200    v_Prec: 0.158021  v_Recall: 0.999976  v_F1: 0.272914  v_AUC: 0.500450
steps 200    running time 127 seconds

steps 400    base_loss: 0.504840    reg_loss: 0.216917    l2_loss: 0.867710    loss: 1.589467
steps 400    v_Prec: 0.158024  v_Recall: 0.999951  v_F1: 0.272919  v_AUC: 0.501611
steps 400    running time 139 seconds

steps 600    base_loss: 0.491346    reg_loss: 0.214738    l2_loss: 0.841750    loss: 1.547834
steps 600    v_Prec: 0.158015  v_Recall: 1.000000  v_F1: 0.272906  v_AUC: 0.500468
steps 600    running time 151 seconds

steps 800    base_loss: 0.484380    reg_loss: 0.211185    l2_loss: 0.799343    loss: 1.494907
steps 800    v_Prec: 0.158017  v_Recall: 1.000000  v_F1: 0.272909  v_AUC: 0.499144
steps 800    running time 162 seconds

steps 1000    base_loss: 0.479943    reg_loss: 0.206585    l2_loss: 0.751347    loss: 1.437875
steps 1000    v_Prec: 0.158056  v_Recall: 0.999339  v_F1: 0.272943  v_AUC: 0.498248
steps 1000    running time 173 seconds

steps 1200    base_loss: 0.472007    reg_loss: 0.200681    l2_loss: 0.696237    loss: 1.368925
steps 1200    v_Prec: 0.159241  v_Recall: 0.970994  v_F1: 0.273610  v_AUC: 0.504684
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.457729    reg_loss: 0.192382    l2_loss: 0.642760    loss: 1.292871
steps 1400    v_Prec: 0.161973  v_Recall: 0.937703  v_F1: 0.276231  v_AUC: 0.521482
steps 1400    running time 196 seconds

steps 1600    base_loss: 0.443792    reg_loss: 0.183370    l2_loss: 0.591200    loss: 1.218362
steps 1600    v_Prec: 0.175010  v_Recall: 0.767973  v_F1: 0.285059  v_AUC: 0.566029
steps 1600    running time 208 seconds

steps 1800    base_loss: 0.438676    reg_loss: 0.176257    l2_loss: 0.541119    loss: 1.156052
steps 1800    v_Prec: 0.226027  v_Recall: 0.533180  v_F1: 0.317471  v_AUC: 0.631563
steps 1800    running time 220 seconds

steps 2000    base_loss: 0.419093    reg_loss: 0.168461    l2_loss: 0.499749    loss: 1.087303
steps 2000    v_Prec: 0.290002  v_Recall: 0.517196  v_F1: 0.371626  v_AUC: 0.690540
steps 2000    running time 231 seconds

steps 2200    base_loss: 0.409834    reg_loss: 0.163317    l2_loss: 0.459991    loss: 1.033142
steps 2200    v_Prec: 0.328224  v_Recall: 0.544587  v_F1: 0.409588  v_AUC: 0.724686
steps 2200    running time 243 seconds

steps 2400    base_loss: 0.398775    reg_loss: 0.159220    l2_loss: 0.425844    loss: 0.983839
steps 2400    v_Prec: 0.358059  v_Recall: 0.559836  v_F1: 0.436770  v_AUC: 0.744671
steps 2400    running time 254 seconds

steps 2600    base_loss: 0.391281    reg_loss: 0.154239    l2_loss: 0.396722    loss: 0.942242
steps 2600    v_Prec: 0.389722  v_Recall: 0.564708  v_F1: 0.461174  v_AUC: 0.761003
steps 2600    running time 265 seconds

steps 2800    base_loss: 0.383803    reg_loss: 0.149776    l2_loss: 0.370765    loss: 0.904345
steps 2800    v_Prec: 0.411923  v_Recall: 0.581157  v_F1: 0.482120  v_AUC: 0.774841
steps 2800    running time 277 seconds

steps 3000    base_loss: 0.372544    reg_loss: 0.145880    l2_loss: 0.347080    loss: 0.865504
steps 3000    v_Prec: 0.430444  v_Recall: 0.598194  v_F1: 0.500640  v_AUC: 0.787006
steps 3000    running time 288 seconds

steps 3200    base_loss: 0.360592    reg_loss: 0.138672    l2_loss: 0.327568    loss: 0.826832
steps 3200    v_Prec: 0.442115  v_Recall: 0.606124  v_F1: 0.511289  v_AUC: 0.797073
steps 3200    running time 300 seconds

steps 3400    base_loss: 0.352733    reg_loss: 0.131900    l2_loss: 0.309275    loss: 0.793908
steps 3400    v_Prec: 0.454001  v_Recall: 0.616552  v_F1: 0.522936  v_AUC: 0.808202
steps 3400    running time 311 seconds

steps 3600    base_loss: 0.344844    reg_loss: 0.126794    l2_loss: 0.293848    loss: 0.765485
steps 3600    v_Prec: 0.479413  v_Recall: 0.611926  v_F1: 0.537624  v_AUC: 0.818912
steps 3600    running time 323 seconds

steps 3800    base_loss: 0.341361    reg_loss: 0.121571    l2_loss: 0.277940    loss: 0.740872
steps 3800    v_Prec: 0.494412  v_Recall: 0.632414  v_F1: 0.554962  v_AUC: 0.832266
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.332985    reg_loss: 0.117326    l2_loss: 0.263396    loss: 0.713708
steps 4000    v_Prec: 0.517428  v_Recall: 0.635522  v_F1: 0.570427  v_AUC: 0.842910
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.321773    reg_loss: 0.113686    l2_loss: 0.251119    loss: 0.686578
steps 4200    v_Prec: 0.539414  v_Recall: 0.634666  v_F1: 0.583176  v_AUC: 0.849458
steps 4200    running time 357 seconds

steps 4400    base_loss: 0.316432    reg_loss: 0.110143    l2_loss: 0.239995    loss: 0.666570
steps 4400    v_Prec: 0.545673  v_Recall: 0.657137  v_F1: 0.596240  v_AUC: 0.859566
steps 4400    running time 368 seconds

steps 4600    base_loss: 0.314483    reg_loss: 0.108870    l2_loss: 0.230067    loss: 0.653419
steps 4600    v_Prec: 0.554286  v_Recall: 0.665067  v_F1: 0.604644  v_AUC: 0.867117
steps 4600    running time 380 seconds

steps 4800    base_loss: 0.309418    reg_loss: 0.107043    l2_loss: 0.221022    loss: 0.637484
steps 4800    v_Prec: 0.549415  v_Recall: 0.693731  v_F1: 0.613196  v_AUC: 0.873451
steps 4800    running time 392 seconds

steps 5000    base_loss: 0.301630    reg_loss: 0.104911    l2_loss: 0.211680    loss: 0.618221
steps 5000    v_Prec: 0.555786  v_Recall: 0.707341  v_F1: 0.622472  v_AUC: 0.880036
steps 5000    running time 403 seconds

steps 5200    base_loss: 0.297984    reg_loss: 0.102017    l2_loss: 0.203423    loss: 0.603425
steps 5200    v_Prec: 0.574069  v_Recall: 0.706411  v_F1: 0.633401  v_AUC: 0.886270
steps 5200    running time 414 seconds

steps 5400    base_loss: 0.281339    reg_loss: 0.097934    l2_loss: 0.196798    loss: 0.576071
steps 5400    v_Prec: 0.569941  v_Recall: 0.719286  v_F1: 0.635963  v_AUC: 0.888995
steps 5400    running time 426 seconds

steps 5600    base_loss: 0.289153    reg_loss: 0.099068    l2_loss: 0.188459    loss: 0.576680
steps 5600    v_Prec: 0.569555  v_Recall: 0.736519  v_F1: 0.642365  v_AUC: 0.892548
steps 5600    running time 437 seconds

steps 5800    base_loss: 0.277909    reg_loss: 0.096987    l2_loss: 0.181771    loss: 0.556667
steps 5800    v_Prec: 0.584256  v_Recall: 0.726899  v_F1: 0.647818  v_AUC: 0.896671
steps 5800    running time 449 seconds

steps 6000    base_loss: 0.276624    reg_loss: 0.095941    l2_loss: 0.176160    loss: 0.548725
steps 6000    v_Prec: 0.569742  v_Recall: 0.755881  v_F1: 0.649743  v_AUC: 0.898424
steps 6000    running time 461 seconds

steps 6200    base_loss: 0.278158    reg_loss: 0.094480    l2_loss: 0.168584    loss: 0.541222
steps 6200    v_Prec: 0.580346  v_Recall: 0.752405  v_F1: 0.655269  v_AUC: 0.903774
steps 6200    running time 472 seconds

steps 6400    base_loss: 0.274550    reg_loss: 0.093243    l2_loss: 0.163239    loss: 0.531032
steps 6400    v_Prec: 0.581112  v_Recall: 0.759430  v_F1: 0.658411  v_AUC: 0.905081
steps 6400    running time 484 seconds

steps 6600    base_loss: 0.270809    reg_loss: 0.091166    l2_loss: 0.156289    loss: 0.518264
steps 6600    v_Prec: 0.580738  v_Recall: 0.773725  v_F1: 0.663483  v_AUC: 0.908538
steps 6600    running time 495 seconds

steps 6800    base_loss: 0.266796    reg_loss: 0.089699    l2_loss: 0.151776    loss: 0.508272
steps 6800    v_Prec: 0.581288  v_Recall: 0.785671  v_F1: 0.668200  v_AUC: 0.910909
steps 6800    running time 507 seconds

steps 7000    base_loss: 0.263407    reg_loss: 0.088865    l2_loss: 0.146749    loss: 0.499021
steps 7000    v_Prec: 0.584956  v_Recall: 0.785401  v_F1: 0.670519  v_AUC: 0.913368
steps 7000    running time 518 seconds

steps 7200    base_loss: 0.269330    reg_loss: 0.088060    l2_loss: 0.142623    loss: 0.500013
steps 7200    v_Prec: 0.586381  v_Recall: 0.789612  v_F1: 0.672988  v_AUC: 0.914909
steps 7200    running time 530 seconds

steps 7400    base_loss: 0.254455    reg_loss: 0.086220    l2_loss: 0.136651    loss: 0.477326
steps 7400    v_Prec: 0.590288  v_Recall: 0.792965  v_F1: 0.676778  v_AUC: 0.916971
steps 7400    running time 541 seconds

steps 7600    base_loss: 0.255924    reg_loss: 0.084890    l2_loss: 0.131808    loss: 0.472622
steps 7600    v_Prec: 0.589848  v_Recall: 0.801239  v_F1: 0.679481  v_AUC: 0.917906
steps 7600    running time 553 seconds

steps 7800    base_loss: 0.256452    reg_loss: 0.086213    l2_loss: 0.127894    loss: 0.470558
steps 7800    v_Prec: 0.592885  v_Recall: 0.803246  v_F1: 0.682217  v_AUC: 0.919424
steps 7800    running time 564 seconds

steps 8000    base_loss: 0.262026    reg_loss: 0.085783    l2_loss: 0.124399    loss: 0.472208
steps 8000    v_Prec: 0.591881  v_Recall: 0.809390  v_F1: 0.683754  v_AUC: 0.920598
steps 8000    running time 576 seconds

steps 8200    base_loss: 0.258365    reg_loss: 0.085129    l2_loss: 0.120993    loss: 0.464486
steps 8200    v_Prec: 0.592150  v_Recall: 0.812107  v_F1: 0.684902  v_AUC: 0.921651
steps 8200    running time 587 seconds

steps 8400    base_loss: 0.251979    reg_loss: 0.081091    l2_loss: 0.115964    loss: 0.449033
steps 8400    v_Prec: 0.588792  v_Recall: 0.817100  v_F1: 0.684409  v_AUC: 0.922431
steps 8400    running time 599 seconds

steps 8600    base_loss: 0.252762    reg_loss: 0.082444    l2_loss: 0.112388    loss: 0.447594
steps 8600    v_Prec: 0.586460  v_Recall: 0.828434  v_F1: 0.686756  v_AUC: 0.924077
steps 8600    running time 610 seconds

steps 8800    base_loss: 0.251594    reg_loss: 0.081313    l2_loss: 0.108886    loss: 0.441793
steps 8800    v_Prec: 0.585114  v_Recall: 0.833966  v_F1: 0.687720  v_AUC: 0.924777
steps 8800    running time 621 seconds

steps 9000    base_loss: 0.249652    reg_loss: 0.081979    l2_loss: 0.105262    loss: 0.436892
steps 9000    v_Prec: 0.595864  v_Recall: 0.819548  v_F1: 0.690031  v_AUC: 0.925741
steps 9000    running time 633 seconds

steps 9200    base_loss: 0.252034    reg_loss: 0.081206    l2_loss: 0.102905    loss: 0.436145
steps 9200    v_Prec: 0.584469  v_Recall: 0.840844  v_F1: 0.689599  v_AUC: 0.925824
steps 9200    running time 644 seconds

steps 9400    base_loss: 0.244633    reg_loss: 0.079770    l2_loss: 0.100045    loss: 0.424448
steps 9400    v_Prec: 0.592618  v_Recall: 0.830881  v_F1: 0.691810  v_AUC: 0.926647
steps 9400    running time 655 seconds

steps 9600    base_loss: 0.249701    reg_loss: 0.080061    l2_loss: 0.096878    loss: 0.426640
steps 9600    v_Prec: 0.584254  v_Recall: 0.846841  v_F1: 0.691457  v_AUC: 0.927181
steps 9600    running time 666 seconds

steps 9800    base_loss: 0.247412    reg_loss: 0.079324    l2_loss: 0.094255    loss: 0.420991
steps 9800    v_Prec: 0.592792  v_Recall: 0.833476  v_F1: 0.692827  v_AUC: 0.927677
steps 9800    running time 677 seconds

steps 10000    base_loss: 0.241919    reg_loss: 0.079300    l2_loss: 0.092737    loss: 0.413956
steps 10000    v_Prec: 0.588586  v_Recall: 0.838396  v_F1: 0.691625  v_AUC: 0.927164
steps 10000    running time 689 seconds

steps 10200    base_loss: 0.246712    reg_loss: 0.078251    l2_loss: 0.089821    loss: 0.414784
steps 10200    v_Prec: 0.585802  v_Recall: 0.844712  v_F1: 0.691827  v_AUC: 0.928159
steps 10200    running time 700 seconds

steps 10400    base_loss: 0.240604    reg_loss: 0.076676    l2_loss: 0.087681    loss: 0.404961
steps 10400    v_Prec: 0.593100  v_Recall: 0.834431  v_F1: 0.693366  v_AUC: 0.928378
steps 10400    running time 711 seconds

steps 10600    base_loss: 0.243289    reg_loss: 0.077500    l2_loss: 0.085096    loss: 0.405886
steps 10600    v_Prec: 0.588579  v_Recall: 0.845446  v_F1: 0.694007  v_AUC: 0.928529
steps 10600    running time 722 seconds

steps 10800    base_loss: 0.247323    reg_loss: 0.077206    l2_loss: 0.084117    loss: 0.408647
steps 10800    v_Prec: 0.590209  v_Recall: 0.840477  v_F1: 0.693453  v_AUC: 0.928664
steps 10800    running time 733 seconds

steps 11000    base_loss: 0.245152    reg_loss: 0.077445    l2_loss: 0.082174    loss: 0.404772
steps 11000    v_Prec: 0.594252  v_Recall: 0.834627  v_F1: 0.694221  v_AUC: 0.928896
steps 11000    running time 744 seconds

steps 11200    base_loss: 0.241107    reg_loss: 0.075909    l2_loss: 0.079438    loss: 0.396454
steps 11200    v_Prec: 0.587467  v_Recall: 0.847673  v_F1: 0.693981  v_AUC: 0.929541
steps 11200    running time 756 seconds

steps 11400    base_loss: 0.238447    reg_loss: 0.076684    l2_loss: 0.078425    loss: 0.393556
steps 11400    v_Prec: 0.585072  v_Recall: 0.846523  v_F1: 0.691923  v_AUC: 0.928778
steps 11400    running time 767 seconds

steps 11600    base_loss: 0.240080    reg_loss: 0.075167    l2_loss: 0.076900    loss: 0.392148
steps 11600    v_Prec: 0.589559  v_Recall: 0.846131  v_F1: 0.694919  v_AUC: 0.929563
steps 11600    running time 778 seconds

steps 11800    base_loss: 0.247745    reg_loss: 0.076283    l2_loss: 0.076180    loss: 0.400209
steps 11800    v_Prec: 0.592377  v_Recall: 0.840795  v_F1: 0.695057  v_AUC: 0.929652
steps 11800    running time 790 seconds

steps 12000    base_loss: 0.244084    reg_loss: 0.075759    l2_loss: 0.075026    loss: 0.394869
steps 12000    v_Prec: 0.592240  v_Recall: 0.833917  v_F1: 0.692601  v_AUC: 0.929575
steps 12000    running time 802 seconds

steps 12200    base_loss: 0.243177    reg_loss: 0.073680    l2_loss: 0.074075    loss: 0.390932
steps 12200    v_Prec: 0.588250  v_Recall: 0.846572  v_F1: 0.694157  v_AUC: 0.929071
steps 12200    running time 813 seconds

steps 12400    base_loss: 0.244398    reg_loss: 0.074216    l2_loss: 0.072340    loss: 0.390954
steps 12400    v_Prec: 0.590972  v_Recall: 0.841187  v_F1: 0.694221  v_AUC: 0.929731
steps 12400    running time 824 seconds

steps 12600    base_loss: 0.244880    reg_loss: 0.074604    l2_loss: 0.071484    loss: 0.390968
steps 12600    v_Prec: 0.585278  v_Recall: 0.853426  v_F1: 0.694363  v_AUC: 0.929716
steps 12600    running time 834 seconds

steps 12800    base_loss: 0.241061    reg_loss: 0.074311    l2_loss: 0.071212    loss: 0.386584
steps 12800    v_Prec: 0.592716  v_Recall: 0.841407  v_F1: 0.695499  v_AUC: 0.929954
steps 12800    running time 846 seconds

steps 13000    base_loss: 0.243695    reg_loss: 0.074541    l2_loss: 0.070675    loss: 0.388911
steps 13000    v_Prec: 0.580633  v_Recall: 0.863780  v_F1: 0.694454  v_AUC: 0.929540
steps 13000    running time 857 seconds

steps 13200    base_loss: 0.243087    reg_loss: 0.073842    l2_loss: 0.068577    loss: 0.385506
steps 13200    v_Prec: 0.591176  v_Recall: 0.844907  v_F1: 0.695627  v_AUC: 0.930128
steps 13200    running time 868 seconds

steps 13400    base_loss: 0.244324    reg_loss: 0.073435    l2_loss: 0.067300    loss: 0.385060
steps 13400    v_Prec: 0.592098  v_Recall: 0.844124  v_F1: 0.695999  v_AUC: 0.929944
steps 13400    running time 880 seconds

steps 13600    base_loss: 0.236625    reg_loss: 0.070960    l2_loss: 0.066223    loss: 0.373808
steps 13600    v_Prec: 0.590368  v_Recall: 0.850978  v_F1: 0.697112  v_AUC: 0.930190
steps 13600    running time 891 seconds

steps 13800    base_loss: 0.245840    reg_loss: 0.074167    l2_loss: 0.066177    loss: 0.386185
steps 13800    v_Prec: 0.596155  v_Recall: 0.838641  v_F1: 0.696907  v_AUC: 0.929947
steps 13800    running time 902 seconds

steps 14000    base_loss: 0.235308    reg_loss: 0.072101    l2_loss: 0.066418    loss: 0.373826
steps 14000    v_Prec: 0.592389  v_Recall: 0.845960  v_F1: 0.696823  v_AUC: 0.930349
steps 14000    running time 913 seconds

steps 14200    base_loss: 0.242192    reg_loss: 0.073522    l2_loss: 0.066260    loss: 0.381975
steps 14200    v_Prec: 0.590262  v_Recall: 0.856706  v_F1: 0.698953  v_AUC: 0.930439
steps 14200    running time 924 seconds

steps 14400    base_loss: 0.241188    reg_loss: 0.072109    l2_loss: 0.065526    loss: 0.378823
steps 14400    v_Prec: 0.594213  v_Recall: 0.842949  v_F1: 0.697056  v_AUC: 0.929768
steps 14400    running time 936 seconds

steps 14600    base_loss: 0.242887    reg_loss: 0.072540    l2_loss: 0.064685    loss: 0.380112
steps 14600    v_Prec: 0.590267  v_Recall: 0.849387  v_F1: 0.696507  v_AUC: 0.929807
steps 14600    running time 947 seconds

steps 14800    base_loss: 0.247998    reg_loss: 0.072469    l2_loss: 0.064807    loss: 0.385274
steps 14800    v_Prec: 0.595480  v_Recall: 0.835214  v_F1: 0.695261  v_AUC: 0.930317
steps 14800    running time 957 seconds

steps 15000    base_loss: 0.236846    reg_loss: 0.071483    l2_loss: 0.064274    loss: 0.372603
steps 15000    v_Prec: 0.591619  v_Recall: 0.840501  v_F1: 0.694434  v_AUC: 0.929449
steps 15000    running time 968 seconds

steps 15200    base_loss: 0.243255    reg_loss: 0.072847    l2_loss: 0.064147    loss: 0.380249
steps 15200    v_Prec: 0.589536  v_Recall: 0.848408  v_F1: 0.695670  v_AUC: 0.929286
steps 15200    running time 979 seconds

steps 15400    base_loss: 0.242614    reg_loss: 0.071695    l2_loss: 0.063646    loss: 0.377955
steps 15400    v_Prec: 0.586091  v_Recall: 0.851957  v_F1: 0.694447  v_AUC: 0.929689
steps 15400    running time 990 seconds

steps 15600    base_loss: 0.239774    reg_loss: 0.072967    l2_loss: 0.063467    loss: 0.376207
steps 15600    v_Prec: 0.587566  v_Recall: 0.846449  v_F1: 0.693639  v_AUC: 0.928829
steps 15600    running time 1001 seconds

steps 15800    base_loss: 0.243669    reg_loss: 0.072439    l2_loss: 0.063991    loss: 0.380099
steps 15800    v_Prec: 0.585660  v_Recall: 0.852349  v_F1: 0.694275  v_AUC: 0.929657
steps 15800    running time 1012 seconds

steps 16000    base_loss: 0.247366    reg_loss: 0.074119    l2_loss: 0.064368    loss: 0.385854
steps 16000    v_Prec: 0.590228  v_Recall: 0.851051  v_F1: 0.697040  v_AUC: 0.930226
steps 16000    running time 1023 seconds

steps 16200    base_loss: 0.243372    reg_loss: 0.072502    l2_loss: 0.064826    loss: 0.380700
steps 16200    v_Prec: 0.591227  v_Recall: 0.849509  v_F1: 0.697217  v_AUC: 0.929608
steps 16200    running time 1034 seconds

Early stop model F1: 0.698953
testing thre: 0.21080309
testing Prec: 0.5421743899908091
testing Recall: 0.7959983169135677
testing F1: 0.6450137559667976
testing AUC: 0.8921123297387263
overall running time 1042 seconds
(0.566108368025301, 0.7635698843603546, 0.6501772896307187, 0.8921123297387263, 0.2714264)
2019-02-17 01:59:38.593940: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 01:59:38.888575: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 01:59:38.890300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 01:59:38.890343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.300000 seconds
loading data in 110.350000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.865193    reg_loss: 0.215710    l2_loss: 0.883215    loss: 1.964118
steps 200    v_Prec: 0.156148  v_Recall: 0.999653  v_F1: 0.270105  v_AUC: 0.505111
steps 200    running time 127 seconds

steps 400    base_loss: 0.798821    reg_loss: 0.215529    l2_loss: 0.872557    loss: 1.886907
steps 400    v_Prec: 0.156160  v_Recall: 0.999653  v_F1: 0.270122  v_AUC: 0.520446
steps 400    running time 139 seconds

steps 600    base_loss: 0.704379    reg_loss: 0.215879    l2_loss: 0.846958    loss: 1.767216
steps 600    v_Prec: 0.166951  v_Recall: 0.761150  v_F1: 0.273838  v_AUC: 0.548443
steps 600    running time 150 seconds

steps 800    base_loss: 0.618399    reg_loss: 0.215476    l2_loss: 0.810901    loss: 1.644776
steps 800    v_Prec: 0.187545  v_Recall: 0.646209  v_F1: 0.290718  v_AUC: 0.589603
steps 800    running time 162 seconds

steps 1000    base_loss: 0.545908    reg_loss: 0.213747    l2_loss: 0.770242    loss: 1.529896
steps 1000    v_Prec: 0.227552  v_Recall: 0.543707  v_F1: 0.320830  v_AUC: 0.634560
steps 1000    running time 173 seconds

steps 1200    base_loss: 0.492856    reg_loss: 0.210037    l2_loss: 0.718855    loss: 1.421748
steps 1200    v_Prec: 0.277314  v_Recall: 0.499281  v_F1: 0.356576  v_AUC: 0.673480
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.478023    reg_loss: 0.204491    l2_loss: 0.662809    loss: 1.345323
steps 1400    v_Prec: 0.318033  v_Recall: 0.496135  v_F1: 0.387604  v_AUC: 0.699929
steps 1400    running time 196 seconds

steps 1600    base_loss: 0.456916    reg_loss: 0.194830    l2_loss: 0.608254    loss: 1.260000
steps 1600    v_Prec: 0.348169  v_Recall: 0.519252  v_F1: 0.416839  v_AUC: 0.722522
steps 1600    running time 208 seconds

steps 1800    base_loss: 0.438763    reg_loss: 0.185311    l2_loss: 0.559427    loss: 1.183501
steps 1800    v_Prec: 0.375409  v_Recall: 0.556938  v_F1: 0.448502  v_AUC: 0.744782
steps 1800    running time 219 seconds

steps 2000    base_loss: 0.406056    reg_loss: 0.174269    l2_loss: 0.513650    loss: 1.093976
steps 2000    v_Prec: 0.418088  v_Recall: 0.553345  v_F1: 0.476300  v_AUC: 0.765483
steps 2000    running time 231 seconds

steps 2200    base_loss: 0.385473    reg_loss: 0.163683    l2_loss: 0.470282    loss: 1.019437
steps 2200    v_Prec: 0.436740  v_Recall: 0.566031  v_F1: 0.493050  v_AUC: 0.780103
steps 2200    running time 242 seconds

steps 2400    base_loss: 0.377315    reg_loss: 0.152967    l2_loss: 0.433497    loss: 0.963779
steps 2400    v_Prec: 0.445157  v_Recall: 0.586843  v_F1: 0.506274  v_AUC: 0.794585
steps 2400    running time 254 seconds

steps 2600    base_loss: 0.362958    reg_loss: 0.143083    l2_loss: 0.400960    loss: 0.907001
steps 2600    v_Prec: 0.451423  v_Recall: 0.605674  v_F1: 0.517294  v_AUC: 0.806441
steps 2600    running time 265 seconds

steps 2800    base_loss: 0.356191    reg_loss: 0.134286    l2_loss: 0.373544    loss: 0.864021
steps 2800    v_Prec: 0.459664  v_Recall: 0.625421  v_F1: 0.529882  v_AUC: 0.820257
steps 2800    running time 277 seconds

steps 3000    base_loss: 0.346956    reg_loss: 0.128251    l2_loss: 0.346652    loss: 0.821859
steps 3000    v_Prec: 0.475619  v_Recall: 0.643806  v_F1: 0.547078  v_AUC: 0.833006
steps 3000    running time 288 seconds

steps 3200    base_loss: 0.342029    reg_loss: 0.124000    l2_loss: 0.323780    loss: 0.789808
steps 3200    v_Prec: 0.496743  v_Recall: 0.657532  v_F1: 0.565939  v_AUC: 0.846757
steps 3200    running time 299 seconds

steps 3400    base_loss: 0.329596    reg_loss: 0.119612    l2_loss: 0.305392    loss: 0.754600
steps 3400    v_Prec: 0.523852  v_Recall: 0.661174  v_F1: 0.584556  v_AUC: 0.858940
steps 3400    running time 311 seconds

steps 3600    base_loss: 0.325122    reg_loss: 0.117411    l2_loss: 0.285906    loss: 0.728438
steps 3600    v_Prec: 0.537673  v_Recall: 0.678246  v_F1: 0.599833  v_AUC: 0.869091
steps 3600    running time 322 seconds

steps 3800    base_loss: 0.307560    reg_loss: 0.112376    l2_loss: 0.270277    loss: 0.690213
steps 3800    v_Prec: 0.546053  v_Recall: 0.701412  v_F1: 0.614058  v_AUC: 0.876938
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.304276    reg_loss: 0.110996    l2_loss: 0.255780    loss: 0.671052
steps 4000    v_Prec: 0.557389  v_Recall: 0.709068  v_F1: 0.624145  v_AUC: 0.884350
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.295784    reg_loss: 0.107347    l2_loss: 0.241088    loss: 0.644219
steps 4200    v_Prec: 0.557981  v_Recall: 0.737983  v_F1: 0.635481  v_AUC: 0.891462
steps 4200    running time 357 seconds

steps 4400    base_loss: 0.290291    reg_loss: 0.106123    l2_loss: 0.231202    loss: 0.627617
steps 4400    v_Prec: 0.571802  v_Recall: 0.731442  v_F1: 0.641845  v_AUC: 0.896735
steps 4400    running time 368 seconds

steps 4600    base_loss: 0.285686    reg_loss: 0.104486    l2_loss: 0.220231    loss: 0.610402
steps 4600    v_Prec: 0.573686  v_Recall: 0.746531  v_F1: 0.648794  v_AUC: 0.901009
steps 4600    running time 380 seconds

steps 4800    base_loss: 0.279114    reg_loss: 0.101971    l2_loss: 0.209159    loss: 0.590244
steps 4800    v_Prec: 0.568061  v_Recall: 0.768459  v_F1: 0.653236  v_AUC: 0.903344
steps 4800    running time 391 seconds

steps 5000    base_loss: 0.274645    reg_loss: 0.099783    l2_loss: 0.201447    loss: 0.575875
steps 5000    v_Prec: 0.580268  v_Recall: 0.758201  v_F1: 0.657407  v_AUC: 0.906599
steps 5000    running time 403 seconds

steps 5200    base_loss: 0.272032    reg_loss: 0.098503    l2_loss: 0.192794    loss: 0.563329
steps 5200    v_Prec: 0.581177  v_Recall: 0.765610  v_F1: 0.660765  v_AUC: 0.909000
steps 5200    running time 414 seconds

steps 5400    base_loss: 0.270536    reg_loss: 0.096829    l2_loss: 0.183171    loss: 0.550537
steps 5400    v_Prec: 0.578175  v_Recall: 0.780823  v_F1: 0.664390  v_AUC: 0.911791
steps 5400    running time 425 seconds

steps 5600    base_loss: 0.266867    reg_loss: 0.095203    l2_loss: 0.176506    loss: 0.538575
steps 5600    v_Prec: 0.578178  v_Recall: 0.787760  v_F1: 0.666890  v_AUC: 0.914432
steps 5600    running time 437 seconds

steps 5800    base_loss: 0.271194    reg_loss: 0.094760    l2_loss: 0.171522    loss: 0.537477
steps 5800    v_Prec: 0.576151  v_Recall: 0.795862  v_F1: 0.668415  v_AUC: 0.916864
steps 5800    running time 449 seconds

steps 6000    base_loss: 0.262552    reg_loss: 0.092740    l2_loss: 0.163435    loss: 0.518728
steps 6000    v_Prec: 0.576730  v_Recall: 0.801734  v_F1: 0.670868  v_AUC: 0.918084
steps 6000    running time 460 seconds

steps 6200    base_loss: 0.262626    reg_loss: 0.091882    l2_loss: 0.157278    loss: 0.511785
steps 6200    v_Prec: 0.583750  v_Recall: 0.798389  v_F1: 0.674404  v_AUC: 0.920018
steps 6200    running time 472 seconds

steps 6400    base_loss: 0.263633    reg_loss: 0.092028    l2_loss: 0.151474    loss: 0.507135
steps 6400    v_Prec: 0.578476  v_Recall: 0.810654  v_F1: 0.675162  v_AUC: 0.920990
steps 6400    running time 484 seconds

steps 6600    base_loss: 0.257992    reg_loss: 0.090351    l2_loss: 0.145280    loss: 0.493623
steps 6600    v_Prec: 0.578842  v_Recall: 0.813404  v_F1: 0.676364  v_AUC: 0.921777
steps 6600    running time 495 seconds

steps 6800    base_loss: 0.253475    reg_loss: 0.088639    l2_loss: 0.140510    loss: 0.482624
steps 6800    v_Prec: 0.582161  v_Recall: 0.811348  v_F1: 0.677908  v_AUC: 0.922653
steps 6800    running time 506 seconds

steps 7000    base_loss: 0.247630    reg_loss: 0.085747    l2_loss: 0.134686    loss: 0.468063
steps 7000    v_Prec: 0.582514  v_Recall: 0.815981  v_F1: 0.679760  v_AUC: 0.923700
steps 7000    running time 518 seconds

steps 7200    base_loss: 0.259536    reg_loss: 0.087511    l2_loss: 0.130713    loss: 0.477759
steps 7200    v_Prec: 0.583807  v_Recall: 0.821135  v_F1: 0.682426  v_AUC: 0.924177
steps 7200    running time 530 seconds

steps 7400    base_loss: 0.249051    reg_loss: 0.085417    l2_loss: 0.126459    loss: 0.460928
steps 7400    v_Prec: 0.582325  v_Recall: 0.821878  v_F1: 0.681668  v_AUC: 0.924971
steps 7400    running time 541 seconds

steps 7600    base_loss: 0.253600    reg_loss: 0.084589    l2_loss: 0.122322    loss: 0.460511
steps 7600    v_Prec: 0.576154  v_Recall: 0.836323  v_F1: 0.682278  v_AUC: 0.925922
steps 7600    running time 552 seconds

steps 7800    base_loss: 0.249978    reg_loss: 0.082813    l2_loss: 0.117418    loss: 0.450209
steps 7800    v_Prec: 0.585807  v_Recall: 0.818112  v_F1: 0.682740  v_AUC: 0.925710
steps 7800    running time 563 seconds

steps 8000    base_loss: 0.247726    reg_loss: 0.084157    l2_loss: 0.114805    loss: 0.446687
steps 8000    v_Prec: 0.588362  v_Recall: 0.820441  v_F1: 0.685286  v_AUC: 0.926266
steps 8000    running time 574 seconds

steps 8200    base_loss: 0.251352    reg_loss: 0.082659    l2_loss: 0.111542    loss: 0.445552
steps 8200    v_Prec: 0.583536  v_Recall: 0.826189  v_F1: 0.683979  v_AUC: 0.926647
steps 8200    running time 586 seconds

steps 8400    base_loss: 0.242315    reg_loss: 0.081107    l2_loss: 0.108059    loss: 0.431481
steps 8400    v_Prec: 0.580975  v_Recall: 0.834093  v_F1: 0.684896  v_AUC: 0.927180
steps 8400    running time 597 seconds

steps 8600    base_loss: 0.245711    reg_loss: 0.081290    l2_loss: 0.104575    loss: 0.431576
steps 8600    v_Prec: 0.584154  v_Recall: 0.829931  v_F1: 0.685684  v_AUC: 0.927089
steps 8600    running time 608 seconds

steps 8800    base_loss: 0.250477    reg_loss: 0.082500    l2_loss: 0.102677    loss: 0.435654
steps 8800    v_Prec: 0.589586  v_Recall: 0.824777  v_F1: 0.687627  v_AUC: 0.928088
steps 8800    running time 619 seconds

steps 9000    base_loss: 0.247997    reg_loss: 0.079153    l2_loss: 0.098486    loss: 0.425636
steps 9000    v_Prec: 0.588154  v_Recall: 0.828370  v_F1: 0.687894  v_AUC: 0.928595
steps 9000    running time 631 seconds

steps 9200    base_loss: 0.244476    reg_loss: 0.078544    l2_loss: 0.095580    loss: 0.418599
steps 9200    v_Prec: 0.587011  v_Recall: 0.833771  v_F1: 0.688963  v_AUC: 0.928287
steps 9200    running time 642 seconds

steps 9400    base_loss: 0.251117    reg_loss: 0.080191    l2_loss: 0.093527    loss: 0.424834
steps 9400    v_Prec: 0.584555  v_Recall: 0.839073  v_F1: 0.689062  v_AUC: 0.929462
steps 9400    running time 654 seconds

steps 9600    base_loss: 0.243946    reg_loss: 0.079541    l2_loss: 0.092424    loss: 0.415910
steps 9600    v_Prec: 0.578369  v_Recall: 0.852205  v_F1: 0.689078  v_AUC: 0.929170
steps 9600    running time 666 seconds

steps 9800    base_loss: 0.244998    reg_loss: 0.076889    l2_loss: 0.090594    loss: 0.412481
steps 9800    v_Prec: 0.578748  v_Recall: 0.849926  v_F1: 0.688601  v_AUC: 0.929190
steps 9800    running time 677 seconds

steps 10000    base_loss: 0.248583    reg_loss: 0.079449    l2_loss: 0.087807    loss: 0.415839
steps 10000    v_Prec: 0.580883  v_Recall: 0.848340  v_F1: 0.689586  v_AUC: 0.929275
steps 10000    running time 688 seconds

steps 10200    base_loss: 0.244007    reg_loss: 0.077849    l2_loss: 0.086898    loss: 0.408753
steps 10200    v_Prec: 0.592794  v_Recall: 0.827973  v_F1: 0.690919  v_AUC: 0.929060
steps 10200    running time 699 seconds

steps 10400    base_loss: 0.247009    reg_loss: 0.077355    l2_loss: 0.084418    loss: 0.408782
steps 10400    v_Prec: 0.587321  v_Recall: 0.838082  v_F1: 0.690644  v_AUC: 0.930284
steps 10400    running time 711 seconds

steps 10600    base_loss: 0.242174    reg_loss: 0.076445    l2_loss: 0.083005    loss: 0.401624
steps 10600    v_Prec: 0.585883  v_Recall: 0.837265  v_F1: 0.689372  v_AUC: 0.929220
steps 10600    running time 722 seconds

steps 10800    base_loss: 0.250161    reg_loss: 0.077604    l2_loss: 0.081864    loss: 0.409629
steps 10800    v_Prec: 0.588500  v_Recall: 0.834267  v_F1: 0.690156  v_AUC: 0.929451
steps 10800    running time 733 seconds

steps 11000    base_loss: 0.242549    reg_loss: 0.075950    l2_loss: 0.079764    loss: 0.398263
steps 11000    v_Prec: 0.588248  v_Recall: 0.839098  v_F1: 0.691630  v_AUC: 0.929833
steps 11000    running time 744 seconds

steps 11200    base_loss: 0.240519    reg_loss: 0.074476    l2_loss: 0.078889    loss: 0.393883
steps 11200    v_Prec: 0.584855  v_Recall: 0.843707  v_F1: 0.690829  v_AUC: 0.929472
steps 11200    running time 755 seconds

steps 11400    base_loss: 0.249917    reg_loss: 0.075728    l2_loss: 0.077525    loss: 0.403170
steps 11400    v_Prec: 0.587327  v_Recall: 0.841204  v_F1: 0.691706  v_AUC: 0.929956
steps 11400    running time 766 seconds

steps 11600    base_loss: 0.246147    reg_loss: 0.075649    l2_loss: 0.076762    loss: 0.398558
steps 11600    v_Prec: 0.586216  v_Recall: 0.845119  v_F1: 0.692252  v_AUC: 0.930208
steps 11600    running time 778 seconds

steps 11800    base_loss: 0.240489    reg_loss: 0.074683    l2_loss: 0.075619    loss: 0.390791
steps 11800    v_Prec: 0.585669  v_Recall: 0.840833  v_F1: 0.690430  v_AUC: 0.928873
steps 11800    running time 789 seconds

steps 12000    base_loss: 0.246596    reg_loss: 0.075786    l2_loss: 0.074552    loss: 0.396934
steps 12000    v_Prec: 0.583093  v_Recall: 0.845961  v_F1: 0.690350  v_AUC: 0.929519
steps 12000    running time 800 seconds

steps 12200    base_loss: 0.243038    reg_loss: 0.074581    l2_loss: 0.073028    loss: 0.390647
steps 12200    v_Prec: 0.585310  v_Recall: 0.843855  v_F1: 0.691196  v_AUC: 0.929164
steps 12200    running time 811 seconds

steps 12400    base_loss: 0.245222    reg_loss: 0.074042    l2_loss: 0.072297    loss: 0.391561
steps 12400    v_Prec: 0.590212  v_Recall: 0.832805  v_F1: 0.690830  v_AUC: 0.929357
steps 12400    running time 822 seconds

steps 12600    base_loss: 0.246256    reg_loss: 0.074756    l2_loss: 0.072836    loss: 0.393848
steps 12600    v_Prec: 0.580137  v_Recall: 0.854336  v_F1: 0.691030  v_AUC: 0.929312
steps 12600    running time 833 seconds

steps 12800    base_loss: 0.243897    reg_loss: 0.073755    l2_loss: 0.070771    loss: 0.388423
steps 12800    v_Prec: 0.576380  v_Recall: 0.856987  v_F1: 0.689217  v_AUC: 0.929531
steps 12800    running time 844 seconds

steps 13000    base_loss: 0.245793    reg_loss: 0.075004    l2_loss: 0.070380    loss: 0.391177
steps 13000    v_Prec: 0.581924  v_Recall: 0.849182  v_F1: 0.690598  v_AUC: 0.928660
steps 13000    running time 855 seconds

steps 13200    base_loss: 0.240612    reg_loss: 0.074203    l2_loss: 0.068738    loss: 0.383553
steps 13200    v_Prec: 0.584412  v_Recall: 0.846036  v_F1: 0.691299  v_AUC: 0.928860
steps 13200    running time 866 seconds

steps 13400    base_loss: 0.243771    reg_loss: 0.074556    l2_loss: 0.069657    loss: 0.387984
steps 13400    v_Prec: 0.590304  v_Recall: 0.840510  v_F1: 0.693530  v_AUC: 0.929172
steps 13400    running time 877 seconds

steps 13600    base_loss: 0.245638    reg_loss: 0.075408    l2_loss: 0.070589    loss: 0.391635
steps 13600    v_Prec: 0.585183  v_Recall: 0.845441  v_F1: 0.691639  v_AUC: 0.928683
steps 13600    running time 889 seconds

steps 13800    base_loss: 0.241772    reg_loss: 0.073821    l2_loss: 0.067631    loss: 0.383224
steps 13800    v_Prec: 0.592087  v_Recall: 0.833176  v_F1: 0.692241  v_AUC: 0.929057
steps 13800    running time 900 seconds

steps 14000    base_loss: 0.244659    reg_loss: 0.073620    l2_loss: 0.067701    loss: 0.385979
steps 14000    v_Prec: 0.594135  v_Recall: 0.826784  v_F1: 0.691414  v_AUC: 0.928599
steps 14000    running time 911 seconds

steps 14200    base_loss: 0.241878    reg_loss: 0.073841    l2_loss: 0.068728    loss: 0.384447
steps 14200    v_Prec: 0.584449  v_Recall: 0.842369  v_F1: 0.690098  v_AUC: 0.928258
steps 14200    running time 921 seconds

steps 14400    base_loss: 0.243130    reg_loss: 0.073524    l2_loss: 0.068004    loss: 0.384657
steps 14400    v_Prec: 0.583274  v_Recall: 0.851586  v_F1: 0.692343  v_AUC: 0.928382
steps 14400    running time 932 seconds

steps 14600    base_loss: 0.239439    reg_loss: 0.072986    l2_loss: 0.066066    loss: 0.378491
steps 14600    v_Prec: 0.584729  v_Recall: 0.844945  v_F1: 0.691156  v_AUC: 0.928120
steps 14600    running time 943 seconds

steps 14800    base_loss: 0.246393    reg_loss: 0.073977    l2_loss: 0.066921    loss: 0.387291
steps 14800    v_Prec: 0.587489  v_Recall: 0.840709  v_F1: 0.691651  v_AUC: 0.929055
steps 14800    running time 954 seconds

steps 15000    base_loss: 0.236062    reg_loss: 0.072724    l2_loss: 0.066229    loss: 0.375015
steps 15000    v_Prec: 0.587367  v_Recall: 0.844623  v_F1: 0.692887  v_AUC: 0.928817
steps 15000    running time 965 seconds

steps 15200    base_loss: 0.234824    reg_loss: 0.071521    l2_loss: 0.067309    loss: 0.373654
steps 15200    v_Prec: 0.586505  v_Recall: 0.837587  v_F1: 0.689912  v_AUC: 0.927778
steps 15200    running time 976 seconds

steps 15400    base_loss: 0.241746    reg_loss: 0.073057    l2_loss: 0.068089    loss: 0.382893
steps 15400    v_Prec: 0.584921  v_Recall: 0.845367  v_F1: 0.691431  v_AUC: 0.928256
steps 15400    running time 987 seconds

Early stop model F1: 0.693530
testing thre: 0.22972634
testing Prec: 0.5385818664237768
testing Recall: 0.7893094992817864
testing F1: 0.6402749415925661
testing AUC: 0.8915691781071285
overall running time 996 seconds
(0.557997974521614, 0.7594637338401938, 0.6433268193159053, 0.8915691781071285, 0.2781407)
2019-02-17 02:11:09.034389: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 02:11:09.315771: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 02:11:09.317145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 02:11:09.317182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.960000 seconds
loading data in 111.290000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.5
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.590209    reg_loss: 0.217412    l2_loss: 0.885764    loss: 1.693385
steps 200    v_Prec: 0.158123  v_Recall: 0.965068  v_F1: 0.271725  v_AUC: 0.526760
steps 200    running time 128 seconds

steps 400    base_loss: 0.558052    reg_loss: 0.216766    l2_loss: 0.873281    loss: 1.648099
steps 400    v_Prec: 0.161397  v_Recall: 0.894168  v_F1: 0.273438  v_AUC: 0.539728
steps 400    running time 140 seconds

steps 600    base_loss: 0.541745    reg_loss: 0.216654    l2_loss: 0.848612    loss: 1.607012
steps 600    v_Prec: 0.170034  v_Recall: 0.761175  v_F1: 0.277973  v_AUC: 0.557709
steps 600    running time 152 seconds

steps 800    base_loss: 0.538477    reg_loss: 0.215186    l2_loss: 0.817630    loss: 1.571293
steps 800    v_Prec: 0.176666  v_Recall: 0.742476  v_F1: 0.285419  v_AUC: 0.578739
steps 800    running time 163 seconds

steps 1000    base_loss: 0.505113    reg_loss: 0.212020    l2_loss: 0.778161    loss: 1.495294
steps 1000    v_Prec: 0.192497  v_Recall: 0.648707  v_F1: 0.296893  v_AUC: 0.601647
steps 1000    running time 175 seconds

steps 1200    base_loss: 0.492746    reg_loss: 0.208227    l2_loss: 0.729995    loss: 1.430968
steps 1200    v_Prec: 0.227967  v_Recall: 0.529184  v_F1: 0.318659  v_AUC: 0.633054
steps 1200    running time 186 seconds

steps 1400    base_loss: 0.462433    reg_loss: 0.203408    l2_loss: 0.679588    loss: 1.345429
steps 1400    v_Prec: 0.286738  v_Recall: 0.501431  v_F1: 0.364844  v_AUC: 0.680030
steps 1400    running time 198 seconds

steps 1600    base_loss: 0.429447    reg_loss: 0.197980    l2_loss: 0.630450    loss: 1.257877
steps 1600    v_Prec: 0.349263  v_Recall: 0.527013  v_F1: 0.420110  v_AUC: 0.722272
steps 1600    running time 210 seconds

steps 1800    base_loss: 0.421172    reg_loss: 0.192177    l2_loss: 0.582364    loss: 1.195713
steps 1800    v_Prec: 0.390717  v_Recall: 0.539076  v_F1: 0.453060  v_AUC: 0.745127
steps 1800    running time 221 seconds

steps 2000    base_loss: 0.398946    reg_loss: 0.183561    l2_loss: 0.539455    loss: 1.121962
steps 2000    v_Prec: 0.412252  v_Recall: 0.567101  v_F1: 0.477435  v_AUC: 0.761443
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.388431    reg_loss: 0.173422    l2_loss: 0.497393    loss: 1.059246
steps 2200    v_Prec: 0.426649  v_Recall: 0.579411  v_F1: 0.491432  v_AUC: 0.773732
steps 2200    running time 244 seconds

steps 2400    base_loss: 0.375403    reg_loss: 0.163757    l2_loss: 0.461662    loss: 1.000823
steps 2400    v_Prec: 0.439289  v_Recall: 0.584419  v_F1: 0.501567  v_AUC: 0.784470
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.372464    reg_loss: 0.155291    l2_loss: 0.427656    loss: 0.955412
steps 2600    v_Prec: 0.455396  v_Recall: 0.594657  v_F1: 0.515792  v_AUC: 0.797970
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.366053    reg_loss: 0.147747    l2_loss: 0.399564    loss: 0.913364
steps 2800    v_Prec: 0.471849  v_Recall: 0.604524  v_F1: 0.530010  v_AUC: 0.807352
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.356180    reg_loss: 0.139934    l2_loss: 0.375390    loss: 0.871505
steps 3000    v_Prec: 0.490353  v_Recall: 0.616958  v_F1: 0.546418  v_AUC: 0.820364
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.345324    reg_loss: 0.133854    l2_loss: 0.351769    loss: 0.830946
steps 3200    v_Prec: 0.506810  v_Recall: 0.618734  v_F1: 0.557207  v_AUC: 0.830986
steps 3200    running time 301 seconds

steps 3400    base_loss: 0.341293    reg_loss: 0.129498    l2_loss: 0.331059    loss: 0.801850
steps 3400    v_Prec: 0.520053  v_Recall: 0.636249  v_F1: 0.572313  v_AUC: 0.842969
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.335304    reg_loss: 0.126178    l2_loss: 0.314783    loss: 0.776265
steps 3600    v_Prec: 0.530352  v_Recall: 0.653493  v_F1: 0.585518  v_AUC: 0.851764
steps 3600    running time 324 seconds

steps 3800    base_loss: 0.327761    reg_loss: 0.122294    l2_loss: 0.297693    loss: 0.747748
steps 3800    v_Prec: 0.535488  v_Recall: 0.676362  v_F1: 0.597737  v_AUC: 0.859609
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.315897    reg_loss: 0.119512    l2_loss: 0.283401    loss: 0.718810
steps 4000    v_Prec: 0.556790  v_Recall: 0.668764  v_F1: 0.607662  v_AUC: 0.867571
steps 4000    running time 348 seconds

steps 4200    base_loss: 0.312930    reg_loss: 0.116586    l2_loss: 0.269741    loss: 0.699257
steps 4200    v_Prec: 0.551885  v_Recall: 0.695752  v_F1: 0.615524  v_AUC: 0.874296
steps 4200    running time 359 seconds

steps 4400    base_loss: 0.313253    reg_loss: 0.114080    l2_loss: 0.258779    loss: 0.686112
steps 4400    v_Prec: 0.559572  v_Recall: 0.707569  v_F1: 0.624928  v_AUC: 0.881708
steps 4400    running time 370 seconds

steps 4600    base_loss: 0.297302    reg_loss: 0.110649    l2_loss: 0.246151    loss: 0.654103
steps 4600    v_Prec: 0.560145  v_Recall: 0.720619  v_F1: 0.630329  v_AUC: 0.885284
steps 4600    running time 382 seconds

steps 4800    base_loss: 0.298908    reg_loss: 0.108571    l2_loss: 0.235235    loss: 0.642713
steps 4800    v_Prec: 0.572059  v_Recall: 0.719533  v_F1: 0.637377  v_AUC: 0.889238
steps 4800    running time 394 seconds

steps 5000    base_loss: 0.289893    reg_loss: 0.105756    l2_loss: 0.225855    loss: 0.621503
steps 5000    v_Prec: 0.566116  v_Recall: 0.740996  v_F1: 0.641857  v_AUC: 0.893741
steps 5000    running time 405 seconds

steps 5200    base_loss: 0.287638    reg_loss: 0.103380    l2_loss: 0.214258    loss: 0.605276
steps 5200    v_Prec: 0.578164  v_Recall: 0.735371  v_F1: 0.647360  v_AUC: 0.897015
steps 5200    running time 417 seconds

steps 5400    base_loss: 0.287091    reg_loss: 0.102903    l2_loss: 0.208052    loss: 0.598045
steps 5400    v_Prec: 0.577267  v_Recall: 0.755748  v_F1: 0.654559  v_AUC: 0.900742
steps 5400    running time 428 seconds

steps 5600    base_loss: 0.283184    reg_loss: 0.101224    l2_loss: 0.199829    loss: 0.584238
steps 5600    v_Prec: 0.578062  v_Recall: 0.762236  v_F1: 0.657495  v_AUC: 0.902858
steps 5600    running time 440 seconds

steps 5800    base_loss: 0.277734    reg_loss: 0.098815    l2_loss: 0.191323    loss: 0.567871
steps 5800    v_Prec: 0.586607  v_Recall: 0.754835  v_F1: 0.660172  v_AUC: 0.905293
steps 5800    running time 451 seconds

steps 6000    base_loss: 0.275111    reg_loss: 0.096599    l2_loss: 0.184576    loss: 0.556286
steps 6000    v_Prec: 0.579588  v_Recall: 0.777802  v_F1: 0.664223  v_AUC: 0.907788
steps 6000    running time 463 seconds

steps 6200    base_loss: 0.278455    reg_loss: 0.097273    l2_loss: 0.177595    loss: 0.553324
steps 6200    v_Prec: 0.590612  v_Recall: 0.765468  v_F1: 0.666767  v_AUC: 0.910473
steps 6200    running time 474 seconds

steps 6400    base_loss: 0.275711    reg_loss: 0.095124    l2_loss: 0.171906    loss: 0.542741
steps 6400    v_Prec: 0.591281  v_Recall: 0.775582  v_F1: 0.671006  v_AUC: 0.911965
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.271663    reg_loss: 0.093632    l2_loss: 0.164267    loss: 0.529562
steps 6600    v_Prec: 0.588588  v_Recall: 0.789126  v_F1: 0.674262  v_AUC: 0.915402
steps 6600    running time 497 seconds

steps 6800    base_loss: 0.267859    reg_loss: 0.092947    l2_loss: 0.159020    loss: 0.519826
steps 6800    v_Prec: 0.585926  v_Recall: 0.796773  v_F1: 0.675274  v_AUC: 0.916382
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.266258    reg_loss: 0.091304    l2_loss: 0.153059    loss: 0.510621
steps 7000    v_Prec: 0.582781  v_Recall: 0.807578  v_F1: 0.677007  v_AUC: 0.918018
steps 7000    running time 520 seconds

steps 7200    base_loss: 0.268879    reg_loss: 0.091733    l2_loss: 0.148394    loss: 0.509006
steps 7200    v_Prec: 0.588948  v_Recall: 0.801929  v_F1: 0.679132  v_AUC: 0.920346
steps 7200    running time 531 seconds

steps 7400    base_loss: 0.263545    reg_loss: 0.089656    l2_loss: 0.144074    loss: 0.497275
steps 7400    v_Prec: 0.587663  v_Recall: 0.808689  v_F1: 0.680683  v_AUC: 0.921936
steps 7400    running time 543 seconds

steps 7600    base_loss: 0.255112    reg_loss: 0.087947    l2_loss: 0.137673    loss: 0.480733
steps 7600    v_Prec: 0.587228  v_Recall: 0.817594  v_F1: 0.683523  v_AUC: 0.922016
steps 7600    running time 554 seconds

steps 7800    base_loss: 0.256302    reg_loss: 0.087306    l2_loss: 0.132725    loss: 0.476333
steps 7800    v_Prec: 0.593786  v_Recall: 0.807652  v_F1: 0.684401  v_AUC: 0.922795
steps 7800    running time 566 seconds

steps 8000    base_loss: 0.255695    reg_loss: 0.086123    l2_loss: 0.127593    loss: 0.469411
steps 8000    v_Prec: 0.593101  v_Recall: 0.818236  v_F1: 0.687712  v_AUC: 0.924318
steps 8000    running time 577 seconds

steps 8200    base_loss: 0.260173    reg_loss: 0.085768    l2_loss: 0.123681    loss: 0.469621
steps 8200    v_Prec: 0.590718  v_Recall: 0.824230  v_F1: 0.688205  v_AUC: 0.925352
steps 8200    running time 589 seconds

steps 8400    base_loss: 0.262496    reg_loss: 0.085726    l2_loss: 0.120985    loss: 0.469207
steps 8400    v_Prec: 0.581044  v_Recall: 0.837379  v_F1: 0.686049  v_AUC: 0.925283
steps 8400    running time 600 seconds

steps 8600    base_loss: 0.250881    reg_loss: 0.082798    l2_loss: 0.115510    loss: 0.449189
steps 8600    v_Prec: 0.585592  v_Recall: 0.834197  v_F1: 0.688129  v_AUC: 0.926410
steps 8600    running time 611 seconds

steps 8800    base_loss: 0.252189    reg_loss: 0.082138    l2_loss: 0.112103    loss: 0.446430
steps 8800    v_Prec: 0.576576  v_Recall: 0.849048  v_F1: 0.686774  v_AUC: 0.926445
steps 8800    running time 622 seconds

steps 9000    base_loss: 0.257089    reg_loss: 0.082810    l2_loss: 0.108007    loss: 0.447905
steps 9000    v_Prec: 0.580532  v_Recall: 0.843917  v_F1: 0.687874  v_AUC: 0.927338
steps 9000    running time 633 seconds

steps 9200    base_loss: 0.246408    reg_loss: 0.082330    l2_loss: 0.105742    loss: 0.434480
steps 9200    v_Prec: 0.588681  v_Recall: 0.830595  v_F1: 0.689021  v_AUC: 0.927085
steps 9200    running time 644 seconds

steps 9400    base_loss: 0.251325    reg_loss: 0.081221    l2_loss: 0.101907    loss: 0.434453
steps 9400    v_Prec: 0.585832  v_Recall: 0.838267  v_F1: 0.689676  v_AUC: 0.927302
steps 9400    running time 656 seconds

steps 9600    base_loss: 0.256765    reg_loss: 0.080896    l2_loss: 0.099139    loss: 0.436800
steps 9600    v_Prec: 0.595413  v_Recall: 0.821689  v_F1: 0.690486  v_AUC: 0.928028
steps 9600    running time 667 seconds

steps 9800    base_loss: 0.253412    reg_loss: 0.080787    l2_loss: 0.096617    loss: 0.430816
steps 9800    v_Prec: 0.594484  v_Recall: 0.824280  v_F1: 0.690772  v_AUC: 0.928030
steps 9800    running time 679 seconds

steps 10000    base_loss: 0.246450    reg_loss: 0.079811    l2_loss: 0.093359    loss: 0.419621
steps 10000    v_Prec: 0.589095  v_Recall: 0.832939  v_F1: 0.690110  v_AUC: 0.928312
steps 10000    running time 690 seconds

steps 10200    base_loss: 0.251909    reg_loss: 0.077983    l2_loss: 0.091461    loss: 0.421353
steps 10200    v_Prec: 0.590241  v_Recall: 0.832273  v_F1: 0.690667  v_AUC: 0.928486
steps 10200    running time 701 seconds

steps 10400    base_loss: 0.254165    reg_loss: 0.079135    l2_loss: 0.089208    loss: 0.422508
steps 10400    v_Prec: 0.581728  v_Recall: 0.849516  v_F1: 0.690571  v_AUC: 0.928123
steps 10400    running time 712 seconds

steps 10600    base_loss: 0.247691    reg_loss: 0.077805    l2_loss: 0.087003    loss: 0.412499
steps 10600    v_Prec: 0.585377  v_Recall: 0.836244  v_F1: 0.688676  v_AUC: 0.927906
steps 10600    running time 723 seconds

steps 10800    base_loss: 0.249154    reg_loss: 0.079425    l2_loss: 0.086090    loss: 0.414670
steps 10800    v_Prec: 0.591667  v_Recall: 0.831335  v_F1: 0.691318  v_AUC: 0.928174
steps 10800    running time 734 seconds

steps 11000    base_loss: 0.252479    reg_loss: 0.077270    l2_loss: 0.083512    loss: 0.413261
steps 11000    v_Prec: 0.582301  v_Recall: 0.848456  v_F1: 0.690622  v_AUC: 0.928908
steps 11000    running time 746 seconds

steps 11200    base_loss: 0.253265    reg_loss: 0.077617    l2_loss: 0.080676    loss: 0.411559
steps 11200    v_Prec: 0.585823  v_Recall: 0.848530  v_F1: 0.693118  v_AUC: 0.929707
steps 11200    running time 756 seconds

steps 11400    base_loss: 0.245178    reg_loss: 0.077788    l2_loss: 0.080646    loss: 0.403612
steps 11400    v_Prec: 0.587975  v_Recall: 0.845323  v_F1: 0.693545  v_AUC: 0.930079
steps 11400    running time 768 seconds

steps 11600    base_loss: 0.249495    reg_loss: 0.076596    l2_loss: 0.079325    loss: 0.405416
steps 11600    v_Prec: 0.588223  v_Recall: 0.843053  v_F1: 0.692953  v_AUC: 0.929961
steps 11600    running time 779 seconds

steps 11800    base_loss: 0.247609    reg_loss: 0.074860    l2_loss: 0.076917    loss: 0.399386
steps 11800    v_Prec: 0.586964  v_Recall: 0.844188  v_F1: 0.692460  v_AUC: 0.929707
steps 11800    running time 790 seconds

steps 12000    base_loss: 0.252566    reg_loss: 0.076896    l2_loss: 0.076021    loss: 0.405483
steps 12000    v_Prec: 0.588740  v_Recall: 0.837404  v_F1: 0.691393  v_AUC: 0.929054
steps 12000    running time 801 seconds

steps 12200    base_loss: 0.251615    reg_loss: 0.075867    l2_loss: 0.075354    loss: 0.402836
steps 12200    v_Prec: 0.591965  v_Recall: 0.833827  v_F1: 0.692382  v_AUC: 0.930173
steps 12200    running time 812 seconds

steps 12400    base_loss: 0.247194    reg_loss: 0.074458    l2_loss: 0.073616    loss: 0.395268
steps 12400    v_Prec: 0.591146  v_Recall: 0.835036  v_F1: 0.692237  v_AUC: 0.929848
steps 12400    running time 823 seconds

steps 12600    base_loss: 0.243772    reg_loss: 0.074868    l2_loss: 0.072396    loss: 0.391037
steps 12600    v_Prec: 0.581562  v_Recall: 0.855931  v_F1: 0.692563  v_AUC: 0.928908
steps 12600    running time 834 seconds

steps 12800    base_loss: 0.250013    reg_loss: 0.074768    l2_loss: 0.071007    loss: 0.395788
steps 12800    v_Prec: 0.586902  v_Recall: 0.846285  v_F1: 0.693121  v_AUC: 0.930014
steps 12800    running time 844 seconds

steps 13000    base_loss: 0.251130    reg_loss: 0.074601    l2_loss: 0.069744    loss: 0.395476
steps 13000    v_Prec: 0.592677  v_Recall: 0.831014  v_F1: 0.691896  v_AUC: 0.930020
steps 13000    running time 856 seconds

steps 13200    base_loss: 0.246975    reg_loss: 0.073711    l2_loss: 0.069434    loss: 0.390120
steps 13200    v_Prec: 0.582923  v_Recall: 0.852872  v_F1: 0.692520  v_AUC: 0.930049
steps 13200    running time 867 seconds

steps 13400    base_loss: 0.249107    reg_loss: 0.075607    l2_loss: 0.068806    loss: 0.393519
steps 13400    v_Prec: 0.587410  v_Recall: 0.845742  v_F1: 0.693293  v_AUC: 0.929534
steps 13400    running time 877 seconds

Early stop model F1: 0.693545
testing thre: 0.19400015
testing Prec: 0.5525275810966573
testing Recall: 0.7789788308353042
testing F1: 0.6464967577624045
testing AUC: 0.8945269218804168
overall running time 886 seconds
(0.5689811824720036, 0.7541533059589965, 0.6486098632325048, 0.8945269218804168, 0.23421948)
2019-02-17 02:21:25.700090: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 02:21:26.289618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 02:21:26.291393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 02:21:26.291435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 90.650000 seconds
loading data in 112.590000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	32
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.677620    reg_loss: 0.217424    l2_loss: 0.883490    loss: 1.778534
steps 200    v_Prec: 0.157152  v_Recall: 0.999852  v_F1: 0.271613  v_AUC: 0.493600
steps 200    running time 129 seconds

steps 400    base_loss: 0.625238    reg_loss: 0.216338    l2_loss: 0.871302    loss: 1.712878
steps 400    v_Prec: 0.157155  v_Recall: 0.999902  v_F1: 0.271619  v_AUC: 0.504778
steps 400    running time 140 seconds

steps 600    base_loss: 0.553407    reg_loss: 0.214673    l2_loss: 0.846694    loss: 1.614775
steps 600    v_Prec: 0.157710  v_Recall: 0.983041  v_F1: 0.271812  v_AUC: 0.524040
steps 600    running time 151 seconds

steps 800    base_loss: 0.499805    reg_loss: 0.211555    l2_loss: 0.814391    loss: 1.525750
steps 800    v_Prec: 0.168465  v_Recall: 0.781752  v_F1: 0.277195  v_AUC: 0.554638
steps 800    running time 162 seconds

steps 1000    base_loss: 0.471760    reg_loss: 0.207670    l2_loss: 0.766726    loss: 1.446156
steps 1000    v_Prec: 0.192793  v_Recall: 0.643202  v_F1: 0.296665  v_AUC: 0.599364
steps 1000    running time 173 seconds

steps 1200    base_loss: 0.468349    reg_loss: 0.203248    l2_loss: 0.716338    loss: 1.387936
steps 1200    v_Prec: 0.241967  v_Recall: 0.536945  v_F1: 0.333601  v_AUC: 0.653228
steps 1200    running time 184 seconds

steps 1400    base_loss: 0.450780    reg_loss: 0.196461    l2_loss: 0.659324    loss: 1.306565
steps 1400    v_Prec: 0.302213  v_Recall: 0.508492  v_F1: 0.379109  v_AUC: 0.697392
steps 1400    running time 195 seconds

steps 1600    base_loss: 0.436765    reg_loss: 0.187982    l2_loss: 0.603398    loss: 1.228145
steps 1600    v_Prec: 0.352894  v_Recall: 0.502806  v_F1: 0.414719  v_AUC: 0.724336
steps 1600    running time 206 seconds

steps 1800    base_loss: 0.416008    reg_loss: 0.178316    l2_loss: 0.553585    loss: 1.147909
steps 1800    v_Prec: 0.378359  v_Recall: 0.534730  v_F1: 0.443155  v_AUC: 0.743493
steps 1800    running time 217 seconds

steps 2000    base_loss: 0.395084    reg_loss: 0.165967    l2_loss: 0.504597    loss: 1.065648
steps 2000    v_Prec: 0.402419  v_Recall: 0.541326  v_F1: 0.461650  v_AUC: 0.759630
steps 2000    running time 229 seconds

steps 2200    base_loss: 0.387562    reg_loss: 0.155417    l2_loss: 0.467406    loss: 1.010385
steps 2200    v_Prec: 0.417106  v_Recall: 0.550704  v_F1: 0.474684  v_AUC: 0.772714
steps 2200    running time 240 seconds

steps 2400    base_loss: 0.373834    reg_loss: 0.144824    l2_loss: 0.429355    loss: 0.948014
steps 2400    v_Prec: 0.417687  v_Recall: 0.578468  v_F1: 0.485102  v_AUC: 0.783144
steps 2400    running time 250 seconds

steps 2600    base_loss: 0.373245    reg_loss: 0.136727    l2_loss: 0.395320    loss: 0.905292
steps 2600    v_Prec: 0.431460  v_Recall: 0.587157  v_F1: 0.497409  v_AUC: 0.795613
steps 2600    running time 261 seconds

steps 2800    base_loss: 0.370142    reg_loss: 0.130993    l2_loss: 0.368667    loss: 0.869803
steps 2800    v_Prec: 0.444636  v_Recall: 0.602220  v_F1: 0.511568  v_AUC: 0.809643
steps 2800    running time 272 seconds

steps 3000    base_loss: 0.362542    reg_loss: 0.125519    l2_loss: 0.341675    loss: 0.829736
steps 3000    v_Prec: 0.450574  v_Recall: 0.630846  v_F1: 0.525684  v_AUC: 0.823049
steps 3000    running time 283 seconds

steps 3200    base_loss: 0.351630    reg_loss: 0.119801    l2_loss: 0.320175    loss: 0.791606
steps 3200    v_Prec: 0.476314  v_Recall: 0.630083  v_F1: 0.542513  v_AUC: 0.836238
steps 3200    running time 294 seconds

steps 3400    base_loss: 0.333083    reg_loss: 0.114096    l2_loss: 0.298957    loss: 0.746137
steps 3400    v_Prec: 0.486692  v_Recall: 0.654869  v_F1: 0.558392  v_AUC: 0.848429
steps 3400    running time 305 seconds

steps 3600    base_loss: 0.322508    reg_loss: 0.109897    l2_loss: 0.280459    loss: 0.712864
steps 3600    v_Prec: 0.509762  v_Recall: 0.655484  v_F1: 0.573511  v_AUC: 0.859726
steps 3600    running time 316 seconds

steps 3800    base_loss: 0.320226    reg_loss: 0.108246    l2_loss: 0.267207    loss: 0.695679
steps 3800    v_Prec: 0.516637  v_Recall: 0.681033  v_F1: 0.587552  v_AUC: 0.869405
steps 3800    running time 327 seconds

steps 4000    base_loss: 0.311958    reg_loss: 0.105378    l2_loss: 0.252492    loss: 0.669828
steps 4000    v_Prec: 0.526316  v_Recall: 0.701487  v_F1: 0.601405  v_AUC: 0.879218
steps 4000    running time 337 seconds

steps 4200    base_loss: 0.303403    reg_loss: 0.102988    l2_loss: 0.239354    loss: 0.645745
steps 4200    v_Prec: 0.535565  v_Recall: 0.719799  v_F1: 0.614163  v_AUC: 0.886662
steps 4200    running time 348 seconds

steps 4400    base_loss: 0.299580    reg_loss: 0.100560    l2_loss: 0.226709    loss: 0.626848
steps 4400    v_Prec: 0.535660  v_Recall: 0.740376  v_F1: 0.621597  v_AUC: 0.893164
steps 4400    running time 359 seconds

steps 4600    base_loss: 0.291080    reg_loss: 0.098444    l2_loss: 0.217045    loss: 0.606569
steps 4600    v_Prec: 0.548205  v_Recall: 0.737718  v_F1: 0.628997  v_AUC: 0.898204
steps 4600    running time 370 seconds

steps 4800    base_loss: 0.281170    reg_loss: 0.095940    l2_loss: 0.205686    loss: 0.582796
steps 4800    v_Prec: 0.555824  v_Recall: 0.741213  v_F1: 0.635270  v_AUC: 0.902580
steps 4800    running time 381 seconds

steps 5000    base_loss: 0.271578    reg_loss: 0.093655    l2_loss: 0.196359    loss: 0.561592
steps 5000    v_Prec: 0.557542  v_Recall: 0.758270  v_F1: 0.642596  v_AUC: 0.906986
steps 5000    running time 392 seconds

steps 5200    base_loss: 0.272106    reg_loss: 0.091917    l2_loss: 0.188494    loss: 0.552518
steps 5200    v_Prec: 0.555778  v_Recall: 0.772669  v_F1: 0.646518  v_AUC: 0.910076
steps 5200    running time 403 seconds

steps 5400    base_loss: 0.267793    reg_loss: 0.090531    l2_loss: 0.180608    loss: 0.538932
steps 5400    v_Prec: 0.558327  v_Recall: 0.782810  v_F1: 0.651781  v_AUC: 0.912996
steps 5400    running time 414 seconds

steps 5600    base_loss: 0.266490    reg_loss: 0.088717    l2_loss: 0.172087    loss: 0.527294
steps 5600    v_Prec: 0.565842  v_Recall: 0.777789  v_F1: 0.655099  v_AUC: 0.915351
steps 5600    running time 425 seconds

steps 5800    base_loss: 0.256554    reg_loss: 0.086897    l2_loss: 0.164577    loss: 0.508028
steps 5800    v_Prec: 0.567494  v_Recall: 0.783007  v_F1: 0.658055  v_AUC: 0.917305
steps 5800    running time 436 seconds

steps 6000    base_loss: 0.257069    reg_loss: 0.086671    l2_loss: 0.158712    loss: 0.502452
steps 6000    v_Prec: 0.559384  v_Recall: 0.807079  v_F1: 0.660782  v_AUC: 0.919937
steps 6000    running time 448 seconds

steps 6200    base_loss: 0.258286    reg_loss: 0.084977    l2_loss: 0.151061    loss: 0.494325
steps 6200    v_Prec: 0.563741  v_Recall: 0.810131  v_F1: 0.664842  v_AUC: 0.921093
steps 6200    running time 459 seconds

steps 6400    base_loss: 0.252073    reg_loss: 0.083946    l2_loss: 0.145636    loss: 0.481656
steps 6400    v_Prec: 0.578790  v_Recall: 0.794846  v_F1: 0.669826  v_AUC: 0.923072
steps 6400    running time 470 seconds

steps 6600    base_loss: 0.252748    reg_loss: 0.082081    l2_loss: 0.139582    loss: 0.474410
steps 6600    v_Prec: 0.576310  v_Recall: 0.804519  v_F1: 0.671557  v_AUC: 0.924381
steps 6600    running time 481 seconds

steps 6800    base_loss: 0.246013    reg_loss: 0.082228    l2_loss: 0.135171    loss: 0.463411
steps 6800    v_Prec: 0.576472  v_Recall: 0.808605  v_F1: 0.673086  v_AUC: 0.925492
steps 6800    running time 492 seconds

steps 7000    base_loss: 0.242315    reg_loss: 0.081401    l2_loss: 0.131070    loss: 0.454786
steps 7000    v_Prec: 0.581658  v_Recall: 0.800532  v_F1: 0.673765  v_AUC: 0.926290
steps 7000    running time 503 seconds

steps 7200    base_loss: 0.243053    reg_loss: 0.080829    l2_loss: 0.126604    loss: 0.450486
steps 7200    v_Prec: 0.582676  v_Recall: 0.803510  v_F1: 0.675502  v_AUC: 0.927118
steps 7200    running time 514 seconds

steps 7400    base_loss: 0.248276    reg_loss: 0.079850    l2_loss: 0.122053    loss: 0.450179
steps 7400    v_Prec: 0.577739  v_Recall: 0.818303  v_F1: 0.677294  v_AUC: 0.927823
steps 7400    running time 525 seconds

steps 7600    base_loss: 0.241070    reg_loss: 0.077779    l2_loss: 0.117335    loss: 0.436183
steps 7600    v_Prec: 0.584654  v_Recall: 0.809663  v_F1: 0.679003  v_AUC: 0.928318
steps 7600    running time 536 seconds

steps 7800    base_loss: 0.245285    reg_loss: 0.078514    l2_loss: 0.113743    loss: 0.437543
steps 7800    v_Prec: 0.582964  v_Recall: 0.818155  v_F1: 0.680820  v_AUC: 0.929668
steps 7800    running time 547 seconds

steps 8000    base_loss: 0.243332    reg_loss: 0.078396    l2_loss: 0.112305    loss: 0.434034
steps 8000    v_Prec: 0.588115  v_Recall: 0.813109  v_F1: 0.682548  v_AUC: 0.930101
steps 8000    running time 558 seconds

steps 8200    base_loss: 0.237119    reg_loss: 0.077298    l2_loss: 0.108218    loss: 0.422634
steps 8200    v_Prec: 0.590446  v_Recall: 0.812002  v_F1: 0.683723  v_AUC: 0.930944
steps 8200    running time 569 seconds

steps 8400    base_loss: 0.240596    reg_loss: 0.077532    l2_loss: 0.105317    loss: 0.423444
steps 8400    v_Prec: 0.582925  v_Recall: 0.828690  v_F1: 0.684413  v_AUC: 0.931445
steps 8400    running time 580 seconds

steps 8600    base_loss: 0.236567    reg_loss: 0.075577    l2_loss: 0.103186    loss: 0.415330
steps 8600    v_Prec: 0.586069  v_Recall: 0.824013  v_F1: 0.684965  v_AUC: 0.931897
steps 8600    running time 591 seconds

steps 8800    base_loss: 0.232792    reg_loss: 0.074990    l2_loss: 0.100579    loss: 0.408360
steps 8800    v_Prec: 0.580581  v_Recall: 0.838190  v_F1: 0.685999  v_AUC: 0.932273
steps 8800    running time 602 seconds

steps 9000    base_loss: 0.241599    reg_loss: 0.074958    l2_loss: 0.097891    loss: 0.414448
steps 9000    v_Prec: 0.581613  v_Recall: 0.836517  v_F1: 0.686156  v_AUC: 0.932885
steps 9000    running time 613 seconds

steps 9200    base_loss: 0.235030    reg_loss: 0.074980    l2_loss: 0.095496    loss: 0.405507
steps 9200    v_Prec: 0.584597  v_Recall: 0.834375  v_F1: 0.687502  v_AUC: 0.932839
steps 9200    running time 624 seconds

steps 9400    base_loss: 0.241033    reg_loss: 0.075233    l2_loss: 0.094178    loss: 0.410444
steps 9400    v_Prec: 0.580428  v_Recall: 0.841341  v_F1: 0.686944  v_AUC: 0.933146
steps 9400    running time 635 seconds

steps 9600    base_loss: 0.231461    reg_loss: 0.073702    l2_loss: 0.092194    loss: 0.397357
steps 9600    v_Prec: 0.581065  v_Recall: 0.837058  v_F1: 0.685956  v_AUC: 0.932918
steps 9600    running time 645 seconds

steps 9800    base_loss: 0.232203    reg_loss: 0.073721    l2_loss: 0.091059    loss: 0.396983
steps 9800    v_Prec: 0.581153  v_Recall: 0.836984  v_F1: 0.685993  v_AUC: 0.932670
steps 9800    running time 656 seconds

steps 10000    base_loss: 0.234196    reg_loss: 0.073661    l2_loss: 0.089524    loss: 0.397381
steps 10000    v_Prec: 0.589490  v_Recall: 0.825022  v_F1: 0.687647  v_AUC: 0.933569
steps 10000    running time 667 seconds

steps 10200    base_loss: 0.229614    reg_loss: 0.072435    l2_loss: 0.087833    loss: 0.389882
steps 10200    v_Prec: 0.585903  v_Recall: 0.832332  v_F1: 0.687708  v_AUC: 0.933680
steps 10200    running time 678 seconds

steps 10400    base_loss: 0.236464    reg_loss: 0.072578    l2_loss: 0.085085    loss: 0.394127
steps 10400    v_Prec: 0.590194  v_Recall: 0.827779  v_F1: 0.689082  v_AUC: 0.934076
steps 10400    running time 689 seconds

steps 10600    base_loss: 0.234245    reg_loss: 0.072165    l2_loss: 0.084853    loss: 0.391262
steps 10600    v_Prec: 0.588189  v_Recall: 0.836492  v_F1: 0.690703  v_AUC: 0.934026
steps 10600    running time 699 seconds

steps 10800    base_loss: 0.233439    reg_loss: 0.072083    l2_loss: 0.083880    loss: 0.389401
steps 10800    v_Prec: 0.588800  v_Recall: 0.836911  v_F1: 0.691266  v_AUC: 0.934070
steps 10800    running time 710 seconds

steps 11000    base_loss: 0.230772    reg_loss: 0.071804    l2_loss: 0.082561    loss: 0.385137
steps 11000    v_Prec: 0.590212  v_Recall: 0.828763  v_F1: 0.689436  v_AUC: 0.934024
steps 11000    running time 721 seconds

steps 11200    base_loss: 0.234367    reg_loss: 0.070987    l2_loss: 0.080766    loss: 0.386119
steps 11200    v_Prec: 0.582860  v_Recall: 0.846042  v_F1: 0.690214  v_AUC: 0.934375
steps 11200    running time 732 seconds

steps 11400    base_loss: 0.233345    reg_loss: 0.070360    l2_loss: 0.079338    loss: 0.383043
steps 11400    v_Prec: 0.583283  v_Recall: 0.848651  v_F1: 0.691378  v_AUC: 0.934782
steps 11400    running time 742 seconds

steps 11600    base_loss: 0.229316    reg_loss: 0.069508    l2_loss: 0.078817    loss: 0.377641
steps 11600    v_Prec: 0.591109  v_Recall: 0.837821  v_F1: 0.693167  v_AUC: 0.934352
steps 11600    running time 753 seconds

steps 11800    base_loss: 0.232135    reg_loss: 0.069787    l2_loss: 0.078325    loss: 0.380247
steps 11800    v_Prec: 0.585663  v_Recall: 0.838363  v_F1: 0.689592  v_AUC: 0.934138
steps 11800    running time 764 seconds

steps 12000    base_loss: 0.237857    reg_loss: 0.070220    l2_loss: 0.077745    loss: 0.385822
steps 12000    v_Prec: 0.594507  v_Recall: 0.826819  v_F1: 0.691677  v_AUC: 0.934662
steps 12000    running time 775 seconds

steps 12200    base_loss: 0.235876    reg_loss: 0.069348    l2_loss: 0.077264    loss: 0.382488
steps 12200    v_Prec: 0.593420  v_Recall: 0.831471  v_F1: 0.692560  v_AUC: 0.934947
steps 12200    running time 786 seconds

steps 12400    base_loss: 0.237834    reg_loss: 0.069547    l2_loss: 0.077025    loss: 0.384406
steps 12400    v_Prec: 0.588749  v_Recall: 0.842375  v_F1: 0.693088  v_AUC: 0.934538
steps 12400    running time 796 seconds

steps 12600    base_loss: 0.235382    reg_loss: 0.069543    l2_loss: 0.076662    loss: 0.381588
steps 12600    v_Prec: 0.586392  v_Recall: 0.844270  v_F1: 0.692090  v_AUC: 0.934464
steps 12600    running time 807 seconds

steps 12800    base_loss: 0.235464    reg_loss: 0.068098    l2_loss: 0.075423    loss: 0.378985
steps 12800    v_Prec: 0.591961  v_Recall: 0.837034  v_F1: 0.693483  v_AUC: 0.934766
steps 12800    running time 818 seconds

steps 13000    base_loss: 0.236657    reg_loss: 0.068980    l2_loss: 0.075653    loss: 0.381290
steps 13000    v_Prec: 0.593787  v_Recall: 0.839323  v_F1: 0.695521  v_AUC: 0.935368
steps 13000    running time 829 seconds

steps 13200    base_loss: 0.233543    reg_loss: 0.067539    l2_loss: 0.074496    loss: 0.375578
steps 13200    v_Prec: 0.592082  v_Recall: 0.838880  v_F1: 0.694198  v_AUC: 0.934694
steps 13200    running time 839 seconds

steps 13400    base_loss: 0.230716    reg_loss: 0.068103    l2_loss: 0.074500    loss: 0.373319
steps 13400    v_Prec: 0.591707  v_Recall: 0.841538  v_F1: 0.694848  v_AUC: 0.934797
steps 13400    running time 850 seconds

steps 13600    base_loss: 0.228954    reg_loss: 0.067148    l2_loss: 0.074439    loss: 0.370540
steps 13600    v_Prec: 0.596528  v_Recall: 0.828763  v_F1: 0.693725  v_AUC: 0.933882
steps 13600    running time 861 seconds

steps 13800    base_loss: 0.231968    reg_loss: 0.066805    l2_loss: 0.073212    loss: 0.371985
steps 13800    v_Prec: 0.600313  v_Recall: 0.822364  v_F1: 0.694009  v_AUC: 0.934087
steps 13800    running time 872 seconds

steps 14000    base_loss: 0.233242    reg_loss: 0.067479    l2_loss: 0.072298    loss: 0.373019
steps 14000    v_Prec: 0.594812  v_Recall: 0.831299  v_F1: 0.693447  v_AUC: 0.934644
steps 14000    running time 883 seconds

steps 14200    base_loss: 0.232727    reg_loss: 0.067339    l2_loss: 0.073016    loss: 0.373082
steps 14200    v_Prec: 0.593177  v_Recall: 0.833292  v_F1: 0.693026  v_AUC: 0.934994
steps 14200    running time 893 seconds

steps 14400    base_loss: 0.228265    reg_loss: 0.066182    l2_loss: 0.072733    loss: 0.367179
steps 14400    v_Prec: 0.591036  v_Recall: 0.833514  v_F1: 0.691638  v_AUC: 0.934476
steps 14400    running time 904 seconds

steps 14600    base_loss: 0.228639    reg_loss: 0.064826    l2_loss: 0.071619    loss: 0.365084
steps 14600    v_Prec: 0.593257  v_Recall: 0.832455  v_F1: 0.692791  v_AUC: 0.934287
steps 14600    running time 914 seconds

steps 14800    base_loss: 0.237184    reg_loss: 0.067472    l2_loss: 0.072433    loss: 0.377088
steps 14800    v_Prec: 0.593115  v_Recall: 0.835409  v_F1: 0.693714  v_AUC: 0.933949
steps 14800    running time 925 seconds

steps 15000    base_loss: 0.231115    reg_loss: 0.066359    l2_loss: 0.071254    loss: 0.368729
steps 15000    v_Prec: 0.591762  v_Recall: 0.838092  v_F1: 0.693709  v_AUC: 0.933704
steps 15000    running time 936 seconds

Early stop model F1: 0.695521
testing thre: 0.252661
testing Prec: 0.453197880290117
testing Recall: 0.8077944313054076
testing F1: 0.5806391055859164
testing AUC: 0.8827834308583047
overall running time 944 seconds
(0.4834396444312201, 0.7543709464459308, 0.5892546481778463, 0.8827834308583047, 0.33366734)
2019-02-17 02:31:55.113112: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 02:31:55.777120: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 02:31:55.778077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 02:31:55.778125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.210000 seconds
loading data in 111.540000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	96
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.880227    reg_loss: 0.215262    l2_loss: 0.883278    loss: 1.978767
steps 200    v_Prec: 0.159216  v_Recall: 0.925716  v_F1: 0.271702  v_AUC: 0.536454
steps 200    running time 129 seconds

steps 400    base_loss: 0.808687    reg_loss: 0.215176    l2_loss: 0.871331    loss: 1.895193
steps 400    v_Prec: 0.169350  v_Recall: 0.754076  v_F1: 0.276585  v_AUC: 0.557871
steps 400    running time 142 seconds

steps 600    base_loss: 0.703336    reg_loss: 0.215166    l2_loss: 0.848967    loss: 1.767469
steps 600    v_Prec: 0.185801  v_Recall: 0.665736  v_F1: 0.290521  v_AUC: 0.587909
steps 600    running time 154 seconds

steps 800    base_loss: 0.591882    reg_loss: 0.215594    l2_loss: 0.817121    loss: 1.624598
steps 800    v_Prec: 0.209076  v_Recall: 0.593083  v_F1: 0.309164  v_AUC: 0.618882
steps 800    running time 166 seconds

steps 1000    base_loss: 0.514538    reg_loss: 0.215666    l2_loss: 0.779210    loss: 1.509413
steps 1000    v_Prec: 0.223937  v_Recall: 0.604397  v_F1: 0.326793  v_AUC: 0.642972
steps 1000    running time 178 seconds

steps 1200    base_loss: 0.472339    reg_loss: 0.214363    l2_loss: 0.732904    loss: 1.419606
steps 1200    v_Prec: 0.248872  v_Recall: 0.561537  v_F1: 0.344890  v_AUC: 0.664384
steps 1200    running time 190 seconds

steps 1400    base_loss: 0.449826    reg_loss: 0.211792    l2_loss: 0.681471    loss: 1.343089
steps 1400    v_Prec: 0.287425  v_Recall: 0.514526  v_F1: 0.368820  v_AUC: 0.686439
steps 1400    running time 203 seconds

steps 1600    base_loss: 0.436631    reg_loss: 0.206838    l2_loss: 0.628945    loss: 1.272414
steps 1600    v_Prec: 0.310435  v_Recall: 0.535178  v_F1: 0.392941  v_AUC: 0.705923
steps 1600    running time 215 seconds

steps 1800    base_loss: 0.422467    reg_loss: 0.199390    l2_loss: 0.580590    loss: 1.202447
steps 1800    v_Prec: 0.347558  v_Recall: 0.513266  v_F1: 0.414462  v_AUC: 0.721765
steps 1800    running time 228 seconds

steps 2000    base_loss: 0.422142    reg_loss: 0.191963    l2_loss: 0.535589    loss: 1.149693
steps 2000    v_Prec: 0.371287  v_Recall: 0.524580  v_F1: 0.434818  v_AUC: 0.736913
steps 2000    running time 240 seconds

steps 2200    base_loss: 0.403910    reg_loss: 0.181659    l2_loss: 0.491496    loss: 1.077065
steps 2200    v_Prec: 0.384303  v_Recall: 0.546739  v_F1: 0.451351  v_AUC: 0.749176
steps 2200    running time 252 seconds

steps 2400    base_loss: 0.392355    reg_loss: 0.171547    l2_loss: 0.454248    loss: 1.018150
steps 2400    v_Prec: 0.397866  v_Recall: 0.560894  v_F1: 0.465519  v_AUC: 0.762068
steps 2400    running time 264 seconds

steps 2600    base_loss: 0.385232    reg_loss: 0.162883    l2_loss: 0.423079    loss: 0.971195
steps 2600    v_Prec: 0.403241  v_Recall: 0.588982  v_F1: 0.478726  v_AUC: 0.774583
steps 2600    running time 276 seconds

steps 2800    base_loss: 0.373860    reg_loss: 0.153731    l2_loss: 0.396655    loss: 0.924247
steps 2800    v_Prec: 0.416718  v_Recall: 0.601235  v_F1: 0.492254  v_AUC: 0.788178
steps 2800    running time 289 seconds

steps 3000    base_loss: 0.371622    reg_loss: 0.146515    l2_loss: 0.371627    loss: 0.889764
steps 3000    v_Prec: 0.431063  v_Recall: 0.610005  v_F1: 0.505155  v_AUC: 0.802385
steps 3000    running time 301 seconds

steps 3200    base_loss: 0.353542    reg_loss: 0.138530    l2_loss: 0.348635    loss: 0.840706
steps 3200    v_Prec: 0.440140  v_Recall: 0.640736  v_F1: 0.521824  v_AUC: 0.818549
steps 3200    running time 313 seconds

steps 3400    base_loss: 0.347399    reg_loss: 0.133998    l2_loss: 0.331049    loss: 0.812446
steps 3400    v_Prec: 0.448311  v_Recall: 0.675988  v_F1: 0.539097  v_AUC: 0.834232
steps 3400    running time 326 seconds

steps 3600    base_loss: 0.328941    reg_loss: 0.127607    l2_loss: 0.312961    loss: 0.769509
steps 3600    v_Prec: 0.476131  v_Recall: 0.668454  v_F1: 0.556134  v_AUC: 0.847552
steps 3600    running time 338 seconds

steps 3800    base_loss: 0.327278    reg_loss: 0.124700    l2_loss: 0.296713    loss: 0.748691
steps 3800    v_Prec: 0.494132  v_Recall: 0.690637  v_F1: 0.576089  v_AUC: 0.861252
steps 3800    running time 351 seconds

steps 4000    base_loss: 0.312934    reg_loss: 0.120182    l2_loss: 0.282729    loss: 0.715845
steps 4000    v_Prec: 0.514978  v_Recall: 0.696047  v_F1: 0.591976  v_AUC: 0.873381
steps 4000    running time 363 seconds

steps 4200    base_loss: 0.298146    reg_loss: 0.115696    l2_loss: 0.269549    loss: 0.683391
steps 4200    v_Prec: 0.523092  v_Recall: 0.714328  v_F1: 0.603933  v_AUC: 0.881605
steps 4200    running time 375 seconds

steps 4400    base_loss: 0.299283    reg_loss: 0.114250    l2_loss: 0.257230    loss: 0.670763
steps 4400    v_Prec: 0.536249  v_Recall: 0.722678  v_F1: 0.615660  v_AUC: 0.889689
steps 4400    running time 388 seconds

steps 4600    base_loss: 0.288814    reg_loss: 0.109949    l2_loss: 0.246055    loss: 0.644818
steps 4600    v_Prec: 0.540290  v_Recall: 0.737426  v_F1: 0.623650  v_AUC: 0.895855
steps 4600    running time 400 seconds

steps 4800    base_loss: 0.284879    reg_loss: 0.106763    l2_loss: 0.234899    loss: 0.626542
steps 4800    v_Prec: 0.539542  v_Recall: 0.762129  v_F1: 0.631804  v_AUC: 0.901550
steps 4800    running time 412 seconds

steps 5000    base_loss: 0.267301    reg_loss: 0.103735    l2_loss: 0.223920    loss: 0.594956
steps 5000    v_Prec: 0.557619  v_Recall: 0.752964  v_F1: 0.640733  v_AUC: 0.906404
steps 5000    running time 424 seconds

steps 5200    base_loss: 0.271084    reg_loss: 0.102642    l2_loss: 0.215908    loss: 0.589634
steps 5200    v_Prec: 0.553976  v_Recall: 0.777619  v_F1: 0.647017  v_AUC: 0.909595
steps 5200    running time 437 seconds

steps 5400    base_loss: 0.266417    reg_loss: 0.101213    l2_loss: 0.207116    loss: 0.574746
steps 5400    v_Prec: 0.559939  v_Recall: 0.780830  v_F1: 0.652189  v_AUC: 0.912574
steps 5400    running time 449 seconds

steps 5600    base_loss: 0.262894    reg_loss: 0.098258    l2_loss: 0.197016    loss: 0.558168
steps 5600    v_Prec: 0.568971  v_Recall: 0.771146  v_F1: 0.654808  v_AUC: 0.914834
steps 5600    running time 461 seconds

steps 5800    base_loss: 0.260205    reg_loss: 0.096299    l2_loss: 0.187585    loss: 0.544090
steps 5800    v_Prec: 0.579187  v_Recall: 0.769269  v_F1: 0.660831  v_AUC: 0.917557
steps 5800    running time 473 seconds

steps 6000    base_loss: 0.259193    reg_loss: 0.094618    l2_loss: 0.179287    loss: 0.533097
steps 6000    v_Prec: 0.570777  v_Recall: 0.791798  v_F1: 0.663362  v_AUC: 0.919450
steps 6000    running time 485 seconds

steps 6200    base_loss: 0.256489    reg_loss: 0.093018    l2_loss: 0.170946    loss: 0.520453
steps 6200    v_Prec: 0.576305  v_Recall: 0.783622  v_F1: 0.664161  v_AUC: 0.920719
steps 6200    running time 497 seconds

steps 6400    base_loss: 0.256360    reg_loss: 0.092060    l2_loss: 0.163992    loss: 0.512412
steps 6400    v_Prec: 0.570261  v_Recall: 0.808720  v_F1: 0.668873  v_AUC: 0.922449
steps 6400    running time 509 seconds

steps 6600    base_loss: 0.246476    reg_loss: 0.088938    l2_loss: 0.156093    loss: 0.491507
steps 6600    v_Prec: 0.580483  v_Recall: 0.791453  v_F1: 0.669747  v_AUC: 0.923238
steps 6600    running time 522 seconds

steps 6800    base_loss: 0.245801    reg_loss: 0.087772    l2_loss: 0.149019    loss: 0.482591
steps 6800    v_Prec: 0.577444  v_Recall: 0.805583  v_F1: 0.672697  v_AUC: 0.924546
steps 6800    running time 534 seconds

steps 7000    base_loss: 0.249771    reg_loss: 0.086834    l2_loss: 0.143186    loss: 0.479791
steps 7000    v_Prec: 0.580537  v_Recall: 0.806398  v_F1: 0.675077  v_AUC: 0.925658
steps 7000    running time 546 seconds

steps 7200    base_loss: 0.244755    reg_loss: 0.085374    l2_loss: 0.136324    loss: 0.466453
steps 7200    v_Prec: 0.575706  v_Recall: 0.820282  v_F1: 0.676569  v_AUC: 0.927209
steps 7200    running time 558 seconds

steps 7400    base_loss: 0.241362    reg_loss: 0.084748    l2_loss: 0.131710    loss: 0.457819
steps 7400    v_Prec: 0.580545  v_Recall: 0.810870  v_F1: 0.676644  v_AUC: 0.927272
steps 7400    running time 570 seconds

steps 7600    base_loss: 0.241025    reg_loss: 0.084229    l2_loss: 0.126877    loss: 0.452131
steps 7600    v_Prec: 0.583680  v_Recall: 0.807880  v_F1: 0.677719  v_AUC: 0.927982
steps 7600    running time 583 seconds

steps 7800    base_loss: 0.238689    reg_loss: 0.083614    l2_loss: 0.121582    loss: 0.443886
steps 7800    v_Prec: 0.578984  v_Recall: 0.817787  v_F1: 0.677972  v_AUC: 0.928260
steps 7800    running time 595 seconds

steps 8000    base_loss: 0.237931    reg_loss: 0.080724    l2_loss: 0.115744    loss: 0.434400
steps 8000    v_Prec: 0.574345  v_Recall: 0.825692  v_F1: 0.677456  v_AUC: 0.928772
steps 8000    running time 607 seconds

steps 8200    base_loss: 0.243279    reg_loss: 0.080631    l2_loss: 0.112091    loss: 0.436002
steps 8200    v_Prec: 0.588737  v_Recall: 0.807856  v_F1: 0.681107  v_AUC: 0.929613
steps 8200    running time 618 seconds

steps 8400    base_loss: 0.235453    reg_loss: 0.080204    l2_loss: 0.108641    loss: 0.424298
steps 8400    v_Prec: 0.585686  v_Recall: 0.816502  v_F1: 0.682096  v_AUC: 0.930330
steps 8400    running time 631 seconds

steps 8600    base_loss: 0.233921    reg_loss: 0.079874    l2_loss: 0.104612    loss: 0.418407
steps 8600    v_Prec: 0.582716  v_Recall: 0.825346  v_F1: 0.683126  v_AUC: 0.930734
steps 8600    running time 643 seconds

steps 8800    base_loss: 0.236730    reg_loss: 0.078775    l2_loss: 0.101476    loss: 0.416980
steps 8800    v_Prec: 0.580490  v_Recall: 0.826581  v_F1: 0.682015  v_AUC: 0.930758
steps 8800    running time 655 seconds

steps 9000    base_loss: 0.235726    reg_loss: 0.077933    l2_loss: 0.099184    loss: 0.412844
steps 9000    v_Prec: 0.579657  v_Recall: 0.829076  v_F1: 0.682287  v_AUC: 0.930991
steps 9000    running time 666 seconds

steps 9200    base_loss: 0.234971    reg_loss: 0.076263    l2_loss: 0.095684    loss: 0.406918
steps 9200    v_Prec: 0.593494  v_Recall: 0.808078  v_F1: 0.684359  v_AUC: 0.931585
steps 9200    running time 678 seconds

steps 9400    base_loss: 0.242983    reg_loss: 0.077939    l2_loss: 0.093411    loss: 0.414333
steps 9400    v_Prec: 0.584576  v_Recall: 0.824457  v_F1: 0.684097  v_AUC: 0.931869
steps 9400    running time 690 seconds

steps 9600    base_loss: 0.236246    reg_loss: 0.077370    l2_loss: 0.090878    loss: 0.404494
steps 9600    v_Prec: 0.581234  v_Recall: 0.834017  v_F1: 0.685050  v_AUC: 0.932552
steps 9600    running time 701 seconds

steps 9800    base_loss: 0.235361    reg_loss: 0.076707    l2_loss: 0.088626    loss: 0.400694
steps 9800    v_Prec: 0.583862  v_Recall: 0.831744  v_F1: 0.686100  v_AUC: 0.932698
steps 9800    running time 714 seconds

steps 10000    base_loss: 0.233457    reg_loss: 0.075778    l2_loss: 0.085751    loss: 0.394986
steps 10000    v_Prec: 0.588745  v_Recall: 0.824926  v_F1: 0.687106  v_AUC: 0.932994
steps 10000    running time 726 seconds

steps 10200    base_loss: 0.235398    reg_loss: 0.075759    l2_loss: 0.083558    loss: 0.394715
steps 10200    v_Prec: 0.580133  v_Recall: 0.839674  v_F1: 0.686181  v_AUC: 0.932912
steps 10200    running time 738 seconds

steps 10400    base_loss: 0.235928    reg_loss: 0.074797    l2_loss: 0.082204    loss: 0.392929
steps 10400    v_Prec: 0.582367  v_Recall: 0.833844  v_F1: 0.685778  v_AUC: 0.932989
steps 10400    running time 749 seconds

steps 10600    base_loss: 0.237795    reg_loss: 0.075004    l2_loss: 0.081396    loss: 0.394195
steps 10600    v_Prec: 0.577144  v_Recall: 0.847752  v_F1: 0.686752  v_AUC: 0.933210
steps 10600    running time 761 seconds

steps 10800    base_loss: 0.234668    reg_loss: 0.074235    l2_loss: 0.079427    loss: 0.388331
steps 10800    v_Prec: 0.583865  v_Recall: 0.835845  v_F1: 0.687494  v_AUC: 0.933138
steps 10800    running time 772 seconds

steps 11000    base_loss: 0.238280    reg_loss: 0.075083    l2_loss: 0.078832    loss: 0.392196
steps 11000    v_Prec: 0.583071  v_Recall: 0.838439  v_F1: 0.687817  v_AUC: 0.933856
steps 11000    running time 785 seconds

steps 11200    base_loss: 0.236297    reg_loss: 0.074667    l2_loss: 0.078251    loss: 0.389215
steps 11200    v_Prec: 0.588788  v_Recall: 0.826877  v_F1: 0.687811  v_AUC: 0.933943
steps 11200    running time 797 seconds

steps 11400    base_loss: 0.227145    reg_loss: 0.073249    l2_loss: 0.076880    loss: 0.377274
steps 11400    v_Prec: 0.583221  v_Recall: 0.836191  v_F1: 0.687164  v_AUC: 0.933703
steps 11400    running time 808 seconds

steps 11600    base_loss: 0.237150    reg_loss: 0.073881    l2_loss: 0.075709    loss: 0.386740
steps 11600    v_Prec: 0.571963  v_Recall: 0.860870  v_F1: 0.687290  v_AUC: 0.933785
steps 11600    running time 820 seconds

steps 11800    base_loss: 0.231818    reg_loss: 0.073086    l2_loss: 0.074926    loss: 0.379830
steps 11800    v_Prec: 0.580248  v_Recall: 0.845158  v_F1: 0.688086  v_AUC: 0.933449
steps 11800    running time 831 seconds

steps 12000    base_loss: 0.234959    reg_loss: 0.073495    l2_loss: 0.074147    loss: 0.382601
steps 12000    v_Prec: 0.586549  v_Recall: 0.833572  v_F1: 0.688576  v_AUC: 0.933723
steps 12000    running time 843 seconds

steps 12200    base_loss: 0.230745    reg_loss: 0.072758    l2_loss: 0.073397    loss: 0.376900
steps 12200    v_Prec: 0.590496  v_Recall: 0.831275  v_F1: 0.690497  v_AUC: 0.934223
steps 12200    running time 855 seconds

steps 12400    base_loss: 0.229497    reg_loss: 0.072710    l2_loss: 0.073358    loss: 0.375565
steps 12400    v_Prec: 0.584289  v_Recall: 0.838068  v_F1: 0.688539  v_AUC: 0.934267
steps 12400    running time 867 seconds

steps 12600    base_loss: 0.231462    reg_loss: 0.072922    l2_loss: 0.072848    loss: 0.377232
steps 12600    v_Prec: 0.581863  v_Recall: 0.847381  v_F1: 0.689959  v_AUC: 0.934050
steps 12600    running time 879 seconds

steps 12800    base_loss: 0.232371    reg_loss: 0.072662    l2_loss: 0.073325    loss: 0.378358
steps 12800    v_Prec: 0.588796  v_Recall: 0.834264  v_F1: 0.690359  v_AUC: 0.934589
steps 12800    running time 890 seconds

steps 13000    base_loss: 0.227550    reg_loss: 0.071293    l2_loss: 0.071320    loss: 0.370163
steps 13000    v_Prec: 0.586890  v_Recall: 0.838710  v_F1: 0.690559  v_AUC: 0.934357
steps 13000    running time 902 seconds

steps 13200    base_loss: 0.237357    reg_loss: 0.072351    l2_loss: 0.071683    loss: 0.381391
steps 13200    v_Prec: 0.590314  v_Recall: 0.831966  v_F1: 0.690611  v_AUC: 0.934361
steps 13200    running time 914 seconds

steps 13400    base_loss: 0.227360    reg_loss: 0.071486    l2_loss: 0.071072    loss: 0.369918
steps 13400    v_Prec: 0.587719  v_Recall: 0.843626  v_F1: 0.692796  v_AUC: 0.934740
steps 13400    running time 926 seconds

steps 13600    base_loss: 0.231541    reg_loss: 0.070327    l2_loss: 0.069434    loss: 0.371302
steps 13600    v_Prec: 0.582782  v_Recall: 0.853039  v_F1: 0.692476  v_AUC: 0.934879
steps 13600    running time 938 seconds

steps 13800    base_loss: 0.232460    reg_loss: 0.071573    l2_loss: 0.070592    loss: 0.374626
steps 13800    v_Prec: 0.588053  v_Recall: 0.844121  v_F1: 0.693195  v_AUC: 0.935007
steps 13800    running time 950 seconds

steps 14000    base_loss: 0.232724    reg_loss: 0.071096    l2_loss: 0.069339    loss: 0.373159
steps 14000    v_Prec: 0.580991  v_Recall: 0.850346  v_F1: 0.690325  v_AUC: 0.934408
steps 14000    running time 962 seconds

steps 14200    base_loss: 0.231637    reg_loss: 0.070250    l2_loss: 0.069496    loss: 0.371382
steps 14200    v_Prec: 0.584992  v_Recall: 0.843528  v_F1: 0.690865  v_AUC: 0.934320
steps 14200    running time 973 seconds

steps 14400    base_loss: 0.230308    reg_loss: 0.071077    l2_loss: 0.069456    loss: 0.370840
steps 14400    v_Prec: 0.587336  v_Recall: 0.839550  v_F1: 0.691152  v_AUC: 0.934274
steps 14400    running time 985 seconds

steps 14600    base_loss: 0.231645    reg_loss: 0.070514    l2_loss: 0.069841    loss: 0.372000
steps 14600    v_Prec: 0.583882  v_Recall: 0.841206  v_F1: 0.689312  v_AUC: 0.933427
steps 14600    running time 996 seconds

steps 14800    base_loss: 0.229351    reg_loss: 0.068902    l2_loss: 0.068885    loss: 0.367138
steps 14800    v_Prec: 0.587387  v_Recall: 0.843948  v_F1: 0.692673  v_AUC: 0.933835
steps 14800    running time 1008 seconds

steps 15000    base_loss: 0.232570    reg_loss: 0.068486    l2_loss: 0.067724    loss: 0.368779
steps 15000    v_Prec: 0.589107  v_Recall: 0.842737  v_F1: 0.693459  v_AUC: 0.933923
steps 15000    running time 1019 seconds

steps 15200    base_loss: 0.227492    reg_loss: 0.068724    l2_loss: 0.068112    loss: 0.364328
steps 15200    v_Prec: 0.595526  v_Recall: 0.824086  v_F1: 0.691407  v_AUC: 0.933133
steps 15200    running time 1032 seconds

steps 15400    base_loss: 0.236218    reg_loss: 0.069450    l2_loss: 0.068599    loss: 0.374266
steps 15400    v_Prec: 0.584226  v_Recall: 0.844343  v_F1: 0.690603  v_AUC: 0.933569
steps 15400    running time 1043 seconds

steps 15600    base_loss: 0.228188    reg_loss: 0.067837    l2_loss: 0.067995    loss: 0.364020
steps 15600    v_Prec: 0.589981  v_Recall: 0.844862  v_F1: 0.694783  v_AUC: 0.934199
steps 15600    running time 1054 seconds

steps 15800    base_loss: 0.226747    reg_loss: 0.068143    l2_loss: 0.067566    loss: 0.362456
steps 15800    v_Prec: 0.594181  v_Recall: 0.836462  v_F1: 0.694806  v_AUC: 0.934097
steps 15800    running time 1066 seconds

steps 16000    base_loss: 0.229566    reg_loss: 0.067195    l2_loss: 0.067537    loss: 0.364298
steps 16000    v_Prec: 0.584168  v_Recall: 0.852989  v_F1: 0.693437  v_AUC: 0.933557
steps 16000    running time 1079 seconds

steps 16200    base_loss: 0.233891    reg_loss: 0.068727    l2_loss: 0.068001    loss: 0.370620
steps 16200    v_Prec: 0.588192  v_Recall: 0.844639  v_F1: 0.693466  v_AUC: 0.933174
steps 16200    running time 1090 seconds

steps 16400    base_loss: 0.232204    reg_loss: 0.067474    l2_loss: 0.068398    loss: 0.368076
steps 16400    v_Prec: 0.583751  v_Recall: 0.853607  v_F1: 0.693347  v_AUC: 0.933248
steps 16400    running time 1102 seconds

steps 16600    base_loss: 0.238912    reg_loss: 0.069070    l2_loss: 0.068763    loss: 0.376746
steps 16600    v_Prec: 0.587270  v_Recall: 0.845158  v_F1: 0.693000  v_AUC: 0.933484
steps 16600    running time 1113 seconds

steps 16800    base_loss: 0.232010    reg_loss: 0.066872    l2_loss: 0.068895    loss: 0.367777
steps 16800    v_Prec: 0.587641  v_Recall: 0.844516  v_F1: 0.693041  v_AUC: 0.933739
steps 16800    running time 1125 seconds

steps 17000    base_loss: 0.234851    reg_loss: 0.067475    l2_loss: 0.068160    loss: 0.370485
steps 17000    v_Prec: 0.595138  v_Recall: 0.832164  v_F1: 0.693970  v_AUC: 0.933348
steps 17000    running time 1136 seconds

steps 17200    base_loss: 0.235094    reg_loss: 0.067361    l2_loss: 0.068375    loss: 0.370831
steps 17200    v_Prec: 0.590741  v_Recall: 0.838538  v_F1: 0.693159  v_AUC: 0.933606
steps 17200    running time 1147 seconds

steps 17400    base_loss: 0.235548    reg_loss: 0.066706    l2_loss: 0.067294    loss: 0.369547
steps 17400    v_Prec: 0.590572  v_Recall: 0.838735  v_F1: 0.693110  v_AUC: 0.933117
steps 17400    running time 1159 seconds

steps 17600    base_loss: 0.237756    reg_loss: 0.067866    l2_loss: 0.067733    loss: 0.373354
steps 17600    v_Prec: 0.591658  v_Recall: 0.836067  v_F1: 0.692942  v_AUC: 0.932929
steps 17600    running time 1170 seconds

steps 17800    base_loss: 0.237332    reg_loss: 0.067152    l2_loss: 0.068030    loss: 0.372514
steps 17800    v_Prec: 0.588044  v_Recall: 0.845924  v_F1: 0.693796  v_AUC: 0.932332
steps 17800    running time 1182 seconds

Early stop model F1: 0.694806
testing thre: 0.2972767
testing Prec: 0.46126448534423997
testing Recall: 0.7854500079801512
testing F1: 0.581207960017393
testing AUC: 0.8820640164177743
overall running time 1191 seconds
(0.4718660390629227, 0.7592606027190552, 0.5820185853552738, 0.8820640164177743, 0.32899567)
2019-02-17 02:46:06.647469: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 02:46:06.963490: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 02:46:06.964412: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 21.69GiB
2019-02-17 02:46:06.964449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.000000 seconds
loading data in 111.350000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	128
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 1.386331    reg_loss: 0.215081    l2_loss: 0.883591    loss: 2.485003
steps 200    v_Prec: 0.157191  v_Recall: 0.999951  v_F1: 0.271675  v_AUC: 0.487243
steps 200    running time 129 seconds

steps 400    base_loss: 1.314556    reg_loss: 0.214224    l2_loss: 0.871102    loss: 2.399882
steps 400    v_Prec: 0.157192  v_Recall: 0.999852  v_F1: 0.271672  v_AUC: 0.501170
steps 400    running time 143 seconds

steps 600    base_loss: 1.175156    reg_loss: 0.211718    l2_loss: 0.843369    loss: 2.230242
steps 600    v_Prec: 0.157198  v_Recall: 0.999852  v_F1: 0.271682  v_AUC: 0.518960
steps 600    running time 155 seconds

steps 800    base_loss: 0.985968    reg_loss: 0.209214    l2_loss: 0.804679    loss: 1.999861
steps 800    v_Prec: 0.157195  v_Recall: 0.999803  v_F1: 0.271675  v_AUC: 0.523856
steps 800    running time 168 seconds

steps 1000    base_loss: 0.779285    reg_loss: 0.207203    l2_loss: 0.754738    loss: 1.741226
steps 1000    v_Prec: 0.157460  v_Recall: 0.992396  v_F1: 0.271794  v_AUC: 0.516695
steps 1000    running time 180 seconds

steps 1200    base_loss: 0.577471    reg_loss: 0.205477    l2_loss: 0.700410    loss: 1.483358
steps 1200    v_Prec: 0.158404  v_Recall: 0.976032  v_F1: 0.272571  v_AUC: 0.534884
steps 1200    running time 193 seconds

steps 1400    base_loss: 0.465336    reg_loss: 0.202125    l2_loss: 0.645823    loss: 1.313284
steps 1400    v_Prec: 0.176572  v_Recall: 0.726660  v_F1: 0.284108  v_AUC: 0.574084
steps 1400    running time 206 seconds

steps 1600    base_loss: 0.444477    reg_loss: 0.193402    l2_loss: 0.595297    loss: 1.233176
steps 1600    v_Prec: 0.198613  v_Recall: 0.642871  v_F1: 0.303470  v_AUC: 0.610678
steps 1600    running time 219 seconds

steps 1800    base_loss: 0.442429    reg_loss: 0.180558    l2_loss: 0.546023    loss: 1.169010
steps 1800    v_Prec: 0.226338  v_Recall: 0.582509  v_F1: 0.326004  v_AUC: 0.642140
steps 1800    running time 232 seconds

steps 2000    base_loss: 0.443018    reg_loss: 0.167252    l2_loss: 0.500809    loss: 1.111080
steps 2000    v_Prec: 0.268685  v_Recall: 0.538831  v_F1: 0.358570  v_AUC: 0.679904
steps 2000    running time 245 seconds

steps 2200    base_loss: 0.422814    reg_loss: 0.153409    l2_loss: 0.457325    loss: 1.033548
steps 2200    v_Prec: 0.326105  v_Recall: 0.565062  v_F1: 0.413547  v_AUC: 0.727568
steps 2200    running time 258 seconds

steps 2400    base_loss: 0.421019    reg_loss: 0.143900    l2_loss: 0.418322    loss: 0.983242
steps 2400    v_Prec: 0.363520  v_Recall: 0.586151  v_F1: 0.448740  v_AUC: 0.755656
steps 2400    running time 271 seconds

steps 2600    base_loss: 0.397432    reg_loss: 0.133603    l2_loss: 0.383557    loss: 0.914591
steps 2600    v_Prec: 0.393866  v_Recall: 0.584945  v_F1: 0.470755  v_AUC: 0.771769
steps 2600    running time 283 seconds

steps 2800    base_loss: 0.382160    reg_loss: 0.124986    l2_loss: 0.353372    loss: 0.860518
steps 2800    v_Prec: 0.429530  v_Recall: 0.574905  v_F1: 0.491697  v_AUC: 0.785843
steps 2800    running time 296 seconds

steps 3000    base_loss: 0.365611    reg_loss: 0.118122    l2_loss: 0.327679    loss: 0.811413
steps 3000    v_Prec: 0.437418  v_Recall: 0.605419  v_F1: 0.507886  v_AUC: 0.797260
steps 3000    running time 309 seconds

steps 3200    base_loss: 0.357584    reg_loss: 0.114223    l2_loss: 0.305385    loss: 0.777191
steps 3200    v_Prec: 0.451034  v_Recall: 0.627639  v_F1: 0.524880  v_AUC: 0.812936
steps 3200    running time 322 seconds

steps 3400    base_loss: 0.343340    reg_loss: 0.109411    l2_loss: 0.283989    loss: 0.736741
steps 3400    v_Prec: 0.471981  v_Recall: 0.631306  v_F1: 0.540139  v_AUC: 0.826051
steps 3400    running time 335 seconds

steps 3600    base_loss: 0.338836    reg_loss: 0.107533    l2_loss: 0.267959    loss: 0.714328
steps 3600    v_Prec: 0.510450  v_Recall: 0.617230  v_F1: 0.558785  v_AUC: 0.838331
steps 3600    running time 348 seconds

steps 3800    base_loss: 0.328598    reg_loss: 0.105332    l2_loss: 0.251733    loss: 0.685663
steps 3800    v_Prec: 0.518138  v_Recall: 0.644618  v_F1: 0.574499  v_AUC: 0.849209
steps 3800    running time 361 seconds

steps 4000    base_loss: 0.323872    reg_loss: 0.103006    l2_loss: 0.239030    loss: 0.665908
steps 4000    v_Prec: 0.529264  v_Recall: 0.673803  v_F1: 0.592851  v_AUC: 0.861286
steps 4000    running time 374 seconds

steps 4200    base_loss: 0.306021    reg_loss: 0.099836    l2_loss: 0.224522    loss: 0.630379
steps 4200    v_Prec: 0.544379  v_Recall: 0.678257  v_F1: 0.603988  v_AUC: 0.869830
steps 4200    running time 387 seconds

steps 4400    base_loss: 0.300517    reg_loss: 0.097675    l2_loss: 0.215174    loss: 0.613367
steps 4400    v_Prec: 0.548968  v_Recall: 0.693809  v_F1: 0.612948  v_AUC: 0.877938
steps 4400    running time 400 seconds

steps 4600    base_loss: 0.303611    reg_loss: 0.097589    l2_loss: 0.204887    loss: 0.606088
steps 4600    v_Prec: 0.563697  v_Recall: 0.706654  v_F1: 0.627132  v_AUC: 0.884294
steps 4600    running time 413 seconds

steps 4800    base_loss: 0.287585    reg_loss: 0.095003    l2_loss: 0.195984    loss: 0.578572
steps 4800    v_Prec: 0.565676  v_Recall: 0.722427  v_F1: 0.634514  v_AUC: 0.889279
steps 4800    running time 426 seconds

steps 5000    base_loss: 0.289994    reg_loss: 0.093892    l2_loss: 0.187953    loss: 0.571839
steps 5000    v_Prec: 0.563812  v_Recall: 0.741621  v_F1: 0.640607  v_AUC: 0.894068
steps 5000    running time 439 seconds

steps 5200    base_loss: 0.281308    reg_loss: 0.092132    l2_loss: 0.179784    loss: 0.553224
steps 5200    v_Prec: 0.570279  v_Recall: 0.748191  v_F1: 0.647232  v_AUC: 0.900024
steps 5200    running time 452 seconds

steps 5400    base_loss: 0.277959    reg_loss: 0.091207    l2_loss: 0.172987    loss: 0.542153
steps 5400    v_Prec: 0.574225  v_Recall: 0.757862  v_F1: 0.653386  v_AUC: 0.901129
steps 5400    running time 465 seconds

steps 5600    base_loss: 0.270266    reg_loss: 0.089419    l2_loss: 0.165660    loss: 0.525345
steps 5600    v_Prec: 0.583046  v_Recall: 0.756017  v_F1: 0.658359  v_AUC: 0.905554
steps 5600    running time 478 seconds

steps 5800    base_loss: 0.265957    reg_loss: 0.087801    l2_loss: 0.159315    loss: 0.513072
steps 5800    v_Prec: 0.581084  v_Recall: 0.767730  v_F1: 0.661493  v_AUC: 0.907659
steps 5800    running time 491 seconds

steps 6000    base_loss: 0.268156    reg_loss: 0.087600    l2_loss: 0.154456    loss: 0.510213
steps 6000    v_Prec: 0.588084  v_Recall: 0.763374  v_F1: 0.664361  v_AUC: 0.910408
steps 6000    running time 504 seconds

steps 6200    base_loss: 0.263436    reg_loss: 0.085941    l2_loss: 0.148245    loss: 0.497622
steps 6200    v_Prec: 0.576508  v_Recall: 0.790836  v_F1: 0.666874  v_AUC: 0.911266
steps 6200    running time 517 seconds

steps 6400    base_loss: 0.262186    reg_loss: 0.084950    l2_loss: 0.143211    loss: 0.490347
steps 6400    v_Prec: 0.585986  v_Recall: 0.784660  v_F1: 0.670924  v_AUC: 0.914809
steps 6400    running time 530 seconds

steps 6600    base_loss: 0.259868    reg_loss: 0.083813    l2_loss: 0.138787    loss: 0.482468
steps 6600    v_Prec: 0.586827  v_Recall: 0.789483  v_F1: 0.673235  v_AUC: 0.916888
steps 6600    running time 543 seconds

steps 6800    base_loss: 0.260170    reg_loss: 0.084569    l2_loss: 0.134700    loss: 0.479439
steps 6800    v_Prec: 0.586520  v_Recall: 0.798957  v_F1: 0.676452  v_AUC: 0.919616
steps 6800    running time 556 seconds

steps 7000    base_loss: 0.260075    reg_loss: 0.084915    l2_loss: 0.130873    loss: 0.475864
steps 7000    v_Prec: 0.581325  v_Recall: 0.813967  v_F1: 0.678252  v_AUC: 0.921166
steps 7000    running time 569 seconds

steps 7200    base_loss: 0.253898    reg_loss: 0.083248    l2_loss: 0.125276    loss: 0.462421
steps 7200    v_Prec: 0.582182  v_Recall: 0.816083  v_F1: 0.679569  v_AUC: 0.921625
steps 7200    running time 582 seconds

steps 7400    base_loss: 0.261073    reg_loss: 0.083564    l2_loss: 0.121933    loss: 0.466570
steps 7400    v_Prec: 0.586628  v_Recall: 0.812023  v_F1: 0.681164  v_AUC: 0.923657
steps 7400    running time 595 seconds

steps 7600    base_loss: 0.245408    reg_loss: 0.081069    l2_loss: 0.117622    loss: 0.444099
steps 7600    v_Prec: 0.588130  v_Recall: 0.812958  v_F1: 0.682505  v_AUC: 0.924194
steps 7600    running time 607 seconds

steps 7800    base_loss: 0.250822    reg_loss: 0.081556    l2_loss: 0.113935    loss: 0.446312
steps 7800    v_Prec: 0.588032  v_Recall: 0.817338  v_F1: 0.683978  v_AUC: 0.924751
steps 7800    running time 620 seconds

steps 8000    base_loss: 0.246400    reg_loss: 0.080142    l2_loss: 0.110837    loss: 0.437379
steps 8000    v_Prec: 0.584631  v_Recall: 0.826566  v_F1: 0.684860  v_AUC: 0.926352
steps 8000    running time 633 seconds

steps 8200    base_loss: 0.243518    reg_loss: 0.080010    l2_loss: 0.107719    loss: 0.431246
steps 8200    v_Prec: 0.589396  v_Recall: 0.821177  v_F1: 0.686244  v_AUC: 0.926839
steps 8200    running time 646 seconds

steps 8400    base_loss: 0.245055    reg_loss: 0.078639    l2_loss: 0.104480    loss: 0.428174
steps 8400    v_Prec: 0.583813  v_Recall: 0.833899  v_F1: 0.686798  v_AUC: 0.926918
steps 8400    running time 659 seconds

steps 8600    base_loss: 0.250968    reg_loss: 0.079432    l2_loss: 0.101948    loss: 0.432348
steps 8600    v_Prec: 0.589513  v_Recall: 0.821965  v_F1: 0.686598  v_AUC: 0.928119
steps 8600    running time 672 seconds

steps 8800    base_loss: 0.243398    reg_loss: 0.078782    l2_loss: 0.099308    loss: 0.421488
steps 8800    v_Prec: 0.592177  v_Recall: 0.818101  v_F1: 0.687043  v_AUC: 0.928542
steps 8800    running time 684 seconds

steps 9000    base_loss: 0.239574    reg_loss: 0.078328    l2_loss: 0.096566    loss: 0.414467
steps 9000    v_Prec: 0.589360  v_Recall: 0.823244  v_F1: 0.686940  v_AUC: 0.928385
steps 9000    running time 697 seconds

steps 9200    base_loss: 0.245249    reg_loss: 0.077692    l2_loss: 0.094187    loss: 0.417127
steps 9200    v_Prec: 0.587536  v_Recall: 0.834736  v_F1: 0.689654  v_AUC: 0.929441
steps 9200    running time 709 seconds

steps 9400    base_loss: 0.241130    reg_loss: 0.077551    l2_loss: 0.091772    loss: 0.410453
steps 9400    v_Prec: 0.587379  v_Recall: 0.834195  v_F1: 0.689361  v_AUC: 0.929278
steps 9400    running time 721 seconds

steps 9600    base_loss: 0.247195    reg_loss: 0.077474    l2_loss: 0.090722    loss: 0.415391
steps 9600    v_Prec: 0.585179  v_Recall: 0.840789  v_F1: 0.690074  v_AUC: 0.930409
steps 9600    running time 733 seconds

steps 9800    base_loss: 0.242938    reg_loss: 0.076858    l2_loss: 0.088713    loss: 0.408510
steps 9800    v_Prec: 0.586417  v_Recall: 0.840100  v_F1: 0.690702  v_AUC: 0.930519
steps 9800    running time 746 seconds

steps 10000    base_loss: 0.236844    reg_loss: 0.076038    l2_loss: 0.086302    loss: 0.399185
steps 10000    v_Prec: 0.588487  v_Recall: 0.835204  v_F1: 0.690468  v_AUC: 0.930782
steps 10000    running time 759 seconds

steps 10200    base_loss: 0.246329    reg_loss: 0.077134    l2_loss: 0.086000    loss: 0.409463
steps 10200    v_Prec: 0.586212  v_Recall: 0.839288  v_F1: 0.690285  v_AUC: 0.930586
steps 10200    running time 771 seconds

steps 10400    base_loss: 0.240248    reg_loss: 0.076907    l2_loss: 0.084121    loss: 0.401276
steps 10400    v_Prec: 0.590767  v_Recall: 0.833235  v_F1: 0.691358  v_AUC: 0.930699
steps 10400    running time 783 seconds

steps 10600    base_loss: 0.241741    reg_loss: 0.074980    l2_loss: 0.081724    loss: 0.398445
steps 10600    v_Prec: 0.590535  v_Recall: 0.834884  v_F1: 0.691766  v_AUC: 0.930847
steps 10600    running time 796 seconds

steps 10800    base_loss: 0.242698    reg_loss: 0.075403    l2_loss: 0.080576    loss: 0.398677
steps 10800    v_Prec: 0.589680  v_Recall: 0.835228  v_F1: 0.691297  v_AUC: 0.931057
steps 10800    running time 808 seconds

steps 11000    base_loss: 0.237909    reg_loss: 0.075121    l2_loss: 0.080269    loss: 0.393299
steps 11000    v_Prec: 0.590452  v_Recall: 0.838821  v_F1: 0.693057  v_AUC: 0.931312
steps 11000    running time 820 seconds

steps 11200    base_loss: 0.241776    reg_loss: 0.075752    l2_loss: 0.078635    loss: 0.396162
steps 11200    v_Prec: 0.589482  v_Recall: 0.844013  v_F1: 0.694150  v_AUC: 0.931659
steps 11200    running time 833 seconds

steps 11400    base_loss: 0.238256    reg_loss: 0.075006    l2_loss: 0.078143    loss: 0.391405
steps 11400    v_Prec: 0.581877  v_Recall: 0.852183  v_F1: 0.691555  v_AUC: 0.931153
steps 11400    running time 846 seconds

steps 11600    base_loss: 0.238507    reg_loss: 0.075608    l2_loss: 0.077431    loss: 0.391546
steps 11600    v_Prec: 0.582983  v_Recall: 0.856169  v_F1: 0.693647  v_AUC: 0.931425
steps 11600    running time 858 seconds

steps 11800    base_loss: 0.241786    reg_loss: 0.075917    l2_loss: 0.077413    loss: 0.395116
steps 11800    v_Prec: 0.588873  v_Recall: 0.842881  v_F1: 0.693345  v_AUC: 0.931222
steps 11800    running time 870 seconds

steps 12000    base_loss: 0.240326    reg_loss: 0.074125    l2_loss: 0.077381    loss: 0.391831
steps 12000    v_Prec: 0.595995  v_Recall: 0.831192  v_F1: 0.694214  v_AUC: 0.931382
steps 12000    running time 882 seconds

steps 12200    base_loss: 0.236324    reg_loss: 0.073807    l2_loss: 0.076159    loss: 0.386290
steps 12200    v_Prec: 0.589325  v_Recall: 0.845514  v_F1: 0.694548  v_AUC: 0.931571
steps 12200    running time 895 seconds

steps 12400    base_loss: 0.236102    reg_loss: 0.072861    l2_loss: 0.075153    loss: 0.384117
steps 12400    v_Prec: 0.589210  v_Recall: 0.847089  v_F1: 0.694999  v_AUC: 0.931354
steps 12400    running time 908 seconds

steps 12600    base_loss: 0.241858    reg_loss: 0.073225    l2_loss: 0.075292    loss: 0.390375
steps 12600    v_Prec: 0.589362  v_Recall: 0.845219  v_F1: 0.694474  v_AUC: 0.931458
steps 12600    running time 921 seconds

steps 12800    base_loss: 0.239518    reg_loss: 0.072789    l2_loss: 0.074258    loss: 0.386565
steps 12800    v_Prec: 0.588533  v_Recall: 0.849722  v_F1: 0.695411  v_AUC: 0.932429
steps 12800    running time 933 seconds

steps 13000    base_loss: 0.239617    reg_loss: 0.072806    l2_loss: 0.072819    loss: 0.385243
steps 13000    v_Prec: 0.596606  v_Recall: 0.834834  v_F1: 0.695897  v_AUC: 0.931856
steps 13000    running time 946 seconds

steps 13200    base_loss: 0.240265    reg_loss: 0.073864    l2_loss: 0.073613    loss: 0.387742
steps 13200    v_Prec: 0.600092  v_Recall: 0.831045  v_F1: 0.696933  v_AUC: 0.931712
steps 13200    running time 959 seconds

steps 13400    base_loss: 0.237780    reg_loss: 0.073356    l2_loss: 0.073625    loss: 0.384760
steps 13400    v_Prec: 0.591167  v_Recall: 0.845859  v_F1: 0.695943  v_AUC: 0.930793
steps 13400    running time 972 seconds

steps 13600    base_loss: 0.243677    reg_loss: 0.074809    l2_loss: 0.074085    loss: 0.392570
steps 13600    v_Prec: 0.595779  v_Recall: 0.833678  v_F1: 0.694932  v_AUC: 0.931898
steps 13600    running time 984 seconds

steps 13800    base_loss: 0.237960    reg_loss: 0.073560    l2_loss: 0.073994    loss: 0.385514
steps 13800    v_Prec: 0.591662  v_Recall: 0.843029  v_F1: 0.695325  v_AUC: 0.931217
steps 13800    running time 996 seconds

steps 14000    base_loss: 0.233362    reg_loss: 0.072350    l2_loss: 0.072184    loss: 0.377896
steps 14000    v_Prec: 0.597217  v_Recall: 0.832324  v_F1: 0.695438  v_AUC: 0.931382
steps 14000    running time 1008 seconds

steps 14200    base_loss: 0.242332    reg_loss: 0.072750    l2_loss: 0.072160    loss: 0.387242
steps 14200    v_Prec: 0.591368  v_Recall: 0.841257  v_F1: 0.694519  v_AUC: 0.930786
steps 14200    running time 1019 seconds

steps 14400    base_loss: 0.240491    reg_loss: 0.073048    l2_loss: 0.072878    loss: 0.386417
steps 14400    v_Prec: 0.594031  v_Recall: 0.834096  v_F1: 0.693886  v_AUC: 0.930206
steps 14400    running time 1031 seconds

steps 14600    base_loss: 0.238702    reg_loss: 0.072729    l2_loss: 0.072244    loss: 0.383675
steps 14600    v_Prec: 0.586707  v_Recall: 0.845440  v_F1: 0.692702  v_AUC: 0.930666
steps 14600    running time 1043 seconds

steps 14800    base_loss: 0.236684    reg_loss: 0.071984    l2_loss: 0.071421    loss: 0.380089
steps 14800    v_Prec: 0.591824  v_Recall: 0.839707  v_F1: 0.694304  v_AUC: 0.930619
steps 14800    running time 1055 seconds

steps 15000    base_loss: 0.235759    reg_loss: 0.073071    l2_loss: 0.071565    loss: 0.380394
steps 15000    v_Prec: 0.592501  v_Recall: 0.844210  v_F1: 0.696306  v_AUC: 0.931730
steps 15000    running time 1067 seconds

steps 15200    base_loss: 0.244570    reg_loss: 0.072112    l2_loss: 0.070993    loss: 0.387675
steps 15200    v_Prec: 0.587840  v_Recall: 0.848172  v_F1: 0.694408  v_AUC: 0.932070
steps 15200    running time 1079 seconds

Early stop model F1: 0.696933
testing thre: 0.23713085
testing Prec: 0.5514482020900189
testing Recall: 0.7779051377664282
testing F1: 0.6453880646423305
testing AUC: 0.8922711805872119
overall running time 1088 seconds
(0.5643712898003238, 0.7586802280872303, 0.6472572429458257, 0.8922711805872119, 0.27266225)
2019-02-17 02:59:38.311841: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 02:59:38.532051: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 02:59:38.532983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 21.69GiB
2019-02-17 02:59:38.533020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.870000 seconds
loading data in 111.730000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1.0
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 1.456000    reg_loss: 0.214468    l2_loss: 0.882778    loss: 2.553245
steps 200    v_Prec: 0.157835  v_Recall: 0.999461  v_F1: 0.272618  v_AUC: 0.503308
steps 200    running time 128 seconds

steps 400    base_loss: 1.417642    reg_loss: 0.214730    l2_loss: 0.883650    loss: 2.516021
steps 400    v_Prec: 0.157821  v_Recall: 1.000000  v_F1: 0.272618  v_AUC: 0.503277
steps 400    running time 140 seconds

steps 600    base_loss: 1.340326    reg_loss: 0.214957    l2_loss: 0.886711    loss: 2.441994
steps 600    v_Prec: 0.157822  v_Recall: 1.000000  v_F1: 0.272619  v_AUC: 0.503223
steps 600    running time 151 seconds

steps 800    base_loss: 1.215667    reg_loss: 0.214361    l2_loss: 0.885367    loss: 2.315396
steps 800    v_Prec: 0.157822  v_Recall: 1.000000  v_F1: 0.272619  v_AUC: 0.503066
steps 800    running time 163 seconds

steps 1000    base_loss: 1.069617    reg_loss: 0.214211    l2_loss: 0.886643    loss: 2.170471
steps 1000    v_Prec: 0.157822  v_Recall: 1.000000  v_F1: 0.272619  v_AUC: 0.502634
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.911157    reg_loss: 0.214884    l2_loss: 0.884576    loss: 2.010617
steps 1200    v_Prec: 0.157823  v_Recall: 1.000000  v_F1: 0.272620  v_AUC: 0.501915
steps 1200    running time 184 seconds

steps 1400    base_loss: 0.766654    reg_loss: 0.214824    l2_loss: 0.884374    loss: 1.865852
steps 1400    v_Prec: 0.157822  v_Recall: 1.000000  v_F1: 0.272619  v_AUC: 0.501377
steps 1400    running time 196 seconds

steps 1600    base_loss: 0.637684    reg_loss: 0.214726    l2_loss: 0.885080    loss: 1.737490
steps 1600    v_Prec: 0.157824  v_Recall: 0.999975  v_F1: 0.272620  v_AUC: 0.501510
steps 1600    running time 207 seconds

steps 1800    base_loss: 0.551210    reg_loss: 0.214600    l2_loss: 0.884326    loss: 1.650136
steps 1800    v_Prec: 0.157828  v_Recall: 0.999975  v_F1: 0.272627  v_AUC: 0.502124
steps 1800    running time 219 seconds

steps 2000    base_loss: 0.506157    reg_loss: 0.214415    l2_loss: 0.884118    loss: 1.604689
steps 2000    v_Prec: 0.157831  v_Recall: 0.999926  v_F1: 0.272629  v_AUC: 0.502834
steps 2000    running time 230 seconds

steps 2200    base_loss: 0.479810    reg_loss: 0.214100    l2_loss: 0.885691    loss: 1.579600
steps 2200    v_Prec: 0.157832  v_Recall: 0.999926  v_F1: 0.272632  v_AUC: 0.503495
steps 2200    running time 242 seconds

steps 2400    base_loss: 0.472448    reg_loss: 0.214342    l2_loss: 0.887381    loss: 1.574171
steps 2400    v_Prec: 0.157832  v_Recall: 0.999926  v_F1: 0.272632  v_AUC: 0.504019
steps 2400    running time 253 seconds

steps 2600    base_loss: 0.473809    reg_loss: 0.214705    l2_loss: 0.882656    loss: 1.571170
steps 2600    v_Prec: 0.157839  v_Recall: 0.999755  v_F1: 0.272635  v_AUC: 0.504438
steps 2600    running time 264 seconds

steps 2800    base_loss: 0.454936    reg_loss: 0.213954    l2_loss: 0.884835    loss: 1.553725
steps 2800    v_Prec: 0.157840  v_Recall: 0.999779  v_F1: 0.272638  v_AUC: 0.504842
steps 2800    running time 275 seconds

steps 3000    base_loss: 0.464305    reg_loss: 0.214428    l2_loss: 0.883662    loss: 1.562395
steps 3000    v_Prec: 0.157844  v_Recall: 0.999755  v_F1: 0.272642  v_AUC: 0.505155
steps 3000    running time 287 seconds

steps 3200    base_loss: 0.465100    reg_loss: 0.214757    l2_loss: 0.884145    loss: 1.564002
steps 3200    v_Prec: 0.157843  v_Recall: 0.999755  v_F1: 0.272641  v_AUC: 0.505424
steps 3200    running time 298 seconds

steps 3400    base_loss: 0.460585    reg_loss: 0.214459    l2_loss: 0.883211    loss: 1.558255
steps 3400    v_Prec: 0.157842  v_Recall: 0.999755  v_F1: 0.272639  v_AUC: 0.505674
steps 3400    running time 309 seconds

steps 3600    base_loss: 0.470664    reg_loss: 0.214776    l2_loss: 0.886769    loss: 1.572209
steps 3600    v_Prec: 0.157841  v_Recall: 0.999755  v_F1: 0.272638  v_AUC: 0.505881
steps 3600    running time 320 seconds

steps 3800    base_loss: 0.468531    reg_loss: 0.214716    l2_loss: 0.884180    loss: 1.567427
steps 3800    v_Prec: 0.157839  v_Recall: 0.999755  v_F1: 0.272635  v_AUC: 0.506077
steps 3800    running time 331 seconds

steps 4000    base_loss: 0.464825    reg_loss: 0.214605    l2_loss: 0.883193    loss: 1.562622
steps 4000    v_Prec: 0.157839  v_Recall: 0.999755  v_F1: 0.272635  v_AUC: 0.506259
steps 4000    running time 342 seconds

steps 4200    base_loss: 0.458441    reg_loss: 0.214116    l2_loss: 0.886636    loss: 1.559193
steps 4200    v_Prec: 0.157839  v_Recall: 0.999755  v_F1: 0.272635  v_AUC: 0.506461
steps 4200    running time 353 seconds

steps 4400    base_loss: 0.458579    reg_loss: 0.214352    l2_loss: 0.887545    loss: 1.560476
steps 4400    v_Prec: 0.157834  v_Recall: 0.999926  v_F1: 0.272634  v_AUC: 0.506686
steps 4400    running time 364 seconds

steps 4600    base_loss: 0.463331    reg_loss: 0.214657    l2_loss: 0.885387    loss: 1.563376
steps 4600    v_Prec: 0.157834  v_Recall: 0.999926  v_F1: 0.272634  v_AUC: 0.506860
steps 4600    running time 375 seconds

steps 4800    base_loss: 0.460430    reg_loss: 0.214430    l2_loss: 0.883644    loss: 1.558505
steps 4800    v_Prec: 0.157834  v_Recall: 0.999926  v_F1: 0.272634  v_AUC: 0.507004
steps 4800    running time 386 seconds

steps 5000    base_loss: 0.465340    reg_loss: 0.214710    l2_loss: 0.884333    loss: 1.564383
steps 5000    v_Prec: 0.157835  v_Recall: 0.999926  v_F1: 0.272635  v_AUC: 0.507187
steps 5000    running time 397 seconds

Early stop model F1: 0.272642
testing thre: 0.11197085
testing Prec: 0.1569853561157473
testing Recall: 0.9995211909287445
testing F1: 0.2713520135345128
testing AUC: 0.5124617879142953
overall running time 406 seconds
(0.15701547350003645, 1.0, 0.2714146475933565, 0.5124617879142953, 0.107287906)
2019-02-17 03:04:42.048517: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 03:04:42.319138: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 03:04:42.320069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 03:04:42.320104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 90.480000 seconds
loading data in 112.830000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	0.01
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 1.532820    reg_loss: 0.215768    l2_loss: 0.886609    loss: 2.635197
steps 200    v_Prec: 0.157511  v_Recall: 1.000000  v_F1: 0.272154  v_AUC: 0.494147
steps 200    running time 130 seconds

steps 400    base_loss: 1.431890    reg_loss: 0.216463    l2_loss: 0.883821    loss: 2.532173
steps 400    v_Prec: 0.157513  v_Recall: 1.000000  v_F1: 0.272158  v_AUC: 0.491426
steps 400    running time 141 seconds

steps 600    base_loss: 1.265977    reg_loss: 0.216411    l2_loss: 0.883115    loss: 2.365503
steps 600    v_Prec: 0.157511  v_Recall: 0.999975  v_F1: 0.272154  v_AUC: 0.489440
steps 600    running time 153 seconds

steps 800    base_loss: 1.040828    reg_loss: 0.216267    l2_loss: 0.882614    loss: 2.139709
steps 800    v_Prec: 0.157521  v_Recall: 0.999804  v_F1: 0.272162  v_AUC: 0.489671
steps 800    running time 164 seconds

steps 1000    base_loss: 0.828442    reg_loss: 0.216420    l2_loss: 0.883311    loss: 1.928173
steps 1000    v_Prec: 0.157509  v_Recall: 0.999951  v_F1: 0.272150  v_AUC: 0.491621
steps 1000    running time 176 seconds

steps 1200    base_loss: 0.650051    reg_loss: 0.216090    l2_loss: 0.883602    loss: 1.749742
steps 1200    v_Prec: 0.157514  v_Recall: 0.999902  v_F1: 0.272155  v_AUC: 0.491503
steps 1200    running time 187 seconds

steps 1400    base_loss: 0.496168    reg_loss: 0.216106    l2_loss: 0.881819    loss: 1.594092
steps 1400    v_Prec: 0.157526  v_Recall: 0.999902  v_F1: 0.272173  v_AUC: 0.501587
steps 1400    running time 198 seconds

steps 1600    base_loss: 0.457141    reg_loss: 0.216147    l2_loss: 0.882741    loss: 1.556029
steps 1600    v_Prec: 0.157561  v_Recall: 0.998060  v_F1: 0.272157  v_AUC: 0.509870
steps 1600    running time 210 seconds

steps 1800    base_loss: 0.450976    reg_loss: 0.215672    l2_loss: 0.880060    loss: 1.546709
steps 1800    v_Prec: 0.157553  v_Recall: 0.999190  v_F1: 0.272187  v_AUC: 0.516017
steps 1800    running time 221 seconds

steps 2000    base_loss: 0.442600    reg_loss: 0.214970    l2_loss: 0.878815    loss: 1.536385
steps 2000    v_Prec: 0.157634  v_Recall: 0.997446  v_F1: 0.272243  v_AUC: 0.523724
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.452512    reg_loss: 0.215325    l2_loss: 0.876570    loss: 1.544407
steps 2200    v_Prec: 0.158558  v_Recall: 0.970211  v_F1: 0.272571  v_AUC: 0.531555
steps 2200    running time 244 seconds

steps 2400    base_loss: 0.454821    reg_loss: 0.215231    l2_loss: 0.878309    loss: 1.548362
steps 2400    v_Prec: 0.160979  v_Recall: 0.912672  v_F1: 0.273684  v_AUC: 0.541656
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.442653    reg_loss: 0.214345    l2_loss: 0.874408    loss: 1.531405
steps 2600    v_Prec: 0.169405  v_Recall: 0.754789  v_F1: 0.276706  v_AUC: 0.553316
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.445743    reg_loss: 0.213854    l2_loss: 0.876080    loss: 1.535676
steps 2800    v_Prec: 0.173546  v_Recall: 0.738237  v_F1: 0.281028  v_AUC: 0.566075
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.448438    reg_loss: 0.213762    l2_loss: 0.871042    loss: 1.533242
steps 3000    v_Prec: 0.177411  v_Recall: 0.742927  v_F1: 0.286424  v_AUC: 0.580564
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.445936    reg_loss: 0.213158    l2_loss: 0.871075    loss: 1.530170
steps 3200    v_Prec: 0.196559  v_Recall: 0.569008  v_F1: 0.292185  v_AUC: 0.592651
steps 3200    running time 302 seconds

steps 3400    base_loss: 0.439487    reg_loss: 0.212471    l2_loss: 0.867978    loss: 1.519935
steps 3400    v_Prec: 0.209401  v_Recall: 0.547471  v_F1: 0.302933  v_AUC: 0.608865
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.430004    reg_loss: 0.211427    l2_loss: 0.866574    loss: 1.508005
steps 3600    v_Prec: 0.218850  v_Recall: 0.561616  v_F1: 0.314965  v_AUC: 0.624765
steps 3600    running time 325 seconds

steps 3800    base_loss: 0.431330    reg_loss: 0.210746    l2_loss: 0.863015    loss: 1.505090
steps 3800    v_Prec: 0.240137  v_Recall: 0.508080  v_F1: 0.326132  v_AUC: 0.638134
steps 3800    running time 337 seconds

steps 4000    base_loss: 0.430864    reg_loss: 0.210219    l2_loss: 0.862050    loss: 1.503132
steps 4000    v_Prec: 0.249113  v_Recall: 0.518713  v_F1: 0.336581  v_AUC: 0.648469
steps 4000    running time 348 seconds

steps 4200    base_loss: 0.422268    reg_loss: 0.209152    l2_loss: 0.860716    loss: 1.492136
steps 4200    v_Prec: 0.259735  v_Recall: 0.519082  v_F1: 0.346227  v_AUC: 0.657022
steps 4200    running time 360 seconds

steps 4400    base_loss: 0.426365    reg_loss: 0.208958    l2_loss: 0.856764    loss: 1.492087
steps 4400    v_Prec: 0.280767  v_Recall: 0.497176  v_F1: 0.358871  v_AUC: 0.667228
steps 4400    running time 372 seconds

steps 4600    base_loss: 0.424745    reg_loss: 0.207889    l2_loss: 0.854023    loss: 1.486657
steps 4600    v_Prec: 0.289376  v_Recall: 0.509799  v_F1: 0.369190  v_AUC: 0.675005
steps 4600    running time 383 seconds

steps 4800    base_loss: 0.412658    reg_loss: 0.206326    l2_loss: 0.852264    loss: 1.471248
steps 4800    v_Prec: 0.301741  v_Recall: 0.516184  v_F1: 0.380851  v_AUC: 0.682449
steps 4800    running time 395 seconds

steps 5000    base_loss: 0.415933    reg_loss: 0.205789    l2_loss: 0.848683    loss: 1.470405
steps 5000    v_Prec: 0.310733  v_Recall: 0.526842  v_F1: 0.390907  v_AUC: 0.688255
steps 5000    running time 406 seconds

steps 5200    base_loss: 0.408452    reg_loss: 0.204673    l2_loss: 0.848931    loss: 1.462057
steps 5200    v_Prec: 0.316506  v_Recall: 0.534897  v_F1: 0.397692  v_AUC: 0.692018
steps 5200    running time 418 seconds

steps 5400    base_loss: 0.406755    reg_loss: 0.203356    l2_loss: 0.844307    loss: 1.454418
steps 5400    v_Prec: 0.321307  v_Recall: 0.546316  v_F1: 0.404635  v_AUC: 0.695758
steps 5400    running time 430 seconds

steps 5600    base_loss: 0.406768    reg_loss: 0.202550    l2_loss: 0.842056    loss: 1.451374
steps 5600    v_Prec: 0.326551  v_Recall: 0.548207  v_F1: 0.409296  v_AUC: 0.698248
steps 5600    running time 441 seconds

steps 5800    base_loss: 0.404038    reg_loss: 0.200410    l2_loss: 0.840004    loss: 1.444452
steps 5800    v_Prec: 0.331484  v_Recall: 0.550295  v_F1: 0.413741  v_AUC: 0.700549
steps 5800    running time 453 seconds

steps 6000    base_loss: 0.404283    reg_loss: 0.199850    l2_loss: 0.834707    loss: 1.438841
steps 6000    v_Prec: 0.337913  v_Recall: 0.550221  v_F1: 0.418691  v_AUC: 0.702898
steps 6000    running time 465 seconds

steps 6200    base_loss: 0.393239    reg_loss: 0.198028    l2_loss: 0.831154    loss: 1.422420
steps 6200    v_Prec: 0.340796  v_Recall: 0.556655  v_F1: 0.422766  v_AUC: 0.704888
steps 6200    running time 476 seconds

steps 6400    base_loss: 0.397349    reg_loss: 0.197107    l2_loss: 0.829078    loss: 1.423535
steps 6400    v_Prec: 0.346190  v_Recall: 0.551719  v_F1: 0.425432  v_AUC: 0.706167
steps 6400    running time 488 seconds

steps 6600    base_loss: 0.401028    reg_loss: 0.195985    l2_loss: 0.825969    loss: 1.422982
steps 6600    v_Prec: 0.349545  v_Recall: 0.552456  v_F1: 0.428177  v_AUC: 0.707561
steps 6600    running time 500 seconds

steps 6800    base_loss: 0.394957    reg_loss: 0.193654    l2_loss: 0.823001    loss: 1.411612
steps 6800    v_Prec: 0.352526  v_Recall: 0.560388  v_F1: 0.432793  v_AUC: 0.709742
steps 6800    running time 512 seconds

steps 7000    base_loss: 0.398077    reg_loss: 0.193015    l2_loss: 0.821406    loss: 1.412498
steps 7000    v_Prec: 0.356045  v_Recall: 0.558865  v_F1: 0.434975  v_AUC: 0.710352
steps 7000    running time 523 seconds

steps 7200    base_loss: 0.390038    reg_loss: 0.190890    l2_loss: 0.816151    loss: 1.397079
steps 7200    v_Prec: 0.357144  v_Recall: 0.565300  v_F1: 0.437736  v_AUC: 0.711430
steps 7200    running time 535 seconds

steps 7400    base_loss: 0.394018    reg_loss: 0.189468    l2_loss: 0.812663    loss: 1.396150
steps 7400    v_Prec: 0.362928  v_Recall: 0.560167  v_F1: 0.440475  v_AUC: 0.712202
steps 7400    running time 547 seconds

steps 7600    base_loss: 0.392437    reg_loss: 0.188096    l2_loss: 0.808256    loss: 1.388789
steps 7600    v_Prec: 0.365828  v_Recall: 0.558202  v_F1: 0.441990  v_AUC: 0.712810
steps 7600    running time 558 seconds

steps 7800    base_loss: 0.387902    reg_loss: 0.185757    l2_loss: 0.804598    loss: 1.378257
steps 7800    v_Prec: 0.374100  v_Recall: 0.549877  v_F1: 0.445269  v_AUC: 0.713947
steps 7800    running time 570 seconds

steps 8000    base_loss: 0.394706    reg_loss: 0.184671    l2_loss: 0.801295    loss: 1.380672
steps 8000    v_Prec: 0.374118  v_Recall: 0.554691  v_F1: 0.446851  v_AUC: 0.714489
steps 8000    running time 581 seconds

steps 8200    base_loss: 0.394326    reg_loss: 0.182718    l2_loss: 0.796270    loss: 1.373314
steps 8200    v_Prec: 0.377060  v_Recall: 0.552996  v_F1: 0.448387  v_AUC: 0.714680
steps 8200    running time 593 seconds

steps 8400    base_loss: 0.385650    reg_loss: 0.180330    l2_loss: 0.795295    loss: 1.361275
steps 8400    v_Prec: 0.383209  v_Recall: 0.546807  v_F1: 0.450619  v_AUC: 0.715541
steps 8400    running time 604 seconds

steps 8600    base_loss: 0.391694    reg_loss: 0.178990    l2_loss: 0.789728    loss: 1.360412
steps 8600    v_Prec: 0.384689  v_Recall: 0.546537  v_F1: 0.451548  v_AUC: 0.715685
steps 8600    running time 616 seconds

steps 8800    base_loss: 0.388971    reg_loss: 0.176872    l2_loss: 0.785684    loss: 1.351527
steps 8800    v_Prec: 0.384128  v_Recall: 0.556655  v_F1: 0.454572  v_AUC: 0.716736
steps 8800    running time 627 seconds

steps 9000    base_loss: 0.387177    reg_loss: 0.174960    l2_loss: 0.782442    loss: 1.344579
steps 9000    v_Prec: 0.384023  v_Recall: 0.560756  v_F1: 0.455859  v_AUC: 0.717024
steps 9000    running time 639 seconds

steps 9200    base_loss: 0.390146    reg_loss: 0.174009    l2_loss: 0.778539    loss: 1.342694
steps 9200    v_Prec: 0.385848  v_Recall: 0.562426  v_F1: 0.457697  v_AUC: 0.717670
steps 9200    running time 651 seconds

steps 9400    base_loss: 0.390343    reg_loss: 0.171780    l2_loss: 0.775794    loss: 1.337917
steps 9400    v_Prec: 0.388183  v_Recall: 0.561960  v_F1: 0.459180  v_AUC: 0.718183
steps 9400    running time 662 seconds

steps 9600    base_loss: 0.397970    reg_loss: 0.170527    l2_loss: 0.770990    loss: 1.339486
steps 9600    v_Prec: 0.394201  v_Recall: 0.557932  v_F1: 0.461989  v_AUC: 0.718939
steps 9600    running time 674 seconds

steps 9800    base_loss: 0.390944    reg_loss: 0.168487    l2_loss: 0.765985    loss: 1.325415
steps 9800    v_Prec: 0.393435  v_Recall: 0.561321  v_F1: 0.462617  v_AUC: 0.719374
steps 9800    running time 686 seconds

steps 10000    base_loss: 0.383440    reg_loss: 0.165755    l2_loss: 0.765649    loss: 1.314844
steps 10000    v_Prec: 0.400737  v_Recall: 0.550147  v_F1: 0.463704  v_AUC: 0.719806
steps 10000    running time 698 seconds

steps 10200    base_loss: 0.385390    reg_loss: 0.163420    l2_loss: 0.757657    loss: 1.306467
steps 10200    v_Prec: 0.402277  v_Recall: 0.550098  v_F1: 0.464716  v_AUC: 0.720335
steps 10200    running time 709 seconds

steps 10400    base_loss: 0.383722    reg_loss: 0.162062    l2_loss: 0.755142    loss: 1.300925
steps 10400    v_Prec: 0.402727  v_Recall: 0.550516  v_F1: 0.465165  v_AUC: 0.720672
steps 10400    running time 720 seconds

steps 10600    base_loss: 0.382437    reg_loss: 0.160010    l2_loss: 0.752483    loss: 1.294930
steps 10600    v_Prec: 0.404024  v_Recall: 0.551326  v_F1: 0.466319  v_AUC: 0.721241
steps 10600    running time 732 seconds

steps 10800    base_loss: 0.386382    reg_loss: 0.158451    l2_loss: 0.746580    loss: 1.291413
steps 10800    v_Prec: 0.405170  v_Recall: 0.555796  v_F1: 0.468678  v_AUC: 0.722288
steps 10800    running time 744 seconds

steps 11000    base_loss: 0.392154    reg_loss: 0.158625    l2_loss: 0.743994    loss: 1.294773
steps 11000    v_Prec: 0.406453  v_Recall: 0.555280  v_F1: 0.469351  v_AUC: 0.722913
steps 11000    running time 755 seconds

steps 11200    base_loss: 0.378030    reg_loss: 0.155300    l2_loss: 0.739989    loss: 1.273318
steps 11200    v_Prec: 0.408489  v_Recall: 0.554249  v_F1: 0.470334  v_AUC: 0.723476
steps 11200    running time 767 seconds

steps 11400    base_loss: 0.385485    reg_loss: 0.153714    l2_loss: 0.734391    loss: 1.273591
steps 11400    v_Prec: 0.409327  v_Recall: 0.556532  v_F1: 0.471712  v_AUC: 0.724445
steps 11400    running time 779 seconds

steps 11600    base_loss: 0.381085    reg_loss: 0.151946    l2_loss: 0.729776    loss: 1.262807
steps 11600    v_Prec: 0.408114  v_Recall: 0.559283  v_F1: 0.471888  v_AUC: 0.724809
steps 11600    running time 790 seconds

steps 11800    base_loss: 0.380309    reg_loss: 0.150915    l2_loss: 0.727937    loss: 1.259161
steps 11800    v_Prec: 0.408904  v_Recall: 0.555305  v_F1: 0.470990  v_AUC: 0.725074
steps 11800    running time 802 seconds

steps 12000    base_loss: 0.380607    reg_loss: 0.149185    l2_loss: 0.724409    loss: 1.254201
steps 12000    v_Prec: 0.407780  v_Recall: 0.564563  v_F1: 0.473531  v_AUC: 0.726391
steps 12000    running time 813 seconds

steps 12200    base_loss: 0.376186    reg_loss: 0.147088    l2_loss: 0.717884    loss: 1.241158
steps 12200    v_Prec: 0.407625  v_Recall: 0.566601  v_F1: 0.474142  v_AUC: 0.727059
steps 12200    running time 825 seconds

steps 12400    base_loss: 0.381833    reg_loss: 0.146916    l2_loss: 0.716699    loss: 1.245449
steps 12400    v_Prec: 0.406863  v_Recall: 0.571316  v_F1: 0.475265  v_AUC: 0.727943
steps 12400    running time 837 seconds

steps 12600    base_loss: 0.378717    reg_loss: 0.144913    l2_loss: 0.711985    loss: 1.235614
steps 12600    v_Prec: 0.409573  v_Recall: 0.567608  v_F1: 0.475811  v_AUC: 0.728482
steps 12600    running time 848 seconds

steps 12800    base_loss: 0.375798    reg_loss: 0.144223    l2_loss: 0.709865    loss: 1.229887
steps 12800    v_Prec: 0.410793  v_Recall: 0.571832  v_F1: 0.478117  v_AUC: 0.730071
steps 12800    running time 860 seconds

steps 13000    base_loss: 0.381534    reg_loss: 0.143174    l2_loss: 0.703901    loss: 1.228609
steps 13000    v_Prec: 0.418947  v_Recall: 0.559086  v_F1: 0.478977  v_AUC: 0.730894
steps 13000    running time 872 seconds

steps 13200    base_loss: 0.372455    reg_loss: 0.141006    l2_loss: 0.698829    loss: 1.212289
steps 13200    v_Prec: 0.411848  v_Recall: 0.572986  v_F1: 0.479234  v_AUC: 0.731611
steps 13200    running time 883 seconds

steps 13400    base_loss: 0.373980    reg_loss: 0.139991    l2_loss: 0.695389    loss: 1.209359
steps 13400    v_Prec: 0.413877  v_Recall: 0.570727  v_F1: 0.479808  v_AUC: 0.732777
steps 13400    running time 895 seconds

steps 13600    base_loss: 0.379684    reg_loss: 0.139574    l2_loss: 0.692973    loss: 1.212231
steps 13600    v_Prec: 0.419206  v_Recall: 0.565496  v_F1: 0.481485  v_AUC: 0.734062
steps 13600    running time 907 seconds

steps 13800    base_loss: 0.384711    reg_loss: 0.139370    l2_loss: 0.688534    loss: 1.212615
steps 13800    v_Prec: 0.419519  v_Recall: 0.567731  v_F1: 0.482500  v_AUC: 0.735464
steps 13800    running time 918 seconds

steps 14000    base_loss: 0.380888    reg_loss: 0.137564    l2_loss: 0.686041    loss: 1.204493
steps 14000    v_Prec: 0.420764  v_Recall: 0.566822  v_F1: 0.482992  v_AUC: 0.736041
steps 14000    running time 930 seconds

steps 14200    base_loss: 0.375345    reg_loss: 0.137117    l2_loss: 0.684045    loss: 1.196506
steps 14200    v_Prec: 0.423465  v_Recall: 0.562942  v_F1: 0.483342  v_AUC: 0.736996
steps 14200    running time 942 seconds

steps 14400    base_loss: 0.376358    reg_loss: 0.135813    l2_loss: 0.676922    loss: 1.189093
steps 14400    v_Prec: 0.421489  v_Recall: 0.569745  v_F1: 0.484530  v_AUC: 0.738371
steps 14400    running time 953 seconds

steps 14600    base_loss: 0.373042    reg_loss: 0.135182    l2_loss: 0.674960    loss: 1.183184
steps 14600    v_Prec: 0.425775  v_Recall: 0.566306  v_F1: 0.486088  v_AUC: 0.740202
steps 14600    running time 965 seconds

steps 14800    base_loss: 0.379084    reg_loss: 0.134952    l2_loss: 0.669969    loss: 1.184004
steps 14800    v_Prec: 0.424944  v_Recall: 0.568468  v_F1: 0.486338  v_AUC: 0.741628
steps 14800    running time 977 seconds

steps 15000    base_loss: 0.375568    reg_loss: 0.133312    l2_loss: 0.668655    loss: 1.177534
steps 15000    v_Prec: 0.425661  v_Recall: 0.570629  v_F1: 0.487598  v_AUC: 0.742794
steps 15000    running time 988 seconds

steps 15200    base_loss: 0.381738    reg_loss: 0.133997    l2_loss: 0.662582    loss: 1.178317
steps 15200    v_Prec: 0.426100  v_Recall: 0.571709  v_F1: 0.488281  v_AUC: 0.744369
steps 15200    running time 1000 seconds

steps 15400    base_loss: 0.370354    reg_loss: 0.131915    l2_loss: 0.660686    loss: 1.162956
steps 15400    v_Prec: 0.424933  v_Recall: 0.576916  v_F1: 0.489396  v_AUC: 0.746055
steps 15400    running time 1012 seconds

steps 15600    base_loss: 0.369698    reg_loss: 0.130578    l2_loss: 0.657147    loss: 1.157423
steps 15600    v_Prec: 0.421532  v_Recall: 0.587205  v_F1: 0.490764  v_AUC: 0.747715
steps 15600    running time 1023 seconds

steps 15800    base_loss: 0.369538    reg_loss: 0.130879    l2_loss: 0.652311    loss: 1.152728
steps 15800    v_Prec: 0.423542  v_Recall: 0.584430  v_F1: 0.491146  v_AUC: 0.749277
steps 15800    running time 1035 seconds

steps 16000    base_loss: 0.370071    reg_loss: 0.130053    l2_loss: 0.650346    loss: 1.150469
steps 16000    v_Prec: 0.422462  v_Recall: 0.588802  v_F1: 0.491952  v_AUC: 0.751039
steps 16000    running time 1046 seconds

steps 16200    base_loss: 0.375110    reg_loss: 0.130672    l2_loss: 0.644805    loss: 1.150587
steps 16200    v_Prec: 0.423731  v_Recall: 0.587844  v_F1: 0.492475  v_AUC: 0.752436
steps 16200    running time 1058 seconds

steps 16400    base_loss: 0.365539    reg_loss: 0.129067    l2_loss: 0.645430    loss: 1.140036
steps 16400    v_Prec: 0.425428  v_Recall: 0.586812  v_F1: 0.493255  v_AUC: 0.753755
steps 16400    running time 1070 seconds

steps 16600    base_loss: 0.373161    reg_loss: 0.128653    l2_loss: 0.641249    loss: 1.143064
steps 16600    v_Prec: 0.424017  v_Recall: 0.596415  v_F1: 0.495653  v_AUC: 0.756224
steps 16600    running time 1081 seconds

steps 16800    base_loss: 0.364386    reg_loss: 0.128009    l2_loss: 0.636617    loss: 1.129012
steps 16800    v_Prec: 0.424282  v_Recall: 0.597225  v_F1: 0.496114  v_AUC: 0.757415
steps 16800    running time 1093 seconds

steps 17000    base_loss: 0.363796    reg_loss: 0.126913    l2_loss: 0.632437    loss: 1.123146
steps 17000    v_Prec: 0.424783  v_Recall: 0.596783  v_F1: 0.496303  v_AUC: 0.759079
steps 17000    running time 1104 seconds

steps 17200    base_loss: 0.365775    reg_loss: 0.127437    l2_loss: 0.628943    loss: 1.122155
steps 17200    v_Prec: 0.428463  v_Recall: 0.595555  v_F1: 0.498376  v_AUC: 0.761207
steps 17200    running time 1116 seconds

steps 17400    base_loss: 0.363479    reg_loss: 0.126485    l2_loss: 0.627152    loss: 1.117116
steps 17400    v_Prec: 0.425805  v_Recall: 0.603143  v_F1: 0.499192  v_AUC: 0.762466
steps 17400    running time 1128 seconds

steps 17600    base_loss: 0.359201    reg_loss: 0.125425    l2_loss: 0.622353    loss: 1.106979
steps 17600    v_Prec: 0.429270  v_Recall: 0.603856  v_F1: 0.501811  v_AUC: 0.764865
steps 17600    running time 1139 seconds

steps 17800    base_loss: 0.367216    reg_loss: 0.126834    l2_loss: 0.618247    loss: 1.112297
steps 17800    v_Prec: 0.430789  v_Recall: 0.605992  v_F1: 0.503587  v_AUC: 0.766631
steps 17800    running time 1151 seconds

steps 18000    base_loss: 0.363446    reg_loss: 0.125856    l2_loss: 0.616796    loss: 1.106097
steps 18000    v_Prec: 0.432498  v_Recall: 0.603659  v_F1: 0.503941  v_AUC: 0.768475
steps 18000    running time 1162 seconds

steps 18200    base_loss: 0.360683    reg_loss: 0.125322    l2_loss: 0.612192    loss: 1.098198
steps 18200    v_Prec: 0.430348  v_Recall: 0.610265  v_F1: 0.504753  v_AUC: 0.770335
steps 18200    running time 1174 seconds

steps 18400    base_loss: 0.356305    reg_loss: 0.124695    l2_loss: 0.610504    loss: 1.091504
steps 18400    v_Prec: 0.433312  v_Recall: 0.608030  v_F1: 0.506014  v_AUC: 0.772469
steps 18400    running time 1186 seconds

steps 18600    base_loss: 0.360642    reg_loss: 0.125842    l2_loss: 0.607565    loss: 1.094050
steps 18600    v_Prec: 0.436696  v_Recall: 0.607932  v_F1: 0.508280  v_AUC: 0.775046
steps 18600    running time 1198 seconds

steps 18800    base_loss: 0.359715    reg_loss: 0.124597    l2_loss: 0.605512    loss: 1.089824
steps 18800    v_Prec: 0.438637  v_Recall: 0.608006  v_F1: 0.509618  v_AUC: 0.777042
steps 18800    running time 1209 seconds

steps 19000    base_loss: 0.355883    reg_loss: 0.124554    l2_loss: 0.601308    loss: 1.081745
steps 19000    v_Prec: 0.442597  v_Recall: 0.606115  v_F1: 0.511608  v_AUC: 0.779197
steps 19000    running time 1221 seconds

steps 19200    base_loss: 0.354983    reg_loss: 0.124323    l2_loss: 0.599095    loss: 1.078400
steps 19200    v_Prec: 0.440181  v_Recall: 0.615496  v_F1: 0.513281  v_AUC: 0.781299
steps 19200    running time 1233 seconds

steps 19400    base_loss: 0.346073    reg_loss: 0.122708    l2_loss: 0.596702    loss: 1.065482
steps 19400    v_Prec: 0.446781  v_Recall: 0.608399  v_F1: 0.515213  v_AUC: 0.783323
steps 19400    running time 1244 seconds

steps 19600    base_loss: 0.358139    reg_loss: 0.124003    l2_loss: 0.591509    loss: 1.073651
steps 19600    v_Prec: 0.451977  v_Recall: 0.606139  v_F1: 0.517828  v_AUC: 0.785879
steps 19600    running time 1256 seconds

steps 19800    base_loss: 0.351019    reg_loss: 0.123141    l2_loss: 0.590238    loss: 1.064397
steps 19800    v_Prec: 0.451925  v_Recall: 0.605648  v_F1: 0.517614  v_AUC: 0.787147
steps 19800    running time 1268 seconds

steps 20000    base_loss: 0.353286    reg_loss: 0.123321    l2_loss: 0.586635    loss: 1.063242
steps 20000    v_Prec: 0.456662  v_Recall: 0.604101  v_F1: 0.520135  v_AUC: 0.789174
steps 20000    running time 1279 seconds

steps 20200    base_loss: 0.346724    reg_loss: 0.122491    l2_loss: 0.583811    loss: 1.053026
steps 20200    v_Prec: 0.462863  v_Recall: 0.597323  v_F1: 0.521567  v_AUC: 0.791013
steps 20200    running time 1291 seconds

steps 20400    base_loss: 0.345697    reg_loss: 0.122743    l2_loss: 0.585240    loss: 1.053680
steps 20400    v_Prec: 0.464200  v_Recall: 0.601031  v_F1: 0.523827  v_AUC: 0.793507
steps 20400    running time 1302 seconds

steps 20600    base_loss: 0.348428    reg_loss: 0.123377    l2_loss: 0.579593    loss: 1.051398
steps 20600    v_Prec: 0.466153  v_Recall: 0.597471  v_F1: 0.523705  v_AUC: 0.794911
steps 20600    running time 1314 seconds

steps 20800    base_loss: 0.341470    reg_loss: 0.121554    l2_loss: 0.578280    loss: 1.041304
steps 20800    v_Prec: 0.472747  v_Recall: 0.592559  v_F1: 0.525915  v_AUC: 0.796959
steps 20800    running time 1325 seconds

steps 21000    base_loss: 0.339614    reg_loss: 0.121613    l2_loss: 0.579079    loss: 1.040306
steps 21000    v_Prec: 0.473589  v_Recall: 0.593615  v_F1: 0.526853  v_AUC: 0.798698
steps 21000    running time 1336 seconds

steps 21200    base_loss: 0.345756    reg_loss: 0.122340    l2_loss: 0.573563    loss: 1.041659
steps 21200    v_Prec: 0.479494  v_Recall: 0.590619  v_F1: 0.529287  v_AUC: 0.800911
steps 21200    running time 1348 seconds

steps 21400    base_loss: 0.338118    reg_loss: 0.121520    l2_loss: 0.571345    loss: 1.030984
steps 21400    v_Prec: 0.475195  v_Recall: 0.604298  v_F1: 0.532026  v_AUC: 0.801983
steps 21400    running time 1360 seconds

steps 21600    base_loss: 0.345973    reg_loss: 0.122770    l2_loss: 0.571405    loss: 1.040148
steps 21600    v_Prec: 0.486204  v_Recall: 0.588531  v_F1: 0.532496  v_AUC: 0.803781
steps 21600    running time 1371 seconds

steps 21800    base_loss: 0.344382    reg_loss: 0.121461    l2_loss: 0.565782    loss: 1.031624
steps 21800    v_Prec: 0.474449  v_Recall: 0.609921  v_F1: 0.533723  v_AUC: 0.805863
steps 21800    running time 1383 seconds

steps 22000    base_loss: 0.338739    reg_loss: 0.121181    l2_loss: 0.565684    loss: 1.025604
steps 22000    v_Prec: 0.486229  v_Recall: 0.596144  v_F1: 0.535606  v_AUC: 0.807466
steps 22000    running time 1395 seconds

steps 22200    base_loss: 0.335466    reg_loss: 0.119922    l2_loss: 0.564632    loss: 1.020019
steps 22200    v_Prec: 0.480212  v_Recall: 0.608792  v_F1: 0.536911  v_AUC: 0.808851
steps 22200    running time 1407 seconds

steps 22400    base_loss: 0.336674    reg_loss: 0.120766    l2_loss: 0.562953    loss: 1.020393
steps 22400    v_Prec: 0.492892  v_Recall: 0.596857  v_F1: 0.539915  v_AUC: 0.810377
steps 22400    running time 1418 seconds

steps 22600    base_loss: 0.338888    reg_loss: 0.120522    l2_loss: 0.560846    loss: 1.020256
steps 22600    v_Prec: 0.476292  v_Recall: 0.625835  v_F1: 0.540918  v_AUC: 0.811862
steps 22600    running time 1430 seconds

steps 22800    base_loss: 0.339965    reg_loss: 0.121320    l2_loss: 0.557612    loss: 1.018897
steps 22800    v_Prec: 0.479746  v_Recall: 0.624140  v_F1: 0.542499  v_AUC: 0.813090
steps 22800    running time 1442 seconds

steps 23000    base_loss: 0.339294    reg_loss: 0.121369    l2_loss: 0.556669    loss: 1.017332
steps 23000    v_Prec: 0.493639  v_Recall: 0.609848  v_F1: 0.545624  v_AUC: 0.815209
steps 23000    running time 1453 seconds

steps 23200    base_loss: 0.340673    reg_loss: 0.120940    l2_loss: 0.556310    loss: 1.017923
steps 23200    v_Prec: 0.491219  v_Recall: 0.614121  v_F1: 0.545838  v_AUC: 0.816507
steps 23200    running time 1465 seconds

steps 23400    base_loss: 0.332985    reg_loss: 0.120355    l2_loss: 0.554082    loss: 1.007422
steps 23400    v_Prec: 0.497558  v_Recall: 0.607932  v_F1: 0.547235  v_AUC: 0.817956
steps 23400    running time 1477 seconds

steps 23600    base_loss: 0.331340    reg_loss: 0.120324    l2_loss: 0.551858    loss: 1.003522
steps 23600    v_Prec: 0.499574  v_Recall: 0.605403  v_F1: 0.547421  v_AUC: 0.818859
steps 23600    running time 1488 seconds

steps 23800    base_loss: 0.332376    reg_loss: 0.120974    l2_loss: 0.549104    loss: 1.002454
steps 23800    v_Prec: 0.497524  v_Recall: 0.616945  v_F1: 0.550836  v_AUC: 0.821138
steps 23800    running time 1499 seconds

steps 24000    base_loss: 0.331481    reg_loss: 0.119975    l2_loss: 0.548169    loss: 0.999625
steps 24000    v_Prec: 0.492502  v_Recall: 0.625860  v_F1: 0.551230  v_AUC: 0.822379
steps 24000    running time 1511 seconds

steps 24200    base_loss: 0.331037    reg_loss: 0.120593    l2_loss: 0.548658    loss: 1.000288
steps 24200    v_Prec: 0.496298  v_Recall: 0.625491  v_F1: 0.553455  v_AUC: 0.823508
steps 24200    running time 1523 seconds

steps 24400    base_loss: 0.330982    reg_loss: 0.119768    l2_loss: 0.543826    loss: 0.994576
steps 24400    v_Prec: 0.498423  v_Recall: 0.624951  v_F1: 0.554562  v_AUC: 0.824838
steps 24400    running time 1534 seconds

steps 24600    base_loss: 0.330080    reg_loss: 0.119766    l2_loss: 0.541921    loss: 0.991767
steps 24600    v_Prec: 0.505862  v_Recall: 0.617780  v_F1: 0.556247  v_AUC: 0.826258
steps 24600    running time 1546 seconds

steps 24800    base_loss: 0.328621    reg_loss: 0.120330    l2_loss: 0.540491    loss: 0.989442
steps 24800    v_Prec: 0.509579  v_Recall: 0.618615  v_F1: 0.558828  v_AUC: 0.827781
steps 24800    running time 1557 seconds

steps 25000    base_loss: 0.326891    reg_loss: 0.120025    l2_loss: 0.541496    loss: 0.988411
steps 25000    v_Prec: 0.504583  v_Recall: 0.621930  v_F1: 0.557144  v_AUC: 0.828326
steps 25000    running time 1569 seconds

steps 25200    base_loss: 0.329338    reg_loss: 0.120419    l2_loss: 0.538532    loss: 0.988289
steps 25200    v_Prec: 0.509367  v_Recall: 0.622986  v_F1: 0.560476  v_AUC: 0.829955
steps 25200    running time 1580 seconds

steps 25400    base_loss: 0.333709    reg_loss: 0.121505    l2_loss: 0.538244    loss: 0.993459
steps 25400    v_Prec: 0.510704  v_Recall: 0.623355  v_F1: 0.561434  v_AUC: 0.831320
steps 25400    running time 1592 seconds

steps 25600    base_loss: 0.328561    reg_loss: 0.120854    l2_loss: 0.536869    loss: 0.986284
steps 25600    v_Prec: 0.518720  v_Recall: 0.616528  v_F1: 0.563410  v_AUC: 0.832559
steps 25600    running time 1604 seconds

steps 25800    base_loss: 0.322646    reg_loss: 0.118059    l2_loss: 0.532838    loss: 0.973544
steps 25800    v_Prec: 0.514959  v_Recall: 0.622618  v_F1: 0.563694  v_AUC: 0.833302
steps 25800    running time 1615 seconds

steps 26000    base_loss: 0.320796    reg_loss: 0.118604    l2_loss: 0.531862    loss: 0.971262
steps 26000    v_Prec: 0.511747  v_Recall: 0.633890  v_F1: 0.566307  v_AUC: 0.834264
steps 26000    running time 1627 seconds

steps 26200    base_loss: 0.324330    reg_loss: 0.118971    l2_loss: 0.530826    loss: 0.974127
steps 26200    v_Prec: 0.519413  v_Recall: 0.624533  v_F1: 0.567144  v_AUC: 0.835665
steps 26200    running time 1638 seconds

steps 26400    base_loss: 0.327528    reg_loss: 0.119989    l2_loss: 0.530050    loss: 0.977567
steps 26400    v_Prec: 0.521246  v_Recall: 0.623600  v_F1: 0.567847  v_AUC: 0.836449
steps 26400    running time 1650 seconds

steps 26600    base_loss: 0.324614    reg_loss: 0.118991    l2_loss: 0.528888    loss: 0.972493
steps 26600    v_Prec: 0.514432  v_Recall: 0.635953  v_F1: 0.568774  v_AUC: 0.837897
steps 26600    running time 1662 seconds

steps 26800    base_loss: 0.328552    reg_loss: 0.119591    l2_loss: 0.525576    loss: 0.973718
steps 26800    v_Prec: 0.517810  v_Recall: 0.636518  v_F1: 0.571060  v_AUC: 0.838763
steps 26800    running time 1673 seconds

steps 27000    base_loss: 0.323792    reg_loss: 0.119224    l2_loss: 0.526907    loss: 0.969923
steps 27000    v_Prec: 0.530778  v_Recall: 0.620015  v_F1: 0.571937  v_AUC: 0.839749
steps 27000    running time 1685 seconds

steps 27200    base_loss: 0.317490    reg_loss: 0.118453    l2_loss: 0.525239    loss: 0.961182
steps 27200    v_Prec: 0.530803  v_Recall: 0.623993  v_F1: 0.573638  v_AUC: 0.840868
steps 27200    running time 1696 seconds

steps 27400    base_loss: 0.321569    reg_loss: 0.120230    l2_loss: 0.524828    loss: 0.966627
steps 27400    v_Prec: 0.531697  v_Recall: 0.625737  v_F1: 0.574897  v_AUC: 0.841782
steps 27400    running time 1708 seconds

steps 27600    base_loss: 0.318061    reg_loss: 0.119681    l2_loss: 0.522220    loss: 0.959963
steps 27600    v_Prec: 0.525920  v_Recall: 0.637058  v_F1: 0.576179  v_AUC: 0.842803
steps 27600    running time 1720 seconds

steps 27800    base_loss: 0.319137    reg_loss: 0.119624    l2_loss: 0.522331    loss: 0.961092
steps 27800    v_Prec: 0.517607  v_Recall: 0.647593  v_F1: 0.575350  v_AUC: 0.843246
steps 27800    running time 1732 seconds

steps 28000    base_loss: 0.323029    reg_loss: 0.119991    l2_loss: 0.519887    loss: 0.962906
steps 28000    v_Prec: 0.524627  v_Recall: 0.640864  v_F1: 0.576949  v_AUC: 0.844614
steps 28000    running time 1743 seconds

steps 28200    base_loss: 0.311097    reg_loss: 0.117307    l2_loss: 0.519006    loss: 0.947411
steps 28200    v_Prec: 0.512765  v_Recall: 0.661444  v_F1: 0.577692  v_AUC: 0.845274
steps 28200    running time 1754 seconds

steps 28400    base_loss: 0.314711    reg_loss: 0.118733    l2_loss: 0.515971    loss: 0.949414
steps 28400    v_Prec: 0.523650  v_Recall: 0.649779  v_F1: 0.579936  v_AUC: 0.846449
steps 28400    running time 1766 seconds

steps 28600    base_loss: 0.315557    reg_loss: 0.118901    l2_loss: 0.515647    loss: 0.950105
steps 28600    v_Prec: 0.526202  v_Recall: 0.650516  v_F1: 0.581792  v_AUC: 0.847818
steps 28600    running time 1777 seconds

steps 28800    base_loss: 0.315069    reg_loss: 0.118343    l2_loss: 0.514745    loss: 0.948157
steps 28800    v_Prec: 0.518653  v_Recall: 0.663728  v_F1: 0.582290  v_AUC: 0.848605
steps 28800    running time 1789 seconds

steps 29000    base_loss: 0.326411    reg_loss: 0.119426    l2_loss: 0.513709    loss: 0.959547
steps 29000    v_Prec: 0.517012  v_Recall: 0.667240  v_F1: 0.582597  v_AUC: 0.849096
steps 29000    running time 1801 seconds

steps 29200    base_loss: 0.311415    reg_loss: 0.118605    l2_loss: 0.511678    loss: 0.941699
steps 29200    v_Prec: 0.524221  v_Recall: 0.657760  v_F1: 0.583447  v_AUC: 0.850315
steps 29200    running time 1812 seconds

steps 29400    base_loss: 0.307934    reg_loss: 0.117188    l2_loss: 0.510795    loss: 0.935916
steps 29400    v_Prec: 0.528618  v_Recall: 0.654813  v_F1: 0.584987  v_AUC: 0.851458
steps 29400    running time 1824 seconds

steps 29600    base_loss: 0.318308    reg_loss: 0.118514    l2_loss: 0.509556    loss: 0.946378
steps 29600    v_Prec: 0.525872  v_Recall: 0.663384  v_F1: 0.586678  v_AUC: 0.852179
steps 29600    running time 1836 seconds

steps 29800    base_loss: 0.311799    reg_loss: 0.117643    l2_loss: 0.509114    loss: 0.938556
steps 29800    v_Prec: 0.533319  v_Recall: 0.652726  v_F1: 0.587011  v_AUC: 0.853094
steps 29800    running time 1847 seconds

steps 30000    base_loss: 0.314058    reg_loss: 0.118862    l2_loss: 0.509835    loss: 0.942755
steps 30000    v_Prec: 0.532282  v_Recall: 0.656582  v_F1: 0.587934  v_AUC: 0.853874
steps 30000    running time 1859 seconds

steps 30200    base_loss: 0.314471    reg_loss: 0.118481    l2_loss: 0.508351    loss: 0.941302
steps 30200    v_Prec: 0.536583  v_Recall: 0.654126  v_F1: 0.589553  v_AUC: 0.854826
steps 30200    running time 1871 seconds

steps 30400    base_loss: 0.316454    reg_loss: 0.118004    l2_loss: 0.505176    loss: 0.939635
steps 30400    v_Prec: 0.528761  v_Recall: 0.668197  v_F1: 0.590358  v_AUC: 0.855335
steps 30400    running time 1882 seconds

steps 30600    base_loss: 0.308805    reg_loss: 0.117750    l2_loss: 0.506791    loss: 0.933347
steps 30600    v_Prec: 0.526936  v_Recall: 0.673306  v_F1: 0.591196  v_AUC: 0.855771
steps 30600    running time 1894 seconds

steps 30800    base_loss: 0.305455    reg_loss: 0.116487    l2_loss: 0.503674    loss: 0.925616
steps 30800    v_Prec: 0.534012  v_Recall: 0.663384  v_F1: 0.591709  v_AUC: 0.856482
steps 30800    running time 1906 seconds

steps 31000    base_loss: 0.309555    reg_loss: 0.118075    l2_loss: 0.501729    loss: 0.929359
steps 31000    v_Prec: 0.537901  v_Recall: 0.663089  v_F1: 0.593970  v_AUC: 0.857407
steps 31000    running time 1917 seconds

steps 31200    base_loss: 0.312563    reg_loss: 0.117150    l2_loss: 0.503923    loss: 0.933636
steps 31200    v_Prec: 0.545061  v_Recall: 0.653217  v_F1: 0.594258  v_AUC: 0.858103
steps 31200    running time 1929 seconds

steps 31400    base_loss: 0.307875    reg_loss: 0.117388    l2_loss: 0.503579    loss: 0.928842
steps 31400    v_Prec: 0.530899  v_Recall: 0.676596  v_F1: 0.594958  v_AUC: 0.858758
steps 31400    running time 1941 seconds

steps 31600    base_loss: 0.302903    reg_loss: 0.115582    l2_loss: 0.500153    loss: 0.918638
steps 31600    v_Prec: 0.533253  v_Recall: 0.676965  v_F1: 0.596576  v_AUC: 0.859840
steps 31600    running time 1952 seconds

steps 31800    base_loss: 0.303757    reg_loss: 0.116684    l2_loss: 0.499664    loss: 0.920105
steps 31800    v_Prec: 0.547909  v_Recall: 0.653831  v_F1: 0.596202  v_AUC: 0.860256
steps 31800    running time 1964 seconds

steps 32000    base_loss: 0.303578    reg_loss: 0.116940    l2_loss: 0.497526    loss: 0.918044
steps 32000    v_Prec: 0.551411  v_Recall: 0.650860  v_F1: 0.597022  v_AUC: 0.861176
steps 32000    running time 1975 seconds

steps 32200    base_loss: 0.303365    reg_loss: 0.116780    l2_loss: 0.495513    loss: 0.915659
steps 32200    v_Prec: 0.544255  v_Recall: 0.666405  v_F1: 0.599168  v_AUC: 0.861639
steps 32200    running time 1986 seconds

steps 32400    base_loss: 0.304485    reg_loss: 0.118172    l2_loss: 0.499060    loss: 0.921717
steps 32400    v_Prec: 0.542329  v_Recall: 0.669401  v_F1: 0.599202  v_AUC: 0.862375
steps 32400    running time 1998 seconds

steps 32600    base_loss: 0.305181    reg_loss: 0.116905    l2_loss: 0.496902    loss: 0.918988
steps 32600    v_Prec: 0.545354  v_Recall: 0.667510  v_F1: 0.600280  v_AUC: 0.862781
steps 32600    running time 2009 seconds

steps 32800    base_loss: 0.298475    reg_loss: 0.116337    l2_loss: 0.494328    loss: 0.909140
steps 32800    v_Prec: 0.545112  v_Recall: 0.668861  v_F1: 0.600679  v_AUC: 0.863197
steps 32800    running time 2021 seconds

steps 33000    base_loss: 0.299827    reg_loss: 0.115163    l2_loss: 0.492946    loss: 0.907936
steps 33000    v_Prec: 0.543570  v_Recall: 0.676645  v_F1: 0.602851  v_AUC: 0.864371
steps 33000    running time 2033 seconds

steps 33200    base_loss: 0.301970    reg_loss: 0.117026    l2_loss: 0.495705    loss: 0.914701
steps 33200    v_Prec: 0.544291  v_Recall: 0.676473  v_F1: 0.603226  v_AUC: 0.864781
steps 33200    running time 2044 seconds

steps 33400    base_loss: 0.295508    reg_loss: 0.114351    l2_loss: 0.492184    loss: 0.902044
steps 33400    v_Prec: 0.539125  v_Recall: 0.684406  v_F1: 0.603140  v_AUC: 0.865383
steps 33400    running time 2056 seconds

steps 33600    base_loss: 0.300927    reg_loss: 0.116164    l2_loss: 0.490336    loss: 0.907427
steps 33600    v_Prec: 0.542018  v_Recall: 0.684258  v_F1: 0.604889  v_AUC: 0.866524
steps 33600    running time 2067 seconds

steps 33800    base_loss: 0.301032    reg_loss: 0.116636    l2_loss: 0.490313    loss: 0.907981
steps 33800    v_Prec: 0.544140  v_Recall: 0.679052  v_F1: 0.604156  v_AUC: 0.866417
steps 33800    running time 2078 seconds

steps 34000    base_loss: 0.295554    reg_loss: 0.115810    l2_loss: 0.490826    loss: 0.902190
steps 34000    v_Prec: 0.540860  v_Recall: 0.690938  v_F1: 0.606757  v_AUC: 0.867311
steps 34000    running time 2089 seconds

steps 34200    base_loss: 0.300611    reg_loss: 0.116630    l2_loss: 0.487770    loss: 0.905012
steps 34200    v_Prec: 0.544702  v_Recall: 0.684823  v_F1: 0.606778  v_AUC: 0.868070
steps 34200    running time 2101 seconds

steps 34400    base_loss: 0.295719    reg_loss: 0.114447    l2_loss: 0.487251    loss: 0.897417
steps 34400    v_Prec: 0.547462  v_Recall: 0.681262  v_F1: 0.607077  v_AUC: 0.868452
steps 34400    running time 2113 seconds

steps 34600    base_loss: 0.297489    reg_loss: 0.116083    l2_loss: 0.485273    loss: 0.898845
steps 34600    v_Prec: 0.542056  v_Recall: 0.692240  v_F1: 0.608011  v_AUC: 0.869098
steps 34600    running time 2124 seconds

steps 34800    base_loss: 0.298833    reg_loss: 0.114613    l2_loss: 0.487043    loss: 0.900490
steps 34800    v_Prec: 0.550745  v_Recall: 0.681925  v_F1: 0.609355  v_AUC: 0.869594
steps 34800    running time 2136 seconds

steps 35000    base_loss: 0.297590    reg_loss: 0.116417    l2_loss: 0.485141    loss: 0.899148
steps 35000    v_Prec: 0.551444  v_Recall: 0.681410  v_F1: 0.609576  v_AUC: 0.870295
steps 35000    running time 2147 seconds

steps 35200    base_loss: 0.297390    reg_loss: 0.115065    l2_loss: 0.482989    loss: 0.895444
steps 35200    v_Prec: 0.547642  v_Recall: 0.691896  v_F1: 0.611375  v_AUC: 0.870884
steps 35200    running time 2159 seconds

steps 35400    base_loss: 0.294705    reg_loss: 0.116198    l2_loss: 0.484689    loss: 0.895592
steps 35400    v_Prec: 0.552659  v_Recall: 0.686739  v_F1: 0.612446  v_AUC: 0.871614
steps 35400    running time 2170 seconds

steps 35600    base_loss: 0.295021    reg_loss: 0.116079    l2_loss: 0.481974    loss: 0.893075
steps 35600    v_Prec: 0.548470  v_Recall: 0.697225  v_F1: 0.613966  v_AUC: 0.872399
steps 35600    running time 2182 seconds

steps 35800    base_loss: 0.297201    reg_loss: 0.116286    l2_loss: 0.480437    loss: 0.893925
steps 35800    v_Prec: 0.549806  v_Recall: 0.695359  v_F1: 0.614075  v_AUC: 0.872668
steps 35800    running time 2193 seconds

steps 36000    base_loss: 0.294222    reg_loss: 0.116344    l2_loss: 0.482030    loss: 0.892596
steps 36000    v_Prec: 0.549348  v_Recall: 0.694524  v_F1: 0.613464  v_AUC: 0.872814
steps 36000    running time 2205 seconds

steps 36200    base_loss: 0.297140    reg_loss: 0.116871    l2_loss: 0.480785    loss: 0.894796
steps 36200    v_Prec: 0.542932  v_Recall: 0.710584  v_F1: 0.615547  v_AUC: 0.873618
steps 36200    running time 2215 seconds

steps 36400    base_loss: 0.293711    reg_loss: 0.116156    l2_loss: 0.478782    loss: 0.888649
steps 36400    v_Prec: 0.550372  v_Recall: 0.698453  v_F1: 0.615633  v_AUC: 0.873871
steps 36400    running time 2227 seconds

steps 36600    base_loss: 0.287279    reg_loss: 0.115550    l2_loss: 0.479130    loss: 0.881959
steps 36600    v_Prec: 0.544654  v_Recall: 0.710511  v_F1: 0.616624  v_AUC: 0.874409
steps 36600    running time 2238 seconds

steps 36800    base_loss: 0.288779    reg_loss: 0.115151    l2_loss: 0.475715    loss: 0.879645
steps 36800    v_Prec: 0.552887  v_Recall: 0.700491  v_F1: 0.617998  v_AUC: 0.874801
steps 36800    running time 2250 seconds

steps 37000    base_loss: 0.286646    reg_loss: 0.115114    l2_loss: 0.477197    loss: 0.878957
steps 37000    v_Prec: 0.555167  v_Recall: 0.698281  v_F1: 0.618554  v_AUC: 0.875435
steps 37000    running time 2261 seconds

steps 37200    base_loss: 0.282938    reg_loss: 0.115635    l2_loss: 0.476137    loss: 0.874710
steps 37200    v_Prec: 0.554220  v_Recall: 0.698600  v_F1: 0.618091  v_AUC: 0.875725
steps 37200    running time 2273 seconds

steps 37400    base_loss: 0.277197    reg_loss: 0.114781    l2_loss: 0.476613    loss: 0.868590
steps 37400    v_Prec: 0.553801  v_Recall: 0.706164  v_F1: 0.620770  v_AUC: 0.875972
steps 37400    running time 2284 seconds

steps 37600    base_loss: 0.286706    reg_loss: 0.114930    l2_loss: 0.474889    loss: 0.876524
steps 37600    v_Prec: 0.551216  v_Recall: 0.710855  v_F1: 0.620939  v_AUC: 0.876864
steps 37600    running time 2295 seconds

steps 37800    base_loss: 0.284911    reg_loss: 0.113787    l2_loss: 0.473756    loss: 0.872454
steps 37800    v_Prec: 0.554750  v_Recall: 0.702701  v_F1: 0.620022  v_AUC: 0.876863
steps 37800    running time 2307 seconds

steps 38000    base_loss: 0.291316    reg_loss: 0.116043    l2_loss: 0.473328    loss: 0.880687
steps 38000    v_Prec: 0.557042  v_Recall: 0.704592  v_F1: 0.622189  v_AUC: 0.877731
steps 38000    running time 2317 seconds

steps 38200    base_loss: 0.291976    reg_loss: 0.114891    l2_loss: 0.471759    loss: 0.878626
steps 38200    v_Prec: 0.557090  v_Recall: 0.705501  v_F1: 0.622573  v_AUC: 0.878340
steps 38200    running time 2329 seconds

steps 38400    base_loss: 0.284011    reg_loss: 0.115031    l2_loss: 0.473692    loss: 0.872735
steps 38400    v_Prec: 0.563548  v_Recall: 0.692657  v_F1: 0.621468  v_AUC: 0.878150
steps 38400    running time 2340 seconds

steps 38600    base_loss: 0.284426    reg_loss: 0.114708    l2_loss: 0.470845    loss: 0.869979
steps 38600    v_Prec: 0.566195  v_Recall: 0.694131  v_F1: 0.623669  v_AUC: 0.879214
steps 38600    running time 2351 seconds

steps 38800    base_loss: 0.285027    reg_loss: 0.114761    l2_loss: 0.468766    loss: 0.868554
steps 38800    v_Prec: 0.557615  v_Recall: 0.707809  v_F1: 0.623799  v_AUC: 0.879509
steps 38800    running time 2362 seconds

steps 39000    base_loss: 0.283319    reg_loss: 0.114362    l2_loss: 0.470248    loss: 0.867928
steps 39000    v_Prec: 0.562283  v_Recall: 0.703143  v_F1: 0.624873  v_AUC: 0.880125
steps 39000    running time 2374 seconds

steps 39200    base_loss: 0.283617    reg_loss: 0.116019    l2_loss: 0.470872    loss: 0.870509
steps 39200    v_Prec: 0.558841  v_Recall: 0.709627  v_F1: 0.625272  v_AUC: 0.880181
steps 39200    running time 2386 seconds

steps 39400    base_loss: 0.284009    reg_loss: 0.114829    l2_loss: 0.469687    loss: 0.868525
steps 39400    v_Prec: 0.560222  v_Recall: 0.707515  v_F1: 0.625312  v_AUC: 0.880994
steps 39400    running time 2397 seconds

steps 39600    base_loss: 0.290863    reg_loss: 0.116744    l2_loss: 0.468676    loss: 0.876282
steps 39600    v_Prec: 0.562137  v_Recall: 0.706606  v_F1: 0.626147  v_AUC: 0.881386
steps 39600    running time 2409 seconds

steps 39800    base_loss: 0.280751    reg_loss: 0.115032    l2_loss: 0.469222    loss: 0.865005
steps 39800    v_Prec: 0.550794  v_Recall: 0.725000  v_F1: 0.626003  v_AUC: 0.881466
steps 39800    running time 2420 seconds

steps 40000    base_loss: 0.291486    reg_loss: 0.116300    l2_loss: 0.467134    loss: 0.874919
steps 40000    v_Prec: 0.557648  v_Recall: 0.715643  v_F1: 0.626843  v_AUC: 0.882319
steps 40000    running time 2431 seconds

steps 40200    base_loss: 0.295135    reg_loss: 0.116604    l2_loss: 0.467101    loss: 0.878840
steps 40200    v_Prec: 0.561348  v_Recall: 0.712672  v_F1: 0.628023  v_AUC: 0.882230
steps 40200    running time 2443 seconds

steps 40400    base_loss: 0.281821    reg_loss: 0.114659    l2_loss: 0.465187    loss: 0.861667
steps 40400    v_Prec: 0.560729  v_Recall: 0.713016  v_F1: 0.627769  v_AUC: 0.883101
steps 40400    running time 2454 seconds

steps 40600    base_loss: 0.288677    reg_loss: 0.115411    l2_loss: 0.465017    loss: 0.869105
steps 40600    v_Prec: 0.560596  v_Recall: 0.716798  v_F1: 0.629147  v_AUC: 0.883507
steps 40600    running time 2465 seconds

steps 40800    base_loss: 0.282087    reg_loss: 0.114151    l2_loss: 0.465362    loss: 0.861601
steps 40800    v_Prec: 0.560193  v_Recall: 0.717534  v_F1: 0.629176  v_AUC: 0.884135
steps 40800    running time 2476 seconds

steps 41000    base_loss: 0.280452    reg_loss: 0.114100    l2_loss: 0.463375    loss: 0.857926
steps 41000    v_Prec: 0.563816  v_Recall: 0.713286  v_F1: 0.629804  v_AUC: 0.884312
steps 41000    running time 2488 seconds

steps 41200    base_loss: 0.275978    reg_loss: 0.114871    l2_loss: 0.462079    loss: 0.852928
steps 41200    v_Prec: 0.560511  v_Recall: 0.718148  v_F1: 0.629613  v_AUC: 0.884354
steps 41200    running time 2500 seconds

steps 41400    base_loss: 0.282127    reg_loss: 0.115702    l2_loss: 0.462349    loss: 0.860178
steps 41400    v_Prec: 0.564378  v_Recall: 0.715840  v_F1: 0.631149  v_AUC: 0.885221
steps 41400    running time 2510 seconds

steps 41600    base_loss: 0.271158    reg_loss: 0.112709    l2_loss: 0.462161    loss: 0.846028
steps 41600    v_Prec: 0.558136  v_Recall: 0.722863  v_F1: 0.629909  v_AUC: 0.885255
steps 41600    running time 2522 seconds

steps 41800    base_loss: 0.277291    reg_loss: 0.113919    l2_loss: 0.462532    loss: 0.853743
steps 41800    v_Prec: 0.558973  v_Recall: 0.725663  v_F1: 0.631504  v_AUC: 0.885902
steps 41800    running time 2532 seconds

steps 42000    base_loss: 0.279688    reg_loss: 0.113949    l2_loss: 0.462121    loss: 0.855758
steps 42000    v_Prec: 0.558078  v_Recall: 0.726940  v_F1: 0.631414  v_AUC: 0.886049
steps 42000    running time 2544 seconds

steps 42200    base_loss: 0.280420    reg_loss: 0.114421    l2_loss: 0.459131    loss: 0.853972
steps 42200    v_Prec: 0.560460  v_Recall: 0.724730  v_F1: 0.632096  v_AUC: 0.886520
steps 42200    running time 2555 seconds

steps 42400    base_loss: 0.283652    reg_loss: 0.114698    l2_loss: 0.457815    loss: 0.856165
steps 42400    v_Prec: 0.558698  v_Recall: 0.729175  v_F1: 0.632653  v_AUC: 0.887091
steps 42400    running time 2566 seconds

steps 42600    base_loss: 0.283326    reg_loss: 0.115650    l2_loss: 0.461215    loss: 0.860190
steps 42600    v_Prec: 0.561835  v_Recall: 0.725860  v_F1: 0.633400  v_AUC: 0.887374
steps 42600    running time 2578 seconds

steps 42800    base_loss: 0.281610    reg_loss: 0.114231    l2_loss: 0.458350    loss: 0.854191
steps 42800    v_Prec: 0.562449  v_Recall: 0.725810  v_F1: 0.633772  v_AUC: 0.887392
steps 42800    running time 2589 seconds

steps 43000    base_loss: 0.281100    reg_loss: 0.115089    l2_loss: 0.458916    loss: 0.855104
steps 43000    v_Prec: 0.566349  v_Recall: 0.720481  v_F1: 0.634184  v_AUC: 0.887787
steps 43000    running time 2601 seconds

steps 43200    base_loss: 0.281375    reg_loss: 0.115601    l2_loss: 0.458380    loss: 0.855356
steps 43200    v_Prec: 0.554384  v_Recall: 0.739759  v_F1: 0.633795  v_AUC: 0.888001
steps 43200    running time 2612 seconds

steps 43400    base_loss: 0.273687    reg_loss: 0.114375    l2_loss: 0.456779    loss: 0.844841
steps 43400    v_Prec: 0.566795  v_Recall: 0.724460  v_F1: 0.636002  v_AUC: 0.888424
steps 43400    running time 2623 seconds

steps 43600    base_loss: 0.277853    reg_loss: 0.113693    l2_loss: 0.457999    loss: 0.849545
steps 43600    v_Prec: 0.567645  v_Recall: 0.722716  v_F1: 0.635863  v_AUC: 0.888986
steps 43600    running time 2635 seconds

steps 43800    base_loss: 0.269337    reg_loss: 0.112974    l2_loss: 0.456213    loss: 0.838524
steps 43800    v_Prec: 0.566644  v_Recall: 0.727898  v_F1: 0.637228  v_AUC: 0.889287
steps 43800    running time 2645 seconds

steps 44000    base_loss: 0.277379    reg_loss: 0.114145    l2_loss: 0.455360    loss: 0.846884
steps 44000    v_Prec: 0.570978  v_Recall: 0.719695  v_F1: 0.636769  v_AUC: 0.889484
steps 44000    running time 2657 seconds

steps 44200    base_loss: 0.273316    reg_loss: 0.113028    l2_loss: 0.455312    loss: 0.841656
steps 44200    v_Prec: 0.565249  v_Recall: 0.730034  v_F1: 0.637160  v_AUC: 0.889853
steps 44200    running time 2668 seconds

steps 44400    base_loss: 0.275524    reg_loss: 0.112385    l2_loss: 0.453944    loss: 0.841854
steps 44400    v_Prec: 0.564834  v_Recall: 0.732564  v_F1: 0.637857  v_AUC: 0.890187
steps 44400    running time 2679 seconds

steps 44600    base_loss: 0.282429    reg_loss: 0.114501    l2_loss: 0.453293    loss: 0.850223
steps 44600    v_Prec: 0.566386  v_Recall: 0.730918  v_F1: 0.638218  v_AUC: 0.890603
steps 44600    running time 2690 seconds

steps 44800    base_loss: 0.279241    reg_loss: 0.114146    l2_loss: 0.453259    loss: 0.846646
steps 44800    v_Prec: 0.571547  v_Recall: 0.726056  v_F1: 0.639603  v_AUC: 0.890926
steps 44800    running time 2701 seconds

steps 45000    base_loss: 0.276319    reg_loss: 0.113409    l2_loss: 0.453569    loss: 0.843297
steps 45000    v_Prec: 0.561945  v_Recall: 0.739416  v_F1: 0.638579  v_AUC: 0.891139
steps 45000    running time 2713 seconds

steps 45200    base_loss: 0.273364    reg_loss: 0.113584    l2_loss: 0.452914    loss: 0.839862
steps 45200    v_Prec: 0.564402  v_Recall: 0.739710  v_F1: 0.640273  v_AUC: 0.891831
steps 45200    running time 2724 seconds

steps 45400    base_loss: 0.279301    reg_loss: 0.113841    l2_loss: 0.447111    loss: 0.840253
steps 45400    v_Prec: 0.571429  v_Recall: 0.727505  v_F1: 0.640090  v_AUC: 0.891878
steps 45400    running time 2735 seconds

steps 45600    base_loss: 0.276131    reg_loss: 0.113165    l2_loss: 0.448720    loss: 0.838015
steps 45600    v_Prec: 0.571104  v_Recall: 0.727554  v_F1: 0.639905  v_AUC: 0.892122
steps 45600    running time 2746 seconds

steps 45800    base_loss: 0.273535    reg_loss: 0.114375    l2_loss: 0.451614    loss: 0.839525
steps 45800    v_Prec: 0.570668  v_Recall: 0.731876  v_F1: 0.641296  v_AUC: 0.892603
steps 45800    running time 2757 seconds

steps 46000    base_loss: 0.273059    reg_loss: 0.113370    l2_loss: 0.451043    loss: 0.837472
steps 46000    v_Prec: 0.572374  v_Recall: 0.728806  v_F1: 0.641187  v_AUC: 0.892480
steps 46000    running time 2769 seconds

steps 46200    base_loss: 0.273969    reg_loss: 0.113572    l2_loss: 0.450713    loss: 0.838254
steps 46200    v_Prec: 0.571522  v_Recall: 0.730894  v_F1: 0.641457  v_AUC: 0.892972
steps 46200    running time 2779 seconds

steps 46400    base_loss: 0.272212    reg_loss: 0.113949    l2_loss: 0.449439    loss: 0.835600
steps 46400    v_Prec: 0.572621  v_Recall: 0.729249  v_F1: 0.641513  v_AUC: 0.893251
steps 46400    running time 2791 seconds

steps 46600    base_loss: 0.271853    reg_loss: 0.113238    l2_loss: 0.447767    loss: 0.832858
steps 46600    v_Prec: 0.570165  v_Recall: 0.732687  v_F1: 0.641289  v_AUC: 0.893541
steps 46600    running time 2802 seconds

steps 46800    base_loss: 0.272067    reg_loss: 0.112850    l2_loss: 0.446374    loss: 0.831291
steps 46800    v_Prec: 0.566043  v_Recall: 0.742264  v_F1: 0.642286  v_AUC: 0.893529
steps 46800    running time 2813 seconds

steps 47000    base_loss: 0.270336    reg_loss: 0.113200    l2_loss: 0.449022    loss: 0.832557
steps 47000    v_Prec: 0.569424  v_Recall: 0.737525  v_F1: 0.642664  v_AUC: 0.894011
steps 47000    running time 2825 seconds

steps 47200    base_loss: 0.271478    reg_loss: 0.112647    l2_loss: 0.444781    loss: 0.828905
steps 47200    v_Prec: 0.566170  v_Recall: 0.743418  v_F1: 0.642800  v_AUC: 0.894658
steps 47200    running time 2836 seconds

steps 47400    base_loss: 0.267194    reg_loss: 0.113563    l2_loss: 0.448856    loss: 0.829612
steps 47400    v_Prec: 0.569771  v_Recall: 0.741724  v_F1: 0.644475  v_AUC: 0.894820
steps 47400    running time 2848 seconds

steps 47600    base_loss: 0.268329    reg_loss: 0.112539    l2_loss: 0.443662    loss: 0.824530
steps 47600    v_Prec: 0.565263  v_Recall: 0.749042  v_F1: 0.644303  v_AUC: 0.894673
steps 47600    running time 2859 seconds

steps 47800    base_loss: 0.271334    reg_loss: 0.113939    l2_loss: 0.446505    loss: 0.831778
steps 47800    v_Prec: 0.576483  v_Recall: 0.733472  v_F1: 0.645571  v_AUC: 0.895069
steps 47800    running time 2870 seconds

steps 48000    base_loss: 0.269171    reg_loss: 0.113172    l2_loss: 0.445062    loss: 0.827405
steps 48000    v_Prec: 0.566402  v_Recall: 0.749509  v_F1: 0.645216  v_AUC: 0.895449
steps 48000    running time 2881 seconds

steps 48200    base_loss: 0.272818    reg_loss: 0.113698    l2_loss: 0.442524    loss: 0.829040
steps 48200    v_Prec: 0.575710  v_Recall: 0.735020  v_F1: 0.645683  v_AUC: 0.895578
steps 48200    running time 2892 seconds

steps 48400    base_loss: 0.266692    reg_loss: 0.113283    l2_loss: 0.444282    loss: 0.824256
steps 48400    v_Prec: 0.569711  v_Recall: 0.747299  v_F1: 0.646532  v_AUC: 0.895844
steps 48400    running time 2904 seconds

steps 48600    base_loss: 0.273014    reg_loss: 0.113916    l2_loss: 0.444963    loss: 0.831893
steps 48600    v_Prec: 0.570571  v_Recall: 0.747151  v_F1: 0.647030  v_AUC: 0.896412
steps 48600    running time 2915 seconds

steps 48800    base_loss: 0.270219    reg_loss: 0.113189    l2_loss: 0.442901    loss: 0.826309
steps 48800    v_Prec: 0.572957  v_Recall: 0.743001  v_F1: 0.646993  v_AUC: 0.896878
steps 48800    running time 2927 seconds

steps 49000    base_loss: 0.270044    reg_loss: 0.113392    l2_loss: 0.442405    loss: 0.825842
steps 49000    v_Prec: 0.576683  v_Recall: 0.738458  v_F1: 0.647621  v_AUC: 0.896887
steps 49000    running time 2938 seconds

steps 49200    base_loss: 0.270696    reg_loss: 0.113065    l2_loss: 0.442216    loss: 0.825976
steps 49200    v_Prec: 0.572946  v_Recall: 0.745604  v_F1: 0.647971  v_AUC: 0.896985
steps 49200    running time 2949 seconds

steps 49400    base_loss: 0.264898    reg_loss: 0.112288    l2_loss: 0.442687    loss: 0.819873
steps 49400    v_Prec: 0.573334  v_Recall: 0.746292  v_F1: 0.648479  v_AUC: 0.897439
steps 49400    running time 2961 seconds

steps 49600    base_loss: 0.272167    reg_loss: 0.113459    l2_loss: 0.440547    loss: 0.826173
steps 49600    v_Prec: 0.572014  v_Recall: 0.747692  v_F1: 0.648160  v_AUC: 0.897833
steps 49600    running time 2972 seconds

steps 49800    base_loss: 0.271142    reg_loss: 0.112979    l2_loss: 0.439384    loss: 0.823505
steps 49800    v_Prec: 0.567285  v_Recall: 0.757490  v_F1: 0.648733  v_AUC: 0.898236
steps 49800    running time 2983 seconds

steps 50000    base_loss: 0.266410    reg_loss: 0.112873    l2_loss: 0.440778    loss: 0.820062
steps 50000    v_Prec: 0.563783  v_Recall: 0.763973  v_F1: 0.648787  v_AUC: 0.898307
steps 50000    running time 2995 seconds

steps 50200    base_loss: 0.269244    reg_loss: 0.112961    l2_loss: 0.439548    loss: 0.821753
steps 50200    v_Prec: 0.564567  v_Recall: 0.762083  v_F1: 0.648622  v_AUC: 0.898359
steps 50200    running time 3006 seconds

steps 50400    base_loss: 0.269919    reg_loss: 0.112706    l2_loss: 0.439795    loss: 0.822421
steps 50400    v_Prec: 0.563499  v_Recall: 0.766356  v_F1: 0.649455  v_AUC: 0.898784
steps 50400    running time 3017 seconds

steps 50600    base_loss: 0.271073    reg_loss: 0.112577    l2_loss: 0.437855    loss: 0.821505
steps 50600    v_Prec: 0.575513  v_Recall: 0.747348  v_F1: 0.650270  v_AUC: 0.898895
steps 50600    running time 3029 seconds

steps 50800    base_loss: 0.264102    reg_loss: 0.112404    l2_loss: 0.437005    loss: 0.813511
steps 50800    v_Prec: 0.578062  v_Recall: 0.742878  v_F1: 0.650188  v_AUC: 0.899354
steps 50800    running time 3040 seconds

steps 51000    base_loss: 0.267338    reg_loss: 0.111638    l2_loss: 0.437701    loss: 0.816677
steps 51000    v_Prec: 0.573449  v_Recall: 0.753610  v_F1: 0.651300  v_AUC: 0.899442
steps 51000    running time 3051 seconds

steps 51200    base_loss: 0.266899    reg_loss: 0.112618    l2_loss: 0.438005    loss: 0.817522
steps 51200    v_Prec: 0.564662  v_Recall: 0.768173  v_F1: 0.650880  v_AUC: 0.899955
steps 51200    running time 3063 seconds

steps 51400    base_loss: 0.266295    reg_loss: 0.112904    l2_loss: 0.437920    loss: 0.817120
steps 51400    v_Prec: 0.584667  v_Recall: 0.734897  v_F1: 0.651230  v_AUC: 0.899852
steps 51400    running time 3074 seconds

steps 51600    base_loss: 0.263814    reg_loss: 0.111850    l2_loss: 0.437481    loss: 0.813145
steps 51600    v_Prec: 0.563659  v_Recall: 0.771169  v_F1: 0.651284  v_AUC: 0.900548
steps 51600    running time 3085 seconds

steps 51800    base_loss: 0.267232    reg_loss: 0.112712    l2_loss: 0.437190    loss: 0.817135
steps 51800    v_Prec: 0.571908  v_Recall: 0.757834  v_F1: 0.651873  v_AUC: 0.900775
steps 51800    running time 3096 seconds

steps 52000    base_loss: 0.266760    reg_loss: 0.112419    l2_loss: 0.435818    loss: 0.814996
steps 52000    v_Prec: 0.574333  v_Recall: 0.754715  v_F1: 0.652283  v_AUC: 0.900909
steps 52000    running time 3107 seconds

steps 52200    base_loss: 0.266099    reg_loss: 0.112524    l2_loss: 0.434852    loss: 0.813475
steps 52200    v_Prec: 0.572865  v_Recall: 0.757146  v_F1: 0.652239  v_AUC: 0.900971
steps 52200    running time 3118 seconds

steps 52400    base_loss: 0.264060    reg_loss: 0.112339    l2_loss: 0.435339    loss: 0.811738
steps 52400    v_Prec: 0.576507  v_Recall: 0.752333  v_F1: 0.652788  v_AUC: 0.901233
steps 52400    running time 3129 seconds

steps 52600    base_loss: 0.266237    reg_loss: 0.112671    l2_loss: 0.435418    loss: 0.814326
steps 52600    v_Prec: 0.572222  v_Recall: 0.758743  v_F1: 0.652413  v_AUC: 0.901480
steps 52600    running time 3141 seconds

steps 52800    base_loss: 0.270829    reg_loss: 0.112651    l2_loss: 0.434016    loss: 0.817496
steps 52800    v_Prec: 0.571355  v_Recall: 0.761984  v_F1: 0.653042  v_AUC: 0.901845
steps 52800    running time 3151 seconds

steps 53000    base_loss: 0.261100    reg_loss: 0.112249    l2_loss: 0.434305    loss: 0.807655
steps 53000    v_Prec: 0.567991  v_Recall: 0.767583  v_F1: 0.652874  v_AUC: 0.901759
steps 53000    running time 3163 seconds

steps 53200    base_loss: 0.262736    reg_loss: 0.112268    l2_loss: 0.431073    loss: 0.806077
steps 53200    v_Prec: 0.579313  v_Recall: 0.748084  v_F1: 0.652969  v_AUC: 0.902133
steps 53200    running time 3174 seconds

steps 53400    base_loss: 0.264196    reg_loss: 0.112108    l2_loss: 0.431847    loss: 0.808150
steps 53400    v_Prec: 0.572674  v_Recall: 0.761297  v_F1: 0.653650  v_AUC: 0.902375
steps 53400    running time 3185 seconds

steps 53600    base_loss: 0.263745    reg_loss: 0.113164    l2_loss: 0.433639    loss: 0.810548
steps 53600    v_Prec: 0.579492  v_Recall: 0.752087  v_F1: 0.654604  v_AUC: 0.902695
steps 53600    running time 3196 seconds

steps 53800    base_loss: 0.265576    reg_loss: 0.111816    l2_loss: 0.432368    loss: 0.809761
steps 53800    v_Prec: 0.579271  v_Recall: 0.754077  v_F1: 0.655215  v_AUC: 0.902987
steps 53800    running time 3207 seconds

steps 54000    base_loss: 0.264919    reg_loss: 0.112125    l2_loss: 0.431542    loss: 0.808586
steps 54000    v_Prec: 0.574968  v_Recall: 0.759136  v_F1: 0.654340  v_AUC: 0.902537
steps 54000    running time 3219 seconds

steps 54200    base_loss: 0.260691    reg_loss: 0.111646    l2_loss: 0.430052    loss: 0.802389
steps 54200    v_Prec: 0.574731  v_Recall: 0.761886  v_F1: 0.655206  v_AUC: 0.903485
steps 54200    running time 3230 seconds

steps 54400    base_loss: 0.266046    reg_loss: 0.113437    l2_loss: 0.430764    loss: 0.810247
steps 54400    v_Prec: 0.578789  v_Recall: 0.757245  v_F1: 0.656099  v_AUC: 0.903544
steps 54400    running time 3241 seconds

steps 54600    base_loss: 0.259143    reg_loss: 0.112100    l2_loss: 0.428034    loss: 0.799277
steps 54600    v_Prec: 0.580288  v_Recall: 0.754617  v_F1: 0.656070  v_AUC: 0.903745
steps 54600    running time 3253 seconds

steps 54800    base_loss: 0.252341    reg_loss: 0.111467    l2_loss: 0.431328    loss: 0.795136
steps 54800    v_Prec: 0.578374  v_Recall: 0.757809  v_F1: 0.656044  v_AUC: 0.903789
steps 54800    running time 3263 seconds

steps 55000    base_loss: 0.260048    reg_loss: 0.111896    l2_loss: 0.427446    loss: 0.799390
steps 55000    v_Prec: 0.573548  v_Recall: 0.767092  v_F1: 0.656349  v_AUC: 0.904079
steps 55000    running time 3274 seconds

steps 55200    base_loss: 0.256672    reg_loss: 0.110888    l2_loss: 0.427194    loss: 0.794755
steps 55200    v_Prec: 0.573410  v_Recall: 0.768738  v_F1: 0.656860  v_AUC: 0.904038
steps 55200    running time 3286 seconds

steps 55400    base_loss: 0.253359    reg_loss: 0.111548    l2_loss: 0.428746    loss: 0.793653
steps 55400    v_Prec: 0.574878  v_Recall: 0.766429  v_F1: 0.656976  v_AUC: 0.904390
steps 55400    running time 3297 seconds

steps 55600    base_loss: 0.256578    reg_loss: 0.112517    l2_loss: 0.429524    loss: 0.798618
steps 55600    v_Prec: 0.571159  v_Recall: 0.773183  v_F1: 0.656991  v_AUC: 0.904297
steps 55600    running time 3309 seconds

steps 55800    base_loss: 0.260531    reg_loss: 0.112729    l2_loss: 0.427936    loss: 0.801196
steps 55800    v_Prec: 0.573439  v_Recall: 0.772397  v_F1: 0.658212  v_AUC: 0.904547
steps 55800    running time 3320 seconds

steps 56000    base_loss: 0.258671    reg_loss: 0.113033    l2_loss: 0.426758    loss: 0.798462
steps 56000    v_Prec: 0.570255  v_Recall: 0.775810  v_F1: 0.657338  v_AUC: 0.904724
steps 56000    running time 3332 seconds

steps 56200    base_loss: 0.256917    reg_loss: 0.111228    l2_loss: 0.428645    loss: 0.796790
steps 56200    v_Prec: 0.572215  v_Recall: 0.771169  v_F1: 0.656959  v_AUC: 0.904653
steps 56200    running time 3343 seconds

steps 56400    base_loss: 0.258973    reg_loss: 0.112478    l2_loss: 0.427719    loss: 0.799170
steps 56400    v_Prec: 0.577637  v_Recall: 0.766135  v_F1: 0.658665  v_AUC: 0.905026
steps 56400    running time 3354 seconds

steps 56600    base_loss: 0.253415    reg_loss: 0.111463    l2_loss: 0.426300    loss: 0.791177
steps 56600    v_Prec: 0.577287  v_Recall: 0.766110  v_F1: 0.658428  v_AUC: 0.905260
steps 56600    running time 3366 seconds

steps 56800    base_loss: 0.258383    reg_loss: 0.111646    l2_loss: 0.424905    loss: 0.794934
steps 56800    v_Prec: 0.581590  v_Recall: 0.760437  v_F1: 0.659096  v_AUC: 0.905517
steps 56800    running time 3376 seconds

steps 57000    base_loss: 0.254818    reg_loss: 0.112263    l2_loss: 0.424607    loss: 0.791689
steps 57000    v_Prec: 0.581575  v_Recall: 0.761690  v_F1: 0.659557  v_AUC: 0.905609
steps 57000    running time 3388 seconds

steps 57200    base_loss: 0.256423    reg_loss: 0.111447    l2_loss: 0.425159    loss: 0.793029
steps 57200    v_Prec: 0.576873  v_Recall: 0.768664  v_F1: 0.659100  v_AUC: 0.905761
steps 57200    running time 3399 seconds

steps 57400    base_loss: 0.255383    reg_loss: 0.111210    l2_loss: 0.425249    loss: 0.791841
steps 57400    v_Prec: 0.575485  v_Recall: 0.772495  v_F1: 0.659593  v_AUC: 0.906055
steps 57400    running time 3410 seconds

steps 57600    base_loss: 0.258278    reg_loss: 0.113027    l2_loss: 0.424824    loss: 0.796128
steps 57600    v_Prec: 0.581284  v_Recall: 0.764391  v_F1: 0.660380  v_AUC: 0.906334
steps 57600    running time 3421 seconds

steps 57800    base_loss: 0.255158    reg_loss: 0.112742    l2_loss: 0.424876    loss: 0.792776
steps 57800    v_Prec: 0.574063  v_Recall: 0.775860  v_F1: 0.659878  v_AUC: 0.906373
steps 57800    running time 3433 seconds

steps 58000    base_loss: 0.258156    reg_loss: 0.112061    l2_loss: 0.424475    loss: 0.794691
steps 58000    v_Prec: 0.581448  v_Recall: 0.765079  v_F1: 0.660742  v_AUC: 0.906894
steps 58000    running time 3444 seconds

steps 58200    base_loss: 0.259085    reg_loss: 0.111336    l2_loss: 0.423334    loss: 0.793756
steps 58200    v_Prec: 0.582337  v_Recall: 0.765275  v_F1: 0.661389  v_AUC: 0.906975
steps 58200    running time 3455 seconds

steps 58400    base_loss: 0.255826    reg_loss: 0.112618    l2_loss: 0.424900    loss: 0.793345
steps 58400    v_Prec: 0.583291  v_Recall: 0.760413  v_F1: 0.660178  v_AUC: 0.907130
steps 58400    running time 3466 seconds

steps 58600    base_loss: 0.262292    reg_loss: 0.112290    l2_loss: 0.422379    loss: 0.796961
steps 58600    v_Prec: 0.577862  v_Recall: 0.771783  v_F1: 0.660891  v_AUC: 0.907369
steps 58600    running time 3477 seconds

steps 58800    base_loss: 0.251532    reg_loss: 0.111182    l2_loss: 0.421760    loss: 0.784474
steps 58800    v_Prec: 0.581577  v_Recall: 0.767019  v_F1: 0.661548  v_AUC: 0.907307
steps 58800    running time 3488 seconds

steps 59000    base_loss: 0.256410    reg_loss: 0.111406    l2_loss: 0.421979    loss: 0.789795
steps 59000    v_Prec: 0.572778  v_Recall: 0.781999  v_F1: 0.661233  v_AUC: 0.907550
steps 59000    running time 3500 seconds

steps 59200    base_loss: 0.251530    reg_loss: 0.111438    l2_loss: 0.421370    loss: 0.784338
steps 59200    v_Prec: 0.581701  v_Recall: 0.768639  v_F1: 0.662230  v_AUC: 0.907670
steps 59200    running time 3511 seconds

steps 59400    base_loss: 0.258164    reg_loss: 0.112238    l2_loss: 0.419677    loss: 0.790078
steps 59400    v_Prec: 0.579310  v_Recall: 0.771783  v_F1: 0.661837  v_AUC: 0.908015
steps 59400    running time 3522 seconds

steps 59600    base_loss: 0.248967    reg_loss: 0.109645    l2_loss: 0.420068    loss: 0.778679
steps 59600    v_Prec: 0.579974  v_Recall: 0.770530  v_F1: 0.661808  v_AUC: 0.907916
steps 59600    running time 3533 seconds

steps 59800    base_loss: 0.256941    reg_loss: 0.111999    l2_loss: 0.422288    loss: 0.791228
steps 59800    v_Prec: 0.577513  v_Recall: 0.776891  v_F1: 0.662527  v_AUC: 0.908197
steps 59800    running time 3544 seconds

steps 60000    base_loss: 0.248194    reg_loss: 0.110686    l2_loss: 0.419124    loss: 0.778005
steps 60000    v_Prec: 0.583301  v_Recall: 0.768590  v_F1: 0.663248  v_AUC: 0.908670
steps 60000    running time 3556 seconds

steps 60200    base_loss: 0.253255    reg_loss: 0.112545    l2_loss: 0.420032    loss: 0.785832
steps 60200    v_Prec: 0.580704  v_Recall: 0.772741  v_F1: 0.663098  v_AUC: 0.908653
steps 60200    running time 3567 seconds

steps 60400    base_loss: 0.251916    reg_loss: 0.110753    l2_loss: 0.419746    loss: 0.782415
steps 60400    v_Prec: 0.582752  v_Recall: 0.770972  v_F1: 0.663777  v_AUC: 0.908938
steps 60400    running time 3578 seconds

steps 60600    base_loss: 0.258715    reg_loss: 0.112667    l2_loss: 0.419227    loss: 0.790609
steps 60600    v_Prec: 0.581460  v_Recall: 0.772520  v_F1: 0.663510  v_AUC: 0.909117
steps 60600    running time 3590 seconds

steps 60800    base_loss: 0.252094    reg_loss: 0.111443    l2_loss: 0.416968    loss: 0.780505
steps 60800    v_Prec: 0.582181  v_Recall: 0.773134  v_F1: 0.664205  v_AUC: 0.909162
steps 60800    running time 3601 seconds

steps 61000    base_loss: 0.259320    reg_loss: 0.111896    l2_loss: 0.419231    loss: 0.790447
steps 61000    v_Prec: 0.581516  v_Recall: 0.774165  v_F1: 0.664153  v_AUC: 0.909348
steps 61000    running time 3612 seconds

steps 61200    base_loss: 0.250725    reg_loss: 0.110344    l2_loss: 0.417795    loss: 0.778864
steps 61200    v_Prec: 0.575629  v_Recall: 0.785142  v_F1: 0.664257  v_AUC: 0.909575
steps 61200    running time 3623 seconds

steps 61400    base_loss: 0.251180    reg_loss: 0.111521    l2_loss: 0.418021    loss: 0.780722
steps 61400    v_Prec: 0.575076  v_Recall: 0.785462  v_F1: 0.664002  v_AUC: 0.909756
steps 61400    running time 3635 seconds

steps 61600    base_loss: 0.253868    reg_loss: 0.110250    l2_loss: 0.416419    loss: 0.780536
steps 61600    v_Prec: 0.579526  v_Recall: 0.776326  v_F1: 0.663644  v_AUC: 0.909661
steps 61600    running time 3646 seconds

steps 61800    base_loss: 0.254846    reg_loss: 0.110355    l2_loss: 0.417658    loss: 0.782859
steps 61800    v_Prec: 0.581193  v_Recall: 0.775933  v_F1: 0.664591  v_AUC: 0.909657
steps 61800    running time 3656 seconds

steps 62000    base_loss: 0.248667    reg_loss: 0.109956    l2_loss: 0.415084    loss: 0.773708
steps 62000    v_Prec: 0.581240  v_Recall: 0.776252  v_F1: 0.664739  v_AUC: 0.910021
steps 62000    running time 3668 seconds

steps 62200    base_loss: 0.252776    reg_loss: 0.109926    l2_loss: 0.416403    loss: 0.779106
steps 62200    v_Prec: 0.580619  v_Recall: 0.776621  v_F1: 0.664467  v_AUC: 0.910040
steps 62200    running time 3679 seconds

steps 62400    base_loss: 0.254520    reg_loss: 0.111242    l2_loss: 0.414793    loss: 0.780555
steps 62400    v_Prec: 0.584907  v_Recall: 0.772200  v_F1: 0.665629  v_AUC: 0.910270
steps 62400    running time 3690 seconds

steps 62600    base_loss: 0.247905    reg_loss: 0.109772    l2_loss: 0.413454    loss: 0.771131
steps 62600    v_Prec: 0.582743  v_Recall: 0.776400  v_F1: 0.665775  v_AUC: 0.910417
steps 62600    running time 3702 seconds

steps 62800    base_loss: 0.248419    reg_loss: 0.109616    l2_loss: 0.416623    loss: 0.774658
steps 62800    v_Prec: 0.583651  v_Recall: 0.773453  v_F1: 0.665280  v_AUC: 0.910630
steps 62800    running time 3713 seconds

steps 63000    base_loss: 0.252888    reg_loss: 0.110215    l2_loss: 0.413317    loss: 0.776420
steps 63000    v_Prec: 0.581317  v_Recall: 0.778340  v_F1: 0.665554  v_AUC: 0.910771
steps 63000    running time 3724 seconds

steps 63200    base_loss: 0.255272    reg_loss: 0.111521    l2_loss: 0.415628    loss: 0.782421
steps 63200    v_Prec: 0.578270  v_Recall: 0.782539  v_F1: 0.665073  v_AUC: 0.910841
steps 63200    running time 3735 seconds

steps 63400    base_loss: 0.257621    reg_loss: 0.111792    l2_loss: 0.411961    loss: 0.781374
steps 63400    v_Prec: 0.580596  v_Recall: 0.781410  v_F1: 0.666199  v_AUC: 0.911077
steps 63400    running time 3746 seconds

steps 63600    base_loss: 0.253050    reg_loss: 0.111193    l2_loss: 0.413692    loss: 0.777936
steps 63600    v_Prec: 0.582718  v_Recall: 0.778512  v_F1: 0.666534  v_AUC: 0.911411
steps 63600    running time 3757 seconds

steps 63800    base_loss: 0.252486    reg_loss: 0.111347    l2_loss: 0.414899    loss: 0.778732
steps 63800    v_Prec: 0.582318  v_Recall: 0.780452  v_F1: 0.666981  v_AUC: 0.911320
steps 63800    running time 3769 seconds

steps 64000    base_loss: 0.249652    reg_loss: 0.110945    l2_loss: 0.413857    loss: 0.774454
steps 64000    v_Prec: 0.576604  v_Recall: 0.789489  v_F1: 0.666459  v_AUC: 0.911435
steps 64000    running time 3780 seconds

steps 64200    base_loss: 0.251148    reg_loss: 0.111129    l2_loss: 0.414348    loss: 0.776626
steps 64200    v_Prec: 0.586350  v_Recall: 0.772839  v_F1: 0.666801  v_AUC: 0.911820
steps 64200    running time 3791 seconds

steps 64400    base_loss: 0.254806    reg_loss: 0.110171    l2_loss: 0.412511    loss: 0.777488
steps 64400    v_Prec: 0.580123  v_Recall: 0.784848  v_F1: 0.667133  v_AUC: 0.912120
steps 64400    running time 3802 seconds

steps 64600    base_loss: 0.246427    reg_loss: 0.110633    l2_loss: 0.411908    loss: 0.768968
steps 64600    v_Prec: 0.582666  v_Recall: 0.780575  v_F1: 0.667254  v_AUC: 0.912082
steps 64600    running time 3813 seconds

steps 64800    base_loss: 0.245527    reg_loss: 0.109839    l2_loss: 0.411712    loss: 0.767078
steps 64800    v_Prec: 0.576478  v_Recall: 0.792657  v_F1: 0.667501  v_AUC: 0.912152
steps 64800    running time 3825 seconds

steps 65000    base_loss: 0.249370    reg_loss: 0.110721    l2_loss: 0.412989    loss: 0.773080
steps 65000    v_Prec: 0.575032  v_Recall: 0.795088  v_F1: 0.667388  v_AUC: 0.912153
steps 65000    running time 3836 seconds

steps 65200    base_loss: 0.252989    reg_loss: 0.112021    l2_loss: 0.410941    loss: 0.775950
steps 65200    v_Prec: 0.585329  v_Recall: 0.778954  v_F1: 0.668402  v_AUC: 0.912482
steps 65200    running time 3847 seconds

steps 65400    base_loss: 0.249800    reg_loss: 0.111073    l2_loss: 0.412765    loss: 0.773638
steps 65400    v_Prec: 0.586915  v_Recall: 0.776768  v_F1: 0.668626  v_AUC: 0.912572
steps 65400    running time 3859 seconds

steps 65600    base_loss: 0.244746    reg_loss: 0.110803    l2_loss: 0.410049    loss: 0.765599
steps 65600    v_Prec: 0.580338  v_Recall: 0.788360  v_F1: 0.668541  v_AUC: 0.912604
steps 65600    running time 3870 seconds

steps 65800    base_loss: 0.252066    reg_loss: 0.111958    l2_loss: 0.410002    loss: 0.774027
steps 65800    v_Prec: 0.582506  v_Recall: 0.785167  v_F1: 0.668821  v_AUC: 0.912889
steps 65800    running time 3881 seconds

steps 66000    base_loss: 0.254966    reg_loss: 0.110748    l2_loss: 0.409221    loss: 0.774936
steps 66000    v_Prec: 0.582839  v_Recall: 0.784357  v_F1: 0.668747  v_AUC: 0.913142
steps 66000    running time 3893 seconds

steps 66200    base_loss: 0.245389    reg_loss: 0.110933    l2_loss: 0.409706    loss: 0.766028
steps 66200    v_Prec: 0.583181  v_Recall: 0.784602  v_F1: 0.669061  v_AUC: 0.913107
steps 66200    running time 3903 seconds

steps 66400    base_loss: 0.250649    reg_loss: 0.110518    l2_loss: 0.408321    loss: 0.769489
steps 66400    v_Prec: 0.580607  v_Recall: 0.792289  v_F1: 0.670129  v_AUC: 0.913210
steps 66400    running time 3915 seconds

steps 66600    base_loss: 0.249953    reg_loss: 0.111027    l2_loss: 0.406552    loss: 0.767532
steps 66600    v_Prec: 0.582757  v_Recall: 0.788826  v_F1: 0.670312  v_AUC: 0.913272
steps 66600    running time 3926 seconds

steps 66800    base_loss: 0.247466    reg_loss: 0.110871    l2_loss: 0.408323    loss: 0.766660
steps 66800    v_Prec: 0.581466  v_Recall: 0.789563  v_F1: 0.669722  v_AUC: 0.913475
steps 66800    running time 3938 seconds

steps 67000    base_loss: 0.247923    reg_loss: 0.110699    l2_loss: 0.410118    loss: 0.768739
steps 67000    v_Prec: 0.582317  v_Recall: 0.786714  v_F1: 0.669257  v_AUC: 0.913513
steps 67000    running time 3949 seconds

steps 67200    base_loss: 0.247650    reg_loss: 0.109873    l2_loss: 0.407935    loss: 0.765458
steps 67200    v_Prec: 0.584515  v_Recall: 0.785363  v_F1: 0.670215  v_AUC: 0.913915
steps 67200    running time 3960 seconds

steps 67400    base_loss: 0.244253    reg_loss: 0.108426    l2_loss: 0.407187    loss: 0.759866
steps 67400    v_Prec: 0.577479  v_Recall: 0.798232  v_F1: 0.670144  v_AUC: 0.913881
steps 67400    running time 3971 seconds

steps 67600    base_loss: 0.246614    reg_loss: 0.110493    l2_loss: 0.407835    loss: 0.764942
steps 67600    v_Prec: 0.587781  v_Recall: 0.779936  v_F1: 0.670361  v_AUC: 0.913825
steps 67600    running time 3982 seconds

steps 67800    base_loss: 0.248601    reg_loss: 0.109784    l2_loss: 0.407383    loss: 0.765768
steps 67800    v_Prec: 0.581961  v_Recall: 0.793050  v_F1: 0.671302  v_AUC: 0.914233
steps 67800    running time 3993 seconds

steps 68000    base_loss: 0.245301    reg_loss: 0.109554    l2_loss: 0.407675    loss: 0.762530
steps 68000    v_Prec: 0.582438  v_Recall: 0.791970  v_F1: 0.671232  v_AUC: 0.914356
steps 68000    running time 4004 seconds

steps 68200    base_loss: 0.252039    reg_loss: 0.111089    l2_loss: 0.407740    loss: 0.770867
steps 68200    v_Prec: 0.582209  v_Recall: 0.792559  v_F1: 0.671291  v_AUC: 0.914254
steps 68200    running time 4015 seconds

steps 68400    base_loss: 0.244142    reg_loss: 0.109458    l2_loss: 0.406641    loss: 0.760241
steps 68400    v_Prec: 0.585669  v_Recall: 0.786640  v_F1: 0.671439  v_AUC: 0.914165
steps 68400    running time 4026 seconds

steps 68600    base_loss: 0.246947    reg_loss: 0.110233    l2_loss: 0.406143    loss: 0.763323
steps 68600    v_Prec: 0.586655  v_Recall: 0.785486  v_F1: 0.671665  v_AUC: 0.914595
steps 68600    running time 4037 seconds

steps 68800    base_loss: 0.246973    reg_loss: 0.110408    l2_loss: 0.405222    loss: 0.762603
steps 68800    v_Prec: 0.584574  v_Recall: 0.789907  v_F1: 0.671903  v_AUC: 0.914602
steps 68800    running time 4049 seconds

steps 69000    base_loss: 0.248116    reg_loss: 0.110734    l2_loss: 0.406744    loss: 0.765594
steps 69000    v_Prec: 0.586018  v_Recall: 0.786591  v_F1: 0.671650  v_AUC: 0.914703
steps 69000    running time 4060 seconds

steps 69200    base_loss: 0.248422    reg_loss: 0.110857    l2_loss: 0.405007    loss: 0.764285
steps 69200    v_Prec: 0.583680  v_Recall: 0.791552  v_F1: 0.671906  v_AUC: 0.914895
steps 69200    running time 4071 seconds

steps 69400    base_loss: 0.243166    reg_loss: 0.109291    l2_loss: 0.402493    loss: 0.754950
steps 69400    v_Prec: 0.585312  v_Recall: 0.788188  v_F1: 0.671767  v_AUC: 0.915006
steps 69400    running time 4083 seconds

steps 69600    base_loss: 0.242945    reg_loss: 0.111675    l2_loss: 0.404989    loss: 0.759609
steps 69600    v_Prec: 0.583257  v_Recall: 0.793197  v_F1: 0.672217  v_AUC: 0.915131
steps 69600    running time 4093 seconds

steps 69800    base_loss: 0.242853    reg_loss: 0.109507    l2_loss: 0.404068    loss: 0.756428
steps 69800    v_Prec: 0.582902  v_Recall: 0.792829  v_F1: 0.671848  v_AUC: 0.915374
steps 69800    running time 4105 seconds

steps 70000    base_loss: 0.253390    reg_loss: 0.111639    l2_loss: 0.402450    loss: 0.767480
steps 70000    v_Prec: 0.583582  v_Recall: 0.790889  v_F1: 0.671602  v_AUC: 0.915527
steps 70000    running time 4116 seconds

steps 70200    base_loss: 0.243018    reg_loss: 0.110654    l2_loss: 0.405355    loss: 0.759027
steps 70200    v_Prec: 0.580100  v_Recall: 0.800516  v_F1: 0.672713  v_AUC: 0.915703
steps 70200    running time 4127 seconds

steps 70400    base_loss: 0.245279    reg_loss: 0.108939    l2_loss: 0.401638    loss: 0.755856
steps 70400    v_Prec: 0.589966  v_Recall: 0.784357  v_F1: 0.673414  v_AUC: 0.916000
steps 70400    running time 4138 seconds

steps 70600    base_loss: 0.247040    reg_loss: 0.109653    l2_loss: 0.401232    loss: 0.757925
steps 70600    v_Prec: 0.586477  v_Recall: 0.790029  v_F1: 0.673203  v_AUC: 0.916102
steps 70600    running time 4150 seconds

steps 70800    base_loss: 0.240873    reg_loss: 0.109495    l2_loss: 0.403697    loss: 0.754066
steps 70800    v_Prec: 0.589297  v_Recall: 0.784479  v_F1: 0.673022  v_AUC: 0.916122
steps 70800    running time 4161 seconds

steps 71000    base_loss: 0.240435    reg_loss: 0.110696    l2_loss: 0.401509    loss: 0.752640
steps 71000    v_Prec: 0.593814  v_Recall: 0.778389  v_F1: 0.673688  v_AUC: 0.916145
steps 71000    running time 4171 seconds

steps 71200    base_loss: 0.239015    reg_loss: 0.109874    l2_loss: 0.400981    loss: 0.749870
steps 71200    v_Prec: 0.588021  v_Recall: 0.788875  v_F1: 0.673798  v_AUC: 0.916075
steps 71200    running time 4183 seconds

steps 71400    base_loss: 0.244539    reg_loss: 0.109625    l2_loss: 0.402215    loss: 0.756379
steps 71400    v_Prec: 0.582679  v_Recall: 0.798379  v_F1: 0.673685  v_AUC: 0.916207
steps 71400    running time 4194 seconds

steps 71600    base_loss: 0.246348    reg_loss: 0.109983    l2_loss: 0.402491    loss: 0.758822
steps 71600    v_Prec: 0.582460  v_Recall: 0.798379  v_F1: 0.673538  v_AUC: 0.916638
steps 71600    running time 4205 seconds

steps 71800    base_loss: 0.247984    reg_loss: 0.111029    l2_loss: 0.401938    loss: 0.760951
steps 71800    v_Prec: 0.582153  v_Recall: 0.802161  v_F1: 0.674674  v_AUC: 0.916695
steps 71800    running time 4216 seconds

steps 72000    base_loss: 0.245928    reg_loss: 0.109371    l2_loss: 0.403662    loss: 0.758960
steps 72000    v_Prec: 0.583844  v_Recall: 0.797151  v_F1: 0.674024  v_AUC: 0.916678
steps 72000    running time 4227 seconds

steps 72200    base_loss: 0.247118    reg_loss: 0.111819    l2_loss: 0.400113    loss: 0.759050
steps 72200    v_Prec: 0.584554  v_Recall: 0.797790  v_F1: 0.674725  v_AUC: 0.916860
steps 72200    running time 4238 seconds

steps 72400    base_loss: 0.247653    reg_loss: 0.110368    l2_loss: 0.400359    loss: 0.758380
steps 72400    v_Prec: 0.590557  v_Recall: 0.787549  v_F1: 0.674973  v_AUC: 0.917243
steps 72400    running time 4250 seconds

steps 72600    base_loss: 0.251089    reg_loss: 0.111099    l2_loss: 0.400220    loss: 0.762408
steps 72600    v_Prec: 0.584542  v_Recall: 0.798477  v_F1: 0.674963  v_AUC: 0.917283
steps 72600    running time 4262 seconds

steps 72800    base_loss: 0.245512    reg_loss: 0.110852    l2_loss: 0.400213    loss: 0.756578
steps 72800    v_Prec: 0.588994  v_Recall: 0.789342  v_F1: 0.674607  v_AUC: 0.917437
steps 72800    running time 4272 seconds

steps 73000    base_loss: 0.235255    reg_loss: 0.110248    l2_loss: 0.400866    loss: 0.746369
steps 73000    v_Prec: 0.584330  v_Recall: 0.797986  v_F1: 0.674646  v_AUC: 0.917333
steps 73000    running time 4283 seconds

steps 73200    base_loss: 0.238816    reg_loss: 0.109764    l2_loss: 0.399450    loss: 0.748030
steps 73200    v_Prec: 0.588116  v_Recall: 0.793148  v_F1: 0.675415  v_AUC: 0.917483
steps 73200    running time 4294 seconds

steps 73400    base_loss: 0.241526    reg_loss: 0.110320    l2_loss: 0.398972    loss: 0.750819
steps 73400    v_Prec: 0.586932  v_Recall: 0.795039  v_F1: 0.675317  v_AUC: 0.917528
steps 73400    running time 4306 seconds

steps 73600    base_loss: 0.234829    reg_loss: 0.109589    l2_loss: 0.398762    loss: 0.743180
steps 73600    v_Prec: 0.586927  v_Recall: 0.796071  v_F1: 0.675685  v_AUC: 0.917483
steps 73600    running time 4316 seconds

steps 73800    base_loss: 0.241508    reg_loss: 0.109776    l2_loss: 0.399794    loss: 0.751078
steps 73800    v_Prec: 0.590529  v_Recall: 0.789514  v_F1: 0.675676  v_AUC: 0.917771
steps 73800    running time 4328 seconds

steps 74000    base_loss: 0.241125    reg_loss: 0.109620    l2_loss: 0.399365    loss: 0.750110
steps 74000    v_Prec: 0.585083  v_Recall: 0.797937  v_F1: 0.675130  v_AUC: 0.917607
steps 74000    running time 4339 seconds

steps 74200    base_loss: 0.241633    reg_loss: 0.110129    l2_loss: 0.398666    loss: 0.750429
steps 74200    v_Prec: 0.591819  v_Recall: 0.787009  v_F1: 0.675598  v_AUC: 0.917624
steps 74200    running time 4350 seconds

steps 74400    base_loss: 0.242411    reg_loss: 0.110396    l2_loss: 0.397992    loss: 0.750798
steps 74400    v_Prec: 0.589142  v_Recall: 0.792854  v_F1: 0.675984  v_AUC: 0.917973
steps 74400    running time 4361 seconds

steps 74600    base_loss: 0.232412    reg_loss: 0.107727    l2_loss: 0.396998    loss: 0.737137
steps 74600    v_Prec: 0.591948  v_Recall: 0.788998  v_F1: 0.676415  v_AUC: 0.918130
steps 74600    running time 4372 seconds

steps 74800    base_loss: 0.237949    reg_loss: 0.109298    l2_loss: 0.397215    loss: 0.744462
steps 74800    v_Prec: 0.586116  v_Recall: 0.799116  v_F1: 0.676240  v_AUC: 0.918326
steps 74800    running time 4384 seconds

steps 75000    base_loss: 0.239251    reg_loss: 0.109306    l2_loss: 0.397343    loss: 0.745900
steps 75000    v_Prec: 0.587204  v_Recall: 0.800123  v_F1: 0.677324  v_AUC: 0.918253
steps 75000    running time 4395 seconds

steps 75200    base_loss: 0.238089    reg_loss: 0.109568    l2_loss: 0.397719    loss: 0.745376
steps 75200    v_Prec: 0.585284  v_Recall: 0.804420  v_F1: 0.677575  v_AUC: 0.918488
steps 75200    running time 4407 seconds

steps 75400    base_loss: 0.238194    reg_loss: 0.111111    l2_loss: 0.398378    loss: 0.747683
steps 75400    v_Prec: 0.587807  v_Recall: 0.797495  v_F1: 0.676781  v_AUC: 0.918463
steps 75400    running time 4418 seconds

steps 75600    base_loss: 0.241382    reg_loss: 0.110917    l2_loss: 0.396333    loss: 0.748631
steps 75600    v_Prec: 0.590997  v_Recall: 0.792215  v_F1: 0.676971  v_AUC: 0.918462
steps 75600    running time 4429 seconds

steps 75800    base_loss: 0.238665    reg_loss: 0.109959    l2_loss: 0.393171    loss: 0.741795
steps 75800    v_Prec: 0.585910  v_Recall: 0.801842  v_F1: 0.677077  v_AUC: 0.918650
steps 75800    running time 4440 seconds

steps 76000    base_loss: 0.239924    reg_loss: 0.110264    l2_loss: 0.398054    loss: 0.748241
steps 76000    v_Prec: 0.587487  v_Recall: 0.799239  v_F1: 0.677196  v_AUC: 0.918759
steps 76000    running time 4450 seconds

steps 76200    base_loss: 0.232426    reg_loss: 0.107748    l2_loss: 0.395102    loss: 0.735276
steps 76200    v_Prec: 0.598319  v_Recall: 0.779813  v_F1: 0.677115  v_AUC: 0.918926
steps 76200    running time 4461 seconds

steps 76400    base_loss: 0.240580    reg_loss: 0.109550    l2_loss: 0.396203    loss: 0.746333
steps 76400    v_Prec: 0.589410  v_Recall: 0.797151  v_F1: 0.677718  v_AUC: 0.918993
steps 76400    running time 4472 seconds

steps 76600    base_loss: 0.238135    reg_loss: 0.109393    l2_loss: 0.395816    loss: 0.743343
steps 76600    v_Prec: 0.584181  v_Recall: 0.808055  v_F1: 0.678118  v_AUC: 0.919073
steps 76600    running time 4483 seconds

steps 76800    base_loss: 0.236174    reg_loss: 0.109495    l2_loss: 0.396596    loss: 0.742265
steps 76800    v_Prec: 0.592299  v_Recall: 0.792927  v_F1: 0.678084  v_AUC: 0.919062
steps 76800    running time 4495 seconds

steps 77000    base_loss: 0.234658    reg_loss: 0.108526    l2_loss: 0.394002    loss: 0.737186
steps 77000    v_Prec: 0.586168  v_Recall: 0.801547  v_F1: 0.677144  v_AUC: 0.918898
steps 77000    running time 4506 seconds

steps 77200    base_loss: 0.237592    reg_loss: 0.109316    l2_loss: 0.395545    loss: 0.742453
steps 77200    v_Prec: 0.585286  v_Recall: 0.804740  v_F1: 0.677690  v_AUC: 0.919223
steps 77200    running time 4517 seconds

steps 77400    base_loss: 0.231378    reg_loss: 0.108582    l2_loss: 0.393309    loss: 0.733269
steps 77400    v_Prec: 0.583071  v_Recall: 0.808595  v_F1: 0.677559  v_AUC: 0.919260
steps 77400    running time 4527 seconds

steps 77600    base_loss: 0.238321    reg_loss: 0.109752    l2_loss: 0.395307    loss: 0.743380
steps 77600    v_Prec: 0.587963  v_Recall: 0.800810  v_F1: 0.678076  v_AUC: 0.919423
steps 77600    running time 4538 seconds

steps 77800    base_loss: 0.234065    reg_loss: 0.108547    l2_loss: 0.392620    loss: 0.735232
steps 77800    v_Prec: 0.588484  v_Recall: 0.800639  v_F1: 0.678360  v_AUC: 0.919785
steps 77800    running time 4549 seconds

steps 78000    base_loss: 0.235891    reg_loss: 0.110347    l2_loss: 0.393039    loss: 0.739277
steps 78000    v_Prec: 0.591333  v_Recall: 0.795555  v_F1: 0.678408  v_AUC: 0.919835
steps 78000    running time 4560 seconds

steps 78200    base_loss: 0.241015    reg_loss: 0.110009    l2_loss: 0.393776    loss: 0.744799
steps 78200    v_Prec: 0.595186  v_Recall: 0.788752  v_F1: 0.678432  v_AUC: 0.919883
steps 78200    running time 4572 seconds

steps 78400    base_loss: 0.233109    reg_loss: 0.108268    l2_loss: 0.392912    loss: 0.734289
steps 78400    v_Prec: 0.588744  v_Recall: 0.801007  v_F1: 0.678665  v_AUC: 0.919941
steps 78400    running time 4583 seconds

steps 78600    base_loss: 0.237962    reg_loss: 0.109371    l2_loss: 0.394010    loss: 0.741344
steps 78600    v_Prec: 0.583689  v_Recall: 0.810413  v_F1: 0.678614  v_AUC: 0.920164
steps 78600    running time 4594 seconds

steps 78800    base_loss: 0.235743    reg_loss: 0.108827    l2_loss: 0.393696    loss: 0.738265
steps 78800    v_Prec: 0.587335  v_Recall: 0.804052  v_F1: 0.678816  v_AUC: 0.920077
steps 78800    running time 4605 seconds

steps 79000    base_loss: 0.242351    reg_loss: 0.110730    l2_loss: 0.393375    loss: 0.746456
steps 79000    v_Prec: 0.583837  v_Recall: 0.811837  v_F1: 0.679213  v_AUC: 0.920324
steps 79000    running time 4616 seconds

steps 79200    base_loss: 0.239253    reg_loss: 0.110776    l2_loss: 0.392205    loss: 0.742234
steps 79200    v_Prec: 0.580105  v_Recall: 0.817731  v_F1: 0.678720  v_AUC: 0.920204
steps 79200    running time 4628 seconds

steps 79400    base_loss: 0.233852    reg_loss: 0.108924    l2_loss: 0.392038    loss: 0.734814
steps 79400    v_Prec: 0.588888  v_Recall: 0.803242  v_F1: 0.679562  v_AUC: 0.920612
steps 79400    running time 4638 seconds

steps 79600    base_loss: 0.232114    reg_loss: 0.110001    l2_loss: 0.390920    loss: 0.733034
steps 79600    v_Prec: 0.587785  v_Recall: 0.806385  v_F1: 0.679947  v_AUC: 0.920629
steps 79600    running time 4650 seconds

steps 79800    base_loss: 0.235901    reg_loss: 0.109240    l2_loss: 0.389072    loss: 0.734212
steps 79800    v_Prec: 0.583749  v_Recall: 0.813163  v_F1: 0.679618  v_AUC: 0.920559
steps 79800    running time 4661 seconds

steps 80000    base_loss: 0.239281    reg_loss: 0.109123    l2_loss: 0.389347    loss: 0.737750
steps 80000    v_Prec: 0.586580  v_Recall: 0.808694  v_F1: 0.679957  v_AUC: 0.920636
steps 80000    running time 4672 seconds

steps 80200    base_loss: 0.244846    reg_loss: 0.110741    l2_loss: 0.390526    loss: 0.746113
steps 80200    v_Prec: 0.591767  v_Recall: 0.798870  v_F1: 0.679897  v_AUC: 0.920794
steps 80200    running time 4684 seconds

steps 80400    base_loss: 0.236546    reg_loss: 0.107341    l2_loss: 0.388251    loss: 0.732137
steps 80400    v_Prec: 0.581723  v_Recall: 0.817412  v_F1: 0.679716  v_AUC: 0.920657
steps 80400    running time 4694 seconds

steps 80600    base_loss: 0.236735    reg_loss: 0.109290    l2_loss: 0.390343    loss: 0.736368
steps 80600    v_Prec: 0.586961  v_Recall: 0.807662  v_F1: 0.679848  v_AUC: 0.920813
steps 80600    running time 4705 seconds

steps 80800    base_loss: 0.237074    reg_loss: 0.109431    l2_loss: 0.390148    loss: 0.736652
steps 80800    v_Prec: 0.587017  v_Recall: 0.809037  v_F1: 0.680373  v_AUC: 0.920905
steps 80800    running time 4716 seconds

steps 81000    base_loss: 0.237842    reg_loss: 0.109380    l2_loss: 0.391382    loss: 0.738604
steps 81000    v_Prec: 0.590020  v_Recall: 0.806090  v_F1: 0.681335  v_AUC: 0.921004
steps 81000    running time 4728 seconds

steps 81200    base_loss: 0.236340    reg_loss: 0.110506    l2_loss: 0.390953    loss: 0.737798
steps 81200    v_Prec: 0.587018  v_Recall: 0.809283  v_F1: 0.680460  v_AUC: 0.921191
steps 81200    running time 4739 seconds

steps 81400    base_loss: 0.240155    reg_loss: 0.110080    l2_loss: 0.389981    loss: 0.740216
steps 81400    v_Prec: 0.585971  v_Recall: 0.811567  v_F1: 0.680561  v_AUC: 0.921477
steps 81400    running time 4750 seconds

steps 81600    base_loss: 0.235649    reg_loss: 0.110255    l2_loss: 0.387469    loss: 0.733373
steps 81600    v_Prec: 0.588644  v_Recall: 0.806827  v_F1: 0.680679  v_AUC: 0.921392
steps 81600    running time 4761 seconds

steps 81800    base_loss: 0.236361    reg_loss: 0.107996    l2_loss: 0.386835    loss: 0.731192
steps 81800    v_Prec: 0.590195  v_Recall: 0.803880  v_F1: 0.680661  v_AUC: 0.921536
steps 81800    running time 4772 seconds

steps 82000    base_loss: 0.235647    reg_loss: 0.107871    l2_loss: 0.389470    loss: 0.732988
steps 82000    v_Prec: 0.590154  v_Recall: 0.803143  v_F1: 0.680369  v_AUC: 0.921653
steps 82000    running time 4783 seconds

steps 82200    base_loss: 0.235108    reg_loss: 0.107970    l2_loss: 0.387633    loss: 0.730711
steps 82200    v_Prec: 0.595120  v_Recall: 0.795972  v_F1: 0.681046  v_AUC: 0.921542
steps 82200    running time 4793 seconds

steps 82400    base_loss: 0.233195    reg_loss: 0.107959    l2_loss: 0.387242    loss: 0.728396
steps 82400    v_Prec: 0.583085  v_Recall: 0.818468  v_F1: 0.681011  v_AUC: 0.921797
steps 82400    running time 4804 seconds

steps 82600    base_loss: 0.235973    reg_loss: 0.108335    l2_loss: 0.388779    loss: 0.733087
steps 82600    v_Prec: 0.586940  v_Recall: 0.810977  v_F1: 0.681006  v_AUC: 0.921742
steps 82600    running time 4815 seconds

steps 82800    base_loss: 0.233440    reg_loss: 0.108416    l2_loss: 0.388338    loss: 0.730194
steps 82800    v_Prec: 0.589246  v_Recall: 0.808694  v_F1: 0.681745  v_AUC: 0.921900
steps 82800    running time 4825 seconds

steps 83000    base_loss: 0.229193    reg_loss: 0.107172    l2_loss: 0.386803    loss: 0.723169
steps 83000    v_Prec: 0.592707  v_Recall: 0.800344  v_F1: 0.681051  v_AUC: 0.921792
steps 83000    running time 4837 seconds

steps 83200    base_loss: 0.233650    reg_loss: 0.108388    l2_loss: 0.384622    loss: 0.726660
steps 83200    v_Prec: 0.588805  v_Recall: 0.810142  v_F1: 0.681964  v_AUC: 0.922025
steps 83200    running time 4848 seconds

steps 83400    base_loss: 0.234970    reg_loss: 0.109346    l2_loss: 0.386587    loss: 0.730902
steps 83400    v_Prec: 0.589311  v_Recall: 0.810216  v_F1: 0.682330  v_AUC: 0.922167
steps 83400    running time 4859 seconds

steps 83600    base_loss: 0.236891    reg_loss: 0.109772    l2_loss: 0.386409    loss: 0.733071
steps 83600    v_Prec: 0.589934  v_Recall: 0.808276  v_F1: 0.682057  v_AUC: 0.922307
steps 83600    running time 4871 seconds

steps 83800    base_loss: 0.233164    reg_loss: 0.109901    l2_loss: 0.387452    loss: 0.730518
steps 83800    v_Prec: 0.587142  v_Recall: 0.814587  v_F1: 0.682412  v_AUC: 0.922215
steps 83800    running time 4881 seconds

steps 84000    base_loss: 0.238233    reg_loss: 0.110544    l2_loss: 0.386222    loss: 0.735000
steps 84000    v_Prec: 0.584105  v_Recall: 0.819425  v_F1: 0.682038  v_AUC: 0.922141
steps 84000    running time 4893 seconds

steps 84200    base_loss: 0.237613    reg_loss: 0.107876    l2_loss: 0.383326    loss: 0.728815
steps 84200    v_Prec: 0.587945  v_Recall: 0.812525  v_F1: 0.682228  v_AUC: 0.922433
steps 84200    running time 4903 seconds

steps 84400    base_loss: 0.242566    reg_loss: 0.109605    l2_loss: 0.386237    loss: 0.738407
steps 84400    v_Prec: 0.586543  v_Recall: 0.814808  v_F1: 0.682085  v_AUC: 0.922472
steps 84400    running time 4914 seconds

steps 84600    base_loss: 0.239610    reg_loss: 0.109498    l2_loss: 0.387774    loss: 0.736882
steps 84600    v_Prec: 0.591098  v_Recall: 0.806852  v_F1: 0.682326  v_AUC: 0.922556
steps 84600    running time 4925 seconds

steps 84800    base_loss: 0.232642    reg_loss: 0.108160    l2_loss: 0.385478    loss: 0.726281
steps 84800    v_Prec: 0.586518  v_Recall: 0.818173  v_F1: 0.683244  v_AUC: 0.922708
steps 84800    running time 4936 seconds

steps 85000    base_loss: 0.230878    reg_loss: 0.108749    l2_loss: 0.385376    loss: 0.725003
steps 85000    v_Prec: 0.593745  v_Recall: 0.805157  v_F1: 0.683476  v_AUC: 0.922743
steps 85000    running time 4947 seconds

steps 85200    base_loss: 0.239725    reg_loss: 0.109609    l2_loss: 0.386356    loss: 0.735690
steps 85200    v_Prec: 0.591013  v_Recall: 0.809160  v_F1: 0.683093  v_AUC: 0.922613
steps 85200    running time 4959 seconds

steps 85400    base_loss: 0.234572    reg_loss: 0.108709    l2_loss: 0.384562    loss: 0.727844
steps 85400    v_Prec: 0.590578  v_Recall: 0.812451  v_F1: 0.683971  v_AUC: 0.923013
steps 85400    running time 4969 seconds

steps 85600    base_loss: 0.233729    reg_loss: 0.108653    l2_loss: 0.385302    loss: 0.727684
steps 85600    v_Prec: 0.593984  v_Recall: 0.805526  v_F1: 0.683767  v_AUC: 0.922959
steps 85600    running time 4981 seconds

steps 85800    base_loss: 0.233496    reg_loss: 0.107789    l2_loss: 0.384310    loss: 0.725595
steps 85800    v_Prec: 0.592715  v_Recall: 0.807269  v_F1: 0.683552  v_AUC: 0.923286
steps 85800    running time 4992 seconds

steps 86000    base_loss: 0.239060    reg_loss: 0.108612    l2_loss: 0.384382    loss: 0.732054
steps 86000    v_Prec: 0.595560  v_Recall: 0.801842  v_F1: 0.683476  v_AUC: 0.923189
steps 86000    running time 5002 seconds

steps 86200    base_loss: 0.232007    reg_loss: 0.109056    l2_loss: 0.383863    loss: 0.724925
steps 86200    v_Prec: 0.593179  v_Recall: 0.808497  v_F1: 0.684300  v_AUC: 0.923159
steps 86200    running time 5014 seconds

steps 86400    base_loss: 0.231580    reg_loss: 0.108612    l2_loss: 0.384049    loss: 0.724241
steps 86400    v_Prec: 0.594416  v_Recall: 0.805673  v_F1: 0.684106  v_AUC: 0.923373
steps 86400    running time 5025 seconds

steps 86600    base_loss: 0.237318    reg_loss: 0.109500    l2_loss: 0.382913    loss: 0.729730
steps 86600    v_Prec: 0.598364  v_Recall: 0.797446  v_F1: 0.683707  v_AUC: 0.923551
steps 86600    running time 5036 seconds

steps 86800    base_loss: 0.229600    reg_loss: 0.106832    l2_loss: 0.381828    loss: 0.718260
steps 86800    v_Prec: 0.592202  v_Recall: 0.808301  v_F1: 0.683579  v_AUC: 0.923621
steps 86800    running time 5047 seconds

steps 87000    base_loss: 0.233456    reg_loss: 0.108882    l2_loss: 0.382633    loss: 0.724971
steps 87000    v_Prec: 0.588792  v_Recall: 0.816110  v_F1: 0.684060  v_AUC: 0.923591
steps 87000    running time 5058 seconds

steps 87200    base_loss: 0.234563    reg_loss: 0.109080    l2_loss: 0.382555    loss: 0.726198
steps 87200    v_Prec: 0.584651  v_Recall: 0.822790  v_F1: 0.683574  v_AUC: 0.923722
steps 87200    running time 5069 seconds

steps 87400    base_loss: 0.237937    reg_loss: 0.109583    l2_loss: 0.383783    loss: 0.731304
steps 87400    v_Prec: 0.596816  v_Recall: 0.801056  v_F1: 0.684016  v_AUC: 0.923731
steps 87400    running time 5080 seconds

steps 87600    base_loss: 0.233162    reg_loss: 0.107660    l2_loss: 0.383106    loss: 0.723928
steps 87600    v_Prec: 0.588569  v_Recall: 0.815079  v_F1: 0.683548  v_AUC: 0.923883
steps 87600    running time 5091 seconds

steps 87800    base_loss: 0.232500    reg_loss: 0.107788    l2_loss: 0.381985    loss: 0.722273
steps 87800    v_Prec: 0.595525  v_Recall: 0.802628  v_F1: 0.683738  v_AUC: 0.923933
steps 87800    running time 5102 seconds

steps 88000    base_loss: 0.230308    reg_loss: 0.108759    l2_loss: 0.381527    loss: 0.720595
steps 88000    v_Prec: 0.589123  v_Recall: 0.816135  v_F1: 0.684292  v_AUC: 0.923875
steps 88000    running time 5113 seconds

steps 88200    base_loss: 0.233919    reg_loss: 0.109140    l2_loss: 0.383006    loss: 0.726065
steps 88200    v_Prec: 0.590661  v_Recall: 0.814538  v_F1: 0.684766  v_AUC: 0.924204
steps 88200    running time 5123 seconds

steps 88400    base_loss: 0.232206    reg_loss: 0.109313    l2_loss: 0.382606    loss: 0.724125
steps 88400    v_Prec: 0.587830  v_Recall: 0.818443  v_F1: 0.684227  v_AUC: 0.924110
steps 88400    running time 5135 seconds

steps 88600    base_loss: 0.236389    reg_loss: 0.108638    l2_loss: 0.382518    loss: 0.727546
steps 88600    v_Prec: 0.592136  v_Recall: 0.808865  v_F1: 0.683737  v_AUC: 0.924015
steps 88600    running time 5146 seconds

steps 88800    base_loss: 0.225799    reg_loss: 0.108112    l2_loss: 0.382063    loss: 0.715974
steps 88800    v_Prec: 0.589302  v_Recall: 0.816036  v_F1: 0.684379  v_AUC: 0.924197
steps 88800    running time 5157 seconds

steps 89000    base_loss: 0.234236    reg_loss: 0.108904    l2_loss: 0.379942    loss: 0.723083
steps 89000    v_Prec: 0.595576  v_Recall: 0.805943  v_F1: 0.684971  v_AUC: 0.924340
steps 89000    running time 5167 seconds

steps 89200    base_loss: 0.233936    reg_loss: 0.109246    l2_loss: 0.383210    loss: 0.726391
steps 89200    v_Prec: 0.595973  v_Recall: 0.806876  v_F1: 0.685571  v_AUC: 0.924444
steps 89200    running time 5179 seconds

steps 89400    base_loss: 0.228820    reg_loss: 0.107753    l2_loss: 0.380585    loss: 0.717158
steps 89400    v_Prec: 0.591816  v_Recall: 0.814023  v_F1: 0.685358  v_AUC: 0.924263
steps 89400    running time 5190 seconds

steps 89600    base_loss: 0.233481    reg_loss: 0.108075    l2_loss: 0.378724    loss: 0.720279
steps 89600    v_Prec: 0.588592  v_Recall: 0.819794  v_F1: 0.685216  v_AUC: 0.924321
steps 89600    running time 5201 seconds

steps 89800    base_loss: 0.230685    reg_loss: 0.108827    l2_loss: 0.378875    loss: 0.718388
steps 89800    v_Prec: 0.585109  v_Recall: 0.826768  v_F1: 0.685257  v_AUC: 0.924517
steps 89800    running time 5212 seconds

steps 90000    base_loss: 0.237472    reg_loss: 0.108633    l2_loss: 0.381484    loss: 0.727589
steps 90000    v_Prec: 0.589459  v_Recall: 0.818468  v_F1: 0.685338  v_AUC: 0.924607
steps 90000    running time 5223 seconds

steps 90200    base_loss: 0.230075    reg_loss: 0.109237    l2_loss: 0.379401    loss: 0.718712
steps 90200    v_Prec: 0.583196  v_Recall: 0.831655  v_F1: 0.685610  v_AUC: 0.924748
steps 90200    running time 5234 seconds

steps 90400    base_loss: 0.231026    reg_loss: 0.107648    l2_loss: 0.378684    loss: 0.717358
steps 90400    v_Prec: 0.587558  v_Recall: 0.822250  v_F1: 0.685369  v_AUC: 0.924813
steps 90400    running time 5245 seconds

steps 90600    base_loss: 0.229088    reg_loss: 0.108505    l2_loss: 0.379354    loss: 0.716946
steps 90600    v_Prec: 0.584389  v_Recall: 0.829568  v_F1: 0.685721  v_AUC: 0.924739
steps 90600    running time 5256 seconds

steps 90800    base_loss: 0.234214    reg_loss: 0.108907    l2_loss: 0.379353    loss: 0.722474
steps 90800    v_Prec: 0.589294  v_Recall: 0.821046  v_F1: 0.686129  v_AUC: 0.924946
steps 90800    running time 5267 seconds

steps 91000    base_loss: 0.229999    reg_loss: 0.108679    l2_loss: 0.379815    loss: 0.718493
steps 91000    v_Prec: 0.591707  v_Recall: 0.817215  v_F1: 0.686414  v_AUC: 0.925001
steps 91000    running time 5278 seconds

steps 91200    base_loss: 0.229380    reg_loss: 0.108557    l2_loss: 0.380346    loss: 0.718283
steps 91200    v_Prec: 0.588674  v_Recall: 0.822250  v_F1: 0.686128  v_AUC: 0.924955
steps 91200    running time 5290 seconds

steps 91400    base_loss: 0.222220    reg_loss: 0.108681    l2_loss: 0.378815    loss: 0.709716
steps 91400    v_Prec: 0.588904  v_Recall: 0.821906  v_F1: 0.686164  v_AUC: 0.924990
steps 91400    running time 5301 seconds

steps 91600    base_loss: 0.229017    reg_loss: 0.109077    l2_loss: 0.377745    loss: 0.715839
steps 91600    v_Prec: 0.586031  v_Recall: 0.826056  v_F1: 0.685644  v_AUC: 0.925027
steps 91600    running time 5312 seconds

steps 91800    base_loss: 0.227757    reg_loss: 0.107105    l2_loss: 0.377631    loss: 0.712493
steps 91800    v_Prec: 0.588828  v_Recall: 0.819573  v_F1: 0.685298  v_AUC: 0.925281
steps 91800    running time 5322 seconds

steps 92000    base_loss: 0.219546    reg_loss: 0.107813    l2_loss: 0.378119    loss: 0.705478
steps 92000    v_Prec: 0.591106  v_Recall: 0.815791  v_F1: 0.685507  v_AUC: 0.925196
steps 92000    running time 5333 seconds

steps 92200    base_loss: 0.220909    reg_loss: 0.107440    l2_loss: 0.376475    loss: 0.704824
steps 92200    v_Prec: 0.590326  v_Recall: 0.820629  v_F1: 0.686682  v_AUC: 0.925301
steps 92200    running time 5344 seconds

steps 92400    base_loss: 0.227448    reg_loss: 0.107103    l2_loss: 0.377605    loss: 0.712155
steps 92400    v_Prec: 0.589554  v_Recall: 0.822495  v_F1: 0.686811  v_AUC: 0.925274
steps 92400    running time 5356 seconds

steps 92600    base_loss: 0.226926    reg_loss: 0.108551    l2_loss: 0.378266    loss: 0.713742
steps 92600    v_Prec: 0.594537  v_Recall: 0.810290  v_F1: 0.685846  v_AUC: 0.925267
steps 92600    running time 5368 seconds

steps 92800    base_loss: 0.226719    reg_loss: 0.108550    l2_loss: 0.376871    loss: 0.712141
steps 92800    v_Prec: 0.591049  v_Recall: 0.818934  v_F1: 0.686576  v_AUC: 0.925540
steps 92800    running time 5378 seconds

steps 93000    base_loss: 0.225419    reg_loss: 0.108214    l2_loss: 0.376278    loss: 0.709911
steps 93000    v_Prec: 0.597642  v_Recall: 0.807859  v_F1: 0.687029  v_AUC: 0.925689
steps 93000    running time 5389 seconds

steps 93200    base_loss: 0.230672    reg_loss: 0.107978    l2_loss: 0.376568    loss: 0.715218
steps 93200    v_Prec: 0.590634  v_Recall: 0.820751  v_F1: 0.686933  v_AUC: 0.925621
steps 93200    running time 5401 seconds

steps 93400    base_loss: 0.228258    reg_loss: 0.107767    l2_loss: 0.375188    loss: 0.711212
steps 93400    v_Prec: 0.588529  v_Recall: 0.824533  v_F1: 0.686823  v_AUC: 0.925527
steps 93400    running time 5411 seconds

steps 93600    base_loss: 0.226096    reg_loss: 0.108161    l2_loss: 0.376988    loss: 0.711245
steps 93600    v_Prec: 0.587807  v_Recall: 0.824951  v_F1: 0.686476  v_AUC: 0.925507
steps 93600    running time 5422 seconds

steps 93800    base_loss: 0.227340    reg_loss: 0.108574    l2_loss: 0.375444    loss: 0.711357
steps 93800    v_Prec: 0.588940  v_Recall: 0.823576  v_F1: 0.686770  v_AUC: 0.925800
steps 93800    running time 5433 seconds

steps 94000    base_loss: 0.223085    reg_loss: 0.107502    l2_loss: 0.375837    loss: 0.706424
steps 94000    v_Prec: 0.588480  v_Recall: 0.822471  v_F1: 0.686073  v_AUC: 0.925860
steps 94000    running time 5444 seconds

steps 94200    base_loss: 0.227566    reg_loss: 0.107828    l2_loss: 0.375638    loss: 0.711032
steps 94200    v_Prec: 0.593716  v_Recall: 0.812525  v_F1: 0.686097  v_AUC: 0.925698
steps 94200    running time 5455 seconds

steps 94400    base_loss: 0.226460    reg_loss: 0.108388    l2_loss: 0.376236    loss: 0.711083
steps 94400    v_Prec: 0.587672  v_Recall: 0.825786  v_F1: 0.686672  v_AUC: 0.925865
steps 94400    running time 5466 seconds

steps 94600    base_loss: 0.229618    reg_loss: 0.108188    l2_loss: 0.375578    loss: 0.713384
steps 94600    v_Prec: 0.592657  v_Recall: 0.817829  v_F1: 0.687270  v_AUC: 0.925947
steps 94600    running time 5477 seconds

steps 94800    base_loss: 0.231734    reg_loss: 0.108177    l2_loss: 0.375169    loss: 0.715080
steps 94800    v_Prec: 0.588474  v_Recall: 0.825540  v_F1: 0.687135  v_AUC: 0.926040
steps 94800    running time 5488 seconds

steps 95000    base_loss: 0.227613    reg_loss: 0.109758    l2_loss: 0.375402    loss: 0.712773
steps 95000    v_Prec: 0.591767  v_Recall: 0.817240  v_F1: 0.686463  v_AUC: 0.925915
steps 95000    running time 5499 seconds

steps 95200    base_loss: 0.227570    reg_loss: 0.108167    l2_loss: 0.375132    loss: 0.710869
steps 95200    v_Prec: 0.592759  v_Recall: 0.817854  v_F1: 0.687347  v_AUC: 0.926021
steps 95200    running time 5510 seconds

steps 95400    base_loss: 0.223126    reg_loss: 0.106771    l2_loss: 0.374166    loss: 0.704063
steps 95400    v_Prec: 0.590669  v_Recall: 0.822397  v_F1: 0.687533  v_AUC: 0.926080
steps 95400    running time 5521 seconds

steps 95600    base_loss: 0.225012    reg_loss: 0.107115    l2_loss: 0.375875    loss: 0.708002
steps 95600    v_Prec: 0.589359  v_Recall: 0.825319  v_F1: 0.687660  v_AUC: 0.926310
steps 95600    running time 5533 seconds

steps 95800    base_loss: 0.228527    reg_loss: 0.106778    l2_loss: 0.375389    loss: 0.710695
steps 95800    v_Prec: 0.588935  v_Recall: 0.826866  v_F1: 0.687908  v_AUC: 0.926313
steps 95800    running time 5545 seconds

steps 96000    base_loss: 0.226634    reg_loss: 0.108417    l2_loss: 0.374456    loss: 0.709508
steps 96000    v_Prec: 0.594277  v_Recall: 0.817583  v_F1: 0.688271  v_AUC: 0.926340
steps 96000    running time 5556 seconds

steps 96200    base_loss: 0.219239    reg_loss: 0.106339    l2_loss: 0.373711    loss: 0.699289
steps 96200    v_Prec: 0.590194  v_Recall: 0.824460  v_F1: 0.687930  v_AUC: 0.926462
steps 96200    running time 5567 seconds

steps 96400    base_loss: 0.230002    reg_loss: 0.108203    l2_loss: 0.373626    loss: 0.711831
steps 96400    v_Prec: 0.590389  v_Recall: 0.823993  v_F1: 0.687900  v_AUC: 0.926434
steps 96400    running time 5578 seconds

steps 96600    base_loss: 0.223887    reg_loss: 0.107433    l2_loss: 0.373819    loss: 0.705140
steps 96600    v_Prec: 0.589471  v_Recall: 0.828242  v_F1: 0.688750  v_AUC: 0.926393
steps 96600    running time 5589 seconds

steps 96800    base_loss: 0.225560    reg_loss: 0.107645    l2_loss: 0.372083    loss: 0.705288
steps 96800    v_Prec: 0.598385  v_Recall: 0.811861  v_F1: 0.688966  v_AUC: 0.926518
steps 96800    running time 5601 seconds

steps 97000    base_loss: 0.231446    reg_loss: 0.108376    l2_loss: 0.373865    loss: 0.713687
steps 97000    v_Prec: 0.587447  v_Recall: 0.830231  v_F1: 0.688050  v_AUC: 0.926799
steps 97000    running time 5612 seconds

steps 97200    base_loss: 0.223829    reg_loss: 0.108005    l2_loss: 0.372636    loss: 0.704471
steps 97200    v_Prec: 0.592208  v_Recall: 0.821979  v_F1: 0.688427  v_AUC: 0.926720
steps 97200    running time 5623 seconds

steps 97400    base_loss: 0.221846    reg_loss: 0.107618    l2_loss: 0.372552    loss: 0.702016
steps 97400    v_Prec: 0.592625  v_Recall: 0.820580  v_F1: 0.688218  v_AUC: 0.926801
steps 97400    running time 5634 seconds

steps 97600    base_loss: 0.228230    reg_loss: 0.108701    l2_loss: 0.372757    loss: 0.709688
steps 97600    v_Prec: 0.591390  v_Recall: 0.823502  v_F1: 0.688407  v_AUC: 0.926866
steps 97600    running time 5645 seconds

steps 97800    base_loss: 0.226182    reg_loss: 0.108251    l2_loss: 0.373003    loss: 0.707435
steps 97800    v_Prec: 0.591934  v_Recall: 0.820408  v_F1: 0.687691  v_AUC: 0.927057
steps 97800    running time 5656 seconds

steps 98000    base_loss: 0.228624    reg_loss: 0.107924    l2_loss: 0.371513    loss: 0.708061
steps 98000    v_Prec: 0.593408  v_Recall: 0.819769  v_F1: 0.688460  v_AUC: 0.927055
steps 98000    running time 5667 seconds

steps 98200    base_loss: 0.222905    reg_loss: 0.108875    l2_loss: 0.372716    loss: 0.704496
steps 98200    v_Prec: 0.591919  v_Recall: 0.820604  v_F1: 0.687750  v_AUC: 0.926830
steps 98200    running time 5677 seconds

steps 98400    base_loss: 0.227151    reg_loss: 0.107692    l2_loss: 0.371905    loss: 0.706748
steps 98400    v_Prec: 0.593623  v_Recall: 0.818885  v_F1: 0.688292  v_AUC: 0.927172
steps 98400    running time 5688 seconds

steps 98600    base_loss: 0.228487    reg_loss: 0.107613    l2_loss: 0.370402    loss: 0.706502
steps 98600    v_Prec: 0.592076  v_Recall: 0.824632  v_F1: 0.689267  v_AUC: 0.927382
steps 98600    running time 5699 seconds

steps 98800    base_loss: 0.221160    reg_loss: 0.108066    l2_loss: 0.372393    loss: 0.701620
steps 98800    v_Prec: 0.592449  v_Recall: 0.823870  v_F1: 0.689253  v_AUC: 0.927310
steps 98800    running time 5710 seconds

steps 99000    base_loss: 0.221850    reg_loss: 0.108061    l2_loss: 0.371399    loss: 0.701310
steps 99000    v_Prec: 0.589345  v_Recall: 0.829641  v_F1: 0.689147  v_AUC: 0.927287
steps 99000    running time 5721 seconds

steps 99200    base_loss: 0.225591    reg_loss: 0.107889    l2_loss: 0.369547    loss: 0.703026
steps 99200    v_Prec: 0.589606  v_Recall: 0.832195  v_F1: 0.690205  v_AUC: 0.927428
steps 99200    running time 5732 seconds

steps 99400    base_loss: 0.226812    reg_loss: 0.106885    l2_loss: 0.369247    loss: 0.702945
steps 99400    v_Prec: 0.592157  v_Recall: 0.826621  v_F1: 0.690016  v_AUC: 0.927370
steps 99400    running time 5743 seconds

steps 99600    base_loss: 0.229470    reg_loss: 0.108113    l2_loss: 0.371849    loss: 0.709433
steps 99600    v_Prec: 0.588532  v_Recall: 0.833816  v_F1: 0.690024  v_AUC: 0.927389
steps 99600    running time 5754 seconds

steps 99800    base_loss: 0.219893    reg_loss: 0.106848    l2_loss: 0.370116    loss: 0.696858
steps 99800    v_Prec: 0.592172  v_Recall: 0.825639  v_F1: 0.689683  v_AUC: 0.927558
steps 99800    running time 5765 seconds

steps 100000    base_loss: 0.229497    reg_loss: 0.108746    l2_loss: 0.370200    loss: 0.708443
steps 100000    v_Prec: 0.591777  v_Recall: 0.828487  v_F1: 0.690406  v_AUC: 0.927659
steps 100000    running time 5776 seconds

testing thre: 0.23788707
testing Prec: 0.5601290478332913
testing Recall: 0.7406160676716821
testing F1: 0.6378506716651047
testing AUC: 0.885934846166021
overall running time 5785 seconds
(0.5685209698039349, 0.7291101405957545, 0.6388786472570085, 0.885934846166021, 0.2587052)
2019-02-17 04:07:39.577422: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 04:07:40.236372: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 04:07:40.309706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 21.69GiB
2019-02-17 04:07:40.309802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.570000 seconds
loading data in 112.130000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	0.0001
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.902077    reg_loss: 0.214938    l2_loss: 0.886774    loss: 2.003789
steps 200    v_Prec: 0.157083  v_Recall: 0.999557  v_F1: 0.271499  v_AUC: 0.521753
steps 200    running time 129 seconds

steps 400    base_loss: 0.837374    reg_loss: 0.214196    l2_loss: 0.883094    loss: 1.934664
steps 400    v_Prec: 0.159951  v_Recall: 0.911250  v_F1: 0.272135  v_AUC: 0.532312
steps 400    running time 141 seconds

steps 600    base_loss: 0.724999    reg_loss: 0.212510    l2_loss: 0.876269    loss: 1.813778
steps 600    v_Prec: 0.165207  v_Recall: 0.835012  v_F1: 0.275839  v_AUC: 0.548652
steps 600    running time 153 seconds

steps 800    base_loss: 0.608389    reg_loss: 0.210010    l2_loss: 0.861748    loss: 1.680147
steps 800    v_Prec: 0.176670  v_Recall: 0.711186  v_F1: 0.283031  v_AUC: 0.568445
steps 800    running time 165 seconds

steps 1000    base_loss: 0.517756    reg_loss: 0.205667    l2_loss: 0.847759    loss: 1.571181
steps 1000    v_Prec: 0.187402  v_Recall: 0.683573  v_F1: 0.294159  v_AUC: 0.591750
steps 1000    running time 176 seconds

steps 1200    base_loss: 0.462438    reg_loss: 0.201038    l2_loss: 0.820575    loss: 1.484051
steps 1200    v_Prec: 0.205022  v_Recall: 0.619652  v_F1: 0.308103  v_AUC: 0.614552
steps 1200    running time 188 seconds

steps 1400    base_loss: 0.450731    reg_loss: 0.196178    l2_loss: 0.795253    loss: 1.442162
steps 1400    v_Prec: 0.218187  v_Recall: 0.624061  v_F1: 0.323330  v_AUC: 0.636779
steps 1400    running time 199 seconds

steps 1600    base_loss: 0.437297    reg_loss: 0.189781    l2_loss: 0.766336    loss: 1.393415
steps 1600    v_Prec: 0.249646  v_Recall: 0.573195  v_F1: 0.347809  v_AUC: 0.665098
steps 1600    running time 211 seconds

steps 1800    base_loss: 0.433491    reg_loss: 0.183097    l2_loss: 0.733624    loss: 1.350212
steps 1800    v_Prec: 0.298852  v_Recall: 0.536862  v_F1: 0.383965  v_AUC: 0.693187
steps 1800    running time 222 seconds

steps 2000    base_loss: 0.420701    reg_loss: 0.174519    l2_loss: 0.701345    loss: 1.296565
steps 2000    v_Prec: 0.365466  v_Recall: 0.481784  v_F1: 0.415640  v_AUC: 0.708076
steps 2000    running time 234 seconds

steps 2200    base_loss: 0.413590    reg_loss: 0.167011    l2_loss: 0.674072    loss: 1.254673
steps 2200    v_Prec: 0.407601  v_Recall: 0.463655  v_F1: 0.433825  v_AUC: 0.715846
steps 2200    running time 246 seconds

steps 2400    base_loss: 0.397567    reg_loss: 0.158214    l2_loss: 0.640819    loss: 1.196600
steps 2400    v_Prec: 0.410160  v_Recall: 0.475922  v_F1: 0.440601  v_AUC: 0.720588
steps 2400    running time 258 seconds

steps 2600    base_loss: 0.393698    reg_loss: 0.151421    l2_loss: 0.614986    loss: 1.160105
steps 2600    v_Prec: 0.409240  v_Recall: 0.483533  v_F1: 0.443295  v_AUC: 0.725984
steps 2600    running time 269 seconds

steps 2800    base_loss: 0.394508    reg_loss: 0.145413    l2_loss: 0.587825    loss: 1.127746
steps 2800    v_Prec: 0.399559  v_Recall: 0.508757  v_F1: 0.447594  v_AUC: 0.731887
steps 2800    running time 281 seconds

steps 3000    base_loss: 0.387876    reg_loss: 0.140349    l2_loss: 0.562867    loss: 1.091092
steps 3000    v_Prec: 0.404912  v_Recall: 0.515383  v_F1: 0.453517  v_AUC: 0.737465
steps 3000    running time 293 seconds

steps 3200    base_loss: 0.388699    reg_loss: 0.136777    l2_loss: 0.538002    loss: 1.063478
steps 3200    v_Prec: 0.414837  v_Recall: 0.517624  v_F1: 0.460566  v_AUC: 0.745516
steps 3200    running time 304 seconds

steps 3400    base_loss: 0.373451    reg_loss: 0.132448    l2_loss: 0.517786    loss: 1.023685
steps 3400    v_Prec: 0.421773  v_Recall: 0.519817  v_F1: 0.465691  v_AUC: 0.751068
steps 3400    running time 316 seconds

steps 3600    base_loss: 0.380802    reg_loss: 0.130395    l2_loss: 0.499175    loss: 1.010372
steps 3600    v_Prec: 0.422182  v_Recall: 0.538759  v_F1: 0.473399  v_AUC: 0.761035
steps 3600    running time 328 seconds

steps 3800    base_loss: 0.372563    reg_loss: 0.128058    l2_loss: 0.481842    loss: 0.982463
steps 3800    v_Prec: 0.432065  v_Recall: 0.537503  v_F1: 0.479051  v_AUC: 0.769303
steps 3800    running time 339 seconds

steps 4000    base_loss: 0.368210    reg_loss: 0.126260    l2_loss: 0.464386    loss: 0.958857
steps 4000    v_Prec: 0.442701  v_Recall: 0.540779  v_F1: 0.486850  v_AUC: 0.777353
steps 4000    running time 351 seconds

steps 4200    base_loss: 0.367839    reg_loss: 0.124458    l2_loss: 0.448907    loss: 0.941204
steps 4200    v_Prec: 0.452784  v_Recall: 0.548489  v_F1: 0.496062  v_AUC: 0.787805
steps 4200    running time 362 seconds

steps 4400    base_loss: 0.355358    reg_loss: 0.122934    l2_loss: 0.434717    loss: 0.913009
steps 4400    v_Prec: 0.461781  v_Recall: 0.560263  v_F1: 0.506277  v_AUC: 0.796996
steps 4400    running time 374 seconds

steps 4600    base_loss: 0.356022    reg_loss: 0.123043    l2_loss: 0.423649    loss: 0.902714
steps 4600    v_Prec: 0.466591  v_Recall: 0.587236  v_F1: 0.520007  v_AUC: 0.809181
steps 4600    running time 386 seconds

steps 4800    base_loss: 0.341132    reg_loss: 0.121076    l2_loss: 0.411199    loss: 0.873407
steps 4800    v_Prec: 0.470475  v_Recall: 0.610168  v_F1: 0.531293  v_AUC: 0.817920
steps 4800    running time 398 seconds

steps 5000    base_loss: 0.339578    reg_loss: 0.119799    l2_loss: 0.398182    loss: 0.857559
steps 5000    v_Prec: 0.479750  v_Recall: 0.631130  v_F1: 0.545126  v_AUC: 0.829342
steps 5000    running time 409 seconds

steps 5200    base_loss: 0.331157    reg_loss: 0.119192    l2_loss: 0.388843    loss: 0.839193
steps 5200    v_Prec: 0.506526  v_Recall: 0.618519  v_F1: 0.556948  v_AUC: 0.838448
steps 5200    running time 421 seconds

steps 5400    base_loss: 0.323877    reg_loss: 0.118651    l2_loss: 0.379950    loss: 0.822478
steps 5400    v_Prec: 0.508391  v_Recall: 0.649211  v_F1: 0.570236  v_AUC: 0.848235
steps 5400    running time 432 seconds

steps 5600    base_loss: 0.319750    reg_loss: 0.118222    l2_loss: 0.370637    loss: 0.808608
steps 5600    v_Prec: 0.513794  v_Recall: 0.661502  v_F1: 0.578366  v_AUC: 0.854808
steps 5600    running time 444 seconds

steps 5800    base_loss: 0.313713    reg_loss: 0.116364    l2_loss: 0.360855    loss: 0.790932
steps 5800    v_Prec: 0.529665  v_Recall: 0.664556  v_F1: 0.589492  v_AUC: 0.864169
steps 5800    running time 455 seconds

steps 6000    base_loss: 0.311852    reg_loss: 0.116007    l2_loss: 0.352583    loss: 0.780443
steps 6000    v_Prec: 0.527429  v_Recall: 0.692711  v_F1: 0.598876  v_AUC: 0.870380
steps 6000    running time 467 seconds

steps 6200    base_loss: 0.295269    reg_loss: 0.114005    l2_loss: 0.346334    loss: 0.755608
steps 6200    v_Prec: 0.535656  v_Recall: 0.700865  v_F1: 0.607224  v_AUC: 0.876429
steps 6200    running time 478 seconds

steps 6400    base_loss: 0.294146    reg_loss: 0.113205    l2_loss: 0.337856    loss: 0.745207
steps 6400    v_Prec: 0.544426  v_Recall: 0.698057  v_F1: 0.611743  v_AUC: 0.879919
steps 6400    running time 490 seconds

steps 6600    base_loss: 0.290881    reg_loss: 0.111957    l2_loss: 0.330323    loss: 0.733161
steps 6600    v_Prec: 0.545253  v_Recall: 0.720324  v_F1: 0.620679  v_AUC: 0.886019
steps 6600    running time 501 seconds

steps 6800    base_loss: 0.288888    reg_loss: 0.111401    l2_loss: 0.325062    loss: 0.725352
steps 6800    v_Prec: 0.551250  v_Recall: 0.722516  v_F1: 0.625369  v_AUC: 0.890741
steps 6800    running time 513 seconds

steps 7000    base_loss: 0.285879    reg_loss: 0.110211    l2_loss: 0.319745    loss: 0.715835
steps 7000    v_Prec: 0.554177  v_Recall: 0.737370  v_F1: 0.632782  v_AUC: 0.895553
steps 7000    running time 524 seconds

steps 7200    base_loss: 0.278183    reg_loss: 0.108687    l2_loss: 0.310252    loss: 0.697122
steps 7200    v_Prec: 0.570456  v_Recall: 0.716087  v_F1: 0.635029  v_AUC: 0.898332
steps 7200    running time 536 seconds

steps 7400    base_loss: 0.282747    reg_loss: 0.108381    l2_loss: 0.305057    loss: 0.696185
steps 7400    v_Prec: 0.557120  v_Recall: 0.752346  v_F1: 0.640180  v_AUC: 0.902202
steps 7400    running time 547 seconds

steps 7600    base_loss: 0.275034    reg_loss: 0.106118    l2_loss: 0.297770    loss: 0.678923
steps 7600    v_Prec: 0.569635  v_Recall: 0.745548  v_F1: 0.645827  v_AUC: 0.905267
steps 7600    running time 559 seconds

steps 7800    base_loss: 0.269961    reg_loss: 0.105563    l2_loss: 0.292883    loss: 0.668406
steps 7800    v_Prec: 0.567433  v_Recall: 0.755524  v_F1: 0.648107  v_AUC: 0.906940
steps 7800    running time 571 seconds

steps 8000    base_loss: 0.266610    reg_loss: 0.104517    l2_loss: 0.287444    loss: 0.658571
steps 8000    v_Prec: 0.565622  v_Recall: 0.770919  v_F1: 0.652503  v_AUC: 0.910017
steps 8000    running time 582 seconds

steps 8200    base_loss: 0.267733    reg_loss: 0.104356    l2_loss: 0.280990    loss: 0.653079
steps 8200    v_Prec: 0.576452  v_Recall: 0.762421  v_F1: 0.656521  v_AUC: 0.911987
steps 8200    running time 594 seconds

steps 8400    base_loss: 0.264125    reg_loss: 0.102735    l2_loss: 0.276531    loss: 0.643391
steps 8400    v_Prec: 0.571385  v_Recall: 0.777126  v_F1: 0.658561  v_AUC: 0.913975
steps 8400    running time 606 seconds

steps 8600    base_loss: 0.262107    reg_loss: 0.101918    l2_loss: 0.269566    loss: 0.633591
steps 8600    v_Prec: 0.577891  v_Recall: 0.767200  v_F1: 0.659223  v_AUC: 0.915938
steps 8600    running time 617 seconds

steps 8800    base_loss: 0.256830    reg_loss: 0.100216    l2_loss: 0.265758    loss: 0.622804
steps 8800    v_Prec: 0.583927  v_Recall: 0.760844  v_F1: 0.660748  v_AUC: 0.916717
steps 8800    running time 629 seconds

steps 9000    base_loss: 0.259027    reg_loss: 0.100088    l2_loss: 0.261505    loss: 0.620620
steps 9000    v_Prec: 0.570554  v_Recall: 0.792398  v_F1: 0.663422  v_AUC: 0.918388
steps 9000    running time 640 seconds

steps 9200    base_loss: 0.255541    reg_loss: 0.098887    l2_loss: 0.255731    loss: 0.610159
steps 9200    v_Prec: 0.578439  v_Recall: 0.783629  v_F1: 0.665579  v_AUC: 0.919593
steps 9200    running time 652 seconds

steps 9400    base_loss: 0.257669    reg_loss: 0.099153    l2_loss: 0.250068    loss: 0.606890
steps 9400    v_Prec: 0.579372  v_Recall: 0.787176  v_F1: 0.667474  v_AUC: 0.920782
steps 9400    running time 663 seconds

steps 9600    base_loss: 0.250429    reg_loss: 0.096764    l2_loss: 0.244630    loss: 0.591823
steps 9600    v_Prec: 0.578071  v_Recall: 0.788014  v_F1: 0.666910  v_AUC: 0.921662
steps 9600    running time 674 seconds

steps 9800    base_loss: 0.252975    reg_loss: 0.097771    l2_loss: 0.241664    loss: 0.592410
steps 9800    v_Prec: 0.573391  v_Recall: 0.807991  v_F1: 0.670770  v_AUC: 0.922581
steps 9800    running time 685 seconds

steps 10000    base_loss: 0.252354    reg_loss: 0.096278    l2_loss: 0.237363    loss: 0.585996
steps 10000    v_Prec: 0.582503  v_Recall: 0.792004  v_F1: 0.671288  v_AUC: 0.924210
steps 10000    running time 697 seconds

steps 10200    base_loss: 0.249140    reg_loss: 0.094898    l2_loss: 0.232420    loss: 0.576458
steps 10200    v_Prec: 0.572383  v_Recall: 0.812351  v_F1: 0.671574  v_AUC: 0.924333
steps 10200    running time 709 seconds

steps 10400    base_loss: 0.245402    reg_loss: 0.093980    l2_loss: 0.228100    loss: 0.567482
steps 10400    v_Prec: 0.577129  v_Recall: 0.805454  v_F1: 0.672438  v_AUC: 0.925427
steps 10400    running time 720 seconds

steps 10600    base_loss: 0.246597    reg_loss: 0.093207    l2_loss: 0.224237    loss: 0.564041
steps 10600    v_Prec: 0.578443  v_Recall: 0.814568  v_F1: 0.676493  v_AUC: 0.926334
steps 10600    running time 732 seconds

steps 10800    base_loss: 0.245294    reg_loss: 0.092870    l2_loss: 0.220143    loss: 0.558307
steps 10800    v_Prec: 0.576364  v_Recall: 0.820997  v_F1: 0.677267  v_AUC: 0.926938
steps 10800    running time 743 seconds

steps 11000    base_loss: 0.249208    reg_loss: 0.092264    l2_loss: 0.215165    loss: 0.556637
steps 11000    v_Prec: 0.583748  v_Recall: 0.814173  v_F1: 0.679970  v_AUC: 0.928214
steps 11000    running time 755 seconds

steps 11200    base_loss: 0.242678    reg_loss: 0.091360    l2_loss: 0.213820    loss: 0.547859
steps 11200    v_Prec: 0.582888  v_Recall: 0.812228  v_F1: 0.678708  v_AUC: 0.928729
steps 11200    running time 767 seconds

steps 11400    base_loss: 0.245189    reg_loss: 0.091058    l2_loss: 0.208320    loss: 0.544566
steps 11400    v_Prec: 0.588798  v_Recall: 0.804813  v_F1: 0.680064  v_AUC: 0.929102
steps 11400    running time 777 seconds

steps 11600    base_loss: 0.244343    reg_loss: 0.090922    l2_loss: 0.205835    loss: 0.541100
steps 11600    v_Prec: 0.590743  v_Recall: 0.807646  v_F1: 0.682373  v_AUC: 0.929901
steps 11600    running time 789 seconds

steps 11800    base_loss: 0.241940    reg_loss: 0.090690    l2_loss: 0.203047    loss: 0.535676
steps 11800    v_Prec: 0.585122  v_Recall: 0.821292  v_F1: 0.683378  v_AUC: 0.930126
steps 11800    running time 801 seconds

steps 12000    base_loss: 0.244102    reg_loss: 0.089703    l2_loss: 0.199229    loss: 0.533035
steps 12000    v_Prec: 0.585792  v_Recall: 0.822622  v_F1: 0.684295  v_AUC: 0.931009
steps 12000    running time 812 seconds

steps 12200    base_loss: 0.237335    reg_loss: 0.088574    l2_loss: 0.195554    loss: 0.521463
steps 12200    v_Prec: 0.582932  v_Recall: 0.826662  v_F1: 0.683726  v_AUC: 0.931058
steps 12200    running time 824 seconds

steps 12400    base_loss: 0.240099    reg_loss: 0.088712    l2_loss: 0.193351    loss: 0.522162
steps 12400    v_Prec: 0.587456  v_Recall: 0.818780  v_F1: 0.684091  v_AUC: 0.931091
steps 12400    running time 835 seconds

steps 12600    base_loss: 0.237547    reg_loss: 0.088246    l2_loss: 0.190569    loss: 0.516363
steps 12600    v_Prec: 0.584231  v_Recall: 0.823164  v_F1: 0.683416  v_AUC: 0.932229
steps 12600    running time 846 seconds

steps 12800    base_loss: 0.243874    reg_loss: 0.089316    l2_loss: 0.187457    loss: 0.520646
steps 12800    v_Prec: 0.586312  v_Recall: 0.816883  v_F1: 0.682654  v_AUC: 0.932336
steps 12800    running time 857 seconds

steps 13000    base_loss: 0.230595    reg_loss: 0.086453    l2_loss: 0.183815    loss: 0.500863
steps 13000    v_Prec: 0.585083  v_Recall: 0.827032  v_F1: 0.685330  v_AUC: 0.932325
steps 13000    running time 869 seconds

steps 13200    base_loss: 0.240216    reg_loss: 0.087405    l2_loss: 0.182458    loss: 0.510079
steps 13200    v_Prec: 0.587061  v_Recall: 0.830579  v_F1: 0.687904  v_AUC: 0.932993
steps 13200    running time 880 seconds

steps 13400    base_loss: 0.235424    reg_loss: 0.086305    l2_loss: 0.179254    loss: 0.500984
steps 13400    v_Prec: 0.590480  v_Recall: 0.822007  v_F1: 0.687268  v_AUC: 0.933369
steps 13400    running time 892 seconds

steps 13600    base_loss: 0.234917    reg_loss: 0.086303    l2_loss: 0.176944    loss: 0.498164
steps 13600    v_Prec: 0.585264  v_Recall: 0.831786  v_F1: 0.687082  v_AUC: 0.933685
steps 13600    running time 903 seconds

steps 13800    base_loss: 0.236977    reg_loss: 0.086822    l2_loss: 0.174946    loss: 0.498745
steps 13800    v_Prec: 0.586319  v_Recall: 0.832894  v_F1: 0.688186  v_AUC: 0.934296
steps 13800    running time 914 seconds

steps 14000    base_loss: 0.235523    reg_loss: 0.084526    l2_loss: 0.171586    loss: 0.491635
steps 14000    v_Prec: 0.585004  v_Recall: 0.834471  v_F1: 0.687816  v_AUC: 0.934466
steps 14000    running time 925 seconds

steps 14200    base_loss: 0.236556    reg_loss: 0.085588    l2_loss: 0.168848    loss: 0.490992
steps 14200    v_Prec: 0.594146  v_Recall: 0.825061  v_F1: 0.690818  v_AUC: 0.934692
steps 14200    running time 936 seconds

steps 14400    base_loss: 0.238190    reg_loss: 0.084950    l2_loss: 0.167283    loss: 0.490424
steps 14400    v_Prec: 0.585421  v_Recall: 0.842304  v_F1: 0.690752  v_AUC: 0.934987
steps 14400    running time 948 seconds

steps 14600    base_loss: 0.232836    reg_loss: 0.085041    l2_loss: 0.165666    loss: 0.483543
steps 14600    v_Prec: 0.578016  v_Recall: 0.850358  v_F1: 0.688224  v_AUC: 0.934192
steps 14600    running time 959 seconds

steps 14800    base_loss: 0.232412    reg_loss: 0.083858    l2_loss: 0.162563    loss: 0.478833
steps 14800    v_Prec: 0.591873  v_Recall: 0.834150  v_F1: 0.692430  v_AUC: 0.935422
steps 14800    running time 970 seconds

steps 15000    base_loss: 0.230845    reg_loss: 0.083888    l2_loss: 0.161086    loss: 0.475819
steps 15000    v_Prec: 0.588393  v_Recall: 0.838116  v_F1: 0.691396  v_AUC: 0.935469
steps 15000    running time 982 seconds

steps 15200    base_loss: 0.234791    reg_loss: 0.084030    l2_loss: 0.159158    loss: 0.477980
steps 15200    v_Prec: 0.588831  v_Recall: 0.840973  v_F1: 0.692670  v_AUC: 0.935994
steps 15200    running time 993 seconds

steps 15400    base_loss: 0.234027    reg_loss: 0.083977    l2_loss: 0.157302    loss: 0.475306
steps 15400    v_Prec: 0.594001  v_Recall: 0.825430  v_F1: 0.690849  v_AUC: 0.936044
steps 15400    running time 1004 seconds

steps 15600    base_loss: 0.233484    reg_loss: 0.082861    l2_loss: 0.155728    loss: 0.472073
steps 15600    v_Prec: 0.585946  v_Recall: 0.844373  v_F1: 0.691813  v_AUC: 0.935639
steps 15600    running time 1015 seconds

steps 15800    base_loss: 0.225394    reg_loss: 0.081670    l2_loss: 0.153570    loss: 0.460633
steps 15800    v_Prec: 0.592108  v_Recall: 0.842008  v_F1: 0.695285  v_AUC: 0.936328
steps 15800    running time 1026 seconds

steps 16000    base_loss: 0.231898    reg_loss: 0.082226    l2_loss: 0.153298    loss: 0.467423
steps 16000    v_Prec: 0.594185  v_Recall: 0.835185  v_F1: 0.694368  v_AUC: 0.936638
steps 16000    running time 1038 seconds

steps 16200    base_loss: 0.230459    reg_loss: 0.082021    l2_loss: 0.150104    loss: 0.462585
steps 16200    v_Prec: 0.592651  v_Recall: 0.835948  v_F1: 0.693583  v_AUC: 0.936726
steps 16200    running time 1048 seconds

steps 16400    base_loss: 0.231091    reg_loss: 0.081987    l2_loss: 0.150601    loss: 0.463679
steps 16400    v_Prec: 0.598831  v_Recall: 0.830283  v_F1: 0.695815  v_AUC: 0.937295
steps 16400    running time 1059 seconds

steps 16600    base_loss: 0.227527    reg_loss: 0.080551    l2_loss: 0.147290    loss: 0.455367
steps 16600    v_Prec: 0.592179  v_Recall: 0.841860  v_F1: 0.695283  v_AUC: 0.937882
steps 16600    running time 1071 seconds

steps 16800    base_loss: 0.231091    reg_loss: 0.081833    l2_loss: 0.146163    loss: 0.459087
steps 16800    v_Prec: 0.596868  v_Recall: 0.835456  v_F1: 0.696290  v_AUC: 0.937680
steps 16800    running time 1082 seconds

steps 17000    base_loss: 0.228512    reg_loss: 0.080457    l2_loss: 0.143221    loss: 0.452190
steps 17000    v_Prec: 0.592911  v_Recall: 0.841762  v_F1: 0.695754  v_AUC: 0.937809
steps 17000    running time 1093 seconds

steps 17200    base_loss: 0.229039    reg_loss: 0.080283    l2_loss: 0.143094    loss: 0.452416
steps 17200    v_Prec: 0.589315  v_Recall: 0.847181  v_F1: 0.695103  v_AUC: 0.937799
steps 17200    running time 1104 seconds

steps 17400    base_loss: 0.228711    reg_loss: 0.079513    l2_loss: 0.141256    loss: 0.449480
steps 17400    v_Prec: 0.595425  v_Recall: 0.839274  v_F1: 0.696626  v_AUC: 0.938016
steps 17400    running time 1115 seconds

steps 17600    base_loss: 0.230071    reg_loss: 0.080242    l2_loss: 0.140649    loss: 0.450963
steps 17600    v_Prec: 0.595462  v_Recall: 0.833313  v_F1: 0.694590  v_AUC: 0.937287
steps 17600    running time 1127 seconds

steps 17800    base_loss: 0.230041    reg_loss: 0.079886    l2_loss: 0.137578    loss: 0.447505
steps 17800    v_Prec: 0.599784  v_Recall: 0.835579  v_F1: 0.698314  v_AUC: 0.938339
steps 17800    running time 1137 seconds

steps 18000    base_loss: 0.229305    reg_loss: 0.078996    l2_loss: 0.137210    loss: 0.445511
steps 18000    v_Prec: 0.593748  v_Recall: 0.848683  v_F1: 0.698687  v_AUC: 0.938504
steps 18000    running time 1149 seconds

steps 18200    base_loss: 0.226470    reg_loss: 0.079388    l2_loss: 0.135493    loss: 0.441352
steps 18200    v_Prec: 0.591014  v_Recall: 0.848240  v_F1: 0.696641  v_AUC: 0.938241
steps 18200    running time 1161 seconds

steps 18400    base_loss: 0.212724    reg_loss: 0.078966    l2_loss: 0.133615    loss: 0.425304
steps 18400    v_Prec: 0.593071  v_Recall: 0.842501  v_F1: 0.696117  v_AUC: 0.937875
steps 18400    running time 1172 seconds

steps 18600    base_loss: 0.216023    reg_loss: 0.077334    l2_loss: 0.131790    loss: 0.425146
steps 18600    v_Prec: 0.593306  v_Recall: 0.840481  v_F1: 0.695587  v_AUC: 0.937303
steps 18600    running time 1183 seconds

steps 18800    base_loss: 0.213844    reg_loss: 0.077451    l2_loss: 0.132147    loss: 0.423442
steps 18800    v_Prec: 0.595038  v_Recall: 0.835283  v_F1: 0.694984  v_AUC: 0.937616
steps 18800    running time 1194 seconds

steps 19000    base_loss: 0.216340    reg_loss: 0.078266    l2_loss: 0.130750    loss: 0.425355
steps 19000    v_Prec: 0.591172  v_Recall: 0.843240  v_F1: 0.695058  v_AUC: 0.937997
steps 19000    running time 1205 seconds

steps 19200    base_loss: 0.220502    reg_loss: 0.077734    l2_loss: 0.128753    loss: 0.426989
steps 19200    v_Prec: 0.594096  v_Recall: 0.850235  v_F1: 0.699454  v_AUC: 0.938165
steps 19200    running time 1216 seconds

steps 19400    base_loss: 0.221772    reg_loss: 0.078699    l2_loss: 0.128541    loss: 0.429012
steps 19400    v_Prec: 0.598196  v_Recall: 0.836343  v_F1: 0.697502  v_AUC: 0.938258
steps 19400    running time 1228 seconds

steps 19600    base_loss: 0.213209    reg_loss: 0.076809    l2_loss: 0.126464    loss: 0.416481
steps 19600    v_Prec: 0.595229  v_Recall: 0.843338  v_F1: 0.697888  v_AUC: 0.937847
steps 19600    running time 1239 seconds

steps 19800    base_loss: 0.220485    reg_loss: 0.077655    l2_loss: 0.127525    loss: 0.425665
steps 19800    v_Prec: 0.593224  v_Recall: 0.849250  v_F1: 0.698516  v_AUC: 0.938480
steps 19800    running time 1250 seconds

steps 20000    base_loss: 0.211614    reg_loss: 0.075529    l2_loss: 0.124098    loss: 0.411241
steps 20000    v_Prec: 0.608039  v_Recall: 0.824987  v_F1: 0.700091  v_AUC: 0.939436
steps 20000    running time 1261 seconds

steps 20200    base_loss: 0.220738    reg_loss: 0.077491    l2_loss: 0.124140    loss: 0.422370
steps 20200    v_Prec: 0.593251  v_Recall: 0.851787  v_F1: 0.699391  v_AUC: 0.939309
steps 20200    running time 1272 seconds

steps 20400    base_loss: 0.218404    reg_loss: 0.076637    l2_loss: 0.121845    loss: 0.416886
steps 20400    v_Prec: 0.592124  v_Recall: 0.858586  v_F1: 0.700884  v_AUC: 0.939040
steps 20400    running time 1283 seconds

steps 20600    base_loss: 0.221405    reg_loss: 0.077085    l2_loss: 0.121987    loss: 0.420477
steps 20600    v_Prec: 0.597196  v_Recall: 0.856098  v_F1: 0.703585  v_AUC: 0.940180
steps 20600    running time 1295 seconds

steps 20800    base_loss: 0.222958    reg_loss: 0.077787    l2_loss: 0.122159    loss: 0.422904
steps 20800    v_Prec: 0.601551  v_Recall: 0.840826  v_F1: 0.701342  v_AUC: 0.939436
steps 20800    running time 1306 seconds

steps 21000    base_loss: 0.215191    reg_loss: 0.075434    l2_loss: 0.119796    loss: 0.410421
steps 21000    v_Prec: 0.597863  v_Recall: 0.850235  v_F1: 0.702057  v_AUC: 0.939983
steps 21000    running time 1317 seconds

steps 21200    base_loss: 0.210069    reg_loss: 0.073811    l2_loss: 0.118331    loss: 0.402211
steps 21200    v_Prec: 0.595592  v_Recall: 0.858684  v_F1: 0.703340  v_AUC: 0.940147
steps 21200    running time 1328 seconds

steps 21400    base_loss: 0.215621    reg_loss: 0.074771    l2_loss: 0.117623    loss: 0.408016
steps 21400    v_Prec: 0.597181  v_Recall: 0.857723  v_F1: 0.704123  v_AUC: 0.940707
steps 21400    running time 1339 seconds

steps 21600    base_loss: 0.215016    reg_loss: 0.074611    l2_loss: 0.117604    loss: 0.407231
steps 21600    v_Prec: 0.592384  v_Recall: 0.860655  v_F1: 0.701754  v_AUC: 0.940235
steps 21600    running time 1351 seconds

steps 21800    base_loss: 0.212261    reg_loss: 0.074923    l2_loss: 0.116007    loss: 0.403191
steps 21800    v_Prec: 0.599324  v_Recall: 0.856048  v_F1: 0.705043  v_AUC: 0.940711
steps 21800    running time 1362 seconds

steps 22000    base_loss: 0.217028    reg_loss: 0.075136    l2_loss: 0.115543    loss: 0.407706
steps 22000    v_Prec: 0.604652  v_Recall: 0.849644  v_F1: 0.706512  v_AUC: 0.940835
steps 22000    running time 1373 seconds

steps 22200    base_loss: 0.213122    reg_loss: 0.073390    l2_loss: 0.115360    loss: 0.401871
steps 22200    v_Prec: 0.596783  v_Recall: 0.861812  v_F1: 0.705220  v_AUC: 0.941125
steps 22200    running time 1385 seconds

steps 22400    base_loss: 0.221314    reg_loss: 0.074902    l2_loss: 0.114211    loss: 0.410427
steps 22400    v_Prec: 0.599948  v_Recall: 0.857132  v_F1: 0.705843  v_AUC: 0.940904
steps 22400    running time 1396 seconds

steps 22600    base_loss: 0.220353    reg_loss: 0.075275    l2_loss: 0.114375    loss: 0.410004
steps 22600    v_Prec: 0.596656  v_Recall: 0.861320  v_F1: 0.704966  v_AUC: 0.941155
steps 22600    running time 1407 seconds

steps 22800    base_loss: 0.211750    reg_loss: 0.073410    l2_loss: 0.112339    loss: 0.397500
steps 22800    v_Prec: 0.600882  v_Recall: 0.856319  v_F1: 0.706212  v_AUC: 0.941207
steps 22800    running time 1418 seconds

steps 23000    base_loss: 0.211716    reg_loss: 0.073464    l2_loss: 0.111968    loss: 0.397148
steps 23000    v_Prec: 0.599003  v_Recall: 0.861123  v_F1: 0.706535  v_AUC: 0.941137
steps 23000    running time 1429 seconds

steps 23200    base_loss: 0.216106    reg_loss: 0.074121    l2_loss: 0.110793    loss: 0.401020
steps 23200    v_Prec: 0.600287  v_Recall: 0.856714  v_F1: 0.705935  v_AUC: 0.941538
steps 23200    running time 1440 seconds

steps 23400    base_loss: 0.214702    reg_loss: 0.072647    l2_loss: 0.110701    loss: 0.398050
steps 23400    v_Prec: 0.605609  v_Recall: 0.848930  v_F1: 0.706918  v_AUC: 0.941948
steps 23400    running time 1451 seconds

steps 23600    base_loss: 0.215525    reg_loss: 0.073295    l2_loss: 0.110114    loss: 0.398934
steps 23600    v_Prec: 0.608119  v_Recall: 0.847205  v_F1: 0.708023  v_AUC: 0.942424
steps 23600    running time 1463 seconds

steps 23800    base_loss: 0.217413    reg_loss: 0.072864    l2_loss: 0.109064    loss: 0.399340
steps 23800    v_Prec: 0.601534  v_Recall: 0.857945  v_F1: 0.707215  v_AUC: 0.942594
steps 23800    running time 1474 seconds

steps 24000    base_loss: 0.213084    reg_loss: 0.073313    l2_loss: 0.107689    loss: 0.394086
steps 24000    v_Prec: 0.601922  v_Recall: 0.856246  v_F1: 0.706905  v_AUC: 0.942284
steps 24000    running time 1485 seconds

steps 24200    base_loss: 0.214823    reg_loss: 0.072979    l2_loss: 0.108063    loss: 0.395865
steps 24200    v_Prec: 0.605719  v_Recall: 0.855186  v_F1: 0.709153  v_AUC: 0.942766
steps 24200    running time 1496 seconds

steps 24400    base_loss: 0.215704    reg_loss: 0.073932    l2_loss: 0.107800    loss: 0.397437
steps 24400    v_Prec: 0.601169  v_Recall: 0.858610  v_F1: 0.707189  v_AUC: 0.942702
steps 24400    running time 1508 seconds

steps 24600    base_loss: 0.218428    reg_loss: 0.074143    l2_loss: 0.106234    loss: 0.398805
steps 24600    v_Prec: 0.599587  v_Recall: 0.858980  v_F1: 0.706218  v_AUC: 0.942589
steps 24600    running time 1519 seconds

steps 24800    base_loss: 0.212445    reg_loss: 0.072598    l2_loss: 0.106530    loss: 0.391573
steps 24800    v_Prec: 0.604505  v_Recall: 0.859398  v_F1: 0.709761  v_AUC: 0.942960
steps 24800    running time 1530 seconds

steps 25000    base_loss: 0.214770    reg_loss: 0.071834    l2_loss: 0.105900    loss: 0.392504
steps 25000    v_Prec: 0.604904  v_Recall: 0.855630  v_F1: 0.708746  v_AUC: 0.942957
steps 25000    running time 1542 seconds

steps 25200    base_loss: 0.205473    reg_loss: 0.070810    l2_loss: 0.103887    loss: 0.380171
steps 25200    v_Prec: 0.599671  v_Recall: 0.862379  v_F1: 0.707423  v_AUC: 0.942989
steps 25200    running time 1553 seconds

steps 25400    base_loss: 0.211877    reg_loss: 0.072648    l2_loss: 0.105196    loss: 0.389721
steps 25400    v_Prec: 0.608773  v_Recall: 0.846048  v_F1: 0.708061  v_AUC: 0.942976
steps 25400    running time 1564 seconds

steps 25600    base_loss: 0.215436    reg_loss: 0.071985    l2_loss: 0.104318    loss: 0.391740
steps 25600    v_Prec: 0.600635  v_Recall: 0.866591  v_F1: 0.709509  v_AUC: 0.943331
steps 25600    running time 1575 seconds

steps 25800    base_loss: 0.208800    reg_loss: 0.071249    l2_loss: 0.102868    loss: 0.382917
steps 25800    v_Prec: 0.602174  v_Recall: 0.867700  v_F1: 0.710954  v_AUC: 0.943364
steps 25800    running time 1586 seconds

steps 26000    base_loss: 0.212590    reg_loss: 0.071636    l2_loss: 0.103017    loss: 0.387243
steps 26000    v_Prec: 0.606834  v_Recall: 0.858241  v_F1: 0.710967  v_AUC: 0.943660
steps 26000    running time 1598 seconds

steps 26200    base_loss: 0.214274    reg_loss: 0.071587    l2_loss: 0.103081    loss: 0.388941
steps 26200    v_Prec: 0.607846  v_Recall: 0.859103  v_F1: 0.711957  v_AUC: 0.943867
steps 26200    running time 1609 seconds

steps 26400    base_loss: 0.208335    reg_loss: 0.070890    l2_loss: 0.102174    loss: 0.381399
steps 26400    v_Prec: 0.605629  v_Recall: 0.862847  v_F1: 0.711711  v_AUC: 0.943936
steps 26400    running time 1621 seconds

steps 26600    base_loss: 0.216325    reg_loss: 0.071854    l2_loss: 0.102073    loss: 0.390252
steps 26600    v_Prec: 0.602176  v_Recall: 0.871099  v_F1: 0.712094  v_AUC: 0.944089
steps 26600    running time 1632 seconds

steps 26800    base_loss: 0.205826    reg_loss: 0.069792    l2_loss: 0.100560    loss: 0.376178
steps 26800    v_Prec: 0.604758  v_Recall: 0.867207  v_F1: 0.712586  v_AUC: 0.944458
steps 26800    running time 1643 seconds

steps 27000    base_loss: 0.209030    reg_loss: 0.070221    l2_loss: 0.099924    loss: 0.379175
steps 27000    v_Prec: 0.611032  v_Recall: 0.861394  v_F1: 0.714928  v_AUC: 0.945215
steps 27000    running time 1655 seconds

steps 27200    base_loss: 0.215360    reg_loss: 0.072557    l2_loss: 0.100384    loss: 0.388302
steps 27200    v_Prec: 0.609109  v_Recall: 0.856221  v_F1: 0.711828  v_AUC: 0.944572
steps 27200    running time 1667 seconds

steps 27400    base_loss: 0.210187    reg_loss: 0.069850    l2_loss: 0.099157    loss: 0.379194
steps 27400    v_Prec: 0.609121  v_Recall: 0.859719  v_F1: 0.713042  v_AUC: 0.944658
steps 27400    running time 1678 seconds

steps 27600    base_loss: 0.212082    reg_loss: 0.070703    l2_loss: 0.099800    loss: 0.382585
steps 27600    v_Prec: 0.612464  v_Recall: 0.849004  v_F1: 0.711591  v_AUC: 0.944498
steps 27600    running time 1689 seconds

steps 27800    base_loss: 0.208171    reg_loss: 0.069493    l2_loss: 0.097873    loss: 0.375537
steps 27800    v_Prec: 0.610371  v_Recall: 0.860236  v_F1: 0.714077  v_AUC: 0.945377
steps 27800    running time 1699 seconds

steps 28000    base_loss: 0.211679    reg_loss: 0.071143    l2_loss: 0.098503    loss: 0.381324
steps 28000    v_Prec: 0.614114  v_Recall: 0.853364  v_F1: 0.714236  v_AUC: 0.945620
steps 28000    running time 1710 seconds

steps 28200    base_loss: 0.204871    reg_loss: 0.069364    l2_loss: 0.097452    loss: 0.371687
steps 28200    v_Prec: 0.615167  v_Recall: 0.846023  v_F1: 0.712358  v_AUC: 0.945149
steps 28200    running time 1721 seconds

steps 28400    base_loss: 0.207979    reg_loss: 0.070497    l2_loss: 0.098285    loss: 0.376760
steps 28400    v_Prec: 0.615400  v_Recall: 0.852649  v_F1: 0.714854  v_AUC: 0.945317
steps 28400    running time 1732 seconds

steps 28600    base_loss: 0.209926    reg_loss: 0.069851    l2_loss: 0.097330    loss: 0.377107
steps 28600    v_Prec: 0.607816  v_Recall: 0.867700  v_F1: 0.714871  v_AUC: 0.945747
steps 28600    running time 1743 seconds

steps 28800    base_loss: 0.208197    reg_loss: 0.069320    l2_loss: 0.095655    loss: 0.373171
steps 28800    v_Prec: 0.607804  v_Recall: 0.871394  v_F1: 0.716113  v_AUC: 0.945821
steps 28800    running time 1754 seconds

steps 29000    base_loss: 0.214817    reg_loss: 0.070860    l2_loss: 0.096638    loss: 0.382315
steps 29000    v_Prec: 0.612124  v_Recall: 0.859842  v_F1: 0.715139  v_AUC: 0.945454
steps 29000    running time 1766 seconds

steps 29200    base_loss: 0.211192    reg_loss: 0.069134    l2_loss: 0.095893    loss: 0.376219
steps 29200    v_Prec: 0.614072  v_Recall: 0.856270  v_F1: 0.715223  v_AUC: 0.945755
steps 29200    running time 1777 seconds

steps 29400    base_loss: 0.206803    reg_loss: 0.069282    l2_loss: 0.095053    loss: 0.371139
steps 29400    v_Prec: 0.610677  v_Recall: 0.865015  v_F1: 0.715928  v_AUC: 0.946018
steps 29400    running time 1788 seconds

steps 29600    base_loss: 0.206397    reg_loss: 0.068321    l2_loss: 0.093590    loss: 0.368308
steps 29600    v_Prec: 0.614515  v_Recall: 0.862034  v_F1: 0.717528  v_AUC: 0.946374
steps 29600    running time 1799 seconds

steps 29800    base_loss: 0.203872    reg_loss: 0.067898    l2_loss: 0.093988    loss: 0.365758
steps 29800    v_Prec: 0.613753  v_Recall: 0.862946  v_F1: 0.717323  v_AUC: 0.946346
steps 29800    running time 1810 seconds

steps 30000    base_loss: 0.200092    reg_loss: 0.067641    l2_loss: 0.093880    loss: 0.361612
steps 30000    v_Prec: 0.610046  v_Recall: 0.866074  v_F1: 0.715856  v_AUC: 0.946332
steps 30000    running time 1821 seconds

steps 30200    base_loss: 0.210030    reg_loss: 0.069051    l2_loss: 0.093958    loss: 0.373039
steps 30200    v_Prec: 0.612425  v_Recall: 0.864473  v_F1: 0.716941  v_AUC: 0.946321
steps 30200    running time 1832 seconds

steps 30400    base_loss: 0.205061    reg_loss: 0.068880    l2_loss: 0.093013    loss: 0.366954
steps 30400    v_Prec: 0.612483  v_Recall: 0.866320  v_F1: 0.717616  v_AUC: 0.946691
steps 30400    running time 1842 seconds

steps 30600    base_loss: 0.210449    reg_loss: 0.069771    l2_loss: 0.094077    loss: 0.374297
steps 30600    v_Prec: 0.614387  v_Recall: 0.870163  v_F1: 0.720241  v_AUC: 0.947334
steps 30600    running time 1854 seconds

steps 30800    base_loss: 0.208137    reg_loss: 0.068906    l2_loss: 0.092706    loss: 0.369749
steps 30800    v_Prec: 0.613249  v_Recall: 0.863340  v_F1: 0.717115  v_AUC: 0.946934
steps 30800    running time 1865 seconds

steps 31000    base_loss: 0.202947    reg_loss: 0.067845    l2_loss: 0.091863    loss: 0.362655
steps 31000    v_Prec: 0.610364  v_Recall: 0.869202  v_F1: 0.717143  v_AUC: 0.947046
steps 31000    running time 1876 seconds

steps 31200    base_loss: 0.208157    reg_loss: 0.068754    l2_loss: 0.093023    loss: 0.369935
steps 31200    v_Prec: 0.618126  v_Recall: 0.855802  v_F1: 0.717801  v_AUC: 0.947087
steps 31200    running time 1888 seconds

steps 31400    base_loss: 0.208157    reg_loss: 0.068922    l2_loss: 0.091789    loss: 0.368869
steps 31400    v_Prec: 0.617492  v_Recall: 0.856172  v_F1: 0.717503  v_AUC: 0.946885
steps 31400    running time 1898 seconds

steps 31600    base_loss: 0.210681    reg_loss: 0.070078    l2_loss: 0.092045    loss: 0.372804
steps 31600    v_Prec: 0.615622  v_Recall: 0.866074  v_F1: 0.719681  v_AUC: 0.947577
steps 31600    running time 1909 seconds

steps 31800    base_loss: 0.209338    reg_loss: 0.068748    l2_loss: 0.091095    loss: 0.369181
steps 31800    v_Prec: 0.612783  v_Recall: 0.869793  v_F1: 0.719011  v_AUC: 0.947428
steps 31800    running time 1920 seconds

steps 32000    base_loss: 0.204343    reg_loss: 0.068782    l2_loss: 0.091582    loss: 0.364708
steps 32000    v_Prec: 0.614757  v_Recall: 0.863586  v_F1: 0.718231  v_AUC: 0.947461
steps 32000    running time 1931 seconds

steps 32200    base_loss: 0.198617    reg_loss: 0.067039    l2_loss: 0.090738    loss: 0.356395
steps 32200    v_Prec: 0.614094  v_Recall: 0.864621  v_F1: 0.718135  v_AUC: 0.947376
steps 32200    running time 1942 seconds

steps 32400    base_loss: 0.208058    reg_loss: 0.068622    l2_loss: 0.089599    loss: 0.366279
steps 32400    v_Prec: 0.613004  v_Recall: 0.862527  v_F1: 0.716667  v_AUC: 0.947524
steps 32400    running time 1953 seconds

steps 32600    base_loss: 0.210704    reg_loss: 0.068671    l2_loss: 0.088976    loss: 0.368352
steps 32600    v_Prec: 0.612715  v_Recall: 0.876715  v_F1: 0.721318  v_AUC: 0.948071
steps 32600    running time 1964 seconds

steps 32800    base_loss: 0.205829    reg_loss: 0.068291    l2_loss: 0.089972    loss: 0.364092
steps 32800    v_Prec: 0.613974  v_Recall: 0.877306  v_F1: 0.722390  v_AUC: 0.948064
steps 32800    running time 1976 seconds

steps 33000    base_loss: 0.206156    reg_loss: 0.067949    l2_loss: 0.088604    loss: 0.362709
steps 33000    v_Prec: 0.612908  v_Recall: 0.877232  v_F1: 0.721627  v_AUC: 0.947804
steps 33000    running time 1987 seconds

steps 33200    base_loss: 0.201199    reg_loss: 0.067347    l2_loss: 0.088099    loss: 0.356644
steps 33200    v_Prec: 0.614191  v_Recall: 0.874227  v_F1: 0.721494  v_AUC: 0.947883
steps 33200    running time 1998 seconds

steps 33400    base_loss: 0.207985    reg_loss: 0.067792    l2_loss: 0.088828    loss: 0.364605
steps 33400    v_Prec: 0.617635  v_Recall: 0.869621  v_F1: 0.722281  v_AUC: 0.948036
steps 33400    running time 2009 seconds

steps 33600    base_loss: 0.210868    reg_loss: 0.069390    l2_loss: 0.088873    loss: 0.369130
steps 33600    v_Prec: 0.619942  v_Recall: 0.863463  v_F1: 0.721714  v_AUC: 0.948470
steps 33600    running time 2020 seconds

steps 33800    base_loss: 0.206144    reg_loss: 0.068914    l2_loss: 0.088495    loss: 0.363553
steps 33800    v_Prec: 0.614869  v_Recall: 0.874572  v_F1: 0.722079  v_AUC: 0.948089
steps 33800    running time 2031 seconds

steps 34000    base_loss: 0.208783    reg_loss: 0.068181    l2_loss: 0.087414    loss: 0.364378
steps 34000    v_Prec: 0.614975  v_Recall: 0.876025  v_F1: 0.722647  v_AUC: 0.948257
steps 34000    running time 2042 seconds

steps 34200    base_loss: 0.204921    reg_loss: 0.067469    l2_loss: 0.086555    loss: 0.358945
steps 34200    v_Prec: 0.622686  v_Recall: 0.865015  v_F1: 0.724114  v_AUC: 0.948736
steps 34200    running time 2054 seconds

steps 34400    base_loss: 0.206727    reg_loss: 0.067003    l2_loss: 0.086840    loss: 0.360570
steps 34400    v_Prec: 0.616122  v_Recall: 0.877553  v_F1: 0.723959  v_AUC: 0.948561
steps 34400    running time 2065 seconds

steps 34600    base_loss: 0.200396    reg_loss: 0.066534    l2_loss: 0.087127    loss: 0.354057
steps 34600    v_Prec: 0.613862  v_Recall: 0.878538  v_F1: 0.722730  v_AUC: 0.948805
steps 34600    running time 2076 seconds

steps 34800    base_loss: 0.208467    reg_loss: 0.068411    l2_loss: 0.087600    loss: 0.364479
steps 34800    v_Prec: 0.615175  v_Recall: 0.879129  v_F1: 0.723840  v_AUC: 0.948685
steps 34800    running time 2087 seconds

steps 35000    base_loss: 0.202884    reg_loss: 0.067526    l2_loss: 0.086141    loss: 0.356551
steps 35000    v_Prec: 0.609075  v_Recall: 0.882504  v_F1: 0.720727  v_AUC: 0.948356
steps 35000    running time 2098 seconds

steps 35200    base_loss: 0.201125    reg_loss: 0.065862    l2_loss: 0.085507    loss: 0.352494
steps 35200    v_Prec: 0.613098  v_Recall: 0.888243  v_F1: 0.725458  v_AUC: 0.949085
steps 35200    running time 2109 seconds

steps 35400    base_loss: 0.204092    reg_loss: 0.067221    l2_loss: 0.085545    loss: 0.356858
steps 35400    v_Prec: 0.618917  v_Recall: 0.874917  v_F1: 0.724981  v_AUC: 0.949413
steps 35400    running time 2121 seconds

steps 35600    base_loss: 0.204585    reg_loss: 0.068052    l2_loss: 0.085879    loss: 0.358516
steps 35600    v_Prec: 0.624214  v_Recall: 0.860926  v_F1: 0.723706  v_AUC: 0.948593
steps 35600    running time 2132 seconds

steps 35800    base_loss: 0.204686    reg_loss: 0.066998    l2_loss: 0.085377    loss: 0.357061
steps 35800    v_Prec: 0.617974  v_Recall: 0.876050  v_F1: 0.724722  v_AUC: 0.948754
steps 35800    running time 2143 seconds

steps 36000    base_loss: 0.201862    reg_loss: 0.066446    l2_loss: 0.085284    loss: 0.353592
steps 36000    v_Prec: 0.616538  v_Recall: 0.875139  v_F1: 0.723422  v_AUC: 0.949043
steps 36000    running time 2154 seconds

steps 36200    base_loss: 0.209123    reg_loss: 0.067814    l2_loss: 0.084927    loss: 0.361865
steps 36200    v_Prec: 0.616801  v_Recall: 0.876986  v_F1: 0.724234  v_AUC: 0.949446
steps 36200    running time 2165 seconds

steps 36400    base_loss: 0.200409    reg_loss: 0.066665    l2_loss: 0.084295    loss: 0.351369
steps 36400    v_Prec: 0.620017  v_Recall: 0.871173  v_F1: 0.724444  v_AUC: 0.949630
steps 36400    running time 2176 seconds

steps 36600    base_loss: 0.180174    reg_loss: 0.064850    l2_loss: 0.082792    loss: 0.327817
steps 36600    v_Prec: 0.622979  v_Recall: 0.859866  v_F1: 0.722501  v_AUC: 0.948691
steps 36600    running time 2187 seconds

steps 36800    base_loss: 0.180588    reg_loss: 0.065217    l2_loss: 0.083034    loss: 0.328839
steps 36800    v_Prec: 0.613253  v_Recall: 0.867650  v_F1: 0.718600  v_AUC: 0.948241
steps 36800    running time 2198 seconds

steps 37000    base_loss: 0.187248    reg_loss: 0.065883    l2_loss: 0.083746    loss: 0.336877
steps 37000    v_Prec: 0.619549  v_Recall: 0.857453  v_F1: 0.719341  v_AUC: 0.948570
steps 37000    running time 2209 seconds

steps 37200    base_loss: 0.191606    reg_loss: 0.067097    l2_loss: 0.083940    loss: 0.342642
steps 37200    v_Prec: 0.618113  v_Recall: 0.868315  v_F1: 0.722157  v_AUC: 0.948899
steps 37200    running time 2220 seconds

Early stop model F1: 0.725458
testing thre: 0.21322753
testing Prec: 0.393760433085267
testing Recall: 0.8590560206613369
testing F1: 0.5400029185895915
testing AUC: 0.8692197732308575
overall running time 2229 seconds
(0.46397788849692695, 0.7404419552821346, 0.5704799646747788, 0.8692197732308575, 0.38747466)
2019-02-17 04:32:15.544611: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 04:32:16.123248: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 04:32:16.124207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 04:32:16.124244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.920000 seconds
loading data in 110.870000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.902010    reg_loss: 0.215136    l2_loss: 0.883748    loss: 2.000894
steps 200    v_Prec: 0.157314  v_Recall: 0.999557  v_F1: 0.271844  v_AUC: 0.493515
steps 200    running time 128 seconds

steps 400    base_loss: 0.822961    reg_loss: 0.215466    l2_loss: 0.872160    loss: 1.910587
steps 400    v_Prec: 0.157512  v_Recall: 0.992770  v_F1: 0.271886  v_AUC: 0.514643
steps 400    running time 140 seconds

steps 600    base_loss: 0.704581    reg_loss: 0.215225    l2_loss: 0.849503    loss: 1.769309
steps 600    v_Prec: 0.165553  v_Recall: 0.805041  v_F1: 0.274630  v_AUC: 0.545109
steps 600    running time 151 seconds

steps 800    base_loss: 0.591725    reg_loss: 0.214257    l2_loss: 0.811763    loss: 1.617746
steps 800    v_Prec: 0.177599  v_Recall: 0.696594  v_F1: 0.283036  v_AUC: 0.571404
steps 800    running time 163 seconds

steps 1000    base_loss: 0.510838    reg_loss: 0.212243    l2_loss: 0.766396    loss: 1.489478
steps 1000    v_Prec: 0.189338  v_Recall: 0.625009  v_F1: 0.290633  v_AUC: 0.589341
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.462874    reg_loss: 0.208702    l2_loss: 0.711422    loss: 1.382998
steps 1200    v_Prec: 0.221147  v_Recall: 0.538817  v_F1: 0.313588  v_AUC: 0.626171
steps 1200    running time 186 seconds

steps 1400    base_loss: 0.445376    reg_loss: 0.201287    l2_loss: 0.653793    loss: 1.300456
steps 1400    v_Prec: 0.270050  v_Recall: 0.484323  v_F1: 0.346755  v_AUC: 0.662106
steps 1400    running time 197 seconds

steps 1600    base_loss: 0.435942    reg_loss: 0.191444    l2_loss: 0.599889    loss: 1.227275
steps 1600    v_Prec: 0.321302  v_Recall: 0.499988  v_F1: 0.391207  v_AUC: 0.699744
steps 1600    running time 209 seconds

steps 1800    base_loss: 0.422881    reg_loss: 0.180696    l2_loss: 0.547835    loss: 1.151412
steps 1800    v_Prec: 0.370591  v_Recall: 0.516193  v_F1: 0.431439  v_AUC: 0.732237
steps 1800    running time 221 seconds

steps 2000    base_loss: 0.405679    reg_loss: 0.169859    l2_loss: 0.500757    loss: 1.076295
steps 2000    v_Prec: 0.408301  v_Recall: 0.526669  v_F1: 0.459992  v_AUC: 0.754339
steps 2000    running time 233 seconds

steps 2200    base_loss: 0.385061    reg_loss: 0.157007    l2_loss: 0.456758    loss: 0.998826
steps 2200    v_Prec: 0.421700  v_Recall: 0.554531  v_F1: 0.479079  v_AUC: 0.770501
steps 2200    running time 244 seconds

steps 2400    base_loss: 0.377616    reg_loss: 0.146208    l2_loss: 0.422023    loss: 0.945846
steps 2400    v_Prec: 0.433266  v_Recall: 0.576196  v_F1: 0.494612  v_AUC: 0.784621
steps 2400    running time 256 seconds

steps 2600    base_loss: 0.366510    reg_loss: 0.135878    l2_loss: 0.389593    loss: 0.891981
steps 2600    v_Prec: 0.457499  v_Recall: 0.579048  v_F1: 0.511147  v_AUC: 0.799100
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.365180    reg_loss: 0.129225    l2_loss: 0.362029    loss: 0.856434
steps 2800    v_Prec: 0.468766  v_Recall: 0.598820  v_F1: 0.525871  v_AUC: 0.812449
steps 2800    running time 279 seconds

steps 3000    base_loss: 0.347910    reg_loss: 0.122082    l2_loss: 0.338597    loss: 0.808589
steps 3000    v_Prec: 0.486593  v_Recall: 0.599311  v_F1: 0.537102  v_AUC: 0.822622
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.344171    reg_loss: 0.117302    l2_loss: 0.315192    loss: 0.776665
steps 3200    v_Prec: 0.489376  v_Recall: 0.639444  v_F1: 0.554435  v_AUC: 0.834870
steps 3200    running time 302 seconds

steps 3400    base_loss: 0.331990    reg_loss: 0.113653    l2_loss: 0.298235    loss: 0.743878
steps 3400    v_Prec: 0.507152  v_Recall: 0.646969  v_F1: 0.568591  v_AUC: 0.845782
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.314893    reg_loss: 0.108958    l2_loss: 0.281643    loss: 0.705494
steps 3600    v_Prec: 0.512674  v_Recall: 0.668462  v_F1: 0.580294  v_AUC: 0.853893
steps 3600    running time 324 seconds

steps 3800    base_loss: 0.317315    reg_loss: 0.107270    l2_loss: 0.265997    loss: 0.690582
steps 3800    v_Prec: 0.531886  v_Recall: 0.679503  v_F1: 0.596700  v_AUC: 0.863250
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.308603    reg_loss: 0.105824    l2_loss: 0.252229    loss: 0.666656
steps 4000    v_Prec: 0.531753  v_Recall: 0.711619  v_F1: 0.608676  v_AUC: 0.872129
steps 4000    running time 348 seconds

steps 4200    base_loss: 0.296039    reg_loss: 0.103537    l2_loss: 0.239058    loss: 0.638634
steps 4200    v_Prec: 0.562426  v_Recall: 0.687372  v_F1: 0.618653  v_AUC: 0.879463
steps 4200    running time 359 seconds

steps 4400    base_loss: 0.298502    reg_loss: 0.101280    l2_loss: 0.227497    loss: 0.627280
steps 4400    v_Prec: 0.557656  v_Recall: 0.724136  v_F1: 0.630085  v_AUC: 0.885169
steps 4400    running time 371 seconds

steps 4600    base_loss: 0.287338    reg_loss: 0.098824    l2_loss: 0.217908    loss: 0.604070
steps 4600    v_Prec: 0.560622  v_Recall: 0.734440  v_F1: 0.635866  v_AUC: 0.890066
steps 4600    running time 382 seconds

steps 4800    base_loss: 0.287532    reg_loss: 0.098632    l2_loss: 0.207432    loss: 0.593595
steps 4800    v_Prec: 0.568486  v_Recall: 0.739137  v_F1: 0.642676  v_AUC: 0.894761
steps 4800    running time 394 seconds

steps 5000    base_loss: 0.284034    reg_loss: 0.097627    l2_loss: 0.200267    loss: 0.581928
steps 5000    v_Prec: 0.574979  v_Recall: 0.741399  v_F1: 0.647669  v_AUC: 0.899539
steps 5000    running time 406 seconds

steps 5200    base_loss: 0.270081    reg_loss: 0.094038    l2_loss: 0.191531    loss: 0.555650
steps 5200    v_Prec: 0.576953  v_Recall: 0.756842  v_F1: 0.654767  v_AUC: 0.903913
steps 5200    running time 417 seconds

steps 5400    base_loss: 0.269636    reg_loss: 0.092350    l2_loss: 0.183173    loss: 0.545160
steps 5400    v_Prec: 0.577501  v_Recall: 0.765769  v_F1: 0.658441  v_AUC: 0.906792
steps 5400    running time 429 seconds

steps 5600    base_loss: 0.269560    reg_loss: 0.091645    l2_loss: 0.176302    loss: 0.537507
steps 5600    v_Prec: 0.571854  v_Recall: 0.788811  v_F1: 0.663036  v_AUC: 0.910022
steps 5600    running time 440 seconds

steps 5800    base_loss: 0.264334    reg_loss: 0.090683    l2_loss: 0.169517    loss: 0.524534
steps 5800    v_Prec: 0.581554  v_Recall: 0.777794  v_F1: 0.665509  v_AUC: 0.911605
steps 5800    running time 452 seconds

steps 6000    base_loss: 0.260965    reg_loss: 0.089374    l2_loss: 0.163170    loss: 0.513510
steps 6000    v_Prec: 0.581856  v_Recall: 0.788614  v_F1: 0.669639  v_AUC: 0.913826
steps 6000    running time 463 seconds

steps 6200    base_loss: 0.265367    reg_loss: 0.089105    l2_loss: 0.157434    loss: 0.511906
steps 6200    v_Prec: 0.588943  v_Recall: 0.784040  v_F1: 0.672630  v_AUC: 0.916655
steps 6200    running time 475 seconds

steps 6400    base_loss: 0.254652    reg_loss: 0.087062    l2_loss: 0.151356    loss: 0.493069
steps 6400    v_Prec: 0.580987  v_Recall: 0.799238  v_F1: 0.672857  v_AUC: 0.918838
steps 6400    running time 487 seconds

steps 6600    base_loss: 0.256687    reg_loss: 0.087316    l2_loss: 0.146123    loss: 0.490127
steps 6600    v_Prec: 0.593483  v_Recall: 0.782073  v_F1: 0.674850  v_AUC: 0.919629
steps 6600    running time 498 seconds

steps 6800    base_loss: 0.257925    reg_loss: 0.086093    l2_loss: 0.141492    loss: 0.485510
steps 6800    v_Prec: 0.586501  v_Recall: 0.803246  v_F1: 0.677972  v_AUC: 0.921848
steps 6800    running time 510 seconds

steps 7000    base_loss: 0.256989    reg_loss: 0.086398    l2_loss: 0.135774    loss: 0.479161
steps 7000    v_Prec: 0.582982  v_Recall: 0.812935  v_F1: 0.679018  v_AUC: 0.922531
steps 7000    running time 521 seconds

steps 7200    base_loss: 0.254516    reg_loss: 0.085076    l2_loss: 0.132656    loss: 0.472249
steps 7200    v_Prec: 0.584367  v_Recall: 0.821075  v_F1: 0.682788  v_AUC: 0.923886
steps 7200    running time 533 seconds

steps 7400    base_loss: 0.248572    reg_loss: 0.082211    l2_loss: 0.126439    loss: 0.457223
steps 7400    v_Prec: 0.593221  v_Recall: 0.809517  v_F1: 0.684693  v_AUC: 0.924470
steps 7400    running time 544 seconds

steps 7600    base_loss: 0.252258    reg_loss: 0.084123    l2_loss: 0.123477    loss: 0.459859
steps 7600    v_Prec: 0.587669  v_Recall: 0.818517  v_F1: 0.684145  v_AUC: 0.924962
steps 7600    running time 556 seconds

steps 7800    base_loss: 0.251202    reg_loss: 0.083066    l2_loss: 0.119324    loss: 0.453591
steps 7800    v_Prec: 0.590425  v_Recall: 0.815197  v_F1: 0.684840  v_AUC: 0.926380
steps 7800    running time 567 seconds

steps 8000    base_loss: 0.245373    reg_loss: 0.080835    l2_loss: 0.114888    loss: 0.441096
steps 8000    v_Prec: 0.585439  v_Recall: 0.826583  v_F1: 0.685420  v_AUC: 0.926020
steps 8000    running time 578 seconds

steps 8200    base_loss: 0.246874    reg_loss: 0.080854    l2_loss: 0.111549    loss: 0.439277
steps 8200    v_Prec: 0.588873  v_Recall: 0.821960  v_F1: 0.686162  v_AUC: 0.926874
steps 8200    running time 590 seconds

steps 8400    base_loss: 0.248013    reg_loss: 0.081124    l2_loss: 0.108460    loss: 0.437597
steps 8400    v_Prec: 0.584920  v_Recall: 0.832510  v_F1: 0.687091  v_AUC: 0.927147
steps 8400    running time 601 seconds

steps 8600    base_loss: 0.246047    reg_loss: 0.079730    l2_loss: 0.104944    loss: 0.430721
steps 8600    v_Prec: 0.591531  v_Recall: 0.821394  v_F1: 0.687765  v_AUC: 0.927025
steps 8600    running time 613 seconds

steps 8800    base_loss: 0.241568    reg_loss: 0.079393    l2_loss: 0.103324    loss: 0.424285
steps 8800    v_Prec: 0.585504  v_Recall: 0.833542  v_F1: 0.687846  v_AUC: 0.926734
steps 8800    running time 624 seconds

steps 9000    base_loss: 0.242338    reg_loss: 0.079316    l2_loss: 0.100019    loss: 0.421673
steps 9000    v_Prec: 0.584960  v_Recall: 0.836665  v_F1: 0.688530  v_AUC: 0.927306
steps 9000    running time 636 seconds

steps 9200    base_loss: 0.245413    reg_loss: 0.078699    l2_loss: 0.097825    loss: 0.421937
steps 9200    v_Prec: 0.585473  v_Recall: 0.839862  v_F1: 0.689967  v_AUC: 0.927552
steps 9200    running time 648 seconds

steps 9400    base_loss: 0.243026    reg_loss: 0.079430    l2_loss: 0.095421    loss: 0.417877
steps 9400    v_Prec: 0.589239  v_Recall: 0.833788  v_F1: 0.690501  v_AUC: 0.927528
steps 9400    running time 659 seconds

steps 9600    base_loss: 0.248624    reg_loss: 0.079616    l2_loss: 0.093447    loss: 0.421688
steps 9600    v_Prec: 0.582900  v_Recall: 0.837920  v_F1: 0.687523  v_AUC: 0.928298
steps 9600    running time 671 seconds

steps 9800    base_loss: 0.244752    reg_loss: 0.077433    l2_loss: 0.091856    loss: 0.414041
steps 9800    v_Prec: 0.590802  v_Recall: 0.830813  v_F1: 0.690547  v_AUC: 0.929424
steps 9800    running time 682 seconds

steps 10000    base_loss: 0.243867    reg_loss: 0.077676    l2_loss: 0.090410    loss: 0.411953
steps 10000    v_Prec: 0.589856  v_Recall: 0.830542  v_F1: 0.689807  v_AUC: 0.929352
steps 10000    running time 693 seconds

steps 10200    base_loss: 0.241986    reg_loss: 0.076636    l2_loss: 0.087919    loss: 0.406541
steps 10200    v_Prec: 0.591484  v_Recall: 0.831132  v_F1: 0.691123  v_AUC: 0.928957
steps 10200    running time 704 seconds

steps 10400    base_loss: 0.239023    reg_loss: 0.076732    l2_loss: 0.085847    loss: 0.401602
steps 10400    v_Prec: 0.583810  v_Recall: 0.850584  v_F1: 0.692389  v_AUC: 0.929263
steps 10400    running time 716 seconds

steps 10600    base_loss: 0.244974    reg_loss: 0.077425    l2_loss: 0.085123    loss: 0.407522
steps 10600    v_Prec: 0.588095  v_Recall: 0.839690  v_F1: 0.691726  v_AUC: 0.929298
steps 10600    running time 727 seconds

steps 10800    base_loss: 0.238811    reg_loss: 0.075348    l2_loss: 0.084411    loss: 0.398570
steps 10800    v_Prec: 0.578127  v_Recall: 0.858355  v_F1: 0.690908  v_AUC: 0.928709
steps 10800    running time 738 seconds

steps 11000    base_loss: 0.243314    reg_loss: 0.076959    l2_loss: 0.082570    loss: 0.402843
steps 11000    v_Prec: 0.585288  v_Recall: 0.843871  v_F1: 0.691186  v_AUC: 0.928171
steps 11000    running time 750 seconds

steps 11200    base_loss: 0.236372    reg_loss: 0.076413    l2_loss: 0.080935    loss: 0.393720
steps 11200    v_Prec: 0.586898  v_Recall: 0.844461  v_F1: 0.692506  v_AUC: 0.927820
steps 11200    running time 761 seconds

steps 11400    base_loss: 0.239837    reg_loss: 0.074745    l2_loss: 0.079664    loss: 0.394246
steps 11400    v_Prec: 0.585692  v_Recall: 0.847190  v_F1: 0.692580  v_AUC: 0.928359
steps 11400    running time 772 seconds

steps 11600    base_loss: 0.244985    reg_loss: 0.075272    l2_loss: 0.079300    loss: 0.399557
steps 11600    v_Prec: 0.587791  v_Recall: 0.843649  v_F1: 0.692854  v_AUC: 0.929330
steps 11600    running time 784 seconds

steps 11800    base_loss: 0.246659    reg_loss: 0.075542    l2_loss: 0.078933    loss: 0.401134
steps 11800    v_Prec: 0.586367  v_Recall: 0.845297  v_F1: 0.692417  v_AUC: 0.929492
steps 11800    running time 795 seconds

steps 12000    base_loss: 0.241650    reg_loss: 0.075512    l2_loss: 0.078486    loss: 0.395648
steps 12000    v_Prec: 0.592630  v_Recall: 0.832116  v_F1: 0.692246  v_AUC: 0.929105
steps 12000    running time 806 seconds

steps 12200    base_loss: 0.240075    reg_loss: 0.074207    l2_loss: 0.077242    loss: 0.391524
steps 12200    v_Prec: 0.595131  v_Recall: 0.830739  v_F1: 0.693469  v_AUC: 0.929028
steps 12200    running time 817 seconds

steps 12400    base_loss: 0.242159    reg_loss: 0.075458    l2_loss: 0.076431    loss: 0.394048
steps 12400    v_Prec: 0.590951  v_Recall: 0.843723  v_F1: 0.695069  v_AUC: 0.929401
steps 12400    running time 829 seconds

steps 12600    base_loss: 0.238672    reg_loss: 0.073950    l2_loss: 0.076606    loss: 0.389228
steps 12600    v_Prec: 0.596815  v_Recall: 0.830346  v_F1: 0.694474  v_AUC: 0.929579
steps 12600    running time 841 seconds

steps 12800    base_loss: 0.233760    reg_loss: 0.073590    l2_loss: 0.075679    loss: 0.383029
steps 12800    v_Prec: 0.589426  v_Recall: 0.848272  v_F1: 0.695548  v_AUC: 0.929388
steps 12800    running time 852 seconds

steps 13000    base_loss: 0.238100    reg_loss: 0.074068    l2_loss: 0.075411    loss: 0.387579
steps 13000    v_Prec: 0.603121  v_Recall: 0.820239  v_F1: 0.695120  v_AUC: 0.929632
steps 13000    running time 863 seconds

steps 13200    base_loss: 0.240807    reg_loss: 0.073752    l2_loss: 0.073997    loss: 0.388557
steps 13200    v_Prec: 0.588410  v_Recall: 0.852945  v_F1: 0.696402  v_AUC: 0.930018
steps 13200    running time 874 seconds

steps 13400    base_loss: 0.237782    reg_loss: 0.073439    l2_loss: 0.074187    loss: 0.385408
steps 13400    v_Prec: 0.586360  v_Recall: 0.851617  v_F1: 0.694523  v_AUC: 0.930311
steps 13400    running time 886 seconds

steps 13600    base_loss: 0.238317    reg_loss: 0.073500    l2_loss: 0.073804    loss: 0.385622
steps 13600    v_Prec: 0.590429  v_Recall: 0.842862  v_F1: 0.694416  v_AUC: 0.929960
steps 13600    running time 897 seconds

steps 13800    base_loss: 0.242337    reg_loss: 0.072960    l2_loss: 0.073768    loss: 0.389066
steps 13800    v_Prec: 0.589519  v_Recall: 0.841780  v_F1: 0.693419  v_AUC: 0.930195
steps 13800    running time 908 seconds

steps 14000    base_loss: 0.241523    reg_loss: 0.073484    l2_loss: 0.073835    loss: 0.388842
steps 14000    v_Prec: 0.591407  v_Recall: 0.835387  v_F1: 0.692537  v_AUC: 0.929476
steps 14000    running time 919 seconds

steps 14200    base_loss: 0.242898    reg_loss: 0.073719    l2_loss: 0.074237    loss: 0.390853
steps 14200    v_Prec: 0.586521  v_Recall: 0.847928  v_F1: 0.693406  v_AUC: 0.930208
steps 14200    running time 930 seconds

steps 14400    base_loss: 0.240810    reg_loss: 0.072956    l2_loss: 0.073768    loss: 0.387534
steps 14400    v_Prec: 0.590321  v_Recall: 0.838092  v_F1: 0.692717  v_AUC: 0.929162
steps 14400    running time 941 seconds

steps 14600    base_loss: 0.239129    reg_loss: 0.073467    l2_loss: 0.073117    loss: 0.385712
steps 14600    v_Prec: 0.594169  v_Recall: 0.837870  v_F1: 0.695283  v_AUC: 0.929734
steps 14600    running time 952 seconds

steps 14800    base_loss: 0.239228    reg_loss: 0.071468    l2_loss: 0.073010    loss: 0.383706
steps 14800    v_Prec: 0.593433  v_Recall: 0.839592  v_F1: 0.695371  v_AUC: 0.929898
steps 14800    running time 963 seconds

steps 15000    base_loss: 0.235812    reg_loss: 0.070905    l2_loss: 0.071684    loss: 0.378401
steps 15000    v_Prec: 0.596448  v_Recall: 0.828354  v_F1: 0.693528  v_AUC: 0.929687
steps 15000    running time 974 seconds

steps 15200    base_loss: 0.242903    reg_loss: 0.073093    l2_loss: 0.072837    loss: 0.388833
steps 15200    v_Prec: 0.596849  v_Recall: 0.829042  v_F1: 0.694040  v_AUC: 0.929744
steps 15200    running time 985 seconds

Early stop model F1: 0.696402
testing thre: 0.24847034
testing Prec: 0.5354398948342178
testing Recall: 0.7978264970038159
testing F1: 0.6408143762819318
testing AUC: 0.8898239133951568
overall running time 994 seconds
(0.5642358116267034, 0.7593331495480332, 0.6474055655551638, 0.8898239133951568, 0.32031223)
2019-02-17 04:43:45.455773: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 04:43:46.124351: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 04:43:46.125305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 04:43:46.125352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 88.220000 seconds
loading data in 110.380000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-08
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.603804    reg_loss: 0.213682    l2_loss: 0.884833    loss: 1.702319
steps 200    v_Prec: 0.161422  v_Recall: 0.876143  v_F1: 0.272617  v_AUC: 0.537237
steps 200    running time 127 seconds

steps 400    base_loss: 0.566571    reg_loss: 0.212864    l2_loss: 0.868877    loss: 1.648312
steps 400    v_Prec: 0.167045  v_Recall: 0.799029  v_F1: 0.276322  v_AUC: 0.551913
steps 400    running time 139 seconds

steps 600    base_loss: 0.521728    reg_loss: 0.211844    l2_loss: 0.842157    loss: 1.575730
steps 600    v_Prec: 0.175425  v_Recall: 0.735695  v_F1: 0.283298  v_AUC: 0.572542
steps 600    running time 151 seconds

steps 800    base_loss: 0.478829    reg_loss: 0.209112    l2_loss: 0.799305    loss: 1.487246
steps 800    v_Prec: 0.192709  v_Recall: 0.628824  v_F1: 0.295010  v_AUC: 0.598209
steps 800    running time 162 seconds

steps 1000    base_loss: 0.457300    reg_loss: 0.205415    l2_loss: 0.749552    loss: 1.412267
steps 1000    v_Prec: 0.212629  v_Recall: 0.604763  v_F1: 0.314635  v_AUC: 0.629000
steps 1000    running time 174 seconds

steps 1200    base_loss: 0.448919    reg_loss: 0.200465    l2_loss: 0.695656    loss: 1.345040
steps 1200    v_Prec: 0.249855  v_Recall: 0.542909  v_F1: 0.342217  v_AUC: 0.660822
steps 1200    running time 185 seconds

steps 1400    base_loss: 0.449951    reg_loss: 0.193826    l2_loss: 0.641197    loss: 1.284975
steps 1400    v_Prec: 0.308633  v_Recall: 0.487316  v_F1: 0.377918  v_AUC: 0.693118
steps 1400    running time 197 seconds

steps 1600    base_loss: 0.436766    reg_loss: 0.185097    l2_loss: 0.582973    loss: 1.204836
steps 1600    v_Prec: 0.364658  v_Recall: 0.484925  v_F1: 0.416279  v_AUC: 0.718768
steps 1600    running time 209 seconds

steps 1800    base_loss: 0.426231    reg_loss: 0.175570    l2_loss: 0.532173    loss: 1.133974
steps 1800    v_Prec: 0.391077  v_Recall: 0.511082  v_F1: 0.443098  v_AUC: 0.738417
steps 1800    running time 220 seconds

steps 2000    base_loss: 0.409853    reg_loss: 0.164737    l2_loss: 0.484496    loss: 1.059086
steps 2000    v_Prec: 0.393906  v_Recall: 0.534132  v_F1: 0.453425  v_AUC: 0.754724
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.398941    reg_loss: 0.153356    l2_loss: 0.443136    loss: 0.995434
steps 2200    v_Prec: 0.389819  v_Recall: 0.574662  v_F1: 0.464528  v_AUC: 0.769857
steps 2200    running time 243 seconds

steps 2400    base_loss: 0.393278    reg_loss: 0.143113    l2_loss: 0.404730    loss: 0.941121
steps 2400    v_Prec: 0.398473  v_Recall: 0.594483  v_F1: 0.477132  v_AUC: 0.784827
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.376801    reg_loss: 0.134101    l2_loss: 0.374941    loss: 0.885843
steps 2600    v_Prec: 0.414135  v_Recall: 0.597490  v_F1: 0.489196  v_AUC: 0.797862
steps 2600    running time 266 seconds

steps 2800    base_loss: 0.364674    reg_loss: 0.126012    l2_loss: 0.344366    loss: 0.835052
steps 2800    v_Prec: 0.420540  v_Recall: 0.626482  v_F1: 0.503258  v_AUC: 0.810784
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.356474    reg_loss: 0.120627    l2_loss: 0.319848    loss: 0.796949
steps 3000    v_Prec: 0.433177  v_Recall: 0.649237  v_F1: 0.519643  v_AUC: 0.824840
steps 3000    running time 289 seconds

steps 3200    base_loss: 0.349410    reg_loss: 0.116912    l2_loss: 0.298771    loss: 0.765092
steps 3200    v_Prec: 0.459320  v_Recall: 0.650248  v_F1: 0.538357  v_AUC: 0.839554
steps 3200    running time 301 seconds

steps 3400    base_loss: 0.338814    reg_loss: 0.113063    l2_loss: 0.278671    loss: 0.730549
steps 3400    v_Prec: 0.483644  v_Recall: 0.667406  v_F1: 0.560857  v_AUC: 0.854972
steps 3400    running time 312 seconds

steps 3600    base_loss: 0.324450    reg_loss: 0.109585    l2_loss: 0.263899    loss: 0.697935
steps 3600    v_Prec: 0.510082  v_Recall: 0.667899  v_F1: 0.578419  v_AUC: 0.867141
steps 3600    running time 324 seconds

steps 3800    base_loss: 0.308940    reg_loss: 0.105170    l2_loss: 0.247180    loss: 0.661291
steps 3800    v_Prec: 0.518398  v_Recall: 0.696719  v_F1: 0.594474  v_AUC: 0.877515
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.300597    reg_loss: 0.102730    l2_loss: 0.232218    loss: 0.635545
steps 4000    v_Prec: 0.534425  v_Recall: 0.702290  v_F1: 0.606965  v_AUC: 0.885736
steps 4000    running time 347 seconds

steps 4200    base_loss: 0.289538    reg_loss: 0.099925    l2_loss: 0.221307    loss: 0.610771
steps 4200    v_Prec: 0.529191  v_Recall: 0.742105  v_F1: 0.617819  v_AUC: 0.892248
steps 4200    running time 359 seconds

steps 4400    base_loss: 0.287050    reg_loss: 0.098260    l2_loss: 0.209329    loss: 0.594639
steps 4400    v_Prec: 0.540528  v_Recall: 0.754111  v_F1: 0.629701  v_AUC: 0.899405
steps 4400    running time 370 seconds

steps 4600    base_loss: 0.282417    reg_loss: 0.096380    l2_loss: 0.199553    loss: 0.578351
steps 4600    v_Prec: 0.550671  v_Recall: 0.749230  v_F1: 0.634786  v_AUC: 0.903719
steps 4600    running time 382 seconds

steps 4800    base_loss: 0.268117    reg_loss: 0.093256    l2_loss: 0.189187    loss: 0.550559
steps 4800    v_Prec: 0.551102  v_Recall: 0.763306  v_F1: 0.640074  v_AUC: 0.906584
steps 4800    running time 393 seconds

steps 5000    base_loss: 0.274408    reg_loss: 0.092327    l2_loss: 0.181690    loss: 0.548425
steps 5000    v_Prec: 0.568707  v_Recall: 0.741957  v_F1: 0.643882  v_AUC: 0.910220
steps 5000    running time 405 seconds

steps 5200    base_loss: 0.269488    reg_loss: 0.091061    l2_loss: 0.172713    loss: 0.533262
steps 5200    v_Prec: 0.567017  v_Recall: 0.766758  v_F1: 0.651931  v_AUC: 0.913255
steps 5200    running time 416 seconds

steps 5400    base_loss: 0.260684    reg_loss: 0.088907    l2_loss: 0.164249    loss: 0.513840
steps 5400    v_Prec: 0.559914  v_Recall: 0.787812  v_F1: 0.654595  v_AUC: 0.915775
steps 5400    running time 428 seconds

steps 5600    base_loss: 0.261499    reg_loss: 0.087066    l2_loss: 0.157442    loss: 0.506007
steps 5600    v_Prec: 0.572616  v_Recall: 0.772946  v_F1: 0.657868  v_AUC: 0.917732
steps 5600    running time 439 seconds

steps 5800    base_loss: 0.255887    reg_loss: 0.086525    l2_loss: 0.149794    loss: 0.492206
steps 5800    v_Prec: 0.571629  v_Recall: 0.784705  v_F1: 0.661430  v_AUC: 0.919551
steps 5800    running time 450 seconds

steps 6000    base_loss: 0.252553    reg_loss: 0.083730    l2_loss: 0.142445    loss: 0.478728
steps 6000    v_Prec: 0.573245  v_Recall: 0.792520  v_F1: 0.665280  v_AUC: 0.921588
steps 6000    running time 462 seconds

steps 6200    base_loss: 0.250648    reg_loss: 0.084121    l2_loss: 0.137859    loss: 0.472628
steps 6200    v_Prec: 0.571071  v_Recall: 0.803663  v_F1: 0.667691  v_AUC: 0.922638
steps 6200    running time 473 seconds

steps 6400    base_loss: 0.245272    reg_loss: 0.082951    l2_loss: 0.132819    loss: 0.461043
steps 6400    v_Prec: 0.577602  v_Recall: 0.797747  v_F1: 0.670056  v_AUC: 0.923812
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.245295    reg_loss: 0.082390    l2_loss: 0.127888    loss: 0.455574
steps 6600    v_Prec: 0.579453  v_Recall: 0.801888  v_F1: 0.672761  v_AUC: 0.925605
steps 6600    running time 496 seconds

steps 6800    base_loss: 0.238692    reg_loss: 0.079923    l2_loss: 0.122756    loss: 0.441371
steps 6800    v_Prec: 0.573231  v_Recall: 0.810788  v_F1: 0.671622  v_AUC: 0.926102
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.240351    reg_loss: 0.079561    l2_loss: 0.118338    loss: 0.438250
steps 7000    v_Prec: 0.581264  v_Recall: 0.804280  v_F1: 0.674823  v_AUC: 0.927135
steps 7000    running time 519 seconds

steps 7200    base_loss: 0.244426    reg_loss: 0.080974    l2_loss: 0.116233    loss: 0.441633
steps 7200    v_Prec: 0.584409  v_Recall: 0.805808  v_F1: 0.677479  v_AUC: 0.927884
steps 7200    running time 530 seconds

steps 7400    base_loss: 0.241853    reg_loss: 0.078346    l2_loss: 0.111215    loss: 0.431415
steps 7400    v_Prec: 0.576231  v_Recall: 0.823583  v_F1: 0.678053  v_AUC: 0.929309
steps 7400    running time 542 seconds

steps 7600    base_loss: 0.237514    reg_loss: 0.078645    l2_loss: 0.107996    loss: 0.424155
steps 7600    v_Prec: 0.578423  v_Recall: 0.822794  v_F1: 0.679299  v_AUC: 0.929974
steps 7600    running time 553 seconds

steps 7800    base_loss: 0.238786    reg_loss: 0.077354    l2_loss: 0.104505    loss: 0.420645
steps 7800    v_Prec: 0.582295  v_Recall: 0.817149  v_F1: 0.680016  v_AUC: 0.929918
steps 7800    running time 565 seconds

steps 8000    base_loss: 0.240324    reg_loss: 0.077120    l2_loss: 0.101747    loss: 0.419191
steps 8000    v_Prec: 0.583876  v_Recall: 0.818258  v_F1: 0.681477  v_AUC: 0.930301
steps 8000    running time 576 seconds

steps 8200    base_loss: 0.234508    reg_loss: 0.076797    l2_loss: 0.099087    loss: 0.410392
steps 8200    v_Prec: 0.583988  v_Recall: 0.818948  v_F1: 0.681793  v_AUC: 0.930968
steps 8200    running time 588 seconds

steps 8400    base_loss: 0.233756    reg_loss: 0.076196    l2_loss: 0.096677    loss: 0.406629
steps 8400    v_Prec: 0.584970  v_Recall: 0.821537  v_F1: 0.683359  v_AUC: 0.931592
steps 8400    running time 599 seconds

steps 8600    base_loss: 0.234888    reg_loss: 0.075354    l2_loss: 0.094242    loss: 0.404484
steps 8600    v_Prec: 0.579879  v_Recall: 0.832557  v_F1: 0.683617  v_AUC: 0.932165
steps 8600    running time 610 seconds

steps 8800    base_loss: 0.234969    reg_loss: 0.076439    l2_loss: 0.092831    loss: 0.404239
steps 8800    v_Prec: 0.578132  v_Recall: 0.835564  v_F1: 0.683409  v_AUC: 0.932381
steps 8800    running time 622 seconds

steps 9000    base_loss: 0.231063    reg_loss: 0.074630    l2_loss: 0.091224    loss: 0.396917
steps 9000    v_Prec: 0.584932  v_Recall: 0.825161  v_F1: 0.684584  v_AUC: 0.932866
steps 9000    running time 633 seconds

steps 9200    base_loss: 0.237198    reg_loss: 0.074940    l2_loss: 0.088833    loss: 0.400971
steps 9200    v_Prec: 0.585485  v_Recall: 0.830141  v_F1: 0.686672  v_AUC: 0.933182
steps 9200    running time 644 seconds

steps 9400    base_loss: 0.241847    reg_loss: 0.076377    l2_loss: 0.088327    loss: 0.406552
steps 9400    v_Prec: 0.590541  v_Recall: 0.822794  v_F1: 0.687584  v_AUC: 0.933761
steps 9400    running time 655 seconds

steps 9600    base_loss: 0.236109    reg_loss: 0.074383    l2_loss: 0.086222    loss: 0.396714
steps 9600    v_Prec: 0.593498  v_Recall: 0.819540  v_F1: 0.688439  v_AUC: 0.933794
steps 9600    running time 667 seconds

steps 9800    base_loss: 0.235331    reg_loss: 0.074570    l2_loss: 0.084668    loss: 0.394569
steps 9800    v_Prec: 0.576189  v_Recall: 0.846165  v_F1: 0.685555  v_AUC: 0.933570
steps 9800    running time 678 seconds

steps 10000    base_loss: 0.233578    reg_loss: 0.074579    l2_loss: 0.084446    loss: 0.392603
steps 10000    v_Prec: 0.584645  v_Recall: 0.831645  v_F1: 0.686606  v_AUC: 0.933234
steps 10000    running time 689 seconds

steps 10200    base_loss: 0.232205    reg_loss: 0.072825    l2_loss: 0.082756    loss: 0.387785
steps 10200    v_Prec: 0.585675  v_Recall: 0.833789  v_F1: 0.688048  v_AUC: 0.933492
steps 10200    running time 700 seconds

steps 10400    base_loss: 0.232163    reg_loss: 0.073094    l2_loss: 0.080365    loss: 0.385621
steps 10400    v_Prec: 0.587407  v_Recall: 0.830954  v_F1: 0.688271  v_AUC: 0.933919
steps 10400    running time 711 seconds

steps 10600    base_loss: 0.231188    reg_loss: 0.071944    l2_loss: 0.079806    loss: 0.382937
steps 10600    v_Prec: 0.588346  v_Recall: 0.835096  v_F1: 0.690334  v_AUC: 0.934516
steps 10600    running time 722 seconds

steps 10800    base_loss: 0.237361    reg_loss: 0.072852    l2_loss: 0.079181    loss: 0.389394
steps 10800    v_Prec: 0.589859  v_Recall: 0.835121  v_F1: 0.691383  v_AUC: 0.934625
steps 10800    running time 733 seconds

steps 11000    base_loss: 0.232782    reg_loss: 0.072786    l2_loss: 0.078849    loss: 0.384417
steps 11000    v_Prec: 0.594953  v_Recall: 0.826492  v_F1: 0.691865  v_AUC: 0.934730
steps 11000    running time 745 seconds

steps 11200    base_loss: 0.234462    reg_loss: 0.071976    l2_loss: 0.078010    loss: 0.384448
steps 11200    v_Prec: 0.587543  v_Recall: 0.845574  v_F1: 0.693329  v_AUC: 0.934878
steps 11200    running time 756 seconds

steps 11400    base_loss: 0.229647    reg_loss: 0.070563    l2_loss: 0.076035    loss: 0.376245
steps 11400    v_Prec: 0.589769  v_Recall: 0.834209  v_F1: 0.691009  v_AUC: 0.934328
steps 11400    running time 768 seconds

steps 11600    base_loss: 0.233658    reg_loss: 0.072491    l2_loss: 0.075538    loss: 0.381687
steps 11600    v_Prec: 0.588400  v_Recall: 0.837611  v_F1: 0.691229  v_AUC: 0.934460
steps 11600    running time 779 seconds

steps 11800    base_loss: 0.232636    reg_loss: 0.070874    l2_loss: 0.074963    loss: 0.378474
steps 11800    v_Prec: 0.594872  v_Recall: 0.827626  v_F1: 0.692207  v_AUC: 0.934565
steps 11800    running time 789 seconds

steps 12000    base_loss: 0.234414    reg_loss: 0.070602    l2_loss: 0.075050    loss: 0.380066
steps 12000    v_Prec: 0.585268  v_Recall: 0.849543  v_F1: 0.693067  v_AUC: 0.934819
steps 12000    running time 800 seconds

steps 12200    base_loss: 0.231794    reg_loss: 0.070297    l2_loss: 0.074364    loss: 0.376456
steps 12200    v_Prec: 0.594658  v_Recall: 0.829352  v_F1: 0.692665  v_AUC: 0.934553
steps 12200    running time 811 seconds

steps 12400    base_loss: 0.226901    reg_loss: 0.069446    l2_loss: 0.074249    loss: 0.370596
steps 12400    v_Prec: 0.593741  v_Recall: 0.826961  v_F1: 0.691208  v_AUC: 0.934068
steps 12400    running time 822 seconds

steps 12600    base_loss: 0.228387    reg_loss: 0.069261    l2_loss: 0.073275    loss: 0.370923
steps 12600    v_Prec: 0.586942  v_Recall: 0.840643  v_F1: 0.691250  v_AUC: 0.934173
steps 12600    running time 833 seconds

steps 12800    base_loss: 0.231898    reg_loss: 0.070037    l2_loss: 0.073471    loss: 0.375406
steps 12800    v_Prec: 0.589126  v_Recall: 0.836378  v_F1: 0.691309  v_AUC: 0.934314
steps 12800    running time 844 seconds

steps 13000    base_loss: 0.239219    reg_loss: 0.071178    l2_loss: 0.072480    loss: 0.382878
steps 13000    v_Prec: 0.585400  v_Recall: 0.841999  v_F1: 0.690636  v_AUC: 0.934255
steps 13000    running time 855 seconds

steps 13200    base_loss: 0.228822    reg_loss: 0.069206    l2_loss: 0.071604    loss: 0.369631
steps 13200    v_Prec: 0.591228  v_Recall: 0.831127  v_F1: 0.690946  v_AUC: 0.934143
steps 13200    running time 866 seconds

Early stop model F1: 0.693329
testing thre: 0.2655509
testing Prec: 0.45098415746519444
testing Recall: 0.8178058937043862
testing F1: 0.5813688428631105
testing AUC: 0.8839385059383893
overall running time 875 seconds
(0.479736037635688, 0.7605084081774786, 0.5883409380454487, 0.8839385059383893, 0.34707558)
2019-02-17 04:53:59.151266: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 04:53:59.641380: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 04:53:59.642311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 04:53:59.642353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.420000 seconds
loading data in 111.320000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.0
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 1.301245    reg_loss: 0.000000    l2_loss: 0.887155    loss: 2.188400
steps 200    v_Prec: 0.157003  v_Recall: 0.999975  v_F1: 0.271395  v_AUC: 0.500628
steps 200    running time 128 seconds

steps 400    base_loss: 1.197537    reg_loss: 0.000000    l2_loss: 0.874070    loss: 2.071607
steps 400    v_Prec: 0.157599  v_Recall: 0.982162  v_F1: 0.271614  v_AUC: 0.519045
steps 400    running time 140 seconds

steps 600    base_loss: 1.003446    reg_loss: 0.000000    l2_loss: 0.846453    loss: 1.849899
steps 600    v_Prec: 0.165855  v_Recall: 0.814620  v_F1: 0.275598  v_AUC: 0.547809
steps 600    running time 151 seconds

steps 800    base_loss: 0.769346    reg_loss: 0.000000    l2_loss: 0.811120    loss: 1.580466
steps 800    v_Prec: 0.179391  v_Recall: 0.697194  v_F1: 0.285358  v_AUC: 0.576491
steps 800    running time 163 seconds

steps 1000    base_loss: 0.575803    reg_loss: 0.000000    l2_loss: 0.768777    loss: 1.344580
steps 1000    v_Prec: 0.188857  v_Recall: 0.677310  v_F1: 0.295358  v_AUC: 0.598472
steps 1000    running time 175 seconds

steps 1200    base_loss: 0.479972    reg_loss: 0.000000    l2_loss: 0.718931    loss: 1.198902
steps 1200    v_Prec: 0.214938  v_Recall: 0.581615  v_F1: 0.313880  v_AUC: 0.626734
steps 1200    running time 187 seconds

steps 1400    base_loss: 0.448326    reg_loss: 0.000000    l2_loss: 0.664828    loss: 1.113154
steps 1400    v_Prec: 0.248360  v_Recall: 0.538251  v_F1: 0.339889  v_AUC: 0.659608
steps 1400    running time 198 seconds

steps 1600    base_loss: 0.432912    reg_loss: 0.000000    l2_loss: 0.610511    loss: 1.043422
steps 1600    v_Prec: 0.315591  v_Recall: 0.496119  v_F1: 0.385780  v_AUC: 0.699714
steps 1600    running time 210 seconds

steps 1800    base_loss: 0.428637    reg_loss: 0.000000    l2_loss: 0.551859    loss: 0.980495
steps 1800    v_Prec: 0.382527  v_Recall: 0.498066  v_F1: 0.432716  v_AUC: 0.730173
steps 1800    running time 222 seconds

steps 2000    base_loss: 0.425277    reg_loss: 0.000000    l2_loss: 0.506056    loss: 0.931333
steps 2000    v_Prec: 0.400077  v_Recall: 0.538128  v_F1: 0.458946  v_AUC: 0.746528
steps 2000    running time 233 seconds

steps 2200    base_loss: 0.416820    reg_loss: 0.000000    l2_loss: 0.460044    loss: 0.876864
steps 2200    v_Prec: 0.414265  v_Recall: 0.539483  v_F1: 0.468654  v_AUC: 0.757990
steps 2200    running time 245 seconds

steps 2400    base_loss: 0.406052    reg_loss: 0.000000    l2_loss: 0.421973    loss: 0.828026
steps 2400    v_Prec: 0.410196  v_Recall: 0.578289  v_F1: 0.479950  v_AUC: 0.771061
steps 2400    running time 256 seconds

steps 2600    base_loss: 0.394782    reg_loss: 0.000000    l2_loss: 0.386652    loss: 0.781434
steps 2600    v_Prec: 0.416602  v_Recall: 0.607879  v_F1: 0.494384  v_AUC: 0.784754
steps 2600    running time 268 seconds

steps 2800    base_loss: 0.378447    reg_loss: 0.000000    l2_loss: 0.355726    loss: 0.734173
steps 2800    v_Prec: 0.425823  v_Recall: 0.619928  v_F1: 0.504861  v_AUC: 0.795425
steps 2800    running time 280 seconds

steps 3000    base_loss: 0.375712    reg_loss: 0.000000    l2_loss: 0.327051    loss: 0.702763
steps 3000    v_Prec: 0.433571  v_Recall: 0.642841  v_F1: 0.517864  v_AUC: 0.808973
steps 3000    running time 291 seconds

steps 3200    base_loss: 0.362899    reg_loss: 0.000000    l2_loss: 0.301866    loss: 0.664765
steps 3200    v_Prec: 0.441332  v_Recall: 0.665287  v_F1: 0.530648  v_AUC: 0.822852
steps 3200    running time 303 seconds

steps 3400    base_loss: 0.355144    reg_loss: 0.000000    l2_loss: 0.280639    loss: 0.635783
steps 3400    v_Prec: 0.452670  v_Recall: 0.686550  v_F1: 0.545602  v_AUC: 0.838284
steps 3400    running time 315 seconds

steps 3600    base_loss: 0.342862    reg_loss: 0.000000    l2_loss: 0.262576    loss: 0.605439
steps 3600    v_Prec: 0.473004  v_Recall: 0.686821  v_F1: 0.560203  v_AUC: 0.851860
steps 3600    running time 326 seconds

steps 3800    base_loss: 0.329143    reg_loss: 0.000000    l2_loss: 0.248056    loss: 0.577199
steps 3800    v_Prec: 0.496327  v_Recall: 0.692586  v_F1: 0.578258  v_AUC: 0.865151
steps 3800    running time 338 seconds

steps 4000    base_loss: 0.323566    reg_loss: 0.000000    l2_loss: 0.233345    loss: 0.556911
steps 4000    v_Prec: 0.516799  v_Recall: 0.710203  v_F1: 0.598259  v_AUC: 0.878237
steps 4000    running time 350 seconds

steps 4200    base_loss: 0.305442    reg_loss: 0.000000    l2_loss: 0.221629    loss: 0.527071
steps 4200    v_Prec: 0.539059  v_Recall: 0.711878  v_F1: 0.613531  v_AUC: 0.887858
steps 4200    running time 361 seconds

steps 4400    base_loss: 0.298727    reg_loss: 0.000000    l2_loss: 0.209078    loss: 0.507805
steps 4400    v_Prec: 0.540145  v_Recall: 0.738093  v_F1: 0.623792  v_AUC: 0.894922
steps 4400    running time 373 seconds

steps 4600    base_loss: 0.290661    reg_loss: 0.000000    l2_loss: 0.199367    loss: 0.490028
steps 4600    v_Prec: 0.556771  v_Recall: 0.737601  v_F1: 0.634554  v_AUC: 0.901619
steps 4600    running time 385 seconds

steps 4800    base_loss: 0.278811    reg_loss: 0.000000    l2_loss: 0.189082    loss: 0.467893
steps 4800    v_Prec: 0.559807  v_Recall: 0.755168  v_F1: 0.642976  v_AUC: 0.906027
steps 4800    running time 396 seconds

steps 5000    base_loss: 0.274379    reg_loss: 0.000000    l2_loss: 0.180827    loss: 0.455206
steps 5000    v_Prec: 0.572574  v_Recall: 0.752950  v_F1: 0.650490  v_AUC: 0.910504
steps 5000    running time 408 seconds

steps 5200    base_loss: 0.266766    reg_loss: 0.000000    l2_loss: 0.172201    loss: 0.438966
steps 5200    v_Prec: 0.571643  v_Recall: 0.768374  v_F1: 0.655567  v_AUC: 0.914208
steps 5200    running time 419 seconds

steps 5400    base_loss: 0.266076    reg_loss: 0.000000    l2_loss: 0.166565    loss: 0.432641
steps 5400    v_Prec: 0.571578  v_Recall: 0.779511  v_F1: 0.659544  v_AUC: 0.916900
steps 5400    running time 431 seconds

steps 5600    base_loss: 0.259701    reg_loss: 0.000000    l2_loss: 0.157925    loss: 0.417626
steps 5600    v_Prec: 0.579657  v_Recall: 0.780102  v_F1: 0.665105  v_AUC: 0.919141
steps 5600    running time 443 seconds

steps 5800    base_loss: 0.261353    reg_loss: 0.000000    l2_loss: 0.153032    loss: 0.414386
steps 5800    v_Prec: 0.576252  v_Recall: 0.799345  v_F1: 0.669708  v_AUC: 0.921422
steps 5800    running time 454 seconds

steps 6000    base_loss: 0.251101    reg_loss: 0.000000    l2_loss: 0.147151    loss: 0.398252
steps 6000    v_Prec: 0.582034  v_Recall: 0.792594  v_F1: 0.671187  v_AUC: 0.923349
steps 6000    running time 466 seconds

steps 6200    base_loss: 0.250990    reg_loss: 0.000000    l2_loss: 0.141170    loss: 0.392160
steps 6200    v_Prec: 0.577247  v_Recall: 0.809372  v_F1: 0.673881  v_AUC: 0.924604
steps 6200    running time 477 seconds

steps 6400    base_loss: 0.244007    reg_loss: 0.000000    l2_loss: 0.134092    loss: 0.378099
steps 6400    v_Prec: 0.578343  v_Recall: 0.808387  v_F1: 0.674284  v_AUC: 0.926108
steps 6400    running time 489 seconds

steps 6600    base_loss: 0.248399    reg_loss: 0.000000    l2_loss: 0.131343    loss: 0.379742
steps 6600    v_Prec: 0.578054  v_Recall: 0.822111  v_F1: 0.678812  v_AUC: 0.927793
steps 6600    running time 500 seconds

steps 6800    base_loss: 0.242192    reg_loss: 0.000000    l2_loss: 0.126890    loss: 0.369082
steps 6800    v_Prec: 0.583856  v_Recall: 0.814596  v_F1: 0.680190  v_AUC: 0.928518
steps 6800    running time 512 seconds

steps 7000    base_loss: 0.245176    reg_loss: 0.000000    l2_loss: 0.124025    loss: 0.369201
steps 7000    v_Prec: 0.579466  v_Recall: 0.825461  v_F1: 0.680928  v_AUC: 0.929220
steps 7000    running time 524 seconds

steps 7200    base_loss: 0.238374    reg_loss: 0.000000    l2_loss: 0.118759    loss: 0.357133
steps 7200    v_Prec: 0.578920  v_Recall: 0.831202  v_F1: 0.682494  v_AUC: 0.930516
steps 7200    running time 535 seconds

steps 7400    base_loss: 0.240269    reg_loss: 0.000000    l2_loss: 0.114787    loss: 0.355055
steps 7400    v_Prec: 0.592570  v_Recall: 0.807993  v_F1: 0.683714  v_AUC: 0.931540
steps 7400    running time 547 seconds

steps 7600    base_loss: 0.240346    reg_loss: 0.000000    l2_loss: 0.112252    loss: 0.352598
steps 7600    v_Prec: 0.587952  v_Recall: 0.820977  v_F1: 0.685194  v_AUC: 0.932208
steps 7600    running time 559 seconds

steps 7800    base_loss: 0.243784    reg_loss: 0.000000    l2_loss: 0.110466    loss: 0.354250
steps 7800    v_Prec: 0.601447  v_Recall: 0.804790  v_F1: 0.688417  v_AUC: 0.933429
steps 7800    running time 570 seconds

steps 8000    base_loss: 0.232516    reg_loss: 0.000000    l2_loss: 0.107109    loss: 0.339624
steps 8000    v_Prec: 0.586976  v_Recall: 0.834799  v_F1: 0.689289  v_AUC: 0.933703
steps 8000    running time 582 seconds

steps 8200    base_loss: 0.234546    reg_loss: 0.000000    l2_loss: 0.104099    loss: 0.338644
steps 8200    v_Prec: 0.604091  v_Recall: 0.804100  v_F1: 0.689891  v_AUC: 0.934266
steps 8200    running time 593 seconds

steps 8400    base_loss: 0.236343    reg_loss: 0.000000    l2_loss: 0.101916    loss: 0.338258
steps 8400    v_Prec: 0.597403  v_Recall: 0.819647  v_F1: 0.691097  v_AUC: 0.935038
steps 8400    running time 605 seconds

steps 8600    base_loss: 0.230873    reg_loss: 0.000000    l2_loss: 0.099581    loss: 0.330453
steps 8600    v_Prec: 0.599642  v_Recall: 0.816986  v_F1: 0.691641  v_AUC: 0.935233
steps 8600    running time 617 seconds

steps 8800    base_loss: 0.236045    reg_loss: 0.000000    l2_loss: 0.098128    loss: 0.334174
steps 8800    v_Prec: 0.601748  v_Recall: 0.815926  v_F1: 0.692658  v_AUC: 0.935311
steps 8800    running time 628 seconds

steps 9000    base_loss: 0.231901    reg_loss: 0.000000    l2_loss: 0.095568    loss: 0.327469
steps 9000    v_Prec: 0.589799  v_Recall: 0.834528  v_F1: 0.691139  v_AUC: 0.935604
steps 9000    running time 640 seconds

steps 9200    base_loss: 0.232304    reg_loss: 0.000000    l2_loss: 0.092930    loss: 0.325234
steps 9200    v_Prec: 0.594765  v_Recall: 0.829157  v_F1: 0.692669  v_AUC: 0.935730
steps 9200    running time 651 seconds

steps 9400    base_loss: 0.229173    reg_loss: 0.000000    l2_loss: 0.091428    loss: 0.320601
steps 9400    v_Prec: 0.592700  v_Recall: 0.834996  v_F1: 0.693288  v_AUC: 0.936030
steps 9400    running time 663 seconds

steps 9600    base_loss: 0.236114    reg_loss: 0.000000    l2_loss: 0.089744    loss: 0.325858
steps 9600    v_Prec: 0.600330  v_Recall: 0.823811  v_F1: 0.694536  v_AUC: 0.936500
steps 9600    running time 674 seconds

steps 9800    base_loss: 0.230219    reg_loss: 0.000000    l2_loss: 0.088300    loss: 0.318519
steps 9800    v_Prec: 0.599038  v_Recall: 0.825535  v_F1: 0.694281  v_AUC: 0.936643
steps 9800    running time 686 seconds

steps 10000    base_loss: 0.230556    reg_loss: 0.000000    l2_loss: 0.086685    loss: 0.317241
steps 10000    v_Prec: 0.600299  v_Recall: 0.821519  v_F1: 0.693699  v_AUC: 0.937200
steps 10000    running time 697 seconds

steps 10200    base_loss: 0.228561    reg_loss: 0.000000    l2_loss: 0.085503    loss: 0.314064
steps 10200    v_Prec: 0.595526  v_Recall: 0.834282  v_F1: 0.694970  v_AUC: 0.937228
steps 10200    running time 708 seconds

steps 10400    base_loss: 0.231812    reg_loss: 0.000000    l2_loss: 0.085480    loss: 0.317292
steps 10400    v_Prec: 0.598669  v_Recall: 0.830956  v_F1: 0.695941  v_AUC: 0.937200
steps 10400    running time 719 seconds

steps 10600    base_loss: 0.232991    reg_loss: 0.000000    l2_loss: 0.083530    loss: 0.316521
steps 10600    v_Prec: 0.602242  v_Recall: 0.827309  v_F1: 0.697058  v_AUC: 0.937857
steps 10600    running time 731 seconds

steps 10800    base_loss: 0.227786    reg_loss: 0.000000    l2_loss: 0.082617    loss: 0.310403
steps 10800    v_Prec: 0.597723  v_Recall: 0.838052  v_F1: 0.697773  v_AUC: 0.937994
steps 10800    running time 742 seconds

steps 11000    base_loss: 0.229539    reg_loss: 0.000000    l2_loss: 0.080290    loss: 0.309829
steps 11000    v_Prec: 0.603210  v_Recall: 0.825979  v_F1: 0.697233  v_AUC: 0.937793
steps 11000    running time 754 seconds

steps 11200    base_loss: 0.231910    reg_loss: 0.000000    l2_loss: 0.080340    loss: 0.312250
steps 11200    v_Prec: 0.595791  v_Recall: 0.838470  v_F1: 0.696600  v_AUC: 0.937986
steps 11200    running time 765 seconds

steps 11400    base_loss: 0.235151    reg_loss: 0.000000    l2_loss: 0.078705    loss: 0.313856
steps 11400    v_Prec: 0.597799  v_Recall: 0.840442  v_F1: 0.698652  v_AUC: 0.938786
steps 11400    running time 776 seconds

steps 11600    base_loss: 0.233283    reg_loss: 0.000000    l2_loss: 0.078964    loss: 0.312247
steps 11600    v_Prec: 0.597608  v_Recall: 0.837288  v_F1: 0.697431  v_AUC: 0.938330
steps 11600    running time 788 seconds

steps 11800    base_loss: 0.232059    reg_loss: 0.000000    l2_loss: 0.078213    loss: 0.310272
steps 11800    v_Prec: 0.604035  v_Recall: 0.829921  v_F1: 0.699186  v_AUC: 0.938610
steps 11800    running time 799 seconds

steps 12000    base_loss: 0.224578    reg_loss: 0.000000    l2_loss: 0.076952    loss: 0.301530
steps 12000    v_Prec: 0.606564  v_Recall: 0.824624  v_F1: 0.698982  v_AUC: 0.938662
steps 12000    running time 811 seconds

steps 12200    base_loss: 0.225749    reg_loss: 0.000000    l2_loss: 0.075581    loss: 0.301330
steps 12200    v_Prec: 0.599292  v_Recall: 0.838273  v_F1: 0.698918  v_AUC: 0.938280
steps 12200    running time 822 seconds

steps 12400    base_loss: 0.223768    reg_loss: 0.000000    l2_loss: 0.075333    loss: 0.299100
steps 12400    v_Prec: 0.600240  v_Recall: 0.836524  v_F1: 0.698953  v_AUC: 0.937696
steps 12400    running time 833 seconds

steps 12600    base_loss: 0.220223    reg_loss: 0.000000    l2_loss: 0.074006    loss: 0.294229
steps 12600    v_Prec: 0.601440  v_Recall: 0.831498  v_F1: 0.698001  v_AUC: 0.937903
steps 12600    running time 844 seconds

steps 12800    base_loss: 0.228858    reg_loss: 0.000000    l2_loss: 0.075430    loss: 0.304288
steps 12800    v_Prec: 0.600665  v_Recall: 0.832927  v_F1: 0.697981  v_AUC: 0.937690
steps 12800    running time 855 seconds

steps 13000    base_loss: 0.227834    reg_loss: 0.000000    l2_loss: 0.074528    loss: 0.302361
steps 13000    v_Prec: 0.594028  v_Recall: 0.846995  v_F1: 0.698308  v_AUC: 0.938402
steps 13000    running time 866 seconds

steps 13200    base_loss: 0.226881    reg_loss: 0.000000    l2_loss: 0.074526    loss: 0.301406
steps 13200    v_Prec: 0.599257  v_Recall: 0.834799  v_F1: 0.697684  v_AUC: 0.937901
steps 13200    running time 877 seconds

steps 13400    base_loss: 0.229623    reg_loss: 0.000000    l2_loss: 0.074117    loss: 0.303740
steps 13400    v_Prec: 0.603017  v_Recall: 0.831153  v_F1: 0.698940  v_AUC: 0.937892
steps 13400    running time 888 seconds

steps 13600    base_loss: 0.226790    reg_loss: 0.000000    l2_loss: 0.073353    loss: 0.300143
steps 13600    v_Prec: 0.607193  v_Recall: 0.827827  v_F1: 0.700548  v_AUC: 0.938634
steps 13600    running time 899 seconds

steps 13800    base_loss: 0.224517    reg_loss: 0.000000    l2_loss: 0.073092    loss: 0.297609
steps 13800    v_Prec: 0.605769  v_Recall: 0.830512  v_F1: 0.700557  v_AUC: 0.938427
steps 13800    running time 910 seconds

steps 14000    base_loss: 0.226980    reg_loss: 0.000000    l2_loss: 0.072228    loss: 0.299208
steps 14000    v_Prec: 0.603865  v_Recall: 0.835267  v_F1: 0.700963  v_AUC: 0.938252
steps 14000    running time 922 seconds

steps 14200    base_loss: 0.232756    reg_loss: 0.000000    l2_loss: 0.073451    loss: 0.306207
steps 14200    v_Prec: 0.604102  v_Recall: 0.835267  v_F1: 0.701122  v_AUC: 0.938637
steps 14200    running time 933 seconds

steps 14400    base_loss: 0.225567    reg_loss: 0.000000    l2_loss: 0.072584    loss: 0.298151
steps 14400    v_Prec: 0.601617  v_Recall: 0.839555  v_F1: 0.700944  v_AUC: 0.938339
steps 14400    running time 945 seconds

steps 14600    base_loss: 0.232484    reg_loss: 0.000000    l2_loss: 0.073626    loss: 0.306110
steps 14600    v_Prec: 0.603702  v_Recall: 0.831695  v_F1: 0.699592  v_AUC: 0.938113
steps 14600    running time 956 seconds

steps 14800    base_loss: 0.230200    reg_loss: 0.000000    l2_loss: 0.072383    loss: 0.302583
steps 14800    v_Prec: 0.596012  v_Recall: 0.848400  v_F1: 0.700156  v_AUC: 0.938566
steps 14800    running time 967 seconds

steps 15000    base_loss: 0.223587    reg_loss: 0.000000    l2_loss: 0.071895    loss: 0.295482
steps 15000    v_Prec: 0.602030  v_Recall: 0.834405  v_F1: 0.699422  v_AUC: 0.938088
steps 15000    running time 978 seconds

steps 15200    base_loss: 0.225456    reg_loss: 0.000000    l2_loss: 0.071705    loss: 0.297161
steps 15200    v_Prec: 0.608408  v_Recall: 0.826201  v_F1: 0.700772  v_AUC: 0.938556
steps 15200    running time 989 seconds

steps 15400    base_loss: 0.231339    reg_loss: 0.000000    l2_loss: 0.071370    loss: 0.302709
steps 15400    v_Prec: 0.603639  v_Recall: 0.835489  v_F1: 0.700888  v_AUC: 0.938118
steps 15400    running time 1000 seconds

steps 15600    base_loss: 0.223897    reg_loss: 0.000000    l2_loss: 0.070658    loss: 0.294555
steps 15600    v_Prec: 0.600858  v_Recall: 0.838939  v_F1: 0.700214  v_AUC: 0.938293
steps 15600    running time 1011 seconds

steps 15800    base_loss: 0.226209    reg_loss: 0.000000    l2_loss: 0.070976    loss: 0.297184
steps 15800    v_Prec: 0.599073  v_Recall: 0.841082  v_F1: 0.699744  v_AUC: 0.937737
steps 15800    running time 1022 seconds

steps 16000    base_loss: 0.229329    reg_loss: 0.000000    l2_loss: 0.071443    loss: 0.300772
steps 16000    v_Prec: 0.608613  v_Recall: 0.831473  v_F1: 0.702799  v_AUC: 0.938094
steps 16000    running time 1033 seconds

steps 16200    base_loss: 0.231967    reg_loss: 0.000000    l2_loss: 0.071473    loss: 0.303441
steps 16200    v_Prec: 0.601240  v_Recall: 0.838569  v_F1: 0.700345  v_AUC: 0.937347
steps 16200    running time 1045 seconds

steps 16400    base_loss: 0.229577    reg_loss: 0.000000    l2_loss: 0.070214    loss: 0.299791
steps 16400    v_Prec: 0.606936  v_Recall: 0.830019  v_F1: 0.701161  v_AUC: 0.937118
steps 16400    running time 1055 seconds

steps 16600    base_loss: 0.229076    reg_loss: 0.000000    l2_loss: 0.070729    loss: 0.299804
steps 16600    v_Prec: 0.595893  v_Recall: 0.840097  v_F1: 0.697230  v_AUC: 0.937160
steps 16600    running time 1066 seconds

steps 16800    base_loss: 0.225735    reg_loss: 0.000000    l2_loss: 0.069913    loss: 0.295648
steps 16800    v_Prec: 0.600752  v_Recall: 0.838865  v_F1: 0.700116  v_AUC: 0.936515
steps 16800    running time 1077 seconds

steps 17000    base_loss: 0.230385    reg_loss: 0.000000    l2_loss: 0.070570    loss: 0.300955
steps 17000    v_Prec: 0.604529  v_Recall: 0.835292  v_F1: 0.701418  v_AUC: 0.936997
steps 17000    running time 1088 seconds

steps 17200    base_loss: 0.228550    reg_loss: 0.000000    l2_loss: 0.070511    loss: 0.299061
steps 17200    v_Prec: 0.603075  v_Recall: 0.837978  v_F1: 0.701381  v_AUC: 0.937074
steps 17200    running time 1100 seconds

steps 17400    base_loss: 0.226055    reg_loss: 0.000000    l2_loss: 0.069973    loss: 0.296027
steps 17400    v_Prec: 0.609899  v_Recall: 0.826693  v_F1: 0.701938  v_AUC: 0.937428
steps 17400    running time 1110 seconds

steps 17600    base_loss: 0.232176    reg_loss: 0.000000    l2_loss: 0.070750    loss: 0.302926
steps 17600    v_Prec: 0.600039  v_Recall: 0.837263  v_F1: 0.699074  v_AUC: 0.936793
steps 17600    running time 1121 seconds

steps 17800    base_loss: 0.223212    reg_loss: 0.000000    l2_loss: 0.070542    loss: 0.293754
steps 17800    v_Prec: 0.602188  v_Recall: 0.835588  v_F1: 0.699943  v_AUC: 0.936728
steps 17800    running time 1132 seconds

steps 18000    base_loss: 0.235159    reg_loss: 0.000000    l2_loss: 0.071075    loss: 0.306233
steps 18000    v_Prec: 0.595356  v_Recall: 0.847685  v_F1: 0.699459  v_AUC: 0.937324
steps 18000    running time 1143 seconds

Early stop model F1: 0.702799
testing thre: 0.3064675
testing Prec: 0.4804996816457569
testing Recall: 0.7774263286951727
testing F1: 0.5939190387514409
testing AUC: 0.8877770503401106
overall running time 1152 seconds
(0.4813548032870991, 0.7759463733840194, 0.5941384941840442, 0.8877770503401106, 0.30880028)
2019-02-17 05:07:08.763536: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 05:07:09.396679: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 05:07:09.397671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 05:07:09.397717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.770000 seconds
loading data in 111.620000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.01
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.828502    reg_loss: 0.021783    l2_loss: 0.883395    loss: 1.733680
steps 200    v_Prec: 0.157303  v_Recall: 0.999902  v_F1: 0.271841  v_AUC: 0.486921
steps 200    running time 128 seconds

steps 400    base_loss: 0.718139    reg_loss: 0.021831    l2_loss: 0.874840    loss: 1.614810
steps 400    v_Prec: 0.157296  v_Recall: 0.999951  v_F1: 0.271832  v_AUC: 0.496587
steps 400    running time 140 seconds

steps 600    base_loss: 0.574089    reg_loss: 0.021871    l2_loss: 0.853383    loss: 1.449343
steps 600    v_Prec: 0.158240  v_Recall: 0.975507  v_F1: 0.272308  v_AUC: 0.528029
steps 600    running time 151 seconds

steps 800    base_loss: 0.500115    reg_loss: 0.022035    l2_loss: 0.821263    loss: 1.343413
steps 800    v_Prec: 0.182480  v_Recall: 0.686782  v_F1: 0.288346  v_AUC: 0.585066
steps 800    running time 163 seconds

steps 1000    base_loss: 0.471029    reg_loss: 0.022177    l2_loss: 0.779556    loss: 1.272762
steps 1000    v_Prec: 0.224535  v_Recall: 0.575802  v_F1: 0.323084  v_AUC: 0.641132
steps 1000    running time 175 seconds

steps 1200    base_loss: 0.450710    reg_loss: 0.022222    l2_loss: 0.733177    loss: 1.206110
steps 1200    v_Prec: 0.281262  v_Recall: 0.488676  v_F1: 0.357031  v_AUC: 0.675353
steps 1200    running time 186 seconds

steps 1400    base_loss: 0.460807    reg_loss: 0.022392    l2_loss: 0.680985    loss: 1.164184
steps 1400    v_Prec: 0.317335  v_Recall: 0.505668  v_F1: 0.389953  v_AUC: 0.702949
steps 1400    running time 198 seconds

steps 1600    base_loss: 0.438802    reg_loss: 0.022447    l2_loss: 0.629775    loss: 1.091023
steps 1600    v_Prec: 0.371593  v_Recall: 0.532128  v_F1: 0.437602  v_AUC: 0.737327
steps 1600    running time 209 seconds

steps 1800    base_loss: 0.413616    reg_loss: 0.022630    l2_loss: 0.578019    loss: 1.014264
steps 1800    v_Prec: 0.385900  v_Recall: 0.575286  v_F1: 0.461935  v_AUC: 0.756862
steps 1800    running time 221 seconds

steps 2000    base_loss: 0.408690    reg_loss: 0.022829    l2_loss: 0.529650    loss: 0.961169
steps 2000    v_Prec: 0.410456  v_Recall: 0.571843  v_F1: 0.477892  v_AUC: 0.770957
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.380442    reg_loss: 0.023028    l2_loss: 0.484568    loss: 0.888038
steps 2200    v_Prec: 0.422573  v_Recall: 0.579589  v_F1: 0.488781  v_AUC: 0.783456
steps 2200    running time 244 seconds

steps 2400    base_loss: 0.370978    reg_loss: 0.023086    l2_loss: 0.446739    loss: 0.840802
steps 2400    v_Prec: 0.429969  v_Recall: 0.600000  v_F1: 0.500950  v_AUC: 0.795520
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.365954    reg_loss: 0.023022    l2_loss: 0.414321    loss: 0.803297
steps 2600    v_Prec: 0.432685  v_Recall: 0.630050  v_F1: 0.513041  v_AUC: 0.807309
steps 2600    running time 267 seconds

steps 2800    base_loss: 0.352851    reg_loss: 0.022896    l2_loss: 0.382743    loss: 0.758490
steps 2800    v_Prec: 0.455147  v_Recall: 0.613869  v_F1: 0.522725  v_AUC: 0.817046
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.348072    reg_loss: 0.022780    l2_loss: 0.359858    loss: 0.730710
steps 3000    v_Prec: 0.458021  v_Recall: 0.646748  v_F1: 0.536264  v_AUC: 0.828928
steps 3000    running time 290 seconds

steps 3200    base_loss: 0.339877    reg_loss: 0.022695    l2_loss: 0.337321    loss: 0.699893
steps 3200    v_Prec: 0.476794  v_Recall: 0.648002  v_F1: 0.549368  v_AUC: 0.839462
steps 3200    running time 302 seconds

steps 3400    base_loss: 0.334358    reg_loss: 0.022516    l2_loss: 0.314655    loss: 0.671530
steps 3400    v_Prec: 0.497686  v_Recall: 0.650609  v_F1: 0.563965  v_AUC: 0.849941
steps 3400    running time 313 seconds

steps 3600    base_loss: 0.322942    reg_loss: 0.022358    l2_loss: 0.296530    loss: 0.641830
steps 3600    v_Prec: 0.503883  v_Recall: 0.676552  v_F1: 0.577589  v_AUC: 0.859211
steps 3600    running time 325 seconds

steps 3800    base_loss: 0.320428    reg_loss: 0.022087    l2_loss: 0.280946    loss: 0.623462
steps 3800    v_Prec: 0.519230  v_Recall: 0.691528  v_F1: 0.593120  v_AUC: 0.868493
steps 3800    running time 336 seconds

steps 4000    base_loss: 0.312056    reg_loss: 0.021794    l2_loss: 0.265386    loss: 0.599237
steps 4000    v_Prec: 0.534391  v_Recall: 0.693545  v_F1: 0.603654  v_AUC: 0.874602
steps 4000    running time 348 seconds

steps 4200    base_loss: 0.303219    reg_loss: 0.021636    l2_loss: 0.253740    loss: 0.578596
steps 4200    v_Prec: 0.541749  v_Recall: 0.712087  v_F1: 0.615347  v_AUC: 0.881558
steps 4200    running time 360 seconds

steps 4400    base_loss: 0.295498    reg_loss: 0.021358    l2_loss: 0.241053    loss: 0.557908
steps 4400    v_Prec: 0.556108  v_Recall: 0.712431  v_F1: 0.624638  v_AUC: 0.887224
steps 4400    running time 371 seconds

steps 4600    base_loss: 0.285715    reg_loss: 0.021161    l2_loss: 0.230711    loss: 0.537587
steps 4600    v_Prec: 0.555396  v_Recall: 0.733358  v_F1: 0.632090  v_AUC: 0.891878
steps 4600    running time 383 seconds

steps 4800    base_loss: 0.281925    reg_loss: 0.020852    l2_loss: 0.220542    loss: 0.523319
steps 4800    v_Prec: 0.565265  v_Recall: 0.740981  v_F1: 0.641304  v_AUC: 0.896852
steps 4800    running time 394 seconds

steps 5000    base_loss: 0.280943    reg_loss: 0.020574    l2_loss: 0.211725    loss: 0.513242
steps 5000    v_Prec: 0.576085  v_Recall: 0.740219  v_F1: 0.647919  v_AUC: 0.900782
steps 5000    running time 406 seconds

steps 5200    base_loss: 0.272428    reg_loss: 0.020278    l2_loss: 0.204259    loss: 0.496964
steps 5200    v_Prec: 0.582502  v_Recall: 0.747719  v_F1: 0.654850  v_AUC: 0.905002
steps 5200    running time 417 seconds

steps 5400    base_loss: 0.266473    reg_loss: 0.020209    l2_loss: 0.194829    loss: 0.481511
steps 5400    v_Prec: 0.588036  v_Recall: 0.745973  v_F1: 0.657655  v_AUC: 0.905912
steps 5400    running time 429 seconds

steps 5600    base_loss: 0.268431    reg_loss: 0.020019    l2_loss: 0.187329    loss: 0.475779
steps 5600    v_Prec: 0.580190  v_Recall: 0.772089  v_F1: 0.662524  v_AUC: 0.908748
steps 5600    running time 441 seconds

steps 5800    base_loss: 0.271500    reg_loss: 0.019800    l2_loss: 0.180152    loss: 0.471452
steps 5800    v_Prec: 0.590530  v_Recall: 0.766753  v_F1: 0.667202  v_AUC: 0.911727
steps 5800    running time 452 seconds

steps 6000    base_loss: 0.263089    reg_loss: 0.019790    l2_loss: 0.174917    loss: 0.457795
steps 6000    v_Prec: 0.579312  v_Recall: 0.794639  v_F1: 0.670102  v_AUC: 0.913822
steps 6000    running time 464 seconds

steps 6200    base_loss: 0.262487    reg_loss: 0.019780    l2_loss: 0.168269    loss: 0.450536
steps 6200    v_Prec: 0.588980  v_Recall: 0.786770  v_F1: 0.673657  v_AUC: 0.916422
steps 6200    running time 476 seconds

steps 6400    base_loss: 0.253345    reg_loss: 0.019643    l2_loss: 0.161668    loss: 0.434656
steps 6400    v_Prec: 0.596968  v_Recall: 0.777696  v_F1: 0.675452  v_AUC: 0.917128
steps 6400    running time 487 seconds

steps 6600    base_loss: 0.256954    reg_loss: 0.019620    l2_loss: 0.156707    loss: 0.433281
steps 6600    v_Prec: 0.598595  v_Recall: 0.785983  v_F1: 0.679609  v_AUC: 0.919321
steps 6600    running time 499 seconds

steps 6800    base_loss: 0.243776    reg_loss: 0.019440    l2_loss: 0.151736    loss: 0.414952
steps 6800    v_Prec: 0.592933  v_Recall: 0.797664  v_F1: 0.680228  v_AUC: 0.920017
steps 6800    running time 510 seconds

steps 7000    base_loss: 0.249412    reg_loss: 0.019375    l2_loss: 0.146953    loss: 0.415740
steps 7000    v_Prec: 0.595408  v_Recall: 0.801008  v_F1: 0.683073  v_AUC: 0.921795
steps 7000    running time 522 seconds

steps 7200    base_loss: 0.248485    reg_loss: 0.019559    l2_loss: 0.141577    loss: 0.409622
steps 7200    v_Prec: 0.599996  v_Recall: 0.800615  v_F1: 0.685938  v_AUC: 0.923225
steps 7200    running time 533 seconds

steps 7400    base_loss: 0.247268    reg_loss: 0.019460    l2_loss: 0.137581    loss: 0.404309
steps 7400    v_Prec: 0.594118  v_Recall: 0.812787  v_F1: 0.686460  v_AUC: 0.924496
steps 7400    running time 545 seconds

steps 7600    base_loss: 0.247651    reg_loss: 0.019587    l2_loss: 0.133399    loss: 0.400637
steps 7600    v_Prec: 0.601357  v_Recall: 0.808582  v_F1: 0.689741  v_AUC: 0.925567
steps 7600    running time 557 seconds

steps 7800    base_loss: 0.245361    reg_loss: 0.019479    l2_loss: 0.128299    loss: 0.393138
steps 7800    v_Prec: 0.603250  v_Recall: 0.810771  v_F1: 0.691782  v_AUC: 0.926330
steps 7800    running time 568 seconds

steps 8000    base_loss: 0.243503    reg_loss: 0.019539    l2_loss: 0.125080    loss: 0.388122
steps 8000    v_Prec: 0.600902  v_Recall: 0.816156  v_F1: 0.692180  v_AUC: 0.926457
steps 8000    running time 580 seconds

steps 8200    base_loss: 0.237590    reg_loss: 0.019407    l2_loss: 0.122072    loss: 0.379068
steps 8200    v_Prec: 0.605257  v_Recall: 0.804599  v_F1: 0.690835  v_AUC: 0.926965
steps 8200    running time 591 seconds

steps 8400    base_loss: 0.239402    reg_loss: 0.019435    l2_loss: 0.119017    loss: 0.377853
steps 8400    v_Prec: 0.599652  v_Recall: 0.821935  v_F1: 0.693415  v_AUC: 0.928000
steps 8400    running time 602 seconds

steps 8600    base_loss: 0.241071    reg_loss: 0.019352    l2_loss: 0.115333    loss: 0.375755
steps 8600    v_Prec: 0.597200  v_Recall: 0.829632  v_F1: 0.694484  v_AUC: 0.928568
steps 8600    running time 614 seconds

steps 8800    base_loss: 0.237107    reg_loss: 0.019380    l2_loss: 0.112001    loss: 0.368487
steps 8800    v_Prec: 0.606770  v_Recall: 0.812787  v_F1: 0.694830  v_AUC: 0.928964
steps 8800    running time 626 seconds

steps 9000    base_loss: 0.237782    reg_loss: 0.019192    l2_loss: 0.109213    loss: 0.366188
steps 9000    v_Prec: 0.603000  v_Recall: 0.817509  v_F1: 0.694058  v_AUC: 0.928674
steps 9000    running time 637 seconds

steps 9200    base_loss: 0.237581    reg_loss: 0.018994    l2_loss: 0.106764    loss: 0.363339
steps 9200    v_Prec: 0.597141  v_Recall: 0.830124  v_F1: 0.694617  v_AUC: 0.928448
steps 9200    running time 648 seconds

steps 9400    base_loss: 0.239468    reg_loss: 0.018716    l2_loss: 0.104487    loss: 0.362671
steps 9400    v_Prec: 0.594858  v_Recall: 0.834133  v_F1: 0.694463  v_AUC: 0.928806
steps 9400    running time 659 seconds

steps 9600    base_loss: 0.241021    reg_loss: 0.018726    l2_loss: 0.102291    loss: 0.362038
steps 9600    v_Prec: 0.599868  v_Recall: 0.825845  v_F1: 0.694948  v_AUC: 0.929453
steps 9600    running time 670 seconds

steps 9800    base_loss: 0.236502    reg_loss: 0.018594    l2_loss: 0.100284    loss: 0.355380
steps 9800    v_Prec: 0.589830  v_Recall: 0.844879  v_F1: 0.694684  v_AUC: 0.929522
steps 9800    running time 681 seconds

steps 10000    base_loss: 0.234030    reg_loss: 0.018257    l2_loss: 0.097453    loss: 0.349740
steps 10000    v_Prec: 0.594557  v_Recall: 0.832731  v_F1: 0.693772  v_AUC: 0.928478
steps 10000    running time 692 seconds

steps 10200    base_loss: 0.234279    reg_loss: 0.017866    l2_loss: 0.095503    loss: 0.347649
steps 10200    v_Prec: 0.601954  v_Recall: 0.818075  v_F1: 0.693568  v_AUC: 0.928789
steps 10200    running time 704 seconds

steps 10400    base_loss: 0.239705    reg_loss: 0.017088    l2_loss: 0.093524    loss: 0.350317
steps 10400    v_Prec: 0.602337  v_Recall: 0.823853  v_F1: 0.695892  v_AUC: 0.929676
steps 10400    running time 715 seconds

steps 10600    base_loss: 0.236473    reg_loss: 0.016618    l2_loss: 0.091397    loss: 0.344487
steps 10600    v_Prec: 0.600403  v_Recall: 0.828132  v_F1: 0.696116  v_AUC: 0.928921
steps 10600    running time 726 seconds

steps 10800    base_loss: 0.236299    reg_loss: 0.016164    l2_loss: 0.090839    loss: 0.343302
steps 10800    v_Prec: 0.596427  v_Recall: 0.836493  v_F1: 0.696350  v_AUC: 0.929481
steps 10800    running time 738 seconds

steps 11000    base_loss: 0.242631    reg_loss: 0.016010    l2_loss: 0.089071    loss: 0.347712
steps 11000    v_Prec: 0.593724  v_Recall: 0.838952  v_F1: 0.695351  v_AUC: 0.928869
steps 11000    running time 750 seconds

steps 11200    base_loss: 0.238945    reg_loss: 0.015161    l2_loss: 0.087047    loss: 0.341153
steps 11200    v_Prec: 0.594561  v_Recall: 0.836567  v_F1: 0.695102  v_AUC: 0.929268
steps 11200    running time 760 seconds

steps 11400    base_loss: 0.243174    reg_loss: 0.015029    l2_loss: 0.085698    loss: 0.343900
steps 11400    v_Prec: 0.591257  v_Recall: 0.845789  v_F1: 0.695981  v_AUC: 0.929878
steps 11400    running time 771 seconds

steps 11600    base_loss: 0.238595    reg_loss: 0.014752    l2_loss: 0.083496    loss: 0.336842
steps 11600    v_Prec: 0.599423  v_Recall: 0.827370  v_F1: 0.695188  v_AUC: 0.929419
steps 11600    running time 782 seconds

steps 11800    base_loss: 0.239631    reg_loss: 0.014512    l2_loss: 0.082201    loss: 0.336343
steps 11800    v_Prec: 0.594880  v_Recall: 0.838288  v_F1: 0.695914  v_AUC: 0.929395
steps 11800    running time 793 seconds

steps 12000    base_loss: 0.235945    reg_loss: 0.014061    l2_loss: 0.081473    loss: 0.331480
steps 12000    v_Prec: 0.596250  v_Recall: 0.843035  v_F1: 0.698485  v_AUC: 0.930211
steps 12000    running time 804 seconds

steps 12200    base_loss: 0.242247    reg_loss: 0.013905    l2_loss: 0.079962    loss: 0.336114
steps 12200    v_Prec: 0.597921  v_Recall: 0.834501  v_F1: 0.696674  v_AUC: 0.929839
steps 12200    running time 815 seconds

steps 12400    base_loss: 0.238550    reg_loss: 0.013827    l2_loss: 0.078551    loss: 0.330927
steps 12400    v_Prec: 0.601517  v_Recall: 0.834403  v_F1: 0.699075  v_AUC: 0.930237
steps 12400    running time 826 seconds

steps 12600    base_loss: 0.239735    reg_loss: 0.013378    l2_loss: 0.077757    loss: 0.330869
steps 12600    v_Prec: 0.592900  v_Recall: 0.843969  v_F1: 0.696499  v_AUC: 0.930017
steps 12600    running time 838 seconds

steps 12800    base_loss: 0.240161    reg_loss: 0.013477    l2_loss: 0.076039    loss: 0.329677
steps 12800    v_Prec: 0.595122  v_Recall: 0.840034  v_F1: 0.696681  v_AUC: 0.930245
steps 12800    running time 849 seconds

steps 13000    base_loss: 0.242887    reg_loss: 0.013260    l2_loss: 0.075477    loss: 0.331624
steps 13000    v_Prec: 0.595887  v_Recall: 0.842272  v_F1: 0.697974  v_AUC: 0.930113
steps 13000    running time 860 seconds

steps 13200    base_loss: 0.237559    reg_loss: 0.013260    l2_loss: 0.075131    loss: 0.325950
steps 13200    v_Prec: 0.591286  v_Recall: 0.842297  v_F1: 0.694816  v_AUC: 0.930252
steps 13200    running time 871 seconds

steps 13400    base_loss: 0.234736    reg_loss: 0.013090    l2_loss: 0.073829    loss: 0.321655
steps 13400    v_Prec: 0.593843  v_Recall: 0.837674  v_F1: 0.694992  v_AUC: 0.930094
steps 13400    running time 882 seconds

steps 13600    base_loss: 0.236464    reg_loss: 0.012839    l2_loss: 0.073121    loss: 0.322424
steps 13600    v_Prec: 0.592925  v_Recall: 0.837575  v_F1: 0.694330  v_AUC: 0.930121
steps 13600    running time 893 seconds

steps 13800    base_loss: 0.241169    reg_loss: 0.012697    l2_loss: 0.071757    loss: 0.325623
steps 13800    v_Prec: 0.597015  v_Recall: 0.833149  v_F1: 0.695588  v_AUC: 0.930310
steps 13800    running time 904 seconds

steps 14000    base_loss: 0.239560    reg_loss: 0.012606    l2_loss: 0.070863    loss: 0.323028
steps 14000    v_Prec: 0.590654  v_Recall: 0.847584  v_F1: 0.696169  v_AUC: 0.930261
steps 14000    running time 915 seconds

steps 14200    base_loss: 0.242828    reg_loss: 0.012661    l2_loss: 0.070321    loss: 0.325810
steps 14200    v_Prec: 0.592609  v_Recall: 0.842346  v_F1: 0.695746  v_AUC: 0.930544
steps 14200    running time 926 seconds

steps 14400    base_loss: 0.238326    reg_loss: 0.012346    l2_loss: 0.069211    loss: 0.319883
steps 14400    v_Prec: 0.590258  v_Recall: 0.844215  v_F1: 0.694756  v_AUC: 0.930151
steps 14400    running time 937 seconds

Early stop model F1: 0.699075
testing thre: 0.21434185
testing Prec: 0.5648437416699542
testing Recall: 0.7686336530230263
testing F1: 0.6511665068712048
testing AUC: 0.8948427115837402
overall running time 946 seconds
(0.5693332611168282, 0.7625832474862524, 0.6519387729787393, 0.8948427115837402, 0.22364283)
2019-02-17 05:18:05.745783: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 05:18:06.498515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 05:18:06.499488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 05:18:06.499526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 89.360000 seconds
loading data in 111.710000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.1
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 2.242897    reg_loss: 0.215641    l2_loss: 0.884339    loss: 3.342877
steps 200    v_Prec: 0.156528  v_Recall: 0.999753  v_F1: 0.270677  v_AUC: 0.492654
steps 200    running time 129 seconds

steps 400    base_loss: 2.078037    reg_loss: 0.215271    l2_loss: 0.872873    loss: 3.166181
steps 400    v_Prec: 0.156537  v_Recall: 0.999605  v_F1: 0.270684  v_AUC: 0.497164
steps 400    running time 141 seconds

steps 600    base_loss: 1.763629    reg_loss: 0.214104    l2_loss: 0.848603    loss: 2.826336
steps 600    v_Prec: 0.156562  v_Recall: 0.999506  v_F1: 0.270719  v_AUC: 0.504362
steps 600    running time 152 seconds

steps 800    base_loss: 1.330861    reg_loss: 0.212748    l2_loss: 0.817800    loss: 2.361408
steps 800    v_Prec: 0.156576  v_Recall: 0.999184  v_F1: 0.270728  v_AUC: 0.513198
steps 800    running time 163 seconds

steps 1000    base_loss: 0.893135    reg_loss: 0.211109    l2_loss: 0.778900    loss: 1.883144
steps 1000    v_Prec: 0.156568  v_Recall: 0.999184  v_F1: 0.270716  v_AUC: 0.517505
steps 1000    running time 175 seconds

steps 1200    base_loss: 0.593327    reg_loss: 0.208175    l2_loss: 0.734641    loss: 1.536142
steps 1200    v_Prec: 0.156524  v_Recall: 0.999975  v_F1: 0.270680  v_AUC: 0.506399
steps 1200    running time 186 seconds

steps 1400    base_loss: 0.481507    reg_loss: 0.204466    l2_loss: 0.691807    loss: 1.377781
steps 1400    v_Prec: 0.160189  v_Recall: 0.918049  v_F1: 0.272781  v_AUC: 0.526154
steps 1400    running time 197 seconds

steps 1600    base_loss: 0.442921    reg_loss: 0.196438    l2_loss: 0.643037    loss: 1.282396
steps 1600    v_Prec: 0.178013  v_Recall: 0.712997  v_F1: 0.284896  v_AUC: 0.574015
steps 1600    running time 208 seconds

steps 1800    base_loss: 0.436027    reg_loss: 0.185721    l2_loss: 0.591553    loss: 1.213301
steps 1800    v_Prec: 0.213839  v_Recall: 0.568322  v_F1: 0.310753  v_AUC: 0.623123
steps 1800    running time 220 seconds

steps 2000    base_loss: 0.437283    reg_loss: 0.173609    l2_loss: 0.541835    loss: 1.152727
steps 2000    v_Prec: 0.256321  v_Recall: 0.537652  v_F1: 0.347144  v_AUC: 0.666261
steps 2000    running time 232 seconds

steps 2200    base_loss: 0.425733    reg_loss: 0.160034    l2_loss: 0.490311    loss: 1.076078
steps 2200    v_Prec: 0.312636  v_Recall: 0.517164  v_F1: 0.389694  v_AUC: 0.704895
steps 2200    running time 243 seconds

steps 2400    base_loss: 0.415554    reg_loss: 0.148684    l2_loss: 0.446607    loss: 1.010844
steps 2400    v_Prec: 0.333730  v_Recall: 0.574994  v_F1: 0.422335  v_AUC: 0.732846
steps 2400    running time 255 seconds

steps 2600    base_loss: 0.407590    reg_loss: 0.139121    l2_loss: 0.403327    loss: 0.950038
steps 2600    v_Prec: 0.343124  v_Recall: 0.618120  v_F1: 0.441286  v_AUC: 0.754479
steps 2600    running time 266 seconds

steps 2800    base_loss: 0.382113    reg_loss: 0.129505    l2_loss: 0.368328    loss: 0.879946
steps 2800    v_Prec: 0.418674  v_Recall: 0.528260  v_F1: 0.467126  v_AUC: 0.772256
steps 2800    running time 278 seconds

steps 3000    base_loss: 0.376462    reg_loss: 0.123015    l2_loss: 0.336570    loss: 0.836048
steps 3000    v_Prec: 0.454958  v_Recall: 0.538195  v_F1: 0.493088  v_AUC: 0.788376
steps 3000    running time 289 seconds

steps 3200    base_loss: 0.354733    reg_loss: 0.115903    l2_loss: 0.309277    loss: 0.779913
steps 3200    v_Prec: 0.447106  v_Recall: 0.602798  v_F1: 0.513408  v_AUC: 0.804222
steps 3200    running time 301 seconds

steps 3400    base_loss: 0.346993    reg_loss: 0.112237    l2_loss: 0.286439    loss: 0.745669
steps 3400    v_Prec: 0.454636  v_Recall: 0.631713  v_F1: 0.528743  v_AUC: 0.817763
steps 3400    running time 312 seconds

steps 3600    base_loss: 0.337509    reg_loss: 0.109684    l2_loss: 0.265676    loss: 0.712869
steps 3600    v_Prec: 0.471213  v_Recall: 0.645231  v_F1: 0.544660  v_AUC: 0.832956
steps 3600    running time 324 seconds

steps 3800    base_loss: 0.334644    reg_loss: 0.106807    l2_loss: 0.249690    loss: 0.691141
steps 3800    v_Prec: 0.504647  v_Recall: 0.650866  v_F1: 0.568505  v_AUC: 0.846196
steps 3800    running time 335 seconds

steps 4000    base_loss: 0.320911    reg_loss: 0.105142    l2_loss: 0.234083    loss: 0.660136
steps 4000    v_Prec: 0.520737  v_Recall: 0.676149  v_F1: 0.588353  v_AUC: 0.860547
steps 4000    running time 347 seconds

steps 4200    base_loss: 0.308140    reg_loss: 0.102095    l2_loss: 0.220304    loss: 0.630539
steps 4200    v_Prec: 0.544678  v_Recall: 0.687097  v_F1: 0.607654  v_AUC: 0.870118
steps 4200    running time 359 seconds

steps 4400    base_loss: 0.303854    reg_loss: 0.100913    l2_loss: 0.209034    loss: 0.613800
steps 4400    v_Prec: 0.545588  v_Recall: 0.717544  v_F1: 0.619861  v_AUC: 0.879201
steps 4400    running time 370 seconds

steps 4600    base_loss: 0.297552    reg_loss: 0.099072    l2_loss: 0.197822    loss: 0.594447
steps 4600    v_Prec: 0.559710  v_Recall: 0.719200  v_F1: 0.629510  v_AUC: 0.886526
steps 4600    running time 382 seconds

steps 4800    base_loss: 0.284785    reg_loss: 0.096286    l2_loss: 0.187021    loss: 0.568092
steps 4800    v_Prec: 0.563188  v_Recall: 0.741443  v_F1: 0.640137  v_AUC: 0.891904
steps 4800    running time 393 seconds

steps 5000    base_loss: 0.277832    reg_loss: 0.094862    l2_loss: 0.178772    loss: 0.551466
steps 5000    v_Prec: 0.563355  v_Recall: 0.766181  v_F1: 0.649297  v_AUC: 0.897138
steps 5000    running time 404 seconds

steps 5200    base_loss: 0.275997    reg_loss: 0.094032    l2_loss: 0.170764    loss: 0.540793
steps 5200    v_Prec: 0.570580  v_Recall: 0.766404  v_F1: 0.654151  v_AUC: 0.902677
steps 5200    running time 416 seconds

steps 5400    base_loss: 0.268402    reg_loss: 0.092201    l2_loss: 0.163155    loss: 0.523758
steps 5400    v_Prec: 0.578390  v_Recall: 0.765045  v_F1: 0.658750  v_AUC: 0.905261
steps 5400    running time 427 seconds

steps 5600    base_loss: 0.263912    reg_loss: 0.090968    l2_loss: 0.156194    loss: 0.511074
steps 5600    v_Prec: 0.572613  v_Recall: 0.786570  v_F1: 0.662752  v_AUC: 0.907066
steps 5600    running time 439 seconds

steps 5800    base_loss: 0.259850    reg_loss: 0.088519    l2_loss: 0.148795    loss: 0.497164
steps 5800    v_Prec: 0.580178  v_Recall: 0.786422  v_F1: 0.667737  v_AUC: 0.909631
steps 5800    running time 450 seconds

steps 6000    base_loss: 0.263158    reg_loss: 0.088492    l2_loss: 0.143065    loss: 0.494715
steps 6000    v_Prec: 0.585832  v_Recall: 0.787485  v_F1: 0.671854  v_AUC: 0.913324
steps 6000    running time 462 seconds

steps 6200    base_loss: 0.262167    reg_loss: 0.087874    l2_loss: 0.137933    loss: 0.487974
steps 6200    v_Prec: 0.581691  v_Recall: 0.798235  v_F1: 0.672973  v_AUC: 0.914715
steps 6200    running time 473 seconds

steps 6400    base_loss: 0.252465    reg_loss: 0.085652    l2_loss: 0.132586    loss: 0.470703
steps 6400    v_Prec: 0.583478  v_Recall: 0.798408  v_F1: 0.674229  v_AUC: 0.916479
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.253403    reg_loss: 0.084587    l2_loss: 0.127116    loss: 0.465107
steps 6600    v_Prec: 0.585596  v_Recall: 0.799990  v_F1: 0.676206  v_AUC: 0.918248
steps 6600    running time 496 seconds

steps 6800    base_loss: 0.256255    reg_loss: 0.084094    l2_loss: 0.123659    loss: 0.464008
steps 6800    v_Prec: 0.591355  v_Recall: 0.791489  v_F1: 0.676939  v_AUC: 0.919533
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.258852    reg_loss: 0.083882    l2_loss: 0.119119    loss: 0.461853
steps 7000    v_Prec: 0.583181  v_Recall: 0.814275  v_F1: 0.679620  v_AUC: 0.921430
steps 7000    running time 519 seconds

steps 7200    base_loss: 0.248118    reg_loss: 0.081418    l2_loss: 0.113692    loss: 0.443227
steps 7200    v_Prec: 0.587285  v_Recall: 0.808887  v_F1: 0.680500  v_AUC: 0.921771
steps 7200    running time 531 seconds

steps 7400    base_loss: 0.248346    reg_loss: 0.080972    l2_loss: 0.111166    loss: 0.440483
steps 7400    v_Prec: 0.593310  v_Recall: 0.805748  v_F1: 0.683401  v_AUC: 0.923410
steps 7400    running time 542 seconds

steps 7600    base_loss: 0.249037    reg_loss: 0.081017    l2_loss: 0.106932    loss: 0.436985
steps 7600    v_Prec: 0.590719  v_Recall: 0.814201  v_F1: 0.684685  v_AUC: 0.924354
steps 7600    running time 554 seconds

steps 7800    base_loss: 0.247591    reg_loss: 0.080152    l2_loss: 0.103721    loss: 0.431464
steps 7800    v_Prec: 0.588412  v_Recall: 0.819193  v_F1: 0.684884  v_AUC: 0.924367
steps 7800    running time 565 seconds

steps 8000    base_loss: 0.240029    reg_loss: 0.079564    l2_loss: 0.099703    loss: 0.419296
steps 8000    v_Prec: 0.581708  v_Recall: 0.835924  v_F1: 0.686023  v_AUC: 0.925046
steps 8000    running time 577 seconds

steps 8200    base_loss: 0.255462    reg_loss: 0.079558    l2_loss: 0.097799    loss: 0.432819
steps 8200    v_Prec: 0.583785  v_Recall: 0.831377  v_F1: 0.685922  v_AUC: 0.926080
steps 8200    running time 588 seconds

steps 8400    base_loss: 0.243167    reg_loss: 0.078298    l2_loss: 0.095818    loss: 0.417283
steps 8400    v_Prec: 0.582910  v_Recall: 0.834021  v_F1: 0.686215  v_AUC: 0.925884
steps 8400    running time 599 seconds

steps 8600    base_loss: 0.241282    reg_loss: 0.077917    l2_loss: 0.092400    loss: 0.411598
steps 8600    v_Prec: 0.584977  v_Recall: 0.831673  v_F1: 0.686846  v_AUC: 0.926080
steps 8600    running time 611 seconds

steps 8800    base_loss: 0.242906    reg_loss: 0.078210    l2_loss: 0.090860    loss: 0.411976
steps 8800    v_Prec: 0.588138  v_Recall: 0.826632  v_F1: 0.687283  v_AUC: 0.927073
steps 8800    running time 622 seconds

steps 9000    base_loss: 0.244848    reg_loss: 0.077246    l2_loss: 0.087968    loss: 0.410061
steps 9000    v_Prec: 0.584810  v_Recall: 0.833848  v_F1: 0.687470  v_AUC: 0.927034
steps 9000    running time 634 seconds

steps 9200    base_loss: 0.244773    reg_loss: 0.077942    l2_loss: 0.086099    loss: 0.408814
steps 9200    v_Prec: 0.580816  v_Recall: 0.841905  v_F1: 0.687404  v_AUC: 0.927385
steps 9200    running time 646 seconds

steps 9400    base_loss: 0.245166    reg_loss: 0.077992    l2_loss: 0.084944    loss: 0.408102
steps 9400    v_Prec: 0.586739  v_Recall: 0.833453  v_F1: 0.688667  v_AUC: 0.927556
steps 9400    running time 657 seconds

steps 9600    base_loss: 0.244320    reg_loss: 0.075913    l2_loss: 0.082901    loss: 0.403134
steps 9600    v_Prec: 0.588293  v_Recall: 0.831080  v_F1: 0.688922  v_AUC: 0.927941
steps 9600    running time 668 seconds

steps 9800    base_loss: 0.241916    reg_loss: 0.076459    l2_loss: 0.080682    loss: 0.399057
steps 9800    v_Prec: 0.586585  v_Recall: 0.836394  v_F1: 0.689562  v_AUC: 0.928362
steps 9800    running time 679 seconds

steps 10000    base_loss: 0.241314    reg_loss: 0.076152    l2_loss: 0.078559    loss: 0.396025
steps 10000    v_Prec: 0.584129  v_Recall: 0.839532  v_F1: 0.688921  v_AUC: 0.928394
steps 10000    running time 691 seconds

steps 10200    base_loss: 0.248055    reg_loss: 0.077234    l2_loss: 0.078093    loss: 0.403382
steps 10200    v_Prec: 0.583096  v_Recall: 0.843264  v_F1: 0.689452  v_AUC: 0.928904
steps 10200    running time 702 seconds

steps 10400    base_loss: 0.236786    reg_loss: 0.074292    l2_loss: 0.076610    loss: 0.387688
steps 10400    v_Prec: 0.591212  v_Recall: 0.826656  v_F1: 0.689386  v_AUC: 0.929192
steps 10400    running time 713 seconds

steps 10600    base_loss: 0.239455    reg_loss: 0.075242    l2_loss: 0.075826    loss: 0.390523
steps 10600    v_Prec: 0.580326  v_Recall: 0.849270  v_F1: 0.689500  v_AUC: 0.929393
steps 10600    running time 724 seconds

steps 10800    base_loss: 0.237023    reg_loss: 0.074682    l2_loss: 0.073893    loss: 0.385598
steps 10800    v_Prec: 0.586129  v_Recall: 0.843190  v_F1: 0.691544  v_AUC: 0.929490
steps 10800    running time 734 seconds

steps 11000    base_loss: 0.239782    reg_loss: 0.073802    l2_loss: 0.071703    loss: 0.385286
steps 11000    v_Prec: 0.589582  v_Recall: 0.837185  v_F1: 0.691898  v_AUC: 0.930189
steps 11000    running time 746 seconds

steps 11200    base_loss: 0.239528    reg_loss: 0.075263    l2_loss: 0.071808    loss: 0.386599
steps 11200    v_Prec: 0.590560  v_Recall: 0.835232  v_F1: 0.691903  v_AUC: 0.929120
steps 11200    running time 757 seconds

steps 11400    base_loss: 0.239455    reg_loss: 0.072956    l2_loss: 0.070210    loss: 0.382621
steps 11400    v_Prec: 0.583545  v_Recall: 0.846625  v_F1: 0.690888  v_AUC: 0.929422
steps 11400    running time 769 seconds

steps 11600    base_loss: 0.238263    reg_loss: 0.073510    l2_loss: 0.069409    loss: 0.381182
steps 11600    v_Prec: 0.585303  v_Recall: 0.845068  v_F1: 0.691598  v_AUC: 0.929623
steps 11600    running time 780 seconds

steps 11800    base_loss: 0.235052    reg_loss: 0.072925    l2_loss: 0.068314    loss: 0.376291
steps 11800    v_Prec: 0.586780  v_Recall: 0.841139  v_F1: 0.691305  v_AUC: 0.929947
steps 11800    running time 791 seconds

steps 12000    base_loss: 0.239979    reg_loss: 0.073791    l2_loss: 0.068099    loss: 0.381870
steps 12000    v_Prec: 0.587125  v_Recall: 0.838297  v_F1: 0.690582  v_AUC: 0.930011
steps 12000    running time 801 seconds

steps 12200    base_loss: 0.238149    reg_loss: 0.072988    l2_loss: 0.067910    loss: 0.379047
steps 12200    v_Prec: 0.587905  v_Recall: 0.841139  v_F1: 0.692085  v_AUC: 0.929970
steps 12200    running time 812 seconds

steps 12400    base_loss: 0.237501    reg_loss: 0.072903    l2_loss: 0.067282    loss: 0.377686
steps 12400    v_Prec: 0.583935  v_Recall: 0.847120  v_F1: 0.691326  v_AUC: 0.929239
steps 12400    running time 824 seconds

steps 12600    base_loss: 0.238380    reg_loss: 0.072230    l2_loss: 0.066149    loss: 0.376758
steps 12600    v_Prec: 0.584365  v_Recall: 0.847787  v_F1: 0.691850  v_AUC: 0.929924
steps 12600    running time 835 seconds

steps 12800    base_loss: 0.239263    reg_loss: 0.072347    l2_loss: 0.065475    loss: 0.377084
steps 12800    v_Prec: 0.581908  v_Recall: 0.854015  v_F1: 0.692179  v_AUC: 0.929844
steps 12800    running time 846 seconds

steps 13000    base_loss: 0.237580    reg_loss: 0.071564    l2_loss: 0.065547    loss: 0.374691
steps 13000    v_Prec: 0.586713  v_Recall: 0.844450  v_F1: 0.692374  v_AUC: 0.929771
steps 13000    running time 858 seconds

steps 13200    base_loss: 0.235570    reg_loss: 0.072090    l2_loss: 0.064455    loss: 0.372115
steps 13200    v_Prec: 0.585070  v_Recall: 0.851889  v_F1: 0.693708  v_AUC: 0.930061
steps 13200    running time 869 seconds

steps 13400    base_loss: 0.233930    reg_loss: 0.071749    l2_loss: 0.064745    loss: 0.370423
steps 13400    v_Prec: 0.590615  v_Recall: 0.839878  v_F1: 0.693530  v_AUC: 0.929889
steps 13400    running time 881 seconds

steps 13600    base_loss: 0.236742    reg_loss: 0.071397    l2_loss: 0.063932    loss: 0.372071
steps 13600    v_Prec: 0.589697  v_Recall: 0.840496  v_F1: 0.693106  v_AUC: 0.929942
steps 13600    running time 892 seconds

steps 13800    base_loss: 0.225619    reg_loss: 0.069986    l2_loss: 0.064315    loss: 0.359920
steps 13800    v_Prec: 0.587429  v_Recall: 0.844871  v_F1: 0.693013  v_AUC: 0.928776
steps 13800    running time 903 seconds

steps 14000    base_loss: 0.240667    reg_loss: 0.071434    l2_loss: 0.063739    loss: 0.375839
steps 14000    v_Prec: 0.584497  v_Recall: 0.849047  v_F1: 0.692362  v_AUC: 0.929474
steps 14000    running time 914 seconds

steps 14200    base_loss: 0.233906    reg_loss: 0.071748    l2_loss: 0.063665    loss: 0.369320
steps 14200    v_Prec: 0.588996  v_Recall: 0.849294  v_F1: 0.695591  v_AUC: 0.929391
steps 14200    running time 926 seconds

steps 14400    base_loss: 0.233427    reg_loss: 0.071170    l2_loss: 0.063740    loss: 0.368338
steps 14400    v_Prec: 0.590704  v_Recall: 0.843042  v_F1: 0.694668  v_AUC: 0.929350
steps 14400    running time 937 seconds

steps 14600    base_loss: 0.240141    reg_loss: 0.073568    l2_loss: 0.063730    loss: 0.377439
steps 14600    v_Prec: 0.589762  v_Recall: 0.834293  v_F1: 0.691033  v_AUC: 0.929251
steps 14600    running time 948 seconds

steps 14800    base_loss: 0.231507    reg_loss: 0.070547    l2_loss: 0.062783    loss: 0.364837
steps 14800    v_Prec: 0.589557  v_Recall: 0.839088  v_F1: 0.692530  v_AUC: 0.929097
steps 14800    running time 959 seconds

steps 15000    base_loss: 0.239171    reg_loss: 0.072388    l2_loss: 0.062663    loss: 0.374222
steps 15000    v_Prec: 0.591646  v_Recall: 0.838420  v_F1: 0.693742  v_AUC: 0.930543
steps 15000    running time 970 seconds

steps 15200    base_loss: 0.232281    reg_loss: 0.071007    l2_loss: 0.061876    loss: 0.365164
steps 15200    v_Prec: 0.593324  v_Recall: 0.835504  v_F1: 0.693890  v_AUC: 0.929960
steps 15200    running time 981 seconds

steps 15400    base_loss: 0.238417    reg_loss: 0.071832    l2_loss: 0.063070    loss: 0.373319
steps 15400    v_Prec: 0.585921  v_Recall: 0.851840  v_F1: 0.694289  v_AUC: 0.929439
steps 15400    running time 992 seconds

steps 15600    base_loss: 0.241657    reg_loss: 0.072375    l2_loss: 0.061365    loss: 0.375396
steps 15600    v_Prec: 0.592955  v_Recall: 0.838223  v_F1: 0.694572  v_AUC: 0.930123
steps 15600    running time 1003 seconds

steps 15800    base_loss: 0.239596    reg_loss: 0.070930    l2_loss: 0.062000    loss: 0.372526
steps 15800    v_Prec: 0.594824  v_Recall: 0.833898  v_F1: 0.694358  v_AUC: 0.929674
steps 15800    running time 1014 seconds

steps 16000    base_loss: 0.236551    reg_loss: 0.069548    l2_loss: 0.062445    loss: 0.368544
steps 16000    v_Prec: 0.594050  v_Recall: 0.839977  v_F1: 0.695926  v_AUC: 0.930225
steps 16000    running time 1025 seconds

steps 16200    base_loss: 0.236567    reg_loss: 0.070891    l2_loss: 0.062166    loss: 0.369624
steps 16200    v_Prec: 0.592771  v_Recall: 0.839384  v_F1: 0.694845  v_AUC: 0.930076
steps 16200    running time 1037 seconds

steps 16400    base_loss: 0.237540    reg_loss: 0.070713    l2_loss: 0.062414    loss: 0.370666
steps 16400    v_Prec: 0.593083  v_Recall: 0.837012  v_F1: 0.694244  v_AUC: 0.929577
steps 16400    running time 1047 seconds

steps 16600    base_loss: 0.237262    reg_loss: 0.069943    l2_loss: 0.062319    loss: 0.369523
steps 16600    v_Prec: 0.593549  v_Recall: 0.834120  v_F1: 0.693566  v_AUC: 0.929771
steps 16600    running time 1059 seconds

steps 16800    base_loss: 0.229842    reg_loss: 0.069663    l2_loss: 0.061904    loss: 0.361409
steps 16800    v_Prec: 0.591386  v_Recall: 0.841238  v_F1: 0.694525  v_AUC: 0.929516
steps 16800    running time 1070 seconds

steps 17000    base_loss: 0.232527    reg_loss: 0.070279    l2_loss: 0.062550    loss: 0.365357
steps 17000    v_Prec: 0.589577  v_Recall: 0.841856  v_F1: 0.693485  v_AUC: 0.928601
steps 17000    running time 1081 seconds

steps 17200    base_loss: 0.235376    reg_loss: 0.070807    l2_loss: 0.063767    loss: 0.369951
steps 17200    v_Prec: 0.594498  v_Recall: 0.832662  v_F1: 0.693708  v_AUC: 0.929377
steps 17200    running time 1092 seconds

steps 17400    base_loss: 0.237314    reg_loss: 0.070904    l2_loss: 0.061970    loss: 0.370188
steps 17400    v_Prec: 0.587246  v_Recall: 0.844129  v_F1: 0.692637  v_AUC: 0.928437
steps 17400    running time 1102 seconds

steps 17600    base_loss: 0.234778    reg_loss: 0.070187    l2_loss: 0.061745    loss: 0.366710
steps 17600    v_Prec: 0.595500  v_Recall: 0.830784  v_F1: 0.693736  v_AUC: 0.927824
steps 17600    running time 1114 seconds

steps 17800    base_loss: 0.236224    reg_loss: 0.070158    l2_loss: 0.062337    loss: 0.368719
steps 17800    v_Prec: 0.587506  v_Recall: 0.841411  v_F1: 0.691900  v_AUC: 0.928478
steps 17800    running time 1125 seconds

steps 18000    base_loss: 0.239919    reg_loss: 0.071084    l2_loss: 0.064023    loss: 0.375026
steps 18000    v_Prec: 0.584684  v_Recall: 0.847614  v_F1: 0.692016  v_AUC: 0.928835
steps 18000    running time 1135 seconds

Early stop model F1: 0.695926
testing thre: 0.22936542
testing Prec: 0.562774559113771
testing Recall: 0.7695332337023548
testing F1: 0.6501106255707483
testing AUC: 0.8931809062316678
overall running time 1144 seconds
(0.5727227695525345, 0.7549077929803688, 0.6513150482580774, 0.8931809062316678, 0.25661632)
2019-02-17 05:31:07.566353: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 05:31:07.881511: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 05:31:07.882461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 05:31:07.882496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 87.830000 seconds
loading data in 109.520000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	0.3
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.587703    reg_loss: 0.644189    l2_loss: 0.884129    loss: 2.116021
steps 200    v_Prec: 0.157147  v_Recall: 1.000000  v_F1: 0.271611  v_AUC: 0.463142
steps 200    running time 126 seconds

steps 400    base_loss: 0.544666    reg_loss: 0.638339    l2_loss: 0.874083    loss: 2.057088
steps 400    v_Prec: 0.157146  v_Recall: 1.000000  v_F1: 0.271609  v_AUC: 0.452922
steps 400    running time 138 seconds

steps 600    base_loss: 0.504134    reg_loss: 0.627540    l2_loss: 0.850584    loss: 1.982258
steps 600    v_Prec: 0.157145  v_Recall: 1.000000  v_F1: 0.271608  v_AUC: 0.435745
steps 600    running time 149 seconds

steps 800    base_loss: 0.481785    reg_loss: 0.611622    l2_loss: 0.815706    loss: 1.909113
steps 800    v_Prec: 0.157146  v_Recall: 1.000000  v_F1: 0.271609  v_AUC: 0.414803
steps 800    running time 160 seconds

steps 1000    base_loss: 0.466987    reg_loss: 0.583411    l2_loss: 0.772951    loss: 1.823349
steps 1000    v_Prec: 0.157146  v_Recall: 1.000000  v_F1: 0.271610  v_AUC: 0.414241
steps 1000    running time 171 seconds

steps 1200    base_loss: 0.473477    reg_loss: 0.549555    l2_loss: 0.725756    loss: 1.748788
steps 1200    v_Prec: 0.157148  v_Recall: 1.000000  v_F1: 0.271612  v_AUC: 0.442198
steps 1200    running time 182 seconds

steps 1400    base_loss: 0.460429    reg_loss: 0.501196    l2_loss: 0.675119    loss: 1.636744
steps 1400    v_Prec: 0.157205  v_Recall: 0.998351  v_F1: 0.271636  v_AUC: 0.494082
steps 1400    running time 193 seconds

steps 1600    base_loss: 0.460725    reg_loss: 0.454376    l2_loss: 0.621639    loss: 1.536740
steps 1600    v_Prec: 0.177374  v_Recall: 0.642389  v_F1: 0.277991  v_AUC: 0.570192
steps 1600    running time 205 seconds

steps 1800    base_loss: 0.449806    reg_loss: 0.410698    l2_loss: 0.573103    loss: 1.433607
steps 1800    v_Prec: 0.295827  v_Recall: 0.443733  v_F1: 0.354990  v_AUC: 0.663072
steps 1800    running time 216 seconds

steps 2000    base_loss: 0.422406    reg_loss: 0.369884    l2_loss: 0.526465    loss: 1.318755
steps 2000    v_Prec: 0.346859  v_Recall: 0.514424  v_F1: 0.414341  v_AUC: 0.717434
steps 2000    running time 228 seconds

steps 2200    base_loss: 0.401807    reg_loss: 0.340008    l2_loss: 0.487651    loss: 1.229466
steps 2200    v_Prec: 0.369421  v_Recall: 0.565324  v_F1: 0.446844  v_AUC: 0.742935
steps 2200    running time 239 seconds

steps 2400    base_loss: 0.390476    reg_loss: 0.316118    l2_loss: 0.452164    loss: 1.158759
steps 2400    v_Prec: 0.393769  v_Recall: 0.574554  v_F1: 0.467285  v_AUC: 0.759873
steps 2400    running time 251 seconds

steps 2600    base_loss: 0.380344    reg_loss: 0.297190    l2_loss: 0.422392    loss: 1.099926
steps 2600    v_Prec: 0.413078  v_Recall: 0.576548  v_F1: 0.481312  v_AUC: 0.773246
steps 2600    running time 262 seconds

steps 2800    base_loss: 0.378038    reg_loss: 0.288429    l2_loss: 0.394717    loss: 1.061184
steps 2800    v_Prec: 0.424051  v_Recall: 0.592375  v_F1: 0.494275  v_AUC: 0.785025
steps 2800    running time 274 seconds

steps 3000    base_loss: 0.371132    reg_loss: 0.277304    l2_loss: 0.369545    loss: 1.017981
steps 3000    v_Prec: 0.437039  v_Recall: 0.605248  v_F1: 0.507570  v_AUC: 0.797210
steps 3000    running time 285 seconds

steps 3200    base_loss: 0.361690    reg_loss: 0.269065    l2_loss: 0.348013    loss: 0.978768
steps 3200    v_Prec: 0.454159  v_Recall: 0.607315  v_F1: 0.519688  v_AUC: 0.809800
steps 3200    running time 296 seconds

steps 3400    base_loss: 0.348767    reg_loss: 0.262330    l2_loss: 0.326309    loss: 0.937407
steps 3400    v_Prec: 0.466432  v_Recall: 0.619376  v_F1: 0.532132  v_AUC: 0.820551
steps 3400    running time 308 seconds

steps 3600    base_loss: 0.343344    reg_loss: 0.260241    l2_loss: 0.308875    loss: 0.912459
steps 3600    v_Prec: 0.480712  v_Recall: 0.643817  v_F1: 0.550436  v_AUC: 0.833941
steps 3600    running time 320 seconds

steps 3800    base_loss: 0.322508    reg_loss: 0.247117    l2_loss: 0.289856    loss: 0.859480
steps 3800    v_Prec: 0.494614  v_Recall: 0.657748  v_F1: 0.564634  v_AUC: 0.845188
steps 3800    running time 331 seconds

steps 4000    base_loss: 0.326499    reg_loss: 0.247511    l2_loss: 0.274994    loss: 0.849004
steps 4000    v_Prec: 0.518161  v_Recall: 0.658364  v_F1: 0.579909  v_AUC: 0.857327
steps 4000    running time 343 seconds

steps 4200    base_loss: 0.318292    reg_loss: 0.248392    l2_loss: 0.259974    loss: 0.826658
steps 4200    v_Prec: 0.515998  v_Recall: 0.687088  v_F1: 0.589378  v_AUC: 0.865359
steps 4200    running time 354 seconds

steps 4400    base_loss: 0.309270    reg_loss: 0.240916    l2_loss: 0.248985    loss: 0.799171
steps 4400    v_Prec: 0.531242  v_Recall: 0.697475  v_F1: 0.603114  v_AUC: 0.874723
steps 4400    running time 366 seconds

steps 4600    base_loss: 0.300516    reg_loss: 0.238968    l2_loss: 0.237913    loss: 0.777397
steps 4600    v_Prec: 0.533150  v_Recall: 0.717092  v_F1: 0.611590  v_AUC: 0.881461
steps 4600    running time 378 seconds

steps 4800    base_loss: 0.295651    reg_loss: 0.239513    l2_loss: 0.227468    loss: 0.762632
steps 4800    v_Prec: 0.548781  v_Recall: 0.702914  v_F1: 0.616357  v_AUC: 0.886068
steps 4800    running time 389 seconds

steps 5000    base_loss: 0.293942    reg_loss: 0.236303    l2_loss: 0.217701    loss: 0.747945
steps 5000    v_Prec: 0.546770  v_Recall: 0.727577  v_F1: 0.624347  v_AUC: 0.891248
steps 5000    running time 400 seconds

steps 5200    base_loss: 0.285763    reg_loss: 0.232608    l2_loss: 0.207196    loss: 0.725567
steps 5200    v_Prec: 0.546085  v_Recall: 0.751452  v_F1: 0.632517  v_AUC: 0.896545
steps 5200    running time 412 seconds

steps 5400    base_loss: 0.282181    reg_loss: 0.228998    l2_loss: 0.198713    loss: 0.709892
steps 5400    v_Prec: 0.562879  v_Recall: 0.737570  v_F1: 0.638491  v_AUC: 0.900952
steps 5400    running time 424 seconds

steps 5600    base_loss: 0.275916    reg_loss: 0.227144    l2_loss: 0.191683    loss: 0.694744
steps 5600    v_Prec: 0.559898  v_Recall: 0.761322  v_F1: 0.645256  v_AUC: 0.904056
steps 5600    running time 435 seconds

steps 5800    base_loss: 0.278740    reg_loss: 0.232809    l2_loss: 0.184102    loss: 0.695651
steps 5800    v_Prec: 0.567819  v_Recall: 0.761667  v_F1: 0.650611  v_AUC: 0.907203
steps 5800    running time 447 seconds

steps 6000    base_loss: 0.268027    reg_loss: 0.222287    l2_loss: 0.177218    loss: 0.667533
steps 6000    v_Prec: 0.577087  v_Recall: 0.762381  v_F1: 0.656918  v_AUC: 0.909983
steps 6000    running time 458 seconds

steps 6200    base_loss: 0.264900    reg_loss: 0.221390    l2_loss: 0.171436    loss: 0.657726
steps 6200    v_Prec: 0.569159  v_Recall: 0.776927  v_F1: 0.657009  v_AUC: 0.911711
steps 6200    running time 470 seconds

steps 6400    base_loss: 0.264487    reg_loss: 0.218510    l2_loss: 0.164855    loss: 0.647852
steps 6400    v_Prec: 0.578659  v_Recall: 0.768189  v_F1: 0.660089  v_AUC: 0.914174
steps 6400    running time 482 seconds

steps 6600    base_loss: 0.260251    reg_loss: 0.217555    l2_loss: 0.159264    loss: 0.637070
steps 6600    v_Prec: 0.579801  v_Recall: 0.775057  v_F1: 0.663359  v_AUC: 0.915734
steps 6600    running time 493 seconds

steps 6800    base_loss: 0.261453    reg_loss: 0.220345    l2_loss: 0.155574    loss: 0.637372
steps 6800    v_Prec: 0.574751  v_Recall: 0.794378  v_F1: 0.666949  v_AUC: 0.917647
steps 6800    running time 505 seconds

steps 7000    base_loss: 0.260758    reg_loss: 0.214541    l2_loss: 0.148673    loss: 0.623972
steps 7000    v_Prec: 0.580184  v_Recall: 0.796175  v_F1: 0.671232  v_AUC: 0.920167
steps 7000    running time 516 seconds

steps 7200    base_loss: 0.251119    reg_loss: 0.211344    l2_loss: 0.144667    loss: 0.607130
steps 7200    v_Prec: 0.578869  v_Recall: 0.808433  v_F1: 0.674657  v_AUC: 0.921414
steps 7200    running time 528 seconds

steps 7400    base_loss: 0.251344    reg_loss: 0.211519    l2_loss: 0.138870    loss: 0.601733
steps 7400    v_Prec: 0.591426  v_Recall: 0.789111  v_F1: 0.676115  v_AUC: 0.922536
steps 7400    running time 539 seconds

steps 7600    base_loss: 0.251493    reg_loss: 0.214320    l2_loss: 0.136292    loss: 0.602105
steps 7600    v_Prec: 0.585784  v_Recall: 0.803239  v_F1: 0.677490  v_AUC: 0.924107
steps 7600    running time 550 seconds

steps 7800    base_loss: 0.247240    reg_loss: 0.205821    l2_loss: 0.131755    loss: 0.584816
steps 7800    v_Prec: 0.582922  v_Recall: 0.813749  v_F1: 0.679261  v_AUC: 0.925545
steps 7800    running time 562 seconds

steps 8000    base_loss: 0.247411    reg_loss: 0.206478    l2_loss: 0.127936    loss: 0.581825
steps 8000    v_Prec: 0.588306  v_Recall: 0.808334  v_F1: 0.680988  v_AUC: 0.925903
steps 8000    running time 574 seconds

steps 8200    base_loss: 0.244564    reg_loss: 0.204722    l2_loss: 0.124937    loss: 0.574223
steps 8200    v_Prec: 0.587962  v_Recall: 0.812174  v_F1: 0.682116  v_AUC: 0.927288
steps 8200    running time 585 seconds

steps 8400    base_loss: 0.245092    reg_loss: 0.200780    l2_loss: 0.120762    loss: 0.566634
steps 8400    v_Prec: 0.589471  v_Recall: 0.816014  v_F1: 0.684484  v_AUC: 0.928136
steps 8400    running time 596 seconds

steps 8600    base_loss: 0.241941    reg_loss: 0.198740    l2_loss: 0.118158    loss: 0.558839
steps 8600    v_Prec: 0.590088  v_Recall: 0.817638  v_F1: 0.685472  v_AUC: 0.928724
steps 8600    running time 608 seconds

steps 8800    base_loss: 0.237510    reg_loss: 0.193178    l2_loss: 0.115392    loss: 0.546080
steps 8800    v_Prec: 0.591872  v_Recall: 0.816949  v_F1: 0.686431  v_AUC: 0.929417
steps 8800    running time 619 seconds

steps 9000    base_loss: 0.245321    reg_loss: 0.196471    l2_loss: 0.113555    loss: 0.555347
steps 9000    v_Prec: 0.587878  v_Recall: 0.825342  v_F1: 0.686660  v_AUC: 0.930643
steps 9000    running time 631 seconds

steps 9200    base_loss: 0.240319    reg_loss: 0.192241    l2_loss: 0.110635    loss: 0.543196
steps 9200    v_Prec: 0.596274  v_Recall: 0.814512  v_F1: 0.688513  v_AUC: 0.930519
steps 9200    running time 642 seconds

steps 9400    base_loss: 0.234534    reg_loss: 0.190145    l2_loss: 0.106461    loss: 0.531140
steps 9400    v_Prec: 0.588713  v_Recall: 0.832702  v_F1: 0.689767  v_AUC: 0.931227
steps 9400    running time 654 seconds

steps 9600    base_loss: 0.241178    reg_loss: 0.188319    l2_loss: 0.104334    loss: 0.533831
steps 9600    v_Prec: 0.592965  v_Recall: 0.828148  v_F1: 0.691096  v_AUC: 0.931947
steps 9600    running time 665 seconds

steps 9800    base_loss: 0.238380    reg_loss: 0.188995    l2_loss: 0.103591    loss: 0.530966
steps 9800    v_Prec: 0.597463  v_Recall: 0.818475  v_F1: 0.690720  v_AUC: 0.931588
steps 9800    running time 677 seconds

steps 10000    base_loss: 0.243112    reg_loss: 0.186843    l2_loss: 0.102320    loss: 0.532275
steps 10000    v_Prec: 0.587170  v_Recall: 0.836517  v_F1: 0.690008  v_AUC: 0.931813
steps 10000    running time 687 seconds

steps 10200    base_loss: 0.241759    reg_loss: 0.188143    l2_loss: 0.099839    loss: 0.529741
steps 10200    v_Prec: 0.590592  v_Recall: 0.835926  v_F1: 0.692163  v_AUC: 0.932033
steps 10200    running time 699 seconds

steps 10400    base_loss: 0.231488    reg_loss: 0.177976    l2_loss: 0.098299    loss: 0.507763
steps 10400    v_Prec: 0.588181  v_Recall: 0.840750  v_F1: 0.692144  v_AUC: 0.932373
steps 10400    running time 710 seconds

steps 10600    base_loss: 0.238614    reg_loss: 0.181174    l2_loss: 0.097638    loss: 0.517426
steps 10600    v_Prec: 0.592591  v_Recall: 0.834277  v_F1: 0.692965  v_AUC: 0.932688
steps 10600    running time 721 seconds

steps 10800    base_loss: 0.228771    reg_loss: 0.175893    l2_loss: 0.095852    loss: 0.500516
steps 10800    v_Prec: 0.600280  v_Recall: 0.823767  v_F1: 0.694487  v_AUC: 0.932738
steps 10800    running time 732 seconds

steps 11000    base_loss: 0.243725    reg_loss: 0.180028    l2_loss: 0.094563    loss: 0.518315
steps 11000    v_Prec: 0.595148  v_Recall: 0.829133  v_F1: 0.692921  v_AUC: 0.932532
steps 11000    running time 744 seconds

steps 11200    base_loss: 0.240170    reg_loss: 0.179208    l2_loss: 0.093743    loss: 0.513120
steps 11200    v_Prec: 0.588111  v_Recall: 0.841562  v_F1: 0.692371  v_AUC: 0.933086
steps 11200    running time 755 seconds

steps 11400    base_loss: 0.236216    reg_loss: 0.175436    l2_loss: 0.092230    loss: 0.503882
steps 11400    v_Prec: 0.602832  v_Recall: 0.811140  v_F1: 0.691642  v_AUC: 0.932711
steps 11400    running time 765 seconds

steps 11600    base_loss: 0.242620    reg_loss: 0.180026    l2_loss: 0.091950    loss: 0.514596
steps 11600    v_Prec: 0.595056  v_Recall: 0.831200  v_F1: 0.693579  v_AUC: 0.933421
steps 11600    running time 776 seconds

steps 11800    base_loss: 0.238188    reg_loss: 0.175665    l2_loss: 0.091916    loss: 0.505769
steps 11800    v_Prec: 0.592942  v_Recall: 0.836172  v_F1: 0.693858  v_AUC: 0.932901
steps 11800    running time 787 seconds

steps 12000    base_loss: 0.237195    reg_loss: 0.170684    l2_loss: 0.089468    loss: 0.497347
steps 12000    v_Prec: 0.594748  v_Recall: 0.835631  v_F1: 0.694906  v_AUC: 0.933308
steps 12000    running time 798 seconds

steps 12200    base_loss: 0.231268    reg_loss: 0.169326    l2_loss: 0.087870    loss: 0.488465
steps 12200    v_Prec: 0.595802  v_Recall: 0.829354  v_F1: 0.693441  v_AUC: 0.932144
steps 12200    running time 810 seconds

steps 12400    base_loss: 0.241773    reg_loss: 0.170905    l2_loss: 0.088304    loss: 0.500982
steps 12400    v_Prec: 0.593265  v_Recall: 0.839052  v_F1: 0.695070  v_AUC: 0.932562
steps 12400    running time 821 seconds

steps 12600    base_loss: 0.241439    reg_loss: 0.171607    l2_loss: 0.089290    loss: 0.502336
steps 12600    v_Prec: 0.589042  v_Recall: 0.840923  v_F1: 0.692798  v_AUC: 0.932623
steps 12600    running time 832 seconds

steps 12800    base_loss: 0.228566    reg_loss: 0.165344    l2_loss: 0.087148    loss: 0.481058
steps 12800    v_Prec: 0.595863  v_Recall: 0.828222  v_F1: 0.693086  v_AUC: 0.932225
steps 12800    running time 843 seconds

steps 13000    base_loss: 0.239371    reg_loss: 0.169305    l2_loss: 0.087625    loss: 0.496301
steps 13000    v_Prec: 0.588354  v_Recall: 0.842055  v_F1: 0.692706  v_AUC: 0.931945
steps 13000    running time 853 seconds

steps 13200    base_loss: 0.241704    reg_loss: 0.171002    l2_loss: 0.086797    loss: 0.499503
steps 13200    v_Prec: 0.590118  v_Recall: 0.836911  v_F1: 0.692174  v_AUC: 0.931816
steps 13200    running time 864 seconds

steps 13400    base_loss: 0.229545    reg_loss: 0.161474    l2_loss: 0.086245    loss: 0.477265
steps 13400    v_Prec: 0.588482  v_Recall: 0.839790  v_F1: 0.692027  v_AUC: 0.931294
steps 13400    running time 875 seconds

steps 13600    base_loss: 0.232237    reg_loss: 0.162109    l2_loss: 0.086192    loss: 0.480538
steps 13600    v_Prec: 0.590346  v_Recall: 0.834474  v_F1: 0.691496  v_AUC: 0.931584
steps 13600    running time 886 seconds

steps 13800    base_loss: 0.241716    reg_loss: 0.165777    l2_loss: 0.086637    loss: 0.494130
steps 13800    v_Prec: 0.586434  v_Recall: 0.842670  v_F1: 0.691580  v_AUC: 0.931124
steps 13800    running time 897 seconds

steps 14000    base_loss: 0.234122    reg_loss: 0.162442    l2_loss: 0.085219    loss: 0.481782
steps 14000    v_Prec: 0.586576  v_Recall: 0.843655  v_F1: 0.692011  v_AUC: 0.931158
steps 14000    running time 908 seconds

steps 14200    base_loss: 0.234877    reg_loss: 0.162637    l2_loss: 0.084915    loss: 0.482428
steps 14200    v_Prec: 0.596032  v_Recall: 0.828837  v_F1: 0.693416  v_AUC: 0.930671
steps 14200    running time 919 seconds

steps 14400    base_loss: 0.237423    reg_loss: 0.165271    l2_loss: 0.085322    loss: 0.488016
steps 14400    v_Prec: 0.592327  v_Recall: 0.833366  v_F1: 0.692471  v_AUC: 0.930943
steps 14400    running time 930 seconds

Early stop model F1: 0.695070
testing thre: 0.22392142
testing Prec: 0.4236311897008248
testing Recall: 0.8078379594027945
testing F1: 0.5558001287752871
testing AUC: 0.8678424576606634
overall running time 938 seconds
(0.533596214511041, 0.6871925828122053, 0.6007318573575764, 0.8678424576606634, 0.39343178)
2019-02-17 05:42:00.446767: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-17 05:42:01.158679: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-17 05:42:01.159636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:0a.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-17 05:42:01.159674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:0a.0, compute capability: 6.1)
user_feat_size is 14, in 87.710000 seconds
loading data in 109.680000 seconds
train/valid/test size: 2326847/258539/438949
poi_feat_size 	3
dim 	64
action_feat_size 	2
cuda_devices 	0
epsilon 	1e-06
dropout 	0.2
fnn_hidden 	16
item_size 	295795
batch_size 	128
patience 	10
warmup_steps 	18178
reg_weight 	1.0
user_feat_size 	14
l2_weight 	0.0006
max_steps 	100000
dir 	../beijing/
steps 200    base_loss: 0.479143    reg_loss: 2.156108    l2_loss: 0.886029    loss: 3.521279
steps 200    v_Prec: 0.155799  v_Recall: 1.000000  v_F1: 0.269595  v_AUC: 0.467785
steps 200    running time 127 seconds

steps 400    base_loss: 0.469200    reg_loss: 2.137238    l2_loss: 0.879125    loss: 3.485563
steps 400    v_Prec: 0.155799  v_Recall: 1.000000  v_F1: 0.269595  v_AUC: 0.459766
steps 400    running time 138 seconds

steps 600    base_loss: 0.464796    reg_loss: 2.092054    l2_loss: 0.866444    loss: 3.423294
steps 600    v_Prec: 0.155799  v_Recall: 1.000000  v_F1: 0.269595  v_AUC: 0.445744
steps 600    running time 150 seconds

steps 800    base_loss: 0.468954    reg_loss: 2.027589    l2_loss: 0.847212    loss: 3.343754
steps 800    v_Prec: 0.155801  v_Recall: 1.000000  v_F1: 0.269598  v_AUC: 0.426794
steps 800    running time 161 seconds

steps 1000    base_loss: 0.462544    reg_loss: 1.919306    l2_loss: 0.824147    loss: 3.205997
steps 1000    v_Prec: 0.155804  v_Recall: 0.999975  v_F1: 0.269602  v_AUC: 0.403398
steps 1000    running time 172 seconds

steps 1200    base_loss: 0.459679    reg_loss: 1.784575    l2_loss: 0.795053    loss: 3.039308
steps 1200    v_Prec: 0.155803  v_Recall: 0.999975  v_F1: 0.269601  v_AUC: 0.378322
steps 1200    running time 184 seconds

steps 1400    base_loss: 0.468309    reg_loss: 1.633713    l2_loss: 0.760751    loss: 2.862773
steps 1400    v_Prec: 0.155799  v_Recall: 1.000000  v_F1: 0.269595  v_AUC: 0.352815
steps 1400    running time 195 seconds

steps 1600    base_loss: 0.466339    reg_loss: 1.471159    l2_loss: 0.723011    loss: 2.660509
steps 1600    v_Prec: 0.155835  v_Recall: 0.999628  v_F1: 0.269635  v_AUC: 0.416642
steps 1600    running time 206 seconds

steps 1800    base_loss: 0.445683    reg_loss: 1.317693    l2_loss: 0.683922    loss: 2.447297
steps 1800    v_Prec: 0.221689  v_Recall: 0.613928  v_F1: 0.325750  v_AUC: 0.624536
steps 1800    running time 218 seconds

steps 2000    base_loss: 0.429266    reg_loss: 1.177423    l2_loss: 0.644341    loss: 2.251030
steps 2000    v_Prec: 0.287330  v_Recall: 0.605611  v_F1: 0.389746  v_AUC: 0.694750
steps 2000    running time 229 seconds

steps 2200    base_loss: 0.412763    reg_loss: 1.064147    l2_loss: 0.604314    loss: 2.081223
steps 2200    v_Prec: 0.310197  v_Recall: 0.591931  v_F1: 0.407072  v_AUC: 0.717787
steps 2200    running time 241 seconds

steps 2400    base_loss: 0.416759    reg_loss: 1.013849    l2_loss: 0.568740    loss: 1.999348
steps 2400    v_Prec: 0.336941  v_Recall: 0.575869  v_F1: 0.425135  v_AUC: 0.734173
steps 2400    running time 252 seconds

steps 2600    base_loss: 0.394702    reg_loss: 0.929921    l2_loss: 0.532299    loss: 1.856922
steps 2600    v_Prec: 0.360912  v_Recall: 0.564772  v_F1: 0.440394  v_AUC: 0.746039
steps 2600    running time 264 seconds

steps 2800    base_loss: 0.383905    reg_loss: 0.873195    l2_loss: 0.497104    loss: 1.754205
steps 2800    v_Prec: 0.376541  v_Recall: 0.558044  v_F1: 0.449668  v_AUC: 0.754351
steps 2800    running time 276 seconds

steps 3000    base_loss: 0.378329    reg_loss: 0.834095    l2_loss: 0.466658    loss: 1.679082
steps 3000    v_Prec: 0.394019  v_Recall: 0.549826  v_F1: 0.459062  v_AUC: 0.762134
steps 3000    running time 288 seconds

steps 3200    base_loss: 0.380187    reg_loss: 0.816168    l2_loss: 0.439406    loss: 1.635760
steps 3200    v_Prec: 0.400128  v_Recall: 0.559633  v_F1: 0.466626  v_AUC: 0.770054
steps 3200    running time 299 seconds

steps 3400    base_loss: 0.373371    reg_loss: 0.787527    l2_loss: 0.414809    loss: 1.575706
steps 3400    v_Prec: 0.416039  v_Recall: 0.552284  v_F1: 0.474576  v_AUC: 0.777235
steps 3400    running time 311 seconds

steps 3600    base_loss: 0.362102    reg_loss: 0.747690    l2_loss: 0.388813    loss: 1.498605
steps 3600    v_Prec: 0.417922  v_Recall: 0.568024  v_F1: 0.481547  v_AUC: 0.783622
steps 3600    running time 322 seconds

steps 3800    base_loss: 0.357291    reg_loss: 0.732686    l2_loss: 0.367739    loss: 1.457716
steps 3800    v_Prec: 0.436896  v_Recall: 0.554667  v_F1: 0.488788  v_AUC: 0.791169
steps 3800    running time 334 seconds

steps 4000    base_loss: 0.360169    reg_loss: 0.727681    l2_loss: 0.348305    loss: 1.436156
steps 4000    v_Prec: 0.442871  v_Recall: 0.566683  v_F1: 0.497185  v_AUC: 0.800187
steps 4000    running time 346 seconds

steps 4200    base_loss: 0.354310    reg_loss: 0.717329    l2_loss: 0.330088    loss: 1.401727
steps 4200    v_Prec: 0.471347  v_Recall: 0.544389  v_F1: 0.505242  v_AUC: 0.809026
steps 4200    running time 357 seconds

steps 4400    base_loss: 0.346531    reg_loss: 0.701964    l2_loss: 0.310720    loss: 1.359215
steps 4400    v_Prec: 0.474804  v_Recall: 0.570531  v_F1: 0.518285  v_AUC: 0.818432
steps 4400    running time 369 seconds

steps 4600    base_loss: 0.340674    reg_loss: 0.683602    l2_loss: 0.295292    loss: 1.319567
steps 4600    v_Prec: 0.486134  v_Recall: 0.590988  v_F1: 0.533457  v_AUC: 0.828473
steps 4600    running time 381 seconds

steps 4800    base_loss: 0.336997    reg_loss: 0.677317    l2_loss: 0.281929    loss: 1.296242
steps 4800    v_Prec: 0.508772  v_Recall: 0.591807  v_F1: 0.547157  v_AUC: 0.839831
steps 4800    running time 392 seconds

steps 5000    base_loss: 0.325562    reg_loss: 0.665460    l2_loss: 0.265646    loss: 1.256668
steps 5000    v_Prec: 0.506954  v_Recall: 0.631653  v_F1: 0.562475  v_AUC: 0.849819
steps 5000    running time 404 seconds

steps 5200    base_loss: 0.324375    reg_loss: 0.667909    l2_loss: 0.254557    loss: 1.246840
steps 5200    v_Prec: 0.508300  v_Recall: 0.668222  v_F1: 0.577392  v_AUC: 0.861050
steps 5200    running time 415 seconds

steps 5400    base_loss: 0.315413    reg_loss: 0.661613    l2_loss: 0.243609    loss: 1.220635
steps 5400    v_Prec: 0.533448  v_Recall: 0.660626  v_F1: 0.590264  v_AUC: 0.871212
steps 5400    running time 427 seconds

steps 5600    base_loss: 0.299226    reg_loss: 0.631131    l2_loss: 0.232553    loss: 1.162910
steps 5600    v_Prec: 0.532744  v_Recall: 0.695953  v_F1: 0.603509  v_AUC: 0.880015
steps 5600    running time 438 seconds

steps 5800    base_loss: 0.295902    reg_loss: 0.647013    l2_loss: 0.222846    loss: 1.165761
steps 5800    v_Prec: 0.540402  v_Recall: 0.710626  v_F1: 0.613933  v_AUC: 0.886142
steps 5800    running time 450 seconds

steps 6000    base_loss: 0.298788    reg_loss: 0.644031    l2_loss: 0.214405    loss: 1.157225
steps 6000    v_Prec: 0.545956  v_Recall: 0.727905  v_F1: 0.623936  v_AUC: 0.893551
steps 6000    running time 462 seconds

steps 6200    base_loss: 0.287611    reg_loss: 0.623407    l2_loss: 0.204788    loss: 1.115806
steps 6200    v_Prec: 0.555396  v_Recall: 0.731902  v_F1: 0.631549  v_AUC: 0.898034
steps 6200    running time 474 seconds

steps 6400    base_loss: 0.284281    reg_loss: 0.626967    l2_loss: 0.197040    loss: 1.108288
steps 6400    v_Prec: 0.553995  v_Recall: 0.755760  v_F1: 0.639336  v_AUC: 0.902770
steps 6400    running time 485 seconds

steps 6600    base_loss: 0.286093    reg_loss: 0.630527    l2_loss: 0.190824    loss: 1.107445
steps 6600    v_Prec: 0.562406  v_Recall: 0.753873  v_F1: 0.644214  v_AUC: 0.906001
steps 6600    running time 497 seconds

steps 6800    base_loss: 0.272231    reg_loss: 0.606334    l2_loss: 0.184375    loss: 1.062940
steps 6800    v_Prec: 0.566377  v_Recall: 0.763133  v_F1: 0.650196  v_AUC: 0.908599
steps 6800    running time 508 seconds

steps 7000    base_loss: 0.272618    reg_loss: 0.614382    l2_loss: 0.176884    loss: 1.063885
steps 7000    v_Prec: 0.573887  v_Recall: 0.766683  v_F1: 0.656421  v_AUC: 0.911776
steps 7000    running time 520 seconds

steps 7200    base_loss: 0.272125    reg_loss: 0.606884    l2_loss: 0.171872    loss: 1.050882
steps 7200    v_Prec: 0.580160  v_Recall: 0.767502  v_F1: 0.660810  v_AUC: 0.913275
steps 7200    running time 532 seconds

steps 7400    base_loss: 0.271026    reg_loss: 0.611982    l2_loss: 0.167374    loss: 1.050382
steps 7400    v_Prec: 0.578687  v_Recall: 0.778426  v_F1: 0.663858  v_AUC: 0.915673
steps 7400    running time 543 seconds

steps 7600    base_loss: 0.260027    reg_loss: 0.585002    l2_loss: 0.162043    loss: 1.007071
steps 7600    v_Prec: 0.574892  v_Recall: 0.789449  v_F1: 0.665300  v_AUC: 0.916092
steps 7600    running time 555 seconds

steps 7800    base_loss: 0.259904    reg_loss: 0.588078    l2_loss: 0.156909    loss: 1.004891
steps 7800    v_Prec: 0.585995  v_Recall: 0.782423  v_F1: 0.670111  v_AUC: 0.918344
steps 7800    running time 566 seconds

steps 8000    base_loss: 0.253895    reg_loss: 0.579978    l2_loss: 0.153154    loss: 0.987028
steps 8000    v_Prec: 0.591218  v_Recall: 0.781852  v_F1: 0.673301  v_AUC: 0.920401
steps 8000    running time 578 seconds

steps 8200    base_loss: 0.251321    reg_loss: 0.571885    l2_loss: 0.149343    loss: 0.972550
steps 8200    v_Prec: 0.581216  v_Recall: 0.804121  v_F1: 0.674735  v_AUC: 0.921277
steps 8200    running time 589 seconds

steps 8400    base_loss: 0.252608    reg_loss: 0.579650    l2_loss: 0.146367    loss: 0.978625
steps 8400    v_Prec: 0.587831  v_Recall: 0.794638  v_F1: 0.675766  v_AUC: 0.921802
steps 8400    running time 601 seconds

steps 8600    base_loss: 0.250417    reg_loss: 0.565454    l2_loss: 0.141364    loss: 0.957236
steps 8600    v_Prec: 0.587068  v_Recall: 0.802656  v_F1: 0.678140  v_AUC: 0.922475
steps 8600    running time 613 seconds

steps 8800    base_loss: 0.251901    reg_loss: 0.566322    l2_loss: 0.139226    loss: 0.957449
steps 8800    v_Prec: 0.590505  v_Recall: 0.804394  v_F1: 0.681051  v_AUC: 0.923564
steps 8800    running time 624 seconds

steps 9000    base_loss: 0.246292    reg_loss: 0.556759    l2_loss: 0.135264    loss: 0.938314
steps 9000    v_Prec: 0.596485  v_Recall: 0.797865  v_F1: 0.682633  v_AUC: 0.923628
steps 9000    running time 636 seconds

steps 9200    base_loss: 0.244411    reg_loss: 0.551047    l2_loss: 0.132556    loss: 0.928014
steps 9200    v_Prec: 0.588921  v_Recall: 0.807646  v_F1: 0.681156  v_AUC: 0.923489
steps 9200    running time 648 seconds

steps 9400    base_loss: 0.247456    reg_loss: 0.551076    l2_loss: 0.129644    loss: 0.928176
steps 9400    v_Prec: 0.595043  v_Recall: 0.801092  v_F1: 0.682863  v_AUC: 0.924189
steps 9400    running time 659 seconds

steps 9600    base_loss: 0.244807    reg_loss: 0.552922    l2_loss: 0.127552    loss: 0.925281
steps 9600    v_Prec: 0.596581  v_Recall: 0.797890  v_F1: 0.682705  v_AUC: 0.924382
steps 9600    running time 671 seconds

steps 9800    base_loss: 0.245324    reg_loss: 0.548522    l2_loss: 0.125331    loss: 0.919177
steps 9800    v_Prec: 0.604509  v_Recall: 0.794762  v_F1: 0.686702  v_AUC: 0.925650
steps 9800    running time 681 seconds

steps 10000    base_loss: 0.240600    reg_loss: 0.527630    l2_loss: 0.122736    loss: 0.890967
steps 10000    v_Prec: 0.602758  v_Recall: 0.799628  v_F1: 0.687375  v_AUC: 0.925886
steps 10000    running time 693 seconds

steps 10200    base_loss: 0.245426    reg_loss: 0.540652    l2_loss: 0.122276    loss: 0.908355
steps 10200    v_Prec: 0.603081  v_Recall: 0.798932  v_F1: 0.687327  v_AUC: 0.925686
steps 10200    running time 705 seconds

steps 10400    base_loss: 0.249403    reg_loss: 0.549778    l2_loss: 0.121312    loss: 0.920493
steps 10400    v_Prec: 0.598511  v_Recall: 0.810501  v_F1: 0.688559  v_AUC: 0.926301
steps 10400    running time 716 seconds

steps 10600    base_loss: 0.241965    reg_loss: 0.541279    l2_loss: 0.116900    loss: 0.900145
steps 10600    v_Prec: 0.605775  v_Recall: 0.801539  v_F1: 0.690041  v_AUC: 0.927128
steps 10600    running time 727 seconds

steps 10800    base_loss: 0.241510    reg_loss: 0.528777    l2_loss: 0.116165    loss: 0.886452
steps 10800    v_Prec: 0.603630  v_Recall: 0.807498  v_F1: 0.690837  v_AUC: 0.927467
steps 10800    running time 739 seconds

steps 11000    base_loss: 0.243645    reg_loss: 0.540459    l2_loss: 0.115556    loss: 0.899660
steps 11000    v_Prec: 0.597679  v_Recall: 0.816882  v_F1: 0.690296  v_AUC: 0.927134
steps 11000    running time 750 seconds

steps 11200    base_loss: 0.242894    reg_loss: 0.529523    l2_loss: 0.114214    loss: 0.886631
steps 11200    v_Prec: 0.599711  v_Recall: 0.815343  v_F1: 0.691098  v_AUC: 0.927324
steps 11200    running time 761 seconds

steps 11400    base_loss: 0.241859    reg_loss: 0.538699    l2_loss: 0.113810    loss: 0.894368
steps 11400    v_Prec: 0.608737  v_Recall: 0.798113  v_F1: 0.690679  v_AUC: 0.927571
steps 11400    running time 773 seconds

steps 11600    base_loss: 0.242203    reg_loss: 0.529026    l2_loss: 0.112503    loss: 0.883732
steps 11600    v_Prec: 0.603020  v_Recall: 0.815963  v_F1: 0.693514  v_AUC: 0.927732
steps 11600    running time 784 seconds

steps 11800    base_loss: 0.243034    reg_loss: 0.538329    l2_loss: 0.111542    loss: 0.892904
steps 11800    v_Prec: 0.600181  v_Recall: 0.821450  v_F1: 0.693596  v_AUC: 0.927784
steps 11800    running time 795 seconds

steps 12000    base_loss: 0.233958    reg_loss: 0.524135    l2_loss: 0.110486    loss: 0.868578
steps 12000    v_Prec: 0.598326  v_Recall: 0.821599  v_F1: 0.692408  v_AUC: 0.927749
steps 12000    running time 807 seconds

steps 12200    base_loss: 0.246361    reg_loss: 0.534724    l2_loss: 0.109634    loss: 0.890720
steps 12200    v_Prec: 0.600794  v_Recall: 0.814995  v_F1: 0.691691  v_AUC: 0.927619
steps 12200    running time 818 seconds

steps 12400    base_loss: 0.241451    reg_loss: 0.527980    l2_loss: 0.108428    loss: 0.877859
steps 12400    v_Prec: 0.603767  v_Recall: 0.810079  v_F1: 0.691871  v_AUC: 0.928009
steps 12400    running time 829 seconds

steps 12600    base_loss: 0.243984    reg_loss: 0.524132    l2_loss: 0.106714    loss: 0.874830
steps 12600    v_Prec: 0.603175  v_Recall: 0.813133  v_F1: 0.692592  v_AUC: 0.928557
steps 12600    running time 840 seconds

steps 12800    base_loss: 0.241704    reg_loss: 0.527179    l2_loss: 0.108335    loss: 0.877218
steps 12800    v_Prec: 0.599993  v_Recall: 0.820655  v_F1: 0.693187  v_AUC: 0.929214
steps 12800    running time 851 seconds

steps 13000    base_loss: 0.241524    reg_loss: 0.532003    l2_loss: 0.106310    loss: 0.879837
steps 13000    v_Prec: 0.601901  v_Recall: 0.812686  v_F1: 0.691589  v_AUC: 0.928964
steps 13000    running time 862 seconds

steps 13200    base_loss: 0.236392    reg_loss: 0.514181    l2_loss: 0.105922    loss: 0.856496
steps 13200    v_Prec: 0.602922  v_Recall: 0.815442  v_F1: 0.693261  v_AUC: 0.928955
steps 13200    running time 873 seconds

steps 13400    base_loss: 0.240890    reg_loss: 0.524833    l2_loss: 0.106600    loss: 0.872323
steps 13400    v_Prec: 0.612643  v_Recall: 0.794687  v_F1: 0.691891  v_AUC: 0.929898
steps 13400    running time 884 seconds

steps 13600    base_loss: 0.240333    reg_loss: 0.524137    l2_loss: 0.105282    loss: 0.869752
steps 13600    v_Prec: 0.597276  v_Recall: 0.824131  v_F1: 0.692601  v_AUC: 0.929061
steps 13600    running time 895 seconds

steps 13800    base_loss: 0.233515    reg_loss: 0.500437    l2_loss: 0.104337    loss: 0.838289
steps 13800    v_Prec: 0.605084  v_Recall: 0.806678  v_F1: 0.691488  v_AUC: 0.928706
steps 13800    running time 906 seconds

Early stop model F1: 0.693596
testing thre: 0.2628337
testing Prec: 0.42316076085875776
testing Recall: 0.8027596813743272
testing F1: 0.5541899553258409
testing AUC: 0.8669338125880777
overall running time 915 seconds
(0.4957992107608096, 0.6781387385557377, 0.5728082162400652, 0.8669338125880777, 0.44608516)
