2019-02-24 00:07:49.608815: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:07:50.228880: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:07:50.231782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:07:50.231829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.620000 seconds
loading data in 30.570000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.807272    reg_loss: 0.064847    l2_loss: 0.013287    loss: 0.885405
steps 200    v_Prec: 0.163435  v_Recall: 1.000000  v_F1: 0.280953  v_AUC: 0.512382
steps 200    running time 40 seconds

steps 400    base_loss: 0.531365    reg_loss: 0.064649    l2_loss: 0.013087    loss: 0.609101
steps 400    v_Prec: 0.166107  v_Recall: 0.932301  v_F1: 0.281975  v_AUC: 0.525430
steps 400    running time 45 seconds

steps 600    base_loss: 0.476446    reg_loss: 0.064238    l2_loss: 0.013041    loss: 0.553726
steps 600    v_Prec: 0.176284  v_Recall: 0.771675  v_F1: 0.287004  v_AUC: 0.553082
steps 600    running time 51 seconds

steps 800    base_loss: 0.461597    reg_loss: 0.064170    l2_loss: 0.012962    loss: 0.538729
steps 800    v_Prec: 0.180148  v_Recall: 0.792272  v_F1: 0.293549  v_AUC: 0.575670
steps 800    running time 57 seconds

steps 1000    base_loss: 0.451512    reg_loss: 0.063869    l2_loss: 0.012865    loss: 0.528247
steps 1000    v_Prec: 0.200010  v_Recall: 0.669408  v_F1: 0.307995  v_AUC: 0.608871
steps 1000    running time 63 seconds

steps 1200    base_loss: 0.442325    reg_loss: 0.063397    l2_loss: 0.012787    loss: 0.518509
steps 1200    v_Prec: 0.239898  v_Recall: 0.518042  v_F1: 0.327934  v_AUC: 0.641679
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.433927    reg_loss: 0.063006    l2_loss: 0.012728    loss: 0.509661
steps 1400    v_Prec: 0.284835  v_Recall: 0.465751  v_F1: 0.353490  v_AUC: 0.669940
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.425080    reg_loss: 0.062561    l2_loss: 0.012727    loss: 0.500368
steps 1600    v_Prec: 0.325499  v_Recall: 0.474293  v_F1: 0.386055  v_AUC: 0.703550
steps 1600    running time 81 seconds

steps 1800    base_loss: 0.413451    reg_loss: 0.061972    l2_loss: 0.012725    loss: 0.488147
steps 1800    v_Prec: 0.346743  v_Recall: 0.513332  v_F1: 0.413904  v_AUC: 0.733096
steps 1800    running time 87 seconds

steps 2000    base_loss: 0.398762    reg_loss: 0.061567    l2_loss: 0.012856    loss: 0.473184
steps 2000    v_Prec: 0.402202  v_Recall: 0.498723  v_F1: 0.445292  v_AUC: 0.758377
steps 2000    running time 92 seconds

steps 2200    base_loss: 0.383119    reg_loss: 0.060988    l2_loss: 0.013036    loss: 0.457143
steps 2200    v_Prec: 0.423674  v_Recall: 0.537761  v_F1: 0.473949  v_AUC: 0.781491
steps 2200    running time 98 seconds

steps 2400    base_loss: 0.372255    reg_loss: 0.060463    l2_loss: 0.013239    loss: 0.445957
steps 2400    v_Prec: 0.438629  v_Recall: 0.564027  v_F1: 0.493487  v_AUC: 0.797573
steps 2400    running time 104 seconds

steps 2600    base_loss: 0.363225    reg_loss: 0.060083    l2_loss: 0.013587    loss: 0.436895
steps 2600    v_Prec: 0.460352  v_Recall: 0.569615  v_F1: 0.509188  v_AUC: 0.806581
steps 2600    running time 110 seconds

steps 2800    base_loss: 0.362709    reg_loss: 0.059494    l2_loss: 0.013935    loss: 0.436138
steps 2800    v_Prec: 0.472660  v_Recall: 0.574166  v_F1: 0.518492  v_AUC: 0.816055
steps 2800    running time 116 seconds

steps 3000    base_loss: 0.355149    reg_loss: 0.059084    l2_loss: 0.014183    loss: 0.428416
steps 3000    v_Prec: 0.498302  v_Recall: 0.562270  v_F1: 0.528357  v_AUC: 0.823694
steps 3000    running time 122 seconds

steps 3200    base_loss: 0.347743    reg_loss: 0.058560    l2_loss: 0.014619    loss: 0.420922
steps 3200    v_Prec: 0.493697  v_Recall: 0.584704  v_F1: 0.535361  v_AUC: 0.830256
steps 3200    running time 127 seconds

steps 3400    base_loss: 0.343636    reg_loss: 0.058168    l2_loss: 0.015054    loss: 0.416857
steps 3400    v_Prec: 0.519227  v_Recall: 0.565943  v_F1: 0.541579  v_AUC: 0.834018
steps 3400    running time 133 seconds

steps 3600    base_loss: 0.344798    reg_loss: 0.057733    l2_loss: 0.015512    loss: 0.418043
steps 3600    v_Prec: 0.505035  v_Recall: 0.596519  v_F1: 0.546979  v_AUC: 0.838749
steps 3600    running time 139 seconds

steps 3800    base_loss: 0.335673    reg_loss: 0.057060    l2_loss: 0.015956    loss: 0.408690
steps 3800    v_Prec: 0.526667  v_Recall: 0.579435  v_F1: 0.551792  v_AUC: 0.842348
steps 3800    running time 145 seconds

steps 4000    base_loss: 0.339338    reg_loss: 0.056737    l2_loss: 0.016501    loss: 0.412576
steps 4000    v_Prec: 0.523988  v_Recall: 0.590292  v_F1: 0.555168  v_AUC: 0.844021
steps 4000    running time 151 seconds

steps 4200    base_loss: 0.336299    reg_loss: 0.055924    l2_loss: 0.017000    loss: 0.409224
steps 4200    v_Prec: 0.518209  v_Recall: 0.608894  v_F1: 0.559903  v_AUC: 0.847715
steps 4200    running time 157 seconds

steps 4400    base_loss: 0.339857    reg_loss: 0.055815    l2_loss: 0.017545    loss: 0.413218
steps 4400    v_Prec: 0.513588  v_Recall: 0.627654  v_F1: 0.564921  v_AUC: 0.850698
steps 4400    running time 162 seconds

steps 4600    base_loss: 0.337958    reg_loss: 0.055100    l2_loss: 0.018124    loss: 0.411183
steps 4600    v_Prec: 0.533539  v_Recall: 0.607696  v_F1: 0.568208  v_AUC: 0.852685
steps 4600    running time 168 seconds

steps 4800    base_loss: 0.331964    reg_loss: 0.054489    l2_loss: 0.018870    loss: 0.405322
steps 4800    v_Prec: 0.540298  v_Recall: 0.599952  v_F1: 0.568564  v_AUC: 0.854612
steps 4800    running time 175 seconds

steps 5000    base_loss: 0.331789    reg_loss: 0.054083    l2_loss: 0.019552    loss: 0.405424
steps 5000    v_Prec: 0.541667  v_Recall: 0.610251  v_F1: 0.573917  v_AUC: 0.856908
steps 5000    running time 180 seconds

steps 5200    base_loss: 0.328449    reg_loss: 0.053413    l2_loss: 0.020299    loss: 0.402160
steps 5200    v_Prec: 0.535453  v_Recall: 0.631806  v_F1: 0.579653  v_AUC: 0.860030
steps 5200    running time 186 seconds

steps 5400    base_loss: 0.320417    reg_loss: 0.052884    l2_loss: 0.020933    loss: 0.394234
steps 5400    v_Prec: 0.553783  v_Recall: 0.615280  v_F1: 0.582914  v_AUC: 0.860944
steps 5400    running time 192 seconds

steps 5600    base_loss: 0.226112    reg_loss: 0.055496    l2_loss: 0.021502    loss: 0.303110
steps 5600    v_Prec: 0.529745  v_Recall: 0.626297  v_F1: 0.573989  v_AUC: 0.855018
steps 5600    running time 198 seconds

steps 5800    base_loss: 0.200558    reg_loss: 0.056119    l2_loss: 0.021888    loss: 0.278565
steps 5800    v_Prec: 0.515299  v_Recall: 0.631886  v_F1: 0.567668  v_AUC: 0.852012
steps 5800    running time 204 seconds

steps 6000    base_loss: 0.223581    reg_loss: 0.056437    l2_loss: 0.022226    loss: 0.302244
steps 6000    v_Prec: 0.513379  v_Recall: 0.615759  v_F1: 0.559927  v_AUC: 0.847443
steps 6000    running time 210 seconds

steps 6200    base_loss: 0.232209    reg_loss: 0.056344    l2_loss: 0.022544    loss: 0.311097
steps 6200    v_Prec: 0.522574  v_Recall: 0.606179  v_F1: 0.561280  v_AUC: 0.849179
steps 6200    running time 216 seconds

steps 6400    base_loss: 0.226099    reg_loss: 0.056331    l2_loss: 0.022848    loss: 0.305278
steps 6400    v_Prec: 0.491983  v_Recall: 0.641785  v_F1: 0.556987  v_AUC: 0.848169
steps 6400    running time 221 seconds

steps 6600    base_loss: 0.236535    reg_loss: 0.055961    l2_loss: 0.023251    loss: 0.315747
steps 6600    v_Prec: 0.513056  v_Recall: 0.619591  v_F1: 0.561313  v_AUC: 0.850160
steps 6600    running time 227 seconds

steps 6800    base_loss: 0.233302    reg_loss: 0.055631    l2_loss: 0.023620    loss: 0.312554
steps 6800    v_Prec: 0.506252  v_Recall: 0.630289  v_F1: 0.561502  v_AUC: 0.850092
steps 6800    running time 233 seconds

steps 7000    base_loss: 0.229921    reg_loss: 0.055389    l2_loss: 0.023934    loss: 0.309245
steps 7000    v_Prec: 0.489607  v_Recall: 0.644978  v_F1: 0.556654  v_AUC: 0.849746
steps 7000    running time 238 seconds

steps 7200    base_loss: 0.236292    reg_loss: 0.055524    l2_loss: 0.024239    loss: 0.316054
steps 7200    v_Prec: 0.492232  v_Recall: 0.650088  v_F1: 0.560253  v_AUC: 0.850371
steps 7200    running time 244 seconds

steps 7400    base_loss: 0.227932    reg_loss: 0.054791    l2_loss: 0.024443    loss: 0.307166
steps 7400    v_Prec: 0.500562  v_Recall: 0.640508  v_F1: 0.561953  v_AUC: 0.851455
steps 7400    running time 250 seconds

Early stop model F1: 0.582914
testing thre: 0.29372087
testing Prec: 0.40067147068457254
testing Recall: 0.7134386391251519
testing F1: 0.5131530649700231
testing AUC: 0.8305834919360766
overall running time 253 seconds
(0.510641157757964, 0.5539246658566221, 0.5314029934256539, 0.8305834919360766, 0.55160975)

2019-02-24 00:10:35.063756: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:10:36.144174: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:10:36.146299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:10:36.146428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.960000 seconds
loading data in 31.220000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.537931    reg_loss: 0.065087    l2_loss: 0.013401    loss: 0.616419
steps 200    v_Prec: 0.164901  v_Recall: 1.000000  v_F1: 0.283115  v_AUC: 0.495585
steps 200    running time 41 seconds

steps 400    base_loss: 0.504750    reg_loss: 0.065113    l2_loss: 0.013307    loss: 0.583170
steps 400    v_Prec: 0.164905  v_Recall: 1.000000  v_F1: 0.283122  v_AUC: 0.504583
steps 400    running time 47 seconds

steps 600    base_loss: 0.482248    reg_loss: 0.064906    l2_loss: 0.013131    loss: 0.560285
steps 600    v_Prec: 0.167671  v_Recall: 0.935897  v_F1: 0.284392  v_AUC: 0.532278
steps 600    running time 52 seconds

steps 800    base_loss: 0.470939    reg_loss: 0.064811    l2_loss: 0.012983    loss: 0.548733
steps 800    v_Prec: 0.181815  v_Recall: 0.718265  v_F1: 0.290177  v_AUC: 0.565203
steps 800    running time 58 seconds

steps 1000    base_loss: 0.449053    reg_loss: 0.064263    l2_loss: 0.012867    loss: 0.526183
steps 1000    v_Prec: 0.197956  v_Recall: 0.660652  v_F1: 0.304633  v_AUC: 0.600717
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.435001    reg_loss: 0.063758    l2_loss: 0.012790    loss: 0.511549
steps 1200    v_Prec: 0.283122  v_Recall: 0.456948  v_F1: 0.349622  v_AUC: 0.656897
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.424978    reg_loss: 0.063610    l2_loss: 0.012748    loss: 0.501337
steps 1400    v_Prec: 0.376675  v_Recall: 0.431466  v_F1: 0.402213  v_AUC: 0.705812
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.399647    reg_loss: 0.062993    l2_loss: 0.012683    loss: 0.475323
steps 1600    v_Prec: 0.426736  v_Recall: 0.483539  v_F1: 0.453365  v_AUC: 0.743000
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.377943    reg_loss: 0.062298    l2_loss: 0.012594    loss: 0.452836
steps 1800    v_Prec: 0.498618  v_Recall: 0.485359  v_F1: 0.491899  v_AUC: 0.770153
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.363519    reg_loss: 0.061753    l2_loss: 0.012552    loss: 0.437824
steps 2000    v_Prec: 0.528646  v_Recall: 0.530152  v_F1: 0.529398  v_AUC: 0.792082
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.350060    reg_loss: 0.061338    l2_loss: 0.012558    loss: 0.423956
steps 2200    v_Prec: 0.563121  v_Recall: 0.534109  v_F1: 0.548231  v_AUC: 0.809841
steps 2200    running time 100 seconds

steps 2400    base_loss: 0.344380    reg_loss: 0.060674    l2_loss: 0.012546    loss: 0.417600
steps 2400    v_Prec: 0.606708  v_Recall: 0.536800  v_F1: 0.569617  v_AUC: 0.825175
steps 2400    running time 106 seconds

steps 2600    base_loss: 0.327238    reg_loss: 0.059961    l2_loss: 0.012704    loss: 0.399903
steps 2600    v_Prec: 0.645088  v_Recall: 0.537828  v_F1: 0.586595  v_AUC: 0.836475
steps 2600    running time 112 seconds

steps 2800    base_loss: 0.329709    reg_loss: 0.059722    l2_loss: 0.012875    loss: 0.402306
steps 2800    v_Prec: 0.645666  v_Recall: 0.571779  v_F1: 0.606480  v_AUC: 0.846465
steps 2800    running time 118 seconds

steps 3000    base_loss: 0.315452    reg_loss: 0.058977    l2_loss: 0.013073    loss: 0.387502
steps 3000    v_Prec: 0.649947  v_Recall: 0.586578  v_F1: 0.616639  v_AUC: 0.852956
steps 3000    running time 124 seconds

steps 3200    base_loss: 0.311149    reg_loss: 0.058766    l2_loss: 0.013277    loss: 0.383193
steps 3200    v_Prec: 0.640244  v_Recall: 0.606600  v_F1: 0.622968  v_AUC: 0.858237
steps 3200    running time 130 seconds

steps 3400    base_loss: 0.302144    reg_loss: 0.058402    l2_loss: 0.013498    loss: 0.374043
steps 3400    v_Prec: 0.655648  v_Recall: 0.605888  v_F1: 0.629787  v_AUC: 0.864484
steps 3400    running time 136 seconds

steps 3600    base_loss: 0.302575    reg_loss: 0.057889    l2_loss: 0.013753    loss: 0.374217
steps 3600    v_Prec: 0.671291  v_Recall: 0.601219  v_F1: 0.634326  v_AUC: 0.868903
steps 3600    running time 142 seconds

steps 3800    base_loss: 0.294803    reg_loss: 0.057584    l2_loss: 0.014123    loss: 0.366510
steps 3800    v_Prec: 0.675417  v_Recall: 0.619025  v_F1: 0.645992  v_AUC: 0.871920
steps 3800    running time 149 seconds

steps 4000    base_loss: 0.290970    reg_loss: 0.057191    l2_loss: 0.014363    loss: 0.362525
steps 4000    v_Prec: 0.693819  v_Recall: 0.614752  v_F1: 0.651897  v_AUC: 0.875581
steps 4000    running time 155 seconds

steps 4200    base_loss: 0.289662    reg_loss: 0.056875    l2_loss: 0.014693    loss: 0.361231
steps 4200    v_Prec: 0.692648  v_Recall: 0.619579  v_F1: 0.654079  v_AUC: 0.876771
steps 4200    running time 161 seconds

steps 4400    base_loss: 0.282995    reg_loss: 0.056725    l2_loss: 0.015011    loss: 0.354732
steps 4400    v_Prec: 0.689893  v_Recall: 0.626068  v_F1: 0.656433  v_AUC: 0.879530
steps 4400    running time 168 seconds

steps 4600    base_loss: 0.290592    reg_loss: 0.056631    l2_loss: 0.015331    loss: 0.362554
steps 4600    v_Prec: 0.669474  v_Recall: 0.654163  v_F1: 0.661730  v_AUC: 0.883607
steps 4600    running time 173 seconds

steps 4800    base_loss: 0.283531    reg_loss: 0.055999    l2_loss: 0.015700    loss: 0.355230
steps 4800    v_Prec: 0.690847  v_Recall: 0.636119  v_F1: 0.662354  v_AUC: 0.885176
steps 4800    running time 179 seconds

steps 5000    base_loss: 0.282595    reg_loss: 0.055545    l2_loss: 0.016045    loss: 0.354185
steps 5000    v_Prec: 0.695619  v_Recall: 0.644587  v_F1: 0.669131  v_AUC: 0.885900
steps 5000    running time 185 seconds

steps 5200    base_loss: 0.270610    reg_loss: 0.055254    l2_loss: 0.016313    loss: 0.342178
steps 5200    v_Prec: 0.704733  v_Recall: 0.648069  v_F1: 0.675214  v_AUC: 0.889454
steps 5200    running time 191 seconds

steps 5400    base_loss: 0.274955    reg_loss: 0.054872    l2_loss: 0.016767    loss: 0.346593
steps 5400    v_Prec: 0.702851  v_Recall: 0.647673  v_F1: 0.674135  v_AUC: 0.889704
steps 5400    running time 197 seconds

steps 5600    base_loss: 0.200295    reg_loss: 0.050242    l2_loss: 0.017428    loss: 0.267965
steps 5600    v_Prec: 0.685338  v_Recall: 0.663264  v_F1: 0.674120  v_AUC: 0.888612
steps 5600    running time 202 seconds

steps 5800    base_loss: 0.196316    reg_loss: 0.049368    l2_loss: 0.017884    loss: 0.263569
steps 5800    v_Prec: 0.689897  v_Recall: 0.653371  v_F1: 0.671138  v_AUC: 0.886547
steps 5800    running time 208 seconds

steps 6000    base_loss: 0.213456    reg_loss: 0.050154    l2_loss: 0.018261    loss: 0.281872
steps 6000    v_Prec: 0.700137  v_Recall: 0.648386  v_F1: 0.673268  v_AUC: 0.886939
steps 6000    running time 214 seconds

steps 6200    base_loss: 0.216728    reg_loss: 0.049881    l2_loss: 0.018695    loss: 0.285303
steps 6200    v_Prec: 0.693588  v_Recall: 0.662631  v_F1: 0.677756  v_AUC: 0.886871
steps 6200    running time 219 seconds

steps 6400    base_loss: 0.212411    reg_loss: 0.049501    l2_loss: 0.019085    loss: 0.280997
steps 6400    v_Prec: 0.698814  v_Recall: 0.662314  v_F1: 0.680075  v_AUC: 0.888719
steps 6400    running time 226 seconds

steps 6600    base_loss: 0.212219    reg_loss: 0.049369    l2_loss: 0.019434    loss: 0.281021
steps 6600    v_Prec: 0.719782  v_Recall: 0.647040  v_F1: 0.681475  v_AUC: 0.890365
steps 6600    running time 232 seconds

steps 6800    base_loss: 0.209711    reg_loss: 0.048851    l2_loss: 0.019744    loss: 0.278305
steps 6800    v_Prec: 0.722635  v_Recall: 0.645774  v_F1: 0.682046  v_AUC: 0.891195
steps 6800    running time 238 seconds

steps 7000    base_loss: 0.222631    reg_loss: 0.049262    l2_loss: 0.019977    loss: 0.291870
steps 7000    v_Prec: 0.735413  v_Recall: 0.645378  v_F1: 0.687460  v_AUC: 0.894125
steps 7000    running time 244 seconds

steps 7200    base_loss: 0.220024    reg_loss: 0.049064    l2_loss: 0.020254    loss: 0.289342
steps 7200    v_Prec: 0.720993  v_Recall: 0.655033  v_F1: 0.686432  v_AUC: 0.896074
steps 7200    running time 250 seconds

steps 7400    base_loss: 0.217368    reg_loss: 0.048862    l2_loss: 0.020288    loss: 0.286518
steps 7400    v_Prec: 0.723531  v_Recall: 0.653846  v_F1: 0.686926  v_AUC: 0.897216
steps 7400    running time 256 seconds

steps 7600    base_loss: 0.219234    reg_loss: 0.048685    l2_loss: 0.020537    loss: 0.288456
steps 7600    v_Prec: 0.707817  v_Recall: 0.672919  v_F1: 0.689927  v_AUC: 0.897318
steps 7600    running time 262 seconds

steps 7800    base_loss: 0.214406    reg_loss: 0.048174    l2_loss: 0.020636    loss: 0.283217
steps 7800    v_Prec: 0.715615  v_Recall: 0.675689  v_F1: 0.695079  v_AUC: 0.899098
steps 7800    running time 268 seconds

steps 8000    base_loss: 0.215443    reg_loss: 0.048014    l2_loss: 0.020741    loss: 0.284198
steps 8000    v_Prec: 0.712097  v_Recall: 0.673156  v_F1: 0.692079  v_AUC: 0.900496
steps 8000    running time 275 seconds

steps 8200    base_loss: 0.212453    reg_loss: 0.047897    l2_loss: 0.020861    loss: 0.281211
steps 8200    v_Prec: 0.702072  v_Recall: 0.683682  v_F1: 0.692755  v_AUC: 0.901795
steps 8200    running time 280 seconds

steps 8400    base_loss: 0.221314    reg_loss: 0.047889    l2_loss: 0.020975    loss: 0.290178
steps 8400    v_Prec: 0.728386  v_Recall: 0.673393  v_F1: 0.699811  v_AUC: 0.903301
steps 8400    running time 286 seconds

steps 8600    base_loss: 0.218680    reg_loss: 0.047835    l2_loss: 0.021230    loss: 0.287745
steps 8600    v_Prec: 0.734678  v_Recall: 0.671652  v_F1: 0.701753  v_AUC: 0.905051
steps 8600    running time 292 seconds

steps 8800    base_loss: 0.218154    reg_loss: 0.047584    l2_loss: 0.021298    loss: 0.287036
steps 8800    v_Prec: 0.722185  v_Recall: 0.687322  v_F1: 0.704322  v_AUC: 0.906134
steps 8800    running time 298 seconds

steps 9000    base_loss: 0.218355    reg_loss: 0.047329    l2_loss: 0.021335    loss: 0.287020
steps 9000    v_Prec: 0.747539  v_Recall: 0.672998  v_F1: 0.708313  v_AUC: 0.907024
steps 9000    running time 304 seconds

steps 9200    base_loss: 0.220126    reg_loss: 0.047361    l2_loss: 0.021321    loss: 0.288809
steps 9200    v_Prec: 0.759088  v_Recall: 0.664292  v_F1: 0.708534  v_AUC: 0.907595
steps 9200    running time 310 seconds

steps 9400    base_loss: 0.219269    reg_loss: 0.047466    l2_loss: 0.021443    loss: 0.288178
steps 9400    v_Prec: 0.720917  v_Recall: 0.694444  v_F1: 0.707433  v_AUC: 0.906365
steps 9400    running time 316 seconds

steps 9600    base_loss: 0.218733    reg_loss: 0.046999    l2_loss: 0.021417    loss: 0.287149
steps 9600    v_Prec: 0.737549  v_Recall: 0.682099  v_F1: 0.708741  v_AUC: 0.907405
steps 9600    running time 321 seconds

steps 9800    base_loss: 0.218639    reg_loss: 0.046993    l2_loss: 0.021574    loss: 0.287206
steps 9800    v_Prec: 0.729134  v_Recall: 0.696186  v_F1: 0.712279  v_AUC: 0.909884
steps 9800    running time 327 seconds

steps 10000    base_loss: 0.215122    reg_loss: 0.046977    l2_loss: 0.021660    loss: 0.283759
steps 10000    v_Prec: 0.736140  v_Recall: 0.690408  v_F1: 0.712541  v_AUC: 0.910294
steps 10000    running time 333 seconds

steps 10200    base_loss: 0.218808    reg_loss: 0.046617    l2_loss: 0.021614    loss: 0.287040
steps 10200    v_Prec: 0.722105  v_Recall: 0.705761  v_F1: 0.713840  v_AUC: 0.911937
steps 10200    running time 339 seconds

steps 10400    base_loss: 0.215939    reg_loss: 0.046465    l2_loss: 0.021591    loss: 0.283995
steps 10400    v_Prec: 0.750763  v_Recall: 0.681782  v_F1: 0.714612  v_AUC: 0.913367
steps 10400    running time 345 seconds

steps 10600    base_loss: 0.219729    reg_loss: 0.046293    l2_loss: 0.021624    loss: 0.287646
steps 10600    v_Prec: 0.738039  v_Recall: 0.695869  v_F1: 0.716334  v_AUC: 0.913102
steps 10600    running time 351 seconds

steps 10800    base_loss: 0.210521    reg_loss: 0.045997    l2_loss: 0.021791    loss: 0.278309
steps 10800    v_Prec: 0.719143  v_Recall: 0.714704  v_F1: 0.716917  v_AUC: 0.912392
steps 10800    running time 357 seconds

steps 11000    base_loss: 0.118181    reg_loss: 0.040553    l2_loss: 0.022018    loss: 0.180752
steps 11000    v_Prec: 0.734209  v_Recall: 0.689934  v_F1: 0.711383  v_AUC: 0.909614
steps 11000    running time 363 seconds

steps 11200    base_loss: 0.118840    reg_loss: 0.040788    l2_loss: 0.022139    loss: 0.181767
steps 11200    v_Prec: 0.744549  v_Recall: 0.683682  v_F1: 0.712818  v_AUC: 0.908098
steps 11200    running time 369 seconds

steps 11400    base_loss: 0.124726    reg_loss: 0.040853    l2_loss: 0.022102    loss: 0.187681
steps 11400    v_Prec: 0.722886  v_Recall: 0.699430  v_F1: 0.710965  v_AUC: 0.908182
steps 11400    running time 375 seconds

steps 11600    base_loss: 0.119356    reg_loss: 0.040534    l2_loss: 0.022333    loss: 0.182223
steps 11600    v_Prec: 0.739341  v_Recall: 0.677904  v_F1: 0.707291  v_AUC: 0.906190
steps 11600    running time 381 seconds

steps 11800    base_loss: 0.116321    reg_loss: 0.040776    l2_loss: 0.022293    loss: 0.179389
steps 11800    v_Prec: 0.733954  v_Recall: 0.679645  v_F1: 0.705757  v_AUC: 0.906658
steps 11800    running time 387 seconds

steps 12000    base_loss: 0.123250    reg_loss: 0.040889    l2_loss: 0.022447    loss: 0.186586
steps 12000    v_Prec: 0.717808  v_Recall: 0.693495  v_F1: 0.705442  v_AUC: 0.907181
steps 12000    running time 393 seconds

steps 12200    base_loss: 0.123054    reg_loss: 0.040824    l2_loss: 0.022436    loss: 0.186314
steps 12200    v_Prec: 0.712303  v_Recall: 0.698718  v_F1: 0.705445  v_AUC: 0.907361
steps 12200    running time 398 seconds

steps 12400    base_loss: 0.116776    reg_loss: 0.040535    l2_loss: 0.022456    loss: 0.179767
steps 12400    v_Prec: 0.709952  v_Recall: 0.700063  v_F1: 0.704973  v_AUC: 0.906664
steps 12400    running time 404 seconds

steps 12600    base_loss: 0.123484    reg_loss: 0.040580    l2_loss: 0.022439    loss: 0.186503
steps 12600    v_Prec: 0.706359  v_Recall: 0.703229  v_F1: 0.704791  v_AUC: 0.904733
steps 12600    running time 410 seconds

steps 12800    base_loss: 0.127453    reg_loss: 0.040577    l2_loss: 0.022586    loss: 0.190615
steps 12800    v_Prec: 0.713873  v_Recall: 0.704099  v_F1: 0.708953  v_AUC: 0.909701
steps 12800    running time 416 seconds

Early stop model F1: 0.716917
testing thre: 0.44151264
testing Prec: 0.5382639958911145
testing Recall: 0.7130984204131228
testing F1: 0.6134676896703114
testing AUC: 0.8756326283110769
overall running time 419 seconds
(0.633442719302542, 0.6285783718104496, 0.6310011709601874, 0.8756326283110769, 0.7389036)

2019-02-24 00:14:59.495563: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:14:59.809030: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:14:59.810756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:14:59.810794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.540000 seconds
loading data in 30.780000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.322243    reg_loss: 0.064507    l2_loss: 0.013384    loss: 1.400135
steps 200    v_Prec: 0.164300  v_Recall: 0.991954  v_F1: 0.281908  v_AUC: 0.515534
steps 200    running time 40 seconds

steps 400    base_loss: 0.578216    reg_loss: 0.064200    l2_loss: 0.013469    loss: 0.655885
steps 400    v_Prec: 0.166161  v_Recall: 0.947025  v_F1: 0.282718  v_AUC: 0.529819
steps 400    running time 45 seconds

steps 600    base_loss: 0.491371    reg_loss: 0.064096    l2_loss: 0.013391    loss: 0.568858
steps 600    v_Prec: 0.172682  v_Recall: 0.812236  v_F1: 0.284812  v_AUC: 0.552049
steps 600    running time 51 seconds

steps 800    base_loss: 0.471371    reg_loss: 0.063582    l2_loss: 0.013201    loss: 0.548154
steps 800    v_Prec: 0.188491  v_Recall: 0.672668  v_F1: 0.294467  v_AUC: 0.575939
steps 800    running time 57 seconds

steps 1000    base_loss: 0.461467    reg_loss: 0.063133    l2_loss: 0.013092    loss: 0.537692
steps 1000    v_Prec: 0.189839  v_Recall: 0.674500  v_F1: 0.296287  v_AUC: 0.580982
steps 1000    running time 63 seconds

steps 1200    base_loss: 0.454714    reg_loss: 0.062518    l2_loss: 0.012996    loss: 0.530228
steps 1200    v_Prec: 0.216099  v_Recall: 0.594121  v_F1: 0.316923  v_AUC: 0.623419
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.444224    reg_loss: 0.061730    l2_loss: 0.012895    loss: 0.518848
steps 1400    v_Prec: 0.273726  v_Recall: 0.478372  v_F1: 0.348207  v_AUC: 0.668306
steps 1400    running time 75 seconds

steps 1600    base_loss: 0.428537    reg_loss: 0.061007    l2_loss: 0.012871    loss: 0.502415
steps 1600    v_Prec: 0.370054  v_Recall: 0.438063  v_F1: 0.401197  v_AUC: 0.716532
steps 1600    running time 81 seconds

steps 1800    base_loss: 0.399857    reg_loss: 0.059742    l2_loss: 0.012943    loss: 0.472541
steps 1800    v_Prec: 0.468641  v_Recall: 0.448817  v_F1: 0.458515  v_AUC: 0.757157
steps 1800    running time 87 seconds

steps 2000    base_loss: 0.376381    reg_loss: 0.058946    l2_loss: 0.013129    loss: 0.448456
steps 2000    v_Prec: 0.520266  v_Recall: 0.492870  v_F1: 0.506198  v_AUC: 0.788737
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.357087    reg_loss: 0.058076    l2_loss: 0.013314    loss: 0.428476
steps 2200    v_Prec: 0.579356  v_Recall: 0.493189  v_F1: 0.532811  v_AUC: 0.808478
steps 2200    running time 100 seconds

steps 2400    base_loss: 0.344404    reg_loss: 0.057453    l2_loss: 0.013537    loss: 0.415395
steps 2400    v_Prec: 0.580845  v_Recall: 0.545447  v_F1: 0.562590  v_AUC: 0.824794
steps 2400    running time 105 seconds

steps 2600    base_loss: 0.332346    reg_loss: 0.056785    l2_loss: 0.013700    loss: 0.402830
steps 2600    v_Prec: 0.655266  v_Recall: 0.521947  v_F1: 0.581057  v_AUC: 0.835832
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.321971    reg_loss: 0.056116    l2_loss: 0.013959    loss: 0.392046
steps 2800    v_Prec: 0.646850  v_Recall: 0.565124  v_F1: 0.603231  v_AUC: 0.848039
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.316510    reg_loss: 0.055640    l2_loss: 0.014120    loss: 0.386269
steps 3000    v_Prec: 0.663406  v_Recall: 0.583446  v_F1: 0.620862  v_AUC: 0.857290
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.307815    reg_loss: 0.055287    l2_loss: 0.014313    loss: 0.377415
steps 3200    v_Prec: 0.681885  v_Recall: 0.593723  v_F1: 0.634757  v_AUC: 0.863789
steps 3200    running time 129 seconds

steps 3400    base_loss: 0.304457    reg_loss: 0.054886    l2_loss: 0.014520    loss: 0.373864
steps 3400    v_Prec: 0.677763  v_Recall: 0.608221  v_F1: 0.641112  v_AUC: 0.870526
steps 3400    running time 135 seconds

steps 3600    base_loss: 0.292852    reg_loss: 0.054326    l2_loss: 0.014697    loss: 0.361874
steps 3600    v_Prec: 0.667517  v_Recall: 0.625030  v_F1: 0.645575  v_AUC: 0.873526
steps 3600    running time 141 seconds

steps 3800    base_loss: 0.291538    reg_loss: 0.053953    l2_loss: 0.014977    loss: 0.360468
steps 3800    v_Prec: 0.697030  v_Recall: 0.615072  v_F1: 0.653491  v_AUC: 0.877155
steps 3800    running time 147 seconds

steps 4000    base_loss: 0.285768    reg_loss: 0.053485    l2_loss: 0.015163    loss: 0.354416
steps 4000    v_Prec: 0.704331  v_Recall: 0.619215  v_F1: 0.659036  v_AUC: 0.880586
steps 4000    running time 153 seconds

steps 4200    base_loss: 0.281784    reg_loss: 0.053282    l2_loss: 0.015478    loss: 0.350544
steps 4200    v_Prec: 0.705867  v_Recall: 0.627818  v_F1: 0.664559  v_AUC: 0.883620
steps 4200    running time 158 seconds

steps 4400    base_loss: 0.287088    reg_loss: 0.053142    l2_loss: 0.015771    loss: 0.356001
steps 4400    v_Prec: 0.685673  v_Recall: 0.650442  v_F1: 0.667593  v_AUC: 0.886126
steps 4400    running time 164 seconds

steps 4600    base_loss: 0.275846    reg_loss: 0.052856    l2_loss: 0.015983    loss: 0.344685
steps 4600    v_Prec: 0.687604  v_Recall: 0.655779  v_F1: 0.671315  v_AUC: 0.889996
steps 4600    running time 171 seconds

steps 4800    base_loss: 0.276529    reg_loss: 0.052545    l2_loss: 0.016289    loss: 0.345363
steps 4800    v_Prec: 0.689799  v_Recall: 0.660400  v_F1: 0.674779  v_AUC: 0.891613
steps 4800    running time 176 seconds

steps 5000    base_loss: 0.273610    reg_loss: 0.052450    l2_loss: 0.016670    loss: 0.342730
steps 5000    v_Prec: 0.697259  v_Recall: 0.662710  v_F1: 0.679546  v_AUC: 0.894484
steps 5000    running time 182 seconds

steps 5200    base_loss: 0.268284    reg_loss: 0.051916    l2_loss: 0.017045    loss: 0.337246
steps 5200    v_Prec: 0.700502  v_Recall: 0.667410  v_F1: 0.683556  v_AUC: 0.895802
steps 5200    running time 189 seconds

steps 5400    base_loss: 0.275135    reg_loss: 0.051627    l2_loss: 0.017503    loss: 0.344265
steps 5400    v_Prec: 0.701370  v_Recall: 0.668685  v_F1: 0.684638  v_AUC: 0.896828
steps 5400    running time 195 seconds

steps 5600    base_loss: 0.204593    reg_loss: 0.047969    l2_loss: 0.018059    loss: 0.270621
steps 5600    v_Prec: 0.713557  v_Recall: 0.657851  v_F1: 0.684573  v_AUC: 0.893482
steps 5600    running time 201 seconds

steps 5800    base_loss: 0.208294    reg_loss: 0.048035    l2_loss: 0.018734    loss: 0.275063
steps 5800    v_Prec: 0.727824  v_Recall: 0.650362  v_F1: 0.686916  v_AUC: 0.893282
steps 5800    running time 207 seconds

steps 6000    base_loss: 0.205271    reg_loss: 0.047381    l2_loss: 0.019371    loss: 0.272024
steps 6000    v_Prec: 0.725128  v_Recall: 0.641600  v_F1: 0.680811  v_AUC: 0.892352
steps 6000    running time 213 seconds

steps 6200    base_loss: 0.212627    reg_loss: 0.047122    l2_loss: 0.019702    loss: 0.279452
steps 6200    v_Prec: 0.722005  v_Recall: 0.646140  v_F1: 0.681969  v_AUC: 0.891377
steps 6200    running time 219 seconds

steps 6400    base_loss: 0.205025    reg_loss: 0.046644    l2_loss: 0.020041    loss: 0.271710
steps 6400    v_Prec: 0.704461  v_Recall: 0.664224  v_F1: 0.683751  v_AUC: 0.891552
steps 6400    running time 225 seconds

steps 6600    base_loss: 0.206447    reg_loss: 0.046665    l2_loss: 0.020400    loss: 0.273512
steps 6600    v_Prec: 0.729442  v_Recall: 0.643034  v_F1: 0.683518  v_AUC: 0.891371
steps 6600    running time 231 seconds

steps 6800    base_loss: 0.213540    reg_loss: 0.046499    l2_loss: 0.020831    loss: 0.280870
steps 6800    v_Prec: 0.716242  v_Recall: 0.658329  v_F1: 0.686065  v_AUC: 0.893482
steps 6800    running time 236 seconds

steps 7000    base_loss: 0.211892    reg_loss: 0.045791    l2_loss: 0.021080    loss: 0.278762
steps 7000    v_Prec: 0.729816  v_Recall: 0.652434  v_F1: 0.688959  v_AUC: 0.895356
steps 7000    running time 242 seconds

steps 7200    base_loss: 0.203015    reg_loss: 0.045644    l2_loss: 0.021272    loss: 0.269931
steps 7200    v_Prec: 0.707430  v_Recall: 0.681112  v_F1: 0.694022  v_AUC: 0.896176
steps 7200    running time 248 seconds

steps 7400    base_loss: 0.212627    reg_loss: 0.045939    l2_loss: 0.021539    loss: 0.280105
steps 7400    v_Prec: 0.723838  v_Recall: 0.663985  v_F1: 0.692621  v_AUC: 0.898048
steps 7400    running time 253 seconds

steps 7600    base_loss: 0.214214    reg_loss: 0.045626    l2_loss: 0.021719    loss: 0.281558
steps 7600    v_Prec: 0.725632  v_Recall: 0.656496  v_F1: 0.689335  v_AUC: 0.899692
steps 7600    running time 259 seconds

steps 7800    base_loss: 0.215921    reg_loss: 0.045166    l2_loss: 0.021799    loss: 0.282886
steps 7800    v_Prec: 0.715495  v_Recall: 0.673544  v_F1: 0.693886  v_AUC: 0.900492
steps 7800    running time 265 seconds

steps 8000    base_loss: 0.216678    reg_loss: 0.045441    l2_loss: 0.021882    loss: 0.284002
steps 8000    v_Prec: 0.722575  v_Recall: 0.670597  v_F1: 0.695616  v_AUC: 0.901221
steps 8000    running time 271 seconds

steps 8200    base_loss: 0.217112    reg_loss: 0.045157    l2_loss: 0.022044    loss: 0.284313
steps 8200    v_Prec: 0.719572  v_Recall: 0.680076  v_F1: 0.699267  v_AUC: 0.903483
steps 8200    running time 277 seconds

steps 8400    base_loss: 0.213344    reg_loss: 0.044792    l2_loss: 0.022112    loss: 0.280248
steps 8400    v_Prec: 0.726951  v_Recall: 0.686529  v_F1: 0.706162  v_AUC: 0.903483
steps 8400    running time 282 seconds

steps 8600    base_loss: 0.209545    reg_loss: 0.044874    l2_loss: 0.022181    loss: 0.276599
steps 8600    v_Prec: 0.749154  v_Recall: 0.670198  v_F1: 0.707480  v_AUC: 0.905036
steps 8600    running time 288 seconds

steps 8800    base_loss: 0.205918    reg_loss: 0.044567    l2_loss: 0.022276    loss: 0.272760
steps 8800    v_Prec: 0.733006  v_Recall: 0.689795  v_F1: 0.710744  v_AUC: 0.906813
steps 8800    running time 294 seconds

steps 9000    base_loss: 0.213927    reg_loss: 0.044270    l2_loss: 0.022254    loss: 0.280450
steps 9000    v_Prec: 0.733464  v_Recall: 0.683741  v_F1: 0.707730  v_AUC: 0.907713
steps 9000    running time 299 seconds

steps 9200    base_loss: 0.211623    reg_loss: 0.044110    l2_loss: 0.022308    loss: 0.278041
steps 9200    v_Prec: 0.745421  v_Recall: 0.677607  v_F1: 0.709898  v_AUC: 0.907823
steps 9200    running time 305 seconds

steps 9400    base_loss: 0.210666    reg_loss: 0.043826    l2_loss: 0.022445    loss: 0.276937
steps 9400    v_Prec: 0.732925  v_Recall: 0.695850  v_F1: 0.713906  v_AUC: 0.910043
steps 9400    running time 310 seconds

steps 9600    base_loss: 0.215892    reg_loss: 0.043738    l2_loss: 0.022516    loss: 0.282147
steps 9600    v_Prec: 0.736090  v_Recall: 0.693460  v_F1: 0.714139  v_AUC: 0.911427
steps 9600    running time 317 seconds

steps 9800    base_loss: 0.216320    reg_loss: 0.043913    l2_loss: 0.022421    loss: 0.282654
steps 9800    v_Prec: 0.731440  v_Recall: 0.695372  v_F1: 0.712950  v_AUC: 0.912235
steps 9800    running time 322 seconds

steps 10000    base_loss: 0.213155    reg_loss: 0.043579    l2_loss: 0.022505    loss: 0.279239
steps 10000    v_Prec: 0.732891  v_Recall: 0.695292  v_F1: 0.713597  v_AUC: 0.911082
steps 10000    running time 328 seconds

steps 10200    base_loss: 0.220526    reg_loss: 0.044036    l2_loss: 0.022600    loss: 0.287162
steps 10200    v_Prec: 0.734503  v_Recall: 0.693778  v_F1: 0.713560  v_AUC: 0.911307
steps 10200    running time 333 seconds

steps 10400    base_loss: 0.212328    reg_loss: 0.043537    l2_loss: 0.022541    loss: 0.278406
steps 10400    v_Prec: 0.754638  v_Recall: 0.687007  v_F1: 0.719236  v_AUC: 0.912090
steps 10400    running time 339 seconds

steps 10600    base_loss: 0.211168    reg_loss: 0.043613    l2_loss: 0.022651    loss: 0.277431
steps 10600    v_Prec: 0.737894  v_Recall: 0.708914  v_F1: 0.723114  v_AUC: 0.913771
steps 10600    running time 345 seconds

steps 10800    base_loss: 0.200527    reg_loss: 0.042655    l2_loss: 0.022803    loss: 0.265984
steps 10800    v_Prec: 0.752852  v_Recall: 0.694017  v_F1: 0.722238  v_AUC: 0.915142
steps 10800    running time 351 seconds

steps 11000    base_loss: 0.110886    reg_loss: 0.038186    l2_loss: 0.022944    loss: 0.172017
steps 11000    v_Prec: 0.737834  v_Recall: 0.695690  v_F1: 0.716143  v_AUC: 0.910110
steps 11000    running time 356 seconds

steps 11200    base_loss: 0.114680    reg_loss: 0.038317    l2_loss: 0.023239    loss: 0.176237
steps 11200    v_Prec: 0.732615  v_Recall: 0.698239  v_F1: 0.715014  v_AUC: 0.911003
steps 11200    running time 361 seconds

steps 11400    base_loss: 0.114489    reg_loss: 0.038522    l2_loss: 0.023190    loss: 0.176200
steps 11400    v_Prec: 0.745249  v_Recall: 0.684219  v_F1: 0.713431  v_AUC: 0.907913
steps 11400    running time 367 seconds

steps 11600    base_loss: 0.107568    reg_loss: 0.038311    l2_loss: 0.023243    loss: 0.169122
steps 11600    v_Prec: 0.725062  v_Recall: 0.700629  v_F1: 0.712636  v_AUC: 0.906801
steps 11600    running time 373 seconds

steps 11800    base_loss: 0.126525    reg_loss: 0.038877    l2_loss: 0.023290    loss: 0.188692
steps 11800    v_Prec: 0.751143  v_Recall: 0.680475  v_F1: 0.714065  v_AUC: 0.908673
steps 11800    running time 378 seconds

steps 12000    base_loss: 0.120582    reg_loss: 0.038552    l2_loss: 0.023467    loss: 0.182600
steps 12000    v_Prec: 0.733859  v_Recall: 0.697204  v_F1: 0.715062  v_AUC: 0.906790
steps 12000    running time 384 seconds

steps 12200    base_loss: 0.120468    reg_loss: 0.038409    l2_loss: 0.023334    loss: 0.182212
steps 12200    v_Prec: 0.746010  v_Recall: 0.688839  v_F1: 0.716286  v_AUC: 0.907283
steps 12200    running time 390 seconds

steps 12400    base_loss: 0.119084    reg_loss: 0.038379    l2_loss: 0.023486    loss: 0.180949
steps 12400    v_Prec: 0.733328  v_Recall: 0.692902  v_F1: 0.712542  v_AUC: 0.906326
steps 12400    running time 395 seconds

steps 12600    base_loss: 0.123971    reg_loss: 0.038636    l2_loss: 0.023546    loss: 0.186153
steps 12600    v_Prec: 0.716349  v_Recall: 0.703338  v_F1: 0.709784  v_AUC: 0.906528
steps 12600    running time 401 seconds

Early stop model F1: 0.723114
testing thre: 0.35140994
testing Prec: 0.5459120414265918
testing Recall: 0.7275820170109356
testing F1: 0.6237889868116757
testing AUC: 0.88463263630761
overall running time 403 seconds
(0.6682403653717863, 0.6329040097205346, 0.6500923568468873, 0.88463263630761, 0.6073898)

2019-02-24 00:19:20.598889: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:19:21.997796: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:19:22.025496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:19:22.025609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.440000 seconds
loading data in 30.790000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.631751    reg_loss: 0.064744    l2_loss: 0.013385    loss: 0.709880
steps 200    v_Prec: 0.164498  v_Recall: 1.000000  v_F1: 0.282522  v_AUC: 0.500493
steps 200    running time 40 seconds

steps 400    base_loss: 0.492782    reg_loss: 0.064494    l2_loss: 0.013376    loss: 0.570652
steps 400    v_Prec: 0.164568  v_Recall: 0.999524  v_F1: 0.282607  v_AUC: 0.509740
steps 400    running time 46 seconds

steps 600    base_loss: 0.486943    reg_loss: 0.064376    l2_loss: 0.013289    loss: 0.564609
steps 600    v_Prec: 0.164754  v_Recall: 0.994368  v_F1: 0.282673  v_AUC: 0.512703
steps 600    running time 52 seconds

steps 800    base_loss: 0.463219    reg_loss: 0.063855    l2_loss: 0.013201    loss: 0.540275
steps 800    v_Prec: 0.164528  v_Recall: 0.998890  v_F1: 0.282522  v_AUC: 0.515689
steps 800    running time 59 seconds

steps 1000    base_loss: 0.470064    reg_loss: 0.063829    l2_loss: 0.013041    loss: 0.546933
steps 1000    v_Prec: 0.164492  v_Recall: 1.000000  v_F1: 0.282513  v_AUC: 0.525029
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.451271    reg_loss: 0.062884    l2_loss: 0.012937    loss: 0.527092
steps 1200    v_Prec: 0.167737  v_Recall: 0.932181  v_F1: 0.284315  v_AUC: 0.547632
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.446452    reg_loss: 0.062301    l2_loss: 0.012837    loss: 0.521590
steps 1400    v_Prec: 0.227510  v_Recall: 0.452764  v_F1: 0.302844  v_AUC: 0.599281
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.439052    reg_loss: 0.061482    l2_loss: 0.012850    loss: 0.513384
steps 1600    v_Prec: 0.347287  v_Recall: 0.384310  v_F1: 0.364862  v_AUC: 0.667188
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.414491    reg_loss: 0.060560    l2_loss: 0.012912    loss: 0.487963
steps 1800    v_Prec: 0.457731  v_Recall: 0.419608  v_F1: 0.437841  v_AUC: 0.725341
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.382799    reg_loss: 0.059768    l2_loss: 0.013034    loss: 0.455600
steps 2000    v_Prec: 0.550976  v_Recall: 0.465535  v_F1: 0.504665  v_AUC: 0.769454
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.358688    reg_loss: 0.059118    l2_loss: 0.013203    loss: 0.431009
steps 2200    v_Prec: 0.573450  v_Recall: 0.523915  v_F1: 0.547565  v_AUC: 0.800697
steps 2200    running time 99 seconds

steps 2400    base_loss: 0.340766    reg_loss: 0.058589    l2_loss: 0.013287    loss: 0.412641
steps 2400    v_Prec: 0.633021  v_Recall: 0.520346  v_F1: 0.571180  v_AUC: 0.816863
steps 2400    running time 106 seconds

steps 2600    base_loss: 0.330581    reg_loss: 0.058105    l2_loss: 0.013435    loss: 0.402120
steps 2600    v_Prec: 0.647535  v_Recall: 0.552154  v_F1: 0.596053  v_AUC: 0.832723
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.327089    reg_loss: 0.057883    l2_loss: 0.013587    loss: 0.398558
steps 2800    v_Prec: 0.681489  v_Recall: 0.551916  v_F1: 0.609896  v_AUC: 0.844803
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.319660    reg_loss: 0.057385    l2_loss: 0.013724    loss: 0.390769
steps 3000    v_Prec: 0.684800  v_Recall: 0.577140  v_F1: 0.626377  v_AUC: 0.855282
steps 3000    running time 123 seconds

steps 3200    base_loss: 0.315197    reg_loss: 0.057154    l2_loss: 0.013935    loss: 0.386286
steps 3200    v_Prec: 0.693311  v_Recall: 0.586182  v_F1: 0.635262  v_AUC: 0.861796
steps 3200    running time 129 seconds

steps 3400    base_loss: 0.302387    reg_loss: 0.056440    l2_loss: 0.014055    loss: 0.372883
steps 3400    v_Prec: 0.669565  v_Recall: 0.610772  v_F1: 0.638819  v_AUC: 0.867440
steps 3400    running time 135 seconds

steps 3600    base_loss: 0.297458    reg_loss: 0.056005    l2_loss: 0.014220    loss: 0.367682
steps 3600    v_Prec: 0.697599  v_Recall: 0.610613  v_F1: 0.651214  v_AUC: 0.873264
steps 3600    running time 141 seconds

steps 3800    base_loss: 0.293673    reg_loss: 0.055789    l2_loss: 0.014493    loss: 0.363954
steps 3800    v_Prec: 0.698236  v_Recall: 0.615214  v_F1: 0.654101  v_AUC: 0.874501
steps 3800    running time 147 seconds

steps 4000    base_loss: 0.292733    reg_loss: 0.055462    l2_loss: 0.014701    loss: 0.362896
steps 4000    v_Prec: 0.690003  v_Recall: 0.634013  v_F1: 0.660824  v_AUC: 0.878217
steps 4000    running time 153 seconds

steps 4200    base_loss: 0.289980    reg_loss: 0.055122    l2_loss: 0.015027    loss: 0.360130
steps 4200    v_Prec: 0.719759  v_Recall: 0.616880  v_F1: 0.664360  v_AUC: 0.881627
steps 4200    running time 159 seconds

steps 4400    base_loss: 0.287567    reg_loss: 0.054724    l2_loss: 0.015380    loss: 0.357671
steps 4400    v_Prec: 0.700847  v_Recall: 0.636472  v_F1: 0.667110  v_AUC: 0.884737
steps 4400    running time 165 seconds

steps 4600    base_loss: 0.286915    reg_loss: 0.054571    l2_loss: 0.015664    loss: 0.357150
steps 4600    v_Prec: 0.699677  v_Recall: 0.653446  v_F1: 0.675772  v_AUC: 0.885320
steps 4600    running time 171 seconds

steps 4800    base_loss: 0.287105    reg_loss: 0.054254    l2_loss: 0.015986    loss: 0.357344
steps 4800    v_Prec: 0.685345  v_Recall: 0.668438  v_F1: 0.676786  v_AUC: 0.887886
steps 4800    running time 177 seconds

steps 5000    base_loss: 0.277443    reg_loss: 0.053899    l2_loss: 0.016323    loss: 0.347665
steps 5000    v_Prec: 0.715495  v_Recall: 0.650512  v_F1: 0.681457  v_AUC: 0.890857
steps 5000    running time 183 seconds

steps 5200    base_loss: 0.284276    reg_loss: 0.053531    l2_loss: 0.016821    loss: 0.354628
steps 5200    v_Prec: 0.721219  v_Recall: 0.649480  v_F1: 0.683472  v_AUC: 0.891826
steps 5200    running time 189 seconds

steps 5400    base_loss: 0.276357    reg_loss: 0.053193    l2_loss: 0.017265    loss: 0.346815
steps 5400    v_Prec: 0.697365  v_Recall: 0.673911  v_F1: 0.685438  v_AUC: 0.893446
steps 5400    running time 195 seconds

steps 5600    base_loss: 0.207560    reg_loss: 0.048619    l2_loss: 0.017741    loss: 0.273920
steps 5600    v_Prec: 0.702871  v_Recall: 0.669866  v_F1: 0.685972  v_AUC: 0.890953
steps 5600    running time 200 seconds

steps 5800    base_loss: 0.206697    reg_loss: 0.048043    l2_loss: 0.018416    loss: 0.273156
steps 5800    v_Prec: 0.710515  v_Recall: 0.657651  v_F1: 0.683061  v_AUC: 0.888738
steps 5800    running time 206 seconds

steps 6000    base_loss: 0.207750    reg_loss: 0.047809    l2_loss: 0.018876    loss: 0.274435
steps 6000    v_Prec: 0.692802  v_Recall: 0.675656  v_F1: 0.684122  v_AUC: 0.890502
steps 6000    running time 212 seconds

steps 6200    base_loss: 0.217848    reg_loss: 0.048409    l2_loss: 0.019202    loss: 0.285459
steps 6200    v_Prec: 0.702288  v_Recall: 0.667248  v_F1: 0.684320  v_AUC: 0.891057
steps 6200    running time 217 seconds

steps 6400    base_loss: 0.216596    reg_loss: 0.047950    l2_loss: 0.019544    loss: 0.284091
steps 6400    v_Prec: 0.703479  v_Recall: 0.672008  v_F1: 0.687383  v_AUC: 0.891544
steps 6400    running time 223 seconds

steps 6600    base_loss: 0.219260    reg_loss: 0.047940    l2_loss: 0.019906    loss: 0.287107
steps 6600    v_Prec: 0.715081  v_Recall: 0.661934  v_F1: 0.687482  v_AUC: 0.891089
steps 6600    running time 229 seconds

steps 6800    base_loss: 0.215045    reg_loss: 0.047548    l2_loss: 0.020291    loss: 0.282885
steps 6800    v_Prec: 0.692858  v_Recall: 0.684064  v_F1: 0.688433  v_AUC: 0.890862
steps 6800    running time 235 seconds

steps 7000    base_loss: 0.211699    reg_loss: 0.047270    l2_loss: 0.020545    loss: 0.279514
steps 7000    v_Prec: 0.723989  v_Recall: 0.664551  v_F1: 0.692998  v_AUC: 0.891607
steps 7000    running time 241 seconds

steps 7200    base_loss: 0.226669    reg_loss: 0.047375    l2_loss: 0.020740    loss: 0.294784
steps 7200    v_Prec: 0.704795  v_Recall: 0.677401  v_F1: 0.690827  v_AUC: 0.894236
steps 7200    running time 247 seconds

steps 7400    base_loss: 0.218568    reg_loss: 0.047171    l2_loss: 0.020870    loss: 0.286610
steps 7400    v_Prec: 0.736416  v_Recall: 0.664393  v_F1: 0.698553  v_AUC: 0.897165
steps 7400    running time 253 seconds

steps 7600    base_loss: 0.219076    reg_loss: 0.046762    l2_loss: 0.020978    loss: 0.286816
steps 7600    v_Prec: 0.723312  v_Recall: 0.678274  v_F1: 0.700070  v_AUC: 0.897736
steps 7600    running time 259 seconds

steps 7800    base_loss: 0.216920    reg_loss: 0.046502    l2_loss: 0.021215    loss: 0.284636
steps 7800    v_Prec: 0.729635  v_Recall: 0.677084  v_F1: 0.702378  v_AUC: 0.899222
steps 7800    running time 264 seconds

steps 8000    base_loss: 0.217321    reg_loss: 0.046164    l2_loss: 0.021321    loss: 0.284806
steps 8000    v_Prec: 0.729037  v_Recall: 0.676529  v_F1: 0.701802  v_AUC: 0.901747
steps 8000    running time 270 seconds

steps 8200    base_loss: 0.217849    reg_loss: 0.046011    l2_loss: 0.021460    loss: 0.285320
steps 8200    v_Prec: 0.719533  v_Recall: 0.689855  v_F1: 0.704382  v_AUC: 0.903356
steps 8200    running time 276 seconds

steps 8400    base_loss: 0.215045    reg_loss: 0.045920    l2_loss: 0.021473    loss: 0.282439
steps 8400    v_Prec: 0.752754  v_Recall: 0.661220  v_F1: 0.704024  v_AUC: 0.903107
steps 8400    running time 281 seconds

steps 8600    base_loss: 0.221489    reg_loss: 0.045996    l2_loss: 0.021776    loss: 0.289260
steps 8600    v_Prec: 0.722991  v_Recall: 0.696438  v_F1: 0.709466  v_AUC: 0.906470
steps 8600    running time 287 seconds

steps 8800    base_loss: 0.219271    reg_loss: 0.045549    l2_loss: 0.021771    loss: 0.286591
steps 8800    v_Prec: 0.743954  v_Recall: 0.680812  v_F1: 0.710984  v_AUC: 0.906593
steps 8800    running time 292 seconds

steps 9000    base_loss: 0.217396    reg_loss: 0.045500    l2_loss: 0.021741    loss: 0.284637
steps 9000    v_Prec: 0.739466  v_Recall: 0.684858  v_F1: 0.711115  v_AUC: 0.906768
steps 9000    running time 298 seconds

steps 9200    base_loss: 0.222471    reg_loss: 0.045763    l2_loss: 0.021960    loss: 0.290194
steps 9200    v_Prec: 0.737910  v_Recall: 0.692314  v_F1: 0.714385  v_AUC: 0.908290
steps 9200    running time 303 seconds

steps 9400    base_loss: 0.219095    reg_loss: 0.045130    l2_loss: 0.021971    loss: 0.286196
steps 9400    v_Prec: 0.748912  v_Recall: 0.682557  v_F1: 0.714197  v_AUC: 0.911054
steps 9400    running time 309 seconds

steps 9600    base_loss: 0.215414    reg_loss: 0.044879    l2_loss: 0.021933    loss: 0.282225
steps 9600    v_Prec: 0.733852  v_Recall: 0.702943  v_F1: 0.718065  v_AUC: 0.912054
steps 9600    running time 315 seconds

steps 9800    base_loss: 0.215883    reg_loss: 0.045255    l2_loss: 0.021960    loss: 0.283098
steps 9800    v_Prec: 0.732124  v_Recall: 0.707385  v_F1: 0.719542  v_AUC: 0.912354
steps 9800    running time 321 seconds

steps 10000    base_loss: 0.218848    reg_loss: 0.045090    l2_loss: 0.021981    loss: 0.285919
steps 10000    v_Prec: 0.733611  v_Recall: 0.711906  v_F1: 0.722596  v_AUC: 0.914019
steps 10000    running time 327 seconds

steps 10200    base_loss: 0.213168    reg_loss: 0.045169    l2_loss: 0.021993    loss: 0.280331
steps 10200    v_Prec: 0.735171  v_Recall: 0.708813  v_F1: 0.721751  v_AUC: 0.914474
steps 10200    running time 333 seconds

steps 10400    base_loss: 0.219023    reg_loss: 0.044810    l2_loss: 0.022089    loss: 0.285923
steps 10400    v_Prec: 0.751832  v_Recall: 0.699770  v_F1: 0.724868  v_AUC: 0.914609
steps 10400    running time 339 seconds

steps 10600    base_loss: 0.219351    reg_loss: 0.044968    l2_loss: 0.022018    loss: 0.286337
steps 10600    v_Prec: 0.734542  v_Recall: 0.719918  v_F1: 0.727156  v_AUC: 0.915241
steps 10600    running time 344 seconds

steps 10800    base_loss: 0.200107    reg_loss: 0.043684    l2_loss: 0.022265    loss: 0.266056
steps 10800    v_Prec: 0.748948  v_Recall: 0.705878  v_F1: 0.726775  v_AUC: 0.914634
steps 10800    running time 350 seconds

steps 11000    base_loss: 0.123526    reg_loss: 0.039316    l2_loss: 0.022356    loss: 0.185198
steps 11000    v_Prec: 0.767565  v_Recall: 0.677639  v_F1: 0.719805  v_AUC: 0.911417
steps 11000    running time 356 seconds

steps 11200    base_loss: 0.116464    reg_loss: 0.039231    l2_loss: 0.022372    loss: 0.178067
steps 11200    v_Prec: 0.744135  v_Recall: 0.694376  v_F1: 0.718395  v_AUC: 0.911774
steps 11200    running time 362 seconds

steps 11400    base_loss: 0.125764    reg_loss: 0.039283    l2_loss: 0.022469    loss: 0.187516
steps 11400    v_Prec: 0.729182  v_Recall: 0.705005  v_F1: 0.716890  v_AUC: 0.910897
steps 11400    running time 368 seconds

steps 11600    base_loss: 0.115311    reg_loss: 0.039261    l2_loss: 0.022473    loss: 0.177045
steps 11600    v_Prec: 0.722596  v_Recall: 0.706433  v_F1: 0.714423  v_AUC: 0.908796
steps 11600    running time 373 seconds

steps 11800    base_loss: 0.115554    reg_loss: 0.039298    l2_loss: 0.022561    loss: 0.177413
steps 11800    v_Prec: 0.744240  v_Recall: 0.686682  v_F1: 0.714303  v_AUC: 0.908722
steps 11800    running time 379 seconds

steps 12000    base_loss: 0.118606    reg_loss: 0.039371    l2_loss: 0.022559    loss: 0.180536
steps 12000    v_Prec: 0.744052  v_Recall: 0.687158  v_F1: 0.714474  v_AUC: 0.908258
steps 12000    running time 385 seconds

steps 12200    base_loss: 0.122439    reg_loss: 0.039417    l2_loss: 0.022615    loss: 0.184471
steps 12200    v_Prec: 0.728340  v_Recall: 0.698818  v_F1: 0.713274  v_AUC: 0.908373
steps 12200    running time 391 seconds

steps 12400    base_loss: 0.128239    reg_loss: 0.039256    l2_loss: 0.022679    loss: 0.190175
steps 12400    v_Prec: 0.726713  v_Recall: 0.701753  v_F1: 0.714015  v_AUC: 0.908250
steps 12400    running time 397 seconds

steps 12600    base_loss: 0.124334    reg_loss: 0.039095    l2_loss: 0.022569    loss: 0.185998
steps 12600    v_Prec: 0.736299  v_Recall: 0.685254  v_F1: 0.709860  v_AUC: 0.907910
steps 12600    running time 403 seconds

Early stop model F1: 0.727156
testing thre: 0.42185456
testing Prec: 0.5343677545924737
testing Recall: 0.7281166464155528
testing F1: 0.6163752314338613
testing AUC: 0.87886004464201
overall running time 406 seconds
(0.6417328590224648, 0.640048602673147, 0.6408896242943352, 0.87886004464201, 0.65626967)

2019-02-24 00:23:48.486106: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:23:49.771546: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:23:49.773154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:23:49.773192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 22.800000 seconds
loading data in 29.070000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	16
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.512802    reg_loss: 0.065036    l2_loss: 0.013298    loss: 0.591136
steps 200    v_Prec: 0.164385  v_Recall: 0.993003  v_F1: 0.282074  v_AUC: 0.521563
steps 200    running time 38 seconds

steps 400    base_loss: 0.490296    reg_loss: 0.065033    l2_loss: 0.013194    loss: 0.568522
steps 400    v_Prec: 0.165669  v_Recall: 0.968432  v_F1: 0.282936  v_AUC: 0.525537
steps 400    running time 44 seconds

steps 600    base_loss: 0.459809    reg_loss: 0.064372    l2_loss: 0.013117    loss: 0.537298
steps 600    v_Prec: 0.171093  v_Recall: 0.848362  v_F1: 0.284757  v_AUC: 0.544284
steps 600    running time 50 seconds

steps 800    base_loss: 0.452919    reg_loss: 0.064154    l2_loss: 0.012994    loss: 0.530067
steps 800    v_Prec: 0.181925  v_Recall: 0.747694  v_F1: 0.292646  v_AUC: 0.571617
steps 800    running time 56 seconds

steps 1000    base_loss: 0.449825    reg_loss: 0.063443    l2_loss: 0.012949    loss: 0.526216
steps 1000    v_Prec: 0.205081  v_Recall: 0.611085  v_F1: 0.307099  v_AUC: 0.605659
steps 1000    running time 62 seconds

steps 1200    base_loss: 0.439944    reg_loss: 0.062528    l2_loss: 0.012903    loss: 0.515374
steps 1200    v_Prec: 0.256861  v_Recall: 0.505328  v_F1: 0.340595  v_AUC: 0.654200
steps 1200    running time 68 seconds

steps 1400    base_loss: 0.423738    reg_loss: 0.061639    l2_loss: 0.012883    loss: 0.498260
steps 1400    v_Prec: 0.337874  v_Recall: 0.463502  v_F1: 0.390841  v_AUC: 0.706160
steps 1400    running time 74 seconds

steps 1600    base_loss: 0.402729    reg_loss: 0.060137    l2_loss: 0.012947    loss: 0.475813
steps 1600    v_Prec: 0.428270  v_Recall: 0.451733  v_F1: 0.439689  v_AUC: 0.744830
steps 1600    running time 80 seconds

steps 1800    base_loss: 0.389451    reg_loss: 0.059232    l2_loss: 0.013079    loss: 0.461761
steps 1800    v_Prec: 0.497611  v_Recall: 0.480359  v_F1: 0.488833  v_AUC: 0.779327
steps 1800    running time 86 seconds

steps 2000    base_loss: 0.366945    reg_loss: 0.058269    l2_loss: 0.013237    loss: 0.438452
steps 2000    v_Prec: 0.559197  v_Recall: 0.493877  v_F1: 0.524511  v_AUC: 0.800058
steps 2000    running time 92 seconds

steps 2200    base_loss: 0.354912    reg_loss: 0.057651    l2_loss: 0.013349    loss: 0.425912
steps 2200    v_Prec: 0.570033  v_Recall: 0.529103  v_F1: 0.548806  v_AUC: 0.816797
steps 2200    running time 99 seconds

steps 2400    base_loss: 0.343756    reg_loss: 0.056742    l2_loss: 0.013578    loss: 0.414076
steps 2400    v_Prec: 0.647175  v_Recall: 0.522742  v_F1: 0.578341  v_AUC: 0.833919
steps 2400    running time 105 seconds

steps 2600    base_loss: 0.322596    reg_loss: 0.055962    l2_loss: 0.013738    loss: 0.392295
steps 2600    v_Prec: 0.643047  v_Recall: 0.557809  v_F1: 0.597403  v_AUC: 0.845692
steps 2600    running time 111 seconds

steps 2800    base_loss: 0.320201    reg_loss: 0.055639    l2_loss: 0.013869    loss: 0.389709
steps 2800    v_Prec: 0.643608  v_Recall: 0.584447  v_F1: 0.612602  v_AUC: 0.856148
steps 2800    running time 117 seconds

steps 3000    base_loss: 0.306363    reg_loss: 0.054837    l2_loss: 0.014010    loss: 0.375210
steps 3000    v_Prec: 0.695803  v_Recall: 0.576018  v_F1: 0.630269  v_AUC: 0.862845
steps 3000    running time 122 seconds

steps 3200    base_loss: 0.301613    reg_loss: 0.054625    l2_loss: 0.014181    loss: 0.370419
steps 3200    v_Prec: 0.674775  v_Recall: 0.602179  v_F1: 0.636413  v_AUC: 0.868733
steps 3200    running time 129 seconds

steps 3400    base_loss: 0.301983    reg_loss: 0.054312    l2_loss: 0.014386    loss: 0.370682
steps 3400    v_Prec: 0.701312  v_Recall: 0.595022  v_F1: 0.643810  v_AUC: 0.872152
steps 3400    running time 134 seconds

steps 3600    base_loss: 0.295472    reg_loss: 0.053990    l2_loss: 0.014604    loss: 0.364066
steps 3600    v_Prec: 0.711546  v_Recall: 0.601781  v_F1: 0.652077  v_AUC: 0.877823
steps 3600    running time 140 seconds

steps 3800    base_loss: 0.286786    reg_loss: 0.053410    l2_loss: 0.014790    loss: 0.354986
steps 3800    v_Prec: 0.687895  v_Recall: 0.632156  v_F1: 0.658849  v_AUC: 0.880630
steps 3800    running time 146 seconds

steps 4000    base_loss: 0.286289    reg_loss: 0.053255    l2_loss: 0.014999    loss: 0.354543
steps 4000    v_Prec: 0.674032  v_Recall: 0.647662  v_F1: 0.660584  v_AUC: 0.884390
steps 4000    running time 152 seconds

steps 4200    base_loss: 0.286198    reg_loss: 0.053040    l2_loss: 0.015164    loss: 0.354403
steps 4200    v_Prec: 0.695728  v_Recall: 0.635814  v_F1: 0.664423  v_AUC: 0.888956
steps 4200    running time 158 seconds

steps 4400    base_loss: 0.281011    reg_loss: 0.052524    l2_loss: 0.015491    loss: 0.349026
steps 4400    v_Prec: 0.680895  v_Recall: 0.660862  v_F1: 0.670729  v_AUC: 0.891899
steps 4400    running time 163 seconds

steps 4600    base_loss: 0.274225    reg_loss: 0.052452    l2_loss: 0.015845    loss: 0.342523
steps 4600    v_Prec: 0.702740  v_Recall: 0.646469  v_F1: 0.673431  v_AUC: 0.890880
steps 4600    running time 169 seconds

steps 4800    base_loss: 0.274991    reg_loss: 0.052011    l2_loss: 0.016198    loss: 0.343200
steps 4800    v_Prec: 0.701127  v_Recall: 0.657920  v_F1: 0.678837  v_AUC: 0.893751
steps 4800    running time 174 seconds

steps 5000    base_loss: 0.272875    reg_loss: 0.051905    l2_loss: 0.016476    loss: 0.341256
steps 5000    v_Prec: 0.707722  v_Recall: 0.667541  v_F1: 0.687045  v_AUC: 0.895977
steps 5000    running time 180 seconds

steps 5200    base_loss: 0.274471    reg_loss: 0.051898    l2_loss: 0.016808    loss: 0.343177
steps 5200    v_Prec: 0.698994  v_Recall: 0.673982  v_F1: 0.686260  v_AUC: 0.895553
steps 5200    running time 186 seconds

steps 5400    base_loss: 0.262212    reg_loss: 0.051437    l2_loss: 0.017030    loss: 0.330679
steps 5400    v_Prec: 0.685555  v_Recall: 0.693623  v_F1: 0.689565  v_AUC: 0.898560
steps 5400    running time 192 seconds

steps 5600    base_loss: 0.197289    reg_loss: 0.047491    l2_loss: 0.017673    loss: 0.262453
steps 5600    v_Prec: 0.727257  v_Recall: 0.653467  v_F1: 0.688390  v_AUC: 0.897412
steps 5600    running time 197 seconds

steps 5800    base_loss: 0.206648    reg_loss: 0.047356    l2_loss: 0.018396    loss: 0.272400
steps 5800    v_Prec: 0.715893  v_Recall: 0.657602  v_F1: 0.685511  v_AUC: 0.895108
steps 5800    running time 203 seconds

steps 6000    base_loss: 0.202716    reg_loss: 0.046834    l2_loss: 0.018957    loss: 0.268507
steps 6000    v_Prec: 0.729312  v_Recall: 0.648934  v_F1: 0.686779  v_AUC: 0.894052
steps 6000    running time 208 seconds

steps 6200    base_loss: 0.210656    reg_loss: 0.046966    l2_loss: 0.019331    loss: 0.276953
steps 6200    v_Prec: 0.713506  v_Recall: 0.665394  v_F1: 0.688611  v_AUC: 0.894818
steps 6200    running time 214 seconds

steps 6400    base_loss: 0.214114    reg_loss: 0.047065    l2_loss: 0.019882    loss: 0.281061
steps 6400    v_Prec: 0.722875  v_Recall: 0.660623  v_F1: 0.690349  v_AUC: 0.893224
steps 6400    running time 219 seconds

steps 6600    base_loss: 0.214773    reg_loss: 0.046871    l2_loss: 0.020192    loss: 0.281835
steps 6600    v_Prec: 0.737262  v_Recall: 0.654660  v_F1: 0.693510  v_AUC: 0.894196
steps 6600    running time 225 seconds

steps 6800    base_loss: 0.206129    reg_loss: 0.046266    l2_loss: 0.020540    loss: 0.272935
steps 6800    v_Prec: 0.737010  v_Recall: 0.659828  v_F1: 0.696287  v_AUC: 0.898436
steps 6800    running time 230 seconds

steps 7000    base_loss: 0.207049    reg_loss: 0.045920    l2_loss: 0.020925    loss: 0.273895
steps 7000    v_Prec: 0.721836  v_Recall: 0.668973  v_F1: 0.694400  v_AUC: 0.896119
steps 7000    running time 236 seconds

steps 7200    base_loss: 0.201982    reg_loss: 0.045470    l2_loss: 0.021168    loss: 0.268621
steps 7200    v_Prec: 0.726460  v_Recall: 0.665633  v_F1: 0.694718  v_AUC: 0.896647
steps 7200    running time 242 seconds

steps 7400    base_loss: 0.216977    reg_loss: 0.045846    l2_loss: 0.021431    loss: 0.284254
steps 7400    v_Prec: 0.713789  v_Recall: 0.684955  v_F1: 0.699075  v_AUC: 0.898987
steps 7400    running time 248 seconds

steps 7600    base_loss: 0.208823    reg_loss: 0.045391    l2_loss: 0.021548    loss: 0.275762
steps 7600    v_Prec: 0.733080  v_Recall: 0.674380  v_F1: 0.702506  v_AUC: 0.898397
steps 7600    running time 254 seconds

steps 7800    base_loss: 0.214079    reg_loss: 0.045241    l2_loss: 0.021708    loss: 0.281027
steps 7800    v_Prec: 0.734255  v_Recall: 0.671199  v_F1: 0.701313  v_AUC: 0.900396
steps 7800    running time 260 seconds

steps 8000    base_loss: 0.210321    reg_loss: 0.045098    l2_loss: 0.021939    loss: 0.277357
steps 8000    v_Prec: 0.721316  v_Recall: 0.681854  v_F1: 0.701030  v_AUC: 0.902089
steps 8000    running time 266 seconds

steps 8200    base_loss: 0.213358    reg_loss: 0.044876    l2_loss: 0.022075    loss: 0.280310
steps 8200    v_Prec: 0.729977  v_Recall: 0.684876  v_F1: 0.706708  v_AUC: 0.904191
steps 8200    running time 272 seconds

steps 8400    base_loss: 0.217341    reg_loss: 0.045103    l2_loss: 0.022158    loss: 0.284602
steps 8400    v_Prec: 0.718990  v_Recall: 0.699666  v_F1: 0.709196  v_AUC: 0.905485
steps 8400    running time 278 seconds

steps 8600    base_loss: 0.211345    reg_loss: 0.044385    l2_loss: 0.022155    loss: 0.277886
steps 8600    v_Prec: 0.729937  v_Recall: 0.697201  v_F1: 0.713193  v_AUC: 0.906177
steps 8600    running time 284 seconds

steps 8800    base_loss: 0.213834    reg_loss: 0.044128    l2_loss: 0.022310    loss: 0.280272
steps 8800    v_Prec: 0.757595  v_Recall: 0.676209  v_F1: 0.714592  v_AUC: 0.907237
steps 8800    running time 290 seconds

steps 9000    base_loss: 0.216212    reg_loss: 0.044069    l2_loss: 0.022304    loss: 0.282585
steps 9000    v_Prec: 0.739579  v_Recall: 0.689885  v_F1: 0.713868  v_AUC: 0.907832
steps 9000    running time 296 seconds

steps 9200    base_loss: 0.219137    reg_loss: 0.044465    l2_loss: 0.022478    loss: 0.286081
steps 9200    v_Prec: 0.745924  v_Recall: 0.684001  v_F1: 0.713622  v_AUC: 0.909431
steps 9200    running time 302 seconds

steps 9400    base_loss: 0.218414    reg_loss: 0.043881    l2_loss: 0.022501    loss: 0.284796
steps 9400    v_Prec: 0.750849  v_Recall: 0.685353  v_F1: 0.716608  v_AUC: 0.910347
steps 9400    running time 307 seconds

steps 9600    base_loss: 0.209541    reg_loss: 0.043899    l2_loss: 0.022605    loss: 0.276045
steps 9600    v_Prec: 0.734396  v_Recall: 0.703562  v_F1: 0.718648  v_AUC: 0.911771
steps 9600    running time 314 seconds

steps 9800    base_loss: 0.217344    reg_loss: 0.043830    l2_loss: 0.022610    loss: 0.283785
steps 9800    v_Prec: 0.738669  v_Recall: 0.702370  v_F1: 0.720062  v_AUC: 0.911886
steps 9800    running time 320 seconds

steps 10000    base_loss: 0.211680    reg_loss: 0.043503    l2_loss: 0.022686    loss: 0.277869
steps 10000    v_Prec: 0.758832  v_Recall: 0.690045  v_F1: 0.722805  v_AUC: 0.913285
steps 10000    running time 326 seconds

steps 10200    base_loss: 0.215296    reg_loss: 0.043561    l2_loss: 0.022682    loss: 0.281538
steps 10200    v_Prec: 0.741364  v_Recall: 0.708174  v_F1: 0.724389  v_AUC: 0.914622
steps 10200    running time 332 seconds

steps 10400    base_loss: 0.208080    reg_loss: 0.043097    l2_loss: 0.022605    loss: 0.273781
steps 10400    v_Prec: 0.749745  v_Recall: 0.700143  v_F1: 0.724095  v_AUC: 0.915002
steps 10400    running time 338 seconds

steps 10600    base_loss: 0.208431    reg_loss: 0.043287    l2_loss: 0.022882    loss: 0.274599
steps 10600    v_Prec: 0.739346  v_Recall: 0.710480  v_F1: 0.724626  v_AUC: 0.915819
steps 10600    running time 343 seconds

steps 10800    base_loss: 0.204239    reg_loss: 0.042696    l2_loss: 0.022859    loss: 0.269794
steps 10800    v_Prec: 0.747526  v_Recall: 0.708651  v_F1: 0.727570  v_AUC: 0.917241
steps 10800    running time 349 seconds

steps 11000    base_loss: 0.111034    reg_loss: 0.038066    l2_loss: 0.023014    loss: 0.172115
steps 11000    v_Prec: 0.752793  v_Recall: 0.691078  v_F1: 0.720617  v_AUC: 0.912155
steps 11000    running time 355 seconds

steps 11200    base_loss: 0.113938    reg_loss: 0.038136    l2_loss: 0.023035    loss: 0.175109
steps 11200    v_Prec: 0.739752  v_Recall: 0.695929  v_F1: 0.717171  v_AUC: 0.911272
steps 11200    running time 361 seconds

steps 11400    base_loss: 0.111682    reg_loss: 0.038085    l2_loss: 0.023130    loss: 0.172896
steps 11400    v_Prec: 0.736633  v_Recall: 0.694577  v_F1: 0.714987  v_AUC: 0.911516
steps 11400    running time 366 seconds

steps 11600    base_loss: 0.114730    reg_loss: 0.038269    l2_loss: 0.023240    loss: 0.176239
steps 11600    v_Prec: 0.727750  v_Recall: 0.694418  v_F1: 0.710693  v_AUC: 0.908472
steps 11600    running time 372 seconds

steps 11800    base_loss: 0.115954    reg_loss: 0.038215    l2_loss: 0.023334    loss: 0.177502
steps 11800    v_Prec: 0.741518  v_Recall: 0.696883  v_F1: 0.718508  v_AUC: 0.911134
steps 11800    running time 378 seconds

steps 12000    base_loss: 0.120905    reg_loss: 0.038452    l2_loss: 0.023341    loss: 0.182698
steps 12000    v_Prec: 0.737798  v_Recall: 0.694736  v_F1: 0.715620  v_AUC: 0.910732
steps 12000    running time 383 seconds

steps 12200    base_loss: 0.124850    reg_loss: 0.038472    l2_loss: 0.023413    loss: 0.186735
steps 12200    v_Prec: 0.746352  v_Recall: 0.683206  v_F1: 0.713384  v_AUC: 0.907575
steps 12200    running time 389 seconds

steps 12400    base_loss: 0.121479    reg_loss: 0.038228    l2_loss: 0.023366    loss: 0.183073
steps 12400    v_Prec: 0.741726  v_Recall: 0.680741  v_F1: 0.709926  v_AUC: 0.907888
steps 12400    running time 395 seconds

steps 12600    base_loss: 0.127624    reg_loss: 0.038507    l2_loss: 0.023435    loss: 0.189565
steps 12600    v_Prec: 0.742906  v_Recall: 0.693225  v_F1: 0.717206  v_AUC: 0.909523
steps 12600    running time 401 seconds

steps 12800    base_loss: 0.124909    reg_loss: 0.038533    l2_loss: 0.023388    loss: 0.186830
steps 12800    v_Prec: 0.712394  v_Recall: 0.714377  v_F1: 0.713384  v_AUC: 0.908456
steps 12800    running time 406 seconds

Early stop model F1: 0.727570
testing thre: 0.53599375
testing Prec: 0.553129873022945
testing Recall: 0.7240826245443499
testing F1: 0.6271653791913111
testing AUC: 0.8834899732701081
overall running time 409 seconds
(0.6765704140775939, 0.6297448359659781, 0.6523183809092282, 0.8834899732701081, 0.80470157)

2019-02-24 00:28:18.163543: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:28:18.634136: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:28:18.635024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:28:18.635059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.080000 seconds
loading data in 30.580000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.624250    reg_loss: 0.064899    l2_loss: 0.013336    loss: 0.702485
steps 200    v_Prec: 0.164950  v_Recall: 0.983730  v_F1: 0.282526  v_AUC: 0.509693
steps 200    running time 40 seconds

steps 400    base_loss: 0.531772    reg_loss: 0.064529    l2_loss: 0.013285    loss: 0.609586
steps 400    v_Prec: 0.166465  v_Recall: 0.961270  v_F1: 0.283786  v_AUC: 0.527097
steps 400    running time 46 seconds

steps 600    base_loss: 0.494273    reg_loss: 0.064260    l2_loss: 0.013057    loss: 0.571590
steps 600    v_Prec: 0.165765  v_Recall: 0.970397  v_F1: 0.283160  v_AUC: 0.500158
steps 600    running time 53 seconds

steps 800    base_loss: 0.468986    reg_loss: 0.064176    l2_loss: 0.012795    loss: 0.545958
steps 800    v_Prec: 0.164403  v_Recall: 1.000000  v_F1: 0.282381  v_AUC: 0.507050
steps 800    running time 59 seconds

steps 1000    base_loss: 0.461823    reg_loss: 0.064013    l2_loss: 0.012610    loss: 0.538446
steps 1000    v_Prec: 0.164545  v_Recall: 0.997937  v_F1: 0.282508  v_AUC: 0.514454
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.452508    reg_loss: 0.063632    l2_loss: 0.012552    loss: 0.528692
steps 1200    v_Prec: 0.164957  v_Recall: 0.991587  v_F1: 0.282858  v_AUC: 0.551015
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.447025    reg_loss: 0.063673    l2_loss: 0.012402    loss: 0.523100
steps 1400    v_Prec: 0.275577  v_Recall: 0.457063  v_F1: 0.343841  v_AUC: 0.658326
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.418798    reg_loss: 0.064036    l2_loss: 0.012394    loss: 0.495228
steps 1600    v_Prec: 0.423446  v_Recall: 0.438333  v_F1: 0.430761  v_AUC: 0.740466
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.387310    reg_loss: 0.064208    l2_loss: 0.012538    loss: 0.464056
steps 1800    v_Prec: 0.488508  v_Recall: 0.484127  v_F1: 0.486308  v_AUC: 0.783584
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.363037    reg_loss: 0.064762    l2_loss: 0.012740    loss: 0.440539
steps 2000    v_Prec: 0.540896  v_Recall: 0.529048  v_F1: 0.534906  v_AUC: 0.815677
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.343943    reg_loss: 0.065146    l2_loss: 0.012992    loss: 0.422081
steps 2200    v_Prec: 0.579934  v_Recall: 0.542698  v_F1: 0.560699  v_AUC: 0.835434
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.332537    reg_loss: 0.065815    l2_loss: 0.013322    loss: 0.411674
steps 2400    v_Prec: 0.593497  v_Recall: 0.570794  v_F1: 0.581924  v_AUC: 0.849976
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.320199    reg_loss: 0.065883    l2_loss: 0.013596    loss: 0.399678
steps 2600    v_Prec: 0.611120  v_Recall: 0.583571  v_F1: 0.597028  v_AUC: 0.860796
steps 2600    running time 113 seconds

steps 2800    base_loss: 0.312038    reg_loss: 0.066143    l2_loss: 0.013876    loss: 0.392057
steps 2800    v_Prec: 0.661156  v_Recall: 0.571270  v_F1: 0.612935  v_AUC: 0.868265
steps 2800    running time 119 seconds

steps 3000    base_loss: 0.304264    reg_loss: 0.066159    l2_loss: 0.014191    loss: 0.384614
steps 3000    v_Prec: 0.669358  v_Recall: 0.585635  v_F1: 0.624704  v_AUC: 0.875406
steps 3000    running time 125 seconds

steps 3200    base_loss: 0.301575    reg_loss: 0.066472    l2_loss: 0.014553    loss: 0.382600
steps 3200    v_Prec: 0.679774  v_Recall: 0.581746  v_F1: 0.626951  v_AUC: 0.880718
steps 3200    running time 131 seconds

steps 3400    base_loss: 0.290939    reg_loss: 0.066369    l2_loss: 0.014888    loss: 0.372196
steps 3400    v_Prec: 0.639754  v_Recall: 0.635794  v_F1: 0.637768  v_AUC: 0.883420
steps 3400    running time 138 seconds

steps 3600    base_loss: 0.295224    reg_loss: 0.066378    l2_loss: 0.015226    loss: 0.376828
steps 3600    v_Prec: 0.649820  v_Recall: 0.631667  v_F1: 0.640615  v_AUC: 0.885172
steps 3600    running time 144 seconds

steps 3800    base_loss: 0.285363    reg_loss: 0.066436    l2_loss: 0.015635    loss: 0.367434
steps 3800    v_Prec: 0.658506  v_Recall: 0.631905  v_F1: 0.644931  v_AUC: 0.887928
steps 3800    running time 150 seconds

steps 4000    base_loss: 0.285500    reg_loss: 0.066458    l2_loss: 0.016070    loss: 0.368028
steps 4000    v_Prec: 0.640568  v_Recall: 0.651905  v_F1: 0.646187  v_AUC: 0.890122
steps 4000    running time 156 seconds

steps 4200    base_loss: 0.282392    reg_loss: 0.066627    l2_loss: 0.016523    loss: 0.365541
steps 4200    v_Prec: 0.668652  v_Recall: 0.632460  v_F1: 0.650053  v_AUC: 0.890801
steps 4200    running time 163 seconds

steps 4400    base_loss: 0.276592    reg_loss: 0.066550    l2_loss: 0.016999    loss: 0.360141
steps 4400    v_Prec: 0.643076  v_Recall: 0.667063  v_F1: 0.654850  v_AUC: 0.893056
steps 4400    running time 170 seconds

steps 4600    base_loss: 0.282312    reg_loss: 0.066572    l2_loss: 0.017474    loss: 0.366358
steps 4600    v_Prec: 0.674064  v_Recall: 0.646032  v_F1: 0.659750  v_AUC: 0.896739
steps 4600    running time 176 seconds

steps 4800    base_loss: 0.276642    reg_loss: 0.066660    l2_loss: 0.017991    loss: 0.361293
steps 4800    v_Prec: 0.657356  v_Recall: 0.663095  v_F1: 0.660213  v_AUC: 0.897028
steps 4800    running time 183 seconds

steps 5000    base_loss: 0.278706    reg_loss: 0.066589    l2_loss: 0.018545    loss: 0.363840
steps 5000    v_Prec: 0.693146  v_Recall: 0.630873  v_F1: 0.660545  v_AUC: 0.897740
steps 5000    running time 189 seconds

steps 5200    base_loss: 0.275712    reg_loss: 0.066668    l2_loss: 0.019136    loss: 0.361516
steps 5200    v_Prec: 0.675284  v_Recall: 0.646825  v_F1: 0.660748  v_AUC: 0.898235
steps 5200    running time 196 seconds

steps 5400    base_loss: 0.276864    reg_loss: 0.066689    l2_loss: 0.019805    loss: 0.363358
steps 5400    v_Prec: 0.690853  v_Recall: 0.643810  v_F1: 0.666502  v_AUC: 0.901869
steps 5400    running time 202 seconds

steps 5600    base_loss: 0.194986    reg_loss: 0.067202    l2_loss: 0.020616    loss: 0.282804
steps 5600    v_Prec: 0.679732  v_Recall: 0.644127  v_F1: 0.661451  v_AUC: 0.896547
steps 5600    running time 208 seconds

steps 5800    base_loss: 0.203384    reg_loss: 0.067251    l2_loss: 0.021415    loss: 0.292050
steps 5800    v_Prec: 0.665691  v_Recall: 0.649841  v_F1: 0.657671  v_AUC: 0.896923
steps 5800    running time 214 seconds

steps 6000    base_loss: 0.179947    reg_loss: 0.067124    l2_loss: 0.022201    loss: 0.269273
steps 6000    v_Prec: 0.663046  v_Recall: 0.649206  v_F1: 0.656053  v_AUC: 0.894162
steps 6000    running time 220 seconds

steps 6200    base_loss: 0.207876    reg_loss: 0.067273    l2_loss: 0.022732    loss: 0.297881
steps 6200    v_Prec: 0.652804  v_Recall: 0.657778  v_F1: 0.655281  v_AUC: 0.895310
steps 6200    running time 225 seconds

steps 6400    base_loss: 0.195387    reg_loss: 0.067375    l2_loss: 0.023243    loss: 0.286005
steps 6400    v_Prec: 0.675242  v_Recall: 0.647857  v_F1: 0.661266  v_AUC: 0.895728
steps 6400    running time 231 seconds

steps 6600    base_loss: 0.199210    reg_loss: 0.067371    l2_loss: 0.023800    loss: 0.290381
steps 6600    v_Prec: 0.677175  v_Recall: 0.652937  v_F1: 0.664835  v_AUC: 0.897012
steps 6600    running time 237 seconds

steps 6800    base_loss: 0.197728    reg_loss: 0.066966    l2_loss: 0.024287    loss: 0.288981
steps 6800    v_Prec: 0.677129  v_Recall: 0.650635  v_F1: 0.663618  v_AUC: 0.898803
steps 6800    running time 242 seconds

steps 7000    base_loss: 0.205127    reg_loss: 0.067432    l2_loss: 0.024675    loss: 0.297233
steps 7000    v_Prec: 0.658989  v_Recall: 0.674365  v_F1: 0.666588  v_AUC: 0.899319
steps 7000    running time 248 seconds

steps 7200    base_loss: 0.205798    reg_loss: 0.067167    l2_loss: 0.025089    loss: 0.298054
steps 7200    v_Prec: 0.717645  v_Recall: 0.629762  v_F1: 0.670837  v_AUC: 0.901507
steps 7200    running time 254 seconds

steps 7400    base_loss: 0.200959    reg_loss: 0.067402    l2_loss: 0.025280    loss: 0.293642
steps 7400    v_Prec: 0.717756  v_Recall: 0.637778  v_F1: 0.675408  v_AUC: 0.904058
steps 7400    running time 261 seconds

steps 7600    base_loss: 0.194699    reg_loss: 0.067218    l2_loss: 0.025613    loss: 0.287530
steps 7600    v_Prec: 0.669837  v_Recall: 0.676429  v_F1: 0.673116  v_AUC: 0.903519
steps 7600    running time 267 seconds

steps 7800    base_loss: 0.205789    reg_loss: 0.067146    l2_loss: 0.025809    loss: 0.298744
steps 7800    v_Prec: 0.707392  v_Recall: 0.660794  v_F1: 0.683299  v_AUC: 0.908201
steps 7800    running time 273 seconds

steps 8000    base_loss: 0.197559    reg_loss: 0.067328    l2_loss: 0.026163    loss: 0.291050
steps 8000    v_Prec: 0.698718  v_Recall: 0.670714  v_F1: 0.684430  v_AUC: 0.907013
steps 8000    running time 280 seconds

steps 8200    base_loss: 0.206774    reg_loss: 0.066979    l2_loss: 0.026557    loss: 0.300310
steps 8200    v_Prec: 0.694651  v_Recall: 0.675079  v_F1: 0.684725  v_AUC: 0.909347
steps 8200    running time 286 seconds

steps 8400    base_loss: 0.197172    reg_loss: 0.066985    l2_loss: 0.026876    loss: 0.291033
steps 8400    v_Prec: 0.717674  v_Recall: 0.658095  v_F1: 0.686594  v_AUC: 0.908851
steps 8400    running time 292 seconds

steps 8600    base_loss: 0.201606    reg_loss: 0.066904    l2_loss: 0.027245    loss: 0.295755
steps 8600    v_Prec: 0.712231  v_Recall: 0.671984  v_F1: 0.691522  v_AUC: 0.911255
steps 8600    running time 299 seconds

steps 8800    base_loss: 0.195702    reg_loss: 0.066901    l2_loss: 0.027409    loss: 0.290011
steps 8800    v_Prec: 0.718475  v_Recall: 0.674683  v_F1: 0.695891  v_AUC: 0.912686
steps 8800    running time 305 seconds

steps 9000    base_loss: 0.202631    reg_loss: 0.066881    l2_loss: 0.027609    loss: 0.297120
steps 9000    v_Prec: 0.714238  v_Recall: 0.685556  v_F1: 0.699603  v_AUC: 0.914205
steps 9000    running time 311 seconds

steps 9200    base_loss: 0.200993    reg_loss: 0.067076    l2_loss: 0.027832    loss: 0.295900
steps 9200    v_Prec: 0.713931  v_Recall: 0.684921  v_F1: 0.699125  v_AUC: 0.915161
steps 9200    running time 317 seconds

steps 9400    base_loss: 0.199237    reg_loss: 0.066844    l2_loss: 0.028019    loss: 0.294100
steps 9400    v_Prec: 0.730039  v_Recall: 0.674127  v_F1: 0.700970  v_AUC: 0.915679
steps 9400    running time 323 seconds

steps 9600    base_loss: 0.197239    reg_loss: 0.066681    l2_loss: 0.028146    loss: 0.292066
steps 9600    v_Prec: 0.723657  v_Recall: 0.691667  v_F1: 0.707300  v_AUC: 0.917957
steps 9600    running time 329 seconds

steps 9800    base_loss: 0.198474    reg_loss: 0.066656    l2_loss: 0.028459    loss: 0.293590
steps 9800    v_Prec: 0.718007  v_Recall: 0.702222  v_F1: 0.710027  v_AUC: 0.919815
steps 9800    running time 335 seconds

steps 10000    base_loss: 0.196767    reg_loss: 0.066837    l2_loss: 0.028772    loss: 0.292376
steps 10000    v_Prec: 0.738969  v_Recall: 0.680556  v_F1: 0.708561  v_AUC: 0.918680
steps 10000    running time 342 seconds

steps 10200    base_loss: 0.201931    reg_loss: 0.066589    l2_loss: 0.028752    loss: 0.297271
steps 10200    v_Prec: 0.734951  v_Recall: 0.699603  v_F1: 0.716842  v_AUC: 0.921835
steps 10200    running time 348 seconds

steps 10400    base_loss: 0.203023    reg_loss: 0.066656    l2_loss: 0.028941    loss: 0.298619
steps 10400    v_Prec: 0.758125  v_Recall: 0.670159  v_F1: 0.711433  v_AUC: 0.921428
steps 10400    running time 354 seconds

steps 10600    base_loss: 0.200303    reg_loss: 0.066460    l2_loss: 0.029107    loss: 0.295870
steps 10600    v_Prec: 0.753975  v_Recall: 0.684921  v_F1: 0.717791  v_AUC: 0.922861
steps 10600    running time 360 seconds

steps 10800    base_loss: 0.182064    reg_loss: 0.066463    l2_loss: 0.029518    loss: 0.278046
steps 10800    v_Prec: 0.742968  v_Recall: 0.683413  v_F1: 0.711947  v_AUC: 0.920790
steps 10800    running time 366 seconds

steps 11000    base_loss: 0.093015    reg_loss: 0.066111    l2_loss: 0.029691    loss: 0.188817
steps 11000    v_Prec: 0.731046  v_Recall: 0.661190  v_F1: 0.694366  v_AUC: 0.910497
steps 11000    running time 372 seconds

steps 11200    base_loss: 0.092827    reg_loss: 0.065981    l2_loss: 0.029867    loss: 0.188675
steps 11200    v_Prec: 0.690172  v_Recall: 0.690556  v_F1: 0.690364  v_AUC: 0.911306
steps 11200    running time 378 seconds

steps 11400    base_loss: 0.098090    reg_loss: 0.065910    l2_loss: 0.029924    loss: 0.193924
steps 11400    v_Prec: 0.698450  v_Recall: 0.679603  v_F1: 0.688898  v_AUC: 0.908878
steps 11400    running time 384 seconds

steps 11600    base_loss: 0.094227    reg_loss: 0.065778    l2_loss: 0.030026    loss: 0.190031
steps 11600    v_Prec: 0.686399  v_Recall: 0.683730  v_F1: 0.685062  v_AUC: 0.907668
steps 11600    running time 390 seconds

steps 11800    base_loss: 0.103491    reg_loss: 0.065864    l2_loss: 0.030141    loss: 0.199496
steps 11800    v_Prec: 0.674851  v_Recall: 0.691508  v_F1: 0.683078  v_AUC: 0.906323
steps 11800    running time 395 seconds

steps 12000    base_loss: 0.101801    reg_loss: 0.065531    l2_loss: 0.030273    loss: 0.197605
steps 12000    v_Prec: 0.667896  v_Recall: 0.689841  v_F1: 0.678691  v_AUC: 0.903904
steps 12000    running time 401 seconds

steps 12200    base_loss: 0.102857    reg_loss: 0.065640    l2_loss: 0.030418    loss: 0.198915
steps 12200    v_Prec: 0.692440  v_Recall: 0.670952  v_F1: 0.681527  v_AUC: 0.903768
steps 12200    running time 408 seconds

steps 12400    base_loss: 0.101102    reg_loss: 0.065601    l2_loss: 0.030487    loss: 0.197190
steps 12400    v_Prec: 0.684607  v_Recall: 0.677381  v_F1: 0.680975  v_AUC: 0.904567
steps 12400    running time 414 seconds

steps 12600    base_loss: 0.102137    reg_loss: 0.065451    l2_loss: 0.030587    loss: 0.198174
steps 12600    v_Prec: 0.682502  v_Recall: 0.680714  v_F1: 0.681607  v_AUC: 0.905486
steps 12600    running time 420 seconds

Early stop model F1: 0.717791
testing thre: 0.52437925
testing Prec: 0.5415915529229977
testing Recall: 0.7154799513973269
testing F1: 0.6165089203450876
testing AUC: 0.8887937819329625
overall running time 422 seconds
(0.6565862614105767, 0.6257594167679222, 0.6408023093768664, 0.8887937819329625, 0.7132227)

2019-02-24 00:33:03.049476: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:33:03.375045: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:33:03.376608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:33:03.376643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.130000 seconds
loading data in 30.180000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.006778    reg_loss: 0.064849    l2_loss: 0.013306    loss: 1.084933
steps 200    v_Prec: 0.165658  v_Recall: 1.000000  v_F1: 0.284230  v_AUC: 0.481745
steps 200    running time 40 seconds

steps 400    base_loss: 0.596854    reg_loss: 0.065061    l2_loss: 0.013085    loss: 0.675001
steps 400    v_Prec: 0.165658  v_Recall: 1.000000  v_F1: 0.284230  v_AUC: 0.495648
steps 400    running time 46 seconds

steps 600    base_loss: 0.489025    reg_loss: 0.065064    l2_loss: 0.013014    loss: 0.567103
steps 600    v_Prec: 0.165757  v_Recall: 0.997322  v_F1: 0.284268  v_AUC: 0.521744
steps 600    running time 52 seconds

steps 800    base_loss: 0.482404    reg_loss: 0.065093    l2_loss: 0.012948    loss: 0.560445
steps 800    v_Prec: 0.168134  v_Recall: 0.950929  v_F1: 0.285745  v_AUC: 0.546555
steps 800    running time 58 seconds

steps 1000    base_loss: 0.461757    reg_loss: 0.065128    l2_loss: 0.012862    loss: 0.539747
steps 1000    v_Prec: 0.179506  v_Recall: 0.764808  v_F1: 0.290766  v_AUC: 0.569210
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.447179    reg_loss: 0.064878    l2_loss: 0.012818    loss: 0.524875
steps 1200    v_Prec: 0.215609  v_Recall: 0.536389  v_F1: 0.307581  v_AUC: 0.603311
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.447605    reg_loss: 0.064701    l2_loss: 0.012816    loss: 0.525122
steps 1400    v_Prec: 0.256061  v_Recall: 0.508270  v_F1: 0.340555  v_AUC: 0.646829
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.426159    reg_loss: 0.064472    l2_loss: 0.012833    loss: 0.503464
steps 1600    v_Prec: 0.331803  v_Recall: 0.466840  v_F1: 0.387905  v_AUC: 0.692462
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.413033    reg_loss: 0.064253    l2_loss: 0.012980    loss: 0.490266
steps 1800    v_Prec: 0.449335  v_Recall: 0.428560  v_F1: 0.438702  v_AUC: 0.728950
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.390114    reg_loss: 0.064373    l2_loss: 0.013166    loss: 0.467653
steps 2000    v_Prec: 0.499243  v_Recall: 0.467470  v_F1: 0.482834  v_AUC: 0.760022
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.375881    reg_loss: 0.064213    l2_loss: 0.013422    loss: 0.453515
steps 2200    v_Prec: 0.543157  v_Recall: 0.485744  v_F1: 0.512848  v_AUC: 0.783779
steps 2200    running time 103 seconds

steps 2400    base_loss: 0.348494    reg_loss: 0.064190    l2_loss: 0.013687    loss: 0.426371
steps 2400    v_Prec: 0.575861  v_Recall: 0.507325  v_F1: 0.539425  v_AUC: 0.801884
steps 2400    running time 109 seconds

steps 2600    base_loss: 0.345329    reg_loss: 0.064010    l2_loss: 0.014022    loss: 0.423361
steps 2600    v_Prec: 0.620997  v_Recall: 0.510161  v_F1: 0.560149  v_AUC: 0.815445
steps 2600    running time 115 seconds

steps 2800    base_loss: 0.334605    reg_loss: 0.064275    l2_loss: 0.014271    loss: 0.413151
steps 2800    v_Prec: 0.596641  v_Recall: 0.565296  v_F1: 0.580546  v_AUC: 0.827822
steps 2800    running time 121 seconds

steps 3000    base_loss: 0.323885    reg_loss: 0.064135    l2_loss: 0.014571    loss: 0.402591
steps 3000    v_Prec: 0.648856  v_Recall: 0.551906  v_F1: 0.596467  v_AUC: 0.835759
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.312685    reg_loss: 0.064155    l2_loss: 0.014838    loss: 0.391679
steps 3200    v_Prec: 0.654737  v_Recall: 0.567738  v_F1: 0.608142  v_AUC: 0.843051
steps 3200    running time 134 seconds

steps 3400    base_loss: 0.311439    reg_loss: 0.064246    l2_loss: 0.015100    loss: 0.390785
steps 3400    v_Prec: 0.674702  v_Recall: 0.570967  v_F1: 0.618515  v_AUC: 0.850326
steps 3400    running time 140 seconds

steps 3600    base_loss: 0.305874    reg_loss: 0.064111    l2_loss: 0.015423    loss: 0.385407
steps 3600    v_Prec: 0.684157  v_Recall: 0.578214  v_F1: 0.626740  v_AUC: 0.855239
steps 3600    running time 146 seconds

steps 3800    base_loss: 0.307087    reg_loss: 0.064292    l2_loss: 0.015726    loss: 0.387105
steps 3800    v_Prec: 0.687872  v_Recall: 0.591052  v_F1: 0.635798  v_AUC: 0.860814
steps 3800    running time 153 seconds

steps 4000    base_loss: 0.302857    reg_loss: 0.064284    l2_loss: 0.016097    loss: 0.383238
steps 4000    v_Prec: 0.715957  v_Recall: 0.593021  v_F1: 0.648716  v_AUC: 0.865872
steps 4000    running time 159 seconds

steps 4200    base_loss: 0.300059    reg_loss: 0.064559    l2_loss: 0.016397    loss: 0.381015
steps 4200    v_Prec: 0.707212  v_Recall: 0.606333  v_F1: 0.652899  v_AUC: 0.871043
steps 4200    running time 165 seconds

steps 4400    base_loss: 0.294692    reg_loss: 0.064366    l2_loss: 0.016730    loss: 0.375788
steps 4400    v_Prec: 0.728650  v_Recall: 0.602158  v_F1: 0.659393  v_AUC: 0.872765
steps 4400    running time 171 seconds

steps 4600    base_loss: 0.290164    reg_loss: 0.064215    l2_loss: 0.017123    loss: 0.371502
steps 4600    v_Prec: 0.698264  v_Recall: 0.627205  v_F1: 0.660830  v_AUC: 0.873567
steps 4600    running time 177 seconds

steps 4800    base_loss: 0.286900    reg_loss: 0.064364    l2_loss: 0.017506    loss: 0.368771
steps 4800    v_Prec: 0.721975  v_Recall: 0.613815  v_F1: 0.663516  v_AUC: 0.876019
steps 4800    running time 183 seconds

steps 5000    base_loss: 0.283503    reg_loss: 0.064164    l2_loss: 0.017993    loss: 0.365661
steps 5000    v_Prec: 0.725018  v_Recall: 0.619486  v_F1: 0.668111  v_AUC: 0.877792
steps 5000    running time 190 seconds

steps 5200    base_loss: 0.282416    reg_loss: 0.064070    l2_loss: 0.018446    loss: 0.364933
steps 5200    v_Prec: 0.686955  v_Recall: 0.657845  v_F1: 0.672085  v_AUC: 0.879665
steps 5200    running time 196 seconds

steps 5400    base_loss: 0.271098    reg_loss: 0.063476    l2_loss: 0.018884    loss: 0.353458
steps 5400    v_Prec: 0.734250  v_Recall: 0.622401  v_F1: 0.673715  v_AUC: 0.881533
steps 5400    running time 202 seconds

steps 5600    base_loss: 0.183347    reg_loss: 0.060208    l2_loss: 0.019165    loss: 0.262720
steps 5600    v_Prec: 0.701216  v_Recall: 0.640517  v_F1: 0.669493  v_AUC: 0.880002
steps 5600    running time 209 seconds

steps 5800    base_loss: 0.180300    reg_loss: 0.060300    l2_loss: 0.019358    loss: 0.259958
steps 5800    v_Prec: 0.689443  v_Recall: 0.642958  v_F1: 0.665390  v_AUC: 0.877305
steps 5800    running time 215 seconds

steps 6000    base_loss: 0.186688    reg_loss: 0.060565    l2_loss: 0.019565    loss: 0.266818
steps 6000    v_Prec: 0.727281  v_Recall: 0.619014  v_F1: 0.668794  v_AUC: 0.879017
steps 6000    running time 221 seconds

steps 6200    base_loss: 0.198542    reg_loss: 0.061098    l2_loss: 0.019848    loss: 0.279487
steps 6200    v_Prec: 0.733951  v_Recall: 0.617754  v_F1: 0.670858  v_AUC: 0.880150
steps 6200    running time 227 seconds

steps 6400    base_loss: 0.192064    reg_loss: 0.060508    l2_loss: 0.019988    loss: 0.272561
steps 6400    v_Prec: 0.729740  v_Recall: 0.626969  v_F1: 0.674462  v_AUC: 0.881645
steps 6400    running time 233 seconds

steps 6600    base_loss: 0.191777    reg_loss: 0.061068    l2_loss: 0.020196    loss: 0.273041
steps 6600    v_Prec: 0.728263  v_Recall: 0.632010  v_F1: 0.676731  v_AUC: 0.882859
steps 6600    running time 239 seconds

steps 6800    base_loss: 0.196768    reg_loss: 0.061051    l2_loss: 0.020448    loss: 0.278267
steps 6800    v_Prec: 0.747008  v_Recall: 0.614445  v_F1: 0.674273  v_AUC: 0.882331
steps 6800    running time 246 seconds

steps 7000    base_loss: 0.205639    reg_loss: 0.061139    l2_loss: 0.020515    loss: 0.287292
steps 7000    v_Prec: 0.743121  v_Recall: 0.627520  v_F1: 0.680446  v_AUC: 0.882215
steps 7000    running time 252 seconds

steps 7200    base_loss: 0.199153    reg_loss: 0.061332    l2_loss: 0.020766    loss: 0.281251
steps 7200    v_Prec: 0.736384  v_Recall: 0.632561  v_F1: 0.680536  v_AUC: 0.884600
steps 7200    running time 258 seconds

steps 7400    base_loss: 0.203439    reg_loss: 0.061555    l2_loss: 0.020860    loss: 0.285854
steps 7400    v_Prec: 0.758971  v_Recall: 0.623031  v_F1: 0.684315  v_AUC: 0.887784
steps 7400    running time 265 seconds

steps 7600    base_loss: 0.207931    reg_loss: 0.061246    l2_loss: 0.021069    loss: 0.290247
steps 7600    v_Prec: 0.749816  v_Recall: 0.643273  v_F1: 0.692471  v_AUC: 0.887949
steps 7600    running time 271 seconds

steps 7800    base_loss: 0.204828    reg_loss: 0.061512    l2_loss: 0.021052    loss: 0.287391
steps 7800    v_Prec: 0.739235  v_Recall: 0.654458  v_F1: 0.694268  v_AUC: 0.887506
steps 7800    running time 277 seconds

steps 8000    base_loss: 0.210248    reg_loss: 0.061511    l2_loss: 0.021061    loss: 0.292820
steps 8000    v_Prec: 0.743865  v_Recall: 0.654222  v_F1: 0.696170  v_AUC: 0.889465
steps 8000    running time 283 seconds

steps 8200    base_loss: 0.204990    reg_loss: 0.061698    l2_loss: 0.021297    loss: 0.287985
steps 8200    v_Prec: 0.769909  v_Recall: 0.639650  v_F1: 0.698761  v_AUC: 0.891238
steps 8200    running time 289 seconds

steps 8400    base_loss: 0.196265    reg_loss: 0.061076    l2_loss: 0.021348    loss: 0.278690
steps 8400    v_Prec: 0.750112  v_Recall: 0.660602  v_F1: 0.702517  v_AUC: 0.893102
steps 8400    running time 295 seconds

steps 8600    base_loss: 0.208118    reg_loss: 0.061329    l2_loss: 0.021399    loss: 0.290845
steps 8600    v_Prec: 0.759197  v_Recall: 0.655088  v_F1: 0.703311  v_AUC: 0.891799
steps 8600    running time 301 seconds

steps 8800    base_loss: 0.200708    reg_loss: 0.061579    l2_loss: 0.021548    loss: 0.283836
steps 8800    v_Prec: 0.767097  v_Recall: 0.655561  v_F1: 0.706957  v_AUC: 0.893560
steps 8800    running time 308 seconds

steps 9000    base_loss: 0.208867    reg_loss: 0.061293    l2_loss: 0.021544    loss: 0.291704
steps 9000    v_Prec: 0.751906  v_Recall: 0.667927  v_F1: 0.707433  v_AUC: 0.893727
steps 9000    running time 314 seconds

steps 9200    base_loss: 0.201181    reg_loss: 0.060998    l2_loss: 0.021541    loss: 0.283720
steps 9200    v_Prec: 0.760709  v_Recall: 0.665800  v_F1: 0.710097  v_AUC: 0.895728
steps 9200    running time 320 seconds

steps 9400    base_loss: 0.206432    reg_loss: 0.061203    l2_loss: 0.021693    loss: 0.289329
steps 9400    v_Prec: 0.772531  v_Recall: 0.660996  v_F1: 0.712424  v_AUC: 0.894894
steps 9400    running time 327 seconds

steps 9600    base_loss: 0.199315    reg_loss: 0.061279    l2_loss: 0.021647    loss: 0.282241
steps 9600    v_Prec: 0.780052  v_Recall: 0.657294  v_F1: 0.713431  v_AUC: 0.896334
steps 9600    running time 333 seconds

steps 9800    base_loss: 0.201209    reg_loss: 0.061457    l2_loss: 0.021622    loss: 0.284288
steps 9800    v_Prec: 0.791512  v_Recall: 0.655167  v_F1: 0.716914  v_AUC: 0.896718
steps 9800    running time 339 seconds

steps 10000    base_loss: 0.206767    reg_loss: 0.061139    l2_loss: 0.021726    loss: 0.289633
steps 10000    v_Prec: 0.756191  v_Recall: 0.685491  v_F1: 0.719108  v_AUC: 0.898220
steps 10000    running time 346 seconds

steps 10200    base_loss: 0.199233    reg_loss: 0.060997    l2_loss: 0.021747    loss: 0.281976
steps 10200    v_Prec: 0.757221  v_Recall: 0.687618  v_F1: 0.720743  v_AUC: 0.899470
steps 10200    running time 352 seconds

steps 10400    base_loss: 0.201969    reg_loss: 0.061002    l2_loss: 0.021829    loss: 0.284800
steps 10400    v_Prec: 0.771892  v_Recall: 0.681790  v_F1: 0.724049  v_AUC: 0.900987
steps 10400    running time 358 seconds

steps 10600    base_loss: 0.192064    reg_loss: 0.060700    l2_loss: 0.021764    loss: 0.274529
steps 10600    v_Prec: 0.772443  v_Recall: 0.680451  v_F1: 0.723534  v_AUC: 0.900590
steps 10600    running time 364 seconds

steps 10800    base_loss: 0.185643    reg_loss: 0.059906    l2_loss: 0.021784    loss: 0.267333
steps 10800    v_Prec: 0.764478  v_Recall: 0.684152  v_F1: 0.722088  v_AUC: 0.902055
steps 10800    running time 370 seconds

steps 11000    base_loss: 0.066274    reg_loss: 0.055809    l2_loss: 0.021721    loss: 0.143804
steps 11000    v_Prec: 0.774909  v_Recall: 0.668951  v_F1: 0.718042  v_AUC: 0.898507
steps 11000    running time 376 seconds

steps 11200    base_loss: 0.065235    reg_loss: 0.055865    l2_loss: 0.021211    loss: 0.142311
steps 11200    v_Prec: 0.756489  v_Recall: 0.672653  v_F1: 0.712112  v_AUC: 0.893807
steps 11200    running time 382 seconds

steps 11400    base_loss: 0.074016    reg_loss: 0.056113    l2_loss: 0.020774    loss: 0.150903
steps 11400    v_Prec: 0.757595  v_Recall: 0.661941  v_F1: 0.706545  v_AUC: 0.891862
steps 11400    running time 388 seconds

steps 11600    base_loss: 0.070164    reg_loss: 0.056028    l2_loss: 0.020517    loss: 0.146709
steps 11600    v_Prec: 0.766821  v_Recall: 0.653513  v_F1: 0.705647  v_AUC: 0.890435
steps 11600    running time 394 seconds

steps 11800    base_loss: 0.073072    reg_loss: 0.056036    l2_loss: 0.020169    loss: 0.149277
steps 11800    v_Prec: 0.748513  v_Recall: 0.663910  v_F1: 0.703677  v_AUC: 0.892038
steps 11800    running time 400 seconds

steps 12000    base_loss: 0.082219    reg_loss: 0.056124    l2_loss: 0.019994    loss: 0.158338
steps 12000    v_Prec: 0.766542  v_Recall: 0.644219  v_F1: 0.700077  v_AUC: 0.888897
steps 12000    running time 406 seconds

steps 12200    base_loss: 0.080233    reg_loss: 0.056182    l2_loss: 0.019783    loss: 0.156198
steps 12200    v_Prec: 0.733660  v_Recall: 0.671944  v_F1: 0.701447  v_AUC: 0.890282
steps 12200    running time 412 seconds

steps 12400    base_loss: 0.084564    reg_loss: 0.056101    l2_loss: 0.019555    loss: 0.160220
steps 12400    v_Prec: 0.723233  v_Recall: 0.679427  v_F1: 0.700646  v_AUC: 0.889814
steps 12400    running time 418 seconds

Early stop model F1: 0.724049
testing thre: 0.39567363
testing Prec: 0.6227107908385735
testing Recall: 0.6593924665856622
testing F1: 0.6405268873046599
testing AUC: 0.8739523333970773
overall running time 421 seconds
(0.6712156204073063, 0.6215309842041312, 0.6454185277714689, 0.8739523333970773, 0.50053453)

2019-02-24 00:37:43.610124: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:37:44.464750: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:37:44.467114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:37:44.467152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.580000 seconds
loading data in 30.120000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.498829    reg_loss: 0.064542    l2_loss: 0.013374    loss: 0.576746
steps 200    v_Prec: 0.164942  v_Recall: 1.000000  v_F1: 0.283177  v_AUC: 0.481645
steps 200    running time 40 seconds

steps 400    base_loss: 0.484023    reg_loss: 0.064498    l2_loss: 0.013306    loss: 0.561828
steps 400    v_Prec: 0.164938  v_Recall: 1.000000  v_F1: 0.283170  v_AUC: 0.498635
steps 400    running time 46 seconds

steps 600    base_loss: 0.463377    reg_loss: 0.064542    l2_loss: 0.013209    loss: 0.541128
steps 600    v_Prec: 0.164938  v_Recall: 1.000000  v_F1: 0.283170  v_AUC: 0.520102
steps 600    running time 52 seconds

steps 800    base_loss: 0.458008    reg_loss: 0.064815    l2_loss: 0.013110    loss: 0.535932
steps 800    v_Prec: 0.178639  v_Recall: 0.755636  v_F1: 0.288964  v_AUC: 0.569719
steps 800    running time 58 seconds

steps 1000    base_loss: 0.441031    reg_loss: 0.064818    l2_loss: 0.013019    loss: 0.518867
steps 1000    v_Prec: 0.268933  v_Recall: 0.419983  v_F1: 0.327898  v_AUC: 0.635506
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.429684    reg_loss: 0.065201    l2_loss: 0.012940    loss: 0.507825
steps 1200    v_Prec: 0.353797  v_Recall: 0.415315  v_F1: 0.382096  v_AUC: 0.698887
steps 1200    running time 69 seconds

steps 1400    base_loss: 0.406520    reg_loss: 0.065336    l2_loss: 0.012959    loss: 0.484815
steps 1400    v_Prec: 0.394050  v_Recall: 0.479867  v_F1: 0.432745  v_AUC: 0.744428
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.381745    reg_loss: 0.065690    l2_loss: 0.013020    loss: 0.460455
steps 1600    v_Prec: 0.469869  v_Recall: 0.477415  v_F1: 0.473612  v_AUC: 0.778923
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.364577    reg_loss: 0.066039    l2_loss: 0.013141    loss: 0.443757
steps 1800    v_Prec: 0.530877  v_Recall: 0.499169  v_F1: 0.514535  v_AUC: 0.804485
steps 1800    running time 88 seconds

steps 2000    base_loss: 0.355043    reg_loss: 0.066561    l2_loss: 0.013309    loss: 0.434912
steps 2000    v_Prec: 0.567856  v_Recall: 0.517364  v_F1: 0.541436  v_AUC: 0.822782
steps 2000    running time 94 seconds

steps 2200    base_loss: 0.336695    reg_loss: 0.066780    l2_loss: 0.013518    loss: 0.416993
steps 2200    v_Prec: 0.588932  v_Recall: 0.542995  v_F1: 0.565031  v_AUC: 0.837042
steps 2200    running time 100 seconds

steps 2400    base_loss: 0.330333    reg_loss: 0.067178    l2_loss: 0.013727    loss: 0.411238
steps 2400    v_Prec: 0.608873  v_Recall: 0.554782  v_F1: 0.580570  v_AUC: 0.847096
steps 2400    running time 107 seconds

steps 2600    base_loss: 0.321152    reg_loss: 0.067183    l2_loss: 0.013904    loss: 0.402239
steps 2600    v_Prec: 0.606051  v_Recall: 0.592675  v_F1: 0.599288  v_AUC: 0.856354
steps 2600    running time 113 seconds

steps 2800    base_loss: 0.317979    reg_loss: 0.067462    l2_loss: 0.014140    loss: 0.399582
steps 2800    v_Prec: 0.638527  v_Recall: 0.585792  v_F1: 0.611024  v_AUC: 0.863253
steps 2800    running time 119 seconds

steps 3000    base_loss: 0.308355    reg_loss: 0.067403    l2_loss: 0.014397    loss: 0.390154
steps 3000    v_Prec: 0.625637  v_Recall: 0.611581  v_F1: 0.618529  v_AUC: 0.869610
steps 3000    running time 126 seconds

steps 3200    base_loss: 0.302071    reg_loss: 0.067737    l2_loss: 0.014727    loss: 0.384535
steps 3200    v_Prec: 0.640033  v_Recall: 0.618464  v_F1: 0.629063  v_AUC: 0.875148
steps 3200    running time 132 seconds

steps 3400    base_loss: 0.294133    reg_loss: 0.067683    l2_loss: 0.015048    loss: 0.376863
steps 3400    v_Prec: 0.668531  v_Recall: 0.605015  v_F1: 0.635190  v_AUC: 0.880195
steps 3400    running time 138 seconds

steps 3600    base_loss: 0.299516    reg_loss: 0.067514    l2_loss: 0.015374    loss: 0.382403
steps 3600    v_Prec: 0.671456  v_Recall: 0.617435  v_F1: 0.643313  v_AUC: 0.884635
steps 3600    running time 144 seconds

steps 3800    base_loss: 0.289417    reg_loss: 0.067673    l2_loss: 0.015746    loss: 0.372836
steps 3800    v_Prec: 0.676435  v_Recall: 0.617198  v_F1: 0.645460  v_AUC: 0.887692
steps 3800    running time 150 seconds

steps 4000    base_loss: 0.286900    reg_loss: 0.067588    l2_loss: 0.016098    loss: 0.370587
steps 4000    v_Prec: 0.656571  v_Recall: 0.643066  v_F1: 0.649748  v_AUC: 0.889691
steps 4000    running time 157 seconds

steps 4200    base_loss: 0.285724    reg_loss: 0.067444    l2_loss: 0.016604    loss: 0.369772
steps 4200    v_Prec: 0.655175  v_Recall: 0.644965  v_F1: 0.650030  v_AUC: 0.891366
steps 4200    running time 162 seconds

steps 4400    base_loss: 0.286653    reg_loss: 0.067573    l2_loss: 0.017026    loss: 0.371253
steps 4400    v_Prec: 0.671061  v_Recall: 0.644253  v_F1: 0.657384  v_AUC: 0.894423
steps 4400    running time 168 seconds

steps 4600    base_loss: 0.274102    reg_loss: 0.067362    l2_loss: 0.017377    loss: 0.358842
steps 4600    v_Prec: 0.696757  v_Recall: 0.620362  v_F1: 0.656344  v_AUC: 0.894706
steps 4600    running time 174 seconds

steps 4800    base_loss: 0.273224    reg_loss: 0.067226    l2_loss: 0.017946    loss: 0.358397
steps 4800    v_Prec: 0.681395  v_Recall: 0.636817  v_F1: 0.658352  v_AUC: 0.896635
steps 4800    running time 179 seconds

steps 5000    base_loss: 0.284340    reg_loss: 0.067401    l2_loss: 0.018520    loss: 0.370262
steps 5000    v_Prec: 0.675071  v_Recall: 0.656594  v_F1: 0.665704  v_AUC: 0.898048
steps 5000    running time 185 seconds

steps 5200    base_loss: 0.276827    reg_loss: 0.067538    l2_loss: 0.019058    loss: 0.363424
steps 5200    v_Prec: 0.680157  v_Recall: 0.656752  v_F1: 0.668250  v_AUC: 0.899120
steps 5200    running time 191 seconds

steps 5400    base_loss: 0.269494    reg_loss: 0.067116    l2_loss: 0.019670    loss: 0.356280
steps 5400    v_Prec: 0.674488  v_Recall: 0.664030  v_F1: 0.669218  v_AUC: 0.901117
steps 5400    running time 197 seconds

steps 5600    base_loss: 0.196364    reg_loss: 0.067247    l2_loss: 0.020531    loss: 0.284141
steps 5600    v_Prec: 0.677281  v_Recall: 0.649474  v_F1: 0.663086  v_AUC: 0.897075
steps 5600    running time 203 seconds

steps 5800    base_loss: 0.181036    reg_loss: 0.067595    l2_loss: 0.021365    loss: 0.269996
steps 5800    v_Prec: 0.680489  v_Recall: 0.625742  v_F1: 0.651968  v_AUC: 0.892575
steps 5800    running time 209 seconds

steps 6000    base_loss: 0.192398    reg_loss: 0.067466    l2_loss: 0.022192    loss: 0.282056
steps 6000    v_Prec: 0.635049  v_Recall: 0.666799  v_F1: 0.650536  v_AUC: 0.891629
steps 6000    running time 215 seconds

steps 6200    base_loss: 0.198765    reg_loss: 0.067361    l2_loss: 0.022766    loss: 0.288892
steps 6200    v_Prec: 0.658996  v_Recall: 0.661498  v_F1: 0.660245  v_AUC: 0.894586
steps 6200    running time 221 seconds

steps 6400    base_loss: 0.201975    reg_loss: 0.067363    l2_loss: 0.023294    loss: 0.292632
steps 6400    v_Prec: 0.698624  v_Recall: 0.630646  v_F1: 0.662897  v_AUC: 0.894725
steps 6400    running time 227 seconds

steps 6600    base_loss: 0.187915    reg_loss: 0.067227    l2_loss: 0.023799    loss: 0.278941
steps 6600    v_Prec: 0.679593  v_Recall: 0.644648  v_F1: 0.661660  v_AUC: 0.893885
steps 6600    running time 233 seconds

steps 6800    base_loss: 0.191693    reg_loss: 0.067610    l2_loss: 0.024319    loss: 0.283621
steps 6800    v_Prec: 0.670839  v_Recall: 0.661340  v_F1: 0.666056  v_AUC: 0.896591
steps 6800    running time 239 seconds

steps 7000    base_loss: 0.190701    reg_loss: 0.067435    l2_loss: 0.024688    loss: 0.282824
steps 7000    v_Prec: 0.679744  v_Recall: 0.655170  v_F1: 0.667231  v_AUC: 0.897625
steps 7000    running time 245 seconds

steps 7200    base_loss: 0.205236    reg_loss: 0.067450    l2_loss: 0.025074    loss: 0.297760
steps 7200    v_Prec: 0.704103  v_Recall: 0.646231  v_F1: 0.673926  v_AUC: 0.900140
steps 7200    running time 251 seconds

steps 7400    base_loss: 0.201340    reg_loss: 0.067216    l2_loss: 0.025503    loss: 0.294059
steps 7400    v_Prec: 0.691746  v_Recall: 0.652401  v_F1: 0.671498  v_AUC: 0.899978
steps 7400    running time 257 seconds

steps 7600    base_loss: 0.201404    reg_loss: 0.067064    l2_loss: 0.025690    loss: 0.294159
steps 7600    v_Prec: 0.713468  v_Recall: 0.650819  v_F1: 0.680705  v_AUC: 0.903265
steps 7600    running time 263 seconds

steps 7800    base_loss: 0.199336    reg_loss: 0.067256    l2_loss: 0.025995    loss: 0.292587
steps 7800    v_Prec: 0.692943  v_Recall: 0.670358  v_F1: 0.681464  v_AUC: 0.903805
steps 7800    running time 269 seconds

steps 8000    base_loss: 0.205796    reg_loss: 0.066970    l2_loss: 0.026188    loss: 0.298955
steps 8000    v_Prec: 0.688538  v_Recall: 0.675738  v_F1: 0.682078  v_AUC: 0.904421
steps 8000    running time 275 seconds

steps 8200    base_loss: 0.202807    reg_loss: 0.066967    l2_loss: 0.026526    loss: 0.296300
steps 8200    v_Prec: 0.732048  v_Recall: 0.645993  v_F1: 0.686334  v_AUC: 0.906488
steps 8200    running time 281 seconds

steps 8400    base_loss: 0.198422    reg_loss: 0.067285    l2_loss: 0.026882    loss: 0.292588
steps 8400    v_Prec: 0.705167  v_Recall: 0.669409  v_F1: 0.686823  v_AUC: 0.907961
steps 8400    running time 287 seconds

steps 8600    base_loss: 0.195233    reg_loss: 0.067081    l2_loss: 0.027155    loss: 0.289469
steps 8600    v_Prec: 0.711122  v_Recall: 0.670675  v_F1: 0.690307  v_AUC: 0.908665
steps 8600    running time 293 seconds

steps 8800    base_loss: 0.200789    reg_loss: 0.066727    l2_loss: 0.027483    loss: 0.295000
steps 8800    v_Prec: 0.708029  v_Recall: 0.681592  v_F1: 0.694559  v_AUC: 0.911432
steps 8800    running time 300 seconds

steps 9000    base_loss: 0.193685    reg_loss: 0.066792    l2_loss: 0.027532    loss: 0.288009
steps 9000    v_Prec: 0.726032  v_Recall: 0.669172  v_F1: 0.696443  v_AUC: 0.911024
steps 9000    running time 306 seconds

steps 9200    base_loss: 0.205399    reg_loss: 0.066863    l2_loss: 0.027757    loss: 0.300018
steps 9200    v_Prec: 0.702911  v_Recall: 0.699074  v_F1: 0.700988  v_AUC: 0.914272
steps 9200    running time 312 seconds

steps 9400    base_loss: 0.199954    reg_loss: 0.066722    l2_loss: 0.028044    loss: 0.294720
steps 9400    v_Prec: 0.732221  v_Recall: 0.673602  v_F1: 0.701689  v_AUC: 0.913286
steps 9400    running time 318 seconds

steps 9600    base_loss: 0.193727    reg_loss: 0.066458    l2_loss: 0.028218    loss: 0.288403
steps 9600    v_Prec: 0.726162  v_Recall: 0.686180  v_F1: 0.705605  v_AUC: 0.914879
steps 9600    running time 324 seconds

steps 9800    base_loss: 0.195538    reg_loss: 0.066658    l2_loss: 0.028505    loss: 0.290701
steps 9800    v_Prec: 0.728276  v_Recall: 0.688870  v_F1: 0.708025  v_AUC: 0.915954
steps 9800    running time 331 seconds

steps 10000    base_loss: 0.193972    reg_loss: 0.066578    l2_loss: 0.028684    loss: 0.289235
steps 10000    v_Prec: 0.725630  v_Recall: 0.692509  v_F1: 0.708682  v_AUC: 0.917199
steps 10000    running time 337 seconds

steps 10200    base_loss: 0.196477    reg_loss: 0.066323    l2_loss: 0.028827    loss: 0.291627
steps 10200    v_Prec: 0.719367  v_Recall: 0.708726  v_F1: 0.714007  v_AUC: 0.918820
steps 10200    running time 343 seconds

steps 10400    base_loss: 0.194626    reg_loss: 0.066390    l2_loss: 0.028849    loss: 0.289865
steps 10400    v_Prec: 0.757247  v_Recall: 0.690214  v_F1: 0.722179  v_AUC: 0.920517
steps 10400    running time 350 seconds

steps 10600    base_loss: 0.188387    reg_loss: 0.066226    l2_loss: 0.029169    loss: 0.283781
steps 10600    v_Prec: 0.757359  v_Recall: 0.677794  v_F1: 0.715371  v_AUC: 0.919238
steps 10600    running time 357 seconds

steps 10800    base_loss: 0.181704    reg_loss: 0.066430    l2_loss: 0.029236    loss: 0.277369
steps 10800    v_Prec: 0.758943  v_Recall: 0.681433  v_F1: 0.718103  v_AUC: 0.920370
steps 10800    running time 363 seconds

steps 11000    base_loss: 0.090004    reg_loss: 0.065333    l2_loss: 0.029592    loss: 0.184929
steps 11000    v_Prec: 0.739223  v_Recall: 0.661973  v_F1: 0.698468  v_AUC: 0.910551
steps 11000    running time 369 seconds

steps 11200    base_loss: 0.095182    reg_loss: 0.065422    l2_loss: 0.029783    loss: 0.190387
steps 11200    v_Prec: 0.711224  v_Recall: 0.674709  v_F1: 0.692486  v_AUC: 0.907768
steps 11200    running time 374 seconds

steps 11400    base_loss: 0.094153    reg_loss: 0.065218    l2_loss: 0.029843    loss: 0.189214
steps 11400    v_Prec: 0.709321  v_Recall: 0.674867  v_F1: 0.691665  v_AUC: 0.907530
steps 11400    running time 380 seconds

steps 11600    base_loss: 0.094410    reg_loss: 0.065126    l2_loss: 0.029968    loss: 0.189504
steps 11600    v_Prec: 0.709547  v_Recall: 0.651452  v_F1: 0.679259  v_AUC: 0.903794
steps 11600    running time 386 seconds

steps 11800    base_loss: 0.099437    reg_loss: 0.065139    l2_loss: 0.030172    loss: 0.194747
steps 11800    v_Prec: 0.702712  v_Recall: 0.666245  v_F1: 0.683993  v_AUC: 0.902637
steps 11800    running time 392 seconds

steps 12000    base_loss: 0.098255    reg_loss: 0.065109    l2_loss: 0.030281    loss: 0.193645
steps 12000    v_Prec: 0.694309  v_Recall: 0.664979  v_F1: 0.679328  v_AUC: 0.901310
steps 12000    running time 398 seconds

steps 12200    base_loss: 0.100800    reg_loss: 0.065206    l2_loss: 0.030387    loss: 0.196394
steps 12200    v_Prec: 0.703430  v_Recall: 0.661973  v_F1: 0.682072  v_AUC: 0.902713
steps 12200    running time 404 seconds

steps 12400    base_loss: 0.101978    reg_loss: 0.065371    l2_loss: 0.030496    loss: 0.197845
steps 12400    v_Prec: 0.696329  v_Recall: 0.661736  v_F1: 0.678592  v_AUC: 0.899498
steps 12400    running time 410 seconds

Early stop model F1: 0.722179
testing thre: 0.31160086
testing Prec: 0.5540928584747343
testing Recall: 0.722138517618469
testing F1: 0.6270521207005697
testing AUC: 0.8934916242234325
overall running time 413 seconds
(0.6708781781313368, 0.6271202916160389, 0.648261655948553, 0.8934916242234325, 0.53144044)

2019-02-24 00:42:23.207521: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:42:24.351748: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:42:24.352633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:42:24.352670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.340000 seconds
loading data in 30.490000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.665301    reg_loss: 0.064865    l2_loss: 0.013339    loss: 0.743505
steps 200    v_Prec: 0.166540  v_Recall: 0.939466  v_F1: 0.282925  v_AUC: 0.523942
steps 200    running time 40 seconds

steps 400    base_loss: 0.524927    reg_loss: 0.064656    l2_loss: 0.013413    loss: 0.602996
steps 400    v_Prec: 0.169365  v_Recall: 0.880759  v_F1: 0.284100  v_AUC: 0.536610
steps 400    running time 47 seconds

steps 600    base_loss: 0.491657    reg_loss: 0.064471    l2_loss: 0.013336    loss: 0.569464
steps 600    v_Prec: 0.181510  v_Recall: 0.758341  v_F1: 0.292912  v_AUC: 0.577501
steps 600    running time 53 seconds

steps 800    base_loss: 0.464747    reg_loss: 0.064252    l2_loss: 0.013241    loss: 0.542240
steps 800    v_Prec: 0.202536  v_Recall: 0.619241  v_F1: 0.305237  v_AUC: 0.599271
steps 800    running time 58 seconds

steps 1000    base_loss: 0.445745    reg_loss: 0.063614    l2_loss: 0.013259    loss: 0.522619
steps 1000    v_Prec: 0.237520  v_Recall: 0.501192  v_F1: 0.322299  v_AUC: 0.629608
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.437843    reg_loss: 0.063036    l2_loss: 0.013238    loss: 0.514117
steps 1200    v_Prec: 0.291887  v_Recall: 0.505005  v_F1: 0.369948  v_AUC: 0.680045
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.419253    reg_loss: 0.062369    l2_loss: 0.013284    loss: 0.494906
steps 1400    v_Prec: 0.408440  v_Recall: 0.430569  v_F1: 0.419213  v_AUC: 0.723223
steps 1400    running time 77 seconds

steps 1600    base_loss: 0.395358    reg_loss: 0.061682    l2_loss: 0.013451    loss: 0.470490
steps 1600    v_Prec: 0.506089  v_Recall: 0.468780  v_F1: 0.486721  v_AUC: 0.769203
steps 1600    running time 84 seconds

steps 1800    base_loss: 0.369997    reg_loss: 0.060888    l2_loss: 0.013579    loss: 0.444464
steps 1800    v_Prec: 0.559497  v_Recall: 0.508738  v_F1: 0.532912  v_AUC: 0.800103
steps 1800    running time 90 seconds

steps 2000    base_loss: 0.347113    reg_loss: 0.060376    l2_loss: 0.013803    loss: 0.421292
steps 2000    v_Prec: 0.603064  v_Recall: 0.537814  v_F1: 0.568573  v_AUC: 0.823327
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.331448    reg_loss: 0.059619    l2_loss: 0.013991    loss: 0.405057
steps 2200    v_Prec: 0.660462  v_Recall: 0.535589  v_F1: 0.591507  v_AUC: 0.839513
steps 2200    running time 102 seconds

steps 2400    base_loss: 0.324664    reg_loss: 0.059216    l2_loss: 0.014287    loss: 0.398166
steps 2400    v_Prec: 0.653809  v_Recall: 0.584366  v_F1: 0.617140  v_AUC: 0.850659
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.311035    reg_loss: 0.058683    l2_loss: 0.014390    loss: 0.384107
steps 2600    v_Prec: 0.669228  v_Recall: 0.595011  v_F1: 0.629941  v_AUC: 0.859192
steps 2600    running time 114 seconds

steps 2800    base_loss: 0.304470    reg_loss: 0.058203    l2_loss: 0.014628    loss: 0.377301
steps 2800    v_Prec: 0.706224  v_Recall: 0.588576  v_F1: 0.642056  v_AUC: 0.866238
steps 2800    running time 121 seconds

steps 3000    base_loss: 0.309408    reg_loss: 0.057809    l2_loss: 0.014740    loss: 0.381958
steps 3000    v_Prec: 0.713502  v_Recall: 0.599460  v_F1: 0.651528  v_AUC: 0.871850
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.296522    reg_loss: 0.057381    l2_loss: 0.014979    loss: 0.368883
steps 3200    v_Prec: 0.714457  v_Recall: 0.616381  v_F1: 0.661805  v_AUC: 0.877317
steps 3200    running time 133 seconds

steps 3400    base_loss: 0.286259    reg_loss: 0.057075    l2_loss: 0.015180    loss: 0.358513
steps 3400    v_Prec: 0.714793  v_Recall: 0.623371  v_F1: 0.665959  v_AUC: 0.880958
steps 3400    running time 139 seconds

steps 3600    base_loss: 0.285391    reg_loss: 0.056780    l2_loss: 0.015293    loss: 0.357464
steps 3600    v_Prec: 0.726433  v_Recall: 0.624404  v_F1: 0.671565  v_AUC: 0.884892
steps 3600    running time 146 seconds

steps 3800    base_loss: 0.277626    reg_loss: 0.056330    l2_loss: 0.015482    loss: 0.349438
steps 3800    v_Prec: 0.722810  v_Recall: 0.639895  v_F1: 0.678830  v_AUC: 0.888136
steps 3800    running time 152 seconds

steps 4000    base_loss: 0.272514    reg_loss: 0.056124    l2_loss: 0.015763    loss: 0.344402
steps 4000    v_Prec: 0.714113  v_Recall: 0.658008  v_F1: 0.684913  v_AUC: 0.892997
steps 4000    running time 158 seconds

steps 4200    base_loss: 0.269708    reg_loss: 0.055820    l2_loss: 0.015962    loss: 0.341489
steps 4200    v_Prec: 0.704682  v_Recall: 0.671989  v_F1: 0.687947  v_AUC: 0.895344
steps 4200    running time 165 seconds

steps 4400    base_loss: 0.271389    reg_loss: 0.055657    l2_loss: 0.016309    loss: 0.343355
steps 4400    v_Prec: 0.706194  v_Recall: 0.666587  v_F1: 0.685819  v_AUC: 0.896399
steps 4400    running time 171 seconds

steps 4600    base_loss: 0.271533    reg_loss: 0.055533    l2_loss: 0.016623    loss: 0.343690
steps 4600    v_Prec: 0.729801  v_Recall: 0.656578  v_F1: 0.691256  v_AUC: 0.898275
steps 4600    running time 177 seconds

steps 4800    base_loss: 0.264408    reg_loss: 0.055174    l2_loss: 0.016939    loss: 0.336521
steps 4800    v_Prec: 0.722498  v_Recall: 0.670956  v_F1: 0.695774  v_AUC: 0.901968
steps 4800    running time 183 seconds

steps 5000    base_loss: 0.266313    reg_loss: 0.054990    l2_loss: 0.017395    loss: 0.338698
steps 5000    v_Prec: 0.723310  v_Recall: 0.674929  v_F1: 0.698282  v_AUC: 0.903380
steps 5000    running time 189 seconds

steps 5200    base_loss: 0.260075    reg_loss: 0.054838    l2_loss: 0.017759    loss: 0.332672
steps 5200    v_Prec: 0.754838  v_Recall: 0.647680  v_F1: 0.697165  v_AUC: 0.903876
steps 5200    running time 195 seconds

steps 5400    base_loss: 0.261343    reg_loss: 0.054188    l2_loss: 0.018086    loss: 0.333617
steps 5400    v_Prec: 0.730512  v_Recall: 0.675961  v_F1: 0.702179  v_AUC: 0.905113
steps 5400    running time 201 seconds

steps 5600    base_loss: 0.162631    reg_loss: 0.049329    l2_loss: 0.018648    loss: 0.230608
steps 5600    v_Prec: 0.742616  v_Recall: 0.665157  v_F1: 0.701756  v_AUC: 0.900322
steps 5600    running time 208 seconds

steps 5800    base_loss: 0.182426    reg_loss: 0.050289    l2_loss: 0.019387    loss: 0.252102
steps 5800    v_Prec: 0.745059  v_Recall: 0.655863  v_F1: 0.697621  v_AUC: 0.900391
steps 5800    running time 214 seconds

steps 6000    base_loss: 0.185921    reg_loss: 0.049813    l2_loss: 0.019994    loss: 0.255729
steps 6000    v_Prec: 0.737926  v_Recall: 0.668812  v_F1: 0.701671  v_AUC: 0.902134
steps 6000    running time 220 seconds

steps 6200    base_loss: 0.177454    reg_loss: 0.049271    l2_loss: 0.020482    loss: 0.247207
steps 6200    v_Prec: 0.736302  v_Recall: 0.672545  v_F1: 0.702981  v_AUC: 0.901048
steps 6200    running time 225 seconds

steps 6400    base_loss: 0.187404    reg_loss: 0.049618    l2_loss: 0.020927    loss: 0.257949
steps 6400    v_Prec: 0.735758  v_Recall: 0.678186  v_F1: 0.705800  v_AUC: 0.900703
steps 6400    running time 231 seconds

steps 6600    base_loss: 0.193655    reg_loss: 0.049803    l2_loss: 0.021373    loss: 0.264831
steps 6600    v_Prec: 0.753918  v_Recall: 0.664919  v_F1: 0.706627  v_AUC: 0.902384
steps 6600    running time 238 seconds

steps 6800    base_loss: 0.182473    reg_loss: 0.048943    l2_loss: 0.021707    loss: 0.253122
steps 6800    v_Prec: 0.754501  v_Recall: 0.669209  v_F1: 0.709300  v_AUC: 0.903301
steps 6800    running time 244 seconds

steps 7000    base_loss: 0.180105    reg_loss: 0.048629    l2_loss: 0.022115    loss: 0.250849
steps 7000    v_Prec: 0.741326  v_Recall: 0.682316  v_F1: 0.710598  v_AUC: 0.905344
steps 7000    running time 250 seconds

steps 7200    base_loss: 0.187308    reg_loss: 0.048781    l2_loss: 0.022381    loss: 0.258471
steps 7200    v_Prec: 0.744259  v_Recall: 0.679695  v_F1: 0.710513  v_AUC: 0.904720
steps 7200    running time 256 seconds

steps 7400    base_loss: 0.198150    reg_loss: 0.049006    l2_loss: 0.022496    loss: 0.269653
steps 7400    v_Prec: 0.764674  v_Recall: 0.664442  v_F1: 0.711043  v_AUC: 0.905521
steps 7400    running time 262 seconds

steps 7600    base_loss: 0.182053    reg_loss: 0.048346    l2_loss: 0.022786    loss: 0.253185
steps 7600    v_Prec: 0.749826  v_Recall: 0.683588  v_F1: 0.715176  v_AUC: 0.906838
steps 7600    running time 268 seconds

steps 7800    base_loss: 0.196825    reg_loss: 0.048452    l2_loss: 0.022967    loss: 0.268244
steps 7800    v_Prec: 0.755857  v_Recall: 0.686924  v_F1: 0.719744  v_AUC: 0.909019
steps 7800    running time 275 seconds

steps 8000    base_loss: 0.190392    reg_loss: 0.048180    l2_loss: 0.023227    loss: 0.261799
steps 8000    v_Prec: 0.762083  v_Recall: 0.680172  v_F1: 0.718801  v_AUC: 0.908020
steps 8000    running time 281 seconds

steps 8200    base_loss: 0.191015    reg_loss: 0.048346    l2_loss: 0.023287    loss: 0.262648
steps 8200    v_Prec: 0.768906  v_Recall: 0.680092  v_F1: 0.721777  v_AUC: 0.909611
steps 8200    running time 288 seconds

steps 8400    base_loss: 0.191343    reg_loss: 0.047950    l2_loss: 0.023498    loss: 0.262791
steps 8400    v_Prec: 0.766168  v_Recall: 0.687957  v_F1: 0.724959  v_AUC: 0.910449
steps 8400    running time 294 seconds

steps 8600    base_loss: 0.195635    reg_loss: 0.047741    l2_loss: 0.023532    loss: 0.266909
steps 8600    v_Prec: 0.767079  v_Recall: 0.690419  v_F1: 0.726733  v_AUC: 0.913415
steps 8600    running time 301 seconds

steps 8800    base_loss: 0.194202    reg_loss: 0.047332    l2_loss: 0.023789    loss: 0.265324
steps 8800    v_Prec: 0.753094  v_Recall: 0.705831  v_F1: 0.728697  v_AUC: 0.915012
steps 8800    running time 307 seconds

steps 9000    base_loss: 0.193643    reg_loss: 0.047400    l2_loss: 0.023798    loss: 0.264841
steps 9000    v_Prec: 0.758735  v_Recall: 0.707261  v_F1: 0.732094  v_AUC: 0.916096
steps 9000    running time 313 seconds

steps 9200    base_loss: 0.195326    reg_loss: 0.047126    l2_loss: 0.023894    loss: 0.266346
steps 9200    v_Prec: 0.761176  v_Recall: 0.707420  v_F1: 0.733314  v_AUC: 0.915128
steps 9200    running time 320 seconds

steps 9400    base_loss: 0.196087    reg_loss: 0.047071    l2_loss: 0.024059    loss: 0.267217
steps 9400    v_Prec: 0.762786  v_Recall: 0.703765  v_F1: 0.732088  v_AUC: 0.917515
steps 9400    running time 326 seconds

steps 9600    base_loss: 0.192766    reg_loss: 0.046781    l2_loss: 0.024006    loss: 0.263554
steps 9600    v_Prec: 0.768690  v_Recall: 0.703289  v_F1: 0.734536  v_AUC: 0.917712
steps 9600    running time 333 seconds

steps 9800    base_loss: 0.188730    reg_loss: 0.046886    l2_loss: 0.024036    loss: 0.259652
steps 9800    v_Prec: 0.771484  v_Recall: 0.701065  v_F1: 0.734590  v_AUC: 0.920058
steps 9800    running time 339 seconds

steps 10000    base_loss: 0.195355    reg_loss: 0.046719    l2_loss: 0.024204    loss: 0.266278
steps 10000    v_Prec: 0.779471  v_Recall: 0.694948  v_F1: 0.734786  v_AUC: 0.919666
steps 10000    running time 345 seconds

steps 10200    base_loss: 0.192222    reg_loss: 0.046436    l2_loss: 0.024281    loss: 0.262940
steps 10200    v_Prec: 0.767112  v_Recall: 0.712266  v_F1: 0.738672  v_AUC: 0.920753
steps 10200    running time 351 seconds

steps 10400    base_loss: 0.189665    reg_loss: 0.046255    l2_loss: 0.024252    loss: 0.260172
steps 10400    v_Prec: 0.770264  v_Recall: 0.710359  v_F1: 0.739100  v_AUC: 0.921705
steps 10400    running time 357 seconds

steps 10600    base_loss: 0.192540    reg_loss: 0.046238    l2_loss: 0.024417    loss: 0.263195
steps 10600    v_Prec: 0.790077  v_Recall: 0.695742  v_F1: 0.739915  v_AUC: 0.922684
steps 10600    running time 363 seconds

steps 10800    base_loss: 0.185902    reg_loss: 0.045638    l2_loss: 0.024433    loss: 0.255974
steps 10800    v_Prec: 0.766661  v_Recall: 0.718303  v_F1: 0.741695  v_AUC: 0.922928
steps 10800    running time 370 seconds

steps 11000    base_loss: 0.083446    reg_loss: 0.040852    l2_loss: 0.024566    loss: 0.148865
steps 11000    v_Prec: 0.774278  v_Recall: 0.703051  v_F1: 0.736947  v_AUC: 0.918731
steps 11000    running time 376 seconds

steps 11200    base_loss: 0.083171    reg_loss: 0.040933    l2_loss: 0.024481    loss: 0.148585
steps 11200    v_Prec: 0.793941  v_Recall: 0.682873  v_F1: 0.734230  v_AUC: 0.917720
steps 11200    running time 382 seconds

steps 11400    base_loss: 0.083127    reg_loss: 0.041316    l2_loss: 0.024680    loss: 0.149123
steps 11400    v_Prec: 0.759057  v_Recall: 0.705752  v_F1: 0.731434  v_AUC: 0.915262
steps 11400    running time 388 seconds

steps 11600    base_loss: 0.081786    reg_loss: 0.041093    l2_loss: 0.024676    loss: 0.147555
steps 11600    v_Prec: 0.771436  v_Recall: 0.701144  v_F1: 0.734612  v_AUC: 0.916138
steps 11600    running time 394 seconds

steps 11800    base_loss: 0.079882    reg_loss: 0.041391    l2_loss: 0.024741    loss: 0.146013
steps 11800    v_Prec: 0.783118  v_Recall: 0.689863  v_F1: 0.733539  v_AUC: 0.916019
steps 11800    running time 400 seconds

steps 12000    base_loss: 0.086580    reg_loss: 0.041537    l2_loss: 0.024618    loss: 0.152735
steps 12000    v_Prec: 0.772211  v_Recall: 0.696695  v_F1: 0.732512  v_AUC: 0.915576
steps 12000    running time 406 seconds

steps 12200    base_loss: 0.087901    reg_loss: 0.041378    l2_loss: 0.024683    loss: 0.153962
steps 12200    v_Prec: 0.771973  v_Recall: 0.694948  v_F1: 0.731438  v_AUC: 0.915256
steps 12200    running time 412 seconds

steps 12400    base_loss: 0.085950    reg_loss: 0.041494    l2_loss: 0.024596    loss: 0.152041
steps 12400    v_Prec: 0.754035  v_Recall: 0.708929  v_F1: 0.730787  v_AUC: 0.914961
steps 12400    running time 418 seconds

steps 12600    base_loss: 0.086490    reg_loss: 0.041456    l2_loss: 0.024678    loss: 0.152624
steps 12600    v_Prec: 0.760918  v_Recall: 0.703130  v_F1: 0.730884  v_AUC: 0.914747
steps 12600    running time 425 seconds

steps 12800    base_loss: 0.091007    reg_loss: 0.041296    l2_loss: 0.024652    loss: 0.156955
steps 12800    v_Prec: 0.761094  v_Recall: 0.703051  v_F1: 0.730922  v_AUC: 0.916059
steps 12800    running time 431 seconds

Early stop model F1: 0.741695
testing thre: 0.4951845
testing Prec: 0.5667910034346494
testing Recall: 0.7459052247873633
testing F1: 0.6441282632418367
testing AUC: 0.8935698653677451
overall running time 434 seconds
(0.6941638314577335, 0.6445686512758202, 0.6684475806451612, 0.8935698653677451, 0.787933)

2019-02-24 00:47:13.085994: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:47:13.553537: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:47:13.555051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:47:13.555091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.140000 seconds
loading data in 30.220000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	32
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.756634    reg_loss: 0.064715    l2_loss: 0.013277    loss: 0.834625
steps 200    v_Prec: 0.163292  v_Recall: 1.000000  v_F1: 0.280741  v_AUC: 0.488890
steps 200    running time 40 seconds

steps 400    base_loss: 0.555164    reg_loss: 0.064937    l2_loss: 0.013100    loss: 0.633201
steps 400    v_Prec: 0.163292  v_Recall: 1.000000  v_F1: 0.280741  v_AUC: 0.504564
steps 400    running time 46 seconds

steps 600    base_loss: 0.502221    reg_loss: 0.064914    l2_loss: 0.012890    loss: 0.580024
steps 600    v_Prec: 0.165683  v_Recall: 0.937435  v_F1: 0.281596  v_AUC: 0.536670
steps 600    running time 52 seconds

steps 800    base_loss: 0.483676    reg_loss: 0.064861    l2_loss: 0.012753    loss: 0.561290
steps 800    v_Prec: 0.163360  v_Recall: 0.999281  v_F1: 0.280813  v_AUC: 0.540307
steps 800    running time 58 seconds

steps 1000    base_loss: 0.455666    reg_loss: 0.064613    l2_loss: 0.012665    loss: 0.532943
steps 1000    v_Prec: 0.194476  v_Recall: 0.571634  v_F1: 0.290217  v_AUC: 0.581128
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.443856    reg_loss: 0.064709    l2_loss: 0.012691    loss: 0.521257
steps 1200    v_Prec: 0.269073  v_Recall: 0.398482  v_F1: 0.321234  v_AUC: 0.619549
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.428841    reg_loss: 0.064757    l2_loss: 0.012721    loss: 0.506320
steps 1400    v_Prec: 0.341716  v_Recall: 0.400639  v_F1: 0.368839  v_AUC: 0.668715
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.411705    reg_loss: 0.064771    l2_loss: 0.012846    loss: 0.489322
steps 1600    v_Prec: 0.430420  v_Recall: 0.425330  v_F1: 0.427859  v_AUC: 0.719065
steps 1600    running time 83 seconds

steps 1800    base_loss: 0.382820    reg_loss: 0.064554    l2_loss: 0.013046    loss: 0.460420
steps 1800    v_Prec: 0.542346  v_Recall: 0.430843  v_F1: 0.480207  v_AUC: 0.754440
steps 1800    running time 89 seconds

steps 2000    base_loss: 0.370187    reg_loss: 0.064739    l2_loss: 0.013258    loss: 0.448184
steps 2000    v_Prec: 0.555045  v_Recall: 0.483020  v_F1: 0.516534  v_AUC: 0.780706
steps 2000    running time 96 seconds

steps 2200    base_loss: 0.352648    reg_loss: 0.064456    l2_loss: 0.013480    loss: 0.430584
steps 2200    v_Prec: 0.585919  v_Recall: 0.516021  v_F1: 0.548753  v_AUC: 0.804077
steps 2200    running time 102 seconds

steps 2400    base_loss: 0.340906    reg_loss: 0.064814    l2_loss: 0.013642    loss: 0.419362
steps 2400    v_Prec: 0.651795  v_Recall: 0.507791  v_F1: 0.570851  v_AUC: 0.819025
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.327270    reg_loss: 0.064685    l2_loss: 0.013856    loss: 0.405811
steps 2600    v_Prec: 0.656636  v_Recall: 0.526568  v_F1: 0.584453  v_AUC: 0.830345
steps 2600    running time 115 seconds

steps 2800    base_loss: 0.322174    reg_loss: 0.064833    l2_loss: 0.014144    loss: 0.401151
steps 2800    v_Prec: 0.678819  v_Recall: 0.540072  v_F1: 0.601549  v_AUC: 0.838354
steps 2800    running time 121 seconds

steps 3000    base_loss: 0.307812    reg_loss: 0.064928    l2_loss: 0.014451    loss: 0.387191
steps 3000    v_Prec: 0.693050  v_Recall: 0.550619  v_F1: 0.613679  v_AUC: 0.846646
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.310786    reg_loss: 0.064900    l2_loss: 0.014679    loss: 0.390365
steps 3200    v_Prec: 0.651407  v_Recall: 0.590092  v_F1: 0.619235  v_AUC: 0.854090
steps 3200    running time 133 seconds

steps 3400    base_loss: 0.296041    reg_loss: 0.064877    l2_loss: 0.014952    loss: 0.375870
steps 3400    v_Prec: 0.669957  v_Recall: 0.591051  v_F1: 0.628035  v_AUC: 0.858932
steps 3400    running time 139 seconds

steps 3600    base_loss: 0.300265    reg_loss: 0.065146    l2_loss: 0.015328    loss: 0.380739
steps 3600    v_Prec: 0.686318  v_Recall: 0.597203  v_F1: 0.638667  v_AUC: 0.862343
steps 3600    running time 145 seconds

steps 3800    base_loss: 0.296988    reg_loss: 0.064859    l2_loss: 0.015639    loss: 0.377486
steps 3800    v_Prec: 0.695684  v_Recall: 0.601518  v_F1: 0.645183  v_AUC: 0.864431
steps 3800    running time 151 seconds

steps 4000    base_loss: 0.294233    reg_loss: 0.064943    l2_loss: 0.015982    loss: 0.375158
steps 4000    v_Prec: 0.736075  v_Recall: 0.584978  v_F1: 0.651885  v_AUC: 0.868912
steps 4000    running time 157 seconds

steps 4200    base_loss: 0.283969    reg_loss: 0.064837    l2_loss: 0.016373    loss: 0.365180
steps 4200    v_Prec: 0.694551  v_Recall: 0.620296  v_F1: 0.655327  v_AUC: 0.872992
steps 4200    running time 163 seconds

steps 4400    base_loss: 0.285362    reg_loss: 0.064645    l2_loss: 0.016749    loss: 0.366756
steps 4400    v_Prec: 0.693388  v_Recall: 0.631003  v_F1: 0.660726  v_AUC: 0.874629
steps 4400    running time 169 seconds

steps 4600    base_loss: 0.275925    reg_loss: 0.064549    l2_loss: 0.017152    loss: 0.357626
steps 4600    v_Prec: 0.734815  v_Recall: 0.602237  v_F1: 0.661953  v_AUC: 0.876967
steps 4600    running time 175 seconds

steps 4800    base_loss: 0.278814    reg_loss: 0.064746    l2_loss: 0.017596    loss: 0.361157
steps 4800    v_Prec: 0.726125  v_Recall: 0.620296  v_F1: 0.669051  v_AUC: 0.879631
steps 4800    running time 181 seconds

steps 5000    base_loss: 0.268438    reg_loss: 0.064552    l2_loss: 0.018144    loss: 0.351135
steps 5000    v_Prec: 0.713874  v_Recall: 0.633959  v_F1: 0.671548  v_AUC: 0.879482
steps 5000    running time 187 seconds

steps 5200    base_loss: 0.273973    reg_loss: 0.064526    l2_loss: 0.018510    loss: 0.357009
steps 5200    v_Prec: 0.730816  v_Recall: 0.627807  v_F1: 0.675406  v_AUC: 0.882279
steps 5200    running time 193 seconds

steps 5400    base_loss: 0.270526    reg_loss: 0.064339    l2_loss: 0.018917    loss: 0.353782
steps 5400    v_Prec: 0.761422  v_Recall: 0.617899  v_F1: 0.682193  v_AUC: 0.883609
steps 5400    running time 200 seconds

steps 5600    base_loss: 0.163847    reg_loss: 0.060124    l2_loss: 0.019106    loss: 0.243077
steps 5600    v_Prec: 0.736961  v_Recall: 0.624371  v_F1: 0.676010  v_AUC: 0.878174
steps 5600    running time 206 seconds

steps 5800    base_loss: 0.181447    reg_loss: 0.060870    l2_loss: 0.019345    loss: 0.261662
steps 5800    v_Prec: 0.727340  v_Recall: 0.630923  v_F1: 0.675709  v_AUC: 0.878131
steps 5800    running time 212 seconds

steps 6000    base_loss: 0.193022    reg_loss: 0.061059    l2_loss: 0.019489    loss: 0.273570
steps 6000    v_Prec: 0.733463  v_Recall: 0.634359  v_F1: 0.680320  v_AUC: 0.876526
steps 6000    running time 218 seconds

steps 6200    base_loss: 0.187931    reg_loss: 0.061425    l2_loss: 0.019863    loss: 0.269219
steps 6200    v_Prec: 0.730988  v_Recall: 0.637475  v_F1: 0.681036  v_AUC: 0.880289
steps 6200    running time 225 seconds

steps 6400    base_loss: 0.187333    reg_loss: 0.061472    l2_loss: 0.019883    loss: 0.268688
steps 6400    v_Prec: 0.766423  v_Recall: 0.612465  v_F1: 0.680849  v_AUC: 0.880222
steps 6400    running time 231 seconds

steps 6600    base_loss: 0.192499    reg_loss: 0.061463    l2_loss: 0.020114    loss: 0.274076
steps 6600    v_Prec: 0.747901  v_Recall: 0.626288  v_F1: 0.681713  v_AUC: 0.881666
steps 6600    running time 237 seconds

steps 6800    base_loss: 0.189800    reg_loss: 0.061419    l2_loss: 0.020225    loss: 0.271444
steps 6800    v_Prec: 0.761695  v_Recall: 0.620615  v_F1: 0.683956  v_AUC: 0.882083
steps 6800    running time 243 seconds

steps 7000    base_loss: 0.181265    reg_loss: 0.061079    l2_loss: 0.020358    loss: 0.262702
steps 7000    v_Prec: 0.742086  v_Recall: 0.634998  v_F1: 0.684378  v_AUC: 0.881548
steps 7000    running time 249 seconds

steps 7200    base_loss: 0.187687    reg_loss: 0.061387    l2_loss: 0.020434    loss: 0.269509
steps 7200    v_Prec: 0.726474  v_Recall: 0.653855  v_F1: 0.688254  v_AUC: 0.883682
steps 7200    running time 255 seconds

steps 7400    base_loss: 0.185003    reg_loss: 0.061467    l2_loss: 0.020599    loss: 0.267070
steps 7400    v_Prec: 0.719307  v_Recall: 0.663843  v_F1: 0.690463  v_AUC: 0.886502
steps 7400    running time 261 seconds

steps 7600    base_loss: 0.196044    reg_loss: 0.061835    l2_loss: 0.020776    loss: 0.278654
steps 7600    v_Prec: 0.745600  v_Recall: 0.646584  v_F1: 0.692571  v_AUC: 0.886563
steps 7600    running time 267 seconds

steps 7800    base_loss: 0.185202    reg_loss: 0.061605    l2_loss: 0.020943    loss: 0.267751
steps 7800    v_Prec: 0.759663  v_Recall: 0.640751  v_F1: 0.695158  v_AUC: 0.888158
steps 7800    running time 274 seconds

steps 8000    base_loss: 0.189366    reg_loss: 0.061281    l2_loss: 0.020978    loss: 0.271626
steps 8000    v_Prec: 0.773959  v_Recall: 0.638833  v_F1: 0.699934  v_AUC: 0.890598
steps 8000    running time 280 seconds

steps 8200    base_loss: 0.198026    reg_loss: 0.061761    l2_loss: 0.021120    loss: 0.280907
steps 8200    v_Prec: 0.750503  v_Recall: 0.656173  v_F1: 0.700175  v_AUC: 0.891573
steps 8200    running time 286 seconds

steps 8400    base_loss: 0.190807    reg_loss: 0.061651    l2_loss: 0.021244    loss: 0.273702
steps 8400    v_Prec: 0.739963  v_Recall: 0.673032  v_F1: 0.704913  v_AUC: 0.892662
steps 8400    running time 292 seconds

steps 8600    base_loss: 0.196641    reg_loss: 0.061512    l2_loss: 0.021376    loss: 0.279528
steps 8600    v_Prec: 0.770117  v_Recall: 0.651538  v_F1: 0.705882  v_AUC: 0.892538
steps 8600    running time 298 seconds

steps 8800    base_loss: 0.188888    reg_loss: 0.061440    l2_loss: 0.021411    loss: 0.271739
steps 8800    v_Prec: 0.748506  v_Recall: 0.670635  v_F1: 0.707434  v_AUC: 0.892792
steps 8800    running time 304 seconds

steps 9000    base_loss: 0.192168    reg_loss: 0.061370    l2_loss: 0.021419    loss: 0.274957
steps 9000    v_Prec: 0.776373  v_Recall: 0.652737  v_F1: 0.709207  v_AUC: 0.895342
steps 9000    running time 310 seconds

steps 9200    base_loss: 0.200754    reg_loss: 0.061332    l2_loss: 0.021463    loss: 0.283549
steps 9200    v_Prec: 0.768630  v_Recall: 0.660967  v_F1: 0.710745  v_AUC: 0.896379
steps 9200    running time 316 seconds

steps 9400    base_loss: 0.192948    reg_loss: 0.061248    l2_loss: 0.021582    loss: 0.275777
steps 9400    v_Prec: 0.774022  v_Recall: 0.664243  v_F1: 0.714943  v_AUC: 0.897672
steps 9400    running time 322 seconds

steps 9600    base_loss: 0.193537    reg_loss: 0.061149    l2_loss: 0.021638    loss: 0.276324
steps 9600    v_Prec: 0.773783  v_Recall: 0.665521  v_F1: 0.715581  v_AUC: 0.898124
steps 9600    running time 329 seconds

steps 9800    base_loss: 0.188295    reg_loss: 0.060921    l2_loss: 0.021637    loss: 0.270853
steps 9800    v_Prec: 0.776614  v_Recall: 0.669197  v_F1: 0.718915  v_AUC: 0.901158
steps 9800    running time 335 seconds

steps 10000    base_loss: 0.194704    reg_loss: 0.061093    l2_loss: 0.021635    loss: 0.277432
steps 10000    v_Prec: 0.802197  v_Recall: 0.653616  v_F1: 0.720324  v_AUC: 0.900616
steps 10000    running time 341 seconds

steps 10200    base_loss: 0.197321    reg_loss: 0.061456    l2_loss: 0.021733    loss: 0.280511
steps 10200    v_Prec: 0.787311  v_Recall: 0.664323  v_F1: 0.720607  v_AUC: 0.902523
steps 10200    running time 348 seconds

steps 10400    base_loss: 0.199267    reg_loss: 0.061219    l2_loss: 0.021715    loss: 0.282200
steps 10400    v_Prec: 0.768348  v_Recall: 0.679265  v_F1: 0.721065  v_AUC: 0.902830
steps 10400    running time 354 seconds

steps 10600    base_loss: 0.192988    reg_loss: 0.061221    l2_loss: 0.021793    loss: 0.276002
steps 10600    v_Prec: 0.762388  v_Recall: 0.689652  v_F1: 0.724199  v_AUC: 0.903104
steps 10600    running time 360 seconds

steps 10800    base_loss: 0.185092    reg_loss: 0.060346    l2_loss: 0.021906    loss: 0.267344
steps 10800    v_Prec: 0.752305  v_Recall: 0.697483  v_F1: 0.723858  v_AUC: 0.904352
steps 10800    running time 366 seconds

steps 11000    base_loss: 0.064856    reg_loss: 0.056073    l2_loss: 0.021581    loss: 0.142510
steps 11000    v_Prec: 0.759897  v_Recall: 0.682541  v_F1: 0.719145  v_AUC: 0.899140
steps 11000    running time 372 seconds

steps 11200    base_loss: 0.066377    reg_loss: 0.055730    l2_loss: 0.021129    loss: 0.143236
steps 11200    v_Prec: 0.773953  v_Recall: 0.662885  v_F1: 0.714126  v_AUC: 0.896212
steps 11200    running time 378 seconds

steps 11400    base_loss: 0.061113    reg_loss: 0.056339    l2_loss: 0.020718    loss: 0.138170
steps 11400    v_Prec: 0.768136  v_Recall: 0.659928  v_F1: 0.709933  v_AUC: 0.895477
steps 11400    running time 384 seconds

steps 11600    base_loss: 0.069564    reg_loss: 0.055994    l2_loss: 0.020487    loss: 0.146045
steps 11600    v_Prec: 0.758984  v_Recall: 0.668318  v_F1: 0.710771  v_AUC: 0.895505
steps 11600    running time 390 seconds

steps 11800    base_loss: 0.069452    reg_loss: 0.056029    l2_loss: 0.020140    loss: 0.145620
steps 11800    v_Prec: 0.756946  v_Recall: 0.663923  v_F1: 0.707390  v_AUC: 0.892684
steps 11800    running time 396 seconds

steps 12000    base_loss: 0.069853    reg_loss: 0.056136    l2_loss: 0.019920    loss: 0.145909
steps 12000    v_Prec: 0.749373  v_Recall: 0.668238  v_F1: 0.706484  v_AUC: 0.891343
steps 12000    running time 403 seconds

steps 12200    base_loss: 0.070539    reg_loss: 0.055958    l2_loss: 0.019607    loss: 0.146104
steps 12200    v_Prec: 0.756169  v_Recall: 0.661127  v_F1: 0.705461  v_AUC: 0.892840
steps 12200    running time 409 seconds

steps 12400    base_loss: 0.069315    reg_loss: 0.056268    l2_loss: 0.019504    loss: 0.145086
steps 12400    v_Prec: 0.753716  v_Recall: 0.664403  v_F1: 0.706247  v_AUC: 0.892746
steps 12400    running time 415 seconds

steps 12600    base_loss: 0.069218    reg_loss: 0.056148    l2_loss: 0.019299    loss: 0.144665
steps 12600    v_Prec: 0.726394  v_Recall: 0.678626  v_F1: 0.701698  v_AUC: 0.890698
steps 12600    running time 421 seconds

Early stop model F1: 0.724199
testing thre: 0.35248795
testing Prec: 0.6111209257132763
testing Recall: 0.6725151883353584
testing F1: 0.6403498623226972
testing AUC: 0.8763587311621148
overall running time 424 seconds
(0.6903225806451613, 0.6136573511543135, 0.6497362665637463, 0.8763587311621148, 0.5185095)

2019-02-24 00:52:10.380828: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:52:11.747354: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:52:11.748257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:52:11.748293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.440000 seconds
loading data in 30.830000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.570293    reg_loss: 0.064705    l2_loss: 0.013348    loss: 0.648346
steps 200    v_Prec: 0.163050  v_Recall: 1.000000  v_F1: 0.280384  v_AUC: 0.482962
steps 200    running time 40 seconds

steps 400    base_loss: 0.509330    reg_loss: 0.064610    l2_loss: 0.013365    loss: 0.587304
steps 400    v_Prec: 0.163081  v_Recall: 0.999760  v_F1: 0.280420  v_AUC: 0.500636
steps 400    running time 47 seconds

steps 600    base_loss: 0.484644    reg_loss: 0.064249    l2_loss: 0.013155    loss: 0.562047
steps 600    v_Prec: 0.164433  v_Recall: 0.976793  v_F1: 0.281481  v_AUC: 0.526992
steps 600    running time 53 seconds

steps 800    base_loss: 0.465602    reg_loss: 0.064118    l2_loss: 0.012918    loss: 0.542638
steps 800    v_Prec: 0.182599  v_Recall: 0.705746  v_F1: 0.290132  v_AUC: 0.569470
steps 800    running time 59 seconds

steps 1000    base_loss: 0.448202    reg_loss: 0.063601    l2_loss: 0.012807    loss: 0.524610
steps 1000    v_Prec: 0.260405  v_Recall: 0.462148  v_F1: 0.333112  v_AUC: 0.650235
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.424744    reg_loss: 0.063086    l2_loss: 0.012754    loss: 0.500583
steps 1200    v_Prec: 0.376621  v_Recall: 0.441661  v_F1: 0.406556  v_AUC: 0.718293
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.405917    reg_loss: 0.063178    l2_loss: 0.012738    loss: 0.481833
steps 1400    v_Prec: 0.444792  v_Recall: 0.478073  v_F1: 0.460832  v_AUC: 0.760539
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.383792    reg_loss: 0.063310    l2_loss: 0.012799    loss: 0.459901
steps 1600    v_Prec: 0.495215  v_Recall: 0.513444  v_F1: 0.504165  v_AUC: 0.791185
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.367434    reg_loss: 0.063599    l2_loss: 0.012891    loss: 0.443924
steps 1800    v_Prec: 0.537751  v_Recall: 0.535771  v_F1: 0.536759  v_AUC: 0.814667
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.347658    reg_loss: 0.064261    l2_loss: 0.013034    loss: 0.424953
steps 2000    v_Prec: 0.546669  v_Recall: 0.583067  v_F1: 0.564281  v_AUC: 0.831926
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.334168    reg_loss: 0.064810    l2_loss: 0.013174    loss: 0.412152
steps 2200    v_Prec: 0.591435  v_Recall: 0.569142  v_F1: 0.580074  v_AUC: 0.843481
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.320623    reg_loss: 0.065067    l2_loss: 0.013479    loss: 0.399169
steps 2400    v_Prec: 0.602001  v_Recall: 0.587308  v_F1: 0.594564  v_AUC: 0.854948
steps 2400    running time 111 seconds

steps 2600    base_loss: 0.314438    reg_loss: 0.065525    l2_loss: 0.013696    loss: 0.393660
steps 2600    v_Prec: 0.632442  v_Recall: 0.577225  v_F1: 0.603573  v_AUC: 0.861506
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.308026    reg_loss: 0.065850    l2_loss: 0.014037    loss: 0.387914
steps 2800    v_Prec: 0.609747  v_Recall: 0.621799  v_F1: 0.615714  v_AUC: 0.867432
steps 2800    running time 124 seconds

steps 3000    base_loss: 0.304929    reg_loss: 0.066201    l2_loss: 0.014332    loss: 0.385461
steps 3000    v_Prec: 0.615444  v_Recall: 0.634603  v_F1: 0.624877  v_AUC: 0.873533
steps 3000    running time 130 seconds

steps 3200    base_loss: 0.301384    reg_loss: 0.066429    l2_loss: 0.014720    loss: 0.382533
steps 3200    v_Prec: 0.614410  v_Recall: 0.640125  v_F1: 0.627004  v_AUC: 0.877247
steps 3200    running time 137 seconds

steps 3400    base_loss: 0.291326    reg_loss: 0.066851    l2_loss: 0.015137    loss: 0.373313
steps 3400    v_Prec: 0.651798  v_Recall: 0.615077  v_F1: 0.632905  v_AUC: 0.879308
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.300920    reg_loss: 0.067064    l2_loss: 0.015460    loss: 0.383444
steps 3600    v_Prec: 0.672021  v_Recall: 0.602593  v_F1: 0.635416  v_AUC: 0.882464
steps 3600    running time 151 seconds

steps 3800    base_loss: 0.289438    reg_loss: 0.067048    l2_loss: 0.015903    loss: 0.372389
steps 3800    v_Prec: 0.658547  v_Recall: 0.620919  v_F1: 0.639180  v_AUC: 0.884350
steps 3800    running time 158 seconds

steps 4000    base_loss: 0.291709    reg_loss: 0.067276    l2_loss: 0.016352    loss: 0.375337
steps 4000    v_Prec: 0.644725  v_Recall: 0.637244  v_F1: 0.640963  v_AUC: 0.886423
steps 4000    running time 164 seconds

steps 4200    base_loss: 0.286112    reg_loss: 0.067285    l2_loss: 0.016809    loss: 0.370206
steps 4200    v_Prec: 0.667754  v_Recall: 0.622759  v_F1: 0.644472  v_AUC: 0.889250
steps 4200    running time 170 seconds

steps 4400    base_loss: 0.291381    reg_loss: 0.067510    l2_loss: 0.017286    loss: 0.376177
steps 4400    v_Prec: 0.633016  v_Recall: 0.660371  v_F1: 0.646405  v_AUC: 0.891457
steps 4400    running time 177 seconds

steps 4600    base_loss: 0.280000    reg_loss: 0.067138    l2_loss: 0.017772    loss: 0.364910
steps 4600    v_Prec: 0.664388  v_Recall: 0.630042  v_F1: 0.646759  v_AUC: 0.890906
steps 4600    running time 183 seconds

steps 4800    base_loss: 0.284257    reg_loss: 0.067173    l2_loss: 0.018373    loss: 0.369804
steps 4800    v_Prec: 0.645919  v_Recall: 0.651088  v_F1: 0.648494  v_AUC: 0.890890
steps 4800    running time 189 seconds

steps 5000    base_loss: 0.283848    reg_loss: 0.067496    l2_loss: 0.018966    loss: 0.370311
steps 5000    v_Prec: 0.681865  v_Recall: 0.629481  v_F1: 0.654627  v_AUC: 0.894440
steps 5000    running time 196 seconds

steps 5200    base_loss: 0.276176    reg_loss: 0.067337    l2_loss: 0.019580    loss: 0.363092
steps 5200    v_Prec: 0.673790  v_Recall: 0.645967  v_F1: 0.659585  v_AUC: 0.895859
steps 5200    running time 203 seconds

steps 5400    base_loss: 0.273980    reg_loss: 0.067621    l2_loss: 0.020188    loss: 0.361789
steps 5400    v_Prec: 0.637079  v_Recall: 0.680058  v_F1: 0.657867  v_AUC: 0.896599
steps 5400    running time 209 seconds

steps 5600    base_loss: 0.179614    reg_loss: 0.068502    l2_loss: 0.021069    loss: 0.269184
steps 5600    v_Prec: 0.663736  v_Recall: 0.640365  v_F1: 0.651841  v_AUC: 0.891468
steps 5600    running time 216 seconds

steps 5800    base_loss: 0.188882    reg_loss: 0.068507    l2_loss: 0.021899    loss: 0.279289
steps 5800    v_Prec: 0.649589  v_Recall: 0.645327  v_F1: 0.647451  v_AUC: 0.889845
steps 5800    running time 222 seconds

steps 6000    base_loss: 0.182790    reg_loss: 0.068292    l2_loss: 0.022563    loss: 0.273645
steps 6000    v_Prec: 0.638989  v_Recall: 0.651569  v_F1: 0.645218  v_AUC: 0.888218
steps 6000    running time 229 seconds

steps 6200    base_loss: 0.190206    reg_loss: 0.068317    l2_loss: 0.023233    loss: 0.281757
steps 6200    v_Prec: 0.652327  v_Recall: 0.637084  v_F1: 0.644615  v_AUC: 0.888483
steps 6200    running time 235 seconds

steps 6400    base_loss: 0.200512    reg_loss: 0.068351    l2_loss: 0.023864    loss: 0.292727
steps 6400    v_Prec: 0.669736  v_Recall: 0.634523  v_F1: 0.651654  v_AUC: 0.890398
steps 6400    running time 242 seconds

steps 6600    base_loss: 0.197379    reg_loss: 0.068156    l2_loss: 0.024291    loss: 0.289826
steps 6600    v_Prec: 0.655954  v_Recall: 0.653329  v_F1: 0.654639  v_AUC: 0.893210
steps 6600    running time 248 seconds

steps 6800    base_loss: 0.196370    reg_loss: 0.068334    l2_loss: 0.024692    loss: 0.289396
steps 6800    v_Prec: 0.669609  v_Recall: 0.649568  v_F1: 0.659436  v_AUC: 0.893423
steps 6800    running time 254 seconds

steps 7000    base_loss: 0.198741    reg_loss: 0.068265    l2_loss: 0.025154    loss: 0.292160
steps 7000    v_Prec: 0.672708  v_Recall: 0.650528  v_F1: 0.661432  v_AUC: 0.894042
steps 7000    running time 260 seconds

steps 7200    base_loss: 0.191246    reg_loss: 0.068301    l2_loss: 0.025513    loss: 0.285060
steps 7200    v_Prec: 0.694728  v_Recall: 0.632682  v_F1: 0.662255  v_AUC: 0.895227
steps 7200    running time 266 seconds

steps 7400    base_loss: 0.198721    reg_loss: 0.068208    l2_loss: 0.025956    loss: 0.292885
steps 7400    v_Prec: 0.667785  v_Recall: 0.669174  v_F1: 0.668479  v_AUC: 0.898173
steps 7400    running time 273 seconds

steps 7600    base_loss: 0.207567    reg_loss: 0.068134    l2_loss: 0.026267    loss: 0.301968
steps 7600    v_Prec: 0.688190  v_Recall: 0.653329  v_F1: 0.670307  v_AUC: 0.899171
steps 7600    running time 279 seconds

steps 7800    base_loss: 0.198913    reg_loss: 0.068157    l2_loss: 0.026621    loss: 0.293691
steps 7800    v_Prec: 0.706259  v_Recall: 0.643806  v_F1: 0.673588  v_AUC: 0.899650
steps 7800    running time 286 seconds

steps 8000    base_loss: 0.198467    reg_loss: 0.068072    l2_loss: 0.026879    loss: 0.293418
steps 8000    v_Prec: 0.670919  v_Recall: 0.673335  v_F1: 0.672125  v_AUC: 0.900912
steps 8000    running time 292 seconds

steps 8200    base_loss: 0.191355    reg_loss: 0.067896    l2_loss: 0.027175    loss: 0.286426
steps 8200    v_Prec: 0.703130  v_Recall: 0.654289  v_F1: 0.677831  v_AUC: 0.903094
steps 8200    running time 299 seconds

steps 8400    base_loss: 0.198122    reg_loss: 0.068202    l2_loss: 0.027593    loss: 0.293917
steps 8400    v_Prec: 0.695046  v_Recall: 0.670294  v_F1: 0.682446  v_AUC: 0.906553
steps 8400    running time 305 seconds

steps 8600    base_loss: 0.204655    reg_loss: 0.068143    l2_loss: 0.027626    loss: 0.300424
steps 8600    v_Prec: 0.722889  v_Recall: 0.650288  v_F1: 0.684670  v_AUC: 0.907386
steps 8600    running time 311 seconds

steps 8800    base_loss: 0.197924    reg_loss: 0.068035    l2_loss: 0.027948    loss: 0.293906
steps 8800    v_Prec: 0.700816  v_Recall: 0.673335  v_F1: 0.686801  v_AUC: 0.907696
steps 8800    running time 318 seconds

steps 9000    base_loss: 0.192533    reg_loss: 0.067931    l2_loss: 0.028146    loss: 0.288610
steps 9000    v_Prec: 0.712427  v_Recall: 0.666133  v_F1: 0.688503  v_AUC: 0.907782
steps 9000    running time 324 seconds

steps 9200    base_loss: 0.196889    reg_loss: 0.067882    l2_loss: 0.028497    loss: 0.293268
steps 9200    v_Prec: 0.712843  v_Recall: 0.672055  v_F1: 0.691848  v_AUC: 0.910050
steps 9200    running time 331 seconds

steps 9400    base_loss: 0.203866    reg_loss: 0.067890    l2_loss: 0.028751    loss: 0.300508
steps 9400    v_Prec: 0.703992  v_Recall: 0.680218  v_F1: 0.691901  v_AUC: 0.912032
steps 9400    running time 337 seconds

steps 9600    base_loss: 0.193660    reg_loss: 0.067726    l2_loss: 0.028961    loss: 0.290348
steps 9600    v_Prec: 0.708361  v_Recall: 0.680698  v_F1: 0.694254  v_AUC: 0.912482
steps 9600    running time 344 seconds

steps 9800    base_loss: 0.190540    reg_loss: 0.067639    l2_loss: 0.029155    loss: 0.287335
steps 9800    v_Prec: 0.712380  v_Recall: 0.683819  v_F1: 0.697807  v_AUC: 0.912278
steps 9800    running time 351 seconds

steps 10000    base_loss: 0.190810    reg_loss: 0.067442    l2_loss: 0.029275    loss: 0.287527
steps 10000    v_Prec: 0.738346  v_Recall: 0.678137  v_F1: 0.706962  v_AUC: 0.915764
steps 10000    running time 357 seconds

steps 10200    base_loss: 0.201606    reg_loss: 0.067728    l2_loss: 0.029423    loss: 0.298758
steps 10200    v_Prec: 0.734214  v_Recall: 0.680218  v_F1: 0.706185  v_AUC: 0.916522
steps 10200    running time 364 seconds

steps 10400    base_loss: 0.191026    reg_loss: 0.067690    l2_loss: 0.029783    loss: 0.288499
steps 10400    v_Prec: 0.728078  v_Recall: 0.691021  v_F1: 0.709066  v_AUC: 0.918487
steps 10400    running time 371 seconds

steps 10600    base_loss: 0.191844    reg_loss: 0.067488    l2_loss: 0.029885    loss: 0.289218
steps 10600    v_Prec: 0.726666  v_Recall: 0.697183  v_F1: 0.711619  v_AUC: 0.920257
steps 10600    running time 378 seconds

steps 10800    base_loss: 0.180018    reg_loss: 0.067217    l2_loss: 0.030168    loss: 0.277403
steps 10800    v_Prec: 0.726256  v_Recall: 0.690861  v_F1: 0.708116  v_AUC: 0.918693
steps 10800    running time 384 seconds

steps 11000    base_loss: 0.086471    reg_loss: 0.067406    l2_loss: 0.030427    loss: 0.184303
steps 11000    v_Prec: 0.700624  v_Recall: 0.683019  v_F1: 0.691709  v_AUC: 0.909800
steps 11000    running time 390 seconds

steps 11200    base_loss: 0.084400    reg_loss: 0.067046    l2_loss: 0.030520    loss: 0.181967
steps 11200    v_Prec: 0.687741  v_Recall: 0.672055  v_F1: 0.679807  v_AUC: 0.904051
steps 11200    running time 396 seconds

steps 11400    base_loss: 0.089535    reg_loss: 0.067077    l2_loss: 0.030780    loss: 0.187393
steps 11400    v_Prec: 0.685374  v_Recall: 0.667494  v_F1: 0.676316  v_AUC: 0.901751
steps 11400    running time 402 seconds

steps 11600    base_loss: 0.086195    reg_loss: 0.066874    l2_loss: 0.030881    loss: 0.183949
steps 11600    v_Prec: 0.686056  v_Recall: 0.660691  v_F1: 0.673135  v_AUC: 0.899243
steps 11600    running time 408 seconds

steps 11800    base_loss: 0.091621    reg_loss: 0.066680    l2_loss: 0.030913    loss: 0.189214
steps 11800    v_Prec: 0.680102  v_Recall: 0.663012  v_F1: 0.671448  v_AUC: 0.899200
steps 11800    running time 414 seconds

steps 12000    base_loss: 0.099054    reg_loss: 0.066838    l2_loss: 0.031176    loss: 0.197068
steps 12000    v_Prec: 0.677650  v_Recall: 0.666533  v_F1: 0.672046  v_AUC: 0.899586
steps 12000    running time 420 seconds

steps 12200    base_loss: 0.086931    reg_loss: 0.066677    l2_loss: 0.031248    loss: 0.184856
steps 12200    v_Prec: 0.664893  v_Recall: 0.660051  v_F1: 0.662463  v_AUC: 0.895983
steps 12200    running time 426 seconds

steps 12400    base_loss: 0.088314    reg_loss: 0.066722    l2_loss: 0.031385    loss: 0.186421
steps 12400    v_Prec: 0.677398  v_Recall: 0.656690  v_F1: 0.666883  v_AUC: 0.897765
steps 12400    running time 432 seconds

steps 12600    base_loss: 0.094099    reg_loss: 0.066444    l2_loss: 0.031494    loss: 0.192036
steps 12600    v_Prec: 0.702870  v_Recall: 0.634923  v_F1: 0.667171  v_AUC: 0.897885
steps 12600    running time 438 seconds

Early stop model F1: 0.711619
testing thre: 0.26065472
testing Prec: 0.5264203280709565
testing Recall: 0.7471202916160389
testing F1: 0.6176470588235294
testing AUC: 0.8930523545791856
overall running time 440 seconds
(0.670646869483958, 0.6278493317132442, 0.6485428119587319, 0.8930523545791856, 0.52733666)

2019-02-24 00:57:22.038068: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:57:23.611488: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:57:23.616306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:57:23.616342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.640000 seconds
loading data in 30.020000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.528371    reg_loss: 0.064996    l2_loss: 0.013283    loss: 0.606651
steps 200    v_Prec: 0.163076  v_Recall: 0.999199  v_F1: 0.280390  v_AUC: 0.518321
steps 200    running time 40 seconds

steps 400    base_loss: 0.507463    reg_loss: 0.064680    l2_loss: 0.013136    loss: 0.585279
steps 400    v_Prec: 0.168598  v_Recall: 0.876881  v_F1: 0.282819  v_AUC: 0.548254
steps 400    running time 46 seconds

steps 600    base_loss: 0.471354    reg_loss: 0.064328    l2_loss: 0.012941    loss: 0.548623
steps 600    v_Prec: 0.186139  v_Recall: 0.707573  v_F1: 0.294741  v_AUC: 0.589009
steps 600    running time 53 seconds

steps 800    base_loss: 0.447005    reg_loss: 0.063665    l2_loss: 0.012798    loss: 0.523468
steps 800    v_Prec: 0.228622  v_Recall: 0.570365  v_F1: 0.326408  v_AUC: 0.638873
steps 800    running time 60 seconds

steps 1000    base_loss: 0.447945    reg_loss: 0.063384    l2_loss: 0.012670    loss: 0.523999
steps 1000    v_Prec: 0.300512  v_Recall: 0.446366  v_F1: 0.359197  v_AUC: 0.675836
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.431444    reg_loss: 0.062848    l2_loss: 0.012617    loss: 0.506908
steps 1200    v_Prec: 0.352286  v_Recall: 0.447887  v_F1: 0.394375  v_AUC: 0.705568
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.420066    reg_loss: 0.062528    l2_loss: 0.012542    loss: 0.495136
steps 1400    v_Prec: 0.385233  v_Recall: 0.479907  v_F1: 0.427390  v_AUC: 0.733840
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.401179    reg_loss: 0.062176    l2_loss: 0.012633    loss: 0.475987
steps 1600    v_Prec: 0.445516  v_Recall: 0.462456  v_F1: 0.453828  v_AUC: 0.757044
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.383663    reg_loss: 0.061787    l2_loss: 0.012797    loss: 0.458247
steps 1800    v_Prec: 0.495423  v_Recall: 0.485191  v_F1: 0.490253  v_AUC: 0.783356
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.370301    reg_loss: 0.061544    l2_loss: 0.012961    loss: 0.444806
steps 2000    v_Prec: 0.506404  v_Recall: 0.534902  v_F1: 0.520263  v_AUC: 0.805322
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.355710    reg_loss: 0.061097    l2_loss: 0.013201    loss: 0.430008
steps 2200    v_Prec: 0.543492  v_Recall: 0.532181  v_F1: 0.537777  v_AUC: 0.821011
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.342560    reg_loss: 0.060823    l2_loss: 0.013489    loss: 0.416872
steps 2400    v_Prec: 0.527073  v_Recall: 0.575088  v_F1: 0.550034  v_AUC: 0.833715
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.339059    reg_loss: 0.060536    l2_loss: 0.013889    loss: 0.413484
steps 2600    v_Prec: 0.561803  v_Recall: 0.568684  v_F1: 0.565223  v_AUC: 0.843235
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.327504    reg_loss: 0.060089    l2_loss: 0.014302    loss: 0.401895
steps 2800    v_Prec: 0.563902  v_Recall: 0.587736  v_F1: 0.575572  v_AUC: 0.851602
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.325642    reg_loss: 0.059850    l2_loss: 0.014752    loss: 0.400244
steps 3000    v_Prec: 0.558545  v_Recall: 0.614793  v_F1: 0.585321  v_AUC: 0.856885
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.323377    reg_loss: 0.059419    l2_loss: 0.015219    loss: 0.398015
steps 3200    v_Prec: 0.554146  v_Recall: 0.625921  v_F1: 0.587851  v_AUC: 0.860073
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.316841    reg_loss: 0.058961    l2_loss: 0.015841    loss: 0.391644
steps 3400    v_Prec: 0.551450  v_Recall: 0.643932  v_F1: 0.594114  v_AUC: 0.863891
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.314434    reg_loss: 0.058501    l2_loss: 0.016381    loss: 0.389316
steps 3600    v_Prec: 0.585342  v_Recall: 0.614393  v_F1: 0.599516  v_AUC: 0.866767
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.313258    reg_loss: 0.058181    l2_loss: 0.016963    loss: 0.388402
steps 3800    v_Prec: 0.585915  v_Recall: 0.610070  v_F1: 0.597749  v_AUC: 0.866967
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.317990    reg_loss: 0.057621    l2_loss: 0.017609    loss: 0.393220
steps 4000    v_Prec: 0.568919  v_Recall: 0.637688  v_F1: 0.601344  v_AUC: 0.869222
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.318089    reg_loss: 0.057199    l2_loss: 0.018296    loss: 0.393584
steps 4200    v_Prec: 0.582139  v_Recall: 0.614713  v_F1: 0.597983  v_AUC: 0.869720
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.309348    reg_loss: 0.056590    l2_loss: 0.018881    loss: 0.384819
steps 4400    v_Prec: 0.563033  v_Recall: 0.650336  v_F1: 0.603544  v_AUC: 0.872107
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.315161    reg_loss: 0.056225    l2_loss: 0.019551    loss: 0.390937
steps 4600    v_Prec: 0.578598  v_Recall: 0.634966  v_F1: 0.605473  v_AUC: 0.874022
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.312995    reg_loss: 0.055739    l2_loss: 0.020423    loss: 0.389157
steps 4800    v_Prec: 0.617804  v_Recall: 0.600544  v_F1: 0.609052  v_AUC: 0.876363
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.307409    reg_loss: 0.055189    l2_loss: 0.021174    loss: 0.383771
steps 5000    v_Prec: 0.585984  v_Recall: 0.637208  v_F1: 0.610523  v_AUC: 0.876787
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.303803    reg_loss: 0.054551    l2_loss: 0.022034    loss: 0.380388
steps 5200    v_Prec: 0.613841  v_Recall: 0.617035  v_F1: 0.615434  v_AUC: 0.877669
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.291562    reg_loss: 0.054189    l2_loss: 0.022880    loss: 0.368632
steps 5400    v_Prec: 0.589187  v_Recall: 0.647294  v_F1: 0.616875  v_AUC: 0.878392
steps 5400    running time 210 seconds

steps 5600    base_loss: 0.190872    reg_loss: 0.056388    l2_loss: 0.023526    loss: 0.270787
steps 5600    v_Prec: 0.596926  v_Recall: 0.631044  v_F1: 0.613511  v_AUC: 0.875562
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.182171    reg_loss: 0.057323    l2_loss: 0.023967    loss: 0.263461
steps 5800    v_Prec: 0.586696  v_Recall: 0.629763  v_F1: 0.607467  v_AUC: 0.872613
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.179127    reg_loss: 0.057807    l2_loss: 0.024540    loss: 0.261474
steps 6000    v_Prec: 0.575922  v_Recall: 0.627281  v_F1: 0.600506  v_AUC: 0.868933
steps 6000    running time 229 seconds

steps 6200    base_loss: 0.204477    reg_loss: 0.057658    l2_loss: 0.025085    loss: 0.287220
steps 6200    v_Prec: 0.565610  v_Recall: 0.642491  v_F1: 0.601604  v_AUC: 0.869594
steps 6200    running time 235 seconds

steps 6400    base_loss: 0.177185    reg_loss: 0.057635    l2_loss: 0.025530    loss: 0.260350
steps 6400    v_Prec: 0.579252  v_Recall: 0.625760  v_F1: 0.601608  v_AUC: 0.868666
steps 6400    running time 241 seconds

steps 6600    base_loss: 0.185761    reg_loss: 0.057566    l2_loss: 0.025987    loss: 0.269314
steps 6600    v_Prec: 0.565867  v_Recall: 0.630644  v_F1: 0.596502  v_AUC: 0.867440
steps 6600    running time 247 seconds

steps 6800    base_loss: 0.191055    reg_loss: 0.057740    l2_loss: 0.026405    loss: 0.275200
steps 6800    v_Prec: 0.567499  v_Recall: 0.629283  v_F1: 0.596796  v_AUC: 0.867629
steps 6800    running time 253 seconds

steps 7000    base_loss: 0.204009    reg_loss: 0.057274    l2_loss: 0.026839    loss: 0.288122
steps 7000    v_Prec: 0.555246  v_Recall: 0.654899  v_F1: 0.600970  v_AUC: 0.869583
steps 7000    running time 259 seconds

steps 7200    base_loss: 0.193061    reg_loss: 0.056855    l2_loss: 0.027157    loss: 0.277074
steps 7200    v_Prec: 0.557511  v_Recall: 0.649135  v_F1: 0.599845  v_AUC: 0.869621
steps 7200    running time 265 seconds

steps 7400    base_loss: 0.196003    reg_loss: 0.056581    l2_loss: 0.027558    loss: 0.280142
steps 7400    v_Prec: 0.570806  v_Recall: 0.639850  v_F1: 0.603359  v_AUC: 0.871135
steps 7400    running time 272 seconds

Early stop model F1: 0.616875
testing thre: 0.24949922
testing Prec: 0.41716749764182726
testing Recall: 0.7523207776427704
testing F1: 0.5367198335644937
testing AUC: 0.8564043009556646
overall running time 275 seconds
(0.5644160328496104, 0.5878979343863913, 0.5759177260391373, 0.8564043009556646, 0.50702477)

2019-02-24 01:00:42.957305: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:00:43.850095: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:00:43.854876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:00:43.854922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.100000 seconds
loading data in 29.280000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.880601    reg_loss: 0.064710    l2_loss: 0.013314    loss: 0.958625
steps 200    v_Prec: 0.166486  v_Recall: 1.000000  v_F1: 0.285449  v_AUC: 0.486418
steps 200    running time 39 seconds

steps 400    base_loss: 0.612116    reg_loss: 0.064713    l2_loss: 0.013412    loss: 0.690242
steps 400    v_Prec: 0.166482  v_Recall: 0.999373  v_F1: 0.285417  v_AUC: 0.488177
steps 400    running time 45 seconds

steps 600    base_loss: 0.479790    reg_loss: 0.064250    l2_loss: 0.013279    loss: 0.557319
steps 600    v_Prec: 0.166556  v_Recall: 0.999138  v_F1: 0.285516  v_AUC: 0.495620
steps 600    running time 51 seconds

steps 800    base_loss: 0.473459    reg_loss: 0.064035    l2_loss: 0.013017    loss: 0.550511
steps 800    v_Prec: 0.166495  v_Recall: 1.000000  v_F1: 0.285462  v_AUC: 0.512824
steps 800    running time 58 seconds

steps 1000    base_loss: 0.466521    reg_loss: 0.063808    l2_loss: 0.012705    loss: 0.543033
steps 1000    v_Prec: 0.167161  v_Recall: 0.989183  v_F1: 0.285993  v_AUC: 0.535915
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.450569    reg_loss: 0.063145    l2_loss: 0.012508    loss: 0.526223
steps 1200    v_Prec: 0.189426  v_Recall: 0.624001  v_F1: 0.290627  v_AUC: 0.573508
steps 1200    running time 70 seconds

steps 1400    base_loss: 0.446963    reg_loss: 0.063030    l2_loss: 0.012393    loss: 0.522386
steps 1400    v_Prec: 0.224189  v_Recall: 0.525239  v_F1: 0.314247  v_AUC: 0.613469
steps 1400    running time 76 seconds

steps 1600    base_loss: 0.432161    reg_loss: 0.062574    l2_loss: 0.012350    loss: 0.507085
steps 1600    v_Prec: 0.324380  v_Recall: 0.421226  v_F1: 0.366513  v_AUC: 0.666485
steps 1600    running time 82 seconds

steps 1800    base_loss: 0.414486    reg_loss: 0.062199    l2_loss: 0.012441    loss: 0.489126
steps 1800    v_Prec: 0.432665  v_Recall: 0.398887  v_F1: 0.415090  v_AUC: 0.709936
steps 1800    running time 89 seconds

steps 2000    base_loss: 0.391923    reg_loss: 0.061609    l2_loss: 0.012539    loss: 0.466071
steps 2000    v_Prec: 0.455371  v_Recall: 0.467863  v_F1: 0.461533  v_AUC: 0.744775
steps 2000    running time 95 seconds

steps 2200    base_loss: 0.380352    reg_loss: 0.061385    l2_loss: 0.012772    loss: 0.454510
steps 2200    v_Prec: 0.536163  v_Recall: 0.471234  v_F1: 0.501606  v_AUC: 0.770085
steps 2200    running time 101 seconds

steps 2400    base_loss: 0.365994    reg_loss: 0.061156    l2_loss: 0.012893    loss: 0.440043
steps 2400    v_Prec: 0.545618  v_Recall: 0.500157  v_F1: 0.521899  v_AUC: 0.782003
steps 2400    running time 108 seconds

steps 2600    base_loss: 0.351378    reg_loss: 0.060899    l2_loss: 0.013010    loss: 0.425287
steps 2600    v_Prec: 0.571514  v_Recall: 0.521790  v_F1: 0.545522  v_AUC: 0.801612
steps 2600    running time 114 seconds

steps 2800    base_loss: 0.346773    reg_loss: 0.060713    l2_loss: 0.013144    loss: 0.420630
steps 2800    v_Prec: 0.585546  v_Recall: 0.546167  v_F1: 0.565172  v_AUC: 0.816331
steps 2800    running time 120 seconds

steps 3000    base_loss: 0.333682    reg_loss: 0.060859    l2_loss: 0.013380    loss: 0.407921
steps 3000    v_Prec: 0.568507  v_Recall: 0.579558  v_F1: 0.573979  v_AUC: 0.822503
steps 3000    running time 127 seconds

steps 3200    base_loss: 0.329542    reg_loss: 0.060937    l2_loss: 0.013589    loss: 0.404068
steps 3200    v_Prec: 0.615595  v_Recall: 0.564979  v_F1: 0.589202  v_AUC: 0.833642
steps 3200    running time 133 seconds

steps 3400    base_loss: 0.310410    reg_loss: 0.061129    l2_loss: 0.013862    loss: 0.385401
steps 3400    v_Prec: 0.642191  v_Recall: 0.555965  v_F1: 0.595975  v_AUC: 0.840127
steps 3400    running time 140 seconds

steps 3600    base_loss: 0.309420    reg_loss: 0.061295    l2_loss: 0.014183    loss: 0.384898
steps 3600    v_Prec: 0.650162  v_Recall: 0.567095  v_F1: 0.605794  v_AUC: 0.845720
steps 3600    running time 147 seconds

steps 3800    base_loss: 0.315291    reg_loss: 0.061910    l2_loss: 0.014640    loss: 0.391841
steps 3800    v_Prec: 0.678764  v_Recall: 0.561452  v_F1: 0.614560  v_AUC: 0.850489
steps 3800    running time 153 seconds

steps 4000    base_loss: 0.306308    reg_loss: 0.062012    l2_loss: 0.015134    loss: 0.383454
steps 4000    v_Prec: 0.695539  v_Recall: 0.564587  v_F1: 0.623259  v_AUC: 0.852656
steps 4000    running time 159 seconds

steps 4200    base_loss: 0.296894    reg_loss: 0.062498    l2_loss: 0.015688    loss: 0.375081
steps 4200    v_Prec: 0.660319  v_Recall: 0.606129  v_F1: 0.632065  v_AUC: 0.857292
steps 4200    running time 166 seconds

steps 4400    base_loss: 0.291868    reg_loss: 0.062583    l2_loss: 0.016279    loss: 0.370730
steps 4400    v_Prec: 0.693040  v_Recall: 0.593196  v_F1: 0.639243  v_AUC: 0.862619
steps 4400    running time 172 seconds

steps 4600    base_loss: 0.299279    reg_loss: 0.062720    l2_loss: 0.016796    loss: 0.378795
steps 4600    v_Prec: 0.701039  v_Recall: 0.602681  v_F1: 0.648150  v_AUC: 0.865843
steps 4600    running time 178 seconds

steps 4800    base_loss: 0.289219    reg_loss: 0.062549    l2_loss: 0.017356    loss: 0.369125
steps 4800    v_Prec: 0.695537  v_Recall: 0.616868  v_F1: 0.653845  v_AUC: 0.868754
steps 4800    running time 185 seconds

steps 5000    base_loss: 0.287594    reg_loss: 0.062690    l2_loss: 0.018083    loss: 0.368367
steps 5000    v_Prec: 0.727751  v_Recall: 0.596097  v_F1: 0.655377  v_AUC: 0.872125
steps 5000    running time 191 seconds

steps 5200    base_loss: 0.280444    reg_loss: 0.062530    l2_loss: 0.018671    loss: 0.361644
steps 5200    v_Prec: 0.703560  v_Recall: 0.625803  v_F1: 0.662408  v_AUC: 0.873397
steps 5200    running time 197 seconds

steps 5400    base_loss: 0.274520    reg_loss: 0.062407    l2_loss: 0.019197    loss: 0.356125
steps 5400    v_Prec: 0.704193  v_Recall: 0.630506  v_F1: 0.665316  v_AUC: 0.875533
steps 5400    running time 204 seconds

steps 5600    base_loss: 0.186596    reg_loss: 0.058115    l2_loss: 0.019586    loss: 0.264296
steps 5600    v_Prec: 0.712325  v_Recall: 0.622433  v_F1: 0.664352  v_AUC: 0.873729
steps 5600    running time 210 seconds

steps 5800    base_loss: 0.190082    reg_loss: 0.058909    l2_loss: 0.019618    loss: 0.268609
steps 5800    v_Prec: 0.741494  v_Recall: 0.602994  v_F1: 0.665110  v_AUC: 0.871761
steps 5800    running time 216 seconds

steps 6000    base_loss: 0.191275    reg_loss: 0.059361    l2_loss: 0.019952    loss: 0.270588
steps 6000    v_Prec: 0.709035  v_Recall: 0.620003  v_F1: 0.661537  v_AUC: 0.872085
steps 6000    running time 222 seconds

steps 6200    base_loss: 0.188455    reg_loss: 0.059652    l2_loss: 0.020179    loss: 0.268285
steps 6200    v_Prec: 0.704620  v_Recall: 0.638345  v_F1: 0.669847  v_AUC: 0.873255
steps 6200    running time 228 seconds

steps 6400    base_loss: 0.182892    reg_loss: 0.059585    l2_loss: 0.020426    loss: 0.262903
steps 6400    v_Prec: 0.708795  v_Recall: 0.631682  v_F1: 0.668021  v_AUC: 0.874486
steps 6400    running time 235 seconds

steps 6600    base_loss: 0.199140    reg_loss: 0.060037    l2_loss: 0.020695    loss: 0.279872
steps 6600    v_Prec: 0.718711  v_Recall: 0.632858  v_F1: 0.673058  v_AUC: 0.876595
steps 6600    running time 241 seconds

steps 6800    base_loss: 0.215265    reg_loss: 0.060655    l2_loss: 0.020877    loss: 0.296797
steps 6800    v_Prec: 0.739583  v_Recall: 0.623295  v_F1: 0.676478  v_AUC: 0.879924
steps 6800    running time 247 seconds

steps 7000    base_loss: 0.204120    reg_loss: 0.060353    l2_loss: 0.020985    loss: 0.285458
steps 7000    v_Prec: 0.728762  v_Recall: 0.634739  v_F1: 0.678509  v_AUC: 0.881100
steps 7000    running time 254 seconds

steps 7200    base_loss: 0.203815    reg_loss: 0.059961    l2_loss: 0.021061    loss: 0.284837
steps 7200    v_Prec: 0.745308  v_Recall: 0.628704  v_F1: 0.682058  v_AUC: 0.882091
steps 7200    running time 261 seconds

steps 7400    base_loss: 0.202828    reg_loss: 0.060232    l2_loss: 0.021202    loss: 0.284263
steps 7400    v_Prec: 0.751585  v_Recall: 0.631996  v_F1: 0.686622  v_AUC: 0.885253
steps 7400    running time 267 seconds

steps 7600    base_loss: 0.197613    reg_loss: 0.060128    l2_loss: 0.021385    loss: 0.279126
steps 7600    v_Prec: 0.721197  v_Recall: 0.655510  v_F1: 0.686787  v_AUC: 0.885326
steps 7600    running time 273 seconds

steps 7800    base_loss: 0.200762    reg_loss: 0.059996    l2_loss: 0.021393    loss: 0.282151
steps 7800    v_Prec: 0.744710  v_Recall: 0.645477  v_F1: 0.691552  v_AUC: 0.886941
steps 7800    running time 280 seconds

steps 8000    base_loss: 0.200422    reg_loss: 0.060130    l2_loss: 0.021444    loss: 0.281996
steps 8000    v_Prec: 0.750204  v_Recall: 0.649475  v_F1: 0.696215  v_AUC: 0.889352
steps 8000    running time 287 seconds

steps 8200    base_loss: 0.195381    reg_loss: 0.059881    l2_loss: 0.021568    loss: 0.276830
steps 8200    v_Prec: 0.756659  v_Recall: 0.641245  v_F1: 0.694188  v_AUC: 0.889668
steps 8200    running time 293 seconds

steps 8400    base_loss: 0.212813    reg_loss: 0.060543    l2_loss: 0.021704    loss: 0.295060
steps 8400    v_Prec: 0.755843  v_Recall: 0.646418  v_F1: 0.696861  v_AUC: 0.891042
steps 8400    running time 299 seconds

steps 8600    base_loss: 0.203552    reg_loss: 0.060119    l2_loss: 0.021798    loss: 0.285469
steps 8600    v_Prec: 0.748641  v_Recall: 0.658332  v_F1: 0.700588  v_AUC: 0.891279
steps 8600    running time 306 seconds

steps 8800    base_loss: 0.204787    reg_loss: 0.060102    l2_loss: 0.021880    loss: 0.286769
steps 8800    v_Prec: 0.762779  v_Recall: 0.651513  v_F1: 0.702769  v_AUC: 0.893813
steps 8800    running time 312 seconds

steps 9000    base_loss: 0.193604    reg_loss: 0.059547    l2_loss: 0.021934    loss: 0.275086
steps 9000    v_Prec: 0.764085  v_Recall: 0.652689  v_F1: 0.704007  v_AUC: 0.894563
steps 9000    running time 318 seconds

steps 9200    base_loss: 0.198703    reg_loss: 0.059646    l2_loss: 0.021903    loss: 0.280252
steps 9200    v_Prec: 0.751815  v_Recall: 0.665543  v_F1: 0.706054  v_AUC: 0.895408
steps 9200    running time 325 seconds

steps 9400    base_loss: 0.197455    reg_loss: 0.059965    l2_loss: 0.021951    loss: 0.279371
steps 9400    v_Prec: 0.768249  v_Recall: 0.655824  v_F1: 0.707599  v_AUC: 0.896861
steps 9400    running time 331 seconds

steps 9600    base_loss: 0.201051    reg_loss: 0.059983    l2_loss: 0.022061    loss: 0.283095
steps 9600    v_Prec: 0.766574  v_Recall: 0.667973  v_F1: 0.713885  v_AUC: 0.897217
steps 9600    running time 338 seconds

steps 9800    base_loss: 0.204878    reg_loss: 0.059808    l2_loss: 0.022042    loss: 0.286727
steps 9800    v_Prec: 0.758642  v_Recall: 0.676046  v_F1: 0.714967  v_AUC: 0.898039
steps 9800    running time 344 seconds

steps 10000    base_loss: 0.197877    reg_loss: 0.059545    l2_loss: 0.022095    loss: 0.279518
steps 10000    v_Prec: 0.747053  v_Recall: 0.685452  v_F1: 0.714928  v_AUC: 0.898816
steps 10000    running time 351 seconds

steps 10200    base_loss: 0.200834    reg_loss: 0.059338    l2_loss: 0.022122    loss: 0.282294
steps 10200    v_Prec: 0.765113  v_Recall: 0.675576  v_F1: 0.717562  v_AUC: 0.900612
steps 10200    running time 357 seconds

steps 10400    base_loss: 0.195317    reg_loss: 0.059332    l2_loss: 0.022130    loss: 0.276779
steps 10400    v_Prec: 0.759698  v_Recall: 0.686158  v_F1: 0.721058  v_AUC: 0.900906
steps 10400    running time 363 seconds

steps 10600    base_loss: 0.197733    reg_loss: 0.059383    l2_loss: 0.022226    loss: 0.279343
steps 10600    v_Prec: 0.776224  v_Recall: 0.674557  v_F1: 0.721828  v_AUC: 0.903523
steps 10600    running time 370 seconds

steps 10800    base_loss: 0.193240    reg_loss: 0.059283    l2_loss: 0.022439    loss: 0.274962
steps 10800    v_Prec: 0.762979  v_Recall: 0.684277  v_F1: 0.721488  v_AUC: 0.903243
steps 10800    running time 376 seconds

steps 11000    base_loss: 0.063492    reg_loss: 0.054621    l2_loss: 0.022187    loss: 0.140300
steps 11000    v_Prec: 0.771758  v_Recall: 0.672127  v_F1: 0.718505  v_AUC: 0.899818
steps 11000    running time 382 seconds

steps 11200    base_loss: 0.066967    reg_loss: 0.055078    l2_loss: 0.021702    loss: 0.143747
steps 11200    v_Prec: 0.762463  v_Recall: 0.672519  v_F1: 0.714672  v_AUC: 0.896679
steps 11200    running time 388 seconds

steps 11400    base_loss: 0.066742    reg_loss: 0.054934    l2_loss: 0.021273    loss: 0.142949
steps 11400    v_Prec: 0.784716  v_Recall: 0.655981  v_F1: 0.714597  v_AUC: 0.895411
steps 11400    running time 394 seconds

steps 11600    base_loss: 0.065754    reg_loss: 0.054562    l2_loss: 0.020990    loss: 0.141306
steps 11600    v_Prec: 0.760546  v_Recall: 0.668443  v_F1: 0.711526  v_AUC: 0.892585
steps 11600    running time 400 seconds

steps 11800    base_loss: 0.066922    reg_loss: 0.054675    l2_loss: 0.020640    loss: 0.142238
steps 11800    v_Prec: 0.759332  v_Recall: 0.663270  v_F1: 0.708058  v_AUC: 0.893270
steps 11800    running time 406 seconds

steps 12000    base_loss: 0.069573    reg_loss: 0.055075    l2_loss: 0.020413    loss: 0.145061
steps 12000    v_Prec: 0.750553  v_Recall: 0.664603  v_F1: 0.704968  v_AUC: 0.891919
steps 12000    running time 412 seconds

steps 12200    base_loss: 0.071125    reg_loss: 0.054808    l2_loss: 0.020235    loss: 0.146168
steps 12200    v_Prec: 0.764328  v_Recall: 0.652297  v_F1: 0.703882  v_AUC: 0.890765
steps 12200    running time 418 seconds

steps 12400    base_loss: 0.067459    reg_loss: 0.054829    l2_loss: 0.020121    loss: 0.142410
steps 12400    v_Prec: 0.753787  v_Recall: 0.663035  v_F1: 0.705505  v_AUC: 0.892387
steps 12400    running time 424 seconds

steps 12600    base_loss: 0.071221    reg_loss: 0.054413    l2_loss: 0.019914    loss: 0.145547
steps 12600    v_Prec: 0.753887  v_Recall: 0.661232  v_F1: 0.704526  v_AUC: 0.891448
steps 12600    running time 430 seconds

Early stop model F1: 0.721828
testing thre: 0.42817345
testing Prec: 0.6324296386787577
testing Recall: 0.6541919805589307
testing F1: 0.6431267619093124
testing AUC: 0.8758919490335564
overall running time 433 seconds
(0.6910991898401576, 0.6136087484811664, 0.6500527765620574, 0.8758919490335564, 0.5373426)

2019-02-24 01:05:42.402881: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:05:43.571628: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:05:43.572597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:05:43.572636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.810000 seconds
loading data in 30.270000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.390265    reg_loss: 0.064942    l2_loss: 0.013370    loss: 1.468577
steps 200    v_Prec: 0.163046  v_Recall: 1.000000  v_F1: 0.280377  v_AUC: 0.467657
steps 200    running time 40 seconds

steps 400    base_loss: 0.888683    reg_loss: 0.065139    l2_loss: 0.013217    loss: 0.967039
steps 400    v_Prec: 0.163559  v_Recall: 0.998960  v_F1: 0.281095  v_AUC: 0.524519
steps 400    running time 47 seconds

steps 600    base_loss: 0.498671    reg_loss: 0.064557    l2_loss: 0.012822    loss: 0.576051
steps 600    v_Prec: 0.165878  v_Recall: 0.956386  v_F1: 0.282720  v_AUC: 0.547042
steps 600    running time 53 seconds

steps 800    base_loss: 0.475432    reg_loss: 0.063970    l2_loss: 0.012635    loss: 0.552036
steps 800    v_Prec: 0.200089  v_Recall: 0.615077  v_F1: 0.301951  v_AUC: 0.597959
steps 800    running time 60 seconds

steps 1000    base_loss: 0.454370    reg_loss: 0.063407    l2_loss: 0.012434    loss: 0.530210
steps 1000    v_Prec: 0.250853  v_Recall: 0.523448  v_F1: 0.339167  v_AUC: 0.651613
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.445429    reg_loss: 0.062706    l2_loss: 0.012248    loss: 0.520382
steps 1200    v_Prec: 0.320020  v_Recall: 0.466149  v_F1: 0.379504  v_AUC: 0.692535
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.428580    reg_loss: 0.061871    l2_loss: 0.012114    loss: 0.502565
steps 1400    v_Prec: 0.385400  v_Recall: 0.471511  v_F1: 0.424129  v_AUC: 0.728651
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.403219    reg_loss: 0.061505    l2_loss: 0.012132    loss: 0.476856
steps 1600    v_Prec: 0.401937  v_Recall: 0.508083  v_F1: 0.448819  v_AUC: 0.752026
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.384462    reg_loss: 0.061288    l2_loss: 0.012194    loss: 0.457945
steps 1800    v_Prec: 0.466506  v_Recall: 0.495439  v_F1: 0.480537  v_AUC: 0.777160
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.366822    reg_loss: 0.061498    l2_loss: 0.012315    loss: 0.440634
steps 2000    v_Prec: 0.500149  v_Recall: 0.538172  v_F1: 0.518464  v_AUC: 0.801720
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.354121    reg_loss: 0.062169    l2_loss: 0.012454    loss: 0.428744
steps 2200    v_Prec: 0.538710  v_Recall: 0.534011  v_F1: 0.536350  v_AUC: 0.815830
steps 2200    running time 104 seconds

steps 2400    base_loss: 0.340912    reg_loss: 0.062796    l2_loss: 0.012658    loss: 0.416366
steps 2400    v_Prec: 0.537016  v_Recall: 0.571783  v_F1: 0.553855  v_AUC: 0.830518
steps 2400    running time 110 seconds

steps 2600    base_loss: 0.331923    reg_loss: 0.063816    l2_loss: 0.012964    loss: 0.408703
steps 2600    v_Prec: 0.569981  v_Recall: 0.571623  v_F1: 0.570801  v_AUC: 0.843137
steps 2600    running time 117 seconds

steps 2800    base_loss: 0.324872    reg_loss: 0.064698    l2_loss: 0.013351    loss: 0.402921
steps 2800    v_Prec: 0.559936  v_Recall: 0.612676  v_F1: 0.585120  v_AUC: 0.852007
steps 2800    running time 123 seconds

steps 3000    base_loss: 0.312191    reg_loss: 0.065286    l2_loss: 0.013741    loss: 0.391217
steps 3000    v_Prec: 0.597035  v_Recall: 0.599472  v_F1: 0.598251  v_AUC: 0.859919
steps 3000    running time 130 seconds

steps 3200    base_loss: 0.309948    reg_loss: 0.065764    l2_loss: 0.014275    loss: 0.389986
steps 3200    v_Prec: 0.597537  v_Recall: 0.613556  v_F1: 0.605441  v_AUC: 0.864068
steps 3200    running time 137 seconds

steps 3400    base_loss: 0.310426    reg_loss: 0.066215    l2_loss: 0.014645    loss: 0.391286
steps 3400    v_Prec: 0.615224  v_Recall: 0.612516  v_F1: 0.613867  v_AUC: 0.869978
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.298849    reg_loss: 0.066633    l2_loss: 0.015179    loss: 0.380660
steps 3600    v_Prec: 0.622079  v_Recall: 0.620038  v_F1: 0.621057  v_AUC: 0.873538
steps 3600    running time 151 seconds

steps 3800    base_loss: 0.291500    reg_loss: 0.066851    l2_loss: 0.015624    loss: 0.373974
steps 3800    v_Prec: 0.650564  v_Recall: 0.600272  v_F1: 0.624407  v_AUC: 0.877224
steps 3800    running time 158 seconds

steps 4000    base_loss: 0.287566    reg_loss: 0.066905    l2_loss: 0.016129    loss: 0.370600
steps 4000    v_Prec: 0.640601  v_Recall: 0.624760  v_F1: 0.632581  v_AUC: 0.880407
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.290893    reg_loss: 0.067246    l2_loss: 0.016643    loss: 0.374783
steps 4200    v_Prec: 0.627983  v_Recall: 0.642206  v_F1: 0.635015  v_AUC: 0.881883
steps 4200    running time 171 seconds

steps 4400    base_loss: 0.293379    reg_loss: 0.067451    l2_loss: 0.017333    loss: 0.378164
steps 4400    v_Prec: 0.642278  v_Recall: 0.634363  v_F1: 0.638296  v_AUC: 0.883707
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.281506    reg_loss: 0.067212    l2_loss: 0.017788    loss: 0.366506
steps 4600    v_Prec: 0.640274  v_Recall: 0.643246  v_F1: 0.641756  v_AUC: 0.886237
steps 4600    running time 184 seconds

steps 4800    base_loss: 0.272097    reg_loss: 0.067356    l2_loss: 0.018440    loss: 0.357893
steps 4800    v_Prec: 0.657737  v_Recall: 0.632682  v_F1: 0.644967  v_AUC: 0.887962
steps 4800    running time 190 seconds

steps 5000    base_loss: 0.279660    reg_loss: 0.067667    l2_loss: 0.019058    loss: 0.366384
steps 5000    v_Prec: 0.637260  v_Recall: 0.651488  v_F1: 0.644296  v_AUC: 0.888590
steps 5000    running time 196 seconds

steps 5200    base_loss: 0.283094    reg_loss: 0.067819    l2_loss: 0.019746    loss: 0.370659
steps 5200    v_Prec: 0.666554  v_Recall: 0.628681  v_F1: 0.647064  v_AUC: 0.891043
steps 5200    running time 202 seconds

steps 5400    base_loss: 0.273757    reg_loss: 0.067780    l2_loss: 0.020431    loss: 0.361968
steps 5400    v_Prec: 0.643760  v_Recall: 0.655970  v_F1: 0.649808  v_AUC: 0.892190
steps 5400    running time 209 seconds

steps 5600    base_loss: 0.186297    reg_loss: 0.068541    l2_loss: 0.021404    loss: 0.276242
steps 5600    v_Prec: 0.642474  v_Recall: 0.641805  v_F1: 0.642139  v_AUC: 0.887129
steps 5600    running time 215 seconds

steps 5800    base_loss: 0.194202    reg_loss: 0.068614    l2_loss: 0.022169    loss: 0.284986
steps 5800    v_Prec: 0.632600  v_Recall: 0.646927  v_F1: 0.639683  v_AUC: 0.886044
steps 5800    running time 221 seconds

steps 6000    base_loss: 0.185048    reg_loss: 0.068458    l2_loss: 0.022771    loss: 0.276276
steps 6000    v_Prec: 0.636421  v_Recall: 0.645487  v_F1: 0.640922  v_AUC: 0.886511
steps 6000    running time 227 seconds

steps 6200    base_loss: 0.196070    reg_loss: 0.068244    l2_loss: 0.023328    loss: 0.287642
steps 6200    v_Prec: 0.655161  v_Recall: 0.627321  v_F1: 0.640939  v_AUC: 0.887255
steps 6200    running time 233 seconds

steps 6400    base_loss: 0.201020    reg_loss: 0.068273    l2_loss: 0.023884    loss: 0.293176
steps 6400    v_Prec: 0.672351  v_Recall: 0.621559  v_F1: 0.645958  v_AUC: 0.887413
steps 6400    running time 239 seconds

steps 6600    base_loss: 0.200834    reg_loss: 0.068165    l2_loss: 0.024455    loss: 0.293454
steps 6600    v_Prec: 0.679555  v_Recall: 0.620278  v_F1: 0.648565  v_AUC: 0.889473
steps 6600    running time 245 seconds

steps 6800    base_loss: 0.193275    reg_loss: 0.068335    l2_loss: 0.024988    loss: 0.286597
steps 6800    v_Prec: 0.647853  v_Recall: 0.653089  v_F1: 0.650460  v_AUC: 0.887691
steps 6800    running time 251 seconds

steps 7000    base_loss: 0.207768    reg_loss: 0.068121    l2_loss: 0.025424    loss: 0.301312
steps 7000    v_Prec: 0.644584  v_Recall: 0.650928  v_F1: 0.647740  v_AUC: 0.886995
steps 7000    running time 258 seconds

steps 7200    base_loss: 0.200074    reg_loss: 0.068227    l2_loss: 0.025900    loss: 0.294200
steps 7200    v_Prec: 0.651218  v_Recall: 0.656690  v_F1: 0.653943  v_AUC: 0.891311
steps 7200    running time 264 seconds

steps 7400    base_loss: 0.209336    reg_loss: 0.068330    l2_loss: 0.026340    loss: 0.304007
steps 7400    v_Prec: 0.668067  v_Recall: 0.649088  v_F1: 0.658441  v_AUC: 0.893264
steps 7400    running time 270 seconds

steps 7600    base_loss: 0.199542    reg_loss: 0.068103    l2_loss: 0.026706    loss: 0.294352
steps 7600    v_Prec: 0.654247  v_Recall: 0.673095  v_F1: 0.663537  v_AUC: 0.896067
steps 7600    running time 277 seconds

steps 7800    base_loss: 0.203006    reg_loss: 0.068286    l2_loss: 0.027052    loss: 0.298345
steps 7800    v_Prec: 0.672931  v_Recall: 0.653329  v_F1: 0.662985  v_AUC: 0.895552
steps 7800    running time 283 seconds

steps 8000    base_loss: 0.211325    reg_loss: 0.068499    l2_loss: 0.027374    loss: 0.307198
steps 8000    v_Prec: 0.684056  v_Recall: 0.653729  v_F1: 0.668549  v_AUC: 0.898596
steps 8000    running time 289 seconds

steps 8200    base_loss: 0.206410    reg_loss: 0.068007    l2_loss: 0.027601    loss: 0.302019
steps 8200    v_Prec: 0.680651  v_Recall: 0.659571  v_F1: 0.669945  v_AUC: 0.900572
steps 8200    running time 296 seconds

steps 8400    base_loss: 0.191692    reg_loss: 0.068002    l2_loss: 0.027805    loss: 0.287499
steps 8400    v_Prec: 0.675830  v_Recall: 0.672855  v_F1: 0.674339  v_AUC: 0.900397
steps 8400    running time 302 seconds

steps 8600    base_loss: 0.201909    reg_loss: 0.068134    l2_loss: 0.028099    loss: 0.298142
steps 8600    v_Prec: 0.691041  v_Recall: 0.664773  v_F1: 0.677652  v_AUC: 0.901424
steps 8600    running time 309 seconds

steps 8800    base_loss: 0.203737    reg_loss: 0.067969    l2_loss: 0.028374    loss: 0.300080
steps 8800    v_Prec: 0.694421  v_Recall: 0.669414  v_F1: 0.681689  v_AUC: 0.904355
steps 8800    running time 315 seconds

steps 9000    base_loss: 0.203438    reg_loss: 0.067779    l2_loss: 0.028590    loss: 0.299808
steps 9000    v_Prec: 0.694936  v_Recall: 0.668854  v_F1: 0.681646  v_AUC: 0.903957
steps 9000    running time 321 seconds

steps 9200    base_loss: 0.204490    reg_loss: 0.068007    l2_loss: 0.028767    loss: 0.301264
steps 9200    v_Prec: 0.688962  v_Recall: 0.683339  v_F1: 0.686139  v_AUC: 0.905132
steps 9200    running time 327 seconds

steps 9400    base_loss: 0.199766    reg_loss: 0.067656    l2_loss: 0.029190    loss: 0.296613
steps 9400    v_Prec: 0.712980  v_Recall: 0.668134  v_F1: 0.689829  v_AUC: 0.908891
steps 9400    running time 334 seconds

steps 9600    base_loss: 0.218098    reg_loss: 0.067808    l2_loss: 0.029320    loss: 0.315226
steps 9600    v_Prec: 0.725723  v_Recall: 0.660851  v_F1: 0.691770  v_AUC: 0.910893
steps 9600    running time 340 seconds

steps 9800    base_loss: 0.201700    reg_loss: 0.067569    l2_loss: 0.029545    loss: 0.298814
steps 9800    v_Prec: 0.703747  v_Recall: 0.680938  v_F1: 0.692154  v_AUC: 0.911645
steps 9800    running time 346 seconds

steps 10000    base_loss: 0.194839    reg_loss: 0.067635    l2_loss: 0.029543    loss: 0.292017
steps 10000    v_Prec: 0.710371  v_Recall: 0.682458  v_F1: 0.696135  v_AUC: 0.912535
steps 10000    running time 353 seconds

steps 10200    base_loss: 0.187912    reg_loss: 0.067397    l2_loss: 0.029891    loss: 0.285200
steps 10200    v_Prec: 0.714465  v_Recall: 0.684219  v_F1: 0.699015  v_AUC: 0.912149
steps 10200    running time 359 seconds

steps 10400    base_loss: 0.195842    reg_loss: 0.067405    l2_loss: 0.029923    loss: 0.293170
steps 10400    v_Prec: 0.725601  v_Recall: 0.678857  v_F1: 0.701451  v_AUC: 0.915022
steps 10400    running time 366 seconds

steps 10600    base_loss: 0.200891    reg_loss: 0.067536    l2_loss: 0.030238    loss: 0.298666
steps 10600    v_Prec: 0.737612  v_Recall: 0.669494  v_F1: 0.701905  v_AUC: 0.916292
steps 10600    running time 372 seconds

steps 10800    base_loss: 0.181981    reg_loss: 0.067252    l2_loss: 0.030383    loss: 0.279616
steps 10800    v_Prec: 0.706753  v_Recall: 0.695102  v_F1: 0.700880  v_AUC: 0.916003
steps 10800    running time 379 seconds

steps 11000    base_loss: 0.089316    reg_loss: 0.067282    l2_loss: 0.030612    loss: 0.187210
steps 11000    v_Prec: 0.710553  v_Recall: 0.665973  v_F1: 0.687541  v_AUC: 0.906949
steps 11000    running time 385 seconds

steps 11200    base_loss: 0.085977    reg_loss: 0.066981    l2_loss: 0.030707    loss: 0.183665
steps 11200    v_Prec: 0.678923  v_Recall: 0.679738  v_F1: 0.679330  v_AUC: 0.902450
steps 11200    running time 391 seconds

steps 11400    base_loss: 0.086898    reg_loss: 0.066612    l2_loss: 0.030791    loss: 0.184301
steps 11400    v_Prec: 0.669450  v_Recall: 0.673736  v_F1: 0.671586  v_AUC: 0.899703
steps 11400    running time 397 seconds

steps 11600    base_loss: 0.089872    reg_loss: 0.066201    l2_loss: 0.030915    loss: 0.186988
steps 11600    v_Prec: 0.666238  v_Recall: 0.663092  v_F1: 0.664661  v_AUC: 0.895221
steps 11600    running time 403 seconds

steps 11800    base_loss: 0.087893    reg_loss: 0.066389    l2_loss: 0.031167    loss: 0.185449
steps 11800    v_Prec: 0.677320  v_Recall: 0.649568  v_F1: 0.663154  v_AUC: 0.895835
steps 11800    running time 409 seconds

steps 12000    base_loss: 0.092269    reg_loss: 0.066344    l2_loss: 0.031234    loss: 0.189847
steps 12000    v_Prec: 0.654150  v_Recall: 0.663572  v_F1: 0.658827  v_AUC: 0.893367
steps 12000    running time 415 seconds

steps 12200    base_loss: 0.094506    reg_loss: 0.065997    l2_loss: 0.031368    loss: 0.191872
steps 12200    v_Prec: 0.669041  v_Recall: 0.654049  v_F1: 0.661460  v_AUC: 0.892701
steps 12200    running time 421 seconds

steps 12400    base_loss: 0.096516    reg_loss: 0.066327    l2_loss: 0.031495    loss: 0.194337
steps 12400    v_Prec: 0.665038  v_Recall: 0.664453  v_F1: 0.664745  v_AUC: 0.894343
steps 12400    running time 427 seconds

steps 12600    base_loss: 0.099492    reg_loss: 0.066116    l2_loss: 0.031583    loss: 0.197192
steps 12600    v_Prec: 0.666829  v_Recall: 0.656850  v_F1: 0.661802  v_AUC: 0.892876
steps 12600    running time 433 seconds

Early stop model F1: 0.701905
testing thre: 0.44728106
testing Prec: 0.5412461842341534
testing Recall: 0.732490886998785
testing F1: 0.6225113589425857
testing AUC: 0.8910717720882668
overall running time 436 seconds
(0.6722140299136297, 0.6203645200486027, 0.6452493491393473, 0.8910717720882668, 0.6867533)

2019-02-24 01:10:38.885029: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:10:39.626593: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:10:39.786110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:10:39.786216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.630000 seconds
loading data in 30.130000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	48
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.743323    reg_loss: 0.064911    l2_loss: 0.013331    loss: 1.821566
steps 200    v_Prec: 0.161359  v_Recall: 0.999515  v_F1: 0.277861  v_AUC: 0.493788
steps 200    running time 40 seconds

steps 400    base_loss: 0.993602    reg_loss: 0.065074    l2_loss: 0.013095    loss: 1.071771
steps 400    v_Prec: 0.161347  v_Recall: 1.000000  v_F1: 0.277862  v_AUC: 0.488298
steps 400    running time 47 seconds

steps 600    base_loss: 0.495658    reg_loss: 0.064819    l2_loss: 0.012873    loss: 0.573350
steps 600    v_Prec: 0.162061  v_Recall: 0.974201  v_F1: 0.277894  v_AUC: 0.519558
steps 600    running time 53 seconds

steps 800    base_loss: 0.472823    reg_loss: 0.064880    l2_loss: 0.012682    loss: 0.550386
steps 800    v_Prec: 0.183046  v_Recall: 0.642135  v_F1: 0.284884  v_AUC: 0.570429
steps 800    running time 59 seconds

steps 1000    base_loss: 0.462559    reg_loss: 0.064597    l2_loss: 0.012528    loss: 0.539684
steps 1000    v_Prec: 0.248912  v_Recall: 0.439466  v_F1: 0.317815  v_AUC: 0.626700
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.449927    reg_loss: 0.064361    l2_loss: 0.012319    loss: 0.526607
steps 1200    v_Prec: 0.366420  v_Recall: 0.391994  v_F1: 0.378775  v_AUC: 0.689653
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.424836    reg_loss: 0.064124    l2_loss: 0.012208    loss: 0.501168
steps 1400    v_Prec: 0.451825  v_Recall: 0.427416  v_F1: 0.439282  v_AUC: 0.743207
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.399252    reg_loss: 0.064350    l2_loss: 0.012256    loss: 0.475857
steps 1600    v_Prec: 0.477500  v_Recall: 0.487424  v_F1: 0.482411  v_AUC: 0.782988
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.379744    reg_loss: 0.065012    l2_loss: 0.012381    loss: 0.457137
steps 1800    v_Prec: 0.539863  v_Recall: 0.496159  v_F1: 0.517089  v_AUC: 0.806964
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.355006    reg_loss: 0.065123    l2_loss: 0.012559    loss: 0.432688
steps 2000    v_Prec: 0.580164  v_Recall: 0.521795  v_F1: 0.549434  v_AUC: 0.828091
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.341557    reg_loss: 0.065710    l2_loss: 0.012851    loss: 0.420118
steps 2200    v_Prec: 0.582802  v_Recall: 0.568945  v_F1: 0.575790  v_AUC: 0.843800
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.320306    reg_loss: 0.066226    l2_loss: 0.013142    loss: 0.399674
steps 2400    v_Prec: 0.619394  v_Recall: 0.564092  v_F1: 0.590451  v_AUC: 0.852769
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.317510    reg_loss: 0.066415    l2_loss: 0.013478    loss: 0.397403
steps 2600    v_Prec: 0.662291  v_Recall: 0.563041  v_F1: 0.608646  v_AUC: 0.863255
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.307942    reg_loss: 0.066815    l2_loss: 0.013860    loss: 0.388617
steps 2800    v_Prec: 0.648735  v_Recall: 0.591023  v_F1: 0.618536  v_AUC: 0.870500
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.300375    reg_loss: 0.066897    l2_loss: 0.014159    loss: 0.381431
steps 3000    v_Prec: 0.615137  v_Recall: 0.633643  v_F1: 0.624253  v_AUC: 0.874497
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.292869    reg_loss: 0.066859    l2_loss: 0.014564    loss: 0.374292
steps 3200    v_Prec: 0.658236  v_Recall: 0.608249  v_F1: 0.632256  v_AUC: 0.877889
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.296623    reg_loss: 0.067112    l2_loss: 0.014870    loss: 0.378605
steps 3400    v_Prec: 0.652480  v_Recall: 0.622402  v_F1: 0.637086  v_AUC: 0.881592
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.293861    reg_loss: 0.067338    l2_loss: 0.015268    loss: 0.376468
steps 3600    v_Prec: 0.647657  v_Recall: 0.633724  v_F1: 0.640615  v_AUC: 0.883878
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.284279    reg_loss: 0.067322    l2_loss: 0.015719    loss: 0.367319
steps 3800    v_Prec: 0.669701  v_Recall: 0.624747  v_F1: 0.646444  v_AUC: 0.885950
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.279842    reg_loss: 0.067195    l2_loss: 0.016192    loss: 0.363230
steps 4000    v_Prec: 0.654542  v_Recall: 0.643267  v_F1: 0.648856  v_AUC: 0.888564
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.282549    reg_loss: 0.067229    l2_loss: 0.016652    loss: 0.366430
steps 4200    v_Prec: 0.678359  v_Recall: 0.636555  v_F1: 0.656792  v_AUC: 0.891040
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.279056    reg_loss: 0.067506    l2_loss: 0.017165    loss: 0.363727
steps 4400    v_Prec: 0.678670  v_Recall: 0.637121  v_F1: 0.657239  v_AUC: 0.893414
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.278976    reg_loss: 0.067393    l2_loss: 0.017649    loss: 0.364017
steps 4600    v_Prec: 0.683503  v_Recall: 0.641326  v_F1: 0.661743  v_AUC: 0.894960
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.275819    reg_loss: 0.067324    l2_loss: 0.018262    loss: 0.361405
steps 4800    v_Prec: 0.680836  v_Recall: 0.639871  v_F1: 0.659718  v_AUC: 0.895061
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.284015    reg_loss: 0.067565    l2_loss: 0.018888    loss: 0.370468
steps 5000    v_Prec: 0.687435  v_Recall: 0.642459  v_F1: 0.664186  v_AUC: 0.896939
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.282201    reg_loss: 0.067416    l2_loss: 0.019464    loss: 0.369081
steps 5200    v_Prec: 0.670445  v_Recall: 0.660089  v_F1: 0.665227  v_AUC: 0.898843
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.269753    reg_loss: 0.067477    l2_loss: 0.020105    loss: 0.357335
steps 5400    v_Prec: 0.672962  v_Recall: 0.662839  v_F1: 0.667862  v_AUC: 0.901291
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.192804    reg_loss: 0.068086    l2_loss: 0.020969    loss: 0.281860
steps 5600    v_Prec: 0.660477  v_Recall: 0.658714  v_F1: 0.659594  v_AUC: 0.894972
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.183567    reg_loss: 0.068073    l2_loss: 0.021793    loss: 0.273433
steps 5800    v_Prec: 0.665746  v_Recall: 0.643025  v_F1: 0.654188  v_AUC: 0.892152
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.198090    reg_loss: 0.067964    l2_loss: 0.022404    loss: 0.288458
steps 6000    v_Prec: 0.680711  v_Recall: 0.637606  v_F1: 0.658454  v_AUC: 0.893309
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.196913    reg_loss: 0.068057    l2_loss: 0.023092    loss: 0.288062
steps 6200    v_Prec: 0.691537  v_Recall: 0.630408  v_F1: 0.659559  v_AUC: 0.894207
steps 6200    running time 236 seconds

steps 6400    base_loss: 0.195139    reg_loss: 0.067908    l2_loss: 0.023748    loss: 0.286795
steps 6400    v_Prec: 0.653475  v_Recall: 0.667691  v_F1: 0.660506  v_AUC: 0.893980
steps 6400    running time 241 seconds

steps 6600    base_loss: 0.188186    reg_loss: 0.068014    l2_loss: 0.024327    loss: 0.280527
steps 6600    v_Prec: 0.669876  v_Recall: 0.652810  v_F1: 0.661233  v_AUC: 0.895553
steps 6600    running time 248 seconds

steps 6800    base_loss: 0.202275    reg_loss: 0.068008    l2_loss: 0.024807    loss: 0.295089
steps 6800    v_Prec: 0.684193  v_Recall: 0.649333  v_F1: 0.666307  v_AUC: 0.896476
steps 6800    running time 254 seconds

steps 7000    base_loss: 0.193793    reg_loss: 0.067791    l2_loss: 0.025263    loss: 0.286847
steps 7000    v_Prec: 0.676107  v_Recall: 0.658391  v_F1: 0.667131  v_AUC: 0.896995
steps 7000    running time 260 seconds

steps 7200    base_loss: 0.201245    reg_loss: 0.067914    l2_loss: 0.025667    loss: 0.294826
steps 7200    v_Prec: 0.686848  v_Recall: 0.655075  v_F1: 0.670585  v_AUC: 0.897476
steps 7200    running time 266 seconds

steps 7400    base_loss: 0.204258    reg_loss: 0.067667    l2_loss: 0.025956    loss: 0.297881
steps 7400    v_Prec: 0.697204  v_Recall: 0.657339  v_F1: 0.676685  v_AUC: 0.899287
steps 7400    running time 272 seconds

steps 7600    base_loss: 0.194407    reg_loss: 0.067974    l2_loss: 0.026402    loss: 0.288784
steps 7600    v_Prec: 0.702710  v_Recall: 0.652244  v_F1: 0.676537  v_AUC: 0.900952
steps 7600    running time 279 seconds

steps 7800    base_loss: 0.201572    reg_loss: 0.067488    l2_loss: 0.026634    loss: 0.295694
steps 7800    v_Prec: 0.698999  v_Recall: 0.655075  v_F1: 0.676324  v_AUC: 0.900110
steps 7800    running time 285 seconds

steps 8000    base_loss: 0.198224    reg_loss: 0.067687    l2_loss: 0.027062    loss: 0.292973
steps 8000    v_Prec: 0.697607  v_Recall: 0.662515  v_F1: 0.679608  v_AUC: 0.903385
steps 8000    running time 291 seconds

steps 8200    base_loss: 0.192296    reg_loss: 0.067667    l2_loss: 0.027327    loss: 0.287289
steps 8200    v_Prec: 0.706525  v_Recall: 0.664699  v_F1: 0.684974  v_AUC: 0.903520
steps 8200    running time 297 seconds

steps 8400    base_loss: 0.197055    reg_loss: 0.067650    l2_loss: 0.027627    loss: 0.292333
steps 8400    v_Prec: 0.686662  v_Recall: 0.679499  v_F1: 0.683062  v_AUC: 0.904514
steps 8400    running time 304 seconds

steps 8600    base_loss: 0.199249    reg_loss: 0.067696    l2_loss: 0.027861    loss: 0.294806
steps 8600    v_Prec: 0.720914  v_Recall: 0.663486  v_F1: 0.691009  v_AUC: 0.907583
steps 8600    running time 310 seconds

steps 8800    base_loss: 0.195334    reg_loss: 0.067501    l2_loss: 0.028305    loss: 0.291140
steps 8800    v_Prec: 0.675339  v_Recall: 0.705378  v_F1: 0.690032  v_AUC: 0.908974
steps 8800    running time 317 seconds

steps 9000    base_loss: 0.203737    reg_loss: 0.067751    l2_loss: 0.028540    loss: 0.300028
steps 9000    v_Prec: 0.710493  v_Recall: 0.670845  v_F1: 0.690100  v_AUC: 0.908891
steps 9000    running time 323 seconds

steps 9200    base_loss: 0.198381    reg_loss: 0.067318    l2_loss: 0.028693    loss: 0.294391
steps 9200    v_Prec: 0.743529  v_Recall: 0.659765  v_F1: 0.699147  v_AUC: 0.911534
steps 9200    running time 328 seconds

steps 9400    base_loss: 0.194911    reg_loss: 0.067539    l2_loss: 0.028937    loss: 0.291387
steps 9400    v_Prec: 0.718132  v_Recall: 0.683866  v_F1: 0.700580  v_AUC: 0.912270
steps 9400    running time 335 seconds

steps 9600    base_loss: 0.192388    reg_loss: 0.067380    l2_loss: 0.029195    loss: 0.288963
steps 9600    v_Prec: 0.727800  v_Recall: 0.679418  v_F1: 0.702777  v_AUC: 0.913697
steps 9600    running time 342 seconds

steps 9800    base_loss: 0.198371    reg_loss: 0.067382    l2_loss: 0.029365    loss: 0.295117
steps 9800    v_Prec: 0.742239  v_Recall: 0.669066  v_F1: 0.703756  v_AUC: 0.913870
steps 9800    running time 348 seconds

steps 10000    base_loss: 0.195891    reg_loss: 0.067310    l2_loss: 0.029536    loss: 0.292737
steps 10000    v_Prec: 0.725859  v_Recall: 0.686939  v_F1: 0.705863  v_AUC: 0.916534
steps 10000    running time 354 seconds

steps 10200    base_loss: 0.194761    reg_loss: 0.067127    l2_loss: 0.029825    loss: 0.291712
steps 10200    v_Prec: 0.726709  v_Recall: 0.692034  v_F1: 0.708948  v_AUC: 0.917285
steps 10200    running time 360 seconds

steps 10400    base_loss: 0.186260    reg_loss: 0.066925    l2_loss: 0.029911    loss: 0.283096
steps 10400    v_Prec: 0.744479  v_Recall: 0.684270  v_F1: 0.713106  v_AUC: 0.917234
steps 10400    running time 367 seconds

steps 10600    base_loss: 0.194387    reg_loss: 0.066898    l2_loss: 0.030112    loss: 0.291396
steps 10600    v_Prec: 0.731816  v_Recall: 0.702224  v_F1: 0.716715  v_AUC: 0.920338
steps 10600    running time 373 seconds

steps 10800    base_loss: 0.175165    reg_loss: 0.067008    l2_loss: 0.030349    loss: 0.272522
steps 10800    v_Prec: 0.746586  v_Recall: 0.689770  v_F1: 0.717054  v_AUC: 0.920469
steps 10800    running time 380 seconds

steps 11000    base_loss: 0.089280    reg_loss: 0.066461    l2_loss: 0.030686    loss: 0.186427
steps 11000    v_Prec: 0.711150  v_Recall: 0.686535  v_F1: 0.698626  v_AUC: 0.910749
steps 11000    running time 386 seconds

steps 11200    base_loss: 0.084888    reg_loss: 0.066448    l2_loss: 0.030727    loss: 0.182064
steps 11200    v_Prec: 0.697047  v_Recall: 0.683461  v_F1: 0.690187  v_AUC: 0.906694
steps 11200    running time 392 seconds

steps 11400    base_loss: 0.086935    reg_loss: 0.066299    l2_loss: 0.030937    loss: 0.184171
steps 11400    v_Prec: 0.717944  v_Recall: 0.655237  v_F1: 0.685159  v_AUC: 0.905325
steps 11400    running time 399 seconds

steps 11600    base_loss: 0.088085    reg_loss: 0.066471    l2_loss: 0.031007    loss: 0.185563
steps 11600    v_Prec: 0.692333  v_Recall: 0.671896  v_F1: 0.681962  v_AUC: 0.903487
steps 11600    running time 404 seconds

steps 11800    base_loss: 0.090605    reg_loss: 0.066125    l2_loss: 0.031098    loss: 0.187829
steps 11800    v_Prec: 0.695015  v_Recall: 0.659604  v_F1: 0.676846  v_AUC: 0.901183
steps 11800    running time 410 seconds

steps 12000    base_loss: 0.094431    reg_loss: 0.066016    l2_loss: 0.031231    loss: 0.191678
steps 12000    v_Prec: 0.682147  v_Recall: 0.678285  v_F1: 0.680211  v_AUC: 0.902756
steps 12000    running time 416 seconds

steps 12200    base_loss: 0.095310    reg_loss: 0.066277    l2_loss: 0.031411    loss: 0.192998
steps 12200    v_Prec: 0.661633  v_Recall: 0.687424  v_F1: 0.674282  v_AUC: 0.899799
steps 12200    running time 422 seconds

steps 12400    base_loss: 0.091525    reg_loss: 0.066146    l2_loss: 0.031404    loss: 0.189075
steps 12400    v_Prec: 0.694016  v_Recall: 0.654670  v_F1: 0.673769  v_AUC: 0.898400
steps 12400    running time 428 seconds

steps 12600    base_loss: 0.087185    reg_loss: 0.066277    l2_loss: 0.031615    loss: 0.185077
steps 12600    v_Prec: 0.686561  v_Recall: 0.668904  v_F1: 0.677618  v_AUC: 0.900680
steps 12600    running time 434 seconds

steps 12800    base_loss: 0.091810    reg_loss: 0.066004    l2_loss: 0.031639    loss: 0.189453
steps 12800    v_Prec: 0.687004  v_Recall: 0.664780  v_F1: 0.675709  v_AUC: 0.900248
steps 12800    running time 440 seconds

Early stop model F1: 0.717054
testing thre: 0.37512395
testing Prec: 0.5367461430575035
testing Recall: 0.7440097205346294
testing F1: 0.6236072919849271
testing AUC: 0.8949879433983333
overall running time 443 seconds
(0.6664989939637826, 0.6439854191980559, 0.6550488196761833, 0.8949879433983333, 0.67339414)

2019-02-24 01:15:40.524420: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:15:41.651643: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:15:41.652587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:15:41.652623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.980000 seconds
loading data in 30.040000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.632701    reg_loss: 0.064873    l2_loss: 0.013356    loss: 0.710930
steps 200    v_Prec: 0.163894  v_Recall: 0.998247  v_F1: 0.281560  v_AUC: 0.527233
steps 200    running time 40 seconds

steps 400    base_loss: 0.541878    reg_loss: 0.064462    l2_loss: 0.013251    loss: 0.619592
steps 400    v_Prec: 0.170663  v_Recall: 0.821064  v_F1: 0.282588  v_AUC: 0.545750
steps 400    running time 47 seconds

steps 600    base_loss: 0.494288    reg_loss: 0.063887    l2_loss: 0.012976    loss: 0.571150
steps 600    v_Prec: 0.171285  v_Recall: 0.857314  v_F1: 0.285525  v_AUC: 0.553935
steps 600    running time 54 seconds

steps 800    base_loss: 0.475230    reg_loss: 0.063649    l2_loss: 0.012597    loss: 0.551476
steps 800    v_Prec: 0.212436  v_Recall: 0.588193  v_F1: 0.312138  v_AUC: 0.615044
steps 800    running time 61 seconds

steps 1000    base_loss: 0.463322    reg_loss: 0.063220    l2_loss: 0.012259    loss: 0.538802
steps 1000    v_Prec: 0.299258  v_Recall: 0.433556  v_F1: 0.354101  v_AUC: 0.671936
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.430524    reg_loss: 0.062205    l2_loss: 0.012112    loss: 0.504841
steps 1200    v_Prec: 0.381961  v_Recall: 0.445347  v_F1: 0.411226  v_AUC: 0.713495
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.408469    reg_loss: 0.061579    l2_loss: 0.012100    loss: 0.482147
steps 1400    v_Prec: 0.461734  v_Recall: 0.448932  v_F1: 0.455243  v_AUC: 0.745745
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.384925    reg_loss: 0.061153    l2_loss: 0.012152    loss: 0.458230
steps 1600    v_Prec: 0.480633  v_Recall: 0.481437  v_F1: 0.481035  v_AUC: 0.768445
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.374661    reg_loss: 0.060953    l2_loss: 0.012221    loss: 0.447835
steps 1800    v_Prec: 0.512681  v_Recall: 0.512110  v_F1: 0.512395  v_AUC: 0.790387
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.361092    reg_loss: 0.060920    l2_loss: 0.012327    loss: 0.434339
steps 2000    v_Prec: 0.537749  v_Recall: 0.518085  v_F1: 0.527734  v_AUC: 0.804035
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.355488    reg_loss: 0.060695    l2_loss: 0.012408    loss: 0.428591
steps 2200    v_Prec: 0.534873  v_Recall: 0.544375  v_F1: 0.539582  v_AUC: 0.813150
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.347662    reg_loss: 0.060363    l2_loss: 0.012551    loss: 0.420575
steps 2400    v_Prec: 0.551721  v_Recall: 0.547721  v_F1: 0.549714  v_AUC: 0.821434
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.344411    reg_loss: 0.060208    l2_loss: 0.012723    loss: 0.417342
steps 2600    v_Prec: 0.569268  v_Recall: 0.545730  v_F1: 0.557250  v_AUC: 0.829692
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.335508    reg_loss: 0.060051    l2_loss: 0.012952    loss: 0.408511
steps 2800    v_Prec: 0.573854  v_Recall: 0.557441  v_F1: 0.565528  v_AUC: 0.836827
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.342158    reg_loss: 0.060052    l2_loss: 0.013326    loss: 0.415537
steps 3000    v_Prec: 0.568288  v_Recall: 0.578792  v_F1: 0.573492  v_AUC: 0.844875
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.329549    reg_loss: 0.059687    l2_loss: 0.013891    loss: 0.403128
steps 3200    v_Prec: 0.574554  v_Recall: 0.575287  v_F1: 0.574920  v_AUC: 0.851061
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.323975    reg_loss: 0.059459    l2_loss: 0.014500    loss: 0.397934
steps 3400    v_Prec: 0.545695  v_Recall: 0.623646  v_F1: 0.582072  v_AUC: 0.856847
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.319284    reg_loss: 0.059004    l2_loss: 0.015225    loss: 0.393513
steps 3600    v_Prec: 0.559943  v_Recall: 0.630338  v_F1: 0.593059  v_AUC: 0.863012
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.321682    reg_loss: 0.058908    l2_loss: 0.015982    loss: 0.396573
steps 3800    v_Prec: 0.574834  v_Recall: 0.622371  v_F1: 0.597659  v_AUC: 0.866322
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.319291    reg_loss: 0.058380    l2_loss: 0.016712    loss: 0.394383
steps 4000    v_Prec: 0.559994  v_Recall: 0.646590  v_F1: 0.600185  v_AUC: 0.869226
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.309103    reg_loss: 0.057957    l2_loss: 0.017534    loss: 0.384594
steps 4200    v_Prec: 0.574691  v_Recall: 0.633525  v_F1: 0.602675  v_AUC: 0.870530
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.312437    reg_loss: 0.057758    l2_loss: 0.018429    loss: 0.388624
steps 4400    v_Prec: 0.596735  v_Recall: 0.620220  v_F1: 0.608251  v_AUC: 0.874017
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.305630    reg_loss: 0.057167    l2_loss: 0.019378    loss: 0.382175
steps 4600    v_Prec: 0.589662  v_Recall: 0.623486  v_F1: 0.606103  v_AUC: 0.875531
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.307987    reg_loss: 0.056730    l2_loss: 0.020342    loss: 0.385058
steps 4800    v_Prec: 0.578774  v_Recall: 0.643005  v_F1: 0.609201  v_AUC: 0.876310
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.307210    reg_loss: 0.056247    l2_loss: 0.021218    loss: 0.384674
steps 5000    v_Prec: 0.604427  v_Recall: 0.619981  v_F1: 0.612105  v_AUC: 0.876650
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.306055    reg_loss: 0.055829    l2_loss: 0.022027    loss: 0.383910
steps 5200    v_Prec: 0.584301  v_Recall: 0.649379  v_F1: 0.615123  v_AUC: 0.878278
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.300354    reg_loss: 0.055413    l2_loss: 0.023113    loss: 0.378880
steps 5400    v_Prec: 0.606696  v_Recall: 0.641013  v_F1: 0.623383  v_AUC: 0.881450
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.192255    reg_loss: 0.057835    l2_loss: 0.023711    loss: 0.273802
steps 5600    v_Prec: 0.575533  v_Recall: 0.655911  v_F1: 0.613099  v_AUC: 0.876663
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.196726    reg_loss: 0.058638    l2_loss: 0.024034    loss: 0.279398
steps 5800    v_Prec: 0.573311  v_Recall: 0.644837  v_F1: 0.606974  v_AUC: 0.873062
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.187892    reg_loss: 0.058788    l2_loss: 0.024582    loss: 0.271263
steps 6000    v_Prec: 0.570194  v_Recall: 0.651689  v_F1: 0.608224  v_AUC: 0.872355
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.186802    reg_loss: 0.058712    l2_loss: 0.025109    loss: 0.270624
steps 6200    v_Prec: 0.572394  v_Recall: 0.640934  v_F1: 0.604728  v_AUC: 0.870697
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.186578    reg_loss: 0.058916    l2_loss: 0.025622    loss: 0.271116
steps 6400    v_Prec: 0.578623  v_Recall: 0.635277  v_F1: 0.605628  v_AUC: 0.869752
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.189118    reg_loss: 0.058860    l2_loss: 0.026179    loss: 0.274158
steps 6600    v_Prec: 0.591799  v_Recall: 0.614006  v_F1: 0.602698  v_AUC: 0.870741
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.191776    reg_loss: 0.058660    l2_loss: 0.026594    loss: 0.277030
steps 6800    v_Prec: 0.571959  v_Recall: 0.637986  v_F1: 0.603171  v_AUC: 0.869670
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.200157    reg_loss: 0.058180    l2_loss: 0.026938    loss: 0.285274
steps 7000    v_Prec: 0.595358  v_Recall: 0.621256  v_F1: 0.608031  v_AUC: 0.871334
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.193015    reg_loss: 0.058159    l2_loss: 0.027356    loss: 0.278531
steps 7200    v_Prec: 0.571965  v_Recall: 0.643642  v_F1: 0.605690  v_AUC: 0.871181
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.203142    reg_loss: 0.057844    l2_loss: 0.027665    loss: 0.288652
steps 7400    v_Prec: 0.582929  v_Recall: 0.642049  v_F1: 0.611063  v_AUC: 0.873981
steps 7400    running time 278 seconds

Early stop model F1: 0.623383
testing thre: 0.36440617
testing Prec: 0.4231032875435277
testing Recall: 0.7499878493317133
testing F1: 0.5410019983872664
testing AUC: 0.857629206421613
overall running time 281 seconds
(0.5719181297530749, 0.5921263669501823, 0.5818468371659861, 0.857629206421613, 0.614513)

2019-02-24 01:19:05.904820: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:19:06.640837: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:19:06.642229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:19:06.642266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.510000 seconds
loading data in 30.660000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.503631    reg_loss: 0.064985    l2_loss: 0.013312    loss: 0.581928
steps 200    v_Prec: 0.164612  v_Recall: 0.996747  v_F1: 0.282559  v_AUC: 0.525951
steps 200    running time 41 seconds

steps 400    base_loss: 0.491591    reg_loss: 0.064793    l2_loss: 0.013223    loss: 0.569606
steps 400    v_Prec: 0.170712  v_Recall: 0.880524  v_F1: 0.285979  v_AUC: 0.539394
steps 400    running time 47 seconds

steps 600    base_loss: 0.471750    reg_loss: 0.064460    l2_loss: 0.013150    loss: 0.549360
steps 600    v_Prec: 0.174791  v_Recall: 0.860214  v_F1: 0.290545  v_AUC: 0.562735
steps 600    running time 54 seconds

steps 800    base_loss: 0.454143    reg_loss: 0.064044    l2_loss: 0.013056    loss: 0.531243
steps 800    v_Prec: 0.203376  v_Recall: 0.579215  v_F1: 0.301047  v_AUC: 0.596487
steps 800    running time 61 seconds

steps 1000    base_loss: 0.436688    reg_loss: 0.063557    l2_loss: 0.013063    loss: 0.513308
steps 1000    v_Prec: 0.255701  v_Recall: 0.482110  v_F1: 0.334167  v_AUC: 0.642947
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.426939    reg_loss: 0.063056    l2_loss: 0.013033    loss: 0.503028
steps 1200    v_Prec: 0.395098  v_Recall: 0.406664  v_F1: 0.400798  v_AUC: 0.703338
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.401149    reg_loss: 0.062362    l2_loss: 0.013233    loss: 0.476744
steps 1400    v_Prec: 0.476480  v_Recall: 0.453233  v_F1: 0.464566  v_AUC: 0.756047
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.375309    reg_loss: 0.061609    l2_loss: 0.013385    loss: 0.450303
steps 1600    v_Prec: 0.563342  v_Recall: 0.487902  v_F1: 0.522915  v_AUC: 0.796822
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.353539    reg_loss: 0.060935    l2_loss: 0.013647    loss: 0.428121
steps 1800    v_Prec: 0.599618  v_Recall: 0.523602  v_F1: 0.559038  v_AUC: 0.821975
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.334322    reg_loss: 0.060229    l2_loss: 0.013876    loss: 0.408427
steps 2000    v_Prec: 0.620622  v_Recall: 0.555335  v_F1: 0.586166  v_AUC: 0.840012
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.327013    reg_loss: 0.059801    l2_loss: 0.014129    loss: 0.400943
steps 2200    v_Prec: 0.673244  v_Recall: 0.554939  v_F1: 0.608393  v_AUC: 0.851262
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.310241    reg_loss: 0.059248    l2_loss: 0.014373    loss: 0.383862
steps 2400    v_Prec: 0.694119  v_Recall: 0.558985  v_F1: 0.619265  v_AUC: 0.858014
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.305643    reg_loss: 0.058709    l2_loss: 0.014664    loss: 0.379015
steps 2600    v_Prec: 0.672388  v_Recall: 0.599841  v_F1: 0.634046  v_AUC: 0.866486
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.301214    reg_loss: 0.058277    l2_loss: 0.014993    loss: 0.374485
steps 2800    v_Prec: 0.702738  v_Recall: 0.598651  v_F1: 0.646532  v_AUC: 0.871847
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.292113    reg_loss: 0.057723    l2_loss: 0.015307    loss: 0.365142
steps 3000    v_Prec: 0.699396  v_Recall: 0.615946  v_F1: 0.655024  v_AUC: 0.877138
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.284534    reg_loss: 0.057386    l2_loss: 0.015613    loss: 0.357532
steps 3200    v_Prec: 0.683517  v_Recall: 0.638239  v_F1: 0.660103  v_AUC: 0.881142
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.288200    reg_loss: 0.057096    l2_loss: 0.015945    loss: 0.361241
steps 3400    v_Prec: 0.702395  v_Recall: 0.635303  v_F1: 0.667167  v_AUC: 0.884147
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.286879    reg_loss: 0.056912    l2_loss: 0.016198    loss: 0.359989
steps 3600    v_Prec: 0.708160  v_Recall: 0.649901  v_F1: 0.677781  v_AUC: 0.887255
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.274211    reg_loss: 0.056559    l2_loss: 0.016502    loss: 0.347273
steps 3800    v_Prec: 0.719542  v_Recall: 0.643792  v_F1: 0.679563  v_AUC: 0.888702
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.278559    reg_loss: 0.056194    l2_loss: 0.016769    loss: 0.351521
steps 4000    v_Prec: 0.738550  v_Recall: 0.640936  v_F1: 0.686290  v_AUC: 0.892332
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.273283    reg_loss: 0.056040    l2_loss: 0.017182    loss: 0.346506
steps 4200    v_Prec: 0.745956  v_Recall: 0.643871  v_F1: 0.691165  v_AUC: 0.895365
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.276490    reg_loss: 0.055849    l2_loss: 0.017492    loss: 0.349831
steps 4400    v_Prec: 0.745987  v_Recall: 0.648869  v_F1: 0.694047  v_AUC: 0.896264
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.269797    reg_loss: 0.055632    l2_loss: 0.017870    loss: 0.343299
steps 4600    v_Prec: 0.750800  v_Recall: 0.651805  v_F1: 0.697809  v_AUC: 0.899315
steps 4600    running time 190 seconds

steps 4800    base_loss: 0.263655    reg_loss: 0.055344    l2_loss: 0.018148    loss: 0.337147
steps 4800    v_Prec: 0.722984  v_Recall: 0.682031  v_F1: 0.701911  v_AUC: 0.900834
steps 4800    running time 197 seconds

steps 5000    base_loss: 0.268515    reg_loss: 0.055380    l2_loss: 0.018501    loss: 0.342396
steps 5000    v_Prec: 0.761284  v_Recall: 0.658310  v_F1: 0.706063  v_AUC: 0.902610
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.261477    reg_loss: 0.055194    l2_loss: 0.018864    loss: 0.335536
steps 5200    v_Prec: 0.761135  v_Recall: 0.661563  v_F1: 0.707865  v_AUC: 0.903662
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.253707    reg_loss: 0.054657    l2_loss: 0.019363    loss: 0.327727
steps 5400    v_Prec: 0.762941  v_Recall: 0.659500  v_F1: 0.707459  v_AUC: 0.906242
steps 5400    running time 217 seconds

steps 5600    base_loss: 0.163032    reg_loss: 0.050640    l2_loss: 0.019770    loss: 0.233441
steps 5600    v_Prec: 0.756349  v_Recall: 0.663943  v_F1: 0.707140  v_AUC: 0.902939
steps 5600    running time 223 seconds

steps 5800    base_loss: 0.183366    reg_loss: 0.051173    l2_loss: 0.020380    loss: 0.254920
steps 5800    v_Prec: 0.749417  v_Recall: 0.662436  v_F1: 0.703247  v_AUC: 0.899397
steps 5800    running time 230 seconds

steps 6000    base_loss: 0.176107    reg_loss: 0.050938    l2_loss: 0.021098    loss: 0.248144
steps 6000    v_Prec: 0.766966  v_Recall: 0.642840  v_F1: 0.699439  v_AUC: 0.898607
steps 6000    running time 236 seconds

steps 6200    base_loss: 0.165614    reg_loss: 0.050476    l2_loss: 0.021634    loss: 0.237724
steps 6200    v_Prec: 0.751859  v_Recall: 0.657676  v_F1: 0.701621  v_AUC: 0.897467
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.182865    reg_loss: 0.050718    l2_loss: 0.022221    loss: 0.255804
steps 6400    v_Prec: 0.728285  v_Recall: 0.679810  v_F1: 0.703213  v_AUC: 0.898384
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.172166    reg_loss: 0.050287    l2_loss: 0.022769    loss: 0.245222
steps 6600    v_Prec: 0.762881  v_Recall: 0.661325  v_F1: 0.708482  v_AUC: 0.901889
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.179330    reg_loss: 0.050425    l2_loss: 0.023146    loss: 0.252901
steps 6800    v_Prec: 0.746688  v_Recall: 0.679572  v_F1: 0.711550  v_AUC: 0.902278
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.175365    reg_loss: 0.050321    l2_loss: 0.023433    loss: 0.249118
steps 7000    v_Prec: 0.778709  v_Recall: 0.656327  v_F1: 0.712299  v_AUC: 0.902184
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.189180    reg_loss: 0.050398    l2_loss: 0.023948    loss: 0.263526
steps 7200    v_Prec: 0.744620  v_Recall: 0.686315  v_F1: 0.714280  v_AUC: 0.904348
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.174729    reg_loss: 0.049582    l2_loss: 0.024039    loss: 0.248351
steps 7400    v_Prec: 0.781724  v_Recall: 0.658310  v_F1: 0.714729  v_AUC: 0.905356
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.185349    reg_loss: 0.050294    l2_loss: 0.024384    loss: 0.260027
steps 7600    v_Prec: 0.764998  v_Recall: 0.671718  v_F1: 0.715330  v_AUC: 0.906237
steps 7600    running time 288 seconds

steps 7800    base_loss: 0.183227    reg_loss: 0.049577    l2_loss: 0.024533    loss: 0.257337
steps 7800    v_Prec: 0.761199  v_Recall: 0.668624  v_F1: 0.711915  v_AUC: 0.904848
steps 7800    running time 295 seconds

steps 8000    base_loss: 0.174655    reg_loss: 0.049378    l2_loss: 0.024829    loss: 0.248862
steps 8000    v_Prec: 0.773907  v_Recall: 0.669655  v_F1: 0.718016  v_AUC: 0.907814
steps 8000    running time 301 seconds

steps 8200    base_loss: 0.190886    reg_loss: 0.049520    l2_loss: 0.024914    loss: 0.265320
steps 8200    v_Prec: 0.766750  v_Recall: 0.680920  v_F1: 0.721291  v_AUC: 0.909626
steps 8200    running time 307 seconds

steps 8400    base_loss: 0.184162    reg_loss: 0.048957    l2_loss: 0.025068    loss: 0.258187
steps 8400    v_Prec: 0.780172  v_Recall: 0.677985  v_F1: 0.725498  v_AUC: 0.911640
steps 8400    running time 314 seconds

steps 8600    base_loss: 0.182501    reg_loss: 0.048837    l2_loss: 0.025180    loss: 0.256518
steps 8600    v_Prec: 0.784814  v_Recall: 0.676478  v_F1: 0.726630  v_AUC: 0.912796
steps 8600    running time 321 seconds

steps 8800    base_loss: 0.191678    reg_loss: 0.048839    l2_loss: 0.025412    loss: 0.265930
steps 8800    v_Prec: 0.761494  v_Recall: 0.700357  v_F1: 0.729647  v_AUC: 0.913579
steps 8800    running time 328 seconds

steps 9000    base_loss: 0.185819    reg_loss: 0.048443    l2_loss: 0.025543    loss: 0.259805
steps 9000    v_Prec: 0.782644  v_Recall: 0.690440  v_F1: 0.733656  v_AUC: 0.916361
steps 9000    running time 335 seconds

steps 9200    base_loss: 0.178035    reg_loss: 0.048083    l2_loss: 0.025577    loss: 0.251695
steps 9200    v_Prec: 0.754018  v_Recall: 0.710829  v_F1: 0.731787  v_AUC: 0.916774
steps 9200    running time 341 seconds

steps 9400    base_loss: 0.193509    reg_loss: 0.048367    l2_loss: 0.025690    loss: 0.267566
steps 9400    v_Prec: 0.794386  v_Recall: 0.677985  v_F1: 0.731584  v_AUC: 0.916986
steps 9400    running time 347 seconds

steps 9600    base_loss: 0.179604    reg_loss: 0.047941    l2_loss: 0.025770    loss: 0.253316
steps 9600    v_Prec: 0.783943  v_Recall: 0.694883  v_F1: 0.736731  v_AUC: 0.917419
steps 9600    running time 354 seconds

steps 9800    base_loss: 0.178097    reg_loss: 0.047958    l2_loss: 0.025762    loss: 0.251817
steps 9800    v_Prec: 0.772409  v_Recall: 0.708925  v_F1: 0.739307  v_AUC: 0.918001
steps 9800    running time 360 seconds

steps 10000    base_loss: 0.183942    reg_loss: 0.047906    l2_loss: 0.025786    loss: 0.257633
steps 10000    v_Prec: 0.782861  v_Recall: 0.707338  v_F1: 0.743186  v_AUC: 0.920034
steps 10000    running time 367 seconds

steps 10200    base_loss: 0.183381    reg_loss: 0.047832    l2_loss: 0.025875    loss: 0.257088
steps 10200    v_Prec: 0.792250  v_Recall: 0.700674  v_F1: 0.743653  v_AUC: 0.921507
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.188553    reg_loss: 0.047599    l2_loss: 0.025993    loss: 0.262145
steps 10400    v_Prec: 0.769016  v_Recall: 0.722650  v_F1: 0.745112  v_AUC: 0.922509
steps 10400    running time 380 seconds

steps 10600    base_loss: 0.190804    reg_loss: 0.047617    l2_loss: 0.025947    loss: 0.264368
steps 10600    v_Prec: 0.781915  v_Recall: 0.711384  v_F1: 0.744984  v_AUC: 0.922048
steps 10600    running time 387 seconds

steps 10800    base_loss: 0.162973    reg_loss: 0.046497    l2_loss: 0.025870    loss: 0.235340
steps 10800    v_Prec: 0.790968  v_Recall: 0.707259  v_F1: 0.746775  v_AUC: 0.924210
steps 10800    running time 393 seconds

steps 11000    base_loss: 0.069272    reg_loss: 0.042260    l2_loss: 0.026059    loss: 0.137591
steps 11000    v_Prec: 0.788188  v_Recall: 0.704086  v_F1: 0.743767  v_AUC: 0.921357
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.066053    reg_loss: 0.042500    l2_loss: 0.025941    loss: 0.134494
steps 11200    v_Prec: 0.785014  v_Recall: 0.704800  v_F1: 0.742747  v_AUC: 0.920313
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.066924    reg_loss: 0.042522    l2_loss: 0.025774    loss: 0.135220
steps 11400    v_Prec: 0.771207  v_Recall: 0.709718  v_F1: 0.739186  v_AUC: 0.918387
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.073106    reg_loss: 0.042444    l2_loss: 0.025717    loss: 0.141267
steps 11600    v_Prec: 0.765164  v_Recall: 0.709560  v_F1: 0.736313  v_AUC: 0.915738
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.065754    reg_loss: 0.042716    l2_loss: 0.025890    loss: 0.134360
steps 11800    v_Prec: 0.762680  v_Recall: 0.709798  v_F1: 0.735289  v_AUC: 0.915971
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.074187    reg_loss: 0.042934    l2_loss: 0.025831    loss: 0.142952
steps 12000    v_Prec: 0.778646  v_Recall: 0.695438  v_F1: 0.734694  v_AUC: 0.914469
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.076325    reg_loss: 0.042983    l2_loss: 0.025987    loss: 0.145296
steps 12200    v_Prec: 0.781868  v_Recall: 0.695835  v_F1: 0.736347  v_AUC: 0.914739
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.077164    reg_loss: 0.043098    l2_loss: 0.026024    loss: 0.146286
steps 12400    v_Prec: 0.787876  v_Recall: 0.687743  v_F1: 0.734412  v_AUC: 0.914272
steps 12400    running time 443 seconds

steps 12600    base_loss: 0.079339    reg_loss: 0.042922    l2_loss: 0.026030    loss: 0.148291
steps 12600    v_Prec: 0.754279  v_Recall: 0.713288  v_F1: 0.733211  v_AUC: 0.915637
steps 12600    running time 449 seconds

steps 12800    base_loss: 0.076131    reg_loss: 0.043046    l2_loss: 0.026009    loss: 0.145186
steps 12800    v_Prec: 0.773303  v_Recall: 0.702261  v_F1: 0.736072  v_AUC: 0.916145
steps 12800    running time 455 seconds

Early stop model F1: 0.746775
testing thre: 0.58156186
testing Prec: 0.581230283911672
testing Recall: 0.7522235722964763
testing F1: 0.6557634048683346
testing AUC: 0.902401122142239
overall running time 458 seconds
(0.7263665420662008, 0.6516646415552856, 0.6869908285084798, 0.902401122142239, 0.8320386)

2019-02-24 01:24:22.592696: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:24:22.841013: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:24:22.842762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:24:22.842803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.460000 seconds
loading data in 30.570000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.534014    reg_loss: 0.064695    l2_loss: 0.013310    loss: 0.612019
steps 200    v_Prec: 0.162089  v_Recall: 0.983281  v_F1: 0.278301  v_AUC: 0.491318
steps 200    running time 40 seconds

steps 400    base_loss: 0.511093    reg_loss: 0.064716    l2_loss: 0.013212    loss: 0.589020
steps 400    v_Prec: 0.163886  v_Recall: 0.942654  v_F1: 0.279227  v_AUC: 0.526093
steps 400    running time 47 seconds

steps 600    base_loss: 0.486958    reg_loss: 0.064473    l2_loss: 0.013054    loss: 0.564485
steps 600    v_Prec: 0.185295  v_Recall: 0.679267  v_F1: 0.291165  v_AUC: 0.580875
steps 600    running time 54 seconds

steps 800    base_loss: 0.455557    reg_loss: 0.064350    l2_loss: 0.012947    loss: 0.532853
steps 800    v_Prec: 0.260983  v_Recall: 0.444794  v_F1: 0.328953  v_AUC: 0.646187
steps 800    running time 61 seconds

steps 1000    base_loss: 0.434189    reg_loss: 0.063836    l2_loss: 0.012831    loss: 0.510857
steps 1000    v_Prec: 0.294006  v_Recall: 0.487683  v_F1: 0.366851  v_AUC: 0.686651
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.422735    reg_loss: 0.063478    l2_loss: 0.012701    loss: 0.498914
steps 1200    v_Prec: 0.363211  v_Recall: 0.457556  v_F1: 0.404961  v_AUC: 0.720378
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.414518    reg_loss: 0.063314    l2_loss: 0.012681    loss: 0.490513
steps 1400    v_Prec: 0.423483  v_Recall: 0.473387  v_F1: 0.447046  v_AUC: 0.752619
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.387889    reg_loss: 0.063253    l2_loss: 0.012789    loss: 0.463931
steps 1600    v_Prec: 0.473198  v_Recall: 0.484129  v_F1: 0.478601  v_AUC: 0.779541
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.363705    reg_loss: 0.063648    l2_loss: 0.012960    loss: 0.440313
steps 1800    v_Prec: 0.535173  v_Recall: 0.499556  v_F1: 0.516752  v_AUC: 0.804193
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.353958    reg_loss: 0.064097    l2_loss: 0.013180    loss: 0.431234
steps 2000    v_Prec: 0.562929  v_Recall: 0.530329  v_F1: 0.546143  v_AUC: 0.825178
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.343685    reg_loss: 0.064961    l2_loss: 0.013379    loss: 0.422025
steps 2200    v_Prec: 0.550602  v_Recall: 0.591471  v_F1: 0.570305  v_AUC: 0.839759
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.329579    reg_loss: 0.065312    l2_loss: 0.013651    loss: 0.408542
steps 2400    v_Prec: 0.592207  v_Recall: 0.579436  v_F1: 0.585752  v_AUC: 0.850616
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.310394    reg_loss: 0.065676    l2_loss: 0.013849    loss: 0.389920
steps 2600    v_Prec: 0.605922  v_Recall: 0.588402  v_F1: 0.597033  v_AUC: 0.858764
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.311312    reg_loss: 0.066275    l2_loss: 0.014152    loss: 0.391739
steps 2800    v_Prec: 0.598079  v_Recall: 0.618609  v_F1: 0.608171  v_AUC: 0.865738
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.308324    reg_loss: 0.066757    l2_loss: 0.014457    loss: 0.389538
steps 3000    v_Prec: 0.648882  v_Recall: 0.602132  v_F1: 0.624633  v_AUC: 0.871892
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.298264    reg_loss: 0.066877    l2_loss: 0.014768    loss: 0.379909
steps 3200    v_Prec: 0.635552  v_Recall: 0.620871  v_F1: 0.628126  v_AUC: 0.876066
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.298237    reg_loss: 0.067111    l2_loss: 0.015146    loss: 0.380493
steps 3400    v_Prec: 0.661119  v_Recall: 0.603182  v_F1: 0.630823  v_AUC: 0.880215
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.290367    reg_loss: 0.067320    l2_loss: 0.015534    loss: 0.373222
steps 3600    v_Prec: 0.682375  v_Recall: 0.598821  v_F1: 0.637873  v_AUC: 0.883497
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.291172    reg_loss: 0.067406    l2_loss: 0.016012    loss: 0.374590
steps 3800    v_Prec: 0.649413  v_Recall: 0.630321  v_F1: 0.639725  v_AUC: 0.885235
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.287561    reg_loss: 0.067581    l2_loss: 0.016453    loss: 0.371595
steps 4000    v_Prec: 0.662040  v_Recall: 0.639528  v_F1: 0.650590  v_AUC: 0.889642
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.284027    reg_loss: 0.067493    l2_loss: 0.017049    loss: 0.368569
steps 4200    v_Prec: 0.667557  v_Recall: 0.645667  v_F1: 0.656430  v_AUC: 0.891438
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.279133    reg_loss: 0.067638    l2_loss: 0.017551    loss: 0.364322
steps 4400    v_Prec: 0.660210  v_Recall: 0.644213  v_F1: 0.652113  v_AUC: 0.892149
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.278510    reg_loss: 0.067646    l2_loss: 0.018238    loss: 0.364394
steps 4600    v_Prec: 0.670028  v_Recall: 0.638640  v_F1: 0.653957  v_AUC: 0.895195
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.270937    reg_loss: 0.067792    l2_loss: 0.018814    loss: 0.357542
steps 4800    v_Prec: 0.656748  v_Recall: 0.659559  v_F1: 0.658150  v_AUC: 0.897223
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.278225    reg_loss: 0.067829    l2_loss: 0.019445    loss: 0.365499
steps 5000    v_Prec: 0.666096  v_Recall: 0.660447  v_F1: 0.663260  v_AUC: 0.898590
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.275591    reg_loss: 0.067920    l2_loss: 0.020064    loss: 0.363576
steps 5200    v_Prec: 0.668810  v_Recall: 0.655197  v_F1: 0.661934  v_AUC: 0.899746
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.259814    reg_loss: 0.067623    l2_loss: 0.020735    loss: 0.348173
steps 5400    v_Prec: 0.705733  v_Recall: 0.627413  v_F1: 0.664272  v_AUC: 0.901311
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.187172    reg_loss: 0.068742    l2_loss: 0.021540    loss: 0.277454
steps 5600    v_Prec: 0.670124  v_Recall: 0.641871  v_F1: 0.655693  v_AUC: 0.894961
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.174419    reg_loss: 0.068660    l2_loss: 0.022484    loss: 0.265564
steps 5800    v_Prec: 0.631667  v_Recall: 0.673451  v_F1: 0.651890  v_AUC: 0.894058
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.190793    reg_loss: 0.068563    l2_loss: 0.023079    loss: 0.282434
steps 6000    v_Prec: 0.653489  v_Recall: 0.654228  v_F1: 0.653859  v_AUC: 0.893821
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.191648    reg_loss: 0.068542    l2_loss: 0.023843    loss: 0.284033
steps 6200    v_Prec: 0.668072  v_Recall: 0.652532  v_F1: 0.660211  v_AUC: 0.894749
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.189393    reg_loss: 0.068500    l2_loss: 0.024375    loss: 0.282268
steps 6400    v_Prec: 0.653176  v_Recall: 0.663517  v_F1: 0.658306  v_AUC: 0.894902
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.199697    reg_loss: 0.068556    l2_loss: 0.024914    loss: 0.293167
steps 6600    v_Prec: 0.700359  v_Recall: 0.629594  v_F1: 0.663094  v_AUC: 0.896716
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.196344    reg_loss: 0.068478    l2_loss: 0.025377    loss: 0.290198
steps 6800    v_Prec: 0.677818  v_Recall: 0.646394  v_F1: 0.661733  v_AUC: 0.895348
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.192262    reg_loss: 0.068343    l2_loss: 0.025866    loss: 0.286470
steps 7000    v_Prec: 0.693984  v_Recall: 0.645667  v_F1: 0.668954  v_AUC: 0.897987
steps 7000    running time 261 seconds

steps 7200    base_loss: 0.194595    reg_loss: 0.068419    l2_loss: 0.026260    loss: 0.289274
steps 7200    v_Prec: 0.694327  v_Recall: 0.647444  v_F1: 0.670066  v_AUC: 0.899061
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.189815    reg_loss: 0.068078    l2_loss: 0.026732    loss: 0.284625
steps 7400    v_Prec: 0.684851  v_Recall: 0.649948  v_F1: 0.666943  v_AUC: 0.898018
steps 7400    running time 274 seconds

steps 7600    base_loss: 0.187236    reg_loss: 0.068281    l2_loss: 0.027076    loss: 0.282593
steps 7600    v_Prec: 0.695891  v_Recall: 0.655197  v_F1: 0.674931  v_AUC: 0.901524
steps 7600    running time 280 seconds

steps 7800    base_loss: 0.193430    reg_loss: 0.068175    l2_loss: 0.027430    loss: 0.289035
steps 7800    v_Prec: 0.676868  v_Recall: 0.675228  v_F1: 0.676047  v_AUC: 0.902262
steps 7800    running time 288 seconds

steps 8000    base_loss: 0.191489    reg_loss: 0.068136    l2_loss: 0.027815    loss: 0.287439
steps 8000    v_Prec: 0.702323  v_Recall: 0.649624  v_F1: 0.674947  v_AUC: 0.902072
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.195642    reg_loss: 0.068221    l2_loss: 0.027969    loss: 0.291832
steps 8200    v_Prec: 0.699415  v_Recall: 0.665859  v_F1: 0.682224  v_AUC: 0.904480
steps 8200    running time 301 seconds

steps 8400    base_loss: 0.197874    reg_loss: 0.068323    l2_loss: 0.028323    loss: 0.294520
steps 8400    v_Prec: 0.711492  v_Recall: 0.667071  v_F1: 0.688566  v_AUC: 0.907725
steps 8400    running time 307 seconds

steps 8600    base_loss: 0.187884    reg_loss: 0.068179    l2_loss: 0.028647    loss: 0.284710
steps 8600    v_Prec: 0.706575  v_Recall: 0.669251  v_F1: 0.687407  v_AUC: 0.907686
steps 8600    running time 314 seconds

steps 8800    base_loss: 0.195164    reg_loss: 0.068025    l2_loss: 0.028892    loss: 0.292081
steps 8800    v_Prec: 0.717306  v_Recall: 0.663194  v_F1: 0.689189  v_AUC: 0.908400
steps 8800    running time 320 seconds

steps 9000    base_loss: 0.196013    reg_loss: 0.067875    l2_loss: 0.029318    loss: 0.293206
steps 9000    v_Prec: 0.709843  v_Recall: 0.682094  v_F1: 0.695692  v_AUC: 0.910165
steps 9000    running time 327 seconds

steps 9200    base_loss: 0.197086    reg_loss: 0.067985    l2_loss: 0.029510    loss: 0.294581
steps 9200    v_Prec: 0.729307  v_Recall: 0.671109  v_F1: 0.698999  v_AUC: 0.911653
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.191134    reg_loss: 0.068000    l2_loss: 0.029769    loss: 0.288903
steps 9400    v_Prec: 0.705590  v_Recall: 0.698409  v_F1: 0.701981  v_AUC: 0.913932
steps 9400    running time 340 seconds

steps 9600    base_loss: 0.189404    reg_loss: 0.067731    l2_loss: 0.029906    loss: 0.287041
steps 9600    v_Prec: 0.731829  v_Recall: 0.673370  v_F1: 0.701384  v_AUC: 0.914832
steps 9600    running time 347 seconds

steps 9800    base_loss: 0.194207    reg_loss: 0.067645    l2_loss: 0.030118    loss: 0.291971
steps 9800    v_Prec: 0.716714  v_Recall: 0.691301  v_F1: 0.703778  v_AUC: 0.915731
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.186373    reg_loss: 0.067477    l2_loss: 0.030370    loss: 0.284220
steps 10000    v_Prec: 0.724838  v_Recall: 0.688717  v_F1: 0.706316  v_AUC: 0.916702
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.193048    reg_loss: 0.067822    l2_loss: 0.030468    loss: 0.291338
steps 10200    v_Prec: 0.732039  v_Recall: 0.682255  v_F1: 0.706271  v_AUC: 0.918507
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.192021    reg_loss: 0.067809    l2_loss: 0.030685    loss: 0.290514
steps 10400    v_Prec: 0.748411  v_Recall: 0.675147  v_F1: 0.709894  v_AUC: 0.919506
steps 10400    running time 373 seconds

steps 10600    base_loss: 0.188635    reg_loss: 0.067631    l2_loss: 0.030813    loss: 0.287080
steps 10600    v_Prec: 0.723301  v_Recall: 0.700751  v_F1: 0.711848  v_AUC: 0.922329
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.183641    reg_loss: 0.067573    l2_loss: 0.031107    loss: 0.282321
steps 10800    v_Prec: 0.725541  v_Recall: 0.701397  v_F1: 0.713265  v_AUC: 0.921949
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.084549    reg_loss: 0.067298    l2_loss: 0.031235    loss: 0.183081
steps 11000    v_Prec: 0.731938  v_Recall: 0.669332  v_F1: 0.699236  v_AUC: 0.911506
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.079694    reg_loss: 0.066937    l2_loss: 0.031350    loss: 0.177981
steps 11200    v_Prec: 0.683841  v_Recall: 0.692513  v_F1: 0.688150  v_AUC: 0.905805
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.079823    reg_loss: 0.066705    l2_loss: 0.031377    loss: 0.177905
steps 11400    v_Prec: 0.725069  v_Recall: 0.654794  v_F1: 0.688142  v_AUC: 0.906161
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.081758    reg_loss: 0.066861    l2_loss: 0.031566    loss: 0.180186
steps 11600    v_Prec: 0.696126  v_Recall: 0.666101  v_F1: 0.680783  v_AUC: 0.902406
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.080077    reg_loss: 0.066562    l2_loss: 0.031636    loss: 0.178274
steps 11800    v_Prec: 0.719691  v_Recall: 0.646798  v_F1: 0.681300  v_AUC: 0.901774
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.089895    reg_loss: 0.066559    l2_loss: 0.031777    loss: 0.188230
steps 12000    v_Prec: 0.692741  v_Recall: 0.665213  v_F1: 0.678698  v_AUC: 0.901426
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.091406    reg_loss: 0.066728    l2_loss: 0.031952    loss: 0.190085
steps 12200    v_Prec: 0.674481  v_Recall: 0.666909  v_F1: 0.670674  v_AUC: 0.897991
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.089388    reg_loss: 0.066504    l2_loss: 0.032083    loss: 0.187975
steps 12400    v_Prec: 0.683747  v_Recall: 0.664971  v_F1: 0.674228  v_AUC: 0.899873
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.090883    reg_loss: 0.066538    l2_loss: 0.032312    loss: 0.189733
steps 12600    v_Prec: 0.688182  v_Recall: 0.646717  v_F1: 0.666805  v_AUC: 0.896767
steps 12600    running time 443 seconds

steps 12800    base_loss: 0.087174    reg_loss: 0.066512    l2_loss: 0.032419    loss: 0.186104
steps 12800    v_Prec: 0.690968  v_Recall: 0.650674  v_F1: 0.670216  v_AUC: 0.898722
steps 12800    running time 450 seconds

Early stop model F1: 0.713265
testing thre: 0.31094402
testing Prec: 0.5244484799569545
testing Recall: 0.757958687727825
testing F1: 0.6199439486394626
testing AUC: 0.8964909102572065
overall running time 452 seconds
(0.6693143384236958, 0.6347995139732685, 0.6516001895781885, 0.8964909102572065, 0.6307592)

2019-02-24 01:29:36.559740: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:29:37.385991: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:29:37.510554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:29:37.510637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.120000 seconds
loading data in 30.230000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.070804    reg_loss: 0.065021    l2_loss: 0.013321    loss: 1.149146
steps 200    v_Prec: 0.163515  v_Recall: 0.963300  v_F1: 0.279574  v_AUC: 0.522219
steps 200    running time 40 seconds

steps 400    base_loss: 0.708272    reg_loss: 0.064343    l2_loss: 0.013386    loss: 0.786001
steps 400    v_Prec: 0.170916  v_Recall: 0.835171  v_F1: 0.283761  v_AUC: 0.547326
steps 400    running time 47 seconds

steps 600    base_loss: 0.505377    reg_loss: 0.063862    l2_loss: 0.013496    loss: 0.582735
steps 600    v_Prec: 0.177320  v_Recall: 0.759115  v_F1: 0.287486  v_AUC: 0.566201
steps 600    running time 54 seconds

steps 800    base_loss: 0.465689    reg_loss: 0.063220    l2_loss: 0.013359    loss: 0.542268
steps 800    v_Prec: 0.216714  v_Recall: 0.545996  v_F1: 0.310275  v_AUC: 0.616622
steps 800    running time 61 seconds

steps 1000    base_loss: 0.470080    reg_loss: 0.062915    l2_loss: 0.013130    loss: 0.546125
steps 1000    v_Prec: 0.274349  v_Recall: 0.436861  v_F1: 0.337038  v_AUC: 0.655282
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.457570    reg_loss: 0.061903    l2_loss: 0.012907    loss: 0.532380
steps 1200    v_Prec: 0.341284  v_Recall: 0.407646  v_F1: 0.371525  v_AUC: 0.690625
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.445891    reg_loss: 0.061014    l2_loss: 0.012814    loss: 0.519719
steps 1400    v_Prec: 0.448643  v_Recall: 0.430986  v_F1: 0.439637  v_AUC: 0.746127
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.417105    reg_loss: 0.059739    l2_loss: 0.012891    loss: 0.489735
steps 1600    v_Prec: 0.474867  v_Recall: 0.508652  v_F1: 0.491179  v_AUC: 0.782011
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.390488    reg_loss: 0.058595    l2_loss: 0.013021    loss: 0.462104
steps 1800    v_Prec: 0.540172  v_Recall: 0.520000  v_F1: 0.529894  v_AUC: 0.807995
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.361072    reg_loss: 0.057477    l2_loss: 0.013250    loss: 0.431799
steps 2000    v_Prec: 0.585970  v_Recall: 0.542535  v_F1: 0.563417  v_AUC: 0.829763
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.332909    reg_loss: 0.056653    l2_loss: 0.013608    loss: 0.403169
steps 2200    v_Prec: 0.637540  v_Recall: 0.554930  v_F1: 0.593373  v_AUC: 0.845346
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.319434    reg_loss: 0.056066    l2_loss: 0.014029    loss: 0.389529
steps 2400    v_Prec: 0.653091  v_Recall: 0.583340  v_F1: 0.616248  v_AUC: 0.857423
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.309505    reg_loss: 0.055561    l2_loss: 0.014458    loss: 0.379524
steps 2600    v_Prec: 0.647836  v_Recall: 0.611911  v_F1: 0.629361  v_AUC: 0.864270
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.301002    reg_loss: 0.055015    l2_loss: 0.014899    loss: 0.370916
steps 2800    v_Prec: 0.671820  v_Recall: 0.615533  v_F1: 0.642446  v_AUC: 0.872097
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.292785    reg_loss: 0.054463    l2_loss: 0.015319    loss: 0.362567
steps 3000    v_Prec: 0.707179  v_Recall: 0.604105  v_F1: 0.651591  v_AUC: 0.876763
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.275629    reg_loss: 0.053761    l2_loss: 0.015719    loss: 0.345109
steps 3200    v_Prec: 0.719391  v_Recall: 0.604346  v_F1: 0.656869  v_AUC: 0.879095
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.281430    reg_loss: 0.053742    l2_loss: 0.016166    loss: 0.351338
steps 3400    v_Prec: 0.736145  v_Recall: 0.612555  v_F1: 0.668687  v_AUC: 0.883793
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.280961    reg_loss: 0.053418    l2_loss: 0.016551    loss: 0.350931
steps 3600    v_Prec: 0.735557  v_Recall: 0.623018  v_F1: 0.674626  v_AUC: 0.884988
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.286483    reg_loss: 0.053221    l2_loss: 0.016997    loss: 0.356701
steps 3800    v_Prec: 0.740840  v_Recall: 0.624869  v_F1: 0.677931  v_AUC: 0.887871
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.278116    reg_loss: 0.052716    l2_loss: 0.017385    loss: 0.348217
steps 4000    v_Prec: 0.733963  v_Recall: 0.644588  v_F1: 0.686378  v_AUC: 0.891941
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.273841    reg_loss: 0.052355    l2_loss: 0.017757    loss: 0.343953
steps 4200    v_Prec: 0.732510  v_Recall: 0.648853  v_F1: 0.688148  v_AUC: 0.893512
steps 4200    running time 177 seconds

steps 4400    base_loss: 0.270499    reg_loss: 0.052193    l2_loss: 0.018242    loss: 0.340933
steps 4400    v_Prec: 0.755098  v_Recall: 0.643702  v_F1: 0.694965  v_AUC: 0.895641
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.270994    reg_loss: 0.051936    l2_loss: 0.018656    loss: 0.341586
steps 4600    v_Prec: 0.744926  v_Recall: 0.655775  v_F1: 0.697513  v_AUC: 0.898211
steps 4600    running time 190 seconds

steps 4800    base_loss: 0.266991    reg_loss: 0.051677    l2_loss: 0.019069    loss: 0.337737
steps 4800    v_Prec: 0.731834  v_Recall: 0.667928  v_F1: 0.698422  v_AUC: 0.899331
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.264504    reg_loss: 0.051704    l2_loss: 0.019561    loss: 0.335769
steps 5000    v_Prec: 0.735518  v_Recall: 0.668330  v_F1: 0.700316  v_AUC: 0.900874
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.262686    reg_loss: 0.051505    l2_loss: 0.019954    loss: 0.334146
steps 5200    v_Prec: 0.757939  v_Recall: 0.656982  v_F1: 0.703859  v_AUC: 0.904388
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.252043    reg_loss: 0.051359    l2_loss: 0.020404    loss: 0.323807
steps 5400    v_Prec: 0.718310  v_Recall: 0.693682  v_F1: 0.705781  v_AUC: 0.904401
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.175044    reg_loss: 0.048641    l2_loss: 0.020928    loss: 0.244614
steps 5600    v_Prec: 0.727062  v_Recall: 0.681771  v_F1: 0.703688  v_AUC: 0.899016
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.177397    reg_loss: 0.048656    l2_loss: 0.021648    loss: 0.247701
steps 5800    v_Prec: 0.783416  v_Recall: 0.644829  v_F1: 0.707399  v_AUC: 0.899178
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.179652    reg_loss: 0.048257    l2_loss: 0.022330    loss: 0.250239
steps 6000    v_Prec: 0.753679  v_Recall: 0.663662  v_F1: 0.705812  v_AUC: 0.897761
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.169856    reg_loss: 0.048161    l2_loss: 0.022832    loss: 0.240849
steps 6200    v_Prec: 0.764882  v_Recall: 0.656660  v_F1: 0.706652  v_AUC: 0.898243
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.178634    reg_loss: 0.048090    l2_loss: 0.023396    loss: 0.250120
steps 6400    v_Prec: 0.757813  v_Recall: 0.661569  v_F1: 0.706428  v_AUC: 0.899459
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.180260    reg_loss: 0.047665    l2_loss: 0.023845    loss: 0.251770
steps 6600    v_Prec: 0.758318  v_Recall: 0.667686  v_F1: 0.710122  v_AUC: 0.900913
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.175834    reg_loss: 0.047576    l2_loss: 0.024133    loss: 0.247543
steps 6800    v_Prec: 0.773214  v_Recall: 0.651429  v_F1: 0.707116  v_AUC: 0.900714
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.198445    reg_loss: 0.048077    l2_loss: 0.024503    loss: 0.271025
steps 7000    v_Prec: 0.762771  v_Recall: 0.671791  v_F1: 0.714396  v_AUC: 0.904177
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.187030    reg_loss: 0.047317    l2_loss: 0.024762    loss: 0.259108
steps 7200    v_Prec: 0.765913  v_Recall: 0.673078  v_F1: 0.716501  v_AUC: 0.903474
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.186002    reg_loss: 0.047160    l2_loss: 0.025062    loss: 0.258224
steps 7400    v_Prec: 0.758852  v_Recall: 0.683058  v_F1: 0.718963  v_AUC: 0.905425
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.183251    reg_loss: 0.047011    l2_loss: 0.025326    loss: 0.255588
steps 7600    v_Prec: 0.764919  v_Recall: 0.679839  v_F1: 0.719874  v_AUC: 0.907668
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.198470    reg_loss: 0.047155    l2_loss: 0.025530    loss: 0.271155
steps 7800    v_Prec: 0.740662  v_Recall: 0.697384  v_F1: 0.718372  v_AUC: 0.907041
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.183361    reg_loss: 0.046704    l2_loss: 0.025858    loss: 0.255923
steps 8000    v_Prec: 0.749171  v_Recall: 0.691348  v_F1: 0.719099  v_AUC: 0.905761
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.185218    reg_loss: 0.046478    l2_loss: 0.026043    loss: 0.257740
steps 8200    v_Prec: 0.770523  v_Recall: 0.682897  v_F1: 0.724069  v_AUC: 0.908555
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.180894    reg_loss: 0.046227    l2_loss: 0.026135    loss: 0.253256
steps 8400    v_Prec: 0.764441  v_Recall: 0.695533  v_F1: 0.728361  v_AUC: 0.909243
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.184211    reg_loss: 0.046142    l2_loss: 0.026457    loss: 0.256809
steps 8600    v_Prec: 0.764442  v_Recall: 0.698672  v_F1: 0.730079  v_AUC: 0.911358
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.186386    reg_loss: 0.045959    l2_loss: 0.026554    loss: 0.258898
steps 8800    v_Prec: 0.762910  v_Recall: 0.697948  v_F1: 0.728985  v_AUC: 0.912006
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.187464    reg_loss: 0.045866    l2_loss: 0.026716    loss: 0.260045
steps 9000    v_Prec: 0.771105  v_Recall: 0.695453  v_F1: 0.731327  v_AUC: 0.912752
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.185100    reg_loss: 0.045772    l2_loss: 0.026702    loss: 0.257574
steps 9200    v_Prec: 0.766825  v_Recall: 0.700604  v_F1: 0.732220  v_AUC: 0.912484
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.188720    reg_loss: 0.045845    l2_loss: 0.026768    loss: 0.261333
steps 9400    v_Prec: 0.796793  v_Recall: 0.683863  v_F1: 0.736021  v_AUC: 0.914211
steps 9400    running time 346 seconds

steps 9600    base_loss: 0.181901    reg_loss: 0.045565    l2_loss: 0.026768    loss: 0.254235
steps 9600    v_Prec: 0.784564  v_Recall: 0.697867  v_F1: 0.738680  v_AUC: 0.915751
steps 9600    running time 353 seconds

steps 9800    base_loss: 0.184954    reg_loss: 0.045448    l2_loss: 0.026921    loss: 0.257324
steps 9800    v_Prec: 0.780828  v_Recall: 0.702777  v_F1: 0.739749  v_AUC: 0.916747
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.186507    reg_loss: 0.045372    l2_loss: 0.027046    loss: 0.258925
steps 10000    v_Prec: 0.792816  v_Recall: 0.696338  v_F1: 0.741452  v_AUC: 0.917022
steps 10000    running time 366 seconds

steps 10200    base_loss: 0.191275    reg_loss: 0.045580    l2_loss: 0.027009    loss: 0.263864
steps 10200    v_Prec: 0.774131  v_Recall: 0.711952  v_F1: 0.741741  v_AUC: 0.918181
steps 10200    running time 372 seconds

steps 10400    base_loss: 0.180588    reg_loss: 0.045142    l2_loss: 0.027086    loss: 0.252816
steps 10400    v_Prec: 0.781112  v_Recall: 0.710262  v_F1: 0.744004  v_AUC: 0.919348
steps 10400    running time 379 seconds

steps 10600    base_loss: 0.189168    reg_loss: 0.045242    l2_loss: 0.027064    loss: 0.261475
steps 10600    v_Prec: 0.781892  v_Recall: 0.713803  v_F1: 0.746298  v_AUC: 0.920319
steps 10600    running time 386 seconds

steps 10800    base_loss: 0.176261    reg_loss: 0.044661    l2_loss: 0.027160    loss: 0.248081
steps 10800    v_Prec: 0.783167  v_Recall: 0.712193  v_F1: 0.745996  v_AUC: 0.920979
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.068564    reg_loss: 0.040433    l2_loss: 0.026939    loss: 0.135935
steps 11000    v_Prec: 0.783031  v_Recall: 0.713078  v_F1: 0.746420  v_AUC: 0.918840
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.072027    reg_loss: 0.040879    l2_loss: 0.026865    loss: 0.139771
steps 11200    v_Prec: 0.790050  v_Recall: 0.696579  v_F1: 0.740376  v_AUC: 0.914906
steps 11200    running time 406 seconds

steps 11400    base_loss: 0.069914    reg_loss: 0.041098    l2_loss: 0.026967    loss: 0.137979
steps 11400    v_Prec: 0.792989  v_Recall: 0.689980  v_F1: 0.737907  v_AUC: 0.913047
steps 11400    running time 412 seconds

steps 11600    base_loss: 0.076869    reg_loss: 0.041186    l2_loss: 0.026918    loss: 0.144974
steps 11600    v_Prec: 0.784935  v_Recall: 0.689416  v_F1: 0.734082  v_AUC: 0.912925
steps 11600    running time 418 seconds

steps 11800    base_loss: 0.076030    reg_loss: 0.041127    l2_loss: 0.026948    loss: 0.144105
steps 11800    v_Prec: 0.778748  v_Recall: 0.688934  v_F1: 0.731093  v_AUC: 0.910524
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.076843    reg_loss: 0.041245    l2_loss: 0.026900    loss: 0.144989
steps 12000    v_Prec: 0.767617  v_Recall: 0.703984  v_F1: 0.734425  v_AUC: 0.912940
steps 12000    running time 431 seconds

steps 12200    base_loss: 0.077952    reg_loss: 0.041302    l2_loss: 0.026931    loss: 0.146185
steps 12200    v_Prec: 0.773377  v_Recall: 0.696258  v_F1: 0.732794  v_AUC: 0.913032
steps 12200    running time 438 seconds

steps 12400    base_loss: 0.085000    reg_loss: 0.041337    l2_loss: 0.026888    loss: 0.153225
steps 12400    v_Prec: 0.771119  v_Recall: 0.697948  v_F1: 0.732711  v_AUC: 0.912673
steps 12400    running time 444 seconds

steps 12600    base_loss: 0.085799    reg_loss: 0.041261    l2_loss: 0.026960    loss: 0.154021
steps 12600    v_Prec: 0.768787  v_Recall: 0.696579  v_F1: 0.730904  v_AUC: 0.912244
steps 12600    running time 450 seconds

steps 12800    base_loss: 0.086803    reg_loss: 0.041262    l2_loss: 0.026885    loss: 0.154950
steps 12800    v_Prec: 0.769292  v_Recall: 0.701247  v_F1: 0.733695  v_AUC: 0.913595
steps 12800    running time 456 seconds

steps 13000    base_loss: 0.087583    reg_loss: 0.041368    l2_loss: 0.027007    loss: 0.155958
steps 13000    v_Prec: 0.775132  v_Recall: 0.696901  v_F1: 0.733938  v_AUC: 0.914046
steps 13000    running time 462 seconds

Early stop model F1: 0.746420
testing thre: 0.67836076
testing Prec: 0.5675772056201412
testing Recall: 0.7735601458080195
testing F1: 0.6547503959520333
testing AUC: 0.9047652160417791
overall running time 465 seconds
(0.7383843289622795, 0.6650303766707168, 0.6997903135068788, 0.9047652160417791, 0.94257265)

2019-02-24 01:34:55.781817: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:34:57.430741: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:34:57.435113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:34:57.435154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.610000 seconds
loading data in 29.610000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.510658    reg_loss: 0.064697    l2_loss: 0.013352    loss: 0.588707
steps 200    v_Prec: 0.164025  v_Recall: 0.992111  v_F1: 0.281509  v_AUC: 0.494235
steps 200    running time 40 seconds

steps 400    base_loss: 0.492713    reg_loss: 0.064498    l2_loss: 0.013274    loss: 0.570486
steps 400    v_Prec: 0.164051  v_Recall: 0.994741  v_F1: 0.281653  v_AUC: 0.502866
steps 400    running time 47 seconds

steps 600    base_loss: 0.476000    reg_loss: 0.064071    l2_loss: 0.013146    loss: 0.553218
steps 600    v_Prec: 0.164149  v_Recall: 0.990437  v_F1: 0.281623  v_AUC: 0.502919
steps 600    running time 54 seconds

steps 800    base_loss: 0.464132    reg_loss: 0.064042    l2_loss: 0.012995    loss: 0.541169
steps 800    v_Prec: 0.163915  v_Recall: 0.996812  v_F1: 0.281534  v_AUC: 0.517727
steps 800    running time 60 seconds

steps 1000    base_loss: 0.448210    reg_loss: 0.063722    l2_loss: 0.012953    loss: 0.524886
steps 1000    v_Prec: 0.164235  v_Recall: 0.994103  v_F1: 0.281899  v_AUC: 0.537984
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.464743    reg_loss: 0.063885    l2_loss: 0.012874    loss: 0.541501
steps 1200    v_Prec: 0.196646  v_Recall: 0.566260  v_F1: 0.291917  v_AUC: 0.582063
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.442897    reg_loss: 0.063323    l2_loss: 0.012834    loss: 0.519054
steps 1400    v_Prec: 0.262810  v_Recall: 0.434457  v_F1: 0.327506  v_AUC: 0.635798
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.429017    reg_loss: 0.063108    l2_loss: 0.012890    loss: 0.505015
steps 1600    v_Prec: 0.378740  v_Recall: 0.397482  v_F1: 0.387884  v_AUC: 0.690616
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.406174    reg_loss: 0.062494    l2_loss: 0.012970    loss: 0.481638
steps 1800    v_Prec: 0.427754  v_Recall: 0.446809  v_F1: 0.437074  v_AUC: 0.733273
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.384227    reg_loss: 0.061909    l2_loss: 0.013101    loss: 0.459238
steps 2000    v_Prec: 0.502436  v_Recall: 0.451988  v_F1: 0.475879  v_AUC: 0.762747
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.380491    reg_loss: 0.061735    l2_loss: 0.013162    loss: 0.455388
steps 2200    v_Prec: 0.490244  v_Recall: 0.522591  v_F1: 0.505901  v_AUC: 0.788013
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.356956    reg_loss: 0.061087    l2_loss: 0.013240    loss: 0.431283
steps 2400    v_Prec: 0.545253  v_Recall: 0.529524  v_F1: 0.537274  v_AUC: 0.803193
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.347712    reg_loss: 0.060893    l2_loss: 0.013319    loss: 0.421923
steps 2600    v_Prec: 0.575784  v_Recall: 0.526735  v_F1: 0.550169  v_AUC: 0.815926
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.341033    reg_loss: 0.060661    l2_loss: 0.013497    loss: 0.415191
steps 2800    v_Prec: 0.576120  v_Recall: 0.552156  v_F1: 0.563883  v_AUC: 0.822645
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.332091    reg_loss: 0.060543    l2_loss: 0.013561    loss: 0.406194
steps 3000    v_Prec: 0.574994  v_Recall: 0.574627  v_F1: 0.574811  v_AUC: 0.831388
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.332130    reg_loss: 0.060833    l2_loss: 0.013758    loss: 0.406721
steps 3200    v_Prec: 0.601231  v_Recall: 0.568173  v_F1: 0.584235  v_AUC: 0.837480
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.328286    reg_loss: 0.061018    l2_loss: 0.013965    loss: 0.403269
steps 3400    v_Prec: 0.610211  v_Recall: 0.579090  v_F1: 0.594243  v_AUC: 0.844325
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.329666    reg_loss: 0.061474    l2_loss: 0.014311    loss: 0.405451
steps 3600    v_Prec: 0.619421  v_Recall: 0.586102  v_F1: 0.602301  v_AUC: 0.849637
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.314870    reg_loss: 0.061726    l2_loss: 0.014749    loss: 0.391344
steps 3800    v_Prec: 0.644456  v_Recall: 0.580365  v_F1: 0.610734  v_AUC: 0.854742
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.308938    reg_loss: 0.062108    l2_loss: 0.015249    loss: 0.386295
steps 4000    v_Prec: 0.630703  v_Recall: 0.603713  v_F1: 0.616913  v_AUC: 0.857996
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.303682    reg_loss: 0.062410    l2_loss: 0.015873    loss: 0.381965
steps 4200    v_Prec: 0.643454  v_Recall: 0.613356  v_F1: 0.628045  v_AUC: 0.860699
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.299387    reg_loss: 0.062789    l2_loss: 0.016507    loss: 0.378682
steps 4400    v_Prec: 0.663171  v_Recall: 0.609690  v_F1: 0.635307  v_AUC: 0.866951
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.293943    reg_loss: 0.063049    l2_loss: 0.017010    loss: 0.374001
steps 4600    v_Prec: 0.679222  v_Recall: 0.606423  v_F1: 0.640761  v_AUC: 0.871373
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.289464    reg_loss: 0.062832    l2_loss: 0.017683    loss: 0.369980
steps 4800    v_Prec: 0.676080  v_Recall: 0.620049  v_F1: 0.646853  v_AUC: 0.873797
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.289326    reg_loss: 0.063527    l2_loss: 0.018406    loss: 0.371260
steps 5000    v_Prec: 0.703075  v_Recall: 0.613993  v_F1: 0.655522  v_AUC: 0.876087
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.283833    reg_loss: 0.063449    l2_loss: 0.019026    loss: 0.366308
steps 5200    v_Prec: 0.718884  v_Recall: 0.615826  v_F1: 0.663376  v_AUC: 0.879318
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.278739    reg_loss: 0.063144    l2_loss: 0.019641    loss: 0.361524
steps 5400    v_Prec: 0.715178  v_Recall: 0.620288  v_F1: 0.664362  v_AUC: 0.879940
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.194584    reg_loss: 0.059581    l2_loss: 0.019927    loss: 0.274092
steps 5600    v_Prec: 0.727161  v_Recall: 0.615268  v_F1: 0.666552  v_AUC: 0.877680
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.186431    reg_loss: 0.059928    l2_loss: 0.020267    loss: 0.266626
steps 5800    v_Prec: 0.722956  v_Recall: 0.615109  v_F1: 0.664686  v_AUC: 0.876896
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.197241    reg_loss: 0.060394    l2_loss: 0.020587    loss: 0.278222
steps 6000    v_Prec: 0.701287  v_Recall: 0.633835  v_F1: 0.665857  v_AUC: 0.876184
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.190140    reg_loss: 0.060318    l2_loss: 0.020875    loss: 0.271333
steps 6200    v_Prec: 0.698957  v_Recall: 0.635349  v_F1: 0.665637  v_AUC: 0.878407
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.194169    reg_loss: 0.060515    l2_loss: 0.021018    loss: 0.275703
steps 6400    v_Prec: 0.731631  v_Recall: 0.616543  v_F1: 0.669175  v_AUC: 0.878468
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.194975    reg_loss: 0.060593    l2_loss: 0.021136    loss: 0.276705
steps 6600    v_Prec: 0.729503  v_Recall: 0.623237  v_F1: 0.672196  v_AUC: 0.878053
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.189823    reg_loss: 0.060617    l2_loss: 0.021208    loss: 0.271647
steps 6800    v_Prec: 0.727115  v_Recall: 0.636146  v_F1: 0.678596  v_AUC: 0.879640
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.195422    reg_loss: 0.060646    l2_loss: 0.021477    loss: 0.277544
steps 7000    v_Prec: 0.744221  v_Recall: 0.626026  v_F1: 0.680026  v_AUC: 0.882643
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.199089    reg_loss: 0.060787    l2_loss: 0.021602    loss: 0.281477
steps 7200    v_Prec: 0.730350  v_Recall: 0.641246  v_F1: 0.682904  v_AUC: 0.881762
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.205426    reg_loss: 0.061010    l2_loss: 0.021596    loss: 0.288032
steps 7400    v_Prec: 0.732320  v_Recall: 0.645310  v_F1: 0.686068  v_AUC: 0.885324
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.203226    reg_loss: 0.061058    l2_loss: 0.021831    loss: 0.286115
steps 7600    v_Prec: 0.730368  v_Recall: 0.658140  v_F1: 0.692375  v_AUC: 0.886436
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.192070    reg_loss: 0.060667    l2_loss: 0.021948    loss: 0.274685
steps 7800    v_Prec: 0.755098  v_Recall: 0.643239  v_F1: 0.694694  v_AUC: 0.886726
steps 7800    running time 295 seconds

steps 8000    base_loss: 0.192402    reg_loss: 0.060705    l2_loss: 0.021976    loss: 0.275084
steps 8000    v_Prec: 0.729578  v_Recall: 0.664754  v_F1: 0.695659  v_AUC: 0.887686
steps 8000    running time 301 seconds

steps 8200    base_loss: 0.195676    reg_loss: 0.060801    l2_loss: 0.022158    loss: 0.278635
steps 8200    v_Prec: 0.728069  v_Recall: 0.675910  v_F1: 0.701021  v_AUC: 0.889833
steps 8200    running time 308 seconds

steps 8400    base_loss: 0.198157    reg_loss: 0.060874    l2_loss: 0.022188    loss: 0.281219
steps 8400    v_Prec: 0.755466  v_Recall: 0.655351  v_F1: 0.701856  v_AUC: 0.891108
steps 8400    running time 314 seconds

steps 8600    base_loss: 0.194544    reg_loss: 0.060730    l2_loss: 0.022358    loss: 0.277633
steps 8600    v_Prec: 0.751103  v_Recall: 0.664914  v_F1: 0.705385  v_AUC: 0.893646
steps 8600    running time 321 seconds

steps 8800    base_loss: 0.196433    reg_loss: 0.060599    l2_loss: 0.022468    loss: 0.279500
steps 8800    v_Prec: 0.741686  v_Recall: 0.673599  v_F1: 0.706005  v_AUC: 0.893268
steps 8800    running time 328 seconds

steps 9000    base_loss: 0.198349    reg_loss: 0.060726    l2_loss: 0.022508    loss: 0.281583
steps 9000    v_Prec: 0.738085  v_Recall: 0.679974  v_F1: 0.707839  v_AUC: 0.894251
steps 9000    running time 335 seconds

steps 9200    base_loss: 0.198064    reg_loss: 0.060866    l2_loss: 0.022490    loss: 0.281420
steps 9200    v_Prec: 0.746832  v_Recall: 0.681010  v_F1: 0.712404  v_AUC: 0.895706
steps 9200    running time 341 seconds

steps 9400    base_loss: 0.183307    reg_loss: 0.060487    l2_loss: 0.022505    loss: 0.266299
steps 9400    v_Prec: 0.766845  v_Recall: 0.662045  v_F1: 0.710602  v_AUC: 0.896274
steps 9400    running time 348 seconds

steps 9600    base_loss: 0.194804    reg_loss: 0.060768    l2_loss: 0.022622    loss: 0.278194
steps 9600    v_Prec: 0.777809  v_Recall: 0.661407  v_F1: 0.714901  v_AUC: 0.897789
steps 9600    running time 354 seconds

steps 9800    base_loss: 0.198684    reg_loss: 0.060729    l2_loss: 0.022668    loss: 0.282080
steps 9800    v_Prec: 0.792466  v_Recall: 0.655431  v_F1: 0.717463  v_AUC: 0.899255
steps 9800    running time 361 seconds

steps 10000    base_loss: 0.193379    reg_loss: 0.060405    l2_loss: 0.022689    loss: 0.276473
steps 10000    v_Prec: 0.778786  v_Recall: 0.670492  v_F1: 0.720593  v_AUC: 0.899548
steps 10000    running time 368 seconds

steps 10200    base_loss: 0.198279    reg_loss: 0.060536    l2_loss: 0.022828    loss: 0.281643
steps 10200    v_Prec: 0.759837  v_Recall: 0.684756  v_F1: 0.720345  v_AUC: 0.900786
steps 10200    running time 375 seconds

steps 10400    base_loss: 0.189690    reg_loss: 0.060609    l2_loss: 0.022795    loss: 0.273094
steps 10400    v_Prec: 0.792326  v_Recall: 0.666428  v_F1: 0.723944  v_AUC: 0.902495
steps 10400    running time 382 seconds

steps 10600    base_loss: 0.196292    reg_loss: 0.060817    l2_loss: 0.022822    loss: 0.279932
steps 10600    v_Prec: 0.778369  v_Recall: 0.675592  v_F1: 0.723348  v_AUC: 0.902760
steps 10600    running time 389 seconds

steps 10800    base_loss: 0.183604    reg_loss: 0.060030    l2_loss: 0.022971    loss: 0.266604
steps 10800    v_Prec: 0.780917  v_Recall: 0.678301  v_F1: 0.726001  v_AUC: 0.903819
steps 10800    running time 395 seconds

steps 11000    base_loss: 0.057519    reg_loss: 0.055524    l2_loss: 0.022755    loss: 0.135798
steps 11000    v_Prec: 0.787278  v_Recall: 0.667703  v_F1: 0.722577  v_AUC: 0.900421
steps 11000    running time 401 seconds

steps 11200    base_loss: 0.053623    reg_loss: 0.055364    l2_loss: 0.022195    loss: 0.131182
steps 11200    v_Prec: 0.771664  v_Recall: 0.670571  v_F1: 0.717575  v_AUC: 0.897720
steps 11200    running time 408 seconds

steps 11400    base_loss: 0.053918    reg_loss: 0.055761    l2_loss: 0.021809    loss: 0.131487
steps 11400    v_Prec: 0.761124  v_Recall: 0.673360  v_F1: 0.714558  v_AUC: 0.896235
steps 11400    running time 414 seconds

steps 11600    base_loss: 0.062744    reg_loss: 0.055667    l2_loss: 0.021430    loss: 0.139841
steps 11600    v_Prec: 0.729524  v_Recall: 0.694876  v_F1: 0.711779  v_AUC: 0.895243
steps 11600    running time 420 seconds

steps 11800    base_loss: 0.062287    reg_loss: 0.055860    l2_loss: 0.021114    loss: 0.139261
steps 11800    v_Prec: 0.751779  v_Recall: 0.673360  v_F1: 0.710412  v_AUC: 0.893537
steps 11800    running time 427 seconds

steps 12000    base_loss: 0.059188    reg_loss: 0.055886    l2_loss: 0.020911    loss: 0.135986
steps 12000    v_Prec: 0.776768  v_Recall: 0.653837  v_F1: 0.710021  v_AUC: 0.893239
steps 12000    running time 433 seconds

steps 12200    base_loss: 0.063255    reg_loss: 0.055882    l2_loss: 0.020704    loss: 0.139841
steps 12200    v_Prec: 0.769867  v_Recall: 0.653120  v_F1: 0.706704  v_AUC: 0.892512
steps 12200    running time 439 seconds

steps 12400    base_loss: 0.061968    reg_loss: 0.056038    l2_loss: 0.020567    loss: 0.138574
steps 12400    v_Prec: 0.760560  v_Recall: 0.662921  v_F1: 0.708392  v_AUC: 0.890282
steps 12400    running time 445 seconds

steps 12600    base_loss: 0.061108    reg_loss: 0.055828    l2_loss: 0.020342    loss: 0.137278
steps 12600    v_Prec: 0.761773  v_Recall: 0.658698  v_F1: 0.706496  v_AUC: 0.889763
steps 12600    running time 452 seconds

steps 12800    base_loss: 0.063937    reg_loss: 0.055367    l2_loss: 0.020106    loss: 0.139411
steps 12800    v_Prec: 0.746964  v_Recall: 0.666667  v_F1: 0.704535  v_AUC: 0.889727
steps 12800    running time 458 seconds

Early stop model F1: 0.726001
testing thre: 0.5417363
testing Prec: 0.622978299279663
testing Recall: 0.6683353584447145
testing F1: 0.64486025135997
testing AUC: 0.8803234438656546
overall running time 461 seconds
(0.6948645413991948, 0.6208019441069259, 0.6557486459429627, 0.8803234438656546, 0.6887283)

2019-02-24 01:40:15.129725: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:40:15.932438: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:40:15.933393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:40:15.933429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.520000 seconds
loading data in 30.820000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.840427    reg_loss: 0.064700    l2_loss: 0.013315    loss: 0.918442
steps 200    v_Prec: 0.164140  v_Recall: 0.963260  v_F1: 0.280485  v_AUC: 0.519235
steps 200    running time 41 seconds

steps 400    base_loss: 0.602985    reg_loss: 0.064653    l2_loss: 0.013239    loss: 0.680877
steps 400    v_Prec: 0.167109  v_Recall: 0.924434  v_F1: 0.283051  v_AUC: 0.527847
steps 400    running time 48 seconds

steps 600    base_loss: 0.507801    reg_loss: 0.064448    l2_loss: 0.013117    loss: 0.585366
steps 600    v_Prec: 0.174603  v_Recall: 0.791192  v_F1: 0.286075  v_AUC: 0.546407
steps 600    running time 55 seconds

steps 800    base_loss: 0.479902    reg_loss: 0.063908    l2_loss: 0.012916    loss: 0.556727
steps 800    v_Prec: 0.186638  v_Recall: 0.746029  v_F1: 0.298579  v_AUC: 0.584123
steps 800    running time 62 seconds

steps 1000    base_loss: 0.468873    reg_loss: 0.063816    l2_loss: 0.012686    loss: 0.545375
steps 1000    v_Prec: 0.205612  v_Recall: 0.614231  v_F1: 0.308092  v_AUC: 0.611219
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.452458    reg_loss: 0.063426    l2_loss: 0.012528    loss: 0.528412
steps 1200    v_Prec: 0.245295  v_Recall: 0.511231  v_F1: 0.331521  v_AUC: 0.645876
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.430331    reg_loss: 0.063018    l2_loss: 0.012588    loss: 0.505936
steps 1400    v_Prec: 0.362108  v_Recall: 0.450906  v_F1: 0.401658  v_AUC: 0.713677
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.405685    reg_loss: 0.062450    l2_loss: 0.012690    loss: 0.480824
steps 1600    v_Prec: 0.485351  v_Recall: 0.459811  v_F1: 0.472236  v_AUC: 0.761128
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.380604    reg_loss: 0.061811    l2_loss: 0.012835    loss: 0.455250
steps 1800    v_Prec: 0.530148  v_Recall: 0.509947  v_F1: 0.519851  v_AUC: 0.792778
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.356603    reg_loss: 0.061108    l2_loss: 0.013009    loss: 0.430721
steps 2000    v_Prec: 0.582363  v_Recall: 0.513316  v_F1: 0.545664  v_AUC: 0.811482
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.345644    reg_loss: 0.060478    l2_loss: 0.013201    loss: 0.419323
steps 2200    v_Prec: 0.599394  v_Recall: 0.555351  v_F1: 0.576532  v_AUC: 0.832612
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.330581    reg_loss: 0.059830    l2_loss: 0.013405    loss: 0.403817
steps 2400    v_Prec: 0.602352  v_Recall: 0.595781  v_F1: 0.599048  v_AUC: 0.848044
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.310417    reg_loss: 0.059446    l2_loss: 0.013578    loss: 0.383441
steps 2600    v_Prec: 0.641248  v_Recall: 0.593615  v_F1: 0.616513  v_AUC: 0.856907
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.309042    reg_loss: 0.059321    l2_loss: 0.013895    loss: 0.382259
steps 2800    v_Prec: 0.640898  v_Recall: 0.618482  v_F1: 0.629491  v_AUC: 0.865567
steps 2800    running time 131 seconds

steps 3000    base_loss: 0.300267    reg_loss: 0.058806    l2_loss: 0.014181    loss: 0.373254
steps 3000    v_Prec: 0.679161  v_Recall: 0.610460  v_F1: 0.642981  v_AUC: 0.871929
steps 3000    running time 138 seconds

steps 3200    base_loss: 0.289404    reg_loss: 0.058620    l2_loss: 0.014505    loss: 0.362530
steps 3200    v_Prec: 0.688589  v_Recall: 0.621531  v_F1: 0.653343  v_AUC: 0.877839
steps 3200    running time 145 seconds

steps 3400    base_loss: 0.286070    reg_loss: 0.058543    l2_loss: 0.014850    loss: 0.359463
steps 3400    v_Prec: 0.706365  v_Recall: 0.628510  v_F1: 0.665167  v_AUC: 0.884572
steps 3400    running time 152 seconds

steps 3600    base_loss: 0.283733    reg_loss: 0.058296    l2_loss: 0.015286    loss: 0.357315
steps 3600    v_Prec: 0.711272  v_Recall: 0.638296  v_F1: 0.672811  v_AUC: 0.887858
steps 3600    running time 159 seconds

steps 3800    base_loss: 0.276762    reg_loss: 0.058085    l2_loss: 0.015620    loss: 0.350466
steps 3800    v_Prec: 0.741415  v_Recall: 0.633884  v_F1: 0.683446  v_AUC: 0.891537
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.272371    reg_loss: 0.057823    l2_loss: 0.016017    loss: 0.346210
steps 4000    v_Prec: 0.728305  v_Recall: 0.653698  v_F1: 0.688988  v_AUC: 0.894501
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.269538    reg_loss: 0.057547    l2_loss: 0.016436    loss: 0.343521
steps 4200    v_Prec: 0.722053  v_Recall: 0.663725  v_F1: 0.691661  v_AUC: 0.896981
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.267751    reg_loss: 0.057285    l2_loss: 0.016827    loss: 0.341864
steps 4400    v_Prec: 0.742486  v_Recall: 0.645997  v_F1: 0.690889  v_AUC: 0.897709
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.260507    reg_loss: 0.057172    l2_loss: 0.017233    loss: 0.334912
steps 4600    v_Prec: 0.725932  v_Recall: 0.663565  v_F1: 0.693349  v_AUC: 0.899280
steps 4600    running time 193 seconds

steps 4800    base_loss: 0.262559    reg_loss: 0.056963    l2_loss: 0.017709    loss: 0.337230
steps 4800    v_Prec: 0.736414  v_Recall: 0.660918  v_F1: 0.696626  v_AUC: 0.900613
steps 4800    running time 200 seconds

steps 5000    base_loss: 0.259432    reg_loss: 0.056629    l2_loss: 0.018127    loss: 0.334188
steps 5000    v_Prec: 0.742977  v_Recall: 0.653457  v_F1: 0.695348  v_AUC: 0.900001
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.259956    reg_loss: 0.056362    l2_loss: 0.018622    loss: 0.334940
steps 5200    v_Prec: 0.729581  v_Recall: 0.670704  v_F1: 0.698905  v_AUC: 0.902739
steps 5200    running time 214 seconds

steps 5400    base_loss: 0.255939    reg_loss: 0.055745    l2_loss: 0.019094    loss: 0.330778
steps 5400    v_Prec: 0.734685  v_Recall: 0.677282  v_F1: 0.704817  v_AUC: 0.905851
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.179078    reg_loss: 0.051830    l2_loss: 0.019584    loss: 0.250492
steps 5600    v_Prec: 0.757422  v_Recall: 0.658992  v_F1: 0.704787  v_AUC: 0.903800
steps 5600    running time 229 seconds

steps 5800    base_loss: 0.166289    reg_loss: 0.051505    l2_loss: 0.020264    loss: 0.238058
steps 5800    v_Prec: 0.740945  v_Recall: 0.669501  v_F1: 0.703413  v_AUC: 0.902796
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.171632    reg_loss: 0.051610    l2_loss: 0.020876    loss: 0.244118
steps 6000    v_Prec: 0.769427  v_Recall: 0.653698  v_F1: 0.706857  v_AUC: 0.902607
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.186822    reg_loss: 0.051771    l2_loss: 0.021540    loss: 0.260133
steps 6200    v_Prec: 0.754731  v_Recall: 0.668699  v_F1: 0.709115  v_AUC: 0.903090
steps 6200    running time 249 seconds

steps 6400    base_loss: 0.176292    reg_loss: 0.051093    l2_loss: 0.021988    loss: 0.249373
steps 6400    v_Prec: 0.775175  v_Recall: 0.655784  v_F1: 0.710499  v_AUC: 0.903580
steps 6400    running time 256 seconds

steps 6600    base_loss: 0.178161    reg_loss: 0.050989    l2_loss: 0.022482    loss: 0.251631
steps 6600    v_Prec: 0.780058  v_Recall: 0.652655  v_F1: 0.710692  v_AUC: 0.903985
steps 6600    running time 263 seconds

steps 6800    base_loss: 0.176565    reg_loss: 0.050891    l2_loss: 0.022802    loss: 0.250259
steps 6800    v_Prec: 0.756239  v_Recall: 0.670945  v_F1: 0.711043  v_AUC: 0.905095
steps 6800    running time 270 seconds

steps 7000    base_loss: 0.181269    reg_loss: 0.050629    l2_loss: 0.023245    loss: 0.255142
steps 7000    v_Prec: 0.758460  v_Recall: 0.677844  v_F1: 0.715889  v_AUC: 0.906451
steps 7000    running time 277 seconds

steps 7200    base_loss: 0.180048    reg_loss: 0.050446    l2_loss: 0.023588    loss: 0.254082
steps 7200    v_Prec: 0.747173  v_Recall: 0.683700  v_F1: 0.714028  v_AUC: 0.905975
steps 7200    running time 284 seconds

steps 7400    base_loss: 0.178762    reg_loss: 0.050201    l2_loss: 0.023769    loss: 0.252732
steps 7400    v_Prec: 0.764169  v_Recall: 0.671667  v_F1: 0.714938  v_AUC: 0.908201
steps 7400    running time 290 seconds

steps 7600    base_loss: 0.182140    reg_loss: 0.050101    l2_loss: 0.023988    loss: 0.256229
steps 7600    v_Prec: 0.760316  v_Recall: 0.678405  v_F1: 0.717029  v_AUC: 0.909463
steps 7600    running time 297 seconds

steps 7800    base_loss: 0.178141    reg_loss: 0.049930    l2_loss: 0.024174    loss: 0.252246
steps 7800    v_Prec: 0.774256  v_Recall: 0.675999  v_F1: 0.721799  v_AUC: 0.910099
steps 7800    running time 303 seconds

steps 8000    base_loss: 0.178259    reg_loss: 0.050055    l2_loss: 0.024393    loss: 0.252707
steps 8000    v_Prec: 0.760312  v_Recall: 0.689074  v_F1: 0.722942  v_AUC: 0.910424
steps 8000    running time 310 seconds

steps 8200    base_loss: 0.179395    reg_loss: 0.049654    l2_loss: 0.024646    loss: 0.253695
steps 8200    v_Prec: 0.769252  v_Recall: 0.685946  v_F1: 0.725214  v_AUC: 0.912026
steps 8200    running time 318 seconds

steps 8400    base_loss: 0.180848    reg_loss: 0.049766    l2_loss: 0.024952    loss: 0.255566
steps 8400    v_Prec: 0.769031  v_Recall: 0.688834  v_F1: 0.726726  v_AUC: 0.912927
steps 8400    running time 325 seconds

steps 8600    base_loss: 0.186445    reg_loss: 0.049668    l2_loss: 0.025047    loss: 0.261160
steps 8600    v_Prec: 0.765350  v_Recall: 0.694930  v_F1: 0.728442  v_AUC: 0.914174
steps 8600    running time 331 seconds

steps 8800    base_loss: 0.186891    reg_loss: 0.049487    l2_loss: 0.025049    loss: 0.261427
steps 8800    v_Prec: 0.772911  v_Recall: 0.690759  v_F1: 0.729529  v_AUC: 0.914578
steps 8800    running time 339 seconds

steps 9000    base_loss: 0.188347    reg_loss: 0.049359    l2_loss: 0.025343    loss: 0.263049
steps 9000    v_Prec: 0.789103  v_Recall: 0.683138  v_F1: 0.732307  v_AUC: 0.915221
steps 9000    running time 345 seconds

steps 9200    base_loss: 0.184465    reg_loss: 0.049329    l2_loss: 0.025368    loss: 0.259161
steps 9200    v_Prec: 0.780627  v_Recall: 0.693647  v_F1: 0.734571  v_AUC: 0.916782
steps 9200    running time 352 seconds

steps 9400    base_loss: 0.187668    reg_loss: 0.049208    l2_loss: 0.025453    loss: 0.262329
steps 9400    v_Prec: 0.777469  v_Recall: 0.695893  v_F1: 0.734423  v_AUC: 0.917189
steps 9400    running time 359 seconds

steps 9600    base_loss: 0.179336    reg_loss: 0.048946    l2_loss: 0.025467    loss: 0.253748
steps 9600    v_Prec: 0.787895  v_Recall: 0.693406  v_F1: 0.737637  v_AUC: 0.919038
steps 9600    running time 366 seconds

steps 9800    base_loss: 0.188680    reg_loss: 0.048986    l2_loss: 0.025536    loss: 0.263202
steps 9800    v_Prec: 0.754764  v_Recall: 0.724370  v_F1: 0.739255  v_AUC: 0.920539
steps 9800    running time 373 seconds

steps 10000    base_loss: 0.188688    reg_loss: 0.048703    l2_loss: 0.025511    loss: 0.262902
steps 10000    v_Prec: 0.798713  v_Recall: 0.697096  v_F1: 0.744453  v_AUC: 0.923033
steps 10000    running time 380 seconds

steps 10200    base_loss: 0.184565    reg_loss: 0.048690    l2_loss: 0.025731    loss: 0.258986
steps 10200    v_Prec: 0.788104  v_Recall: 0.706803  v_F1: 0.745242  v_AUC: 0.922304
steps 10200    running time 387 seconds

steps 10400    base_loss: 0.179759    reg_loss: 0.048555    l2_loss: 0.025751    loss: 0.254065
steps 10400    v_Prec: 0.802298  v_Recall: 0.694690  v_F1: 0.744626  v_AUC: 0.922838
steps 10400    running time 393 seconds

steps 10600    base_loss: 0.176875    reg_loss: 0.048479    l2_loss: 0.025813    loss: 0.251166
steps 10600    v_Prec: 0.769231  v_Recall: 0.721964  v_F1: 0.744848  v_AUC: 0.923673
steps 10600    running time 400 seconds

steps 10800    base_loss: 0.174019    reg_loss: 0.047935    l2_loss: 0.025884    loss: 0.247839
steps 10800    v_Prec: 0.773998  v_Recall: 0.728301  v_F1: 0.750455  v_AUC: 0.925285
steps 10800    running time 407 seconds

steps 11000    base_loss: 0.070937    reg_loss: 0.043274    l2_loss: 0.025845    loss: 0.140055
steps 11000    v_Prec: 0.789469  v_Recall: 0.710813  v_F1: 0.748079  v_AUC: 0.923486
steps 11000    running time 414 seconds

steps 11200    base_loss: 0.067274    reg_loss: 0.043018    l2_loss: 0.025708    loss: 0.136000
steps 11200    v_Prec: 0.787063  v_Recall: 0.708648  v_F1: 0.745800  v_AUC: 0.922797
steps 11200    running time 420 seconds

steps 11400    base_loss: 0.059443    reg_loss: 0.043084    l2_loss: 0.025611    loss: 0.128138
steps 11400    v_Prec: 0.793659  v_Recall: 0.702872  v_F1: 0.745512  v_AUC: 0.922208
steps 11400    running time 427 seconds

steps 11600    base_loss: 0.065044    reg_loss: 0.043117    l2_loss: 0.025534    loss: 0.133695
steps 11600    v_Prec: 0.798223  v_Recall: 0.699102  v_F1: 0.745381  v_AUC: 0.921167
steps 11600    running time 433 seconds

steps 11800    base_loss: 0.064280    reg_loss: 0.042942    l2_loss: 0.025555    loss: 0.132777
steps 11800    v_Prec: 0.761848  v_Recall: 0.723408  v_F1: 0.742131  v_AUC: 0.919427
steps 11800    running time 439 seconds

steps 12000    base_loss: 0.070324    reg_loss: 0.043121    l2_loss: 0.025515    loss: 0.138959
steps 12000    v_Prec: 0.781166  v_Recall: 0.696695  v_F1: 0.736516  v_AUC: 0.918500
steps 12000    running time 445 seconds

steps 12200    base_loss: 0.072421    reg_loss: 0.043250    l2_loss: 0.025648    loss: 0.141320
steps 12200    v_Prec: 0.787104  v_Recall: 0.694288  v_F1: 0.737789  v_AUC: 0.918312
steps 12200    running time 451 seconds

steps 12400    base_loss: 0.072528    reg_loss: 0.043349    l2_loss: 0.025590    loss: 0.141466
steps 12400    v_Prec: 0.782605  v_Recall: 0.702310  v_F1: 0.740287  v_AUC: 0.918537
steps 12400    running time 457 seconds

steps 12600    base_loss: 0.070020    reg_loss: 0.043381    l2_loss: 0.025624    loss: 0.139025
steps 12600    v_Prec: 0.762322  v_Recall: 0.718354  v_F1: 0.739685  v_AUC: 0.919340
steps 12600    running time 463 seconds

steps 12800    base_loss: 0.072195    reg_loss: 0.043306    l2_loss: 0.025677    loss: 0.141178
steps 12800    v_Prec: 0.768483  v_Recall: 0.716268  v_F1: 0.741457  v_AUC: 0.919744
steps 12800    running time 469 seconds

Early stop model F1: 0.750455
testing thre: 0.55630153
testing Prec: 0.5681718384074942
testing Recall: 0.7546537059538274
testing F1: 0.6482683756758449
testing AUC: 0.9006660824284262
overall running time 472 seconds
(0.718620985469948, 0.6514216281895504, 0.6833732728292459, 0.9006660824284262, 0.8184749)

2019-02-24 01:45:51.395802: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:45:51.822095: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:45:51.834704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:45:51.834759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 22.390000 seconds
loading data in 28.620000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.533285    reg_loss: 0.064975    l2_loss: 0.013301    loss: 1.611561
steps 200    v_Prec: 0.162417  v_Recall: 1.000000  v_F1: 0.279447  v_AUC: 0.485696
steps 200    running time 39 seconds

steps 400    base_loss: 0.913332    reg_loss: 0.064917    l2_loss: 0.012981    loss: 0.991230
steps 400    v_Prec: 0.162919  v_Recall: 0.991886  v_F1: 0.279869  v_AUC: 0.487048
steps 400    running time 47 seconds

steps 600    base_loss: 0.470951    reg_loss: 0.064896    l2_loss: 0.012684    loss: 0.548531
steps 600    v_Prec: 0.162423  v_Recall: 0.999920  v_F1: 0.279453  v_AUC: 0.517063
steps 600    running time 54 seconds

steps 800    base_loss: 0.466660    reg_loss: 0.064761    l2_loss: 0.012583    loss: 0.544004
steps 800    v_Prec: 0.190549  v_Recall: 0.598056  v_F1: 0.289014  v_AUC: 0.579225
steps 800    running time 60 seconds

steps 1000    base_loss: 0.463711    reg_loss: 0.064453    l2_loss: 0.012331    loss: 0.540494
steps 1000    v_Prec: 0.260549  v_Recall: 0.473769  v_F1: 0.336203  v_AUC: 0.645322
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.447757    reg_loss: 0.064114    l2_loss: 0.012149    loss: 0.524020
steps 1200    v_Prec: 0.370196  v_Recall: 0.447256  v_F1: 0.405094  v_AUC: 0.720776
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.429596    reg_loss: 0.064200    l2_loss: 0.012091    loss: 0.505886
steps 1400    v_Prec: 0.473385  v_Recall: 0.447979  v_F1: 0.460332  v_AUC: 0.761140
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.411407    reg_loss: 0.064551    l2_loss: 0.012093    loss: 0.488051
steps 1600    v_Prec: 0.495503  v_Recall: 0.495782  v_F1: 0.495643  v_AUC: 0.786765
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.388209    reg_loss: 0.064776    l2_loss: 0.012164    loss: 0.465149
steps 1800    v_Prec: 0.527340  v_Recall: 0.526874  v_F1: 0.527107  v_AUC: 0.810272
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.367427    reg_loss: 0.065190    l2_loss: 0.012429    loss: 0.445046
steps 2000    v_Prec: 0.568029  v_Recall: 0.542701  v_F1: 0.555076  v_AUC: 0.831741
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.345630    reg_loss: 0.065616    l2_loss: 0.012735    loss: 0.423980
steps 2200    v_Prec: 0.599615  v_Recall: 0.549851  v_F1: 0.573656  v_AUC: 0.841238
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.330061    reg_loss: 0.066055    l2_loss: 0.013183    loss: 0.409299
steps 2400    v_Prec: 0.611545  v_Recall: 0.566000  v_F1: 0.587892  v_AUC: 0.852331
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.322087    reg_loss: 0.066501    l2_loss: 0.013631    loss: 0.402219
steps 2600    v_Prec: 0.639459  v_Recall: 0.558287  v_F1: 0.596123  v_AUC: 0.858680
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.311757    reg_loss: 0.066620    l2_loss: 0.014125    loss: 0.392501
steps 2800    v_Prec: 0.627228  v_Recall: 0.588174  v_F1: 0.607073  v_AUC: 0.863204
steps 2800    running time 130 seconds

steps 3000    base_loss: 0.293922    reg_loss: 0.066621    l2_loss: 0.014594    loss: 0.375136
steps 3000    v_Prec: 0.676988  v_Recall: 0.577890  v_F1: 0.623526  v_AUC: 0.869737
steps 3000    running time 137 seconds

steps 3200    base_loss: 0.297877    reg_loss: 0.066916    l2_loss: 0.015103    loss: 0.379896
steps 3200    v_Prec: 0.657794  v_Recall: 0.605527  v_F1: 0.630579  v_AUC: 0.875562
steps 3200    running time 144 seconds

steps 3400    base_loss: 0.299108    reg_loss: 0.067318    l2_loss: 0.015589    loss: 0.382015
steps 3400    v_Prec: 0.653056  v_Recall: 0.628344  v_F1: 0.640462  v_AUC: 0.880425
steps 3400    running time 151 seconds

steps 3600    base_loss: 0.286970    reg_loss: 0.067113    l2_loss: 0.016163    loss: 0.370246
steps 3600    v_Prec: 0.686194  v_Recall: 0.606974  v_F1: 0.644157  v_AUC: 0.881512
steps 3600    running time 158 seconds

steps 3800    base_loss: 0.275058    reg_loss: 0.067018    l2_loss: 0.016601    loss: 0.358677
steps 3800    v_Prec: 0.674411  v_Recall: 0.627380  v_F1: 0.650046  v_AUC: 0.883418
steps 3800    running time 165 seconds

steps 4000    base_loss: 0.281609    reg_loss: 0.067286    l2_loss: 0.017146    loss: 0.366041
steps 4000    v_Prec: 0.709412  v_Recall: 0.603117  v_F1: 0.651961  v_AUC: 0.884900
steps 4000    running time 172 seconds

steps 4200    base_loss: 0.277686    reg_loss: 0.067250    l2_loss: 0.017671    loss: 0.362608
steps 4200    v_Prec: 0.701374  v_Recall: 0.615329  v_F1: 0.655540  v_AUC: 0.887916
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.270973    reg_loss: 0.067286    l2_loss: 0.018226    loss: 0.356485
steps 4400    v_Prec: 0.697855  v_Recall: 0.627380  v_F1: 0.660744  v_AUC: 0.890311
steps 4400    running time 186 seconds

steps 4600    base_loss: 0.270667    reg_loss: 0.067488    l2_loss: 0.018801    loss: 0.356956
steps 4600    v_Prec: 0.719406  v_Recall: 0.619185  v_F1: 0.665544  v_AUC: 0.892575
steps 4600    running time 193 seconds

steps 4800    base_loss: 0.270541    reg_loss: 0.067336    l2_loss: 0.019438    loss: 0.357314
steps 4800    v_Prec: 0.693165  v_Recall: 0.644493  v_F1: 0.667943  v_AUC: 0.894836
steps 4800    running time 200 seconds

steps 5000    base_loss: 0.269784    reg_loss: 0.067276    l2_loss: 0.020122    loss: 0.357182
steps 5000    v_Prec: 0.710120  v_Recall: 0.631960  v_F1: 0.668764  v_AUC: 0.897541
steps 5000    running time 207 seconds

steps 5200    base_loss: 0.266072    reg_loss: 0.067326    l2_loss: 0.020832    loss: 0.354230
steps 5200    v_Prec: 0.720261  v_Recall: 0.637744  v_F1: 0.676496  v_AUC: 0.899583
steps 5200    running time 214 seconds

steps 5400    base_loss: 0.259680    reg_loss: 0.067259    l2_loss: 0.021495    loss: 0.348435
steps 5400    v_Prec: 0.712497  v_Recall: 0.644493  v_F1: 0.676791  v_AUC: 0.901250
steps 5400    running time 220 seconds

steps 5600    base_loss: 0.191754    reg_loss: 0.067235    l2_loss: 0.022342    loss: 0.281331
steps 5600    v_Prec: 0.728055  v_Recall: 0.625050  v_F1: 0.672632  v_AUC: 0.897667
steps 5600    running time 227 seconds

steps 5800    base_loss: 0.185773    reg_loss: 0.067178    l2_loss: 0.023170    loss: 0.276122
steps 5800    v_Prec: 0.725176  v_Recall: 0.621355  v_F1: 0.669263  v_AUC: 0.895444
steps 5800    running time 233 seconds

steps 6000    base_loss: 0.180038    reg_loss: 0.067056    l2_loss: 0.023948    loss: 0.271041
steps 6000    v_Prec: 0.719755  v_Recall: 0.631397  v_F1: 0.672687  v_AUC: 0.896264
steps 6000    running time 240 seconds

steps 6200    base_loss: 0.194631    reg_loss: 0.067252    l2_loss: 0.024622    loss: 0.286505
steps 6200    v_Prec: 0.698211  v_Recall: 0.639592  v_F1: 0.667617  v_AUC: 0.894149
steps 6200    running time 246 seconds

steps 6400    base_loss: 0.182874    reg_loss: 0.067030    l2_loss: 0.025250    loss: 0.275154
steps 6400    v_Prec: 0.722323  v_Recall: 0.639512  v_F1: 0.678399  v_AUC: 0.897611
steps 6400    running time 252 seconds

steps 6600    base_loss: 0.179667    reg_loss: 0.066969    l2_loss: 0.025799    loss: 0.272435
steps 6600    v_Prec: 0.709017  v_Recall: 0.642484  v_F1: 0.674113  v_AUC: 0.896908
steps 6600    running time 259 seconds

steps 6800    base_loss: 0.193234    reg_loss: 0.067118    l2_loss: 0.026342    loss: 0.286694
steps 6800    v_Prec: 0.696089  v_Recall: 0.656383  v_F1: 0.675653  v_AUC: 0.897336
steps 6800    running time 266 seconds

steps 7000    base_loss: 0.183180    reg_loss: 0.066954    l2_loss: 0.026899    loss: 0.277033
steps 7000    v_Prec: 0.724511  v_Recall: 0.634289  v_F1: 0.676405  v_AUC: 0.896179
steps 7000    running time 272 seconds

steps 7200    base_loss: 0.198923    reg_loss: 0.067054    l2_loss: 0.027419    loss: 0.293395
steps 7200    v_Prec: 0.740602  v_Recall: 0.633084  v_F1: 0.682635  v_AUC: 0.898305
steps 7200    running time 278 seconds

steps 7400    base_loss: 0.186826    reg_loss: 0.066772    l2_loss: 0.027822    loss: 0.281419
steps 7400    v_Prec: 0.725769  v_Recall: 0.644894  v_F1: 0.682946  v_AUC: 0.901788
steps 7400    running time 285 seconds

steps 7600    base_loss: 0.186482    reg_loss: 0.067065    l2_loss: 0.028208    loss: 0.281755
steps 7600    v_Prec: 0.721461  v_Recall: 0.655499  v_F1: 0.686900  v_AUC: 0.903087
steps 7600    running time 292 seconds

steps 7800    base_loss: 0.188376    reg_loss: 0.066822    l2_loss: 0.028506    loss: 0.283705
steps 7800    v_Prec: 0.724753  v_Recall: 0.659597  v_F1: 0.690641  v_AUC: 0.903819
steps 7800    running time 299 seconds

steps 8000    base_loss: 0.188183    reg_loss: 0.066642    l2_loss: 0.028869    loss: 0.283694
steps 8000    v_Prec: 0.743528  v_Recall: 0.648429  v_F1: 0.692730  v_AUC: 0.903854
steps 8000    running time 306 seconds

steps 8200    base_loss: 0.188016    reg_loss: 0.066717    l2_loss: 0.029218    loss: 0.283952
steps 8200    v_Prec: 0.742684  v_Recall: 0.650438  v_F1: 0.693507  v_AUC: 0.905933
steps 8200    running time 313 seconds

steps 8400    base_loss: 0.180666    reg_loss: 0.066878    l2_loss: 0.029586    loss: 0.277130
steps 8400    v_Prec: 0.723908  v_Recall: 0.663132  v_F1: 0.692188  v_AUC: 0.905118
steps 8400    running time 320 seconds

steps 8600    base_loss: 0.184853    reg_loss: 0.066622    l2_loss: 0.029933    loss: 0.281408
steps 8600    v_Prec: 0.743484  v_Recall: 0.653169  v_F1: 0.695407  v_AUC: 0.907176
steps 8600    running time 326 seconds

steps 8800    base_loss: 0.187095    reg_loss: 0.066619    l2_loss: 0.030232    loss: 0.283945
steps 8800    v_Prec: 0.745096  v_Recall: 0.659195  v_F1: 0.699518  v_AUC: 0.909029
steps 8800    running time 333 seconds

steps 9000    base_loss: 0.183795    reg_loss: 0.066415    l2_loss: 0.030492    loss: 0.280702
steps 9000    v_Prec: 0.752224  v_Recall: 0.665863  v_F1: 0.706414  v_AUC: 0.910357
steps 9000    running time 340 seconds

steps 9200    base_loss: 0.177705    reg_loss: 0.066305    l2_loss: 0.030577    loss: 0.274588
steps 9200    v_Prec: 0.742010  v_Recall: 0.673335  v_F1: 0.706006  v_AUC: 0.910691
steps 9200    running time 347 seconds

steps 9400    base_loss: 0.190152    reg_loss: 0.066625    l2_loss: 0.030758    loss: 0.287535
steps 9400    v_Prec: 0.734370  v_Recall: 0.683217  v_F1: 0.707870  v_AUC: 0.911429
steps 9400    running time 353 seconds

steps 9600    base_loss: 0.177982    reg_loss: 0.066479    l2_loss: 0.031070    loss: 0.275531
steps 9600    v_Prec: 0.724741  v_Recall: 0.696152  v_F1: 0.710159  v_AUC: 0.914720
steps 9600    running time 360 seconds

steps 9800    base_loss: 0.188845    reg_loss: 0.066551    l2_loss: 0.031149    loss: 0.286546
steps 9800    v_Prec: 0.743612  v_Recall: 0.682735  v_F1: 0.711874  v_AUC: 0.915014
steps 9800    running time 367 seconds

steps 10000    base_loss: 0.177269    reg_loss: 0.066087    l2_loss: 0.031446    loss: 0.274802
steps 10000    v_Prec: 0.741790  v_Recall: 0.685948  v_F1: 0.712777  v_AUC: 0.913136
steps 10000    running time 374 seconds

steps 10200    base_loss: 0.180601    reg_loss: 0.066386    l2_loss: 0.031621    loss: 0.278609
steps 10200    v_Prec: 0.757562  v_Recall: 0.686109  v_F1: 0.720067  v_AUC: 0.915896
steps 10200    running time 381 seconds

steps 10400    base_loss: 0.185112    reg_loss: 0.066154    l2_loss: 0.031776    loss: 0.283042
steps 10400    v_Prec: 0.750109  v_Recall: 0.689724  v_F1: 0.718651  v_AUC: 0.917443
steps 10400    running time 388 seconds

steps 10600    base_loss: 0.190528    reg_loss: 0.066338    l2_loss: 0.032002    loss: 0.288869
steps 10600    v_Prec: 0.756851  v_Recall: 0.683458  v_F1: 0.718284  v_AUC: 0.918793
steps 10600    running time 395 seconds

steps 10800    base_loss: 0.171510    reg_loss: 0.066059    l2_loss: 0.032213    loss: 0.269782
steps 10800    v_Prec: 0.758700  v_Recall: 0.688359  v_F1: 0.721820  v_AUC: 0.918787
steps 10800    running time 401 seconds

steps 11000    base_loss: 0.082453    reg_loss: 0.065157    l2_loss: 0.032459    loss: 0.180069
steps 11000    v_Prec: 0.785329  v_Recall: 0.655419  v_F1: 0.714517  v_AUC: 0.914002
steps 11000    running time 408 seconds

steps 11200    base_loss: 0.076631    reg_loss: 0.064858    l2_loss: 0.032413    loss: 0.173902
steps 11200    v_Prec: 0.741505  v_Recall: 0.678477  v_F1: 0.708592  v_AUC: 0.911769
steps 11200    running time 415 seconds

steps 11400    base_loss: 0.077174    reg_loss: 0.064942    l2_loss: 0.032556    loss: 0.174671
steps 11400    v_Prec: 0.729894  v_Recall: 0.683217  v_F1: 0.705785  v_AUC: 0.907816
steps 11400    running time 421 seconds

steps 11600    base_loss: 0.079273    reg_loss: 0.064898    l2_loss: 0.032672    loss: 0.176843
steps 11600    v_Prec: 0.726640  v_Recall: 0.679762  v_F1: 0.702420  v_AUC: 0.906063
steps 11600    running time 428 seconds

steps 11800    base_loss: 0.080808    reg_loss: 0.064796    l2_loss: 0.032710    loss: 0.178314
steps 11800    v_Prec: 0.748175  v_Recall: 0.658793  v_F1: 0.700645  v_AUC: 0.905460
steps 11800    running time 434 seconds

steps 12000    base_loss: 0.089783    reg_loss: 0.064708    l2_loss: 0.032733    loss: 0.187224
steps 12000    v_Prec: 0.750162  v_Recall: 0.653009  v_F1: 0.698222  v_AUC: 0.902214
steps 12000    running time 440 seconds

steps 12200    base_loss: 0.087201    reg_loss: 0.064793    l2_loss: 0.032861    loss: 0.184855
steps 12200    v_Prec: 0.738114  v_Recall: 0.659838  v_F1: 0.696785  v_AUC: 0.902378
steps 12200    running time 447 seconds

steps 12400    base_loss: 0.086861    reg_loss: 0.064696    l2_loss: 0.033096    loss: 0.184653
steps 12400    v_Prec: 0.742222  v_Recall: 0.657427  v_F1: 0.697256  v_AUC: 0.902893
steps 12400    running time 454 seconds

steps 12600    base_loss: 0.087751    reg_loss: 0.064528    l2_loss: 0.033195    loss: 0.185474
steps 12600    v_Prec: 0.746410  v_Recall: 0.651482  v_F1: 0.695723  v_AUC: 0.902262
steps 12600    running time 460 seconds

steps 12800    base_loss: 0.089011    reg_loss: 0.064712    l2_loss: 0.033137    loss: 0.186859
steps 12800    v_Prec: 0.741171  v_Recall: 0.645778  v_F1: 0.690194  v_AUC: 0.897799
steps 12800    running time 467 seconds

Early stop model F1: 0.721820
testing thre: 0.48859343
testing Prec: 0.5416910423620909
testing Recall: 0.7650546780072904
testing F1: 0.6342829512028045
testing AUC: 0.9029324740128051
overall running time 470 seconds
(0.727549983056591, 0.6260996354799514, 0.6730231707635642, 0.9029324740128051, 0.8105584)

2019-02-24 01:51:35.320614: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:51:36.289346: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:51:36.292013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:51:36.292080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 23.320000 seconds
loading data in 29.680000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.591280    reg_loss: 0.064958    l2_loss: 0.013351    loss: 0.669590
steps 200    v_Prec: 0.164377  v_Recall: 1.000000  v_F1: 0.282343  v_AUC: 0.462174
steps 200    running time 40 seconds

steps 400    base_loss: 0.515169    reg_loss: 0.064949    l2_loss: 0.013256    loss: 0.593374
steps 400    v_Prec: 0.164379  v_Recall: 1.000000  v_F1: 0.282346  v_AUC: 0.481690
steps 400    running time 48 seconds

steps 600    base_loss: 0.497288    reg_loss: 0.064976    l2_loss: 0.013178    loss: 0.575441
steps 600    v_Prec: 0.164375  v_Recall: 1.000000  v_F1: 0.282340  v_AUC: 0.510832
steps 600    running time 54 seconds

steps 800    base_loss: 0.472309    reg_loss: 0.064893    l2_loss: 0.012997    loss: 0.550198
steps 800    v_Prec: 0.165450  v_Recall: 0.966264  v_F1: 0.282525  v_AUC: 0.530654
steps 800    running time 61 seconds

steps 1000    base_loss: 0.455318    reg_loss: 0.064702    l2_loss: 0.012903    loss: 0.532923
steps 1000    v_Prec: 0.166524  v_Recall: 0.944594  v_F1: 0.283134  v_AUC: 0.548420
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.447244    reg_loss: 0.064467    l2_loss: 0.012844    loss: 0.524556
steps 1200    v_Prec: 0.252635  v_Recall: 0.393872  v_F1: 0.307826  v_AUC: 0.603193
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.434439    reg_loss: 0.064531    l2_loss: 0.012791    loss: 0.511761
steps 1400    v_Prec: 0.389640  v_Recall: 0.366010  v_F1: 0.377456  v_AUC: 0.682662
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.417162    reg_loss: 0.065157    l2_loss: 0.012789    loss: 0.495107
steps 1600    v_Prec: 0.477679  v_Recall: 0.411097  v_F1: 0.441894  v_AUC: 0.743556
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.387628    reg_loss: 0.065875    l2_loss: 0.012905    loss: 0.466409
steps 1800    v_Prec: 0.540207  v_Recall: 0.451659  v_F1: 0.491980  v_AUC: 0.779451
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.369379    reg_loss: 0.066279    l2_loss: 0.013102    loss: 0.448760
steps 2000    v_Prec: 0.568049  v_Recall: 0.495634  v_F1: 0.529377  v_AUC: 0.810303
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.345677    reg_loss: 0.066773    l2_loss: 0.013371    loss: 0.425822
steps 2200    v_Prec: 0.629486  v_Recall: 0.503969  v_F1: 0.559778  v_AUC: 0.826696
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.320766    reg_loss: 0.067019    l2_loss: 0.013661    loss: 0.401446
steps 2400    v_Prec: 0.641050  v_Recall: 0.533021  v_F1: 0.582066  v_AUC: 0.841981
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.322620    reg_loss: 0.067531    l2_loss: 0.014007    loss: 0.404158
steps 2600    v_Prec: 0.667213  v_Recall: 0.549214  v_F1: 0.602490  v_AUC: 0.853930
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.304064    reg_loss: 0.067484    l2_loss: 0.014392    loss: 0.385940
steps 2800    v_Prec: 0.651807  v_Recall: 0.582632  v_F1: 0.615281  v_AUC: 0.860706
steps 2800    running time 130 seconds

steps 3000    base_loss: 0.297620    reg_loss: 0.067702    l2_loss: 0.014766    loss: 0.380087
steps 3000    v_Prec: 0.688166  v_Recall: 0.574218  v_F1: 0.626049  v_AUC: 0.869145
steps 3000    running time 138 seconds

steps 3200    base_loss: 0.293672    reg_loss: 0.067851    l2_loss: 0.015131    loss: 0.376654
steps 3200    v_Prec: 0.687033  v_Recall: 0.590887  v_F1: 0.635343  v_AUC: 0.874593
steps 3200    running time 145 seconds

steps 3400    base_loss: 0.291166    reg_loss: 0.068063    l2_loss: 0.015581    loss: 0.374810
steps 3400    v_Prec: 0.712717  v_Recall: 0.582315  v_F1: 0.640951  v_AUC: 0.878780
steps 3400    running time 152 seconds

steps 3600    base_loss: 0.295556    reg_loss: 0.068141    l2_loss: 0.015926    loss: 0.379622
steps 3600    v_Prec: 0.718447  v_Recall: 0.587395  v_F1: 0.646345  v_AUC: 0.881246
steps 3600    running time 159 seconds

steps 3800    base_loss: 0.288123    reg_loss: 0.068221    l2_loss: 0.016372    loss: 0.372717
steps 3800    v_Prec: 0.699665  v_Recall: 0.612637  v_F1: 0.653265  v_AUC: 0.887230
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.282716    reg_loss: 0.068370    l2_loss: 0.016823    loss: 0.367909
steps 4000    v_Prec: 0.718454  v_Recall: 0.607874  v_F1: 0.658554  v_AUC: 0.888952
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.278332    reg_loss: 0.068400    l2_loss: 0.017360    loss: 0.364092
steps 4200    v_Prec: 0.713453  v_Recall: 0.622162  v_F1: 0.664688  v_AUC: 0.891710
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.267822    reg_loss: 0.068315    l2_loss: 0.017809    loss: 0.353946
steps 4400    v_Prec: 0.698910  v_Recall: 0.641213  v_F1: 0.668819  v_AUC: 0.893571
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.270674    reg_loss: 0.068306    l2_loss: 0.018321    loss: 0.357300
steps 4600    v_Prec: 0.734432  v_Recall: 0.622559  v_F1: 0.673884  v_AUC: 0.896111
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.261715    reg_loss: 0.068117    l2_loss: 0.018798    loss: 0.348631
steps 4800    v_Prec: 0.691767  v_Recall: 0.656295  v_F1: 0.673564  v_AUC: 0.897479
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.266372    reg_loss: 0.068234    l2_loss: 0.019437    loss: 0.354044
steps 5000    v_Prec: 0.728391  v_Recall: 0.634783  v_F1: 0.678373  v_AUC: 0.899708
steps 5000    running time 208 seconds

steps 5200    base_loss: 0.265340    reg_loss: 0.068261    l2_loss: 0.020016    loss: 0.353617
steps 5200    v_Prec: 0.732457  v_Recall: 0.632164  v_F1: 0.678625  v_AUC: 0.901964
steps 5200    running time 215 seconds

steps 5400    base_loss: 0.258321    reg_loss: 0.068208    l2_loss: 0.020610    loss: 0.347140
steps 5400    v_Prec: 0.742698  v_Recall: 0.633751  v_F1: 0.683913  v_AUC: 0.901707
steps 5400    running time 222 seconds

steps 5600    base_loss: 0.166480    reg_loss: 0.067077    l2_loss: 0.021396    loss: 0.254954
steps 5600    v_Prec: 0.734770  v_Recall: 0.625179  v_F1: 0.675559  v_AUC: 0.897567
steps 5600    running time 229 seconds

steps 5800    base_loss: 0.177429    reg_loss: 0.067007    l2_loss: 0.022295    loss: 0.266731
steps 5800    v_Prec: 0.749564  v_Recall: 0.613431  v_F1: 0.674699  v_AUC: 0.894627
steps 5800    running time 235 seconds

steps 6000    base_loss: 0.179627    reg_loss: 0.066912    l2_loss: 0.023047    loss: 0.269587
steps 6000    v_Prec: 0.713834  v_Recall: 0.645102  v_F1: 0.677730  v_AUC: 0.896298
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.181161    reg_loss: 0.067047    l2_loss: 0.023656    loss: 0.271863
steps 6200    v_Prec: 0.745570  v_Recall: 0.624544  v_F1: 0.679711  v_AUC: 0.894768
steps 6200    running time 248 seconds

steps 6400    base_loss: 0.188303    reg_loss: 0.066969    l2_loss: 0.024366    loss: 0.279638
steps 6400    v_Prec: 0.735016  v_Recall: 0.635656  v_F1: 0.681735  v_AUC: 0.893936
steps 6400    running time 254 seconds

steps 6600    base_loss: 0.188123    reg_loss: 0.066841    l2_loss: 0.024943    loss: 0.279907
steps 6600    v_Prec: 0.746546  v_Recall: 0.634783  v_F1: 0.686143  v_AUC: 0.896965
steps 6600    running time 260 seconds

steps 6800    base_loss: 0.204144    reg_loss: 0.067118    l2_loss: 0.025388    loss: 0.296651
steps 6800    v_Prec: 0.749479  v_Recall: 0.628354  v_F1: 0.683592  v_AUC: 0.897287
steps 6800    running time 267 seconds

steps 7000    base_loss: 0.187460    reg_loss: 0.067073    l2_loss: 0.025805    loss: 0.280338
steps 7000    v_Prec: 0.767372  v_Recall: 0.627639  v_F1: 0.690507  v_AUC: 0.901557
steps 7000    running time 274 seconds

steps 7200    base_loss: 0.176564    reg_loss: 0.066922    l2_loss: 0.026209    loss: 0.269696
steps 7200    v_Prec: 0.751945  v_Recall: 0.636926  v_F1: 0.689673  v_AUC: 0.899583
steps 7200    running time 280 seconds

steps 7400    base_loss: 0.184245    reg_loss: 0.066901    l2_loss: 0.026696    loss: 0.277842
steps 7400    v_Prec: 0.751065  v_Recall: 0.643515  v_F1: 0.693143  v_AUC: 0.902382
steps 7400    running time 287 seconds

steps 7600    base_loss: 0.190453    reg_loss: 0.066711    l2_loss: 0.027012    loss: 0.284175
steps 7600    v_Prec: 0.763836  v_Recall: 0.635418  v_F1: 0.693734  v_AUC: 0.905190
steps 7600    running time 294 seconds

steps 7800    base_loss: 0.189816    reg_loss: 0.066793    l2_loss: 0.027388    loss: 0.283997
steps 7800    v_Prec: 0.755134  v_Recall: 0.645023  v_F1: 0.695749  v_AUC: 0.907133
steps 7800    running time 300 seconds

steps 8000    base_loss: 0.186011    reg_loss: 0.066839    l2_loss: 0.027634    loss: 0.280484
steps 8000    v_Prec: 0.744174  v_Recall: 0.666614  v_F1: 0.703262  v_AUC: 0.908049
steps 8000    running time 307 seconds

steps 8200    base_loss: 0.187790    reg_loss: 0.066723    l2_loss: 0.027915    loss: 0.282429
steps 8200    v_Prec: 0.773437  v_Recall: 0.648992  v_F1: 0.705771  v_AUC: 0.908757
steps 8200    running time 314 seconds

steps 8400    base_loss: 0.182894    reg_loss: 0.066629    l2_loss: 0.028242    loss: 0.277765
steps 8400    v_Prec: 0.770870  v_Recall: 0.660422  v_F1: 0.711385  v_AUC: 0.911999
steps 8400    running time 321 seconds

steps 8600    base_loss: 0.190645    reg_loss: 0.066691    l2_loss: 0.028480    loss: 0.285817
steps 8600    v_Prec: 0.768362  v_Recall: 0.664312  v_F1: 0.712559  v_AUC: 0.911882
steps 8600    running time 328 seconds

steps 8800    base_loss: 0.186068    reg_loss: 0.066655    l2_loss: 0.028785    loss: 0.281509
steps 8800    v_Prec: 0.799725  v_Recall: 0.646611  v_F1: 0.715063  v_AUC: 0.913577
steps 8800    running time 335 seconds

steps 9000    base_loss: 0.184729    reg_loss: 0.066505    l2_loss: 0.028941    loss: 0.280174
steps 9000    v_Prec: 0.785741  v_Recall: 0.657882  v_F1: 0.716150  v_AUC: 0.914141
steps 9000    running time 343 seconds

steps 9200    base_loss: 0.171935    reg_loss: 0.066305    l2_loss: 0.029245    loss: 0.267485
steps 9200    v_Prec: 0.782783  v_Recall: 0.664788  v_F1: 0.718977  v_AUC: 0.914877
steps 9200    running time 349 seconds

steps 9400    base_loss: 0.191810    reg_loss: 0.066489    l2_loss: 0.029318    loss: 0.287617
steps 9400    v_Prec: 0.769148  v_Recall: 0.678362  v_F1: 0.720908  v_AUC: 0.916582
steps 9400    running time 356 seconds

steps 9600    base_loss: 0.177277    reg_loss: 0.066445    l2_loss: 0.029737    loss: 0.273459
steps 9600    v_Prec: 0.794359  v_Recall: 0.668439  v_F1: 0.725980  v_AUC: 0.919088
steps 9600    running time 363 seconds

steps 9800    base_loss: 0.180517    reg_loss: 0.066152    l2_loss: 0.029843    loss: 0.276512
steps 9800    v_Prec: 0.755944  v_Recall: 0.694078  v_F1: 0.723691  v_AUC: 0.917005
steps 9800    running time 370 seconds

steps 10000    base_loss: 0.183082    reg_loss: 0.066578    l2_loss: 0.029957    loss: 0.279616
steps 10000    v_Prec: 0.781883  v_Recall: 0.676933  v_F1: 0.725633  v_AUC: 0.918723
steps 10000    running time 377 seconds

steps 10200    base_loss: 0.183096    reg_loss: 0.066119    l2_loss: 0.030169    loss: 0.279384
steps 10200    v_Prec: 0.793110  v_Recall: 0.670662  v_F1: 0.726764  v_AUC: 0.921278
steps 10200    running time 383 seconds

steps 10400    base_loss: 0.183418    reg_loss: 0.065934    l2_loss: 0.030403    loss: 0.279754
steps 10400    v_Prec: 0.791475  v_Recall: 0.683918  v_F1: 0.733776  v_AUC: 0.920329
steps 10400    running time 390 seconds

steps 10600    base_loss: 0.180164    reg_loss: 0.065963    l2_loss: 0.030538    loss: 0.276665
steps 10600    v_Prec: 0.822639  v_Recall: 0.664550  v_F1: 0.735192  v_AUC: 0.921997
steps 10600    running time 397 seconds

steps 10800    base_loss: 0.168033    reg_loss: 0.065861    l2_loss: 0.030500    loss: 0.264394
steps 10800    v_Prec: 0.829887  v_Recall: 0.662565  v_F1: 0.736847  v_AUC: 0.922921
steps 10800    running time 404 seconds

steps 11000    base_loss: 0.078157    reg_loss: 0.063938    l2_loss: 0.030670    loss: 0.172765
steps 11000    v_Prec: 0.781535  v_Recall: 0.680664  v_F1: 0.727620  v_AUC: 0.918249
steps 11000    running time 410 seconds

steps 11200    base_loss: 0.080966    reg_loss: 0.063884    l2_loss: 0.030712    loss: 0.175561
steps 11200    v_Prec: 0.762962  v_Recall: 0.684474  v_F1: 0.721590  v_AUC: 0.914387
steps 11200    running time 417 seconds

steps 11400    base_loss: 0.076050    reg_loss: 0.063822    l2_loss: 0.030781    loss: 0.170653
steps 11400    v_Prec: 0.773988  v_Recall: 0.666534  v_F1: 0.716254  v_AUC: 0.911075
steps 11400    running time 424 seconds

steps 11600    base_loss: 0.084408    reg_loss: 0.063730    l2_loss: 0.030817    loss: 0.178955
steps 11600    v_Prec: 0.787449  v_Recall: 0.656374  v_F1: 0.715962  v_AUC: 0.909806
steps 11600    running time 430 seconds

steps 11800    base_loss: 0.084670    reg_loss: 0.063680    l2_loss: 0.030973    loss: 0.179324
steps 11800    v_Prec: 0.762850  v_Recall: 0.673837  v_F1: 0.715586  v_AUC: 0.907355
steps 11800    running time 437 seconds

steps 12000    base_loss: 0.077056    reg_loss: 0.063929    l2_loss: 0.030985    loss: 0.171969
steps 12000    v_Prec: 0.784710  v_Recall: 0.650976  v_F1: 0.711614  v_AUC: 0.906065
steps 12000    running time 443 seconds

steps 12200    base_loss: 0.084282    reg_loss: 0.063599    l2_loss: 0.031078    loss: 0.178959
steps 12200    v_Prec: 0.757854  v_Recall: 0.673996  v_F1: 0.713469  v_AUC: 0.906837
steps 12200    running time 451 seconds

steps 12400    base_loss: 0.080845    reg_loss: 0.063641    l2_loss: 0.031129    loss: 0.175615
steps 12400    v_Prec: 0.779736  v_Recall: 0.660343  v_F1: 0.715090  v_AUC: 0.905674
steps 12400    running time 457 seconds

steps 12600    base_loss: 0.089113    reg_loss: 0.063421    l2_loss: 0.031108    loss: 0.183642
steps 12600    v_Prec: 0.771891  v_Recall: 0.666137  v_F1: 0.715126  v_AUC: 0.906493
steps 12600    running time 464 seconds

steps 12800    base_loss: 0.088517    reg_loss: 0.063482    l2_loss: 0.031138    loss: 0.183137
steps 12800    v_Prec: 0.782912  v_Recall: 0.658993  v_F1: 0.715628  v_AUC: 0.906360
steps 12800    running time 470 seconds

Early stop model F1: 0.736847
testing thre: 0.5634765
testing Prec: 0.6349435547387766
testing Recall: 0.705273390036452
testing F1: 0.6682631421400447
testing AUC: 0.9042343142518451
overall running time 472 seconds
(0.7412009445631396, 0.6407290400972053, 0.6873126352284873, 0.9042343142518451, 0.73730063)

2019-02-24 01:57:11.405505: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:57:13.105516: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:57:13.106487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:57:13.106537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.040000 seconds
loading data in 30.180000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.523144    reg_loss: 0.064690    l2_loss: 0.013377    loss: 0.601210
steps 200    v_Prec: 0.165309  v_Recall: 0.997707  v_F1: 0.283624  v_AUC: 0.522233
steps 200    running time 40 seconds

steps 400    base_loss: 0.509714    reg_loss: 0.064692    l2_loss: 0.013395    loss: 0.587801
steps 400    v_Prec: 0.166907  v_Recall: 0.960629  v_F1: 0.284400  v_AUC: 0.531535
steps 400    running time 48 seconds

steps 600    base_loss: 0.475500    reg_loss: 0.064051    l2_loss: 0.013290    loss: 0.552841
steps 600    v_Prec: 0.174217  v_Recall: 0.809076  v_F1: 0.286699  v_AUC: 0.550923
steps 600    running time 55 seconds

steps 800    base_loss: 0.467451    reg_loss: 0.063752    l2_loss: 0.013174    loss: 0.544377
steps 800    v_Prec: 0.210668  v_Recall: 0.606056  v_F1: 0.312655  v_AUC: 0.614298
steps 800    running time 62 seconds

steps 1000    base_loss: 0.446763    reg_loss: 0.062888    l2_loss: 0.013092    loss: 0.522743
steps 1000    v_Prec: 0.244940  v_Recall: 0.577832  v_F1: 0.344042  v_AUC: 0.664163
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.436216    reg_loss: 0.061981    l2_loss: 0.013049    loss: 0.511245
steps 1200    v_Prec: 0.355431  v_Recall: 0.460748  v_F1: 0.401294  v_AUC: 0.724252
steps 1200    running time 76 seconds

steps 1400    base_loss: 0.410117    reg_loss: 0.060986    l2_loss: 0.013171    loss: 0.484275
steps 1400    v_Prec: 0.442893  v_Recall: 0.478852  v_F1: 0.460171  v_AUC: 0.770844
steps 1400    running time 83 seconds

steps 1600    base_loss: 0.381031    reg_loss: 0.060133    l2_loss: 0.013355    loss: 0.454519
steps 1600    v_Prec: 0.509891  v_Recall: 0.499249  v_F1: 0.504514  v_AUC: 0.803045
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.361883    reg_loss: 0.059217    l2_loss: 0.013613    loss: 0.434714
steps 1800    v_Prec: 0.519842  v_Recall: 0.563365  v_F1: 0.540729  v_AUC: 0.829964
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.339673    reg_loss: 0.058319    l2_loss: 0.013928    loss: 0.411920
steps 2000    v_Prec: 0.569096  v_Recall: 0.559333  v_F1: 0.564172  v_AUC: 0.842873
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.321727    reg_loss: 0.057430    l2_loss: 0.014245    loss: 0.393403
steps 2200    v_Prec: 0.572250  v_Recall: 0.597676  v_F1: 0.584687  v_AUC: 0.855044
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.317556    reg_loss: 0.056925    l2_loss: 0.014630    loss: 0.389111
steps 2400    v_Prec: 0.610563  v_Recall: 0.592221  v_F1: 0.601252  v_AUC: 0.860706
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.313653    reg_loss: 0.056183    l2_loss: 0.015034    loss: 0.384870
steps 2600    v_Prec: 0.632471  v_Recall: 0.599020  v_F1: 0.615291  v_AUC: 0.868498
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.303417    reg_loss: 0.055576    l2_loss: 0.015523    loss: 0.374516
steps 2800    v_Prec: 0.666313  v_Recall: 0.595620  v_F1: 0.628986  v_AUC: 0.873565
steps 2800    running time 130 seconds

steps 3000    base_loss: 0.301441    reg_loss: 0.054792    l2_loss: 0.015942    loss: 0.372176
steps 3000    v_Prec: 0.663553  v_Recall: 0.606530  v_F1: 0.633762  v_AUC: 0.878441
steps 3000    running time 137 seconds

steps 3200    base_loss: 0.296575    reg_loss: 0.054161    l2_loss: 0.016328    loss: 0.367064
steps 3200    v_Prec: 0.673890  v_Recall: 0.607242  v_F1: 0.638832  v_AUC: 0.879950
steps 3200    running time 145 seconds

steps 3400    base_loss: 0.291595    reg_loss: 0.053480    l2_loss: 0.016699    loss: 0.361775
steps 3400    v_Prec: 0.670453  v_Recall: 0.620681  v_F1: 0.644608  v_AUC: 0.883962
steps 3400    running time 152 seconds

steps 3600    base_loss: 0.295211    reg_loss: 0.052956    l2_loss: 0.017250    loss: 0.365417
steps 3600    v_Prec: 0.671673  v_Recall: 0.625741  v_F1: 0.647894  v_AUC: 0.884819
steps 3600    running time 159 seconds

steps 3800    base_loss: 0.286163    reg_loss: 0.052216    l2_loss: 0.017699    loss: 0.356077
steps 3800    v_Prec: 0.700000  v_Recall: 0.613171  v_F1: 0.653715  v_AUC: 0.888216
steps 3800    running time 166 seconds

steps 4000    base_loss: 0.287487    reg_loss: 0.051655    l2_loss: 0.018139    loss: 0.357281
steps 4000    v_Prec: 0.672736  v_Recall: 0.642580  v_F1: 0.657313  v_AUC: 0.890173
steps 4000    running time 173 seconds

steps 4200    base_loss: 0.287608    reg_loss: 0.051157    l2_loss: 0.018636    loss: 0.357402
steps 4200    v_Prec: 0.673479  v_Recall: 0.648668  v_F1: 0.660841  v_AUC: 0.892993
steps 4200    running time 180 seconds

steps 4400    base_loss: 0.281567    reg_loss: 0.050373    l2_loss: 0.019111    loss: 0.351051
steps 4400    v_Prec: 0.703060  v_Recall: 0.630247  v_F1: 0.664666  v_AUC: 0.894587
steps 4400    running time 187 seconds

steps 4600    base_loss: 0.279503    reg_loss: 0.049755    l2_loss: 0.019653    loss: 0.348911
steps 4600    v_Prec: 0.696735  v_Recall: 0.632619  v_F1: 0.663131  v_AUC: 0.895427
steps 4600    running time 194 seconds

steps 4800    base_loss: 0.280923    reg_loss: 0.049167    l2_loss: 0.020148    loss: 0.350238
steps 4800    v_Prec: 0.682734  v_Recall: 0.656178  v_F1: 0.669193  v_AUC: 0.898770
steps 4800    running time 201 seconds

steps 5000    base_loss: 0.279054    reg_loss: 0.048848    l2_loss: 0.020684    loss: 0.348586
steps 5000    v_Prec: 0.693146  v_Recall: 0.653965  v_F1: 0.672985  v_AUC: 0.896292
steps 5000    running time 207 seconds

steps 5200    base_loss: 0.275969    reg_loss: 0.048098    l2_loss: 0.021261    loss: 0.345328
steps 5200    v_Prec: 0.717926  v_Recall: 0.639260  v_F1: 0.676313  v_AUC: 0.899429
steps 5200    running time 214 seconds

steps 5400    base_loss: 0.263051    reg_loss: 0.047647    l2_loss: 0.021826    loss: 0.332524
steps 5400    v_Prec: 0.730508  v_Recall: 0.629615  v_F1: 0.676319  v_AUC: 0.898300
steps 5400    running time 221 seconds

steps 5600    base_loss: 0.175423    reg_loss: 0.048143    l2_loss: 0.022426    loss: 0.245993
steps 5600    v_Prec: 0.716990  v_Recall: 0.622895  v_F1: 0.666638  v_AUC: 0.896380
steps 5600    running time 228 seconds

steps 5800    base_loss: 0.167405    reg_loss: 0.048791    l2_loss: 0.023096    loss: 0.239292
steps 5800    v_Prec: 0.698365  v_Recall: 0.628192  v_F1: 0.661423  v_AUC: 0.891277
steps 5800    running time 234 seconds

steps 6000    base_loss: 0.165248    reg_loss: 0.049053    l2_loss: 0.023789    loss: 0.238091
steps 6000    v_Prec: 0.675743  v_Recall: 0.643529  v_F1: 0.659243  v_AUC: 0.888517
steps 6000    running time 241 seconds

steps 6200    base_loss: 0.186846    reg_loss: 0.049242    l2_loss: 0.024441    loss: 0.260529
steps 6200    v_Prec: 0.694372  v_Recall: 0.628113  v_F1: 0.659582  v_AUC: 0.891419
steps 6200    running time 249 seconds

steps 6400    base_loss: 0.175079    reg_loss: 0.048951    l2_loss: 0.025091    loss: 0.249120
steps 6400    v_Prec: 0.676088  v_Recall: 0.633489  v_F1: 0.654096  v_AUC: 0.891724
steps 6400    running time 255 seconds

steps 6600    base_loss: 0.175974    reg_loss: 0.049046    l2_loss: 0.025643    loss: 0.250663
steps 6600    v_Prec: 0.660370  v_Recall: 0.654992  v_F1: 0.657670  v_AUC: 0.889445
steps 6600    running time 262 seconds

steps 6800    base_loss: 0.183054    reg_loss: 0.048477    l2_loss: 0.026270    loss: 0.257801
steps 6800    v_Prec: 0.676042  v_Recall: 0.649854  v_F1: 0.662689  v_AUC: 0.893222
steps 6800    running time 268 seconds

steps 7000    base_loss: 0.177614    reg_loss: 0.048185    l2_loss: 0.026767    loss: 0.252567
steps 7000    v_Prec: 0.685199  v_Recall: 0.637205  v_F1: 0.660331  v_AUC: 0.892005
steps 7000    running time 275 seconds

steps 7200    base_loss: 0.182514    reg_loss: 0.048033    l2_loss: 0.027042    loss: 0.257589
steps 7200    v_Prec: 0.697592  v_Recall: 0.639023  v_F1: 0.667024  v_AUC: 0.893168
steps 7200    running time 281 seconds

steps 7400    base_loss: 0.179033    reg_loss: 0.047899    l2_loss: 0.027584    loss: 0.254516
steps 7400    v_Prec: 0.701818  v_Recall: 0.628745  v_F1: 0.663275  v_AUC: 0.894114
steps 7400    running time 287 seconds

Early stop model F1: 0.676319
testing thre: 0.44232363
testing Prec: 0.5551593235936961
testing Recall: 0.7036695018226002
testing F1: 0.6206541775624812
testing AUC: 0.881142745904333
overall running time 290 seconds
(0.6875518442736271, 0.604277035236938, 0.6432303792229294, 0.881142745904333, 0.64054734)

2019-02-24 02:00:42.433204: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:00:43.345077: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:00:43.345977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:00:43.346012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.140000 seconds
loading data in 30.340000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	80
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.474194    reg_loss: 0.064674    l2_loss: 0.013284    loss: 0.552152
steps 200    v_Prec: 0.163396  v_Recall: 1.000000  v_F1: 0.280895  v_AUC: 0.474460
steps 200    running time 40 seconds

steps 400    base_loss: 0.468780    reg_loss: 0.064579    l2_loss: 0.013201    loss: 0.546560
steps 400    v_Prec: 0.164787  v_Recall: 0.955602  v_F1: 0.281100  v_AUC: 0.520269
steps 400    running time 47 seconds

steps 600    base_loss: 0.464647    reg_loss: 0.064568    l2_loss: 0.012988    loss: 0.542202
steps 600    v_Prec: 0.191512  v_Recall: 0.668450  v_F1: 0.297726  v_AUC: 0.592074
steps 600    running time 54 seconds

steps 800    base_loss: 0.452223    reg_loss: 0.064525    l2_loss: 0.012796    loss: 0.529545
steps 800    v_Prec: 0.275982  v_Recall: 0.488142  v_F1: 0.352609  v_AUC: 0.671433
steps 800    running time 61 seconds

steps 1000    base_loss: 0.428185    reg_loss: 0.064435    l2_loss: 0.012620    loss: 0.505240
steps 1000    v_Prec: 0.411393  v_Recall: 0.452687  v_F1: 0.431053  v_AUC: 0.748559
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.393049    reg_loss: 0.064660    l2_loss: 0.012591    loss: 0.470300
steps 1200    v_Prec: 0.500932  v_Recall: 0.493492  v_F1: 0.497184  v_AUC: 0.792838
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.353885    reg_loss: 0.064725    l2_loss: 0.012623    loss: 0.431233
steps 1400    v_Prec: 0.551962  v_Recall: 0.531422  v_F1: 0.541497  v_AUC: 0.818589
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.340867    reg_loss: 0.065052    l2_loss: 0.012794    loss: 0.418714
steps 1600    v_Prec: 0.572563  v_Recall: 0.558572  v_F1: 0.565481  v_AUC: 0.835342
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.328811    reg_loss: 0.065550    l2_loss: 0.013021    loss: 0.407382
steps 1800    v_Prec: 0.601466  v_Recall: 0.576779  v_F1: 0.588864  v_AUC: 0.850421
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.310068    reg_loss: 0.065637    l2_loss: 0.013237    loss: 0.388942
steps 2000    v_Prec: 0.622589  v_Recall: 0.592909  v_F1: 0.607387  v_AUC: 0.860682
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.303026    reg_loss: 0.065843    l2_loss: 0.013469    loss: 0.382337
steps 2200    v_Prec: 0.610213  v_Recall: 0.626926  v_F1: 0.618457  v_AUC: 0.867197
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.300009    reg_loss: 0.066254    l2_loss: 0.013749    loss: 0.380011
steps 2400    v_Prec: 0.673031  v_Recall: 0.585483  v_F1: 0.626212  v_AUC: 0.873049
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.294513    reg_loss: 0.066311    l2_loss: 0.014020    loss: 0.374844
steps 2600    v_Prec: 0.677460  v_Recall: 0.603130  v_F1: 0.638138  v_AUC: 0.879071
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.292539    reg_loss: 0.066633    l2_loss: 0.014285    loss: 0.373457
steps 2800    v_Prec: 0.654119  v_Recall: 0.632756  v_F1: 0.643260  v_AUC: 0.883996
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.284934    reg_loss: 0.066887    l2_loss: 0.014600    loss: 0.366421
steps 3000    v_Prec: 0.641175  v_Recall: 0.650084  v_F1: 0.645599  v_AUC: 0.886161
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.289189    reg_loss: 0.066962    l2_loss: 0.014921    loss: 0.371071
steps 3200    v_Prec: 0.670352  v_Recall: 0.634273  v_F1: 0.651814  v_AUC: 0.889580
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.283643    reg_loss: 0.067238    l2_loss: 0.015280    loss: 0.366161
steps 3400    v_Prec: 0.693457  v_Recall: 0.618702  v_F1: 0.653950  v_AUC: 0.890869
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.280508    reg_loss: 0.067309    l2_loss: 0.015667    loss: 0.363484
steps 3600    v_Prec: 0.680031  v_Recall: 0.633874  v_F1: 0.656142  v_AUC: 0.892087
steps 3600    running time 157 seconds

steps 3800    base_loss: 0.275389    reg_loss: 0.067130    l2_loss: 0.016017    loss: 0.358535
steps 3800    v_Prec: 0.670952  v_Recall: 0.650164  v_F1: 0.660394  v_AUC: 0.895384
steps 3800    running time 164 seconds

steps 4000    base_loss: 0.273581    reg_loss: 0.067256    l2_loss: 0.016407    loss: 0.357245
steps 4000    v_Prec: 0.671072  v_Recall: 0.652799  v_F1: 0.661809  v_AUC: 0.896388
steps 4000    running time 171 seconds

steps 4200    base_loss: 0.276799    reg_loss: 0.067439    l2_loss: 0.016873    loss: 0.361111
steps 4200    v_Prec: 0.699316  v_Recall: 0.636828  v_F1: 0.666611  v_AUC: 0.896725
steps 4200    running time 178 seconds

steps 4400    base_loss: 0.266468    reg_loss: 0.067335    l2_loss: 0.017435    loss: 0.351238
steps 4400    v_Prec: 0.687330  v_Recall: 0.644574  v_F1: 0.665266  v_AUC: 0.898180
steps 4400    running time 185 seconds

steps 4600    base_loss: 0.271840    reg_loss: 0.067207    l2_loss: 0.017887    loss: 0.356934
steps 4600    v_Prec: 0.684742  v_Recall: 0.655434  v_F1: 0.669767  v_AUC: 0.900694
steps 4600    running time 191 seconds

steps 4800    base_loss: 0.270332    reg_loss: 0.067311    l2_loss: 0.018402    loss: 0.356046
steps 4800    v_Prec: 0.693298  v_Recall: 0.649285  v_F1: 0.670570  v_AUC: 0.899551
steps 4800    running time 198 seconds

steps 5000    base_loss: 0.269575    reg_loss: 0.067526    l2_loss: 0.019030    loss: 0.356131
steps 5000    v_Prec: 0.712371  v_Recall: 0.640981  v_F1: 0.674793  v_AUC: 0.901701
steps 5000    running time 205 seconds

steps 5200    base_loss: 0.260171    reg_loss: 0.067344    l2_loss: 0.019659    loss: 0.347173
steps 5200    v_Prec: 0.699107  v_Recall: 0.649924  v_F1: 0.673619  v_AUC: 0.901328
steps 5200    running time 212 seconds

steps 5400    base_loss: 0.257271    reg_loss: 0.067291    l2_loss: 0.020397    loss: 0.344959
steps 5400    v_Prec: 0.702516  v_Recall: 0.648886  v_F1: 0.674637  v_AUC: 0.903235
steps 5400    running time 218 seconds

steps 5600    base_loss: 0.179545    reg_loss: 0.068408    l2_loss: 0.021155    loss: 0.269107
steps 5600    v_Prec: 0.693533  v_Recall: 0.653438  v_F1: 0.672889  v_AUC: 0.899412
steps 5600    running time 224 seconds

steps 5800    base_loss: 0.171772    reg_loss: 0.068028    l2_loss: 0.021947    loss: 0.261747
steps 5800    v_Prec: 0.702008  v_Recall: 0.639224  v_F1: 0.669147  v_AUC: 0.895893
steps 5800    running time 231 seconds

steps 6000    base_loss: 0.174412    reg_loss: 0.068289    l2_loss: 0.022687    loss: 0.265389
steps 6000    v_Prec: 0.684622  v_Recall: 0.650563  v_F1: 0.667158  v_AUC: 0.895337
steps 6000    running time 237 seconds

steps 6200    base_loss: 0.179288    reg_loss: 0.068271    l2_loss: 0.023407    loss: 0.270967
steps 6200    v_Prec: 0.681230  v_Recall: 0.643696  v_F1: 0.661931  v_AUC: 0.893368
steps 6200    running time 244 seconds

steps 6400    base_loss: 0.176467    reg_loss: 0.068198    l2_loss: 0.024013    loss: 0.268679
steps 6400    v_Prec: 0.668649  v_Recall: 0.664537  v_F1: 0.666587  v_AUC: 0.895334
steps 6400    running time 250 seconds

steps 6600    base_loss: 0.180096    reg_loss: 0.068086    l2_loss: 0.024524    loss: 0.272706
steps 6600    v_Prec: 0.701586  v_Recall: 0.635870  v_F1: 0.667113  v_AUC: 0.896975
steps 6600    running time 257 seconds

steps 6800    base_loss: 0.179799    reg_loss: 0.068163    l2_loss: 0.025128    loss: 0.273090
steps 6800    v_Prec: 0.710676  v_Recall: 0.637866  v_F1: 0.672306  v_AUC: 0.897686
steps 6800    running time 263 seconds

steps 7000    base_loss: 0.189118    reg_loss: 0.067730    l2_loss: 0.025500    loss: 0.282348
steps 7000    v_Prec: 0.695181  v_Recall: 0.655434  v_F1: 0.674723  v_AUC: 0.898205
steps 7000    running time 269 seconds

Early stop model F1: 0.674793
testing thre: 0.4180065
testing Prec: 0.5415855354659249
testing Recall: 0.6624058323207777
testing F1: 0.5959335373852208
testing AUC: 0.8682359607252538
overall running time 272 seconds
(0.6532428523751251, 0.5707897934386391, 0.6092392291131689, 0.8682359607252538, 0.5678659)

2019-02-24 02:04:04.433257: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:04:05.236074: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:04:05.240499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:04:05.240541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.050000 seconds
loading data in 30.370000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.573186    reg_loss: 0.064718    l2_loss: 0.013326    loss: 1.651230
steps 200    v_Prec: 0.162252  v_Recall: 0.998874  v_F1: 0.279159  v_AUC: 0.519158
steps 200    running time 41 seconds

steps 400    base_loss: 1.043351    reg_loss: 0.064449    l2_loss: 0.013102    loss: 1.120902
steps 400    v_Prec: 0.162880  v_Recall: 0.994449  v_F1: 0.279914  v_AUC: 0.538966
steps 400    running time 48 seconds

steps 600    base_loss: 0.562770    reg_loss: 0.064316    l2_loss: 0.012785    loss: 0.639870
steps 600    v_Prec: 0.179262  v_Recall: 0.713355  v_F1: 0.286522  v_AUC: 0.571731
steps 600    running time 55 seconds

steps 800    base_loss: 0.462561    reg_loss: 0.063999    l2_loss: 0.012567    loss: 0.539127
steps 800    v_Prec: 0.237778  v_Recall: 0.474256  v_F1: 0.316748  v_AUC: 0.625524
steps 800    running time 62 seconds

steps 1000    base_loss: 0.458108    reg_loss: 0.063570    l2_loss: 0.012454    loss: 0.534132
steps 1000    v_Prec: 0.314948  v_Recall: 0.423089  v_F1: 0.361096  v_AUC: 0.669978
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.437304    reg_loss: 0.063030    l2_loss: 0.012305    loss: 0.512639
steps 1200    v_Prec: 0.379635  v_Recall: 0.444811  v_F1: 0.409647  v_AUC: 0.706738
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.417016    reg_loss: 0.062435    l2_loss: 0.012287    loss: 0.491738
steps 1400    v_Prec: 0.470372  v_Recall: 0.431698  v_F1: 0.450206  v_AUC: 0.740073
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.402911    reg_loss: 0.062321    l2_loss: 0.012275    loss: 0.477506
steps 1600    v_Prec: 0.490881  v_Recall: 0.463395  v_F1: 0.476742  v_AUC: 0.761481
steps 1600    running time 91 seconds

steps 1800    base_loss: 0.380711    reg_loss: 0.062087    l2_loss: 0.012334    loss: 0.455132
steps 1800    v_Prec: 0.505451  v_Recall: 0.503540  v_F1: 0.504494  v_AUC: 0.782598
steps 1800    running time 98 seconds

steps 2000    base_loss: 0.367614    reg_loss: 0.061874    l2_loss: 0.012453    loss: 0.441941
steps 2000    v_Prec: 0.536076  v_Recall: 0.511665  v_F1: 0.523586  v_AUC: 0.798783
steps 2000    running time 105 seconds

steps 2200    base_loss: 0.356816    reg_loss: 0.061832    l2_loss: 0.012556    loss: 0.431204
steps 2200    v_Prec: 0.542507  v_Recall: 0.530330  v_F1: 0.536349  v_AUC: 0.810553
steps 2200    running time 113 seconds

steps 2400    base_loss: 0.352930    reg_loss: 0.061853    l2_loss: 0.012665    loss: 0.427448
steps 2400    v_Prec: 0.555537  v_Recall: 0.542800  v_F1: 0.549095  v_AUC: 0.820335
steps 2400    running time 119 seconds

steps 2600    base_loss: 0.348395    reg_loss: 0.061535    l2_loss: 0.012795    loss: 0.422724
steps 2600    v_Prec: 0.560348  v_Recall: 0.549799  v_F1: 0.555023  v_AUC: 0.826767
steps 2600    running time 126 seconds

steps 2800    base_loss: 0.343047    reg_loss: 0.061528    l2_loss: 0.012885    loss: 0.417460
steps 2800    v_Prec: 0.539168  v_Recall: 0.576428  v_F1: 0.557176  v_AUC: 0.829942
steps 2800    running time 134 seconds

steps 3000    base_loss: 0.342257    reg_loss: 0.061276    l2_loss: 0.012994    loss: 0.416528
steps 3000    v_Prec: 0.544651  v_Recall: 0.579968  v_F1: 0.561755  v_AUC: 0.834138
steps 3000    running time 141 seconds

steps 3200    base_loss: 0.341790    reg_loss: 0.061037    l2_loss: 0.013178    loss: 0.416005
steps 3200    v_Prec: 0.552076  v_Recall: 0.582944  v_F1: 0.567091  v_AUC: 0.838112
steps 3200    running time 148 seconds

steps 3400    base_loss: 0.336950    reg_loss: 0.060876    l2_loss: 0.013410    loss: 0.411236
steps 3400    v_Prec: 0.539935  v_Recall: 0.598793  v_F1: 0.567843  v_AUC: 0.842536
steps 3400    running time 155 seconds

steps 3600    base_loss: 0.336570    reg_loss: 0.060747    l2_loss: 0.013790    loss: 0.411106
steps 3600    v_Prec: 0.542169  v_Recall: 0.608206  v_F1: 0.573292  v_AUC: 0.848872
steps 3600    running time 162 seconds

steps 3800    base_loss: 0.320809    reg_loss: 0.060260    l2_loss: 0.014381    loss: 0.395450
steps 3800    v_Prec: 0.570130  v_Recall: 0.600402  v_F1: 0.584875  v_AUC: 0.856098
steps 3800    running time 170 seconds

steps 4000    base_loss: 0.329754    reg_loss: 0.060224    l2_loss: 0.015190    loss: 0.405168
steps 4000    v_Prec: 0.585176  v_Recall: 0.600241  v_F1: 0.592613  v_AUC: 0.863356
steps 4000    running time 177 seconds

steps 4200    base_loss: 0.319580    reg_loss: 0.059851    l2_loss: 0.016233    loss: 0.395664
steps 4200    v_Prec: 0.557077  v_Recall: 0.634835  v_F1: 0.593420  v_AUC: 0.865751
steps 4200    running time 185 seconds

steps 4400    base_loss: 0.308964    reg_loss: 0.059295    l2_loss: 0.017296    loss: 0.385555
steps 4400    v_Prec: 0.571439  v_Recall: 0.631295  v_F1: 0.599878  v_AUC: 0.869095
steps 4400    running time 192 seconds

steps 4600    base_loss: 0.314506    reg_loss: 0.058967    l2_loss: 0.018332    loss: 0.391805
steps 4600    v_Prec: 0.602563  v_Recall: 0.609010  v_F1: 0.605770  v_AUC: 0.872840
steps 4600    running time 199 seconds

steps 4800    base_loss: 0.303771    reg_loss: 0.058568    l2_loss: 0.019484    loss: 0.381823
steps 4800    v_Prec: 0.587901  v_Recall: 0.640306  v_F1: 0.612985  v_AUC: 0.876634
steps 4800    running time 207 seconds

steps 5000    base_loss: 0.301898    reg_loss: 0.058111    l2_loss: 0.020553    loss: 0.380563
steps 5000    v_Prec: 0.593355  v_Recall: 0.642237  v_F1: 0.616829  v_AUC: 0.878482
steps 5000    running time 214 seconds

steps 5200    base_loss: 0.310659    reg_loss: 0.057699    l2_loss: 0.021679    loss: 0.390037
steps 5200    v_Prec: 0.598480  v_Recall: 0.646340  v_F1: 0.621490  v_AUC: 0.881115
steps 5200    running time 222 seconds

steps 5400    base_loss: 0.295952    reg_loss: 0.057207    l2_loss: 0.022797    loss: 0.375955
steps 5400    v_Prec: 0.595401  v_Recall: 0.651971  v_F1: 0.622403  v_AUC: 0.880991
steps 5400    running time 229 seconds

steps 5600    base_loss: 0.177239    reg_loss: 0.060013    l2_loss: 0.023648    loss: 0.260900
steps 5600    v_Prec: 0.597864  v_Recall: 0.625905  v_F1: 0.611563  v_AUC: 0.875749
steps 5600    running time 236 seconds

steps 5800    base_loss: 0.184542    reg_loss: 0.060584    l2_loss: 0.023931    loss: 0.269056
steps 5800    v_Prec: 0.586176  v_Recall: 0.623572  v_F1: 0.604296  v_AUC: 0.870520
steps 5800    running time 243 seconds

steps 6000    base_loss: 0.187529    reg_loss: 0.061038    l2_loss: 0.024589    loss: 0.273155
steps 6000    v_Prec: 0.593767  v_Recall: 0.613113  v_F1: 0.603285  v_AUC: 0.868033
steps 6000    running time 249 seconds

steps 6200    base_loss: 0.192887    reg_loss: 0.061231    l2_loss: 0.025112    loss: 0.279230
steps 6200    v_Prec: 0.592925  v_Recall: 0.610861  v_F1: 0.601759  v_AUC: 0.867554
steps 6200    running time 256 seconds

steps 6400    base_loss: 0.187438    reg_loss: 0.061253    l2_loss: 0.025686    loss: 0.274377
steps 6400    v_Prec: 0.578928  v_Recall: 0.630813  v_F1: 0.603758  v_AUC: 0.870462
steps 6400    running time 262 seconds

steps 6600    base_loss: 0.195167    reg_loss: 0.061196    l2_loss: 0.026169    loss: 0.282532
steps 6600    v_Prec: 0.574829  v_Recall: 0.643041  v_F1: 0.607025  v_AUC: 0.869263
steps 6600    running time 268 seconds

steps 6800    base_loss: 0.180237    reg_loss: 0.060733    l2_loss: 0.026651    loss: 0.267621
steps 6800    v_Prec: 0.585421  v_Recall: 0.626066  v_F1: 0.605062  v_AUC: 0.869993
steps 6800    running time 275 seconds

steps 7000    base_loss: 0.190248    reg_loss: 0.060534    l2_loss: 0.027079    loss: 0.277861
steps 7000    v_Prec: 0.602083  v_Recall: 0.613757  v_F1: 0.607864  v_AUC: 0.870173
steps 7000    running time 281 seconds

steps 7200    base_loss: 0.199444    reg_loss: 0.060387    l2_loss: 0.027546    loss: 0.287377
steps 7200    v_Prec: 0.587762  v_Recall: 0.635237  v_F1: 0.610578  v_AUC: 0.873543
steps 7200    running time 288 seconds

steps 7400    base_loss: 0.186019    reg_loss: 0.060110    l2_loss: 0.027813    loss: 0.273943
steps 7400    v_Prec: 0.592147  v_Recall: 0.641834  v_F1: 0.615990  v_AUC: 0.874746
steps 7400    running time 294 seconds

Early stop model F1: 0.622403
testing thre: 0.2506724
testing Prec: 0.4201774136668204
testing Recall: 0.7528068043742406
testing F1: 0.5393293638357882
testing AUC: 0.8590373200059018
overall running time 297 seconds
(0.616619096343368, 0.5565006075334143, 0.5850194154915185, 0.8590373200059018, 0.5167918)

2019-02-24 02:07:54.602640: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:07:54.870078: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:07:54.870991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:07:54.871026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 22.760000 seconds
loading data in 28.940000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 2.520801    reg_loss: 0.064828    l2_loss: 0.013371    loss: 2.599000
steps 200    v_Prec: 0.163430  v_Recall: 0.999361  v_F1: 0.280920  v_AUC: 0.503853
steps 200    running time 39 seconds

steps 400    base_loss: 1.831953    reg_loss: 0.064448    l2_loss: 0.013371    loss: 1.909772
steps 400    v_Prec: 0.163415  v_Recall: 0.999920  v_F1: 0.280920  v_AUC: 0.468326
steps 400    running time 46 seconds

steps 600    base_loss: 0.684335    reg_loss: 0.065135    l2_loss: 0.013123    loss: 0.762593
steps 600    v_Prec: 0.163396  v_Recall: 1.000000  v_F1: 0.280895  v_AUC: 0.500491
steps 600    running time 53 seconds

steps 800    base_loss: 0.489066    reg_loss: 0.065169    l2_loss: 0.012869    loss: 0.567104
steps 800    v_Prec: 0.186987  v_Recall: 0.631558  v_F1: 0.288544  v_AUC: 0.570156
steps 800    running time 60 seconds

steps 1000    base_loss: 0.471456    reg_loss: 0.064863    l2_loss: 0.012548    loss: 0.548867
steps 1000    v_Prec: 0.274733  v_Recall: 0.432644  v_F1: 0.336063  v_AUC: 0.641975
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.464537    reg_loss: 0.064829    l2_loss: 0.012210    loss: 0.541576
steps 1200    v_Prec: 0.396105  v_Recall: 0.404456  v_F1: 0.400237  v_AUC: 0.706210
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.443890    reg_loss: 0.064789    l2_loss: 0.011994    loss: 0.520673
steps 1400    v_Prec: 0.490451  v_Recall: 0.442945  v_F1: 0.465489  v_AUC: 0.759036
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.429913    reg_loss: 0.064921    l2_loss: 0.011824    loss: 0.506658
steps 1600    v_Prec: 0.522766  v_Recall: 0.493252  v_F1: 0.507580  v_AUC: 0.791334
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.400503    reg_loss: 0.064993    l2_loss: 0.011833    loss: 0.477330
steps 1800    v_Prec: 0.551545  v_Recall: 0.507546  v_F1: 0.528631  v_AUC: 0.810223
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.382007    reg_loss: 0.065076    l2_loss: 0.012002    loss: 0.459086
steps 2000    v_Prec: 0.550544  v_Recall: 0.557534  v_F1: 0.554017  v_AUC: 0.828464
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.354811    reg_loss: 0.065743    l2_loss: 0.012227    loss: 0.432782
steps 2200    v_Prec: 0.580334  v_Recall: 0.561287  v_F1: 0.570652  v_AUC: 0.838703
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.336110    reg_loss: 0.066076    l2_loss: 0.012579    loss: 0.414765
steps 2400    v_Prec: 0.606548  v_Recall: 0.572547  v_F1: 0.589057  v_AUC: 0.850836
steps 2400    running time 117 seconds

steps 2600    base_loss: 0.323903    reg_loss: 0.066402    l2_loss: 0.013023    loss: 0.403328
steps 2600    v_Prec: 0.607498  v_Recall: 0.604248  v_F1: 0.605869  v_AUC: 0.859968
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.312176    reg_loss: 0.066738    l2_loss: 0.013565    loss: 0.392480
steps 2800    v_Prec: 0.641388  v_Recall: 0.587559  v_F1: 0.613294  v_AUC: 0.867298
steps 2800    running time 131 seconds

steps 3000    base_loss: 0.304882    reg_loss: 0.066915    l2_loss: 0.014068    loss: 0.385865
steps 3000    v_Prec: 0.646166  v_Recall: 0.611595  v_F1: 0.628405  v_AUC: 0.873099
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.295693    reg_loss: 0.067090    l2_loss: 0.014541    loss: 0.377324
steps 3200    v_Prec: 0.665093  v_Recall: 0.618781  v_F1: 0.641102  v_AUC: 0.878291
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.286083    reg_loss: 0.067094    l2_loss: 0.015118    loss: 0.368295
steps 3400    v_Prec: 0.669163  v_Recall: 0.620698  v_F1: 0.644020  v_AUC: 0.880658
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.286036    reg_loss: 0.067354    l2_loss: 0.015635    loss: 0.369025
steps 3600    v_Prec: 0.657525  v_Recall: 0.639463  v_F1: 0.648369  v_AUC: 0.883579
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.285179    reg_loss: 0.067218    l2_loss: 0.016260    loss: 0.368658
steps 3800    v_Prec: 0.684615  v_Recall: 0.632516  v_F1: 0.657535  v_AUC: 0.886651
steps 3800    running time 168 seconds

steps 4000    base_loss: 0.281067    reg_loss: 0.067495    l2_loss: 0.016781    loss: 0.365344
steps 4000    v_Prec: 0.679658  v_Recall: 0.634992  v_F1: 0.656566  v_AUC: 0.888084
steps 4000    running time 175 seconds

steps 4200    base_loss: 0.278894    reg_loss: 0.067464    l2_loss: 0.017329    loss: 0.363687
steps 4200    v_Prec: 0.702954  v_Recall: 0.621337  v_F1: 0.659630  v_AUC: 0.890013
steps 4200    running time 181 seconds

steps 4400    base_loss: 0.277469    reg_loss: 0.067433    l2_loss: 0.017955    loss: 0.362857
steps 4400    v_Prec: 0.692261  v_Recall: 0.632836  v_F1: 0.661216  v_AUC: 0.891440
steps 4400    running time 188 seconds

steps 4600    base_loss: 0.273748    reg_loss: 0.067448    l2_loss: 0.018577    loss: 0.359773
steps 4600    v_Prec: 0.694662  v_Recall: 0.636030  v_F1: 0.664054  v_AUC: 0.894702
steps 4600    running time 196 seconds

steps 4800    base_loss: 0.268133    reg_loss: 0.067369    l2_loss: 0.019282    loss: 0.354784
steps 4800    v_Prec: 0.698698  v_Recall: 0.638665  v_F1: 0.667334  v_AUC: 0.895998
steps 4800    running time 204 seconds

steps 5000    base_loss: 0.270798    reg_loss: 0.067233    l2_loss: 0.019861    loss: 0.357892
steps 5000    v_Prec: 0.665897  v_Recall: 0.667492  v_F1: 0.666693  v_AUC: 0.898482
steps 5000    running time 211 seconds

steps 5200    base_loss: 0.264873    reg_loss: 0.067246    l2_loss: 0.020526    loss: 0.352645
steps 5200    v_Prec: 0.667300  v_Recall: 0.673161  v_F1: 0.670218  v_AUC: 0.899738
steps 5200    running time 218 seconds

steps 5400    base_loss: 0.260422    reg_loss: 0.067306    l2_loss: 0.021240    loss: 0.348968
steps 5400    v_Prec: 0.703622  v_Recall: 0.640581  v_F1: 0.670624  v_AUC: 0.900359
steps 5400    running time 225 seconds

steps 5600    base_loss: 0.175538    reg_loss: 0.067841    l2_loss: 0.022142    loss: 0.265521
steps 5600    v_Prec: 0.689434  v_Recall: 0.651282  v_F1: 0.669815  v_AUC: 0.898533
steps 5600    running time 232 seconds

steps 5800    base_loss: 0.186340    reg_loss: 0.067776    l2_loss: 0.023039    loss: 0.277154
steps 5800    v_Prec: 0.680259  v_Recall: 0.654076  v_F1: 0.666911  v_AUC: 0.896582
steps 5800    running time 238 seconds

steps 6000    base_loss: 0.181215    reg_loss: 0.067727    l2_loss: 0.023771    loss: 0.272714
steps 6000    v_Prec: 0.678921  v_Recall: 0.648886  v_F1: 0.663564  v_AUC: 0.895379
steps 6000    running time 245 seconds

steps 6200    base_loss: 0.181766    reg_loss: 0.067477    l2_loss: 0.024509    loss: 0.273751
steps 6200    v_Prec: 0.683008  v_Recall: 0.654156  v_F1: 0.668271  v_AUC: 0.896099
steps 6200    running time 251 seconds

steps 6400    base_loss: 0.189746    reg_loss: 0.067495    l2_loss: 0.025116    loss: 0.282357
steps 6400    v_Prec: 0.678219  v_Recall: 0.659427  v_F1: 0.668691  v_AUC: 0.896624
steps 6400    running time 258 seconds

steps 6600    base_loss: 0.184380    reg_loss: 0.067652    l2_loss: 0.025812    loss: 0.277844
steps 6600    v_Prec: 0.678955  v_Recall: 0.661822  v_F1: 0.670279  v_AUC: 0.897822
steps 6600    running time 264 seconds

steps 6800    base_loss: 0.179827    reg_loss: 0.067497    l2_loss: 0.026436    loss: 0.273760
steps 6800    v_Prec: 0.689609  v_Recall: 0.664058  v_F1: 0.676593  v_AUC: 0.899185
steps 6800    running time 271 seconds

steps 7000    base_loss: 0.194957    reg_loss: 0.067513    l2_loss: 0.026897    loss: 0.289367
steps 7000    v_Prec: 0.689658  v_Recall: 0.665096  v_F1: 0.677154  v_AUC: 0.901348
steps 7000    running time 278 seconds

steps 7200    base_loss: 0.189812    reg_loss: 0.067757    l2_loss: 0.027385    loss: 0.284954
steps 7200    v_Prec: 0.729567  v_Recall: 0.637228  v_F1: 0.680278  v_AUC: 0.901671
steps 7200    running time 285 seconds

steps 7400    base_loss: 0.190854    reg_loss: 0.067421    l2_loss: 0.027782    loss: 0.286058
steps 7400    v_Prec: 0.717540  v_Recall: 0.653997  v_F1: 0.684296  v_AUC: 0.903210
steps 7400    running time 292 seconds

steps 7600    base_loss: 0.186054    reg_loss: 0.067365    l2_loss: 0.028156    loss: 0.281576
steps 7600    v_Prec: 0.743132  v_Recall: 0.641540  v_F1: 0.688609  v_AUC: 0.905327
steps 7600    running time 299 seconds

steps 7800    base_loss: 0.182800    reg_loss: 0.067248    l2_loss: 0.028434    loss: 0.278482
steps 7800    v_Prec: 0.729821  v_Recall: 0.654875  v_F1: 0.690320  v_AUC: 0.905280
steps 7800    running time 307 seconds

steps 8000    base_loss: 0.191853    reg_loss: 0.067364    l2_loss: 0.028857    loss: 0.288074
steps 8000    v_Prec: 0.720447  v_Recall: 0.658948  v_F1: 0.688326  v_AUC: 0.905760
steps 8000    running time 314 seconds

steps 8200    base_loss: 0.183373    reg_loss: 0.067343    l2_loss: 0.029117    loss: 0.279833
steps 8200    v_Prec: 0.755968  v_Recall: 0.637228  v_F1: 0.691538  v_AUC: 0.905986
steps 8200    running time 320 seconds

steps 8400    base_loss: 0.193711    reg_loss: 0.067285    l2_loss: 0.029371    loss: 0.290367
steps 8400    v_Prec: 0.754682  v_Recall: 0.653198  v_F1: 0.700283  v_AUC: 0.909518
steps 8400    running time 328 seconds

steps 8600    base_loss: 0.180728    reg_loss: 0.067095    l2_loss: 0.029743    loss: 0.277566
steps 8600    v_Prec: 0.728511  v_Recall: 0.674758  v_F1: 0.700605  v_AUC: 0.909857
steps 8600    running time 335 seconds

steps 8800    base_loss: 0.189754    reg_loss: 0.067227    l2_loss: 0.030062    loss: 0.287043
steps 8800    v_Prec: 0.741896  v_Recall: 0.672523  v_F1: 0.705508  v_AUC: 0.911766
steps 8800    running time 342 seconds

steps 9000    base_loss: 0.184541    reg_loss: 0.067202    l2_loss: 0.030410    loss: 0.282152
steps 9000    v_Prec: 0.734738  v_Recall: 0.679470  v_F1: 0.706024  v_AUC: 0.912263
steps 9000    running time 350 seconds

steps 9200    base_loss: 0.180689    reg_loss: 0.066979    l2_loss: 0.030560    loss: 0.278227
steps 9200    v_Prec: 0.750850  v_Recall: 0.669967  v_F1: 0.708107  v_AUC: 0.912157
steps 9200    running time 357 seconds

steps 9400    base_loss: 0.184006    reg_loss: 0.066934    l2_loss: 0.030823    loss: 0.281764
steps 9400    v_Prec: 0.744366  v_Recall: 0.677793  v_F1: 0.709521  v_AUC: 0.913456
steps 9400    running time 365 seconds

steps 9600    base_loss: 0.189516    reg_loss: 0.067015    l2_loss: 0.031136    loss: 0.287666
steps 9600    v_Prec: 0.739500  v_Recall: 0.680508  v_F1: 0.708779  v_AUC: 0.914184
steps 9600    running time 372 seconds

steps 9800    base_loss: 0.187383    reg_loss: 0.066850    l2_loss: 0.031345    loss: 0.285578
steps 9800    v_Prec: 0.719841  v_Recall: 0.696159  v_F1: 0.707802  v_AUC: 0.915236
steps 9800    running time 379 seconds

steps 10000    base_loss: 0.195014    reg_loss: 0.066723    l2_loss: 0.031517    loss: 0.293255
steps 10000    v_Prec: 0.763874  v_Recall: 0.668290  v_F1: 0.712892  v_AUC: 0.917369
steps 10000    running time 385 seconds

steps 10200    base_loss: 0.183447    reg_loss: 0.066709    l2_loss: 0.031774    loss: 0.281930
steps 10200    v_Prec: 0.757214  v_Recall: 0.683143  v_F1: 0.718274  v_AUC: 0.919316
steps 10200    running time 392 seconds

steps 10400    base_loss: 0.187490    reg_loss: 0.066692    l2_loss: 0.031938    loss: 0.286120
steps 10400    v_Prec: 0.771491  v_Recall: 0.675078  v_F1: 0.720072  v_AUC: 0.920597
steps 10400    running time 399 seconds

steps 10600    base_loss: 0.182880    reg_loss: 0.066749    l2_loss: 0.031993    loss: 0.281622
steps 10600    v_Prec: 0.758972  v_Recall: 0.690729  v_F1: 0.723244  v_AUC: 0.921331
steps 10600    running time 406 seconds

steps 10800    base_loss: 0.180230    reg_loss: 0.066581    l2_loss: 0.032029    loss: 0.278840
steps 10800    v_Prec: 0.760485  v_Recall: 0.686337  v_F1: 0.721511  v_AUC: 0.921981
steps 10800    running time 413 seconds

steps 11000    base_loss: 0.079193    reg_loss: 0.065821    l2_loss: 0.032425    loss: 0.177440
steps 11000    v_Prec: 0.746878  v_Recall: 0.687774  v_F1: 0.716109  v_AUC: 0.917868
steps 11000    running time 420 seconds

steps 11200    base_loss: 0.079159    reg_loss: 0.065635    l2_loss: 0.032474    loss: 0.177267
steps 11200    v_Prec: 0.718419  v_Recall: 0.697996  v_F1: 0.708060  v_AUC: 0.913665
steps 11200    running time 426 seconds

steps 11400    base_loss: 0.076009    reg_loss: 0.065399    l2_loss: 0.032644    loss: 0.174052
steps 11400    v_Prec: 0.746196  v_Recall: 0.669568  v_F1: 0.705808  v_AUC: 0.912049
steps 11400    running time 432 seconds

steps 11600    base_loss: 0.076841    reg_loss: 0.065387    l2_loss: 0.032749    loss: 0.174977
steps 11600    v_Prec: 0.725609  v_Recall: 0.671085  v_F1: 0.697283  v_AUC: 0.907650
steps 11600    running time 439 seconds

steps 11800    base_loss: 0.082572    reg_loss: 0.065345    l2_loss: 0.032749    loss: 0.180667
steps 11800    v_Prec: 0.709653  v_Recall: 0.681546  v_F1: 0.695316  v_AUC: 0.905738
steps 11800    running time 445 seconds

steps 12000    base_loss: 0.088723    reg_loss: 0.065792    l2_loss: 0.032943    loss: 0.187459
steps 12000    v_Prec: 0.721797  v_Recall: 0.669808  v_F1: 0.694831  v_AUC: 0.905161
steps 12000    running time 452 seconds

steps 12200    base_loss: 0.081210    reg_loss: 0.065237    l2_loss: 0.033014    loss: 0.179461
steps 12200    v_Prec: 0.735675  v_Recall: 0.662301  v_F1: 0.697063  v_AUC: 0.905300
steps 12200    running time 458 seconds

steps 12400    base_loss: 0.085986    reg_loss: 0.065246    l2_loss: 0.033076    loss: 0.184308
steps 12400    v_Prec: 0.692197  v_Recall: 0.691368  v_F1: 0.691782  v_AUC: 0.904689
steps 12400    running time 465 seconds

steps 12600    base_loss: 0.086813    reg_loss: 0.065355    l2_loss: 0.033257    loss: 0.185425
steps 12600    v_Prec: 0.703710  v_Recall: 0.680109  v_F1: 0.691708  v_AUC: 0.904046
steps 12600    running time 471 seconds

Early stop model F1: 0.723244
testing thre: 0.39902985
testing Prec: 0.5543849555931106
testing Recall: 0.7493560145808019
testing F1: 0.6372917786136485
testing AUC: 0.9010704384429489
overall running time 474 seconds
(0.7073746312684366, 0.6410206561360875, 0.6725650178480367, 0.9010704384429489, 0.65937954)

2019-02-24 02:13:41.743685: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:13:42.310120: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:13:42.311011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:13:42.311043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 22.640000 seconds
loading data in 28.740000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.665706    reg_loss: 0.064782    l2_loss: 0.013267    loss: 0.743755
steps 200    v_Prec: 0.164494  v_Recall: 1.000000  v_F1: 0.282516  v_AUC: 0.513759
steps 200    running time 39 seconds

steps 400    base_loss: 0.523598    reg_loss: 0.064623    l2_loss: 0.013094    loss: 0.601315
steps 400    v_Prec: 0.164593  v_Recall: 0.996033  v_F1: 0.282503  v_AUC: 0.533489
steps 400    running time 46 seconds

steps 600    base_loss: 0.477696    reg_loss: 0.064566    l2_loss: 0.012937    loss: 0.555199
steps 600    v_Prec: 0.184439  v_Recall: 0.740024  v_F1: 0.295283  v_AUC: 0.579574
steps 600    running time 53 seconds

steps 800    base_loss: 0.466637    reg_loss: 0.064419    l2_loss: 0.012783    loss: 0.543839
steps 800    v_Prec: 0.246217  v_Recall: 0.472511  v_F1: 0.323740  v_AUC: 0.635328
steps 800    running time 60 seconds

steps 1000    base_loss: 0.451118    reg_loss: 0.064272    l2_loss: 0.012625    loss: 0.528014
steps 1000    v_Prec: 0.335506  v_Recall: 0.396192  v_F1: 0.363332  v_AUC: 0.679849
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.450924    reg_loss: 0.064494    l2_loss: 0.012559    loss: 0.527977
steps 1200    v_Prec: 0.414280  v_Recall: 0.444189  v_F1: 0.428714  v_AUC: 0.736933
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.419207    reg_loss: 0.064168    l2_loss: 0.012536    loss: 0.495912
steps 1400    v_Prec: 0.502322  v_Recall: 0.454899  v_F1: 0.477435  v_AUC: 0.775729
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.387884    reg_loss: 0.064225    l2_loss: 0.012559    loss: 0.464667
steps 1600    v_Prec: 0.482754  v_Recall: 0.561841  v_F1: 0.519303  v_AUC: 0.805058
steps 1600    running time 90 seconds

steps 1800    base_loss: 0.360476    reg_loss: 0.064751    l2_loss: 0.012715    loss: 0.437942
steps 1800    v_Prec: 0.538949  v_Recall: 0.566997  v_F1: 0.552617  v_AUC: 0.826565
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.340584    reg_loss: 0.065288    l2_loss: 0.012879    loss: 0.418751
steps 2000    v_Prec: 0.587917  v_Recall: 0.568187  v_F1: 0.577884  v_AUC: 0.840060
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.330970    reg_loss: 0.065714    l2_loss: 0.013202    loss: 0.409885
steps 2200    v_Prec: 0.633179  v_Recall: 0.565014  v_F1: 0.597158  v_AUC: 0.851966
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.312858    reg_loss: 0.066158    l2_loss: 0.013515    loss: 0.392531
steps 2400    v_Prec: 0.605837  v_Recall: 0.611027  v_F1: 0.608421  v_AUC: 0.858908
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.309837    reg_loss: 0.066450    l2_loss: 0.013804    loss: 0.390092
steps 2600    v_Prec: 0.646533  v_Recall: 0.596985  v_F1: 0.620772  v_AUC: 0.865267
steps 2600    running time 125 seconds

steps 2800    base_loss: 0.300114    reg_loss: 0.066911    l2_loss: 0.014138    loss: 0.381163
steps 2800    v_Prec: 0.643866  v_Recall: 0.614597  v_F1: 0.628892  v_AUC: 0.870656
steps 2800    running time 132 seconds

steps 3000    base_loss: 0.302303    reg_loss: 0.067054    l2_loss: 0.014480    loss: 0.383837
steps 3000    v_Prec: 0.698797  v_Recall: 0.585482  v_F1: 0.637141  v_AUC: 0.874607
steps 3000    running time 139 seconds

steps 3200    base_loss: 0.299110    reg_loss: 0.067330    l2_loss: 0.014906    loss: 0.381345
steps 3200    v_Prec: 0.690138  v_Recall: 0.605712  v_F1: 0.645175  v_AUC: 0.879305
steps 3200    running time 146 seconds

steps 3400    base_loss: 0.293656    reg_loss: 0.067476    l2_loss: 0.015244    loss: 0.376375
steps 3400    v_Prec: 0.667925  v_Recall: 0.631575  v_F1: 0.649242  v_AUC: 0.882962
steps 3400    running time 153 seconds

steps 3600    base_loss: 0.281219    reg_loss: 0.067193    l2_loss: 0.015649    loss: 0.364061
steps 3600    v_Prec: 0.695753  v_Recall: 0.616105  v_F1: 0.653511  v_AUC: 0.885698
steps 3600    running time 160 seconds

steps 3800    base_loss: 0.282627    reg_loss: 0.067381    l2_loss: 0.016106    loss: 0.366114
steps 3800    v_Prec: 0.658343  v_Recall: 0.652598  v_F1: 0.655458  v_AUC: 0.888910
steps 3800    running time 167 seconds

steps 4000    base_loss: 0.287681    reg_loss: 0.067725    l2_loss: 0.016530    loss: 0.371936
steps 4000    v_Prec: 0.668833  v_Recall: 0.645061  v_F1: 0.656732  v_AUC: 0.891117
steps 4000    running time 174 seconds

steps 4200    base_loss: 0.282990    reg_loss: 0.067583    l2_loss: 0.017012    loss: 0.367584
steps 4200    v_Prec: 0.692737  v_Recall: 0.630305  v_F1: 0.660048  v_AUC: 0.893821
steps 4200    running time 182 seconds

steps 4400    base_loss: 0.275357    reg_loss: 0.067424    l2_loss: 0.017501    loss: 0.360283
steps 4400    v_Prec: 0.690670  v_Recall: 0.646013  v_F1: 0.667596  v_AUC: 0.896303
steps 4400    running time 189 seconds

steps 4600    base_loss: 0.276962    reg_loss: 0.067662    l2_loss: 0.018071    loss: 0.362694
steps 4600    v_Prec: 0.707145  v_Recall: 0.635224  v_F1: 0.669258  v_AUC: 0.898657
steps 4600    running time 196 seconds

steps 4800    base_loss: 0.267918    reg_loss: 0.067380    l2_loss: 0.018671    loss: 0.353969
steps 4800    v_Prec: 0.697249  v_Recall: 0.647521  v_F1: 0.671466  v_AUC: 0.898878
steps 4800    running time 204 seconds

steps 5000    base_loss: 0.273187    reg_loss: 0.067358    l2_loss: 0.019246    loss: 0.359791
steps 5000    v_Prec: 0.713117  v_Recall: 0.636176  v_F1: 0.672453  v_AUC: 0.900976
steps 5000    running time 211 seconds

steps 5200    base_loss: 0.269545    reg_loss: 0.067500    l2_loss: 0.019866    loss: 0.356911
steps 5200    v_Prec: 0.710480  v_Recall: 0.638953  v_F1: 0.672821  v_AUC: 0.901449
steps 5200    running time 218 seconds

steps 5400    base_loss: 0.267348    reg_loss: 0.067669    l2_loss: 0.020599    loss: 0.355616
steps 5400    v_Prec: 0.678225  v_Recall: 0.671876  v_F1: 0.675036  v_AUC: 0.902293
steps 5400    running time 225 seconds

steps 5600    base_loss: 0.180212    reg_loss: 0.068457    l2_loss: 0.021362    loss: 0.270031
steps 5600    v_Prec: 0.698792  v_Recall: 0.637921  v_F1: 0.666971  v_AUC: 0.898677
steps 5600    running time 233 seconds

steps 5800    base_loss: 0.168491    reg_loss: 0.068439    l2_loss: 0.022329    loss: 0.259258
steps 5800    v_Prec: 0.706929  v_Recall: 0.624038  v_F1: 0.662902  v_AUC: 0.896794
steps 5800    running time 239 seconds

steps 6000    base_loss: 0.178555    reg_loss: 0.068225    l2_loss: 0.023061    loss: 0.269841
steps 6000    v_Prec: 0.677427  v_Recall: 0.642602  v_F1: 0.659555  v_AUC: 0.894470
steps 6000    running time 245 seconds

steps 6200    base_loss: 0.184122    reg_loss: 0.067968    l2_loss: 0.023794    loss: 0.275884
steps 6200    v_Prec: 0.684135  v_Recall: 0.640063  v_F1: 0.661366  v_AUC: 0.895060
steps 6200    running time 252 seconds

steps 6400    base_loss: 0.186301    reg_loss: 0.068203    l2_loss: 0.024392    loss: 0.278896
steps 6400    v_Prec: 0.678456  v_Recall: 0.651329  v_F1: 0.664616  v_AUC: 0.895400
steps 6400    running time 258 seconds

steps 6600    base_loss: 0.181780    reg_loss: 0.067969    l2_loss: 0.024959    loss: 0.274708
steps 6600    v_Prec: 0.689936  v_Recall: 0.644506  v_F1: 0.666448  v_AUC: 0.896370
steps 6600    running time 264 seconds

steps 6800    base_loss: 0.188538    reg_loss: 0.068288    l2_loss: 0.025443    loss: 0.282269
steps 6800    v_Prec: 0.708110  v_Recall: 0.640698  v_F1: 0.672720  v_AUC: 0.898033
steps 6800    running time 271 seconds

steps 7000    base_loss: 0.192499    reg_loss: 0.068467    l2_loss: 0.025892    loss: 0.286858
steps 7000    v_Prec: 0.692288  v_Recall: 0.654502  v_F1: 0.672865  v_AUC: 0.898883
steps 7000    running time 278 seconds

steps 7200    base_loss: 0.200991    reg_loss: 0.068234    l2_loss: 0.026392    loss: 0.295617
steps 7200    v_Prec: 0.701481  v_Recall: 0.657517  v_F1: 0.678788  v_AUC: 0.900928
steps 7200    running time 285 seconds

steps 7400    base_loss: 0.194986    reg_loss: 0.068297    l2_loss: 0.026755    loss: 0.290039
steps 7400    v_Prec: 0.703549  v_Recall: 0.655772  v_F1: 0.678821  v_AUC: 0.901437
steps 7400    running time 292 seconds

steps 7600    base_loss: 0.196734    reg_loss: 0.068226    l2_loss: 0.027195    loss: 0.292155
steps 7600    v_Prec: 0.699311  v_Recall: 0.660532  v_F1: 0.679368  v_AUC: 0.903188
steps 7600    running time 300 seconds

steps 7800    base_loss: 0.187908    reg_loss: 0.068072    l2_loss: 0.027569    loss: 0.283549
steps 7800    v_Prec: 0.701103  v_Recall: 0.665450  v_F1: 0.682812  v_AUC: 0.902998
steps 7800    running time 307 seconds

steps 8000    base_loss: 0.190798    reg_loss: 0.067925    l2_loss: 0.027978    loss: 0.286701
steps 8000    v_Prec: 0.711132  v_Recall: 0.664419  v_F1: 0.686982  v_AUC: 0.904924
steps 8000    running time 314 seconds

steps 8200    base_loss: 0.179858    reg_loss: 0.067929    l2_loss: 0.028273    loss: 0.276060
steps 8200    v_Prec: 0.716415  v_Recall: 0.655772  v_F1: 0.684753  v_AUC: 0.903599
steps 8200    running time 321 seconds

steps 8400    base_loss: 0.198396    reg_loss: 0.068389    l2_loss: 0.028683    loss: 0.295468
steps 8400    v_Prec: 0.713814  v_Recall: 0.668624  v_F1: 0.690480  v_AUC: 0.907268
steps 8400    running time 327 seconds

steps 8600    base_loss: 0.203532    reg_loss: 0.068031    l2_loss: 0.028930    loss: 0.300493
steps 8600    v_Prec: 0.734798  v_Recall: 0.660532  v_F1: 0.695689  v_AUC: 0.909761
steps 8600    running time 334 seconds

steps 8800    base_loss: 0.193790    reg_loss: 0.068025    l2_loss: 0.029189    loss: 0.291003
steps 8800    v_Prec: 0.709348  v_Recall: 0.683856  v_F1: 0.696369  v_AUC: 0.909435
steps 8800    running time 341 seconds

steps 9000    base_loss: 0.191415    reg_loss: 0.067765    l2_loss: 0.029496    loss: 0.288677
steps 9000    v_Prec: 0.719778  v_Recall: 0.680206  v_F1: 0.699433  v_AUC: 0.910905
steps 9000    running time 348 seconds

steps 9200    base_loss: 0.183972    reg_loss: 0.067917    l2_loss: 0.029736    loss: 0.281626
steps 9200    v_Prec: 0.740905  v_Recall: 0.664022  v_F1: 0.700360  v_AUC: 0.911794
steps 9200    running time 356 seconds

steps 9400    base_loss: 0.184173    reg_loss: 0.067769    l2_loss: 0.029902    loss: 0.281844
steps 9400    v_Prec: 0.729184  v_Recall: 0.682269  v_F1: 0.704947  v_AUC: 0.914491
steps 9400    running time 363 seconds

steps 9600    base_loss: 0.181434    reg_loss: 0.067919    l2_loss: 0.030212    loss: 0.279565
steps 9600    v_Prec: 0.763585  v_Recall: 0.661087  v_F1: 0.708649  v_AUC: 0.913682
steps 9600    running time 370 seconds

steps 9800    base_loss: 0.187328    reg_loss: 0.067730    l2_loss: 0.030493    loss: 0.285551
steps 9800    v_Prec: 0.751609  v_Recall: 0.676240  v_F1: 0.711935  v_AUC: 0.914669
steps 9800    running time 377 seconds

steps 10000    base_loss: 0.191534    reg_loss: 0.067602    l2_loss: 0.030666    loss: 0.289801
steps 10000    v_Prec: 0.733880  v_Recall: 0.696152  v_F1: 0.714518  v_AUC: 0.917030
steps 10000    running time 384 seconds

steps 10200    base_loss: 0.188115    reg_loss: 0.067607    l2_loss: 0.030845    loss: 0.286567
steps 10200    v_Prec: 0.751598  v_Recall: 0.680762  v_F1: 0.714428  v_AUC: 0.916809
steps 10200    running time 391 seconds

steps 10400    base_loss: 0.188890    reg_loss: 0.067432    l2_loss: 0.031033    loss: 0.287354
steps 10400    v_Prec: 0.741732  v_Recall: 0.690361  v_F1: 0.715125  v_AUC: 0.918200
steps 10400    running time 398 seconds

steps 10600    base_loss: 0.179513    reg_loss: 0.067418    l2_loss: 0.031253    loss: 0.278183
steps 10600    v_Prec: 0.749806  v_Recall: 0.688298  v_F1: 0.717737  v_AUC: 0.920006
steps 10600    running time 405 seconds

steps 10800    base_loss: 0.176081    reg_loss: 0.067769    l2_loss: 0.031481    loss: 0.275331
steps 10800    v_Prec: 0.757243  v_Recall: 0.684252  v_F1: 0.718900  v_AUC: 0.918946
steps 10800    running time 413 seconds

steps 11000    base_loss: 0.073391    reg_loss: 0.067053    l2_loss: 0.031606    loss: 0.172049
steps 11000    v_Prec: 0.753312  v_Recall: 0.663070  v_F1: 0.705316  v_AUC: 0.912836
steps 11000    running time 419 seconds

steps 11200    base_loss: 0.077289    reg_loss: 0.067189    l2_loss: 0.031544    loss: 0.176022
steps 11200    v_Prec: 0.744903  v_Recall: 0.663705  v_F1: 0.701963  v_AUC: 0.909674
steps 11200    running time 426 seconds

steps 11400    base_loss: 0.074184    reg_loss: 0.066805    l2_loss: 0.031781    loss: 0.172770
steps 11400    v_Prec: 0.728300  v_Recall: 0.664974  v_F1: 0.695198  v_AUC: 0.907525
steps 11400    running time 432 seconds

steps 11600    base_loss: 0.077506    reg_loss: 0.066784    l2_loss: 0.031834    loss: 0.176124
steps 11600    v_Prec: 0.729694  v_Recall: 0.656406  v_F1: 0.691113  v_AUC: 0.904585
steps 11600    running time 439 seconds

steps 11800    base_loss: 0.078395    reg_loss: 0.066846    l2_loss: 0.031864    loss: 0.177104
steps 11800    v_Prec: 0.715385  v_Recall: 0.664022  v_F1: 0.688747  v_AUC: 0.903166
steps 11800    running time 445 seconds

steps 12000    base_loss: 0.085181    reg_loss: 0.066609    l2_loss: 0.032047    loss: 0.183838
steps 12000    v_Prec: 0.699711  v_Recall: 0.671956  v_F1: 0.685552  v_AUC: 0.903413
steps 12000    running time 452 seconds

steps 12200    base_loss: 0.080599    reg_loss: 0.066720    l2_loss: 0.032119    loss: 0.179438
steps 12200    v_Prec: 0.716757  v_Recall: 0.660690  v_F1: 0.687583  v_AUC: 0.902435
steps 12200    running time 458 seconds

steps 12400    base_loss: 0.081917    reg_loss: 0.066428    l2_loss: 0.032201    loss: 0.180546
steps 12400    v_Prec: 0.721984  v_Recall: 0.654740  v_F1: 0.686720  v_AUC: 0.901459
steps 12400    running time 464 seconds

steps 12600    base_loss: 0.083809    reg_loss: 0.066505    l2_loss: 0.032339    loss: 0.182653
steps 12600    v_Prec: 0.699146  v_Recall: 0.675684  v_F1: 0.687215  v_AUC: 0.900705
steps 12600    running time 471 seconds

steps 12800    base_loss: 0.086962    reg_loss: 0.066469    l2_loss: 0.032494    loss: 0.185926
steps 12800    v_Prec: 0.706396  v_Recall: 0.667672  v_F1: 0.686488  v_AUC: 0.901936
steps 12800    running time 477 seconds

Early stop model F1: 0.718900
testing thre: 0.49416402
testing Prec: 0.5525130737943056
testing Recall: 0.7394410692588093
testing F1: 0.6324541165222091
testing AUC: 0.8967582412079134
overall running time 480 seconds
(0.686605504587156, 0.6365492102065614, 0.6606305170239597, 0.8967582412079134, 0.7493273)

2019-02-24 02:19:31.541195: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:19:32.376916: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:19:32.382134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:19:32.382194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 25.280000 seconds
loading data in 31.400000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.045718    reg_loss: 0.064862    l2_loss: 0.013267    loss: 1.123847
steps 200    v_Prec: 0.166542  v_Recall: 0.919214  v_F1: 0.281992  v_AUC: 0.520974
steps 200    running time 42 seconds

steps 400    base_loss: 0.713936    reg_loss: 0.064662    l2_loss: 0.013057    loss: 0.791655
steps 400    v_Prec: 0.165017  v_Recall: 0.991086  v_F1: 0.282926  v_AUC: 0.540016
steps 400    running time 49 seconds

steps 600    base_loss: 0.510379    reg_loss: 0.064301    l2_loss: 0.012839    loss: 0.587519
steps 600    v_Prec: 0.176690  v_Recall: 0.766794  v_F1: 0.287201  v_AUC: 0.558764
steps 600    running time 57 seconds

steps 800    base_loss: 0.482823    reg_loss: 0.063926    l2_loss: 0.012733    loss: 0.559482
steps 800    v_Prec: 0.205396  v_Recall: 0.581105  v_F1: 0.303513  v_AUC: 0.598388
steps 800    running time 64 seconds

steps 1000    base_loss: 0.466912    reg_loss: 0.063495    l2_loss: 0.012606    loss: 0.543013
steps 1000    v_Prec: 0.251809  v_Recall: 0.470790  v_F1: 0.328119  v_AUC: 0.632252
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.443888    reg_loss: 0.063160    l2_loss: 0.012528    loss: 0.519576
steps 1200    v_Prec: 0.309429  v_Recall: 0.486628  v_F1: 0.378306  v_AUC: 0.688993
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.431269    reg_loss: 0.062850    l2_loss: 0.012480    loss: 0.506600
steps 1400    v_Prec: 0.373184  v_Recall: 0.464104  v_F1: 0.413707  v_AUC: 0.720548
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.408481    reg_loss: 0.062505    l2_loss: 0.012533    loss: 0.483519
steps 1600    v_Prec: 0.413840  v_Recall: 0.487424  v_F1: 0.447628  v_AUC: 0.749585
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.396564    reg_loss: 0.062319    l2_loss: 0.012660    loss: 0.471543
steps 1800    v_Prec: 0.462989  v_Recall: 0.466969  v_F1: 0.464971  v_AUC: 0.766248
steps 1800    running time 101 seconds

steps 2000    base_loss: 0.380530    reg_loss: 0.062158    l2_loss: 0.012791    loss: 0.455480
steps 2000    v_Prec: 0.485360  v_Recall: 0.514565  v_F1: 0.499536  v_AUC: 0.786663
steps 2000    running time 108 seconds

steps 2200    base_loss: 0.364953    reg_loss: 0.062152    l2_loss: 0.012953    loss: 0.440058
steps 2200    v_Prec: 0.539439  v_Recall: 0.510029  v_F1: 0.524322  v_AUC: 0.801746
steps 2200    running time 116 seconds

steps 2400    base_loss: 0.355471    reg_loss: 0.062323    l2_loss: 0.013156    loss: 0.430949
steps 2400    v_Prec: 0.536990  v_Recall: 0.538443  v_F1: 0.537716  v_AUC: 0.815891
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.349534    reg_loss: 0.062577    l2_loss: 0.013372    loss: 0.425483
steps 2600    v_Prec: 0.556097  v_Recall: 0.544811  v_F1: 0.550396  v_AUC: 0.826500
steps 2600    running time 130 seconds

steps 2800    base_loss: 0.343004    reg_loss: 0.063017    l2_loss: 0.013534    loss: 0.419555
steps 2800    v_Prec: 0.520104  v_Recall: 0.606415  v_F1: 0.559953  v_AUC: 0.834993
steps 2800    running time 137 seconds

steps 3000    base_loss: 0.337363    reg_loss: 0.063773    l2_loss: 0.013824    loss: 0.414961
steps 3000    v_Prec: 0.545448  v_Recall: 0.604664  v_F1: 0.573532  v_AUC: 0.846516
steps 3000    running time 144 seconds

steps 3200    base_loss: 0.334047    reg_loss: 0.064425    l2_loss: 0.014071    loss: 0.412542
steps 3200    v_Prec: 0.565488  v_Recall: 0.615807  v_F1: 0.589576  v_AUC: 0.857054
steps 3200    running time 151 seconds

steps 3400    base_loss: 0.322517    reg_loss: 0.065290    l2_loss: 0.014414    loss: 0.402221
steps 3400    v_Prec: 0.569568  v_Recall: 0.626552  v_F1: 0.596703  v_AUC: 0.863377
steps 3400    running time 158 seconds

steps 3600    base_loss: 0.311725    reg_loss: 0.066065    l2_loss: 0.014838    loss: 0.392628
steps 3600    v_Prec: 0.586915  v_Recall: 0.632601  v_F1: 0.608902  v_AUC: 0.870048
steps 3600    running time 166 seconds

steps 3800    base_loss: 0.304127    reg_loss: 0.066604    l2_loss: 0.015286    loss: 0.386017
steps 3800    v_Prec: 0.585422  v_Recall: 0.650748  v_F1: 0.616359  v_AUC: 0.874296
steps 3800    running time 173 seconds

steps 4000    base_loss: 0.295024    reg_loss: 0.066818    l2_loss: 0.015816    loss: 0.377657
steps 4000    v_Prec: 0.607858  v_Recall: 0.637854  v_F1: 0.622495  v_AUC: 0.877303
steps 4000    running time 180 seconds

steps 4200    base_loss: 0.298670    reg_loss: 0.067302    l2_loss: 0.016433    loss: 0.382405
steps 4200    v_Prec: 0.646207  v_Recall: 0.621777  v_F1: 0.633757  v_AUC: 0.882200
steps 4200    running time 187 seconds

steps 4400    base_loss: 0.300073    reg_loss: 0.067746    l2_loss: 0.017106    loss: 0.384924
steps 4400    v_Prec: 0.649927  v_Recall: 0.639685  v_F1: 0.644765  v_AUC: 0.886842
steps 4400    running time 195 seconds

steps 4600    base_loss: 0.286136    reg_loss: 0.067819    l2_loss: 0.017881    loss: 0.371837
steps 4600    v_Prec: 0.659551  v_Recall: 0.629577  v_F1: 0.644215  v_AUC: 0.889644
steps 4600    running time 202 seconds

steps 4800    base_loss: 0.287332    reg_loss: 0.067785    l2_loss: 0.018483    loss: 0.373600
steps 4800    v_Prec: 0.666751  v_Recall: 0.628223  v_F1: 0.646914  v_AUC: 0.890133
steps 4800    running time 209 seconds

steps 5000    base_loss: 0.280245    reg_loss: 0.068084    l2_loss: 0.019263    loss: 0.367592
steps 5000    v_Prec: 0.676622  v_Recall: 0.627507  v_F1: 0.651140  v_AUC: 0.890968
steps 5000    running time 216 seconds

steps 5200    base_loss: 0.277518    reg_loss: 0.067959    l2_loss: 0.020028    loss: 0.365505
steps 5200    v_Prec: 0.691808  v_Recall: 0.627109  v_F1: 0.657872  v_AUC: 0.894152
steps 5200    running time 223 seconds

steps 5400    base_loss: 0.277122    reg_loss: 0.068053    l2_loss: 0.020702    loss: 0.365876
steps 5400    v_Prec: 0.692996  v_Recall: 0.634750  v_F1: 0.662596  v_AUC: 0.896338
steps 5400    running time 231 seconds

steps 5600    base_loss: 0.203562    reg_loss: 0.069583    l2_loss: 0.021608    loss: 0.294752
steps 5600    v_Prec: 0.670961  v_Recall: 0.634273  v_F1: 0.652101  v_AUC: 0.890063
steps 5600    running time 238 seconds

steps 5800    base_loss: 0.189881    reg_loss: 0.069166    l2_loss: 0.022384    loss: 0.281432
steps 5800    v_Prec: 0.672714  v_Recall: 0.640481  v_F1: 0.656202  v_AUC: 0.889835
steps 5800    running time 244 seconds

steps 6000    base_loss: 0.198141    reg_loss: 0.069094    l2_loss: 0.023163    loss: 0.290398
steps 6000    v_Prec: 0.659315  v_Recall: 0.649554  v_F1: 0.654398  v_AUC: 0.889914
steps 6000    running time 251 seconds

steps 6200    base_loss: 0.199187    reg_loss: 0.068790    l2_loss: 0.023794    loss: 0.291771
steps 6200    v_Prec: 0.651801  v_Recall: 0.652579  v_F1: 0.652189  v_AUC: 0.889678
steps 6200    running time 257 seconds

steps 6400    base_loss: 0.200158    reg_loss: 0.068804    l2_loss: 0.024361    loss: 0.293324
steps 6400    v_Prec: 0.659283  v_Recall: 0.651465  v_F1: 0.655350  v_AUC: 0.890387
steps 6400    running time 264 seconds

steps 6600    base_loss: 0.208549    reg_loss: 0.069142    l2_loss: 0.024974    loss: 0.302665
steps 6600    v_Prec: 0.674048  v_Recall: 0.646848  v_F1: 0.660168  v_AUC: 0.893453
steps 6600    running time 270 seconds

steps 6800    base_loss: 0.203097    reg_loss: 0.068890    l2_loss: 0.025502    loss: 0.297489
steps 6800    v_Prec: 0.670211  v_Recall: 0.657195  v_F1: 0.663639  v_AUC: 0.894326
steps 6800    running time 277 seconds

steps 7000    base_loss: 0.206373    reg_loss: 0.068706    l2_loss: 0.025968    loss: 0.301047
steps 7000    v_Prec: 0.688483  v_Recall: 0.651385  v_F1: 0.669420  v_AUC: 0.896289
steps 7000    running time 284 seconds

steps 7200    base_loss: 0.202430    reg_loss: 0.068512    l2_loss: 0.026444    loss: 0.297386
steps 7200    v_Prec: 0.687080  v_Recall: 0.659026  v_F1: 0.672761  v_AUC: 0.897166
steps 7200    running time 291 seconds

steps 7400    base_loss: 0.210639    reg_loss: 0.068695    l2_loss: 0.026645    loss: 0.305978
steps 7400    v_Prec: 0.685574  v_Recall: 0.657036  v_F1: 0.671002  v_AUC: 0.895846
steps 7400    running time 299 seconds

steps 7600    base_loss: 0.202656    reg_loss: 0.068593    l2_loss: 0.027077    loss: 0.298326
steps 7600    v_Prec: 0.704653  v_Recall: 0.654569  v_F1: 0.678688  v_AUC: 0.899125
steps 7600    running time 305 seconds

steps 7800    base_loss: 0.208925    reg_loss: 0.068450    l2_loss: 0.027502    loss: 0.304877
steps 7800    v_Prec: 0.698375  v_Recall: 0.660299  v_F1: 0.678804  v_AUC: 0.901121
steps 7800    running time 313 seconds

steps 8000    base_loss: 0.205973    reg_loss: 0.068547    l2_loss: 0.027732    loss: 0.302252
steps 8000    v_Prec: 0.700988  v_Recall: 0.671920  v_F1: 0.686146  v_AUC: 0.902556
steps 8000    running time 320 seconds

steps 8200    base_loss: 0.189883    reg_loss: 0.068485    l2_loss: 0.028130    loss: 0.286497
steps 8200    v_Prec: 0.686627  v_Recall: 0.684495  v_F1: 0.685559  v_AUC: 0.904184
steps 8200    running time 327 seconds

steps 8400    base_loss: 0.198302    reg_loss: 0.068624    l2_loss: 0.028508    loss: 0.295434
steps 8400    v_Prec: 0.718051  v_Recall: 0.659185  v_F1: 0.687360  v_AUC: 0.904468
steps 8400    running time 334 seconds

steps 8600    base_loss: 0.203518    reg_loss: 0.068513    l2_loss: 0.028741    loss: 0.300771
steps 8600    v_Prec: 0.708466  v_Recall: 0.671363  v_F1: 0.689416  v_AUC: 0.905764
steps 8600    running time 341 seconds

steps 8800    base_loss: 0.213920    reg_loss: 0.068617    l2_loss: 0.029092    loss: 0.311629
steps 8800    v_Prec: 0.714009  v_Recall: 0.675024  v_F1: 0.693969  v_AUC: 0.907275
steps 8800    running time 348 seconds

steps 9000    base_loss: 0.206815    reg_loss: 0.068483    l2_loss: 0.029344    loss: 0.304643
steps 9000    v_Prec: 0.697742  v_Recall: 0.688634  v_F1: 0.693158  v_AUC: 0.908382
steps 9000    running time 355 seconds

steps 9200    base_loss: 0.199107    reg_loss: 0.068491    l2_loss: 0.029506    loss: 0.297104
steps 9200    v_Prec: 0.725780  v_Recall: 0.661254  v_F1: 0.692016  v_AUC: 0.908596
steps 9200    running time 362 seconds

steps 9400    base_loss: 0.192742    reg_loss: 0.068106    l2_loss: 0.029663    loss: 0.290511
steps 9400    v_Prec: 0.733503  v_Recall: 0.664438  v_F1: 0.697265  v_AUC: 0.911054
steps 9400    running time 368 seconds

steps 9600    base_loss: 0.200904    reg_loss: 0.068155    l2_loss: 0.029938    loss: 0.298997
steps 9600    v_Prec: 0.732271  v_Recall: 0.673114  v_F1: 0.701447  v_AUC: 0.911090
steps 9600    running time 375 seconds

steps 9800    base_loss: 0.200689    reg_loss: 0.068292    l2_loss: 0.030127    loss: 0.299108
steps 9800    v_Prec: 0.713873  v_Recall: 0.688475  v_F1: 0.700944  v_AUC: 0.912763
steps 9800    running time 382 seconds

steps 10000    base_loss: 0.201493    reg_loss: 0.068314    l2_loss: 0.030503    loss: 0.300311
steps 10000    v_Prec: 0.737545  v_Recall: 0.681073  v_F1: 0.708185  v_AUC: 0.914271
steps 10000    running time 389 seconds

steps 10200    base_loss: 0.205304    reg_loss: 0.068153    l2_loss: 0.030638    loss: 0.304095
steps 10200    v_Prec: 0.725072  v_Recall: 0.698583  v_F1: 0.711581  v_AUC: 0.916535
steps 10200    running time 396 seconds

steps 10400    base_loss: 0.195819    reg_loss: 0.068051    l2_loss: 0.030785    loss: 0.294654
steps 10400    v_Prec: 0.774609  v_Recall: 0.661414  v_F1: 0.713550  v_AUC: 0.917658
steps 10400    running time 403 seconds

steps 10600    base_loss: 0.192916    reg_loss: 0.068146    l2_loss: 0.031137    loss: 0.292200
steps 10600    v_Prec: 0.743555  v_Recall: 0.690942  v_F1: 0.716284  v_AUC: 0.920631
steps 10600    running time 410 seconds

steps 10800    base_loss: 0.186145    reg_loss: 0.068337    l2_loss: 0.031249    loss: 0.285731
steps 10800    v_Prec: 0.733505  v_Recall: 0.704314  v_F1: 0.718613  v_AUC: 0.919049
steps 10800    running time 418 seconds

steps 11000    base_loss: 0.089792    reg_loss: 0.068044    l2_loss: 0.031430    loss: 0.189266
steps 11000    v_Prec: 0.731266  v_Recall: 0.688953  v_F1: 0.709479  v_AUC: 0.912997
steps 11000    running time 425 seconds

steps 11200    base_loss: 0.081377    reg_loss: 0.067705    l2_loss: 0.031545    loss: 0.180627
steps 11200    v_Prec: 0.713311  v_Recall: 0.682426  v_F1: 0.697527  v_AUC: 0.906764
steps 11200    running time 432 seconds

steps 11400    base_loss: 0.080128    reg_loss: 0.067692    l2_loss: 0.031752    loss: 0.179573
steps 11400    v_Prec: 0.715510  v_Recall: 0.677810  v_F1: 0.696150  v_AUC: 0.906709
steps 11400    running time 439 seconds

steps 11600    base_loss: 0.081946    reg_loss: 0.067256    l2_loss: 0.031960    loss: 0.181162
steps 11600    v_Prec: 0.688375  v_Recall: 0.684814  v_F1: 0.686590  v_AUC: 0.902615
steps 11600    running time 445 seconds

steps 11800    base_loss: 0.084824    reg_loss: 0.067320    l2_loss: 0.032129    loss: 0.184273
steps 11800    v_Prec: 0.674442  v_Recall: 0.690385  v_F1: 0.682321  v_AUC: 0.900066
steps 11800    running time 452 seconds

steps 12000    base_loss: 0.090848    reg_loss: 0.067215    l2_loss: 0.032331    loss: 0.190394
steps 12000    v_Prec: 0.682435  v_Recall: 0.672875  v_F1: 0.677621  v_AUC: 0.896938
steps 12000    running time 458 seconds

steps 12200    base_loss: 0.092316    reg_loss: 0.067280    l2_loss: 0.032490    loss: 0.192087
steps 12200    v_Prec: 0.698874  v_Recall: 0.666667  v_F1: 0.682390  v_AUC: 0.898682
steps 12200    running time 465 seconds

steps 12400    base_loss: 0.093500    reg_loss: 0.067274    l2_loss: 0.032446    loss: 0.193220
steps 12400    v_Prec: 0.688697  v_Recall: 0.666826  v_F1: 0.677585  v_AUC: 0.894790
steps 12400    running time 471 seconds

steps 12600    base_loss: 0.090408    reg_loss: 0.066818    l2_loss: 0.032723    loss: 0.189949
steps 12600    v_Prec: 0.686409  v_Recall: 0.676138  v_F1: 0.681235  v_AUC: 0.898903
steps 12600    running time 478 seconds

steps 12800    base_loss: 0.096341    reg_loss: 0.067018    l2_loss: 0.032757    loss: 0.196116
steps 12800    v_Prec: 0.688584  v_Recall: 0.670169  v_F1: 0.679251  v_AUC: 0.897563
steps 12800    running time 484 seconds

Early stop model F1: 0.718613
testing thre: 0.503802
testing Prec: 0.5255412142320562
testing Recall: 0.7480437424058323
testing F1: 0.6173562503760454
testing AUC: 0.8943849244853949
overall running time 487 seconds
(0.7028997795489231, 0.6043742405832321, 0.6499242147075733, 0.8943849244853949, 0.80084455)

2019-02-24 02:25:23.065418: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:25:23.448487: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:25:23.450213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:25:23.450262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.790000 seconds
loading data in 31.280000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	96
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.843059    reg_loss: 0.065106    l2_loss: 0.013301    loss: 0.921466
steps 200    v_Prec: 0.163344  v_Recall: 1.000000  v_F1: 0.280818  v_AUC: 0.469559
steps 200    running time 42 seconds

steps 400    base_loss: 0.593615    reg_loss: 0.065213    l2_loss: 0.013285    loss: 0.672112
steps 400    v_Prec: 0.163350  v_Recall: 1.000000  v_F1: 0.280827  v_AUC: 0.489556
steps 400    running time 50 seconds

steps 600    base_loss: 0.506599    reg_loss: 0.065033    l2_loss: 0.013162    loss: 0.584794
steps 600    v_Prec: 0.165315  v_Recall: 0.942887  v_F1: 0.281309  v_AUC: 0.521334
steps 600    running time 57 seconds

steps 800    base_loss: 0.490855    reg_loss: 0.064741    l2_loss: 0.012984    loss: 0.568580
steps 800    v_Prec: 0.163380  v_Recall: 1.000000  v_F1: 0.280871  v_AUC: 0.496273
steps 800    running time 64 seconds

steps 1000    base_loss: 0.463332    reg_loss: 0.064217    l2_loss: 0.012749    loss: 0.540297
steps 1000    v_Prec: 0.163547  v_Recall: 0.998163  v_F1: 0.281046  v_AUC: 0.526703
steps 1000    running time 70 seconds

steps 1200    base_loss: 0.457393    reg_loss: 0.063981    l2_loss: 0.012621    loss: 0.533994
steps 1200    v_Prec: 0.208267  v_Recall: 0.502277  v_F1: 0.294444  v_AUC: 0.589326
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.450188    reg_loss: 0.063773    l2_loss: 0.012528    loss: 0.526489
steps 1400    v_Prec: 0.345702  v_Recall: 0.416008  v_F1: 0.377610  v_AUC: 0.682483
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.435630    reg_loss: 0.063682    l2_loss: 0.012518    loss: 0.511831
steps 1600    v_Prec: 0.453264  v_Recall: 0.431504  v_F1: 0.442116  v_AUC: 0.741752
steps 1600    running time 91 seconds

steps 1800    base_loss: 0.404973    reg_loss: 0.064050    l2_loss: 0.012593    loss: 0.481615
steps 1800    v_Prec: 0.495590  v_Recall: 0.484703  v_F1: 0.490086  v_AUC: 0.781861
steps 1800    running time 98 seconds

steps 2000    base_loss: 0.372311    reg_loss: 0.064470    l2_loss: 0.012820    loss: 0.449601
steps 2000    v_Prec: 0.550039  v_Recall: 0.506191  v_F1: 0.527205  v_AUC: 0.810080
steps 2000    running time 105 seconds

steps 2200    base_loss: 0.354630    reg_loss: 0.065027    l2_loss: 0.013140    loss: 0.432797
steps 2200    v_Prec: 0.575532  v_Recall: 0.542615  v_F1: 0.558589  v_AUC: 0.829912
steps 2200    running time 113 seconds

steps 2400    base_loss: 0.330615    reg_loss: 0.065729    l2_loss: 0.013538    loss: 0.409882
steps 2400    v_Prec: 0.604558  v_Recall: 0.563703  v_F1: 0.583416  v_AUC: 0.843985
steps 2400    running time 120 seconds

steps 2600    base_loss: 0.328644    reg_loss: 0.066007    l2_loss: 0.013965    loss: 0.408616
steps 2600    v_Prec: 0.664623  v_Recall: 0.545651  v_F1: 0.599289  v_AUC: 0.854069
steps 2600    running time 128 seconds

steps 2800    base_loss: 0.316113    reg_loss: 0.066549    l2_loss: 0.014357    loss: 0.397019
steps 2800    v_Prec: 0.676479  v_Recall: 0.565381  v_F1: 0.615960  v_AUC: 0.862728
steps 2800    running time 135 seconds

steps 3000    base_loss: 0.307546    reg_loss: 0.066910    l2_loss: 0.014717    loss: 0.389173
steps 3000    v_Prec: 0.681818  v_Recall: 0.588306  v_F1: 0.631620  v_AUC: 0.868647
steps 3000    running time 143 seconds

steps 3200    base_loss: 0.302510    reg_loss: 0.067146    l2_loss: 0.015140    loss: 0.384795
steps 3200    v_Prec: 0.684459  v_Recall: 0.591022  v_F1: 0.634318  v_AUC: 0.871631
steps 3200    running time 150 seconds

steps 3400    base_loss: 0.297417    reg_loss: 0.067349    l2_loss: 0.015520    loss: 0.380285
steps 3400    v_Prec: 0.686683  v_Recall: 0.608355  v_F1: 0.645150  v_AUC: 0.877273
steps 3400    running time 157 seconds

steps 3600    base_loss: 0.298395    reg_loss: 0.067425    l2_loss: 0.016009    loss: 0.381828
steps 3600    v_Prec: 0.669641  v_Recall: 0.635514  v_F1: 0.652131  v_AUC: 0.882114
steps 3600    running time 164 seconds

steps 3800    base_loss: 0.291760    reg_loss: 0.067735    l2_loss: 0.016375    loss: 0.375871
steps 3800    v_Prec: 0.691427  v_Recall: 0.626807  v_F1: 0.657533  v_AUC: 0.884631
steps 3800    running time 172 seconds

steps 4000    base_loss: 0.281457    reg_loss: 0.067634    l2_loss: 0.016870    loss: 0.365960
steps 4000    v_Prec: 0.679477  v_Recall: 0.639748  v_F1: 0.659014  v_AUC: 0.887247
steps 4000    running time 179 seconds

steps 4200    base_loss: 0.283634    reg_loss: 0.067796    l2_loss: 0.017339    loss: 0.368768
steps 4200    v_Prec: 0.700294  v_Recall: 0.628245  v_F1: 0.662316  v_AUC: 0.889455
steps 4200    running time 186 seconds

steps 4400    base_loss: 0.279643    reg_loss: 0.067758    l2_loss: 0.017862    loss: 0.365263
steps 4400    v_Prec: 0.686515  v_Recall: 0.643742  v_F1: 0.664441  v_AUC: 0.892317
steps 4400    running time 193 seconds

steps 4600    base_loss: 0.273299    reg_loss: 0.067689    l2_loss: 0.018481    loss: 0.359469
steps 4600    v_Prec: 0.716621  v_Recall: 0.630242  v_F1: 0.670662  v_AUC: 0.896987
steps 4600    running time 200 seconds

steps 4800    base_loss: 0.271193    reg_loss: 0.067825    l2_loss: 0.019127    loss: 0.358144
steps 4800    v_Prec: 0.705479  v_Recall: 0.640786  v_F1: 0.671578  v_AUC: 0.895942
steps 4800    running time 208 seconds

steps 5000    base_loss: 0.273909    reg_loss: 0.067649    l2_loss: 0.019726    loss: 0.361283
steps 5000    v_Prec: 0.709088  v_Recall: 0.644460  v_F1: 0.675231  v_AUC: 0.900651
steps 5000    running time 215 seconds

steps 5200    base_loss: 0.269118    reg_loss: 0.067690    l2_loss: 0.020448    loss: 0.357256
steps 5200    v_Prec: 0.736041  v_Recall: 0.629683  v_F1: 0.678721  v_AUC: 0.901780
steps 5200    running time 223 seconds

steps 5400    base_loss: 0.267865    reg_loss: 0.067819    l2_loss: 0.021193    loss: 0.356877
steps 5400    v_Prec: 0.701145  v_Recall: 0.660596  v_F1: 0.680267  v_AUC: 0.903678
steps 5400    running time 230 seconds

steps 5600    base_loss: 0.180307    reg_loss: 0.068420    l2_loss: 0.021990    loss: 0.270717
steps 5600    v_Prec: 0.712229  v_Recall: 0.632239  v_F1: 0.669854  v_AUC: 0.897789
steps 5600    running time 238 seconds

steps 5800    base_loss: 0.179486    reg_loss: 0.068202    l2_loss: 0.022894    loss: 0.270582
steps 5800    v_Prec: 0.691477  v_Recall: 0.639668  v_F1: 0.664564  v_AUC: 0.895593
steps 5800    running time 244 seconds

steps 6000    base_loss: 0.187138    reg_loss: 0.068124    l2_loss: 0.023630    loss: 0.278892
steps 6000    v_Prec: 0.690788  v_Recall: 0.648135  v_F1: 0.668782  v_AUC: 0.895052
steps 6000    running time 251 seconds

steps 6200    base_loss: 0.194628    reg_loss: 0.067832    l2_loss: 0.024268    loss: 0.286728
steps 6200    v_Prec: 0.715800  v_Recall: 0.631121  v_F1: 0.670798  v_AUC: 0.896493
steps 6200    running time 257 seconds

steps 6400    base_loss: 0.187641    reg_loss: 0.067836    l2_loss: 0.024936    loss: 0.280413
steps 6400    v_Prec: 0.713862  v_Recall: 0.634715  v_F1: 0.671966  v_AUC: 0.896448
steps 6400    running time 264 seconds

steps 6600    base_loss: 0.187961    reg_loss: 0.067962    l2_loss: 0.025477    loss: 0.281400
steps 6600    v_Prec: 0.693680  v_Recall: 0.658439  v_F1: 0.675600  v_AUC: 0.897193
steps 6600    running time 271 seconds

steps 6800    base_loss: 0.197812    reg_loss: 0.068018    l2_loss: 0.025993    loss: 0.291823
steps 6800    v_Prec: 0.704493  v_Recall: 0.655084  v_F1: 0.678891  v_AUC: 0.897929
steps 6800    running time 277 seconds

steps 7000    base_loss: 0.196232    reg_loss: 0.068166    l2_loss: 0.026475    loss: 0.290872
steps 7000    v_Prec: 0.689024  v_Recall: 0.667945  v_F1: 0.678321  v_AUC: 0.898863
steps 7000    running time 283 seconds

steps 7200    base_loss: 0.182254    reg_loss: 0.067998    l2_loss: 0.026973    loss: 0.277225
steps 7200    v_Prec: 0.714786  v_Recall: 0.652209  v_F1: 0.682065  v_AUC: 0.901210
steps 7200    running time 290 seconds

steps 7400    base_loss: 0.194742    reg_loss: 0.067866    l2_loss: 0.027414    loss: 0.290022
steps 7400    v_Prec: 0.717640  v_Recall: 0.656762  v_F1: 0.685853  v_AUC: 0.902854
steps 7400    running time 297 seconds

steps 7600    base_loss: 0.183960    reg_loss: 0.067796    l2_loss: 0.027787    loss: 0.279543
steps 7600    v_Prec: 0.713969  v_Recall: 0.669143  v_F1: 0.690830  v_AUC: 0.905493
steps 7600    running time 304 seconds

steps 7800    base_loss: 0.195064    reg_loss: 0.067922    l2_loss: 0.028160    loss: 0.291146
steps 7800    v_Prec: 0.729124  v_Recall: 0.660516  v_F1: 0.693127  v_AUC: 0.906762
steps 7800    running time 311 seconds

steps 8000    base_loss: 0.193711    reg_loss: 0.067948    l2_loss: 0.028485    loss: 0.290144
steps 8000    v_Prec: 0.715291  v_Recall: 0.681923  v_F1: 0.698209  v_AUC: 0.908665
steps 8000    running time 318 seconds

steps 8200    base_loss: 0.176278    reg_loss: 0.067863    l2_loss: 0.028799    loss: 0.272940
steps 8200    v_Prec: 0.725227  v_Recall: 0.669383  v_F1: 0.696187  v_AUC: 0.906624
steps 8200    running time 325 seconds

steps 8400    base_loss: 0.189718    reg_loss: 0.067855    l2_loss: 0.029195    loss: 0.286768
steps 8400    v_Prec: 0.716486  v_Recall: 0.680086  v_F1: 0.697812  v_AUC: 0.908739
steps 8400    running time 332 seconds

steps 8600    base_loss: 0.191291    reg_loss: 0.067777    l2_loss: 0.029434    loss: 0.288501
steps 8600    v_Prec: 0.746073  v_Recall: 0.663951  v_F1: 0.702620  v_AUC: 0.910236
steps 8600    running time 338 seconds

steps 8800    base_loss: 0.194424    reg_loss: 0.067627    l2_loss: 0.029863    loss: 0.291915
steps 8800    v_Prec: 0.740118  v_Recall: 0.671539  v_F1: 0.704163  v_AUC: 0.912642
steps 8800    running time 346 seconds

steps 9000    base_loss: 0.185991    reg_loss: 0.067744    l2_loss: 0.030133    loss: 0.283869
steps 9000    v_Prec: 0.727762  v_Recall: 0.680326  v_F1: 0.703245  v_AUC: 0.913021
steps 9000    running time 354 seconds

steps 9200    base_loss: 0.191081    reg_loss: 0.067569    l2_loss: 0.030407    loss: 0.289057
steps 9200    v_Prec: 0.742546  v_Recall: 0.676412  v_F1: 0.707938  v_AUC: 0.913809
steps 9200    running time 360 seconds

steps 9400    base_loss: 0.185983    reg_loss: 0.067773    l2_loss: 0.030589    loss: 0.284345
steps 9400    v_Prec: 0.746770  v_Recall: 0.683361  v_F1: 0.713660  v_AUC: 0.915780
steps 9400    running time 367 seconds

steps 9600    base_loss: 0.191377    reg_loss: 0.067402    l2_loss: 0.030916    loss: 0.289694
steps 9600    v_Prec: 0.764418  v_Recall: 0.673376  v_F1: 0.716015  v_AUC: 0.918561
steps 9600    running time 375 seconds

steps 9800    base_loss: 0.190730    reg_loss: 0.067615    l2_loss: 0.031120    loss: 0.289465
steps 9800    v_Prec: 0.755526  v_Recall: 0.685278  v_F1: 0.718690  v_AUC: 0.918633
steps 9800    running time 381 seconds

steps 10000    base_loss: 0.193677    reg_loss: 0.067481    l2_loss: 0.031305    loss: 0.292462
steps 10000    v_Prec: 0.752090  v_Recall: 0.689911  v_F1: 0.719660  v_AUC: 0.919329
steps 10000    running time 389 seconds

steps 10200    base_loss: 0.186595    reg_loss: 0.067238    l2_loss: 0.031516    loss: 0.285349
steps 10200    v_Prec: 0.739308  v_Recall: 0.707005  v_F1: 0.722796  v_AUC: 0.921550
steps 10200    running time 396 seconds

steps 10400    base_loss: 0.191766    reg_loss: 0.067141    l2_loss: 0.031742    loss: 0.290648
steps 10400    v_Prec: 0.758988  v_Recall: 0.704849  v_F1: 0.730917  v_AUC: 0.924689
steps 10400    running time 403 seconds

steps 10600    base_loss: 0.182943    reg_loss: 0.067238    l2_loss: 0.031859    loss: 0.282040
steps 10600    v_Prec: 0.757966  v_Recall: 0.704929  v_F1: 0.730486  v_AUC: 0.925969
steps 10600    running time 410 seconds

steps 10800    base_loss: 0.173131    reg_loss: 0.067092    l2_loss: 0.032072    loss: 0.272294
steps 10800    v_Prec: 0.774746  v_Recall: 0.687116  v_F1: 0.728304  v_AUC: 0.925560
steps 10800    running time 416 seconds

steps 11000    base_loss: 0.076641    reg_loss: 0.066313    l2_loss: 0.032253    loss: 0.175208
steps 11000    v_Prec: 0.737294  v_Recall: 0.699896  v_F1: 0.718108  v_AUC: 0.920581
steps 11000    running time 423 seconds

steps 11200    base_loss: 0.072922    reg_loss: 0.066549    l2_loss: 0.032345    loss: 0.171816
steps 11200    v_Prec: 0.746335  v_Recall: 0.683202  v_F1: 0.713374  v_AUC: 0.916412
steps 11200    running time 429 seconds

steps 11400    base_loss: 0.078071    reg_loss: 0.066211    l2_loss: 0.032332    loss: 0.176614
steps 11400    v_Prec: 0.719809  v_Recall: 0.698938  v_F1: 0.709220  v_AUC: 0.913310
steps 11400    running time 436 seconds

steps 11600    base_loss: 0.079278    reg_loss: 0.066155    l2_loss: 0.032509    loss: 0.177942
steps 11600    v_Prec: 0.706446  v_Recall: 0.695103  v_F1: 0.700729  v_AUC: 0.909877
steps 11600    running time 443 seconds

steps 11800    base_loss: 0.080975    reg_loss: 0.066297    l2_loss: 0.032488    loss: 0.179760
steps 11800    v_Prec: 0.721956  v_Recall: 0.674495  v_F1: 0.697419  v_AUC: 0.907831
steps 11800    running time 449 seconds

steps 12000    base_loss: 0.081985    reg_loss: 0.066033    l2_loss: 0.032651    loss: 0.180669
steps 12000    v_Prec: 0.721250  v_Recall: 0.678329  v_F1: 0.699131  v_AUC: 0.908233
steps 12000    running time 456 seconds

steps 12200    base_loss: 0.082647    reg_loss: 0.066336    l2_loss: 0.032681    loss: 0.181663
steps 12200    v_Prec: 0.725791  v_Recall: 0.675933  v_F1: 0.699975  v_AUC: 0.907003
steps 12200    running time 463 seconds

steps 12400    base_loss: 0.085795    reg_loss: 0.066358    l2_loss: 0.032838    loss: 0.184991
steps 12400    v_Prec: 0.713913  v_Recall: 0.677930  v_F1: 0.695456  v_AUC: 0.905116
steps 12400    running time 469 seconds

Early stop model F1: 0.730917
testing thre: 0.4371996
testing Prec: 0.5453429222943343
testing Recall: 0.7555285540704739
testing F1: 0.6334555827220864
testing AUC: 0.9003921063470666
overall running time 472 seconds
(0.7153680252170547, 0.6287241798298906, 0.6692534533602359, 0.9003921063470666, 0.7284639)

2019-02-24 02:31:03.051336: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:31:03.483235: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:31:03.484121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:31:03.484156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.810000 seconds
loading data in 31.170000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.657381    reg_loss: 0.064978    l2_loss: 0.013314    loss: 0.735673
steps 200    v_Prec: 0.164328  v_Recall: 0.999762  v_F1: 0.282261  v_AUC: 0.528165
steps 200    running time 42 seconds

steps 400    base_loss: 0.553712    reg_loss: 0.064702    l2_loss: 0.013151    loss: 0.631565
steps 400    v_Prec: 0.177398  v_Recall: 0.758815  v_F1: 0.287567  v_AUC: 0.558990
steps 400    running time 49 seconds

steps 600    base_loss: 0.495967    reg_loss: 0.064230    l2_loss: 0.012951    loss: 0.573148
steps 600    v_Prec: 0.196625  v_Recall: 0.626429  v_F1: 0.299304  v_AUC: 0.589298
steps 600    running time 57 seconds

steps 800    base_loss: 0.473035    reg_loss: 0.063634    l2_loss: 0.012799    loss: 0.549468
steps 800    v_Prec: 0.253620  v_Recall: 0.500715  v_F1: 0.336698  v_AUC: 0.650570
steps 800    running time 65 seconds

steps 1000    base_loss: 0.437896    reg_loss: 0.062855    l2_loss: 0.012639    loss: 0.513390
steps 1000    v_Prec: 0.307288  v_Recall: 0.450365  v_F1: 0.365317  v_AUC: 0.679543
steps 1000    running time 72 seconds

steps 1200    base_loss: 0.436496    reg_loss: 0.062430    l2_loss: 0.012587    loss: 0.511512
steps 1200    v_Prec: 0.347847  v_Recall: 0.458069  v_F1: 0.395421  v_AUC: 0.707251
steps 1200    running time 80 seconds

steps 1400    base_loss: 0.413184    reg_loss: 0.061784    l2_loss: 0.012648    loss: 0.487616
steps 1400    v_Prec: 0.386961  v_Recall: 0.460530  v_F1: 0.420553  v_AUC: 0.737044
steps 1400    running time 88 seconds

steps 1600    base_loss: 0.398325    reg_loss: 0.061325    l2_loss: 0.012707    loss: 0.472357
steps 1600    v_Prec: 0.433354  v_Recall: 0.495473  v_F1: 0.462337  v_AUC: 0.774858
steps 1600    running time 96 seconds

steps 1800    base_loss: 0.378055    reg_loss: 0.060890    l2_loss: 0.012930    loss: 0.451874
steps 1800    v_Prec: 0.459916  v_Recall: 0.540343  v_F1: 0.496896  v_AUC: 0.802255
steps 1800    running time 103 seconds

steps 2000    base_loss: 0.358170    reg_loss: 0.060317    l2_loss: 0.013186    loss: 0.431673
steps 2000    v_Prec: 0.515308  v_Recall: 0.540025  v_F1: 0.527377  v_AUC: 0.825934
steps 2000    running time 110 seconds

steps 2200    base_loss: 0.347094    reg_loss: 0.060097    l2_loss: 0.013540    loss: 0.420731
steps 2200    v_Prec: 0.528046  v_Recall: 0.574174  v_F1: 0.550145  v_AUC: 0.841623
steps 2200    running time 117 seconds

steps 2400    base_loss: 0.331685    reg_loss: 0.059539    l2_loss: 0.013954    loss: 0.405178
steps 2400    v_Prec: 0.563121  v_Recall: 0.580607  v_F1: 0.571730  v_AUC: 0.850389
steps 2400    running time 125 seconds

steps 2600    base_loss: 0.320871    reg_loss: 0.059105    l2_loss: 0.014367    loss: 0.394343
steps 2600    v_Prec: 0.571101  v_Recall: 0.612373  v_F1: 0.591017  v_AUC: 0.862416
steps 2600    running time 132 seconds

steps 2800    base_loss: 0.313356    reg_loss: 0.058601    l2_loss: 0.014817    loss: 0.386773
steps 2800    v_Prec: 0.576468  v_Recall: 0.630718  v_F1: 0.602374  v_AUC: 0.867942
steps 2800    running time 140 seconds

steps 3000    base_loss: 0.313082    reg_loss: 0.058344    l2_loss: 0.015323    loss: 0.386749
steps 3000    v_Prec: 0.615769  v_Recall: 0.617138  v_F1: 0.616452  v_AUC: 0.875032
steps 3000    running time 147 seconds

steps 3200    base_loss: 0.300755    reg_loss: 0.057917    l2_loss: 0.015822    loss: 0.374494
steps 3200    v_Prec: 0.614117  v_Recall: 0.624603  v_F1: 0.619316  v_AUC: 0.877042
steps 3200    running time 155 seconds

steps 3400    base_loss: 0.301189    reg_loss: 0.057515    l2_loss: 0.016399    loss: 0.375103
steps 3400    v_Prec: 0.639041  v_Recall: 0.611738  v_F1: 0.625091  v_AUC: 0.879384
steps 3400    running time 163 seconds

steps 3600    base_loss: 0.301841    reg_loss: 0.057160    l2_loss: 0.016994    loss: 0.375995
steps 3600    v_Prec: 0.618222  v_Recall: 0.642868  v_F1: 0.630304  v_AUC: 0.883075
steps 3600    running time 170 seconds

steps 3800    base_loss: 0.300756    reg_loss: 0.056631    l2_loss: 0.017621    loss: 0.375008
steps 3800    v_Prec: 0.611222  v_Recall: 0.653987  v_F1: 0.631882  v_AUC: 0.883994
steps 3800    running time 178 seconds

steps 4000    base_loss: 0.294292    reg_loss: 0.056025    l2_loss: 0.018251    loss: 0.368567
steps 4000    v_Prec: 0.629433  v_Recall: 0.641280  v_F1: 0.635302  v_AUC: 0.885110
steps 4000    running time 186 seconds

steps 4200    base_loss: 0.289286    reg_loss: 0.055344    l2_loss: 0.018907    loss: 0.363538
steps 4200    v_Prec: 0.651093  v_Recall: 0.624206  v_F1: 0.637366  v_AUC: 0.885337
steps 4200    running time 193 seconds

steps 4400    base_loss: 0.294355    reg_loss: 0.054984    l2_loss: 0.019566    loss: 0.368905
steps 4400    v_Prec: 0.649758  v_Recall: 0.638818  v_F1: 0.644242  v_AUC: 0.888672
steps 4400    running time 200 seconds

steps 4600    base_loss: 0.280587    reg_loss: 0.054264    l2_loss: 0.020254    loss: 0.355106
steps 4600    v_Prec: 0.658140  v_Recall: 0.633418  v_F1: 0.645542  v_AUC: 0.890060
steps 4600    running time 208 seconds

steps 4800    base_loss: 0.278657    reg_loss: 0.053642    l2_loss: 0.020992    loss: 0.353292
steps 4800    v_Prec: 0.651565  v_Recall: 0.646442  v_F1: 0.648993  v_AUC: 0.890586
steps 4800    running time 215 seconds

steps 5000    base_loss: 0.285247    reg_loss: 0.053388    l2_loss: 0.021773    loss: 0.360408
steps 5000    v_Prec: 0.680769  v_Recall: 0.632544  v_F1: 0.655771  v_AUC: 0.893031
steps 5000    running time 223 seconds

steps 5200    base_loss: 0.287504    reg_loss: 0.052817    l2_loss: 0.022484    loss: 0.362804
steps 5200    v_Prec: 0.658387  v_Recall: 0.648348  v_F1: 0.653329  v_AUC: 0.893723
steps 5200    running time 230 seconds

steps 5400    base_loss: 0.277666    reg_loss: 0.052395    l2_loss: 0.023228    loss: 0.353289
steps 5400    v_Prec: 0.674428  v_Recall: 0.648666  v_F1: 0.661296  v_AUC: 0.895301
steps 5400    running time 237 seconds

steps 5600    base_loss: 0.164996    reg_loss: 0.054183    l2_loss: 0.023973    loss: 0.243153
steps 5600    v_Prec: 0.685538  v_Recall: 0.617376  v_F1: 0.649674  v_AUC: 0.891305
steps 5600    running time 244 seconds

steps 5800    base_loss: 0.172569    reg_loss: 0.054568    l2_loss: 0.024486    loss: 0.251623
steps 5800    v_Prec: 0.644998  v_Recall: 0.647713  v_F1: 0.646353  v_AUC: 0.888312
steps 5800    running time 251 seconds

steps 6000    base_loss: 0.174480    reg_loss: 0.054899    l2_loss: 0.025090    loss: 0.254468
steps 6000    v_Prec: 0.668569  v_Recall: 0.623173  v_F1: 0.645074  v_AUC: 0.886371
steps 6000    running time 258 seconds

steps 6200    base_loss: 0.172956    reg_loss: 0.054889    l2_loss: 0.025623    loss: 0.253468
steps 6200    v_Prec: 0.657232  v_Recall: 0.638024  v_F1: 0.647485  v_AUC: 0.886122
steps 6200    running time 265 seconds

steps 6400    base_loss: 0.165319    reg_loss: 0.055109    l2_loss: 0.026248    loss: 0.246676
steps 6400    v_Prec: 0.644524  v_Recall: 0.647236  v_F1: 0.645877  v_AUC: 0.886536
steps 6400    running time 271 seconds

steps 6600    base_loss: 0.178191    reg_loss: 0.055028    l2_loss: 0.026853    loss: 0.260071
steps 6600    v_Prec: 0.635346  v_Recall: 0.653510  v_F1: 0.644300  v_AUC: 0.886684
steps 6600    running time 278 seconds

steps 6800    base_loss: 0.164248    reg_loss: 0.054633    l2_loss: 0.027274    loss: 0.246155
steps 6800    v_Prec: 0.678404  v_Recall: 0.619679  v_F1: 0.647713  v_AUC: 0.888014
steps 6800    running time 285 seconds

steps 7000    base_loss: 0.169085    reg_loss: 0.054608    l2_loss: 0.027702    loss: 0.251395
steps 7000    v_Prec: 0.636357  v_Recall: 0.659705  v_F1: 0.647820  v_AUC: 0.887801
steps 7000    running time 292 seconds

steps 7200    base_loss: 0.169515    reg_loss: 0.054468    l2_loss: 0.028195    loss: 0.252179
steps 7200    v_Prec: 0.675246  v_Recall: 0.627144  v_F1: 0.650307  v_AUC: 0.889861
steps 7200    running time 299 seconds

steps 7400    base_loss: 0.176256    reg_loss: 0.054382    l2_loss: 0.028538    loss: 0.259176
steps 7400    v_Prec: 0.657228  v_Recall: 0.648825  v_F1: 0.652999  v_AUC: 0.889703
steps 7400    running time 306 seconds

Early stop model F1: 0.661296
testing thre: 0.36678
testing Prec: 0.4907573812580231
testing Recall: 0.743232077764277
testing F1: 0.5911665216971103
testing AUC: 0.8795777702831395
overall running time 309 seconds
(0.654699669262776, 0.5965006075334144, 0.6242465857938506, 0.8795777702831395, 0.61703163)

2019-02-24 02:34:57.238198: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:34:58.497463: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:34:58.499459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:34:58.499496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.330000 seconds
loading data in 30.580000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.756889    reg_loss: 0.064905    l2_loss: 0.013298    loss: 0.835091
steps 200    v_Prec: 0.165514  v_Recall: 1.000000  v_F1: 0.284019  v_AUC: 0.494728
steps 200    running time 42 seconds

steps 400    base_loss: 0.569647    reg_loss: 0.064728    l2_loss: 0.013042    loss: 0.647416
steps 400    v_Prec: 0.166449  v_Recall: 0.994639  v_F1: 0.285175  v_AUC: 0.518090
steps 400    running time 50 seconds

steps 600    base_loss: 0.486045    reg_loss: 0.064795    l2_loss: 0.012813    loss: 0.563653
steps 600    v_Prec: 0.183435  v_Recall: 0.791801  v_F1: 0.297865  v_AUC: 0.573639
steps 600    running time 58 seconds

steps 800    base_loss: 0.469639    reg_loss: 0.064608    l2_loss: 0.012616    loss: 0.546863
steps 800    v_Prec: 0.214172  v_Recall: 0.570201  v_F1: 0.311385  v_AUC: 0.612623
steps 800    running time 65 seconds

steps 1000    base_loss: 0.449904    reg_loss: 0.064712    l2_loss: 0.012526    loss: 0.527141
steps 1000    v_Prec: 0.327328  v_Recall: 0.416791  v_F1: 0.366682  v_AUC: 0.683180
steps 1000    running time 73 seconds

steps 1200    base_loss: 0.429669    reg_loss: 0.065046    l2_loss: 0.012475    loss: 0.507190
steps 1200    v_Prec: 0.361737  v_Recall: 0.488609  v_F1: 0.415708  v_AUC: 0.726084
steps 1200    running time 80 seconds

steps 1400    base_loss: 0.410015    reg_loss: 0.065343    l2_loss: 0.012459    loss: 0.487817
steps 1400    v_Prec: 0.453144  v_Recall: 0.502799  v_F1: 0.476682  v_AUC: 0.767056
steps 1400    running time 88 seconds

steps 1600    base_loss: 0.391016    reg_loss: 0.065712    l2_loss: 0.012466    loss: 0.469195
steps 1600    v_Prec: 0.515152  v_Recall: 0.507923  v_F1: 0.511512  v_AUC: 0.795599
steps 1600    running time 95 seconds

steps 1800    base_loss: 0.368162    reg_loss: 0.065901    l2_loss: 0.012630    loss: 0.446693
steps 1800    v_Prec: 0.585160  v_Recall: 0.519748  v_F1: 0.550518  v_AUC: 0.818491
steps 1800    running time 103 seconds

steps 2000    base_loss: 0.342200    reg_loss: 0.066177    l2_loss: 0.012809    loss: 0.421185
steps 2000    v_Prec: 0.606620  v_Recall: 0.548995  v_F1: 0.576371  v_AUC: 0.837773
steps 2000    running time 110 seconds

steps 2200    base_loss: 0.326089    reg_loss: 0.066534    l2_loss: 0.013096    loss: 0.405719
steps 2200    v_Prec: 0.620913  v_Recall: 0.573433  v_F1: 0.596230  v_AUC: 0.851717
steps 2200    running time 117 seconds

steps 2400    base_loss: 0.312081    reg_loss: 0.066736    l2_loss: 0.013442    loss: 0.392259
steps 2400    v_Prec: 0.653131  v_Recall: 0.575641  v_F1: 0.611942  v_AUC: 0.861433
steps 2400    running time 125 seconds

steps 2600    base_loss: 0.305029    reg_loss: 0.066933    l2_loss: 0.013851    loss: 0.385812
steps 2600    v_Prec: 0.706711  v_Recall: 0.565313  v_F1: 0.628153  v_AUC: 0.868185
steps 2600    running time 132 seconds

steps 2800    base_loss: 0.294701    reg_loss: 0.067026    l2_loss: 0.014286    loss: 0.376013
steps 2800    v_Prec: 0.684383  v_Recall: 0.593851  v_F1: 0.635911  v_AUC: 0.873522
steps 2800    running time 140 seconds

steps 3000    base_loss: 0.288089    reg_loss: 0.067282    l2_loss: 0.014762    loss: 0.370133
steps 3000    v_Prec: 0.702811  v_Recall: 0.595270  v_F1: 0.644586  v_AUC: 0.877543
steps 3000    running time 147 seconds

steps 3200    base_loss: 0.284629    reg_loss: 0.067398    l2_loss: 0.015165    loss: 0.367192
steps 3200    v_Prec: 0.673861  v_Recall: 0.625148  v_F1: 0.648591  v_AUC: 0.881714
steps 3200    running time 155 seconds

steps 3400    base_loss: 0.285266    reg_loss: 0.067352    l2_loss: 0.015644    loss: 0.368262
steps 3400    v_Prec: 0.684193  v_Recall: 0.631927  v_F1: 0.657022  v_AUC: 0.885148
steps 3400    running time 163 seconds

steps 3600    base_loss: 0.283562    reg_loss: 0.067473    l2_loss: 0.016090    loss: 0.367125
steps 3600    v_Prec: 0.725450  v_Recall: 0.607410  v_F1: 0.661203  v_AUC: 0.887526
steps 3600    running time 171 seconds

steps 3800    base_loss: 0.269037    reg_loss: 0.067634    l2_loss: 0.016596    loss: 0.353268
steps 3800    v_Prec: 0.718868  v_Recall: 0.614821  v_F1: 0.662786  v_AUC: 0.888475
steps 3800    running time 178 seconds

steps 4000    base_loss: 0.272718    reg_loss: 0.067536    l2_loss: 0.017093    loss: 0.357347
steps 4000    v_Prec: 0.720543  v_Recall: 0.623808  v_F1: 0.668695  v_AUC: 0.892003
steps 4000    running time 186 seconds

steps 4200    base_loss: 0.273976    reg_loss: 0.067823    l2_loss: 0.017560    loss: 0.359360
steps 4200    v_Prec: 0.703380  v_Recall: 0.647931  v_F1: 0.674518  v_AUC: 0.895183
steps 4200    running time 193 seconds

steps 4400    base_loss: 0.268070    reg_loss: 0.067540    l2_loss: 0.018090    loss: 0.353700
steps 4400    v_Prec: 0.722183  v_Recall: 0.637525  v_F1: 0.677218  v_AUC: 0.898060
steps 4400    running time 201 seconds

steps 4600    base_loss: 0.268694    reg_loss: 0.067791    l2_loss: 0.018634    loss: 0.355118
steps 4600    v_Prec: 0.704509  v_Recall: 0.651636  v_F1: 0.677042  v_AUC: 0.898869
steps 4600    running time 208 seconds

steps 4800    base_loss: 0.259734    reg_loss: 0.067769    l2_loss: 0.019240    loss: 0.346743
steps 4800    v_Prec: 0.729896  v_Recall: 0.636106  v_F1: 0.679781  v_AUC: 0.900532
steps 4800    running time 215 seconds

steps 5000    base_loss: 0.265319    reg_loss: 0.067642    l2_loss: 0.019868    loss: 0.352828
steps 5000    v_Prec: 0.716358  v_Recall: 0.650059  v_F1: 0.681600  v_AUC: 0.903382
steps 5000    running time 222 seconds

steps 5200    base_loss: 0.262631    reg_loss: 0.067601    l2_loss: 0.020591    loss: 0.350823
steps 5200    v_Prec: 0.743752  v_Recall: 0.631060  v_F1: 0.682787  v_AUC: 0.904013
steps 5200    running time 229 seconds

steps 5400    base_loss: 0.252254    reg_loss: 0.067616    l2_loss: 0.021227    loss: 0.341097
steps 5400    v_Prec: 0.723267  v_Recall: 0.654789  v_F1: 0.687327  v_AUC: 0.904908
steps 5400    running time 237 seconds

steps 5600    base_loss: 0.168494    reg_loss: 0.067105    l2_loss: 0.022004    loss: 0.257603
steps 5600    v_Prec: 0.720331  v_Recall: 0.652188  v_F1: 0.684568  v_AUC: 0.901729
steps 5600    running time 245 seconds

steps 5800    base_loss: 0.167692    reg_loss: 0.067104    l2_loss: 0.022851    loss: 0.257647
steps 5800    v_Prec: 0.751834  v_Recall: 0.622152  v_F1: 0.680873  v_AUC: 0.899480
steps 5800    running time 251 seconds

steps 6000    base_loss: 0.183009    reg_loss: 0.067150    l2_loss: 0.023630    loss: 0.273789
steps 6000    v_Prec: 0.718588  v_Recall: 0.643358  v_F1: 0.678895  v_AUC: 0.898457
steps 6000    running time 258 seconds

steps 6200    base_loss: 0.190501    reg_loss: 0.067048    l2_loss: 0.024327    loss: 0.281877
steps 6200    v_Prec: 0.719028  v_Recall: 0.655656  v_F1: 0.685882  v_AUC: 0.900456
steps 6200    running time 265 seconds

steps 6400    base_loss: 0.175657    reg_loss: 0.066914    l2_loss: 0.025014    loss: 0.267585
steps 6400    v_Prec: 0.703017  v_Recall: 0.657627  v_F1: 0.679565  v_AUC: 0.898010
steps 6400    running time 272 seconds

steps 6600    base_loss: 0.177976    reg_loss: 0.066860    l2_loss: 0.025537    loss: 0.270374
steps 6600    v_Prec: 0.743342  v_Recall: 0.635869  v_F1: 0.685418  v_AUC: 0.899751
steps 6600    running time 279 seconds

steps 6800    base_loss: 0.182586    reg_loss: 0.066705    l2_loss: 0.025983    loss: 0.275274
steps 6800    v_Prec: 0.705383  v_Recall: 0.668348  v_F1: 0.686367  v_AUC: 0.899819
steps 6800    running time 286 seconds

steps 7000    base_loss: 0.178462    reg_loss: 0.066710    l2_loss: 0.026559    loss: 0.271731
steps 7000    v_Prec: 0.710349  v_Recall: 0.666614  v_F1: 0.687787  v_AUC: 0.901595
steps 7000    running time 293 seconds

steps 7200    base_loss: 0.189533    reg_loss: 0.066949    l2_loss: 0.026956    loss: 0.283438
steps 7200    v_Prec: 0.725630  v_Recall: 0.667797  v_F1: 0.695513  v_AUC: 0.905115
steps 7200    running time 300 seconds

steps 7400    base_loss: 0.174327    reg_loss: 0.066880    l2_loss: 0.027453    loss: 0.268659
steps 7400    v_Prec: 0.720883  v_Recall: 0.671896  v_F1: 0.695528  v_AUC: 0.904158
steps 7400    running time 308 seconds

steps 7600    base_loss: 0.183705    reg_loss: 0.066910    l2_loss: 0.027950    loss: 0.278564
steps 7600    v_Prec: 0.762388  v_Recall: 0.639180  v_F1: 0.695369  v_AUC: 0.904528
steps 7600    running time 315 seconds

steps 7800    base_loss: 0.185714    reg_loss: 0.066766    l2_loss: 0.028264    loss: 0.280745
steps 7800    v_Prec: 0.738087  v_Recall: 0.661805  v_F1: 0.697868  v_AUC: 0.907104
steps 7800    running time 321 seconds

steps 8000    base_loss: 0.179344    reg_loss: 0.066685    l2_loss: 0.028493    loss: 0.274522
steps 8000    v_Prec: 0.758939  v_Recall: 0.647536  v_F1: 0.698826  v_AUC: 0.906005
steps 8000    running time 329 seconds

steps 8200    base_loss: 0.180546    reg_loss: 0.066717    l2_loss: 0.028914    loss: 0.276177
steps 8200    v_Prec: 0.739646  v_Recall: 0.668743  v_F1: 0.702410  v_AUC: 0.906814
steps 8200    running time 337 seconds

steps 8400    base_loss: 0.174606    reg_loss: 0.066531    l2_loss: 0.029166    loss: 0.270303
steps 8400    v_Prec: 0.761870  v_Recall: 0.651478  v_F1: 0.702363  v_AUC: 0.906314
steps 8400    running time 344 seconds

steps 8600    base_loss: 0.182441    reg_loss: 0.066427    l2_loss: 0.029553    loss: 0.278421
steps 8600    v_Prec: 0.746619  v_Recall: 0.670162  v_F1: 0.706327  v_AUC: 0.909527
steps 8600    running time 351 seconds

steps 8800    base_loss: 0.180072    reg_loss: 0.066457    l2_loss: 0.029712    loss: 0.276241
steps 8800    v_Prec: 0.756423  v_Recall: 0.666141  v_F1: 0.708417  v_AUC: 0.911015
steps 8800    running time 359 seconds

steps 9000    base_loss: 0.183526    reg_loss: 0.066469    l2_loss: 0.030054    loss: 0.280049
steps 9000    v_Prec: 0.765463  v_Recall: 0.665353  v_F1: 0.711906  v_AUC: 0.911213
steps 9000    running time 366 seconds

steps 9200    base_loss: 0.178508    reg_loss: 0.066378    l2_loss: 0.030230    loss: 0.275115
steps 9200    v_Prec: 0.772849  v_Recall: 0.661963  v_F1: 0.713121  v_AUC: 0.912622
steps 9200    running time 374 seconds

steps 9400    base_loss: 0.182413    reg_loss: 0.066327    l2_loss: 0.030515    loss: 0.279255
steps 9400    v_Prec: 0.761613  v_Recall: 0.677257  v_F1: 0.716962  v_AUC: 0.914607
steps 9400    running time 381 seconds

steps 9600    base_loss: 0.178111    reg_loss: 0.066147    l2_loss: 0.030724    loss: 0.274982
steps 9600    v_Prec: 0.781817  v_Recall: 0.669767  v_F1: 0.721467  v_AUC: 0.916019
steps 9600    running time 389 seconds

steps 9800    base_loss: 0.184123    reg_loss: 0.066153    l2_loss: 0.030967    loss: 0.281244
steps 9800    v_Prec: 0.763678  v_Recall: 0.688845  v_F1: 0.724334  v_AUC: 0.918183
steps 9800    running time 396 seconds

steps 10000    base_loss: 0.175526    reg_loss: 0.066153    l2_loss: 0.031248    loss: 0.272928
steps 10000    v_Prec: 0.759657  v_Recall: 0.699172  v_F1: 0.728161  v_AUC: 0.918348
steps 10000    running time 403 seconds

steps 10200    base_loss: 0.171350    reg_loss: 0.066129    l2_loss: 0.031515    loss: 0.268994
steps 10200    v_Prec: 0.766814  v_Recall: 0.698384  v_F1: 0.731001  v_AUC: 0.919277
steps 10200    running time 411 seconds

steps 10400    base_loss: 0.179474    reg_loss: 0.066096    l2_loss: 0.031596    loss: 0.277166
steps 10400    v_Prec: 0.775218  v_Recall: 0.692471  v_F1: 0.731512  v_AUC: 0.918114
steps 10400    running time 418 seconds

steps 10600    base_loss: 0.173103    reg_loss: 0.066008    l2_loss: 0.031843    loss: 0.270953
steps 10600    v_Prec: 0.772043  v_Recall: 0.699251  v_F1: 0.733846  v_AUC: 0.921260
steps 10600    running time 425 seconds

steps 10800    base_loss: 0.160064    reg_loss: 0.065708    l2_loss: 0.031929    loss: 0.257701
steps 10800    v_Prec: 0.761787  v_Recall: 0.701853  v_F1: 0.730592  v_AUC: 0.921886
steps 10800    running time 433 seconds

steps 11000    base_loss: 0.077060    reg_loss: 0.064706    l2_loss: 0.032139    loss: 0.173906
steps 11000    v_Prec: 0.766825  v_Recall: 0.688057  v_F1: 0.725309  v_AUC: 0.916201
steps 11000    running time 439 seconds

steps 11200    base_loss: 0.070287    reg_loss: 0.064683    l2_loss: 0.032159    loss: 0.167129
steps 11200    v_Prec: 0.782814  v_Recall: 0.667166  v_F1: 0.720378  v_AUC: 0.914189
steps 11200    running time 446 seconds

steps 11400    base_loss: 0.069033    reg_loss: 0.064364    l2_loss: 0.032172    loss: 0.165569
steps 11400    v_Prec: 0.787041  v_Recall: 0.661648  v_F1: 0.718917  v_AUC: 0.912066
steps 11400    running time 453 seconds

steps 11600    base_loss: 0.074821    reg_loss: 0.064276    l2_loss: 0.032348    loss: 0.171445
steps 11600    v_Prec: 0.762096  v_Recall: 0.673000  v_F1: 0.714782  v_AUC: 0.909128
steps 11600    running time 460 seconds

steps 11800    base_loss: 0.073866    reg_loss: 0.064369    l2_loss: 0.032305    loss: 0.170541
steps 11800    v_Prec: 0.767030  v_Recall: 0.665747  v_F1: 0.712809  v_AUC: 0.907778
steps 11800    running time 466 seconds

steps 12000    base_loss: 0.079425    reg_loss: 0.064017    l2_loss: 0.032392    loss: 0.175834
steps 12000    v_Prec: 0.770336  v_Recall: 0.663697  v_F1: 0.713052  v_AUC: 0.907927
steps 12000    running time 473 seconds

steps 12200    base_loss: 0.075403    reg_loss: 0.064274    l2_loss: 0.032366    loss: 0.172043
steps 12200    v_Prec: 0.797545  v_Recall: 0.640363  v_F1: 0.710363  v_AUC: 0.904992
steps 12200    running time 480 seconds

steps 12400    base_loss: 0.081080    reg_loss: 0.064196    l2_loss: 0.032400    loss: 0.177676
steps 12400    v_Prec: 0.778923  v_Recall: 0.655499  v_F1: 0.711901  v_AUC: 0.904742
steps 12400    running time 487 seconds

steps 12600    base_loss: 0.080367    reg_loss: 0.064141    l2_loss: 0.032519    loss: 0.177027
steps 12600    v_Prec: 0.784468  v_Recall: 0.652188  v_F1: 0.712238  v_AUC: 0.905036
steps 12600    running time 494 seconds

Early stop model F1: 0.733846
testing thre: 0.4267567
testing Prec: 0.5553476879632898
testing Recall: 0.7646658566221142
testing F1: 0.6434106942030466
testing AUC: 0.9063564070608622
overall running time 497 seconds
(0.7441474443363287, 0.6318833535844471, 0.6834358408242655, 0.9063564070608622, 0.7370616)

2019-02-24 02:41:09.939050: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:41:10.808399: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:41:10.810640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:41:10.810691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.520000 seconds
loading data in 30.550000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.210524    reg_loss: 0.064747    l2_loss: 0.013344    loss: 1.288615
steps 200    v_Prec: 0.164215  v_Recall: 0.979172  v_F1: 0.281261  v_AUC: 0.513071
steps 200    running time 41 seconds

steps 400    base_loss: 0.897312    reg_loss: 0.064775    l2_loss: 0.013462    loss: 0.975549
steps 400    v_Prec: 0.164042  v_Recall: 0.993217  v_F1: 0.281577  v_AUC: 0.519941
steps 400    running time 49 seconds

steps 600    base_loss: 0.610068    reg_loss: 0.064786    l2_loss: 0.013726    loss: 0.688579
steps 600    v_Prec: 0.163500  v_Recall: 1.000000  v_F1: 0.281049  v_AUC: 0.514611
steps 600    running time 57 seconds

steps 800    base_loss: 0.492887    reg_loss: 0.064557    l2_loss: 0.013615    loss: 0.571059
steps 800    v_Prec: 0.165182  v_Recall: 0.963610  v_F1: 0.282021  v_AUC: 0.535379
steps 800    running time 64 seconds

steps 1000    base_loss: 0.477704    reg_loss: 0.063869    l2_loss: 0.013187    loss: 0.554760
steps 1000    v_Prec: 0.173116  v_Recall: 0.845743  v_F1: 0.287403  v_AUC: 0.553833
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.462692    reg_loss: 0.063025    l2_loss: 0.012773    loss: 0.538489
steps 1200    v_Prec: 0.183523  v_Recall: 0.688852  v_F1: 0.289830  v_AUC: 0.570642
steps 1200    running time 79 seconds

steps 1400    base_loss: 0.455651    reg_loss: 0.061978    l2_loss: 0.012405    loss: 0.530033
steps 1400    v_Prec: 0.212109  v_Recall: 0.524459  v_F1: 0.302057  v_AUC: 0.601235
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.454886    reg_loss: 0.061142    l2_loss: 0.012101    loss: 0.528129
steps 1600    v_Prec: 0.335809  v_Recall: 0.382491  v_F1: 0.357633  v_AUC: 0.670965
steps 1600    running time 93 seconds

steps 1800    base_loss: 0.434271    reg_loss: 0.059761    l2_loss: 0.012053    loss: 0.506085
steps 1800    v_Prec: 0.475396  v_Recall: 0.393185  v_F1: 0.430400  v_AUC: 0.730841
steps 1800    running time 101 seconds

steps 2000    base_loss: 0.412474    reg_loss: 0.058492    l2_loss: 0.012133    loss: 0.483098
steps 2000    v_Prec: 0.545405  v_Recall: 0.480728  v_F1: 0.511028  v_AUC: 0.785942
steps 2000    running time 108 seconds

steps 2200    base_loss: 0.383921    reg_loss: 0.057231    l2_loss: 0.012387    loss: 0.453539
steps 2200    v_Prec: 0.563249  v_Recall: 0.525178  v_F1: 0.543547  v_AUC: 0.811233
steps 2200    running time 115 seconds

steps 2400    base_loss: 0.356158    reg_loss: 0.056503    l2_loss: 0.012722    loss: 0.425383
steps 2400    v_Prec: 0.579058  v_Recall: 0.571942  v_F1: 0.575478  v_AUC: 0.832640
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.333146    reg_loss: 0.055897    l2_loss: 0.013146    loss: 0.402189
steps 2600    v_Prec: 0.659958  v_Recall: 0.554784  v_F1: 0.602818  v_AUC: 0.848040
steps 2600    running time 130 seconds

steps 2800    base_loss: 0.318002    reg_loss: 0.055493    l2_loss: 0.013610    loss: 0.387105
steps 2800    v_Prec: 0.645459  v_Recall: 0.602346  v_F1: 0.623158  v_AUC: 0.859590
steps 2800    running time 137 seconds

steps 3000    base_loss: 0.302619    reg_loss: 0.055099    l2_loss: 0.014179    loss: 0.371897
steps 3000    v_Prec: 0.717903  v_Recall: 0.574735  v_F1: 0.638390  v_AUC: 0.868301
steps 3000    running time 145 seconds

steps 3200    base_loss: 0.295769    reg_loss: 0.054904    l2_loss: 0.014742    loss: 0.365415
steps 3200    v_Prec: 0.710243  v_Recall: 0.600910  v_F1: 0.651018  v_AUC: 0.874050
steps 3200    running time 152 seconds

steps 3400    base_loss: 0.294752    reg_loss: 0.055132    l2_loss: 0.015305    loss: 0.365189
steps 3400    v_Prec: 0.736863  v_Recall: 0.602027  v_F1: 0.662655  v_AUC: 0.878652
steps 3400    running time 160 seconds

steps 3600    base_loss: 0.279538    reg_loss: 0.054680    l2_loss: 0.015939    loss: 0.350157
steps 3600    v_Prec: 0.719020  v_Recall: 0.623254  v_F1: 0.667721  v_AUC: 0.882383
steps 3600    running time 168 seconds

steps 3800    base_loss: 0.282261    reg_loss: 0.054779    l2_loss: 0.016549    loss: 0.353588
steps 3800    v_Prec: 0.713642  v_Recall: 0.644162  v_F1: 0.677124  v_AUC: 0.886408
steps 3800    running time 175 seconds

steps 4000    base_loss: 0.281429    reg_loss: 0.054607    l2_loss: 0.017177    loss: 0.353213
steps 4000    v_Prec: 0.752767  v_Recall: 0.629559  v_F1: 0.685672  v_AUC: 0.889294
steps 4000    running time 183 seconds

steps 4200    base_loss: 0.276105    reg_loss: 0.054377    l2_loss: 0.017772    loss: 0.348254
steps 4200    v_Prec: 0.749066  v_Recall: 0.640332  v_F1: 0.690444  v_AUC: 0.892207
steps 4200    running time 191 seconds

steps 4400    base_loss: 0.264694    reg_loss: 0.054241    l2_loss: 0.018343    loss: 0.337277
steps 4400    v_Prec: 0.727480  v_Recall: 0.661240  v_F1: 0.692780  v_AUC: 0.894504
steps 4400    running time 198 seconds

steps 4600    base_loss: 0.269630    reg_loss: 0.054255    l2_loss: 0.018883    loss: 0.342767
steps 4600    v_Prec: 0.734073  v_Recall: 0.664831  v_F1: 0.697739  v_AUC: 0.897686
steps 4600    running time 206 seconds

steps 4800    base_loss: 0.274828    reg_loss: 0.054239    l2_loss: 0.019446    loss: 0.348513
steps 4800    v_Prec: 0.750659  v_Recall: 0.658766  v_F1: 0.701717  v_AUC: 0.899463
steps 4800    running time 213 seconds

steps 5000    base_loss: 0.266512    reg_loss: 0.054079    l2_loss: 0.020062    loss: 0.340653
steps 5000    v_Prec: 0.769194  v_Recall: 0.648392  v_F1: 0.703646  v_AUC: 0.901163
steps 5000    running time 220 seconds

steps 5200    base_loss: 0.265822    reg_loss: 0.053891    l2_loss: 0.020592    loss: 0.340305
steps 5200    v_Prec: 0.751859  v_Recall: 0.669540  v_F1: 0.708316  v_AUC: 0.903817
steps 5200    running time 228 seconds

steps 5400    base_loss: 0.250689    reg_loss: 0.053390    l2_loss: 0.021237    loss: 0.325315
steps 5400    v_Prec: 0.764938  v_Recall: 0.664033  v_F1: 0.710923  v_AUC: 0.904857
steps 5400    running time 235 seconds

steps 5600    base_loss: 0.181654    reg_loss: 0.050264    l2_loss: 0.021715    loss: 0.253633
steps 5600    v_Prec: 0.743122  v_Recall: 0.683345  v_F1: 0.711981  v_AUC: 0.904157
steps 5600    running time 242 seconds

steps 5800    base_loss: 0.170738    reg_loss: 0.049797    l2_loss: 0.022300    loss: 0.242834
steps 5800    v_Prec: 0.774790  v_Recall: 0.655335  v_F1: 0.710073  v_AUC: 0.903278
steps 5800    running time 250 seconds

steps 6000    base_loss: 0.186749    reg_loss: 0.050036    l2_loss: 0.022954    loss: 0.259739
steps 6000    v_Prec: 0.751530  v_Recall: 0.676083  v_F1: 0.711813  v_AUC: 0.903393
steps 6000    running time 256 seconds

steps 6200    base_loss: 0.182333    reg_loss: 0.049705    l2_loss: 0.023599    loss: 0.255637
steps 6200    v_Prec: 0.772055  v_Recall: 0.666268  v_F1: 0.715271  v_AUC: 0.903904
steps 6200    running time 263 seconds

steps 6400    base_loss: 0.181584    reg_loss: 0.049456    l2_loss: 0.023937    loss: 0.254978
steps 6400    v_Prec: 0.748711  v_Recall: 0.683824  v_F1: 0.714798  v_AUC: 0.904326
steps 6400    running time 271 seconds

steps 6600    base_loss: 0.175649    reg_loss: 0.048824    l2_loss: 0.024321    loss: 0.248793
steps 6600    v_Prec: 0.750239  v_Recall: 0.688213  v_F1: 0.717889  v_AUC: 0.904810
steps 6600    running time 278 seconds

steps 6800    base_loss: 0.191293    reg_loss: 0.049015    l2_loss: 0.024775    loss: 0.265084
steps 6800    v_Prec: 0.770474  v_Recall: 0.669699  v_F1: 0.716561  v_AUC: 0.905048
steps 6800    running time 285 seconds

steps 7000    base_loss: 0.184792    reg_loss: 0.049056    l2_loss: 0.025066    loss: 0.258914
steps 7000    v_Prec: 0.773778  v_Recall: 0.670657  v_F1: 0.718536  v_AUC: 0.905912
steps 7000    running time 292 seconds

steps 7200    base_loss: 0.186748    reg_loss: 0.048944    l2_loss: 0.025345    loss: 0.261038
steps 7200    v_Prec: 0.761584  v_Recall: 0.676802  v_F1: 0.716694  v_AUC: 0.905547
steps 7200    running time 299 seconds

steps 7400    base_loss: 0.193948    reg_loss: 0.048783    l2_loss: 0.025678    loss: 0.268409
steps 7400    v_Prec: 0.791456  v_Recall: 0.660841  v_F1: 0.720275  v_AUC: 0.906013
steps 7400    running time 305 seconds

steps 7600    base_loss: 0.187608    reg_loss: 0.048348    l2_loss: 0.025970    loss: 0.261927
steps 7600    v_Prec: 0.773251  v_Recall: 0.675445  v_F1: 0.721046  v_AUC: 0.907470
steps 7600    running time 313 seconds

steps 7800    base_loss: 0.196186    reg_loss: 0.048351    l2_loss: 0.026054    loss: 0.270591
steps 7800    v_Prec: 0.781143  v_Recall: 0.673051  v_F1: 0.723080  v_AUC: 0.908772
steps 7800    running time 320 seconds

steps 8000    base_loss: 0.186983    reg_loss: 0.048123    l2_loss: 0.026254    loss: 0.261361
steps 8000    v_Prec: 0.780375  v_Recall: 0.684782  v_F1: 0.729460  v_AUC: 0.911618
steps 8000    running time 327 seconds

steps 8200    base_loss: 0.184126    reg_loss: 0.047973    l2_loss: 0.026454    loss: 0.258554
steps 8200    v_Prec: 0.787309  v_Recall: 0.675285  v_F1: 0.727007  v_AUC: 0.912390
steps 8200    running time 335 seconds

steps 8400    base_loss: 0.186551    reg_loss: 0.047605    l2_loss: 0.026553    loss: 0.260708
steps 8400    v_Prec: 0.773270  v_Recall: 0.692124  v_F1: 0.730450  v_AUC: 0.913122
steps 8400    running time 342 seconds

steps 8600    base_loss: 0.187681    reg_loss: 0.047630    l2_loss: 0.026799    loss: 0.262110
steps 8600    v_Prec: 0.767381  v_Recall: 0.697630  v_F1: 0.730845  v_AUC: 0.913803
steps 8600    running time 350 seconds

steps 8800    base_loss: 0.184110    reg_loss: 0.047360    l2_loss: 0.026838    loss: 0.258309
steps 8800    v_Prec: 0.791013  v_Recall: 0.684143  v_F1: 0.733707  v_AUC: 0.915501
steps 8800    running time 358 seconds

steps 9000    base_loss: 0.191339    reg_loss: 0.047557    l2_loss: 0.027007    loss: 0.265903
steps 9000    v_Prec: 0.766831  v_Recall: 0.706249  v_F1: 0.735294  v_AUC: 0.915396
steps 9000    running time 365 seconds

steps 9200    base_loss: 0.193202    reg_loss: 0.047243    l2_loss: 0.027086    loss: 0.267531
steps 9200    v_Prec: 0.781820  v_Recall: 0.694597  v_F1: 0.735632  v_AUC: 0.916776
steps 9200    running time 374 seconds

steps 9400    base_loss: 0.187031    reg_loss: 0.047068    l2_loss: 0.027197    loss: 0.261296
steps 9400    v_Prec: 0.782263  v_Recall: 0.706727  v_F1: 0.742579  v_AUC: 0.918943
steps 9400    running time 381 seconds

steps 9600    base_loss: 0.185767    reg_loss: 0.046903    l2_loss: 0.027267    loss: 0.259937
steps 9600    v_Prec: 0.789121  v_Recall: 0.703854  v_F1: 0.744053  v_AUC: 0.920498
steps 9600    running time 389 seconds

steps 9800    base_loss: 0.187401    reg_loss: 0.046901    l2_loss: 0.027474    loss: 0.261776
steps 9800    v_Prec: 0.782984  v_Recall: 0.709441  v_F1: 0.744400  v_AUC: 0.919821
steps 9800    running time 396 seconds

steps 10000    base_loss: 0.185529    reg_loss: 0.046540    l2_loss: 0.027454    loss: 0.259523
steps 10000    v_Prec: 0.793719  v_Recall: 0.705929  v_F1: 0.747255  v_AUC: 0.921238
steps 10000    running time 403 seconds

steps 10200    base_loss: 0.186923    reg_loss: 0.046558    l2_loss: 0.027484    loss: 0.260964
steps 10200    v_Prec: 0.774599  v_Recall: 0.717421  v_F1: 0.744914  v_AUC: 0.921446
steps 10200    running time 411 seconds

steps 10400    base_loss: 0.192031    reg_loss: 0.046611    l2_loss: 0.027570    loss: 0.266212
steps 10400    v_Prec: 0.776877  v_Recall: 0.718538  v_F1: 0.746569  v_AUC: 0.922494
steps 10400    running time 417 seconds

steps 10600    base_loss: 0.186629    reg_loss: 0.046600    l2_loss: 0.027486    loss: 0.260715
steps 10600    v_Prec: 0.781432  v_Recall: 0.718698  v_F1: 0.748753  v_AUC: 0.923625
steps 10600    running time 424 seconds

steps 10800    base_loss: 0.176404    reg_loss: 0.046114    l2_loss: 0.027606    loss: 0.250124
steps 10800    v_Prec: 0.788220  v_Recall: 0.715506  v_F1: 0.750105  v_AUC: 0.923823
steps 10800    running time 431 seconds

steps 11000    base_loss: 0.073805    reg_loss: 0.042029    l2_loss: 0.027587    loss: 0.143421
steps 11000    v_Prec: 0.786627  v_Recall: 0.717261  v_F1: 0.750344  v_AUC: 0.923490
steps 11000    running time 439 seconds

steps 11200    base_loss: 0.067618    reg_loss: 0.041879    l2_loss: 0.027342    loss: 0.136838
steps 11200    v_Prec: 0.788577  v_Recall: 0.712872  v_F1: 0.748816  v_AUC: 0.922262
steps 11200    running time 446 seconds

steps 11400    base_loss: 0.072411    reg_loss: 0.042332    l2_loss: 0.027368    loss: 0.142112
steps 11400    v_Prec: 0.789863  v_Recall: 0.706408  v_F1: 0.745808  v_AUC: 0.919903
steps 11400    running time 453 seconds

steps 11600    base_loss: 0.077440    reg_loss: 0.042350    l2_loss: 0.027259    loss: 0.147049
steps 11600    v_Prec: 0.791891  v_Recall: 0.702977  v_F1: 0.744790  v_AUC: 0.917241
steps 11600    running time 460 seconds

steps 11800    base_loss: 0.075356    reg_loss: 0.042398    l2_loss: 0.027255    loss: 0.145009
steps 11800    v_Prec: 0.785379  v_Recall: 0.708164  v_F1: 0.744775  v_AUC: 0.918721
steps 11800    running time 467 seconds

steps 12000    base_loss: 0.073813    reg_loss: 0.042211    l2_loss: 0.027216    loss: 0.143240
steps 12000    v_Prec: 0.794456  v_Recall: 0.699864  v_F1: 0.744166  v_AUC: 0.917533
steps 12000    running time 474 seconds

steps 12200    base_loss: 0.076478    reg_loss: 0.042453    l2_loss: 0.027155    loss: 0.146086
steps 12200    v_Prec: 0.795870  v_Recall: 0.695076  v_F1: 0.742066  v_AUC: 0.918275
steps 12200    running time 481 seconds

steps 12400    base_loss: 0.077452    reg_loss: 0.042612    l2_loss: 0.027159    loss: 0.147222
steps 12400    v_Prec: 0.783789  v_Recall: 0.707605  v_F1: 0.743751  v_AUC: 0.919304
steps 12400    running time 488 seconds

steps 12600    base_loss: 0.081406    reg_loss: 0.042583    l2_loss: 0.027179    loss: 0.151168
steps 12600    v_Prec: 0.784422  v_Recall: 0.705610  v_F1: 0.742932  v_AUC: 0.918956
steps 12600    running time 494 seconds

steps 12800    base_loss: 0.081065    reg_loss: 0.042639    l2_loss: 0.027245    loss: 0.150949
steps 12800    v_Prec: 0.788003  v_Recall: 0.704493  v_F1: 0.743912  v_AUC: 0.916779
steps 12800    running time 501 seconds

steps 13000    base_loss: 0.082049    reg_loss: 0.042775    l2_loss: 0.027292    loss: 0.152116
steps 13000    v_Prec: 0.784888  v_Recall: 0.709600  v_F1: 0.745348  v_AUC: 0.917131
steps 13000    running time 507 seconds

Early stop model F1: 0.750344
testing thre: 0.43420222
testing Prec: 0.5629178480170814
testing Recall: 0.7816281895504252
testing F1: 0.6544847794237343
testing AUC: 0.9090657854587723
overall running time 510 seconds
(0.7626148089352535, 0.6537545565006075, 0.7040012561170282, 0.9090657854587723, 0.8812172)

2019-02-24 02:47:33.337429: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:47:34.085545: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:47:34.095936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:47:34.096019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.370000 seconds
loading data in 30.530000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.539204    reg_loss: 0.064705    l2_loss: 0.013369    loss: 0.617277
steps 200    v_Prec: 0.166774  v_Recall: 0.994041  v_F1: 0.285627  v_AUC: 0.512268
steps 200    running time 41 seconds

steps 400    base_loss: 0.487095    reg_loss: 0.064492    l2_loss: 0.013343    loss: 0.564930
steps 400    v_Prec: 0.174127  v_Recall: 0.871962  v_F1: 0.290286  v_AUC: 0.538569
steps 400    running time 49 seconds

steps 600    base_loss: 0.481017    reg_loss: 0.064403    l2_loss: 0.013327    loss: 0.558748
steps 600    v_Prec: 0.179073  v_Recall: 0.849381  v_F1: 0.295786  v_AUC: 0.561716
steps 600    running time 57 seconds

steps 800    base_loss: 0.464888    reg_loss: 0.064001    l2_loss: 0.013192    loss: 0.542081
steps 800    v_Prec: 0.185883  v_Recall: 0.775757  v_F1: 0.299905  v_AUC: 0.578271
steps 800    running time 65 seconds

steps 1000    base_loss: 0.455827    reg_loss: 0.063767    l2_loss: 0.013096    loss: 0.532691
steps 1000    v_Prec: 0.226705  v_Recall: 0.583346  v_F1: 0.326516  v_AUC: 0.635355
steps 1000    running time 72 seconds

steps 1200    base_loss: 0.430123    reg_loss: 0.063274    l2_loss: 0.013131    loss: 0.506529
steps 1200    v_Prec: 0.399082  v_Recall: 0.415948  v_F1: 0.407341  v_AUC: 0.704877
steps 1200    running time 80 seconds

steps 1400    base_loss: 0.401913    reg_loss: 0.062760    l2_loss: 0.013262    loss: 0.477935
steps 1400    v_Prec: 0.454663  v_Recall: 0.470205  v_F1: 0.462303  v_AUC: 0.749755
steps 1400    running time 87 seconds

steps 1600    base_loss: 0.373371    reg_loss: 0.062150    l2_loss: 0.013365    loss: 0.448886
steps 1600    v_Prec: 0.519624  v_Recall: 0.506586  v_F1: 0.513022  v_AUC: 0.786893
steps 1600    running time 94 seconds

steps 1800    base_loss: 0.349025    reg_loss: 0.061541    l2_loss: 0.013462    loss: 0.424027
steps 1800    v_Prec: 0.572475  v_Recall: 0.520856  v_F1: 0.545447  v_AUC: 0.809781
steps 1800    running time 101 seconds

steps 2000    base_loss: 0.344665    reg_loss: 0.061074    l2_loss: 0.013588    loss: 0.419328
steps 2000    v_Prec: 0.612329  v_Recall: 0.549867  v_F1: 0.579419  v_AUC: 0.828861
steps 2000    running time 109 seconds

steps 2200    base_loss: 0.324638    reg_loss: 0.060509    l2_loss: 0.013673    loss: 0.398820
steps 2200    v_Prec: 0.597362  v_Recall: 0.592912  v_F1: 0.595128  v_AUC: 0.841433
steps 2200    running time 116 seconds

steps 2400    base_loss: 0.315494    reg_loss: 0.060278    l2_loss: 0.013917    loss: 0.389690
steps 2400    v_Prec: 0.623528  v_Recall: 0.593853  v_F1: 0.608329  v_AUC: 0.851777
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.309133    reg_loss: 0.059654    l2_loss: 0.014051    loss: 0.382837
steps 2600    v_Prec: 0.633676  v_Recall: 0.623491  v_F1: 0.628542  v_AUC: 0.863301
steps 2600    running time 131 seconds

steps 2800    base_loss: 0.296256    reg_loss: 0.059164    l2_loss: 0.014274    loss: 0.369694
steps 2800    v_Prec: 0.688083  v_Recall: 0.601223  v_F1: 0.641727  v_AUC: 0.871050
steps 2800    running time 138 seconds

steps 3000    base_loss: 0.289394    reg_loss: 0.058949    l2_loss: 0.014595    loss: 0.362938
steps 3000    v_Prec: 0.678270  v_Recall: 0.635565  v_F1: 0.656223  v_AUC: 0.877351
steps 3000    running time 146 seconds

steps 3200    base_loss: 0.282361    reg_loss: 0.058881    l2_loss: 0.014922    loss: 0.356164
steps 3200    v_Prec: 0.742071  v_Recall: 0.596205  v_F1: 0.661189  v_AUC: 0.880434
steps 3200    running time 154 seconds

steps 3400    base_loss: 0.284848    reg_loss: 0.058617    l2_loss: 0.015325    loss: 0.358790
steps 3400    v_Prec: 0.726904  v_Recall: 0.618786  v_F1: 0.668502  v_AUC: 0.883288
steps 3400    running time 161 seconds

steps 3600    base_loss: 0.278039    reg_loss: 0.058472    l2_loss: 0.015743    loss: 0.352255
steps 3600    v_Prec: 0.725439  v_Recall: 0.634546  v_F1: 0.676955  v_AUC: 0.888293
steps 3600    running time 169 seconds

steps 3800    base_loss: 0.274694    reg_loss: 0.058429    l2_loss: 0.016179    loss: 0.349301
steps 3800    v_Prec: 0.740088  v_Recall: 0.635173  v_F1: 0.683629  v_AUC: 0.891467
steps 3800    running time 176 seconds

steps 4000    base_loss: 0.266450    reg_loss: 0.058115    l2_loss: 0.016608    loss: 0.341172
steps 4000    v_Prec: 0.742212  v_Recall: 0.644504  v_F1: 0.689916  v_AUC: 0.893120
steps 4000    running time 184 seconds

steps 4200    base_loss: 0.272605    reg_loss: 0.058034    l2_loss: 0.016968    loss: 0.347607
steps 4200    v_Prec: 0.744491  v_Recall: 0.646307  v_F1: 0.691933  v_AUC: 0.894755
steps 4200    running time 191 seconds

steps 4400    base_loss: 0.270719    reg_loss: 0.057688    l2_loss: 0.017406    loss: 0.345812
steps 4400    v_Prec: 0.746993  v_Recall: 0.647718  v_F1: 0.693823  v_AUC: 0.896596
steps 4400    running time 198 seconds

steps 4600    base_loss: 0.265198    reg_loss: 0.057469    l2_loss: 0.017884    loss: 0.340552
steps 4600    v_Prec: 0.765657  v_Recall: 0.646072  v_F1: 0.700799  v_AUC: 0.899400
steps 4600    running time 205 seconds

steps 4800    base_loss: 0.257406    reg_loss: 0.057122    l2_loss: 0.018315    loss: 0.332843
steps 4800    v_Prec: 0.754236  v_Recall: 0.656186  v_F1: 0.701803  v_AUC: 0.899193
steps 4800    running time 212 seconds

steps 5000    base_loss: 0.262036    reg_loss: 0.056782    l2_loss: 0.018765    loss: 0.337584
steps 5000    v_Prec: 0.757511  v_Recall: 0.662302  v_F1: 0.706714  v_AUC: 0.901524
steps 5000    running time 220 seconds

steps 5200    base_loss: 0.252151    reg_loss: 0.056655    l2_loss: 0.019213    loss: 0.328019
steps 5200    v_Prec: 0.761289  v_Recall: 0.668888  v_F1: 0.712104  v_AUC: 0.903463
steps 5200    running time 227 seconds

steps 5400    base_loss: 0.249858    reg_loss: 0.056022    l2_loss: 0.019576    loss: 0.325456
steps 5400    v_Prec: 0.754504  v_Recall: 0.676415  v_F1: 0.713329  v_AUC: 0.904552
steps 5400    running time 235 seconds

steps 5600    base_loss: 0.165658    reg_loss: 0.052078    l2_loss: 0.020018    loss: 0.237754
steps 5600    v_Prec: 0.757756  v_Recall: 0.668339  v_F1: 0.710245  v_AUC: 0.901759
steps 5600    running time 242 seconds

steps 5800    base_loss: 0.158504    reg_loss: 0.051813    l2_loss: 0.020670    loss: 0.230987
steps 5800    v_Prec: 0.761823  v_Recall: 0.661832  v_F1: 0.708316  v_AUC: 0.901032
steps 5800    running time 249 seconds

steps 6000    base_loss: 0.172742    reg_loss: 0.052078    l2_loss: 0.021283    loss: 0.246103
steps 6000    v_Prec: 0.754529  v_Recall: 0.676023  v_F1: 0.713122  v_AUC: 0.902583
steps 6000    running time 256 seconds

steps 6200    base_loss: 0.167254    reg_loss: 0.051719    l2_loss: 0.021878    loss: 0.240851
steps 6200    v_Prec: 0.764174  v_Recall: 0.668967  v_F1: 0.713408  v_AUC: 0.901644
steps 6200    running time 263 seconds

steps 6400    base_loss: 0.174239    reg_loss: 0.051658    l2_loss: 0.022481    loss: 0.248378
steps 6400    v_Prec: 0.760854  v_Recall: 0.673279  v_F1: 0.714393  v_AUC: 0.902675
steps 6400    running time 270 seconds

steps 6600    base_loss: 0.168328    reg_loss: 0.051462    l2_loss: 0.022830    loss: 0.242620
steps 6600    v_Prec: 0.753812  v_Recall: 0.682296  v_F1: 0.716273  v_AUC: 0.903484
steps 6600    running time 278 seconds

steps 6800    base_loss: 0.166318    reg_loss: 0.051310    l2_loss: 0.023346    loss: 0.240974
steps 6800    v_Prec: 0.751876  v_Recall: 0.683550  v_F1: 0.716087  v_AUC: 0.903990
steps 6800    running time 286 seconds

steps 7000    base_loss: 0.174717    reg_loss: 0.051221    l2_loss: 0.023749    loss: 0.249686
steps 7000    v_Prec: 0.752396  v_Recall: 0.689274  v_F1: 0.719453  v_AUC: 0.904607
steps 7000    running time 292 seconds

steps 7200    base_loss: 0.171400    reg_loss: 0.050751    l2_loss: 0.023901    loss: 0.246051
steps 7200    v_Prec: 0.765702  v_Recall: 0.684413  v_F1: 0.722779  v_AUC: 0.907712
steps 7200    running time 299 seconds

steps 7400    base_loss: 0.176401    reg_loss: 0.050751    l2_loss: 0.024303    loss: 0.251455
steps 7400    v_Prec: 0.770115  v_Recall: 0.682923  v_F1: 0.723903  v_AUC: 0.906517
steps 7400    running time 307 seconds

steps 7600    base_loss: 0.182932    reg_loss: 0.050754    l2_loss: 0.024456    loss: 0.258142
steps 7600    v_Prec: 0.769956  v_Recall: 0.685197  v_F1: 0.725108  v_AUC: 0.907892
steps 7600    running time 315 seconds

steps 7800    base_loss: 0.183126    reg_loss: 0.050820    l2_loss: 0.024614    loss: 0.258560
steps 7800    v_Prec: 0.782578  v_Recall: 0.686059  v_F1: 0.731147  v_AUC: 0.911632
steps 7800    running time 322 seconds

steps 8000    base_loss: 0.184792    reg_loss: 0.050564    l2_loss: 0.024757    loss: 0.260113
steps 8000    v_Prec: 0.772831  v_Recall: 0.688725  v_F1: 0.728358  v_AUC: 0.911158
steps 8000    running time 329 seconds

steps 8200    base_loss: 0.181214    reg_loss: 0.050286    l2_loss: 0.024914    loss: 0.256414
steps 8200    v_Prec: 0.775154  v_Recall: 0.689823  v_F1: 0.730003  v_AUC: 0.912603
steps 8200    running time 336 seconds

steps 8400    base_loss: 0.174136    reg_loss: 0.049946    l2_loss: 0.025277    loss: 0.249359
steps 8400    v_Prec: 0.771238  v_Recall: 0.699702  v_F1: 0.733731  v_AUC: 0.914885
steps 8400    running time 343 seconds

steps 8600    base_loss: 0.185968    reg_loss: 0.049916    l2_loss: 0.025277    loss: 0.261161
steps 8600    v_Prec: 0.771925  v_Recall: 0.703230  v_F1: 0.735978  v_AUC: 0.915884
steps 8600    running time 351 seconds

steps 8800    base_loss: 0.184335    reg_loss: 0.050033    l2_loss: 0.025355    loss: 0.259723
steps 8800    v_Prec: 0.791836  v_Recall: 0.687471  v_F1: 0.735972  v_AUC: 0.915649
steps 8800    running time 359 seconds

steps 9000    base_loss: 0.187566    reg_loss: 0.049884    l2_loss: 0.025493    loss: 0.262943
steps 9000    v_Prec: 0.784055  v_Recall: 0.698604  v_F1: 0.738867  v_AUC: 0.917889
steps 9000    running time 366 seconds

steps 9200    base_loss: 0.184460    reg_loss: 0.049623    l2_loss: 0.025622    loss: 0.259705
steps 9200    v_Prec: 0.789693  v_Recall: 0.699232  v_F1: 0.741714  v_AUC: 0.919534
steps 9200    running time 373 seconds

steps 9400    base_loss: 0.178037    reg_loss: 0.049246    l2_loss: 0.025672    loss: 0.252956
steps 9400    v_Prec: 0.798641  v_Recall: 0.690999  v_F1: 0.740931  v_AUC: 0.919633
steps 9400    running time 381 seconds

steps 9600    base_loss: 0.173074    reg_loss: 0.049435    l2_loss: 0.025748    loss: 0.248257
steps 9600    v_Prec: 0.801144  v_Recall: 0.692097  v_F1: 0.742638  v_AUC: 0.919972
steps 9600    running time 387 seconds

steps 9800    base_loss: 0.178678    reg_loss: 0.049483    l2_loss: 0.025845    loss: 0.254006
steps 9800    v_Prec: 0.797028  v_Recall: 0.702289  v_F1: 0.746666  v_AUC: 0.921591
steps 9800    running time 395 seconds

steps 10000    base_loss: 0.177568    reg_loss: 0.049422    l2_loss: 0.025918    loss: 0.252909
steps 10000    v_Prec: 0.800699  v_Recall: 0.700251  v_F1: 0.747114  v_AUC: 0.922672
steps 10000    running time 402 seconds

steps 10200    base_loss: 0.181842    reg_loss: 0.049189    l2_loss: 0.025993    loss: 0.257024
steps 10200    v_Prec: 0.789671  v_Recall: 0.710914  v_F1: 0.748226  v_AUC: 0.923539
steps 10200    running time 409 seconds

steps 10400    base_loss: 0.176432    reg_loss: 0.049277    l2_loss: 0.026087    loss: 0.251796
steps 10400    v_Prec: 0.785863  v_Recall: 0.712169  v_F1: 0.747203  v_AUC: 0.923410
steps 10400    running time 417 seconds

steps 10600    base_loss: 0.176029    reg_loss: 0.049016    l2_loss: 0.026042    loss: 0.251087
steps 10600    v_Prec: 0.806080  v_Recall: 0.702682  v_F1: 0.750838  v_AUC: 0.924899
steps 10600    running time 423 seconds

steps 10800    base_loss: 0.166899    reg_loss: 0.048520    l2_loss: 0.026249    loss: 0.241668
steps 10800    v_Prec: 0.794908  v_Recall: 0.714756  v_F1: 0.752704  v_AUC: 0.925776
steps 10800    running time 431 seconds

steps 11000    base_loss: 0.064690    reg_loss: 0.043837    l2_loss: 0.026222    loss: 0.134749
steps 11000    v_Prec: 0.794182  v_Recall: 0.710679  v_F1: 0.750114  v_AUC: 0.924678
steps 11000    running time 438 seconds

steps 11200    base_loss: 0.059005    reg_loss: 0.043743    l2_loss: 0.025945    loss: 0.128693
steps 11200    v_Prec: 0.807762  v_Recall: 0.695154  v_F1: 0.747240  v_AUC: 0.923022
steps 11200    running time 445 seconds

steps 11400    base_loss: 0.060073    reg_loss: 0.043613    l2_loss: 0.025793    loss: 0.129478
steps 11400    v_Prec: 0.789571  v_Recall: 0.704014  v_F1: 0.744342  v_AUC: 0.920834
steps 11400    running time 452 seconds

steps 11600    base_loss: 0.059256    reg_loss: 0.043673    l2_loss: 0.025808    loss: 0.128737
steps 11600    v_Prec: 0.803964  v_Recall: 0.693273  v_F1: 0.744527  v_AUC: 0.920263
steps 11600    running time 459 seconds

steps 11800    base_loss: 0.065427    reg_loss: 0.043683    l2_loss: 0.025711    loss: 0.134821
steps 11800    v_Prec: 0.794294  v_Recall: 0.696331  v_F1: 0.742093  v_AUC: 0.920105
steps 11800    running time 465 seconds

steps 12000    base_loss: 0.061868    reg_loss: 0.043981    l2_loss: 0.025628    loss: 0.131477
steps 12000    v_Prec: 0.796886  v_Recall: 0.694292  v_F1: 0.742060  v_AUC: 0.919710
steps 12000    running time 472 seconds

steps 12200    base_loss: 0.062305    reg_loss: 0.043620    l2_loss: 0.025615    loss: 0.131541
steps 12200    v_Prec: 0.796233  v_Recall: 0.692724  v_F1: 0.740881  v_AUC: 0.919991
steps 12200    running time 479 seconds

steps 12400    base_loss: 0.060822    reg_loss: 0.043876    l2_loss: 0.025566    loss: 0.130264
steps 12400    v_Prec: 0.790898  v_Recall: 0.698996  v_F1: 0.742113  v_AUC: 0.922158
steps 12400    running time 486 seconds

steps 12600    base_loss: 0.066852    reg_loss: 0.043771    l2_loss: 0.025418    loss: 0.136041
steps 12600    v_Prec: 0.799004  v_Recall: 0.691626  v_F1: 0.741447  v_AUC: 0.919529
steps 12600    running time 493 seconds

steps 12800    base_loss: 0.064431    reg_loss: 0.043622    l2_loss: 0.025407    loss: 0.133461
steps 12800    v_Prec: 0.778935  v_Recall: 0.709738  v_F1: 0.742728  v_AUC: 0.920898
steps 12800    running time 499 seconds

Early stop model F1: 0.752704
testing thre: 0.49017546
testing Prec: 0.5828140250769577
testing Recall: 0.7545565006075334
testing F1: 0.6576578484739374
testing AUC: 0.904373874530031
overall running time 502 seconds
(0.7364544115239811, 0.6559902794653706, 0.6938974859904374, 0.904373874530031, 0.78409785)

2019-02-24 02:53:49.803766: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:53:51.129335: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:53:51.130250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:11.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:53:51.130285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:11.0, compute capability: 6.1)
user_feat_size is 11, in 24.000000 seconds
loading data in 30.080000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	112
action_feat_size 	1
cuda_devices 	7
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.680905    reg_loss: 0.064801    l2_loss: 0.013362    loss: 0.759068
steps 200    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.489486
steps 200    running time 42 seconds

steps 400    base_loss: 0.598577    reg_loss: 0.064447    l2_loss: 0.013236    loss: 0.676260
steps 400    v_Prec: 0.163983  v_Recall: 1.000000  v_F1: 0.281762  v_AUC: 0.487610
steps 400    running time 50 seconds

steps 600    base_loss: 0.526561    reg_loss: 0.064272    l2_loss: 0.012837    loss: 0.603670
steps 600    v_Prec: 0.179141  v_Recall: 0.704647  v_F1: 0.285659  v_AUC: 0.563686
steps 600    running time 56 seconds

steps 800    base_loss: 0.489943    reg_loss: 0.064590    l2_loss: 0.012442    loss: 0.566975
steps 800    v_Prec: 0.217855  v_Recall: 0.469685  v_F1: 0.297650  v_AUC: 0.597452
steps 800    running time 64 seconds

steps 1000    base_loss: 0.445477    reg_loss: 0.065291    l2_loss: 0.012376    loss: 0.523144
steps 1000    v_Prec: 0.318738  v_Recall: 0.412397  v_F1: 0.359568  v_AUC: 0.673911
steps 1000    running time 71 seconds

steps 1200    base_loss: 0.420356    reg_loss: 0.065673    l2_loss: 0.012387    loss: 0.498416
steps 1200    v_Prec: 0.410363  v_Recall: 0.423456  v_F1: 0.416807  v_AUC: 0.723105
steps 1200    running time 78 seconds

steps 1400    base_loss: 0.403211    reg_loss: 0.065982    l2_loss: 0.012451    loss: 0.481645
steps 1400    v_Prec: 0.501736  v_Recall: 0.436983  v_F1: 0.467126  v_AUC: 0.759089
steps 1400    running time 86 seconds

steps 1600    base_loss: 0.377997    reg_loss: 0.066169    l2_loss: 0.012476    loss: 0.456642
steps 1600    v_Prec: 0.495911  v_Recall: 0.501750  v_F1: 0.498813  v_AUC: 0.786429
steps 1600    running time 93 seconds

steps 1800    base_loss: 0.356442    reg_loss: 0.066348    l2_loss: 0.012598    loss: 0.435388
steps 1800    v_Prec: 0.558499  v_Recall: 0.508195  v_F1: 0.532161  v_AUC: 0.808666
steps 1800    running time 100 seconds

steps 2000    base_loss: 0.336857    reg_loss: 0.066751    l2_loss: 0.012788    loss: 0.416395
steps 2000    v_Prec: 0.640537  v_Recall: 0.505172  v_F1: 0.564858  v_AUC: 0.825324
steps 2000    running time 108 seconds

steps 2200    base_loss: 0.329900    reg_loss: 0.067007    l2_loss: 0.013042    loss: 0.409949
steps 2200    v_Prec: 0.651399  v_Recall: 0.529599  v_F1: 0.584218  v_AUC: 0.841225
steps 2200    running time 115 seconds

steps 2400    base_loss: 0.314786    reg_loss: 0.067129    l2_loss: 0.013328    loss: 0.395243
steps 2400    v_Prec: 0.683172  v_Recall: 0.540102  v_F1: 0.603271  v_AUC: 0.851155
steps 2400    running time 123 seconds

steps 2600    base_loss: 0.299935    reg_loss: 0.067410    l2_loss: 0.013704    loss: 0.381050
steps 2600    v_Prec: 0.690812  v_Recall: 0.556970  v_F1: 0.616713  v_AUC: 0.860108
steps 2600    running time 130 seconds

steps 2800    base_loss: 0.301235    reg_loss: 0.067678    l2_loss: 0.014100    loss: 0.383013
steps 2800    v_Prec: 0.709031  v_Recall: 0.565961  v_F1: 0.629469  v_AUC: 0.867882
steps 2800    running time 138 seconds

steps 3000    base_loss: 0.291886    reg_loss: 0.067772    l2_loss: 0.014470    loss: 0.374128
steps 3000    v_Prec: 0.697879  v_Recall: 0.581158  v_F1: 0.634193  v_AUC: 0.869677
steps 3000    running time 145 seconds

steps 3200    base_loss: 0.288016    reg_loss: 0.067824    l2_loss: 0.014870    loss: 0.370710
steps 3200    v_Prec: 0.694844  v_Recall: 0.591900  v_F1: 0.639254  v_AUC: 0.873769
steps 3200    running time 153 seconds

steps 3400    base_loss: 0.288383    reg_loss: 0.067862    l2_loss: 0.015320    loss: 0.371564
steps 3400    v_Prec: 0.724246  v_Recall: 0.590150  v_F1: 0.650357  v_AUC: 0.880473
steps 3400    running time 160 seconds

steps 3600    base_loss: 0.280119    reg_loss: 0.068019    l2_loss: 0.015783    loss: 0.363921
steps 3600    v_Prec: 0.733627  v_Recall: 0.596276  v_F1: 0.657859  v_AUC: 0.883140
steps 3600    running time 168 seconds

steps 3800    base_loss: 0.279612    reg_loss: 0.068161    l2_loss: 0.016176    loss: 0.363950
steps 3800    v_Prec: 0.752728  v_Recall: 0.587365  v_F1: 0.659844  v_AUC: 0.885537
steps 3800    running time 176 seconds

steps 4000    base_loss: 0.275424    reg_loss: 0.068132    l2_loss: 0.016593    loss: 0.360149
steps 4000    v_Prec: 0.714025  v_Recall: 0.623409  v_F1: 0.665647  v_AUC: 0.887053
steps 4000    running time 183 seconds

steps 4200    base_loss: 0.272634    reg_loss: 0.068039    l2_loss: 0.017088    loss: 0.357760
steps 4200    v_Prec: 0.737928  v_Recall: 0.611633  v_F1: 0.668871  v_AUC: 0.890474
steps 4200    running time 190 seconds

steps 4400    base_loss: 0.271323    reg_loss: 0.068240    l2_loss: 0.017617    loss: 0.357180
steps 4400    v_Prec: 0.743787  v_Recall: 0.616725  v_F1: 0.674323  v_AUC: 0.889936
steps 4400    running time 198 seconds

steps 4600    base_loss: 0.266304    reg_loss: 0.068171    l2_loss: 0.018047    loss: 0.352522
steps 4600    v_Prec: 0.725616  v_Recall: 0.627467  v_F1: 0.672982  v_AUC: 0.892447
steps 4600    running time 205 seconds

steps 4800    base_loss: 0.267905    reg_loss: 0.068225    l2_loss: 0.018583    loss: 0.354713
steps 4800    v_Prec: 0.761720  v_Recall: 0.608927  v_F1: 0.676807  v_AUC: 0.895190
steps 4800    running time 212 seconds

steps 5000    base_loss: 0.264319    reg_loss: 0.068036    l2_loss: 0.019205    loss: 0.351561
steps 5000    v_Prec: 0.771505  v_Recall: 0.618714  v_F1: 0.686713  v_AUC: 0.896298
steps 5000    running time 219 seconds

steps 5200    base_loss: 0.248945    reg_loss: 0.067806    l2_loss: 0.019859    loss: 0.336611
steps 5200    v_Prec: 0.767324  v_Recall: 0.625557  v_F1: 0.689226  v_AUC: 0.896873
steps 5200    running time 227 seconds

steps 5400    base_loss: 0.253808    reg_loss: 0.067856    l2_loss: 0.020424    loss: 0.342088
steps 5400    v_Prec: 0.767271  v_Recall: 0.632718  v_F1: 0.693529  v_AUC: 0.899077
steps 5400    running time 234 seconds

steps 5600    base_loss: 0.166121    reg_loss: 0.066248    l2_loss: 0.021034    loss: 0.253404
steps 5600    v_Prec: 0.760490  v_Recall: 0.627307  v_F1: 0.687508  v_AUC: 0.895310
steps 5600    running time 242 seconds

steps 5800    base_loss: 0.169548    reg_loss: 0.066331    l2_loss: 0.021718    loss: 0.257596
steps 5800    v_Prec: 0.762215  v_Recall: 0.623090  v_F1: 0.685667  v_AUC: 0.893061
steps 5800    running time 249 seconds

steps 6000    base_loss: 0.169264    reg_loss: 0.066212    l2_loss: 0.022537    loss: 0.258013
steps 6000    v_Prec: 0.747150  v_Recall: 0.625875  v_F1: 0.681157  v_AUC: 0.891950
steps 6000    running time 255 seconds

steps 6200    base_loss: 0.174384    reg_loss: 0.066315    l2_loss: 0.023140    loss: 0.263839
steps 6200    v_Prec: 0.739118  v_Recall: 0.640436  v_F1: 0.686248  v_AUC: 0.893558
steps 6200    running time 262 seconds

steps 6400    base_loss: 0.165988    reg_loss: 0.066327    l2_loss: 0.023700    loss: 0.256016
steps 6400    v_Prec: 0.744013  v_Recall: 0.637810  v_F1: 0.686831  v_AUC: 0.892311
steps 6400    running time 269 seconds

steps 6600    base_loss: 0.177176    reg_loss: 0.066332    l2_loss: 0.024261    loss: 0.267770
steps 6600    v_Prec: 0.767812  v_Recall: 0.629376  v_F1: 0.691736  v_AUC: 0.894190
steps 6600    running time 276 seconds

steps 6800    base_loss: 0.181168    reg_loss: 0.066521    l2_loss: 0.024784    loss: 0.272472
steps 6800    v_Prec: 0.789022  v_Recall: 0.622215  v_F1: 0.695760  v_AUC: 0.894603
steps 6800    running time 282 seconds

steps 7000    base_loss: 0.178540    reg_loss: 0.066221    l2_loss: 0.025308    loss: 0.270069
steps 7000    v_Prec: 0.774369  v_Recall: 0.632718  v_F1: 0.696414  v_AUC: 0.895580
steps 7000    running time 290 seconds

steps 7200    base_loss: 0.182855    reg_loss: 0.066475    l2_loss: 0.025789    loss: 0.275118
steps 7200    v_Prec: 0.789808  v_Recall: 0.632638  v_F1: 0.702540  v_AUC: 0.897377
steps 7200    running time 297 seconds

steps 7400    base_loss: 0.173634    reg_loss: 0.066065    l2_loss: 0.026137    loss: 0.265836
steps 7400    v_Prec: 0.796627  v_Recall: 0.631445  v_F1: 0.704483  v_AUC: 0.898517
steps 7400    running time 304 seconds

steps 7600    base_loss: 0.175800    reg_loss: 0.066086    l2_loss: 0.026527    loss: 0.268412
steps 7600    v_Prec: 0.792451  v_Recall: 0.636458  v_F1: 0.705939  v_AUC: 0.900419
steps 7600    running time 312 seconds

steps 7800    base_loss: 0.182312    reg_loss: 0.066242    l2_loss: 0.026663    loss: 0.275217
steps 7800    v_Prec: 0.763628  v_Recall: 0.666534  v_F1: 0.711785  v_AUC: 0.902161
steps 7800    running time 319 seconds

steps 8000    base_loss: 0.181879    reg_loss: 0.066251    l2_loss: 0.026961    loss: 0.275092
steps 8000    v_Prec: 0.793873  v_Recall: 0.653644  v_F1: 0.716966  v_AUC: 0.903062
steps 8000    running time 326 seconds

steps 8200    base_loss: 0.182150    reg_loss: 0.066356    l2_loss: 0.027323    loss: 0.275829
steps 8200    v_Prec: 0.785278  v_Recall: 0.664624  v_F1: 0.719931  v_AUC: 0.904636
steps 8200    running time 334 seconds

steps 8400    base_loss: 0.178337    reg_loss: 0.066220    l2_loss: 0.027563    loss: 0.272120
steps 8400    v_Prec: 0.797370  v_Recall: 0.660964  v_F1: 0.722788  v_AUC: 0.904909
steps 8400    running time 342 seconds

steps 8600    base_loss: 0.173892    reg_loss: 0.066177    l2_loss: 0.027845    loss: 0.267914
steps 8600    v_Prec: 0.796671  v_Recall: 0.666534  v_F1: 0.725816  v_AUC: 0.906701
steps 8600    running time 350 seconds

steps 8800    base_loss: 0.178317    reg_loss: 0.065877    l2_loss: 0.028020    loss: 0.272214
steps 8800    v_Prec: 0.802123  v_Recall: 0.667330  v_F1: 0.728544  v_AUC: 0.906901
steps 8800    running time 358 seconds

steps 9000    base_loss: 0.174310    reg_loss: 0.066118    l2_loss: 0.028174    loss: 0.268601
steps 9000    v_Prec: 0.808872  v_Recall: 0.663033  v_F1: 0.728728  v_AUC: 0.908568
steps 9000    running time 366 seconds

steps 9200    base_loss: 0.190501    reg_loss: 0.066171    l2_loss: 0.028273    loss: 0.284945
steps 9200    v_Prec: 0.801871  v_Recall: 0.675286  v_F1: 0.733155  v_AUC: 0.910991
steps 9200    running time 373 seconds

steps 9400    base_loss: 0.169683    reg_loss: 0.065725    l2_loss: 0.028532    loss: 0.263940
steps 9400    v_Prec: 0.817969  v_Recall: 0.667887  v_F1: 0.735348  v_AUC: 0.912029
steps 9400    running time 381 seconds

steps 9600    base_loss: 0.174967    reg_loss: 0.065951    l2_loss: 0.028716    loss: 0.269634
steps 9600    v_Prec: 0.829088  v_Recall: 0.670831  v_F1: 0.741611  v_AUC: 0.913275
steps 9600    running time 388 seconds

steps 9800    base_loss: 0.179553    reg_loss: 0.066089    l2_loss: 0.028966    loss: 0.274607
steps 9800    v_Prec: 0.823814  v_Recall: 0.678230  v_F1: 0.743967  v_AUC: 0.914995
steps 9800    running time 396 seconds

steps 10000    base_loss: 0.172430    reg_loss: 0.065858    l2_loss: 0.029014    loss: 0.267302
steps 10000    v_Prec: 0.822293  v_Recall: 0.678549  v_F1: 0.743537  v_AUC: 0.915136
steps 10000    running time 403 seconds

steps 10200    base_loss: 0.165507    reg_loss: 0.065705    l2_loss: 0.029057    loss: 0.260269
steps 10200    v_Prec: 0.833465  v_Recall: 0.672979  v_F1: 0.744673  v_AUC: 0.914459
steps 10200    running time 409 seconds

steps 10400    base_loss: 0.174031    reg_loss: 0.066029    l2_loss: 0.029285    loss: 0.269346
steps 10400    v_Prec: 0.845187  v_Recall: 0.668523  v_F1: 0.746546  v_AUC: 0.915936
steps 10400    running time 417 seconds

steps 10600    base_loss: 0.171525    reg_loss: 0.065808    l2_loss: 0.029365    loss: 0.266699
steps 10600    v_Prec: 0.834456  v_Recall: 0.680220  v_F1: 0.749485  v_AUC: 0.916408
steps 10600    running time 424 seconds

steps 10800    base_loss: 0.162100    reg_loss: 0.065539    l2_loss: 0.029467    loss: 0.257106
steps 10800    v_Prec: 0.855446  v_Recall: 0.676162  v_F1: 0.755311  v_AUC: 0.918038
steps 10800    running time 431 seconds

steps 11000    base_loss: 0.070234    reg_loss: 0.063360    l2_loss: 0.029471    loss: 0.163065
steps 11000    v_Prec: 0.816379  v_Recall: 0.681334  v_F1: 0.742768  v_AUC: 0.913223
steps 11000    running time 439 seconds

steps 11200    base_loss: 0.068239    reg_loss: 0.063160    l2_loss: 0.029250    loss: 0.160649
steps 11200    v_Prec: 0.816870  v_Recall: 0.675764  v_F1: 0.739647  v_AUC: 0.910460
steps 11200    running time 446 seconds

steps 11400    base_loss: 0.060448    reg_loss: 0.062897    l2_loss: 0.029162    loss: 0.152507
steps 11400    v_Prec: 0.821029  v_Recall: 0.671626  v_F1: 0.738851  v_AUC: 0.907162
steps 11400    running time 453 seconds

steps 11600    base_loss: 0.062199    reg_loss: 0.062890    l2_loss: 0.028903    loss: 0.153992
steps 11600    v_Prec: 0.835822  v_Recall: 0.659055  v_F1: 0.736987  v_AUC: 0.906518
steps 11600    running time 460 seconds

steps 11800    base_loss: 0.071193    reg_loss: 0.062926    l2_loss: 0.028872    loss: 0.162991
steps 11800    v_Prec: 0.831305  v_Recall: 0.657543  v_F1: 0.734284  v_AUC: 0.902665
steps 11800    running time 467 seconds

steps 12000    base_loss: 0.069751    reg_loss: 0.062795    l2_loss: 0.028773    loss: 0.161319
steps 12000    v_Prec: 0.828512  v_Recall: 0.663113  v_F1: 0.736642  v_AUC: 0.904480
steps 12000    running time 474 seconds

steps 12200    base_loss: 0.069617    reg_loss: 0.062775    l2_loss: 0.028754    loss: 0.161146
steps 12200    v_Prec: 0.827399  v_Recall: 0.665579  v_F1: 0.737719  v_AUC: 0.903941
steps 12200    running time 481 seconds

steps 12400    base_loss: 0.068986    reg_loss: 0.062399    l2_loss: 0.028635    loss: 0.160020
steps 12400    v_Prec: 0.837028  v_Recall: 0.657941  v_F1: 0.736758  v_AUC: 0.901683
steps 12400    running time 488 seconds

steps 12600    base_loss: 0.067263    reg_loss: 0.062842    l2_loss: 0.028557    loss: 0.158662
steps 12600    v_Prec: 0.829739  v_Recall: 0.667330  v_F1: 0.739725  v_AUC: 0.903155
steps 12600    running time 494 seconds

steps 12800    base_loss: 0.068347    reg_loss: 0.062561    l2_loss: 0.028619    loss: 0.159527
steps 12800    v_Prec: 0.820313  v_Recall: 0.670910  v_F1: 0.738128  v_AUC: 0.902341
steps 12800    running time 501 seconds

Early stop model F1: 0.755311
testing thre: 0.60382676
testing Prec: 0.6908252831854067
testing Recall: 0.6847144592952612
testing F1: 0.6877562975981253
testing AUC: 0.9010077182329045
overall running time 504 seconds
(0.7576951630403747, 0.6448602673147024, 0.6967389591976055, 0.9010077182329045, 0.7204169)

