2019-02-24 00:08:02.051760: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:08:03.046863: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:08:03.047776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:08:03.047812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.580000 seconds
loading data in 30.750000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.883887    reg_loss: 0.000000    l2_loss: 0.013308    loss: 0.897195
steps 200    v_Prec: 0.165917  v_Recall: 0.899139  v_F1: 0.280140  v_AUC: 0.541336
steps 200    running time 40 seconds

steps 400    base_loss: 0.600519    reg_loss: 0.000000    l2_loss: 0.013208    loss: 0.613727
steps 400    v_Prec: 0.172147  v_Recall: 0.837931  v_F1: 0.285616  v_AUC: 0.561551
steps 400    running time 47 seconds

steps 600    base_loss: 0.492517    reg_loss: 0.000000    l2_loss: 0.013184    loss: 0.505701
steps 600    v_Prec: 0.199321  v_Recall: 0.614092  v_F1: 0.300958  v_AUC: 0.598720
steps 600    running time 54 seconds

steps 800    base_loss: 0.469137    reg_loss: 0.000000    l2_loss: 0.013134    loss: 0.482271
steps 800    v_Prec: 0.237411  v_Recall: 0.535832  v_F1: 0.329036  v_AUC: 0.646537
steps 800    running time 61 seconds

steps 1000    base_loss: 0.446886    reg_loss: 0.000000    l2_loss: 0.013069    loss: 0.459955
steps 1000    v_Prec: 0.284558  v_Recall: 0.508968  v_F1: 0.365031  v_AUC: 0.690923
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.431851    reg_loss: 0.000000    l2_loss: 0.013077    loss: 0.444928
steps 1200    v_Prec: 0.374681  v_Recall: 0.472050  v_F1: 0.417767  v_AUC: 0.736069
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.410207    reg_loss: 0.000000    l2_loss: 0.013145    loss: 0.423351
steps 1400    v_Prec: 0.435113  v_Recall: 0.492158  v_F1: 0.461881  v_AUC: 0.768142
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.394357    reg_loss: 0.000000    l2_loss: 0.013256    loss: 0.407613
steps 1600    v_Prec: 0.488275  v_Recall: 0.519183  v_F1: 0.503255  v_AUC: 0.795807
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.364137    reg_loss: 0.000000    l2_loss: 0.013446    loss: 0.377582
steps 1800    v_Prec: 0.528766  v_Recall: 0.527065  v_F1: 0.527914  v_AUC: 0.813556
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.348212    reg_loss: 0.000000    l2_loss: 0.013665    loss: 0.361877
steps 2000    v_Prec: 0.600691  v_Recall: 0.517252  v_F1: 0.555858  v_AUC: 0.829022
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.332298    reg_loss: 0.000000    l2_loss: 0.013988    loss: 0.346286
steps 2200    v_Prec: 0.624965  v_Recall: 0.540014  v_F1: 0.579392  v_AUC: 0.844639
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.318888    reg_loss: 0.000000    l2_loss: 0.014335    loss: 0.333222
steps 2400    v_Prec: 0.632644  v_Recall: 0.565833  v_F1: 0.597376  v_AUC: 0.854299
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.310515    reg_loss: 0.000000    l2_loss: 0.014623    loss: 0.325138
steps 2600    v_Prec: 0.655606  v_Recall: 0.583206  v_F1: 0.617290  v_AUC: 0.861765
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.300981    reg_loss: 0.000000    l2_loss: 0.015043    loss: 0.316024
steps 2800    v_Prec: 0.728466  v_Recall: 0.548942  v_F1: 0.626089  v_AUC: 0.866763
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.303518    reg_loss: 0.000000    l2_loss: 0.015477    loss: 0.318995
steps 3000    v_Prec: 0.675131  v_Recall: 0.603072  v_F1: 0.637070  v_AUC: 0.871872
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.295695    reg_loss: 0.000000    l2_loss: 0.015821    loss: 0.311515
steps 3200    v_Prec: 0.682541  v_Recall: 0.614413  v_F1: 0.646688  v_AUC: 0.876748
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.287020    reg_loss: 0.000000    l2_loss: 0.016253    loss: 0.303274
steps 3400    v_Prec: 0.685747  v_Recall: 0.627282  v_F1: 0.655213  v_AUC: 0.879218
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.287155    reg_loss: 0.000000    l2_loss: 0.016621    loss: 0.303776
steps 3600    v_Prec: 0.716505  v_Recall: 0.604762  v_F1: 0.655908  v_AUC: 0.881866
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.279315    reg_loss: 0.000000    l2_loss: 0.016963    loss: 0.296278
steps 3800    v_Prec: 0.723097  v_Recall: 0.609105  v_F1: 0.661224  v_AUC: 0.881350
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.284602    reg_loss: 0.000000    l2_loss: 0.017437    loss: 0.302039
steps 4000    v_Prec: 0.727688  v_Recall: 0.627604  v_F1: 0.673951  v_AUC: 0.885101
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.277954    reg_loss: 0.000000    l2_loss: 0.017834    loss: 0.295788
steps 4200    v_Prec: 0.716204  v_Recall: 0.643449  v_F1: 0.677880  v_AUC: 0.889033
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.273666    reg_loss: 0.000000    l2_loss: 0.018187    loss: 0.291853
steps 4400    v_Prec: 0.727941  v_Recall: 0.645621  v_F1: 0.684314  v_AUC: 0.890872
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.263918    reg_loss: 0.000000    l2_loss: 0.018581    loss: 0.282499
steps 4600    v_Prec: 0.740589  v_Recall: 0.640875  v_F1: 0.687133  v_AUC: 0.892286
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.270305    reg_loss: 0.000000    l2_loss: 0.018975    loss: 0.289280
steps 4800    v_Prec: 0.721186  v_Recall: 0.665326  v_F1: 0.692131  v_AUC: 0.895946
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.266930    reg_loss: 0.000000    l2_loss: 0.019331    loss: 0.286261
steps 5000    v_Prec: 0.749702  v_Recall: 0.658168  v_F1: 0.700959  v_AUC: 0.898928
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.261694    reg_loss: 0.000000    l2_loss: 0.019683    loss: 0.281377
steps 5200    v_Prec: 0.749272  v_Recall: 0.662189  v_F1: 0.703044  v_AUC: 0.901692
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.251090    reg_loss: 0.000000    l2_loss: 0.019996    loss: 0.271085
steps 5400    v_Prec: 0.739253  v_Recall: 0.674978  v_F1: 0.705655  v_AUC: 0.902945
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.167036    reg_loss: 0.000000    l2_loss: 0.020551    loss: 0.187588
steps 5600    v_Prec: 0.748991  v_Recall: 0.642001  v_F1: 0.691382  v_AUC: 0.891323
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.170695    reg_loss: 0.000000    l2_loss: 0.021307    loss: 0.192003
steps 5800    v_Prec: 0.735361  v_Recall: 0.647470  v_F1: 0.688623  v_AUC: 0.887383
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.171076    reg_loss: 0.000000    l2_loss: 0.021912    loss: 0.192988
steps 6000    v_Prec: 0.732326  v_Recall: 0.650688  v_F1: 0.689097  v_AUC: 0.887072
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.172774    reg_loss: 0.000000    l2_loss: 0.022456    loss: 0.195230
steps 6200    v_Prec: 0.753674  v_Recall: 0.635164  v_F1: 0.689363  v_AUC: 0.886975
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.175819    reg_loss: 0.000000    l2_loss: 0.023026    loss: 0.198846
steps 6400    v_Prec: 0.738888  v_Recall: 0.661868  v_F1: 0.698261  v_AUC: 0.887052
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.175047    reg_loss: 0.000000    l2_loss: 0.023545    loss: 0.198591
steps 6600    v_Prec: 0.724797  v_Recall: 0.652859  v_F1: 0.686950  v_AUC: 0.884660
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.179950    reg_loss: 0.000000    l2_loss: 0.024011    loss: 0.203961
steps 6800    v_Prec: 0.764323  v_Recall: 0.633073  v_F1: 0.692534  v_AUC: 0.891645
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.188533    reg_loss: 0.000000    l2_loss: 0.024384    loss: 0.212917
steps 7000    v_Prec: 0.752518  v_Recall: 0.642966  v_F1: 0.693442  v_AUC: 0.889551
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.182591    reg_loss: 0.000000    l2_loss: 0.024717    loss: 0.207308
steps 7200    v_Prec: 0.744652  v_Recall: 0.657926  v_F1: 0.698608  v_AUC: 0.893995
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.192577    reg_loss: 0.000000    l2_loss: 0.024915    loss: 0.217492
steps 7400    v_Prec: 0.759271  v_Recall: 0.657042  v_F1: 0.704467  v_AUC: 0.894449
steps 7400    running time 278 seconds

Early stop model F1: 0.705655
testing thre: 0.44408202
testing Prec: 0.5825772849462365
testing Recall: 0.6741190765492102
testing F1: 0.6250140819683212
testing AUC: 0.8739835567834341
overall running time 281 seconds
(0.6576450458858298, 0.6164763061968408, 0.6363955646982088, 0.8739835567834341, 0.5942214)

2019-02-24 00:11:19.153434: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:11:20.194615: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:11:20.236169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:11:20.236249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.930000 seconds
loading data in 30.020000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.042753    reg_loss: 0.000000    l2_loss: 0.013336    loss: 1.056089
steps 200    v_Prec: 0.170169  v_Recall: 0.870662  v_F1: 0.284695  v_AUC: 0.534007
steps 200    running time 40 seconds

steps 400    base_loss: 0.735198    reg_loss: 0.000000    l2_loss: 0.013428    loss: 0.748626
steps 400    v_Prec: 0.175497  v_Recall: 0.834611  v_F1: 0.290012  v_AUC: 0.558112
steps 400    running time 47 seconds

steps 600    base_loss: 0.510440    reg_loss: 0.000000    l2_loss: 0.013395    loss: 0.523835
steps 600    v_Prec: 0.186099  v_Recall: 0.722033  v_F1: 0.295925  v_AUC: 0.584662
steps 600    running time 54 seconds

steps 800    base_loss: 0.479343    reg_loss: 0.000000    l2_loss: 0.013135    loss: 0.492477
steps 800    v_Prec: 0.222671  v_Recall: 0.535615  v_F1: 0.314568  v_AUC: 0.618228
steps 800    running time 61 seconds

steps 1000    base_loss: 0.459062    reg_loss: 0.000000    l2_loss: 0.012826    loss: 0.471888
steps 1000    v_Prec: 0.267808  v_Recall: 0.483596  v_F1: 0.344717  v_AUC: 0.657941
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.449723    reg_loss: 0.000000    l2_loss: 0.012628    loss: 0.462351
steps 1200    v_Prec: 0.374157  v_Recall: 0.447545  v_F1: 0.407574  v_AUC: 0.713610
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.429001    reg_loss: 0.000000    l2_loss: 0.012593    loss: 0.441594
steps 1400    v_Prec: 0.511789  v_Recall: 0.437584  v_F1: 0.471787  v_AUC: 0.760342
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.398440    reg_loss: 0.000000    l2_loss: 0.012699    loss: 0.411140
steps 1600    v_Prec: 0.543391  v_Recall: 0.494031  v_F1: 0.517537  v_AUC: 0.796951
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.368612    reg_loss: 0.000000    l2_loss: 0.012948    loss: 0.381560
steps 1800    v_Prec: 0.577840  v_Recall: 0.555775  v_F1: 0.566593  v_AUC: 0.829188
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.338622    reg_loss: 0.000000    l2_loss: 0.013253    loss: 0.351876
steps 2000    v_Prec: 0.624691  v_Recall: 0.558858  v_F1: 0.589944  v_AUC: 0.844815
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.317020    reg_loss: 0.000000    l2_loss: 0.013631    loss: 0.330651
steps 2200    v_Prec: 0.682397  v_Recall: 0.563602  v_F1: 0.617336  v_AUC: 0.858197
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.309368    reg_loss: 0.000000    l2_loss: 0.014006    loss: 0.323374
steps 2400    v_Prec: 0.692510  v_Recall: 0.583999  v_F1: 0.633642  v_AUC: 0.865584
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.295291    reg_loss: 0.000000    l2_loss: 0.014263    loss: 0.309554
steps 2600    v_Prec: 0.713960  v_Recall: 0.593565  v_F1: 0.648219  v_AUC: 0.873140
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.289304    reg_loss: 0.000000    l2_loss: 0.014590    loss: 0.303894
steps 2800    v_Prec: 0.699175  v_Recall: 0.616650  v_F1: 0.655325  v_AUC: 0.877427
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.285922    reg_loss: 0.000000    l2_loss: 0.014806    loss: 0.300727
steps 3000    v_Prec: 0.737447  v_Recall: 0.603763  v_F1: 0.663943  v_AUC: 0.879645
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.285625    reg_loss: 0.000000    l2_loss: 0.015150    loss: 0.300776
steps 3200    v_Prec: 0.709032  v_Recall: 0.641711  v_F1: 0.673694  v_AUC: 0.883986
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.276713    reg_loss: 0.000000    l2_loss: 0.015383    loss: 0.292096
steps 3400    v_Prec: 0.734737  v_Recall: 0.626057  v_F1: 0.676058  v_AUC: 0.886980
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.273145    reg_loss: 0.000000    l2_loss: 0.015671    loss: 0.288815
steps 3600    v_Prec: 0.743101  v_Recall: 0.634358  v_F1: 0.684437  v_AUC: 0.890094
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.265188    reg_loss: 0.000000    l2_loss: 0.015993    loss: 0.281181
steps 3800    v_Prec: 0.742285  v_Recall: 0.644636  v_F1: 0.690023  v_AUC: 0.892261
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.269485    reg_loss: 0.000000    l2_loss: 0.016235    loss: 0.285720
steps 4000    v_Prec: 0.764132  v_Recall: 0.637995  v_F1: 0.695390  v_AUC: 0.895142
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.268181    reg_loss: 0.000000    l2_loss: 0.016624    loss: 0.284805
steps 4200    v_Prec: 0.745253  v_Recall: 0.657760  v_F1: 0.698778  v_AUC: 0.897450
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.263573    reg_loss: 0.000000    l2_loss: 0.016977    loss: 0.280550
steps 4400    v_Prec: 0.747730  v_Recall: 0.670646  v_F1: 0.707093  v_AUC: 0.899888
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.265095    reg_loss: 0.000000    l2_loss: 0.017231    loss: 0.282326
steps 4600    v_Prec: 0.749799  v_Recall: 0.663373  v_F1: 0.703943  v_AUC: 0.900426
steps 4600    running time 190 seconds

steps 4800    base_loss: 0.257163    reg_loss: 0.000000    l2_loss: 0.017656    loss: 0.274818
steps 4800    v_Prec: 0.735674  v_Recall: 0.675943  v_F1: 0.704545  v_AUC: 0.901905
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.257861    reg_loss: 0.000000    l2_loss: 0.018114    loss: 0.275975
steps 5000    v_Prec: 0.747990  v_Recall: 0.669223  v_F1: 0.706417  v_AUC: 0.904595
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.262807    reg_loss: 0.000000    l2_loss: 0.018565    loss: 0.281372
steps 5200    v_Prec: 0.761007  v_Recall: 0.657285  v_F1: 0.705353  v_AUC: 0.905904
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.254511    reg_loss: 0.000000    l2_loss: 0.018875    loss: 0.273386
steps 5400    v_Prec: 0.729477  v_Recall: 0.689857  v_F1: 0.709114  v_AUC: 0.906400
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.174228    reg_loss: 0.000000    l2_loss: 0.019385    loss: 0.193613
steps 5600    v_Prec: 0.753554  v_Recall: 0.670567  v_F1: 0.709642  v_AUC: 0.901234
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.171861    reg_loss: 0.000000    l2_loss: 0.020058    loss: 0.191918
steps 5800    v_Prec: 0.760866  v_Recall: 0.658787  v_F1: 0.706157  v_AUC: 0.900226
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.163237    reg_loss: 0.000000    l2_loss: 0.020755    loss: 0.183991
steps 6000    v_Prec: 0.763477  v_Recall: 0.656099  v_F1: 0.705727  v_AUC: 0.899604
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.172816    reg_loss: 0.000000    l2_loss: 0.021378    loss: 0.194194
steps 6200    v_Prec: 0.742034  v_Recall: 0.673808  v_F1: 0.706277  v_AUC: 0.899109
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.176400    reg_loss: 0.000000    l2_loss: 0.021939    loss: 0.198339
steps 6400    v_Prec: 0.754938  v_Recall: 0.667800  v_F1: 0.708700  v_AUC: 0.900928
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.180716    reg_loss: 0.000000    l2_loss: 0.022389    loss: 0.203105
steps 6600    v_Prec: 0.747716  v_Recall: 0.679500  v_F1: 0.711978  v_AUC: 0.903830
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.180226    reg_loss: 0.000000    l2_loss: 0.022758    loss: 0.202984
steps 6800    v_Prec: 0.748582  v_Recall: 0.678156  v_F1: 0.711631  v_AUC: 0.903188
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.174567    reg_loss: 0.000000    l2_loss: 0.022993    loss: 0.197559
steps 7000    v_Prec: 0.761569  v_Recall: 0.666140  v_F1: 0.710665  v_AUC: 0.901851
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.183923    reg_loss: 0.000000    l2_loss: 0.023461    loss: 0.207384
steps 7200    v_Prec: 0.764621  v_Recall: 0.672860  v_F1: 0.715812  v_AUC: 0.904298
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.181813    reg_loss: 0.000000    l2_loss: 0.023536    loss: 0.205349
steps 7400    v_Prec: 0.738957  v_Recall: 0.704957  v_F1: 0.721557  v_AUC: 0.907696
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.177178    reg_loss: 0.000000    l2_loss: 0.023776    loss: 0.200954
steps 7600    v_Prec: 0.763310  v_Recall: 0.678947  v_F1: 0.718661  v_AUC: 0.905529
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.180567    reg_loss: 0.000000    l2_loss: 0.024078    loss: 0.204645
steps 7800    v_Prec: 0.766868  v_Recall: 0.681082  v_F1: 0.721434  v_AUC: 0.906352
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.179626    reg_loss: 0.000000    l2_loss: 0.024218    loss: 0.203844
steps 8000    v_Prec: 0.745539  v_Recall: 0.700213  v_F1: 0.722166  v_AUC: 0.906936
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.188569    reg_loss: 0.000000    l2_loss: 0.024311    loss: 0.212880
steps 8200    v_Prec: 0.760472  v_Recall: 0.697525  v_F1: 0.727640  v_AUC: 0.908223
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.193282    reg_loss: 0.000000    l2_loss: 0.024453    loss: 0.217735
steps 8400    v_Prec: 0.757950  v_Recall: 0.702822  v_F1: 0.729346  v_AUC: 0.909989
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.184629    reg_loss: 0.000000    l2_loss: 0.024531    loss: 0.209160
steps 8600    v_Prec: 0.775445  v_Recall: 0.689066  v_F1: 0.729708  v_AUC: 0.910820
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.183143    reg_loss: 0.000000    l2_loss: 0.024689    loss: 0.207832
steps 8800    v_Prec: 0.768224  v_Recall: 0.700688  v_F1: 0.732903  v_AUC: 0.912615
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.186426    reg_loss: 0.000000    l2_loss: 0.024882    loss: 0.211308
steps 9000    v_Prec: 0.769131  v_Recall: 0.700846  v_F1: 0.733402  v_AUC: 0.913780
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.187417    reg_loss: 0.000000    l2_loss: 0.024896    loss: 0.212313
steps 9200    v_Prec: 0.795521  v_Recall: 0.688039  v_F1: 0.737886  v_AUC: 0.914436
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.189302    reg_loss: 0.000000    l2_loss: 0.025042    loss: 0.214344
steps 9400    v_Prec: 0.779115  v_Recall: 0.701320  v_F1: 0.738173  v_AUC: 0.915230
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.185428    reg_loss: 0.000000    l2_loss: 0.025016    loss: 0.210444
steps 9600    v_Prec: 0.786013  v_Recall: 0.697525  v_F1: 0.739130  v_AUC: 0.917067
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.185373    reg_loss: 0.000000    l2_loss: 0.025036    loss: 0.210409
steps 9800    v_Prec: 0.793122  v_Recall: 0.698316  v_F1: 0.742706  v_AUC: 0.918806
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.185008    reg_loss: 0.000000    l2_loss: 0.025207    loss: 0.210215
steps 10000    v_Prec: 0.773975  v_Recall: 0.713337  v_F1: 0.742420  v_AUC: 0.918956
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.176278    reg_loss: 0.000000    l2_loss: 0.025141    loss: 0.201418
steps 10200    v_Prec: 0.776982  v_Recall: 0.711440  v_F1: 0.742768  v_AUC: 0.919777
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.178820    reg_loss: 0.000000    l2_loss: 0.025132    loss: 0.203952
steps 10400    v_Prec: 0.765338  v_Recall: 0.725828  v_F1: 0.745060  v_AUC: 0.921405
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.189596    reg_loss: 0.000000    l2_loss: 0.025256    loss: 0.214851
steps 10600    v_Prec: 0.770401  v_Recall: 0.724721  v_F1: 0.746863  v_AUC: 0.923469
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.164028    reg_loss: 0.000000    l2_loss: 0.025150    loss: 0.189178
steps 10800    v_Prec: 0.772700  v_Recall: 0.723219  v_F1: 0.747141  v_AUC: 0.922931
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.073931    reg_loss: 0.000000    l2_loss: 0.025186    loss: 0.099117
steps 11000    v_Prec: 0.798869  v_Recall: 0.692387  v_F1: 0.741826  v_AUC: 0.918723
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.065648    reg_loss: 0.000000    l2_loss: 0.025032    loss: 0.090680
steps 11200    v_Prec: 0.767519  v_Recall: 0.709147  v_F1: 0.737179  v_AUC: 0.914034
steps 11200    running time 404 seconds

steps 11400    base_loss: 0.067902    reg_loss: 0.000000    l2_loss: 0.024972    loss: 0.092874
steps 11400    v_Prec: 0.772913  v_Recall: 0.704720  v_F1: 0.737243  v_AUC: 0.912487
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.071150    reg_loss: 0.000000    l2_loss: 0.024962    loss: 0.096112
steps 11600    v_Prec: 0.769051  v_Recall: 0.701320  v_F1: 0.733626  v_AUC: 0.911463
steps 11600    running time 418 seconds

steps 11800    base_loss: 0.068213    reg_loss: 0.000000    l2_loss: 0.025063    loss: 0.093276
steps 11800    v_Prec: 0.774653  v_Recall: 0.696814  v_F1: 0.733675  v_AUC: 0.911294
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.077291    reg_loss: 0.000000    l2_loss: 0.025053    loss: 0.102344
steps 12000    v_Prec: 0.776896  v_Recall: 0.696498  v_F1: 0.734503  v_AUC: 0.911853
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.069990    reg_loss: 0.000000    l2_loss: 0.025094    loss: 0.095084
steps 12200    v_Prec: 0.768602  v_Recall: 0.699028  v_F1: 0.732166  v_AUC: 0.907747
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.077219    reg_loss: 0.000000    l2_loss: 0.025084    loss: 0.102303
steps 12400    v_Prec: 0.771496  v_Recall: 0.700134  v_F1: 0.734085  v_AUC: 0.910493
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.079159    reg_loss: 0.000000    l2_loss: 0.025058    loss: 0.104217
steps 12600    v_Prec: 0.772536  v_Recall: 0.695154  v_F1: 0.731805  v_AUC: 0.910050
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.076128    reg_loss: 0.000000    l2_loss: 0.025095    loss: 0.101224
steps 12800    v_Prec: 0.781375  v_Recall: 0.692545  v_F1: 0.734283  v_AUC: 0.910415
steps 12800    running time 454 seconds

Early stop model F1: 0.747141
testing thre: 0.371962
testing Prec: 0.5776755321138668
testing Recall: 0.7505710814094775
testing F1: 0.6528705504354444
testing AUC: 0.9012929551506256
overall running time 457 seconds
(0.7156085360012772, 0.6535601458080195, 0.6831783772798861, 0.9012929551506256, 0.70542604)

2019-02-24 00:16:39.776589: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:16:41.466513: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:16:41.475342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:16:41.475397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.800000 seconds
loading data in 31.330000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.779376    reg_loss: 0.000000    l2_loss: 0.013300    loss: 0.792676
steps 200    v_Prec: 0.162867  v_Recall: 0.994305  v_F1: 0.279888  v_AUC: 0.519886
steps 200    running time 41 seconds

steps 400    base_loss: 0.584010    reg_loss: 0.000000    l2_loss: 0.013079    loss: 0.597089
steps 400    v_Prec: 0.165412  v_Recall: 0.942644  v_F1: 0.281437  v_AUC: 0.539661
steps 400    running time 48 seconds

steps 600    base_loss: 0.505199    reg_loss: 0.000000    l2_loss: 0.012739    loss: 0.517938
steps 600    v_Prec: 0.197064  v_Recall: 0.591128  v_F1: 0.295588  v_AUC: 0.586251
steps 600    running time 55 seconds

steps 800    base_loss: 0.470350    reg_loss: 0.000000    l2_loss: 0.012448    loss: 0.482797
steps 800    v_Prec: 0.206450  v_Recall: 0.654741  v_F1: 0.313917  v_AUC: 0.625519
steps 800    running time 61 seconds

steps 1000    base_loss: 0.447194    reg_loss: 0.000000    l2_loss: 0.012175    loss: 0.459369
steps 1000    v_Prec: 0.333480  v_Recall: 0.425718  v_F1: 0.373996  v_AUC: 0.692037
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.413871    reg_loss: 0.000000    l2_loss: 0.012089    loss: 0.425961
steps 1200    v_Prec: 0.421172  v_Recall: 0.475533  v_F1: 0.446705  v_AUC: 0.751574
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.385063    reg_loss: 0.000000    l2_loss: 0.012017    loss: 0.397081
steps 1400    v_Prec: 0.505112  v_Recall: 0.511231  v_F1: 0.508153  v_AUC: 0.792720
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.352057    reg_loss: 0.000000    l2_loss: 0.012121    loss: 0.364178
steps 1600    v_Prec: 0.538516  v_Recall: 0.550698  v_F1: 0.544539  v_AUC: 0.817183
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.336413    reg_loss: 0.000000    l2_loss: 0.012308    loss: 0.348722
steps 1800    v_Prec: 0.598615  v_Recall: 0.540991  v_F1: 0.568347  v_AUC: 0.835852
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.323683    reg_loss: 0.000000    l2_loss: 0.012555    loss: 0.336238
steps 2000    v_Prec: 0.591057  v_Recall: 0.584229  v_F1: 0.587623  v_AUC: 0.849000
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.323547    reg_loss: 0.000000    l2_loss: 0.012780    loss: 0.336327
steps 2200    v_Prec: 0.624499  v_Recall: 0.587678  v_F1: 0.605530  v_AUC: 0.859180
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.307776    reg_loss: 0.000000    l2_loss: 0.013060    loss: 0.320837
steps 2400    v_Prec: 0.653635  v_Recall: 0.583427  v_F1: 0.616539  v_AUC: 0.866466
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.302326    reg_loss: 0.000000    l2_loss: 0.013383    loss: 0.315709
steps 2600    v_Prec: 0.660593  v_Recall: 0.599069  v_F1: 0.628329  v_AUC: 0.872589
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.299840    reg_loss: 0.000000    l2_loss: 0.013735    loss: 0.313575
steps 2800    v_Prec: 0.686190  v_Recall: 0.588320  v_F1: 0.633497  v_AUC: 0.876279
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.284388    reg_loss: 0.000000    l2_loss: 0.014037    loss: 0.298425
steps 3000    v_Prec: 0.653643  v_Recall: 0.624017  v_F1: 0.638486  v_AUC: 0.879598
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.282327    reg_loss: 0.000000    l2_loss: 0.014408    loss: 0.296735
steps 3200    v_Prec: 0.681214  v_Recall: 0.612305  v_F1: 0.644924  v_AUC: 0.883720
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.286935    reg_loss: 0.000000    l2_loss: 0.014786    loss: 0.301721
steps 3400    v_Prec: 0.669868  v_Recall: 0.626665  v_F1: 0.647546  v_AUC: 0.886233
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.282406    reg_loss: 0.000000    l2_loss: 0.015128    loss: 0.297534
steps 3600    v_Prec: 0.698700  v_Recall: 0.612386  v_F1: 0.652702  v_AUC: 0.888133
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.276759    reg_loss: 0.000000    l2_loss: 0.015582    loss: 0.292341
steps 3800    v_Prec: 0.699010  v_Recall: 0.611985  v_F1: 0.652609  v_AUC: 0.890470
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.278233    reg_loss: 0.000000    l2_loss: 0.016001    loss: 0.294235
steps 4000    v_Prec: 0.687380  v_Recall: 0.630916  v_F1: 0.657939  v_AUC: 0.893016
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.276061    reg_loss: 0.000000    l2_loss: 0.016528    loss: 0.292589
steps 4200    v_Prec: 0.652147  v_Recall: 0.665330  v_F1: 0.658672  v_AUC: 0.894079
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.271602    reg_loss: 0.000000    l2_loss: 0.017041    loss: 0.288643
steps 4400    v_Prec: 0.663872  v_Recall: 0.654179  v_F1: 0.658990  v_AUC: 0.896038
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.269145    reg_loss: 0.000000    l2_loss: 0.017565    loss: 0.286711
steps 4600    v_Prec: 0.693471  v_Recall: 0.636451  v_F1: 0.663739  v_AUC: 0.897086
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.275332    reg_loss: 0.000000    l2_loss: 0.018025    loss: 0.293357
steps 4800    v_Prec: 0.692649  v_Recall: 0.639419  v_F1: 0.664970  v_AUC: 0.899138
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.268167    reg_loss: 0.000000    l2_loss: 0.018711    loss: 0.286878
steps 5000    v_Prec: 0.706161  v_Recall: 0.622493  v_F1: 0.661693  v_AUC: 0.899056
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.271738    reg_loss: 0.000000    l2_loss: 0.019241    loss: 0.290979
steps 5200    v_Prec: 0.689321  v_Recall: 0.628108  v_F1: 0.657293  v_AUC: 0.898457
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.269912    reg_loss: 0.000000    l2_loss: 0.019956    loss: 0.289867
steps 5400    v_Prec: 0.675265  v_Recall: 0.655222  v_F1: 0.665092  v_AUC: 0.899920
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.166954    reg_loss: 0.000000    l2_loss: 0.020723    loss: 0.187677
steps 5600    v_Prec: 0.665689  v_Recall: 0.655222  v_F1: 0.660414  v_AUC: 0.896233
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.170976    reg_loss: 0.000000    l2_loss: 0.021497    loss: 0.192472
steps 5800    v_Prec: 0.680888  v_Recall: 0.635007  v_F1: 0.657148  v_AUC: 0.893435
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.175881    reg_loss: 0.000000    l2_loss: 0.022164    loss: 0.198045
steps 6000    v_Prec: 0.695707  v_Recall: 0.622654  v_F1: 0.657156  v_AUC: 0.893642
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.173214    reg_loss: 0.000000    l2_loss: 0.022782    loss: 0.195996
steps 6200    v_Prec: 0.669258  v_Recall: 0.649126  v_F1: 0.659038  v_AUC: 0.894012
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.180977    reg_loss: 0.000000    l2_loss: 0.023402    loss: 0.204379
steps 6400    v_Prec: 0.676510  v_Recall: 0.646880  v_F1: 0.661363  v_AUC: 0.894474
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.186122    reg_loss: 0.000000    l2_loss: 0.023927    loss: 0.210049
steps 6600    v_Prec: 0.675105  v_Recall: 0.643911  v_F1: 0.659139  v_AUC: 0.893203
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.177042    reg_loss: 0.000000    l2_loss: 0.024449    loss: 0.201490
steps 6800    v_Prec: 0.701422  v_Recall: 0.629232  v_F1: 0.663368  v_AUC: 0.895451
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.190716    reg_loss: 0.000000    l2_loss: 0.024890    loss: 0.215606
steps 7000    v_Prec: 0.675500  v_Recall: 0.660436  v_F1: 0.667884  v_AUC: 0.897754
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.189859    reg_loss: 0.000000    l2_loss: 0.025232    loss: 0.215090
steps 7200    v_Prec: 0.704879  v_Recall: 0.636291  v_F1: 0.668831  v_AUC: 0.897673
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.188252    reg_loss: 0.000000    l2_loss: 0.025678    loss: 0.213929
steps 7400    v_Prec: 0.679193  v_Recall: 0.664046  v_F1: 0.671534  v_AUC: 0.899614
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.178149    reg_loss: 0.000000    l2_loss: 0.026059    loss: 0.204209
steps 7600    v_Prec: 0.707371  v_Recall: 0.643591  v_F1: 0.673975  v_AUC: 0.899980
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.193855    reg_loss: 0.000000    l2_loss: 0.026362    loss: 0.220217
steps 7800    v_Prec: 0.702907  v_Recall: 0.655543  v_F1: 0.678399  v_AUC: 0.902872
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.178706    reg_loss: 0.000000    l2_loss: 0.026775    loss: 0.205481
steps 8000    v_Prec: 0.706159  v_Recall: 0.650249  v_F1: 0.677052  v_AUC: 0.902179
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.187803    reg_loss: 0.000000    l2_loss: 0.027064    loss: 0.214867
steps 8200    v_Prec: 0.705660  v_Recall: 0.659073  v_F1: 0.681571  v_AUC: 0.903113
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.189535    reg_loss: 0.000000    l2_loss: 0.027317    loss: 0.216852
steps 8400    v_Prec: 0.701303  v_Recall: 0.660517  v_F1: 0.680299  v_AUC: 0.903969
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.183960    reg_loss: 0.000000    l2_loss: 0.027673    loss: 0.211633
steps 8600    v_Prec: 0.706113  v_Recall: 0.663404  v_F1: 0.684093  v_AUC: 0.906315
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.192451    reg_loss: 0.000000    l2_loss: 0.027894    loss: 0.220346
steps 8800    v_Prec: 0.724741  v_Recall: 0.655383  v_F1: 0.688319  v_AUC: 0.906599
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.189433    reg_loss: 0.000000    l2_loss: 0.028170    loss: 0.217603
steps 9000    v_Prec: 0.750350  v_Recall: 0.644232  v_F1: 0.693254  v_AUC: 0.908405
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.183386    reg_loss: 0.000000    l2_loss: 0.028438    loss: 0.211824
steps 9200    v_Prec: 0.742953  v_Recall: 0.657549  v_F1: 0.697647  v_AUC: 0.909299
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.191623    reg_loss: 0.000000    l2_loss: 0.028805    loss: 0.220428
steps 9400    v_Prec: 0.710118  v_Recall: 0.683459  v_F1: 0.696534  v_AUC: 0.910820
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.186181    reg_loss: 0.000000    l2_loss: 0.028936    loss: 0.215117
steps 9600    v_Prec: 0.740116  v_Recall: 0.665249  v_F1: 0.700689  v_AUC: 0.911660
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.195969    reg_loss: 0.000000    l2_loss: 0.029116    loss: 0.225085
steps 9800    v_Prec: 0.727632  v_Recall: 0.679769  v_F1: 0.702887  v_AUC: 0.912829
steps 9800    running time 356 seconds

steps 10000    base_loss: 0.188236    reg_loss: 0.000000    l2_loss: 0.029357    loss: 0.217593
steps 10000    v_Prec: 0.736025  v_Recall: 0.672790  v_F1: 0.702988  v_AUC: 0.913229
steps 10000    running time 362 seconds

steps 10200    base_loss: 0.193089    reg_loss: 0.000000    l2_loss: 0.029506    loss: 0.222595
steps 10200    v_Prec: 0.727772  v_Recall: 0.691401  v_F1: 0.709120  v_AUC: 0.916469
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.183438    reg_loss: 0.000000    l2_loss: 0.029637    loss: 0.213075
steps 10400    v_Prec: 0.756337  v_Recall: 0.675036  v_F1: 0.713377  v_AUC: 0.917806
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.185435    reg_loss: 0.000000    l2_loss: 0.029810    loss: 0.215245
steps 10600    v_Prec: 0.747046  v_Recall: 0.684662  v_F1: 0.714495  v_AUC: 0.918713
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.176060    reg_loss: 0.000000    l2_loss: 0.029955    loss: 0.206014
steps 10800    v_Prec: 0.717618  v_Recall: 0.710653  v_F1: 0.714119  v_AUC: 0.919193
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.075164    reg_loss: 0.000000    l2_loss: 0.030105    loss: 0.105269
steps 11000    v_Prec: 0.709012  v_Recall: 0.684101  v_F1: 0.696334  v_AUC: 0.910056
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.071358    reg_loss: 0.000000    l2_loss: 0.030316    loss: 0.101673
steps 11200    v_Prec: 0.710114  v_Recall: 0.661239  v_F1: 0.684805  v_AUC: 0.904262
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.074480    reg_loss: 0.000000    l2_loss: 0.030384    loss: 0.104864
steps 11400    v_Prec: 0.714147  v_Recall: 0.647521  v_F1: 0.679204  v_AUC: 0.902985
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.078049    reg_loss: 0.000000    l2_loss: 0.030526    loss: 0.108574
steps 11600    v_Prec: 0.706763  v_Recall: 0.636291  v_F1: 0.669678  v_AUC: 0.897801
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.070550    reg_loss: 0.000000    l2_loss: 0.030648    loss: 0.101198
steps 11800    v_Prec: 0.685676  v_Recall: 0.663565  v_F1: 0.674439  v_AUC: 0.898828
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.074493    reg_loss: 0.000000    l2_loss: 0.030774    loss: 0.105267
steps 12000    v_Prec: 0.682399  v_Recall: 0.659955  v_F1: 0.670989  v_AUC: 0.896381
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.079574    reg_loss: 0.000000    l2_loss: 0.030721    loss: 0.110295
steps 12200    v_Prec: 0.689197  v_Recall: 0.653538  v_F1: 0.670894  v_AUC: 0.897275
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.085316    reg_loss: 0.000000    l2_loss: 0.030892    loss: 0.116208
steps 12400    v_Prec: 0.688032  v_Recall: 0.655302  v_F1: 0.671268  v_AUC: 0.896087
steps 12400    running time 439 seconds

steps 12600    base_loss: 0.081683    reg_loss: 0.000000    l2_loss: 0.030951    loss: 0.112634
steps 12600    v_Prec: 0.683758  v_Recall: 0.650409  v_F1: 0.666667  v_AUC: 0.892692
steps 12600    running time 444 seconds

Early stop model F1: 0.714495
testing thre: 0.43272737
testing Prec: 0.5354541970103488
testing Recall: 0.7468772782503038
testing F1: 0.6237366562487315
testing AUC: 0.8983886976420173
overall running time 447 seconds
(0.6849265089127489, 0.6386877278250304, 0.6609994718442695, 0.8983886976420173, 0.6965931)

2019-02-24 00:22:01.907191: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:22:02.294166: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:22:02.296331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:22:02.296376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.440000 seconds
loading data in 30.800000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.210273    reg_loss: 0.000000    l2_loss: 0.013328    loss: 1.223601
steps 200    v_Prec: 0.164303  v_Recall: 0.942656  v_F1: 0.279832  v_AUC: 0.527630
steps 200    running time 41 seconds

steps 400    base_loss: 0.714103    reg_loss: 0.000000    l2_loss: 0.013469    loss: 0.727571
steps 400    v_Prec: 0.175844  v_Recall: 0.757037  v_F1: 0.285396  v_AUC: 0.556795
steps 400    running time 48 seconds

steps 600    base_loss: 0.512783    reg_loss: 0.000000    l2_loss: 0.013422    loss: 0.526205
steps 600    v_Prec: 0.191160  v_Recall: 0.671951  v_F1: 0.297644  v_AUC: 0.596222
steps 600    running time 54 seconds

steps 800    base_loss: 0.492136    reg_loss: 0.000000    l2_loss: 0.013219    loss: 0.505356
steps 800    v_Prec: 0.240820  v_Recall: 0.507117  v_F1: 0.326562  v_AUC: 0.643047
steps 800    running time 61 seconds

steps 1000    base_loss: 0.467813    reg_loss: 0.000000    l2_loss: 0.013157    loss: 0.480970
steps 1000    v_Prec: 0.297069  v_Recall: 0.441038  v_F1: 0.355013  v_AUC: 0.672749
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.455489    reg_loss: 0.000000    l2_loss: 0.013079    loss: 0.468569
steps 1200    v_Prec: 0.353377  v_Recall: 0.440149  v_F1: 0.392018  v_AUC: 0.701325
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.429631    reg_loss: 0.000000    l2_loss: 0.013132    loss: 0.442763
steps 1400    v_Prec: 0.459014  v_Recall: 0.432061  v_F1: 0.445130  v_AUC: 0.745985
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.408820    reg_loss: 0.000000    l2_loss: 0.013229    loss: 0.422049
steps 1600    v_Prec: 0.546268  v_Recall: 0.449288  v_F1: 0.493055  v_AUC: 0.782089
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.381371    reg_loss: 0.000000    l2_loss: 0.013403    loss: 0.394773
steps 1800    v_Prec: 0.563744  v_Recall: 0.508573  v_F1: 0.534739  v_AUC: 0.807192
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.342421    reg_loss: 0.000000    l2_loss: 0.013686    loss: 0.356106
steps 2000    v_Prec: 0.636336  v_Recall: 0.499434  v_F1: 0.559634  v_AUC: 0.827255
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.335840    reg_loss: 0.000000    l2_loss: 0.014005    loss: 0.349845
steps 2200    v_Prec: 0.661024  v_Recall: 0.521110  v_F1: 0.582787  v_AUC: 0.841386
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.315580    reg_loss: 0.000000    l2_loss: 0.014302    loss: 0.329882
steps 2400    v_Prec: 0.617339  v_Recall: 0.581689  v_F1: 0.598984  v_AUC: 0.850728
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.313741    reg_loss: 0.000000    l2_loss: 0.014586    loss: 0.328327
steps 2600    v_Prec: 0.684000  v_Recall: 0.567049  v_F1: 0.620058  v_AUC: 0.861448
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.302882    reg_loss: 0.000000    l2_loss: 0.014959    loss: 0.317841
steps 2800    v_Prec: 0.686996  v_Recall: 0.585814  v_F1: 0.632383  v_AUC: 0.867705
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.292494    reg_loss: 0.000000    l2_loss: 0.015362    loss: 0.307855
steps 3000    v_Prec: 0.685129  v_Recall: 0.603284  v_F1: 0.641607  v_AUC: 0.871388
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.286516    reg_loss: 0.000000    l2_loss: 0.015741    loss: 0.302257
steps 3200    v_Prec: 0.711380  v_Recall: 0.599644  v_F1: 0.650750  v_AUC: 0.875153
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.280576    reg_loss: 0.000000    l2_loss: 0.016076    loss: 0.296652
steps 3400    v_Prec: 0.712294  v_Recall: 0.611533  v_F1: 0.658079  v_AUC: 0.877548
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.283339    reg_loss: 0.000000    l2_loss: 0.016406    loss: 0.299745
steps 3600    v_Prec: 0.727238  v_Recall: 0.615011  v_F1: 0.666433  v_AUC: 0.882139
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.274630    reg_loss: 0.000000    l2_loss: 0.016778    loss: 0.291408
steps 3800    v_Prec: 0.703766  v_Recall: 0.642349  v_F1: 0.671656  v_AUC: 0.885587
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.276347    reg_loss: 0.000000    l2_loss: 0.017140    loss: 0.293487
steps 4000    v_Prec: 0.725900  v_Recall: 0.637658  v_F1: 0.678924  v_AUC: 0.888076
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.264056    reg_loss: 0.000000    l2_loss: 0.017525    loss: 0.281581
steps 4200    v_Prec: 0.735890  v_Recall: 0.637981  v_F1: 0.683447  v_AUC: 0.888150
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.265409    reg_loss: 0.000000    l2_loss: 0.017927    loss: 0.283336
steps 4400    v_Prec: 0.743964  v_Recall: 0.642996  v_F1: 0.689805  v_AUC: 0.893332
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.265768    reg_loss: 0.000000    l2_loss: 0.018266    loss: 0.284035
steps 4600    v_Prec: 0.724059  v_Recall: 0.667664  v_F1: 0.694719  v_AUC: 0.894451
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.263452    reg_loss: 0.000000    l2_loss: 0.018665    loss: 0.282117
steps 4800    v_Prec: 0.710517  v_Recall: 0.679715  v_F1: 0.694775  v_AUC: 0.898241
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.266391    reg_loss: 0.000000    l2_loss: 0.018942    loss: 0.285333
steps 5000    v_Prec: 0.733174  v_Recall: 0.669605  v_F1: 0.699949  v_AUC: 0.899256
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.254066    reg_loss: 0.000000    l2_loss: 0.019251    loss: 0.273317
steps 5200    v_Prec: 0.766359  v_Recall: 0.650760  v_F1: 0.703845  v_AUC: 0.902100
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.251623    reg_loss: 0.000000    l2_loss: 0.019758    loss: 0.271381
steps 5400    v_Prec: 0.737852  v_Recall: 0.671789  v_F1: 0.703273  v_AUC: 0.904151
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.173790    reg_loss: 0.000000    l2_loss: 0.020125    loss: 0.193915
steps 5600    v_Prec: 0.740075  v_Recall: 0.666451  v_F1: 0.701336  v_AUC: 0.900020
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.172390    reg_loss: 0.000000    l2_loss: 0.020584    loss: 0.192974
steps 5800    v_Prec: 0.747132  v_Recall: 0.658363  v_F1: 0.699944  v_AUC: 0.897056
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.168195    reg_loss: 0.000000    l2_loss: 0.021178    loss: 0.189373
steps 6000    v_Prec: 0.757069  v_Recall: 0.651812  v_F1: 0.700508  v_AUC: 0.896359
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.167180    reg_loss: 0.000000    l2_loss: 0.021780    loss: 0.188961
steps 6200    v_Prec: 0.742922  v_Recall: 0.666370  v_F1: 0.702567  v_AUC: 0.894035
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.164626    reg_loss: 0.000000    l2_loss: 0.022336    loss: 0.186962
steps 6400    v_Prec: 0.748809  v_Recall: 0.661113  v_F1: 0.702234  v_AUC: 0.894248
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.182248    reg_loss: 0.000000    l2_loss: 0.022944    loss: 0.205192
steps 6600    v_Prec: 0.767709  v_Recall: 0.643400  v_F1: 0.700079  v_AUC: 0.896077
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.175167    reg_loss: 0.000000    l2_loss: 0.023330    loss: 0.198497
steps 6800    v_Prec: 0.766120  v_Recall: 0.649628  v_F1: 0.703081  v_AUC: 0.898996
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.188693    reg_loss: 0.000000    l2_loss: 0.023679    loss: 0.212372
steps 7000    v_Prec: 0.736531  v_Recall: 0.674458  v_F1: 0.704129  v_AUC: 0.899118
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.181497    reg_loss: 0.000000    l2_loss: 0.023942    loss: 0.205439
steps 7200    v_Prec: 0.753857  v_Recall: 0.667826  v_F1: 0.708239  v_AUC: 0.899293
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.198747    reg_loss: 0.000000    l2_loss: 0.024216    loss: 0.222964
steps 7400    v_Prec: 0.745842  v_Recall: 0.681899  v_F1: 0.712439  v_AUC: 0.903464
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.175647    reg_loss: 0.000000    l2_loss: 0.024440    loss: 0.200086
steps 7600    v_Prec: 0.743306  v_Recall: 0.678017  v_F1: 0.709162  v_AUC: 0.901905
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.180651    reg_loss: 0.000000    l2_loss: 0.024623    loss: 0.205274
steps 7800    v_Prec: 0.737576  v_Recall: 0.692656  v_F1: 0.714411  v_AUC: 0.905436
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.189346    reg_loss: 0.000000    l2_loss: 0.024920    loss: 0.214265
steps 8000    v_Prec: 0.776963  v_Recall: 0.659576  v_F1: 0.713473  v_AUC: 0.905673
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.191011    reg_loss: 0.000000    l2_loss: 0.024983    loss: 0.215994
steps 8200    v_Prec: 0.759698  v_Recall: 0.684245  v_F1: 0.720000  v_AUC: 0.907939
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.183153    reg_loss: 0.000000    l2_loss: 0.025183    loss: 0.208337
steps 8400    v_Prec: 0.766786  v_Recall: 0.677046  v_F1: 0.719127  v_AUC: 0.905935
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.185704    reg_loss: 0.000000    l2_loss: 0.025167    loss: 0.210870
steps 8600    v_Prec: 0.776000  v_Recall: 0.674701  v_F1: 0.721814  v_AUC: 0.909614
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.189714    reg_loss: 0.000000    l2_loss: 0.025283    loss: 0.214997
steps 8800    v_Prec: 0.737945  v_Recall: 0.711744  v_F1: 0.724608  v_AUC: 0.909980
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.183120    reg_loss: 0.000000    l2_loss: 0.025467    loss: 0.208587
steps 9000    v_Prec: 0.745316  v_Recall: 0.711016  v_F1: 0.727762  v_AUC: 0.909197
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.183442    reg_loss: 0.000000    l2_loss: 0.025496    loss: 0.208938
steps 9200    v_Prec: 0.771351  v_Recall: 0.690311  v_F1: 0.728584  v_AUC: 0.910433
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.183026    reg_loss: 0.000000    l2_loss: 0.025518    loss: 0.208544
steps 9400    v_Prec: 0.781219  v_Recall: 0.689664  v_F1: 0.732592  v_AUC: 0.913984
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.189296    reg_loss: 0.000000    l2_loss: 0.025655    loss: 0.214951
steps 9600    v_Prec: 0.777616  v_Recall: 0.692333  v_F1: 0.732500  v_AUC: 0.915331
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.183151    reg_loss: 0.000000    l2_loss: 0.025667    loss: 0.208818
steps 9800    v_Prec: 0.779297  v_Recall: 0.691686  v_F1: 0.732882  v_AUC: 0.914428
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.186841    reg_loss: 0.000000    l2_loss: 0.025767    loss: 0.212609
steps 10000    v_Prec: 0.753779  v_Recall: 0.713847  v_F1: 0.733270  v_AUC: 0.917064
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.170216    reg_loss: 0.000000    l2_loss: 0.025842    loss: 0.196058
steps 10200    v_Prec: 0.766600  v_Recall: 0.714332  v_F1: 0.739544  v_AUC: 0.918001
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.183057    reg_loss: 0.000000    l2_loss: 0.025883    loss: 0.208940
steps 10400    v_Prec: 0.776057  v_Recall: 0.700987  v_F1: 0.736614  v_AUC: 0.919492
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.179161    reg_loss: 0.000000    l2_loss: 0.025990    loss: 0.205151
steps 10600    v_Prec: 0.778046  v_Recall: 0.702847  v_F1: 0.738537  v_AUC: 0.918752
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.175076    reg_loss: 0.000000    l2_loss: 0.026047    loss: 0.201123
steps 10800    v_Prec: 0.797384  v_Recall: 0.695163  v_F1: 0.742773  v_AUC: 0.920234
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.075937    reg_loss: 0.000000    l2_loss: 0.026049    loss: 0.101987
steps 11000    v_Prec: 0.775964  v_Recall: 0.703413  v_F1: 0.737909  v_AUC: 0.917284
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.069022    reg_loss: 0.000000    l2_loss: 0.025884    loss: 0.094906
steps 11200    v_Prec: 0.775250  v_Recall: 0.697185  v_F1: 0.734148  v_AUC: 0.914554
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.075391    reg_loss: 0.000000    l2_loss: 0.025814    loss: 0.101205
steps 11400    v_Prec: 0.783708  v_Recall: 0.679311  v_F1: 0.727785  v_AUC: 0.910003
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.070209    reg_loss: 0.000000    l2_loss: 0.025784    loss: 0.095993
steps 11600    v_Prec: 0.778687  v_Recall: 0.684973  v_F1: 0.728830  v_AUC: 0.909939
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.075831    reg_loss: 0.000000    l2_loss: 0.025769    loss: 0.101601
steps 11800    v_Prec: 0.764812  v_Recall: 0.684892  v_F1: 0.722649  v_AUC: 0.906773
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.073515    reg_loss: 0.000000    l2_loss: 0.025823    loss: 0.099338
steps 12000    v_Prec: 0.747903  v_Recall: 0.699450  v_F1: 0.722865  v_AUC: 0.906240
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.075302    reg_loss: 0.000000    l2_loss: 0.025825    loss: 0.101127
steps 12200    v_Prec: 0.774590  v_Recall: 0.683436  v_F1: 0.726163  v_AUC: 0.907719
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.080206    reg_loss: 0.000000    l2_loss: 0.025813    loss: 0.106019
steps 12400    v_Prec: 0.767536  v_Recall: 0.687642  v_F1: 0.725396  v_AUC: 0.907397
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.074910    reg_loss: 0.000000    l2_loss: 0.025846    loss: 0.100757
steps 12600    v_Prec: 0.746737  v_Recall: 0.708023  v_F1: 0.726865  v_AUC: 0.907517
steps 12600    running time 444 seconds

steps 12800    base_loss: 0.085755    reg_loss: 0.000000    l2_loss: 0.025864    loss: 0.111619
steps 12800    v_Prec: 0.764377  v_Recall: 0.685862  v_F1: 0.722994  v_AUC: 0.905874
steps 12800    running time 450 seconds

Early stop model F1: 0.742773
testing thre: 0.5435871
testing Prec: 0.6193397003128602
testing Recall: 0.7312272174969623
testing F1: 0.670648806472463
testing AUC: 0.9023050539517039
overall running time 452 seconds
(0.7033311091720987, 0.6660024301336573, 0.6841579709421338, 0.9023050539517039, 0.7328025)

2019-02-24 00:27:22.622677: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:27:23.810820: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:27:23.811851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:27:23.811890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.680000 seconds
loading data in 31.110000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 2.143971    reg_loss: 0.000000    l2_loss: 0.013309    loss: 2.157281
steps 200    v_Prec: 0.164305  v_Recall: 1.000000  v_F1: 0.282237  v_AUC: 0.499693
steps 200    running time 41 seconds

steps 400    base_loss: 1.282358    reg_loss: 0.000000    l2_loss: 0.012949    loss: 1.295307
steps 400    v_Prec: 0.164757  v_Recall: 0.997935  v_F1: 0.282821  v_AUC: 0.518057
steps 400    running time 48 seconds

steps 600    base_loss: 0.526511    reg_loss: 0.000000    l2_loss: 0.012642    loss: 0.539154
steps 600    v_Prec: 0.169309  v_Recall: 0.905654  v_F1: 0.285285  v_AUC: 0.546102
steps 600    running time 54 seconds

steps 800    base_loss: 0.480928    reg_loss: 0.000000    l2_loss: 0.012525    loss: 0.493453
steps 800    v_Prec: 0.181854  v_Recall: 0.762945  v_F1: 0.293702  v_AUC: 0.577158
steps 800    running time 61 seconds

steps 1000    base_loss: 0.465525    reg_loss: 0.000000    l2_loss: 0.012415    loss: 0.477940
steps 1000    v_Prec: 0.266060  v_Recall: 0.471331  v_F1: 0.340124  v_AUC: 0.651948
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.447342    reg_loss: 0.000000    l2_loss: 0.012338    loss: 0.459681
steps 1200    v_Prec: 0.340364  v_Recall: 0.474190  v_F1: 0.396283  v_AUC: 0.704738
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.418831    reg_loss: 0.000000    l2_loss: 0.012346    loss: 0.431177
steps 1400    v_Prec: 0.441761  v_Recall: 0.451795  v_F1: 0.446722  v_AUC: 0.748922
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.393649    reg_loss: 0.000000    l2_loss: 0.012439    loss: 0.406089
steps 1600    v_Prec: 0.460975  v_Recall: 0.519695  v_F1: 0.488577  v_AUC: 0.782580
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.373351    reg_loss: 0.000000    l2_loss: 0.012589    loss: 0.385940
steps 1800    v_Prec: 0.526481  v_Recall: 0.519457  v_F1: 0.522945  v_AUC: 0.806497
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.353377    reg_loss: 0.000000    l2_loss: 0.012796    loss: 0.366173
steps 2000    v_Prec: 0.547066  v_Recall: 0.551541  v_F1: 0.549294  v_AUC: 0.827304
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.339288    reg_loss: 0.000000    l2_loss: 0.013038    loss: 0.352325
steps 2200    v_Prec: 0.564067  v_Recall: 0.578939  v_F1: 0.571406  v_AUC: 0.842135
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.328959    reg_loss: 0.000000    l2_loss: 0.013350    loss: 0.342309
steps 2400    v_Prec: 0.600065  v_Recall: 0.586722  v_F1: 0.593318  v_AUC: 0.855394
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.318052    reg_loss: 0.000000    l2_loss: 0.013613    loss: 0.331665
steps 2600    v_Prec: 0.647211  v_Recall: 0.577668  v_F1: 0.610465  v_AUC: 0.863678
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.305508    reg_loss: 0.000000    l2_loss: 0.013920    loss: 0.319428
steps 2800    v_Prec: 0.629168  v_Recall: 0.612929  v_F1: 0.620942  v_AUC: 0.871165
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.307864    reg_loss: 0.000000    l2_loss: 0.014223    loss: 0.322086
steps 3000    v_Prec: 0.639990  v_Recall: 0.619203  v_F1: 0.629425  v_AUC: 0.874247
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.302332    reg_loss: 0.000000    l2_loss: 0.014616    loss: 0.316948
steps 3200    v_Prec: 0.652508  v_Recall: 0.620950  v_F1: 0.636338  v_AUC: 0.878694
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.291184    reg_loss: 0.000000    l2_loss: 0.015030    loss: 0.306213
steps 3400    v_Prec: 0.665792  v_Recall: 0.624444  v_F1: 0.644455  v_AUC: 0.883639
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.279397    reg_loss: 0.000000    l2_loss: 0.015483    loss: 0.294880
steps 3600    v_Prec: 0.682646  v_Recall: 0.621982  v_F1: 0.650904  v_AUC: 0.886515
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.284015    reg_loss: 0.000000    l2_loss: 0.015929    loss: 0.299945
steps 3800    v_Prec: 0.672856  v_Recall: 0.633100  v_F1: 0.652373  v_AUC: 0.887870
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.280976    reg_loss: 0.000000    l2_loss: 0.016399    loss: 0.297376
steps 4000    v_Prec: 0.665929  v_Recall: 0.645410  v_F1: 0.655509  v_AUC: 0.889970
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.281098    reg_loss: 0.000000    l2_loss: 0.016873    loss: 0.297971
steps 4200    v_Prec: 0.697169  v_Recall: 0.629844  v_F1: 0.661799  v_AUC: 0.891490
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.278500    reg_loss: 0.000000    l2_loss: 0.017436    loss: 0.295935
steps 4400    v_Prec: 0.692281  v_Recall: 0.631750  v_F1: 0.660632  v_AUC: 0.892804
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.273728    reg_loss: 0.000000    l2_loss: 0.018037    loss: 0.291765
steps 4600    v_Prec: 0.690787  v_Recall: 0.643663  v_F1: 0.666393  v_AUC: 0.895653
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.275138    reg_loss: 0.000000    l2_loss: 0.018639    loss: 0.293777
steps 4800    v_Prec: 0.683637  v_Recall: 0.652637  v_F1: 0.667777  v_AUC: 0.898310
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.269171    reg_loss: 0.000000    l2_loss: 0.019218    loss: 0.288389
steps 5000    v_Prec: 0.705660  v_Recall: 0.637627  v_F1: 0.669921  v_AUC: 0.898571
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.276887    reg_loss: 0.000000    l2_loss: 0.019809    loss: 0.296697
steps 5200    v_Prec: 0.704173  v_Recall: 0.644616  v_F1: 0.673079  v_AUC: 0.899696
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.260373    reg_loss: 0.000000    l2_loss: 0.020438    loss: 0.280811
steps 5400    v_Prec: 0.716269  v_Recall: 0.631115  v_F1: 0.671001  v_AUC: 0.901467
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.173661    reg_loss: 0.000000    l2_loss: 0.021316    loss: 0.194977
steps 5600    v_Prec: 0.691505  v_Recall: 0.647078  v_F1: 0.668554  v_AUC: 0.897558
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.172054    reg_loss: 0.000000    l2_loss: 0.022093    loss: 0.194147
steps 5800    v_Prec: 0.672033  v_Recall: 0.656449  v_F1: 0.664149  v_AUC: 0.894921
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.184539    reg_loss: 0.000000    l2_loss: 0.022814    loss: 0.207354
steps 6000    v_Prec: 0.698720  v_Recall: 0.633021  v_F1: 0.664250  v_AUC: 0.895629
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.181901    reg_loss: 0.000000    l2_loss: 0.023565    loss: 0.205466
steps 6200    v_Prec: 0.680267  v_Recall: 0.647475  v_F1: 0.663466  v_AUC: 0.894577
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.177717    reg_loss: 0.000000    l2_loss: 0.023971    loss: 0.201688
steps 6400    v_Prec: 0.702150  v_Recall: 0.632783  v_F1: 0.665664  v_AUC: 0.895570
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.183057    reg_loss: 0.000000    l2_loss: 0.024604    loss: 0.207661
steps 6600    v_Prec: 0.684566  v_Recall: 0.660102  v_F1: 0.672111  v_AUC: 0.896992
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.194599    reg_loss: 0.000000    l2_loss: 0.025064    loss: 0.219664
steps 6800    v_Prec: 0.684603  v_Recall: 0.663834  v_F1: 0.674059  v_AUC: 0.898781
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.189249    reg_loss: 0.000000    l2_loss: 0.025507    loss: 0.214756
steps 7000    v_Prec: 0.682345  v_Recall: 0.668202  v_F1: 0.675200  v_AUC: 0.898875
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.192689    reg_loss: 0.000000    l2_loss: 0.025980    loss: 0.218670
steps 7200    v_Prec: 0.704483  v_Recall: 0.648983  v_F1: 0.675595  v_AUC: 0.899334
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.186326    reg_loss: 0.000000    l2_loss: 0.026392    loss: 0.212718
steps 7400    v_Prec: 0.702334  v_Recall: 0.662008  v_F1: 0.681575  v_AUC: 0.902448
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.183868    reg_loss: 0.000000    l2_loss: 0.026671    loss: 0.210540
steps 7600    v_Prec: 0.694812  v_Recall: 0.662643  v_F1: 0.678346  v_AUC: 0.902156
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.192510    reg_loss: 0.000000    l2_loss: 0.027053    loss: 0.219563
steps 7800    v_Prec: 0.711021  v_Recall: 0.657322  v_F1: 0.683118  v_AUC: 0.902857
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.194512    reg_loss: 0.000000    l2_loss: 0.027341    loss: 0.221853
steps 8000    v_Prec: 0.691565  v_Recall: 0.677176  v_F1: 0.684295  v_AUC: 0.904153
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.192141    reg_loss: 0.000000    l2_loss: 0.027726    loss: 0.219867
steps 8200    v_Prec: 0.704772  v_Recall: 0.667328  v_F1: 0.685539  v_AUC: 0.904523
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.202829    reg_loss: 0.000000    l2_loss: 0.028045    loss: 0.230874
steps 8400    v_Prec: 0.713085  v_Recall: 0.666931  v_F1: 0.689236  v_AUC: 0.905577
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.195722    reg_loss: 0.000000    l2_loss: 0.028295    loss: 0.224018
steps 8600    v_Prec: 0.705173  v_Recall: 0.677732  v_F1: 0.691180  v_AUC: 0.907638
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.189982    reg_loss: 0.000000    l2_loss: 0.028619    loss: 0.218601
steps 8800    v_Prec: 0.711612  v_Recall: 0.679400  v_F1: 0.695133  v_AUC: 0.909612
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.196406    reg_loss: 0.000000    l2_loss: 0.028921    loss: 0.225327
steps 9000    v_Prec: 0.719222  v_Recall: 0.681067  v_F1: 0.699625  v_AUC: 0.911446
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.189543    reg_loss: 0.000000    l2_loss: 0.029068    loss: 0.218611
steps 9200    v_Prec: 0.719726  v_Recall: 0.684403  v_F1: 0.701620  v_AUC: 0.911513
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.192241    reg_loss: 0.000000    l2_loss: 0.029312    loss: 0.221553
steps 9400    v_Prec: 0.743640  v_Recall: 0.663914  v_F1: 0.701519  v_AUC: 0.912002
steps 9400    running time 346 seconds

steps 9600    base_loss: 0.192178    reg_loss: 0.000000    l2_loss: 0.029598    loss: 0.221776
steps 9600    v_Prec: 0.743319  v_Recall: 0.675905  v_F1: 0.708011  v_AUC: 0.914331
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.189295    reg_loss: 0.000000    l2_loss: 0.029768    loss: 0.219063
steps 9800    v_Prec: 0.751812  v_Recall: 0.675508  v_F1: 0.711621  v_AUC: 0.915675
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.193278    reg_loss: 0.000000    l2_loss: 0.029941    loss: 0.223220
steps 10000    v_Prec: 0.756713  v_Recall: 0.675826  v_F1: 0.713986  v_AUC: 0.918189
steps 10000    running time 366 seconds

steps 10200    base_loss: 0.180316    reg_loss: 0.000000    l2_loss: 0.030205    loss: 0.210521
steps 10200    v_Prec: 0.757318  v_Recall: 0.678050  v_F1: 0.715495  v_AUC: 0.918228
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.186988    reg_loss: 0.000000    l2_loss: 0.030324    loss: 0.217311
steps 10400    v_Prec: 0.742573  v_Recall: 0.692741  v_F1: 0.716792  v_AUC: 0.918916
steps 10400    running time 379 seconds

steps 10600    base_loss: 0.190551    reg_loss: 0.000000    l2_loss: 0.030473    loss: 0.221024
steps 10600    v_Prec: 0.773118  v_Recall: 0.670584  v_F1: 0.718210  v_AUC: 0.919852
steps 10600    running time 386 seconds

steps 10800    base_loss: 0.173413    reg_loss: 0.000000    l2_loss: 0.030669    loss: 0.204082
steps 10800    v_Prec: 0.746051  v_Recall: 0.690121  v_F1: 0.716997  v_AUC: 0.920775
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.078072    reg_loss: 0.000000    l2_loss: 0.030902    loss: 0.108974
steps 11000    v_Prec: 0.722561  v_Recall: 0.686468  v_F1: 0.704052  v_AUC: 0.913731
steps 11000    running time 398 seconds

steps 11200    base_loss: 0.075157    reg_loss: 0.000000    l2_loss: 0.031037    loss: 0.106194
steps 11200    v_Prec: 0.703428  v_Recall: 0.676223  v_F1: 0.689557  v_AUC: 0.907580
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.077629    reg_loss: 0.000000    l2_loss: 0.031069    loss: 0.108698
steps 11400    v_Prec: 0.683875  v_Recall: 0.689088  v_F1: 0.686472  v_AUC: 0.904481
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.074755    reg_loss: 0.000000    l2_loss: 0.031272    loss: 0.106026
steps 11600    v_Prec: 0.710255  v_Recall: 0.661690  v_F1: 0.685113  v_AUC: 0.902813
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.082302    reg_loss: 0.000000    l2_loss: 0.031309    loss: 0.113612
steps 11800    v_Prec: 0.707027  v_Recall: 0.660816  v_F1: 0.683141  v_AUC: 0.902454
steps 11800    running time 423 seconds

steps 12000    base_loss: 0.079139    reg_loss: 0.000000    l2_loss: 0.031365    loss: 0.110504
steps 12000    v_Prec: 0.705579  v_Recall: 0.662881  v_F1: 0.683564  v_AUC: 0.901882
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.083213    reg_loss: 0.000000    l2_loss: 0.031357    loss: 0.114571
steps 12200    v_Prec: 0.702620  v_Recall: 0.655972  v_F1: 0.678495  v_AUC: 0.899145
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.084371    reg_loss: 0.000000    l2_loss: 0.031537    loss: 0.115908
steps 12400    v_Prec: 0.688469  v_Recall: 0.673761  v_F1: 0.681036  v_AUC: 0.899026
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.084180    reg_loss: 0.000000    l2_loss: 0.031666    loss: 0.115846
steps 12600    v_Prec: 0.688197  v_Recall: 0.666773  v_F1: 0.677315  v_AUC: 0.898213
steps 12600    running time 447 seconds

Early stop model F1: 0.718210
testing thre: 0.43304482
testing Prec: 0.5759420065126376
testing Recall: 0.722089914945322
testing F1: 0.6407884237993573
testing AUC: 0.8980131602509074
overall running time 450 seconds
(0.6833220444953889, 0.6374240583232078, 0.6595755381211024, 0.8980131602509074, 0.6115226)

2019-02-24 00:32:46.449409: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:32:47.194241: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:32:47.195183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:32:47.195218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 22.750000 seconds
loading data in 29.140000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.648295    reg_loss: 0.006478    l2_loss: 0.013372    loss: 0.668144
steps 200    v_Prec: 0.165592  v_Recall: 1.000000  v_F1: 0.284134  v_AUC: 0.477696
steps 200    running time 39 seconds

steps 400    base_loss: 0.530552    reg_loss: 0.006485    l2_loss: 0.013363    loss: 0.550399
steps 400    v_Prec: 0.165599  v_Recall: 0.999764  v_F1: 0.284134  v_AUC: 0.500567
steps 400    running time 45 seconds

steps 600    base_loss: 0.493662    reg_loss: 0.006493    l2_loss: 0.013229    loss: 0.513383
steps 600    v_Prec: 0.174354  v_Recall: 0.803640  v_F1: 0.286541  v_AUC: 0.559509
steps 600    running time 51 seconds

steps 800    base_loss: 0.462625    reg_loss: 0.006471    l2_loss: 0.012978    loss: 0.482074
steps 800    v_Prec: 0.251226  v_Recall: 0.492317  v_F1: 0.332685  v_AUC: 0.641979
steps 800    running time 58 seconds

steps 1000    base_loss: 0.442479    reg_loss: 0.006498    l2_loss: 0.012814    loss: 0.461791
steps 1000    v_Prec: 0.379653  v_Recall: 0.427547  v_F1: 0.402179  v_AUC: 0.714802
steps 1000    running time 64 seconds

steps 1200    base_loss: 0.417400    reg_loss: 0.006548    l2_loss: 0.012718    loss: 0.436667
steps 1200    v_Prec: 0.454768  v_Recall: 0.468206  v_F1: 0.461389  v_AUC: 0.766240
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.376490    reg_loss: 0.006567    l2_loss: 0.012732    loss: 0.395790
steps 1400    v_Prec: 0.534356  v_Recall: 0.496966  v_F1: 0.514983  v_AUC: 0.801314
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.362759    reg_loss: 0.006621    l2_loss: 0.012844    loss: 0.382224
steps 1600    v_Prec: 0.563301  v_Recall: 0.533606  v_F1: 0.548052  v_AUC: 0.823894
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.343343    reg_loss: 0.006647    l2_loss: 0.013018    loss: 0.363008
steps 1800    v_Prec: 0.602267  v_Recall: 0.540147  v_F1: 0.569518  v_AUC: 0.838016
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.328826    reg_loss: 0.006680    l2_loss: 0.013219    loss: 0.348725
steps 2000    v_Prec: 0.629649  v_Recall: 0.556221  v_F1: 0.590662  v_AUC: 0.850588
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.318951    reg_loss: 0.006723    l2_loss: 0.013457    loss: 0.339130
steps 2200    v_Prec: 0.664085  v_Recall: 0.560791  v_F1: 0.608083  v_AUC: 0.859158
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.307590    reg_loss: 0.006763    l2_loss: 0.013685    loss: 0.328038
steps 2400    v_Prec: 0.628074  v_Recall: 0.611693  v_F1: 0.619776  v_AUC: 0.865830
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.299751    reg_loss: 0.006790    l2_loss: 0.013937    loss: 0.320477
steps 2600    v_Prec: 0.650080  v_Recall: 0.608384  v_F1: 0.628541  v_AUC: 0.870262
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.293633    reg_loss: 0.006785    l2_loss: 0.014234    loss: 0.314653
steps 2800    v_Prec: 0.661304  v_Recall: 0.608935  v_F1: 0.634040  v_AUC: 0.874682
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.291202    reg_loss: 0.006812    l2_loss: 0.014509    loss: 0.312522
steps 3000    v_Prec: 0.669732  v_Recall: 0.614057  v_F1: 0.640687  v_AUC: 0.879747
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.283175    reg_loss: 0.006837    l2_loss: 0.014861    loss: 0.304873
steps 3200    v_Prec: 0.672892  v_Recall: 0.618864  v_F1: 0.644748  v_AUC: 0.883102
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.284003    reg_loss: 0.006846    l2_loss: 0.015158    loss: 0.306006
steps 3400    v_Prec: 0.670562  v_Recall: 0.628556  v_F1: 0.648879  v_AUC: 0.886221
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.276140    reg_loss: 0.006854    l2_loss: 0.015483    loss: 0.298477
steps 3600    v_Prec: 0.654812  v_Recall: 0.647073  v_F1: 0.650919  v_AUC: 0.888165
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.277284    reg_loss: 0.006873    l2_loss: 0.015894    loss: 0.300051
steps 3800    v_Prec: 0.671780  v_Recall: 0.641872  v_F1: 0.656485  v_AUC: 0.891098
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.277919    reg_loss: 0.006883    l2_loss: 0.016276    loss: 0.301079
steps 4000    v_Prec: 0.679356  v_Recall: 0.638405  v_F1: 0.658244  v_AUC: 0.893556
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.277955    reg_loss: 0.006894    l2_loss: 0.016813    loss: 0.301661
steps 4200    v_Prec: 0.689611  v_Recall: 0.632338  v_F1: 0.659734  v_AUC: 0.894659
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.270922    reg_loss: 0.006902    l2_loss: 0.017277    loss: 0.295101
steps 4400    v_Prec: 0.714948  v_Recall: 0.619967  v_F1: 0.664078  v_AUC: 0.896299
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.269526    reg_loss: 0.006920    l2_loss: 0.017761    loss: 0.294208
steps 4600    v_Prec: 0.700189  v_Recall: 0.641321  v_F1: 0.669463  v_AUC: 0.898356
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.271511    reg_loss: 0.006924    l2_loss: 0.018313    loss: 0.296748
steps 4800    v_Prec: 0.674407  v_Recall: 0.665905  v_F1: 0.670129  v_AUC: 0.900381
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.267811    reg_loss: 0.006929    l2_loss: 0.018870    loss: 0.293610
steps 5000    v_Prec: 0.697079  v_Recall: 0.652588  v_F1: 0.674101  v_AUC: 0.901559
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.275382    reg_loss: 0.006932    l2_loss: 0.019419    loss: 0.301734
steps 5200    v_Prec: 0.702073  v_Recall: 0.648412  v_F1: 0.674177  v_AUC: 0.901959
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.263743    reg_loss: 0.006964    l2_loss: 0.020033    loss: 0.290741
steps 5400    v_Prec: 0.708232  v_Recall: 0.642660  v_F1: 0.673855  v_AUC: 0.902647
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.173779    reg_loss: 0.007156    l2_loss: 0.020897    loss: 0.201832
steps 5600    v_Prec: 0.687853  v_Recall: 0.643842  v_F1: 0.665120  v_AUC: 0.898529
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.174530    reg_loss: 0.007127    l2_loss: 0.021704    loss: 0.203361
steps 5800    v_Prec: 0.693575  v_Recall: 0.637066  v_F1: 0.664120  v_AUC: 0.895921
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.169755    reg_loss: 0.007146    l2_loss: 0.022442    loss: 0.199343
steps 6000    v_Prec: 0.665865  v_Recall: 0.654322  v_F1: 0.660043  v_AUC: 0.893421
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.181248    reg_loss: 0.007134    l2_loss: 0.023090    loss: 0.211472
steps 6200    v_Prec: 0.686556  v_Recall: 0.641005  v_F1: 0.662999  v_AUC: 0.894292
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.174290    reg_loss: 0.007139    l2_loss: 0.023774    loss: 0.205202
steps 6400    v_Prec: 0.690320  v_Recall: 0.646206  v_F1: 0.667535  v_AUC: 0.895283
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.188553    reg_loss: 0.007142    l2_loss: 0.024261    loss: 0.219956
steps 6600    v_Prec: 0.705753  v_Recall: 0.633126  v_F1: 0.667470  v_AUC: 0.894815
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.187715    reg_loss: 0.007159    l2_loss: 0.024705    loss: 0.219578
steps 6800    v_Prec: 0.672491  v_Recall: 0.670160  v_F1: 0.671324  v_AUC: 0.896171
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.190318    reg_loss: 0.007126    l2_loss: 0.025190    loss: 0.222634
steps 7000    v_Prec: 0.701442  v_Recall: 0.647939  v_F1: 0.673630  v_AUC: 0.896257
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.188600    reg_loss: 0.007162    l2_loss: 0.025677    loss: 0.221440
steps 7200    v_Prec: 0.693189  v_Recall: 0.648727  v_F1: 0.670221  v_AUC: 0.896679
steps 7200    running time 269 seconds

Early stop model F1: 0.674177
testing thre: 0.36845425
testing Prec: 0.5274579105385171
testing Recall: 0.6745565006075334
testing F1: 0.5920064835352329
testing AUC: 0.8690333281226268
overall running time 272 seconds
(0.6486780546186487, 0.5795382746051033, 0.6121621274738814, 0.8690333281226268, 0.5252591)

2019-02-24 00:36:01.171623: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:36:02.698213: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:36:02.701584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:36:02.701652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.290000 seconds
loading data in 30.450000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.713384    reg_loss: 0.006473    l2_loss: 0.013292    loss: 0.733149
steps 200    v_Prec: 0.163895  v_Recall: 1.000000  v_F1: 0.281632  v_AUC: 0.497895
steps 200    running time 41 seconds

steps 400    base_loss: 0.579436    reg_loss: 0.006485    l2_loss: 0.013074    loss: 0.598995
steps 400    v_Prec: 0.164913  v_Recall: 0.993629  v_F1: 0.282877  v_AUC: 0.528663
steps 400    running time 47 seconds

steps 600    base_loss: 0.505985    reg_loss: 0.006474    l2_loss: 0.012753    loss: 0.525212
steps 600    v_Prec: 0.177221  v_Recall: 0.802341  v_F1: 0.290317  v_AUC: 0.568886
steps 600    running time 54 seconds

steps 800    base_loss: 0.464541    reg_loss: 0.006479    l2_loss: 0.012567    loss: 0.483587
steps 800    v_Prec: 0.242719  v_Recall: 0.564785  v_F1: 0.339525  v_AUC: 0.650076
steps 800    running time 61 seconds

steps 1000    base_loss: 0.441516    reg_loss: 0.006488    l2_loss: 0.012410    loss: 0.460415
steps 1000    v_Prec: 0.355103  v_Recall: 0.438640  v_F1: 0.392475  v_AUC: 0.701571
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.420297    reg_loss: 0.006491    l2_loss: 0.012366    loss: 0.439154
steps 1200    v_Prec: 0.408867  v_Recall: 0.475910  v_F1: 0.439848  v_AUC: 0.748877
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.394403    reg_loss: 0.006521    l2_loss: 0.012403    loss: 0.413327
steps 1400    v_Prec: 0.474804  v_Recall: 0.501234  v_F1: 0.487661  v_AUC: 0.782788
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.372848    reg_loss: 0.006566    l2_loss: 0.012504    loss: 0.391918
steps 1600    v_Prec: 0.523667  v_Recall: 0.528629  v_F1: 0.526136  v_AUC: 0.810286
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.350285    reg_loss: 0.006611    l2_loss: 0.012682    loss: 0.369579
steps 1800    v_Prec: 0.565613  v_Recall: 0.549892  v_F1: 0.557642  v_AUC: 0.829349
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.333702    reg_loss: 0.006661    l2_loss: 0.012910    loss: 0.353273
steps 2000    v_Prec: 0.605078  v_Recall: 0.556025  v_F1: 0.579515  v_AUC: 0.843647
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.317418    reg_loss: 0.006705    l2_loss: 0.013090    loss: 0.337213
steps 2200    v_Prec: 0.619190  v_Recall: 0.579199  v_F1: 0.598527  v_AUC: 0.853807
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.313902    reg_loss: 0.006725    l2_loss: 0.013379    loss: 0.334007
steps 2400    v_Prec: 0.629001  v_Recall: 0.602453  v_F1: 0.615441  v_AUC: 0.862368
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.306265    reg_loss: 0.006771    l2_loss: 0.013649    loss: 0.326685
steps 2600    v_Prec: 0.648090  v_Recall: 0.606594  v_F1: 0.626656  v_AUC: 0.869083
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.301472    reg_loss: 0.006799    l2_loss: 0.013966    loss: 0.322238
steps 2800    v_Prec: 0.640936  v_Recall: 0.626185  v_F1: 0.633474  v_AUC: 0.874421
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.287886    reg_loss: 0.006799    l2_loss: 0.014317    loss: 0.309002
steps 3000    v_Prec: 0.657174  v_Recall: 0.626662  v_F1: 0.641556  v_AUC: 0.879234
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.287240    reg_loss: 0.006826    l2_loss: 0.014622    loss: 0.308688
steps 3200    v_Prec: 0.662349  v_Recall: 0.631122  v_F1: 0.646358  v_AUC: 0.882886
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.287665    reg_loss: 0.006841    l2_loss: 0.015008    loss: 0.309514
steps 3400    v_Prec: 0.667532  v_Recall: 0.634945  v_F1: 0.650831  v_AUC: 0.886125
steps 3400    running time 150 seconds

steps 3600    base_loss: 0.281761    reg_loss: 0.006858    l2_loss: 0.015428    loss: 0.304048
steps 3600    v_Prec: 0.665478  v_Recall: 0.639245  v_F1: 0.652098  v_AUC: 0.888018
steps 3600    running time 157 seconds

steps 3800    base_loss: 0.280870    reg_loss: 0.006869    l2_loss: 0.015828    loss: 0.303567
steps 3800    v_Prec: 0.685616  v_Recall: 0.633909  v_F1: 0.658750  v_AUC: 0.891776
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.274864    reg_loss: 0.006905    l2_loss: 0.016293    loss: 0.298061
steps 4000    v_Prec: 0.667049  v_Recall: 0.649040  v_F1: 0.657921  v_AUC: 0.892823
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.282320    reg_loss: 0.006920    l2_loss: 0.016754    loss: 0.305994
steps 4200    v_Prec: 0.674723  v_Recall: 0.644740  v_F1: 0.659391  v_AUC: 0.894165
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.275598    reg_loss: 0.006897    l2_loss: 0.017320    loss: 0.299815
steps 4400    v_Prec: 0.675104  v_Recall: 0.645696  v_F1: 0.660072  v_AUC: 0.894356
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.274704    reg_loss: 0.006940    l2_loss: 0.017745    loss: 0.299389
steps 4600    v_Prec: 0.689144  v_Recall: 0.644581  v_F1: 0.666118  v_AUC: 0.898110
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.268562    reg_loss: 0.006933    l2_loss: 0.018321    loss: 0.293816
steps 4800    v_Prec: 0.679764  v_Recall: 0.651668  v_F1: 0.665420  v_AUC: 0.898129
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.274260    reg_loss: 0.006946    l2_loss: 0.018902    loss: 0.300108
steps 5000    v_Prec: 0.662995  v_Recall: 0.671020  v_F1: 0.666983  v_AUC: 0.900544
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.266332    reg_loss: 0.006961    l2_loss: 0.019501    loss: 0.292794
steps 5200    v_Prec: 0.681503  v_Recall: 0.657243  v_F1: 0.669153  v_AUC: 0.902162
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.262116    reg_loss: 0.006960    l2_loss: 0.020187    loss: 0.289263
steps 5400    v_Prec: 0.700481  v_Recall: 0.648881  v_F1: 0.673695  v_AUC: 0.903677
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.167575    reg_loss: 0.007160    l2_loss: 0.020956    loss: 0.195691
steps 5600    v_Prec: 0.673189  v_Recall: 0.654854  v_F1: 0.663895  v_AUC: 0.898163
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.173663    reg_loss: 0.007134    l2_loss: 0.021702    loss: 0.202499
steps 5800    v_Prec: 0.660874  v_Recall: 0.657243  v_F1: 0.659054  v_AUC: 0.892980
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.174895    reg_loss: 0.007156    l2_loss: 0.022317    loss: 0.204369
steps 6000    v_Prec: 0.684793  v_Recall: 0.640838  v_F1: 0.662087  v_AUC: 0.894148
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.184231    reg_loss: 0.007149    l2_loss: 0.023002    loss: 0.214382
steps 6200    v_Prec: 0.686642  v_Recall: 0.641475  v_F1: 0.663291  v_AUC: 0.894267
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.183480    reg_loss: 0.007170    l2_loss: 0.023572    loss: 0.214222
steps 6400    v_Prec: 0.698363  v_Recall: 0.635184  v_F1: 0.665277  v_AUC: 0.894498
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.185040    reg_loss: 0.007152    l2_loss: 0.024081    loss: 0.216273
steps 6600    v_Prec: 0.665488  v_Recall: 0.659712  v_F1: 0.662587  v_AUC: 0.892810
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.190140    reg_loss: 0.007143    l2_loss: 0.024678    loss: 0.221962
steps 6800    v_Prec: 0.687405  v_Recall: 0.649359  v_F1: 0.667841  v_AUC: 0.895088
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.184660    reg_loss: 0.007172    l2_loss: 0.025076    loss: 0.216908
steps 7000    v_Prec: 0.665355  v_Recall: 0.673091  v_F1: 0.669200  v_AUC: 0.896258
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.183309    reg_loss: 0.007182    l2_loss: 0.025574    loss: 0.216065
steps 7200    v_Prec: 0.699084  v_Recall: 0.650315  v_F1: 0.673818  v_AUC: 0.899119
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.185423    reg_loss: 0.007168    l2_loss: 0.026087    loss: 0.218678
steps 7400    v_Prec: 0.687989  v_Recall: 0.664649  v_F1: 0.676118  v_AUC: 0.900572
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.185554    reg_loss: 0.007183    l2_loss: 0.026436    loss: 0.219173
steps 7600    v_Prec: 0.701872  v_Recall: 0.650952  v_F1: 0.675453  v_AUC: 0.899526
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.182959    reg_loss: 0.007187    l2_loss: 0.026771    loss: 0.216916
steps 7800    v_Prec: 0.706913  v_Recall: 0.652305  v_F1: 0.678512  v_AUC: 0.900815
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.192968    reg_loss: 0.007165    l2_loss: 0.027168    loss: 0.227302
steps 8000    v_Prec: 0.701419  v_Recall: 0.665446  v_F1: 0.682959  v_AUC: 0.901662
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.185146    reg_loss: 0.007191    l2_loss: 0.027393    loss: 0.219730
steps 8200    v_Prec: 0.696188  v_Recall: 0.674843  v_F1: 0.685349  v_AUC: 0.903073
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.184888    reg_loss: 0.007174    l2_loss: 0.027723    loss: 0.219785
steps 8400    v_Prec: 0.715331  v_Recall: 0.653978  v_F1: 0.683280  v_AUC: 0.902743
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.188819    reg_loss: 0.007195    l2_loss: 0.028045    loss: 0.224060
steps 8600    v_Prec: 0.720563  v_Recall: 0.664729  v_F1: 0.691521  v_AUC: 0.906589
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.199398    reg_loss: 0.007186    l2_loss: 0.028293    loss: 0.234877
steps 8800    v_Prec: 0.705681  v_Recall: 0.689496  v_F1: 0.697495  v_AUC: 0.909586
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.191954    reg_loss: 0.007188    l2_loss: 0.028581    loss: 0.227723
steps 9000    v_Prec: 0.737005  v_Recall: 0.665047  v_F1: 0.699180  v_AUC: 0.910349
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.193552    reg_loss: 0.007197    l2_loss: 0.028841    loss: 0.229590
steps 9200    v_Prec: 0.729343  v_Recall: 0.673409  v_F1: 0.700261  v_AUC: 0.910563
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.196106    reg_loss: 0.007196    l2_loss: 0.029027    loss: 0.232330
steps 9400    v_Prec: 0.750611  v_Recall: 0.660110  v_F1: 0.702458  v_AUC: 0.913257
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.184116    reg_loss: 0.007173    l2_loss: 0.029231    loss: 0.220521
steps 9600    v_Prec: 0.720067  v_Recall: 0.688700  v_F1: 0.704034  v_AUC: 0.913769
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.190519    reg_loss: 0.007190    l2_loss: 0.029354    loss: 0.227063
steps 9800    v_Prec: 0.749955  v_Recall: 0.663534  v_F1: 0.704103  v_AUC: 0.914167
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.192580    reg_loss: 0.007209    l2_loss: 0.029636    loss: 0.229425
steps 10000    v_Prec: 0.724857  v_Recall: 0.695070  v_F1: 0.709651  v_AUC: 0.915916
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.193795    reg_loss: 0.007184    l2_loss: 0.029874    loss: 0.230853
steps 10200    v_Prec: 0.747235  v_Recall: 0.683205  v_F1: 0.713787  v_AUC: 0.918543
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.187735    reg_loss: 0.007213    l2_loss: 0.030008    loss: 0.224956
steps 10400    v_Prec: 0.731967  v_Recall: 0.699849  v_F1: 0.715548  v_AUC: 0.918277
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.190783    reg_loss: 0.007193    l2_loss: 0.030168    loss: 0.228144
steps 10600    v_Prec: 0.753783  v_Recall: 0.674365  v_F1: 0.711866  v_AUC: 0.919044
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.181798    reg_loss: 0.007241    l2_loss: 0.030368    loss: 0.219407
steps 10800    v_Prec: 0.718324  v_Recall: 0.708370  v_F1: 0.713312  v_AUC: 0.919918
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.075455    reg_loss: 0.007356    l2_loss: 0.030516    loss: 0.113327
steps 11000    v_Prec: 0.704194  v_Recall: 0.685912  v_F1: 0.694933  v_AUC: 0.911122
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.075988    reg_loss: 0.007342    l2_loss: 0.030521    loss: 0.113851
steps 11200    v_Prec: 0.684527  v_Recall: 0.689814  v_F1: 0.687160  v_AUC: 0.906530
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.073586    reg_loss: 0.007336    l2_loss: 0.030644    loss: 0.111566
steps 11400    v_Prec: 0.690055  v_Recall: 0.677471  v_F1: 0.683705  v_AUC: 0.904750
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.079930    reg_loss: 0.007319    l2_loss: 0.030649    loss: 0.117898
steps 11600    v_Prec: 0.726399  v_Recall: 0.637891  v_F1: 0.679274  v_AUC: 0.902774
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.080448    reg_loss: 0.007310    l2_loss: 0.030829    loss: 0.118586
steps 11800    v_Prec: 0.679205  v_Recall: 0.677311  v_F1: 0.678257  v_AUC: 0.902173
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.081586    reg_loss: 0.007313    l2_loss: 0.030976    loss: 0.119875
steps 12000    v_Prec: 0.698783  v_Recall: 0.663056  v_F1: 0.680451  v_AUC: 0.901870
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.085988    reg_loss: 0.007325    l2_loss: 0.031085    loss: 0.124398
steps 12200    v_Prec: 0.697070  v_Recall: 0.653659  v_F1: 0.674667  v_AUC: 0.899647
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.082237    reg_loss: 0.007295    l2_loss: 0.031291    loss: 0.120823
steps 12400    v_Prec: 0.676618  v_Recall: 0.667835  v_F1: 0.672198  v_AUC: 0.898646
steps 12400    running time 441 seconds

Early stop model F1: 0.715548
testing thre: 0.2979082
testing Prec: 0.5160824945080167
testing Recall: 0.7650060753341433
testing F1: 0.6163605748521752
testing AUC: 0.8971282274498142
overall running time 444 seconds
(0.6843196682086458, 0.6255164034021872, 0.6535980904981972, 0.8971282274498142, 0.6296298)

2019-02-24 00:41:16.104798: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:41:17.436243: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:41:17.437203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:41:17.437239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.530000 seconds
loading data in 30.770000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.830112    reg_loss: 0.006474    l2_loss: 0.013256    loss: 1.849842
steps 200    v_Prec: 0.163806  v_Recall: 0.997449  v_F1: 0.281399  v_AUC: 0.509129
steps 200    running time 41 seconds

steps 400    base_loss: 1.214572    reg_loss: 0.006465    l2_loss: 0.012952    loss: 1.233989
steps 400    v_Prec: 0.165330  v_Recall: 0.967791  v_F1: 0.282414  v_AUC: 0.518548
steps 400    running time 48 seconds

steps 600    base_loss: 0.549345    reg_loss: 0.006444    l2_loss: 0.012557    loss: 0.568346
steps 600    v_Prec: 0.165873  v_Recall: 0.977757  v_F1: 0.283630  v_AUC: 0.520190
steps 600    running time 55 seconds

steps 800    base_loss: 0.478294    reg_loss: 0.006415    l2_loss: 0.012395    loss: 0.497105
steps 800    v_Prec: 0.168069  v_Recall: 0.941322  v_F1: 0.285214  v_AUC: 0.534658
steps 800    running time 62 seconds

steps 1000    base_loss: 0.472912    reg_loss: 0.006421    l2_loss: 0.012229    loss: 0.491561
steps 1000    v_Prec: 0.191393  v_Recall: 0.645300  v_F1: 0.295224  v_AUC: 0.580978
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.455849    reg_loss: 0.006391    l2_loss: 0.012024    loss: 0.474263
steps 1200    v_Prec: 0.195596  v_Recall: 0.641633  v_F1: 0.299801  v_AUC: 0.585742
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.453420    reg_loss: 0.006384    l2_loss: 0.011932    loss: 0.471737
steps 1400    v_Prec: 0.268664  v_Recall: 0.498924  v_F1: 0.349258  v_AUC: 0.666569
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.435172    reg_loss: 0.006305    l2_loss: 0.011893    loss: 0.453370
steps 1600    v_Prec: 0.348719  v_Recall: 0.464402  v_F1: 0.398331  v_AUC: 0.720888
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.412544    reg_loss: 0.006209    l2_loss: 0.012021    loss: 0.430774
steps 1800    v_Prec: 0.405548  v_Recall: 0.477876  v_F1: 0.438751  v_AUC: 0.757937
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.390157    reg_loss: 0.006136    l2_loss: 0.012396    loss: 0.408689
steps 2000    v_Prec: 0.433156  v_Recall: 0.533684  v_F1: 0.478194  v_AUC: 0.791716
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.367378    reg_loss: 0.006084    l2_loss: 0.012834    loss: 0.386296
steps 2200    v_Prec: 0.481232  v_Recall: 0.559117  v_F1: 0.517259  v_AUC: 0.817941
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.344932    reg_loss: 0.006035    l2_loss: 0.013361    loss: 0.364327
steps 2400    v_Prec: 0.518516  v_Recall: 0.568205  v_F1: 0.542225  v_AUC: 0.834202
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.341742    reg_loss: 0.006028    l2_loss: 0.013962    loss: 0.361732
steps 2600    v_Prec: 0.542547  v_Recall: 0.593718  v_F1: 0.566980  v_AUC: 0.847604
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.337376    reg_loss: 0.005997    l2_loss: 0.014467    loss: 0.357839
steps 2800    v_Prec: 0.568141  v_Recall: 0.582636  v_F1: 0.575297  v_AUC: 0.855498
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.324623    reg_loss: 0.005957    l2_loss: 0.015035    loss: 0.345615
steps 3000    v_Prec: 0.558699  v_Recall: 0.618831  v_F1: 0.587230  v_AUC: 0.860847
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.317731    reg_loss: 0.005925    l2_loss: 0.015637    loss: 0.339293
steps 3200    v_Prec: 0.587385  v_Recall: 0.612533  v_F1: 0.599696  v_AUC: 0.868075
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.313939    reg_loss: 0.005884    l2_loss: 0.016356    loss: 0.336179
steps 3400    v_Prec: 0.593241  v_Recall: 0.621382  v_F1: 0.606986  v_AUC: 0.869908
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.301158    reg_loss: 0.005827    l2_loss: 0.016985    loss: 0.323970
steps 3600    v_Prec: 0.581370  v_Recall: 0.649366  v_F1: 0.613490  v_AUC: 0.874611
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.301644    reg_loss: 0.005803    l2_loss: 0.017687    loss: 0.325135
steps 3800    v_Prec: 0.597627  v_Recall: 0.646416  v_F1: 0.621065  v_AUC: 0.877793
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.297847    reg_loss: 0.005768    l2_loss: 0.018328    loss: 0.321943
steps 4000    v_Prec: 0.625128  v_Recall: 0.631906  v_F1: 0.628499  v_AUC: 0.880344
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.302649    reg_loss: 0.005722    l2_loss: 0.019198    loss: 0.327569
steps 4200    v_Prec: 0.653104  v_Recall: 0.615562  v_F1: 0.633778  v_AUC: 0.883723
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.291295    reg_loss: 0.005683    l2_loss: 0.019848    loss: 0.316826
steps 4400    v_Prec: 0.646654  v_Recall: 0.629435  v_F1: 0.637928  v_AUC: 0.885829
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.294970    reg_loss: 0.005640    l2_loss: 0.020631    loss: 0.321241
steps 4600    v_Prec: 0.658929  v_Recall: 0.633660  v_F1: 0.646048  v_AUC: 0.888657
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.295324    reg_loss: 0.005612    l2_loss: 0.021443    loss: 0.322379
steps 4800    v_Prec: 0.632190  v_Recall: 0.655425  v_F1: 0.643598  v_AUC: 0.888486
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.289504    reg_loss: 0.005569    l2_loss: 0.022191    loss: 0.317263
steps 5000    v_Prec: 0.662586  v_Recall: 0.634378  v_F1: 0.648175  v_AUC: 0.890471
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.288754    reg_loss: 0.005536    l2_loss: 0.023020    loss: 0.317310
steps 5200    v_Prec: 0.643243  v_Recall: 0.655346  v_F1: 0.649238  v_AUC: 0.890397
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.272922    reg_loss: 0.005488    l2_loss: 0.023908    loss: 0.302317
steps 5400    v_Prec: 0.643816  v_Recall: 0.657418  v_F1: 0.650546  v_AUC: 0.893574
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.184700    reg_loss: 0.005746    l2_loss: 0.024614    loss: 0.215060
steps 5600    v_Prec: 0.653398  v_Recall: 0.639959  v_F1: 0.646609  v_AUC: 0.889868
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.181429    reg_loss: 0.005795    l2_loss: 0.025057    loss: 0.212281
steps 5800    v_Prec: 0.635573  v_Recall: 0.646416  v_F1: 0.640949  v_AUC: 0.885740
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.180845    reg_loss: 0.005859    l2_loss: 0.025581    loss: 0.212286
steps 6000    v_Prec: 0.641826  v_Recall: 0.641314  v_F1: 0.641570  v_AUC: 0.885396
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.166457    reg_loss: 0.005898    l2_loss: 0.026201    loss: 0.198556
steps 6200    v_Prec: 0.647186  v_Recall: 0.620665  v_F1: 0.633648  v_AUC: 0.882356
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.171592    reg_loss: 0.005892    l2_loss: 0.026717    loss: 0.204201
steps 6400    v_Prec: 0.647054  v_Recall: 0.623376  v_F1: 0.634994  v_AUC: 0.882274
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.181994    reg_loss: 0.005883    l2_loss: 0.027053    loss: 0.214931
steps 6600    v_Prec: 0.650755  v_Recall: 0.624970  v_F1: 0.637602  v_AUC: 0.884357
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.181159    reg_loss: 0.005852    l2_loss: 0.027572    loss: 0.214583
steps 6800    v_Prec: 0.610021  v_Recall: 0.663956  v_F1: 0.635847  v_AUC: 0.885377
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.185160    reg_loss: 0.005849    l2_loss: 0.028095    loss: 0.219105
steps 7000    v_Prec: 0.638457  v_Recall: 0.627920  v_F1: 0.633144  v_AUC: 0.884914
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.189704    reg_loss: 0.005875    l2_loss: 0.028297    loss: 0.223876
steps 7200    v_Prec: 0.636349  v_Recall: 0.642031  v_F1: 0.639178  v_AUC: 0.886114
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.183167    reg_loss: 0.005858    l2_loss: 0.028754    loss: 0.217779
steps 7400    v_Prec: 0.660876  v_Recall: 0.627840  v_F1: 0.643935  v_AUC: 0.887673
steps 7400    running time 278 seconds

Early stop model F1: 0.650546
testing thre: 0.2676573
testing Prec: 0.47522935779816516
testing Recall: 0.7552855407047387
testing F1: 0.5833880807132801
testing AUC: 0.8783837328278657
overall running time 281 seconds
(0.6708599934931135, 0.6013122721749696, 0.6341850988030858, 0.8783837328278657, 0.53644663)

2019-02-24 00:44:39.970864: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:44:40.869839: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:44:40.872139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:44:40.872195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.280000 seconds
loading data in 29.430000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.526328    reg_loss: 0.006509    l2_loss: 0.013357    loss: 0.546194
steps 200    v_Prec: 0.165488  v_Recall: 0.997002  v_F1: 0.283859  v_AUC: 0.523836
steps 200    running time 39 seconds

steps 400    base_loss: 0.483380    reg_loss: 0.006500    l2_loss: 0.013331    loss: 0.503211
steps 400    v_Prec: 0.172585  v_Recall: 0.871311  v_F1: 0.288103  v_AUC: 0.555814
steps 400    running time 47 seconds

steps 600    base_loss: 0.471661    reg_loss: 0.006477    l2_loss: 0.013321    loss: 0.491459
steps 600    v_Prec: 0.202052  v_Recall: 0.618274  v_F1: 0.304571  v_AUC: 0.599711
steps 600    running time 53 seconds

steps 800    base_loss: 0.456933    reg_loss: 0.006449    l2_loss: 0.013267    loss: 0.476649
steps 800    v_Prec: 0.233053  v_Recall: 0.556888  v_F1: 0.328592  v_AUC: 0.636436
steps 800    running time 60 seconds

steps 1000    base_loss: 0.438931    reg_loss: 0.006411    l2_loss: 0.013303    loss: 0.458646
steps 1000    v_Prec: 0.285570  v_Recall: 0.489190  v_F1: 0.360622  v_AUC: 0.671058
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.426529    reg_loss: 0.006380    l2_loss: 0.013293    loss: 0.446201
steps 1200    v_Prec: 0.387364  v_Recall: 0.449897  v_F1: 0.416296  v_AUC: 0.722919
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.398688    reg_loss: 0.006320    l2_loss: 0.013463    loss: 0.418470
steps 1400    v_Prec: 0.477945  v_Recall: 0.482168  v_F1: 0.480047  v_AUC: 0.766269
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.373334    reg_loss: 0.006245    l2_loss: 0.013620    loss: 0.393200
steps 1600    v_Prec: 0.557016  v_Recall: 0.511441  v_F1: 0.533257  v_AUC: 0.799873
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.349214    reg_loss: 0.006187    l2_loss: 0.013812    loss: 0.369214
steps 1800    v_Prec: 0.616188  v_Recall: 0.531008  v_F1: 0.570436  v_AUC: 0.823055
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.328357    reg_loss: 0.006127    l2_loss: 0.014084    loss: 0.348568
steps 2000    v_Prec: 0.670633  v_Recall: 0.533691  v_F1: 0.594376  v_AUC: 0.838387
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.321086    reg_loss: 0.006081    l2_loss: 0.014402    loss: 0.341568
steps 2200    v_Prec: 0.657493  v_Recall: 0.567382  v_F1: 0.609123  v_AUC: 0.848822
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.302883    reg_loss: 0.006011    l2_loss: 0.014609    loss: 0.323503
steps 2400    v_Prec: 0.676763  v_Recall: 0.580006  v_F1: 0.624660  v_AUC: 0.857765
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.300941    reg_loss: 0.005984    l2_loss: 0.014886    loss: 0.321811
steps 2600    v_Prec: 0.716899  v_Recall: 0.572037  v_F1: 0.636328  v_AUC: 0.864981
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.293864    reg_loss: 0.005954    l2_loss: 0.015149    loss: 0.314967
steps 2800    v_Prec: 0.707528  v_Recall: 0.594761  v_F1: 0.646262  v_AUC: 0.871365
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.294090    reg_loss: 0.005925    l2_loss: 0.015454    loss: 0.315469
steps 3000    v_Prec: 0.734897  v_Recall: 0.588370  v_F1: 0.653521  v_AUC: 0.874236
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.282286    reg_loss: 0.005885    l2_loss: 0.015720    loss: 0.303890
steps 3200    v_Prec: 0.687329  v_Recall: 0.636027  v_F1: 0.660684  v_AUC: 0.878099
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.274804    reg_loss: 0.005862    l2_loss: 0.015985    loss: 0.296651
steps 3400    v_Prec: 0.735227  v_Recall: 0.614565  v_F1: 0.669503  v_AUC: 0.882700
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.282495    reg_loss: 0.005845    l2_loss: 0.016257    loss: 0.304597
steps 3600    v_Prec: 0.734158  v_Recall: 0.622534  v_F1: 0.673754  v_AUC: 0.885950
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.275996    reg_loss: 0.005828    l2_loss: 0.016560    loss: 0.298385
steps 3800    v_Prec: 0.731976  v_Recall: 0.638472  v_F1: 0.682035  v_AUC: 0.890626
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.270571    reg_loss: 0.005803    l2_loss: 0.016759    loss: 0.293134
steps 4000    v_Prec: 0.742560  v_Recall: 0.641786  v_F1: 0.688505  v_AUC: 0.893396
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.268786    reg_loss: 0.005804    l2_loss: 0.017075    loss: 0.291665
steps 4200    v_Prec: 0.714310  v_Recall: 0.673505  v_F1: 0.693307  v_AUC: 0.896361
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.267756    reg_loss: 0.005793    l2_loss: 0.017390    loss: 0.290939
steps 4400    v_Prec: 0.727658  v_Recall: 0.663011  v_F1: 0.693832  v_AUC: 0.896945
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.269972    reg_loss: 0.005777    l2_loss: 0.017643    loss: 0.293392
steps 4600    v_Prec: 0.742232  v_Recall: 0.650229  v_F1: 0.693191  v_AUC: 0.897696
steps 4600    running time 190 seconds

steps 4800    base_loss: 0.265539    reg_loss: 0.005762    l2_loss: 0.017876    loss: 0.289176
steps 4800    v_Prec: 0.731357  v_Recall: 0.671690  v_F1: 0.700255  v_AUC: 0.900831
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.256860    reg_loss: 0.005753    l2_loss: 0.018248    loss: 0.280862
steps 5000    v_Prec: 0.760652  v_Recall: 0.652201  v_F1: 0.702264  v_AUC: 0.901894
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.255522    reg_loss: 0.005739    l2_loss: 0.018670    loss: 0.279931
steps 5200    v_Prec: 0.734414  v_Recall: 0.675714  v_F1: 0.703842  v_AUC: 0.904606
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.251596    reg_loss: 0.005716    l2_loss: 0.019071    loss: 0.276382
steps 5400    v_Prec: 0.731366  v_Recall: 0.684393  v_F1: 0.707100  v_AUC: 0.908616
steps 5400    running time 217 seconds

steps 5600    base_loss: 0.166813    reg_loss: 0.005460    l2_loss: 0.019423    loss: 0.191697
steps 5600    v_Prec: 0.738205  v_Recall: 0.667903  v_F1: 0.701297  v_AUC: 0.899010
steps 5600    running time 223 seconds

steps 5800    base_loss: 0.170673    reg_loss: 0.005448    l2_loss: 0.020102    loss: 0.196223
steps 5800    v_Prec: 0.745805  v_Recall: 0.659303  v_F1: 0.699891  v_AUC: 0.898846
steps 5800    running time 230 seconds

steps 6000    base_loss: 0.171885    reg_loss: 0.005465    l2_loss: 0.020762    loss: 0.198112
steps 6000    v_Prec: 0.743763  v_Recall: 0.668061  v_F1: 0.703882  v_AUC: 0.898563
steps 6000    running time 236 seconds

steps 6200    base_loss: 0.166807    reg_loss: 0.005424    l2_loss: 0.021424    loss: 0.193655
steps 6200    v_Prec: 0.753986  v_Recall: 0.660407  v_F1: 0.704101  v_AUC: 0.898402
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.176648    reg_loss: 0.005460    l2_loss: 0.021924    loss: 0.204032
steps 6400    v_Prec: 0.759594  v_Recall: 0.660644  v_F1: 0.706672  v_AUC: 0.897363
steps 6400    running time 249 seconds

steps 6600    base_loss: 0.185149    reg_loss: 0.005443    l2_loss: 0.022557    loss: 0.213149
steps 6600    v_Prec: 0.747082  v_Recall: 0.671690  v_F1: 0.707383  v_AUC: 0.899918
steps 6600    running time 255 seconds

steps 6800    base_loss: 0.190287    reg_loss: 0.005424    l2_loss: 0.022899    loss: 0.218610
steps 6800    v_Prec: 0.747884  v_Recall: 0.676187  v_F1: 0.710231  v_AUC: 0.901416
steps 6800    running time 262 seconds

steps 7000    base_loss: 0.180977    reg_loss: 0.005416    l2_loss: 0.023223    loss: 0.209616
steps 7000    v_Prec: 0.742651  v_Recall: 0.689680  v_F1: 0.715186  v_AUC: 0.901897
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.181803    reg_loss: 0.005395    l2_loss: 0.023585    loss: 0.210783
steps 7200    v_Prec: 0.744358  v_Recall: 0.692205  v_F1: 0.717334  v_AUC: 0.903876
steps 7200    running time 275 seconds

steps 7400    base_loss: 0.187656    reg_loss: 0.005405    l2_loss: 0.023871    loss: 0.216932
steps 7400    v_Prec: 0.758493  v_Recall: 0.679975  v_F1: 0.717091  v_AUC: 0.903122
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.177047    reg_loss: 0.005374    l2_loss: 0.024154    loss: 0.206575
steps 7600    v_Prec: 0.765194  v_Recall: 0.684472  v_F1: 0.722585  v_AUC: 0.905077
steps 7600    running time 288 seconds

steps 7800    base_loss: 0.178589    reg_loss: 0.005385    l2_loss: 0.024272    loss: 0.208246
steps 7800    v_Prec: 0.750468  v_Recall: 0.695282  v_F1: 0.721822  v_AUC: 0.907649
steps 7800    running time 295 seconds

steps 8000    base_loss: 0.178112    reg_loss: 0.005362    l2_loss: 0.024437    loss: 0.207911
steps 8000    v_Prec: 0.786425  v_Recall: 0.667350  v_F1: 0.722011  v_AUC: 0.907305
steps 8000    running time 301 seconds

steps 8200    base_loss: 0.187728    reg_loss: 0.005366    l2_loss: 0.024678    loss: 0.217772
steps 8200    v_Prec: 0.761277  v_Recall: 0.688417  v_F1: 0.723016  v_AUC: 0.909145
steps 8200    running time 308 seconds

steps 8400    base_loss: 0.174528    reg_loss: 0.005300    l2_loss: 0.024741    loss: 0.204569
steps 8400    v_Prec: 0.768207  v_Recall: 0.687470  v_F1: 0.725600  v_AUC: 0.912202
steps 8400    running time 315 seconds

steps 8600    base_loss: 0.176659    reg_loss: 0.005317    l2_loss: 0.024772    loss: 0.206747
steps 8600    v_Prec: 0.783949  v_Recall: 0.675951  v_F1: 0.725955  v_AUC: 0.911541
steps 8600    running time 321 seconds

steps 8800    base_loss: 0.187103    reg_loss: 0.005347    l2_loss: 0.024870    loss: 0.217320
steps 8800    v_Prec: 0.792259  v_Recall: 0.676740  v_F1: 0.729957  v_AUC: 0.912732
steps 8800    running time 328 seconds

steps 9000    base_loss: 0.192074    reg_loss: 0.005338    l2_loss: 0.024896    loss: 0.222308
steps 9000    v_Prec: 0.766586  v_Recall: 0.701988  v_F1: 0.732867  v_AUC: 0.913976
steps 9000    running time 335 seconds

steps 9200    base_loss: 0.179469    reg_loss: 0.005314    l2_loss: 0.025097    loss: 0.209879
steps 9200    v_Prec: 0.806585  v_Recall: 0.676503  v_F1: 0.735839  v_AUC: 0.914529
steps 9200    running time 342 seconds

steps 9400    base_loss: 0.180583    reg_loss: 0.005299    l2_loss: 0.025014    loss: 0.210896
steps 9400    v_Prec: 0.787295  v_Recall: 0.690390  v_F1: 0.735665  v_AUC: 0.915894
steps 9400    running time 349 seconds

steps 9600    base_loss: 0.182380    reg_loss: 0.005297    l2_loss: 0.025085    loss: 0.212762
steps 9600    v_Prec: 0.757522  v_Recall: 0.713113  v_F1: 0.734647  v_AUC: 0.917625
steps 9600    running time 355 seconds

steps 9800    base_loss: 0.177402    reg_loss: 0.005272    l2_loss: 0.025095    loss: 0.207769
steps 9800    v_Prec: 0.774311  v_Recall: 0.703014  v_F1: 0.736942  v_AUC: 0.917252
steps 9800    running time 361 seconds

steps 10000    base_loss: 0.186968    reg_loss: 0.005274    l2_loss: 0.025098    loss: 0.217340
steps 10000    v_Prec: 0.771517  v_Recall: 0.710825  v_F1: 0.739929  v_AUC: 0.919110
steps 10000    running time 368 seconds

steps 10200    base_loss: 0.183489    reg_loss: 0.005275    l2_loss: 0.025377    loss: 0.214141
steps 10200    v_Prec: 0.775485  v_Recall: 0.705855  v_F1: 0.739033  v_AUC: 0.919369
steps 10200    running time 374 seconds

steps 10400    base_loss: 0.190261    reg_loss: 0.005284    l2_loss: 0.025364    loss: 0.220908
steps 10400    v_Prec: 0.779264  v_Recall: 0.708064  v_F1: 0.741959  v_AUC: 0.922781
steps 10400    running time 380 seconds

steps 10600    base_loss: 0.182331    reg_loss: 0.005271    l2_loss: 0.025389    loss: 0.212990
steps 10600    v_Prec: 0.790598  v_Recall: 0.697964  v_F1: 0.741399  v_AUC: 0.921718
steps 10600    running time 387 seconds

steps 10800    base_loss: 0.172048    reg_loss: 0.005214    l2_loss: 0.025457    loss: 0.202718
steps 10800    v_Prec: 0.790996  v_Recall: 0.705618  v_F1: 0.745872  v_AUC: 0.922274
steps 10800    running time 393 seconds

steps 11000    base_loss: 0.069776    reg_loss: 0.004904    l2_loss: 0.025432    loss: 0.100112
steps 11000    v_Prec: 0.769556  v_Recall: 0.718794  v_F1: 0.743309  v_AUC: 0.921028
steps 11000    running time 399 seconds

steps 11200    base_loss: 0.066020    reg_loss: 0.004913    l2_loss: 0.025346    loss: 0.096279
steps 11200    v_Prec: 0.773548  v_Recall: 0.710194  v_F1: 0.740518  v_AUC: 0.917494
steps 11200    running time 406 seconds

steps 11400    base_loss: 0.066362    reg_loss: 0.004927    l2_loss: 0.025195    loss: 0.096484
steps 11400    v_Prec: 0.769284  v_Recall: 0.704276  v_F1: 0.735346  v_AUC: 0.914095
steps 11400    running time 412 seconds

steps 11600    base_loss: 0.072671    reg_loss: 0.004955    l2_loss: 0.025184    loss: 0.102810
steps 11600    v_Prec: 0.789469  v_Recall: 0.684946  v_F1: 0.733502  v_AUC: 0.913656
steps 11600    running time 419 seconds

steps 11800    base_loss: 0.079551    reg_loss: 0.004972    l2_loss: 0.025241    loss: 0.109763
steps 11800    v_Prec: 0.781228  v_Recall: 0.692836  v_F1: 0.734382  v_AUC: 0.913431
steps 11800    running time 425 seconds

steps 12000    base_loss: 0.074965    reg_loss: 0.004957    l2_loss: 0.025333    loss: 0.105255
steps 12000    v_Prec: 0.752802  v_Recall: 0.710036  v_F1: 0.730794  v_AUC: 0.910394
steps 12000    running time 432 seconds

steps 12200    base_loss: 0.070604    reg_loss: 0.004969    l2_loss: 0.025297    loss: 0.100870
steps 12200    v_Prec: 0.782239  v_Recall: 0.690153  v_F1: 0.733317  v_AUC: 0.913643
steps 12200    running time 438 seconds

steps 12400    base_loss: 0.077359    reg_loss: 0.004993    l2_loss: 0.025386    loss: 0.107738
steps 12400    v_Prec: 0.759138  v_Recall: 0.703014  v_F1: 0.729999  v_AUC: 0.913029
steps 12400    running time 445 seconds

steps 12600    base_loss: 0.080372    reg_loss: 0.004974    l2_loss: 0.025312    loss: 0.110657
steps 12600    v_Prec: 0.754837  v_Recall: 0.711062  v_F1: 0.732296  v_AUC: 0.913509
steps 12600    running time 451 seconds

steps 12800    base_loss: 0.081266    reg_loss: 0.004987    l2_loss: 0.025294    loss: 0.111548
steps 12800    v_Prec: 0.760560  v_Recall: 0.711772  v_F1: 0.735358  v_AUC: 0.914844
steps 12800    running time 458 seconds

Early stop model F1: 0.745872
testing thre: 0.5292955
testing Prec: 0.5976310542981119
testing Recall: 0.743037667071689
testing F1: 0.6624490857093337
testing AUC: 0.9023156555673355
overall running time 461 seconds
(0.7242894337166413, 0.6489914945321993, 0.6845761451898181, 0.9023156555673355, 0.78704405)

2019-02-24 00:50:06.412244: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:50:07.628112: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:50:07.631981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:50:07.632028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.770000 seconds
loading data in 30.060000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.003
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.554516    reg_loss: 0.006484    l2_loss: 0.013329    loss: 0.574328
steps 200    v_Prec: 0.164077  v_Recall: 1.000000  v_F1: 0.281900  v_AUC: 0.483137
steps 200    running time 40 seconds

steps 400    base_loss: 0.520003    reg_loss: 0.006480    l2_loss: 0.013315    loss: 0.539798
steps 400    v_Prec: 0.164092  v_Recall: 1.000000  v_F1: 0.281922  v_AUC: 0.513389
steps 400    running time 47 seconds

steps 600    base_loss: 0.494939    reg_loss: 0.006491    l2_loss: 0.013175    loss: 0.514605
steps 600    v_Prec: 0.189189  v_Recall: 0.658211  v_F1: 0.293901  v_AUC: 0.583315
steps 600    running time 53 seconds

steps 800    base_loss: 0.459398    reg_loss: 0.006511    l2_loss: 0.013039    loss: 0.478949
steps 800    v_Prec: 0.276194  v_Recall: 0.483817  v_F1: 0.351646  v_AUC: 0.666378
steps 800    running time 60 seconds

steps 1000    base_loss: 0.415475    reg_loss: 0.006545    l2_loss: 0.012958    loss: 0.434978
steps 1000    v_Prec: 0.387065  v_Recall: 0.463062  v_F1: 0.421666  v_AUC: 0.733202
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.391502    reg_loss: 0.006580    l2_loss: 0.012986    loss: 0.411068
steps 1200    v_Prec: 0.478785  v_Recall: 0.480080  v_F1: 0.479431  v_AUC: 0.779674
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.369877    reg_loss: 0.006608    l2_loss: 0.013026    loss: 0.389511
steps 1400    v_Prec: 0.534288  v_Recall: 0.519205  v_F1: 0.526638  v_AUC: 0.809046
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.350397    reg_loss: 0.006647    l2_loss: 0.013135    loss: 0.370179
steps 1600    v_Prec: 0.549400  v_Recall: 0.567793  v_F1: 0.558445  v_AUC: 0.830892
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.319132    reg_loss: 0.006649    l2_loss: 0.013233    loss: 0.339013
steps 1800    v_Prec: 0.608954  v_Recall: 0.554911  v_F1: 0.580677  v_AUC: 0.843133
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.321490    reg_loss: 0.006702    l2_loss: 0.013380    loss: 0.341572
steps 2000    v_Prec: 0.601957  v_Recall: 0.596740  v_F1: 0.599337  v_AUC: 0.853704
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.306228    reg_loss: 0.006723    l2_loss: 0.013550    loss: 0.326502
steps 2200    v_Prec: 0.652927  v_Recall: 0.578211  v_F1: 0.613302  v_AUC: 0.861544
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.303748    reg_loss: 0.006758    l2_loss: 0.013761    loss: 0.324267
steps 2400    v_Prec: 0.662540  v_Recall: 0.587356  v_F1: 0.622687  v_AUC: 0.868959
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.297198    reg_loss: 0.006772    l2_loss: 0.013954    loss: 0.317924
steps 2600    v_Prec: 0.634377  v_Recall: 0.634831  v_F1: 0.634604  v_AUC: 0.875529
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.294860    reg_loss: 0.006816    l2_loss: 0.014206    loss: 0.315882
steps 2800    v_Prec: 0.665715  v_Recall: 0.611769  v_F1: 0.637603  v_AUC: 0.879824
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.281087    reg_loss: 0.006804    l2_loss: 0.014442    loss: 0.302333
steps 3000    v_Prec: 0.665039  v_Recall: 0.628072  v_F1: 0.646027  v_AUC: 0.883818
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.285515    reg_loss: 0.006830    l2_loss: 0.014757    loss: 0.307101
steps 3200    v_Prec: 0.666219  v_Recall: 0.631252  v_F1: 0.648265  v_AUC: 0.886426
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.286433    reg_loss: 0.006834    l2_loss: 0.015007    loss: 0.308275
steps 3400    v_Prec: 0.683872  v_Recall: 0.624811  v_F1: 0.653009  v_AUC: 0.890191
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.281649    reg_loss: 0.006846    l2_loss: 0.015378    loss: 0.303873
steps 3600    v_Prec: 0.663762  v_Recall: 0.648032  v_F1: 0.655802  v_AUC: 0.891429
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.275864    reg_loss: 0.006861    l2_loss: 0.015708    loss: 0.298433
steps 3800    v_Prec: 0.704823  v_Recall: 0.615984  v_F1: 0.657416  v_AUC: 0.893787
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.274425    reg_loss: 0.006893    l2_loss: 0.016080    loss: 0.297398
steps 4000    v_Prec: 0.662789  v_Recall: 0.652406  v_F1: 0.657556  v_AUC: 0.895000
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.271979    reg_loss: 0.006882    l2_loss: 0.016577    loss: 0.295438
steps 4200    v_Prec: 0.712529  v_Recall: 0.617336  v_F1: 0.661525  v_AUC: 0.894536
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.275189    reg_loss: 0.006925    l2_loss: 0.016996    loss: 0.299110
steps 4400    v_Prec: 0.687979  v_Recall: 0.642624  v_F1: 0.664529  v_AUC: 0.896689
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.274191    reg_loss: 0.006930    l2_loss: 0.017437    loss: 0.298558
steps 4600    v_Prec: 0.671568  v_Recall: 0.660994  v_F1: 0.666239  v_AUC: 0.897477
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.270080    reg_loss: 0.006923    l2_loss: 0.017905    loss: 0.294908
steps 4800    v_Prec: 0.692184  v_Recall: 0.651451  v_F1: 0.671200  v_AUC: 0.899379
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.274063    reg_loss: 0.006933    l2_loss: 0.018522    loss: 0.299518
steps 5000    v_Prec: 0.666772  v_Recall: 0.670060  v_F1: 0.668412  v_AUC: 0.901193
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.266558    reg_loss: 0.006948    l2_loss: 0.019025    loss: 0.292531
steps 5200    v_Prec: 0.697785  v_Recall: 0.651451  v_F1: 0.673823  v_AUC: 0.902635
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.261654    reg_loss: 0.006978    l2_loss: 0.019609    loss: 0.288241
steps 5400    v_Prec: 0.696708  v_Recall: 0.654712  v_F1: 0.675057  v_AUC: 0.903018
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.175183    reg_loss: 0.007145    l2_loss: 0.020415    loss: 0.202743
steps 5600    v_Prec: 0.708824  v_Recall: 0.626640  v_F1: 0.665203  v_AUC: 0.897078
steps 5600    running time 223 seconds

steps 5800    base_loss: 0.177065    reg_loss: 0.007131    l2_loss: 0.021168    loss: 0.205365
steps 5800    v_Prec: 0.697171  v_Recall: 0.634911  v_F1: 0.664586  v_AUC: 0.895124
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.174477    reg_loss: 0.007131    l2_loss: 0.021890    loss: 0.203497
steps 6000    v_Prec: 0.700239  v_Recall: 0.629742  v_F1: 0.663122  v_AUC: 0.893736
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.168341    reg_loss: 0.007162    l2_loss: 0.022594    loss: 0.198098
steps 6200    v_Prec: 0.673636  v_Recall: 0.650815  v_F1: 0.662029  v_AUC: 0.893792
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.175968    reg_loss: 0.007133    l2_loss: 0.023256    loss: 0.206356
steps 6400    v_Prec: 0.678878  v_Recall: 0.654314  v_F1: 0.666370  v_AUC: 0.894860
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.187055    reg_loss: 0.007169    l2_loss: 0.023746    loss: 0.217969
steps 6600    v_Prec: 0.696103  v_Recall: 0.640636  v_F1: 0.667219  v_AUC: 0.895046
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.184139    reg_loss: 0.007150    l2_loss: 0.024325    loss: 0.215614
steps 6800    v_Prec: 0.704021  v_Recall: 0.640477  v_F1: 0.670747  v_AUC: 0.896319
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.183172    reg_loss: 0.007163    l2_loss: 0.024723    loss: 0.215058
steps 7000    v_Prec: 0.688779  v_Recall: 0.650656  v_F1: 0.669175  v_AUC: 0.896555
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.176216    reg_loss: 0.007160    l2_loss: 0.025146    loss: 0.208521
steps 7200    v_Prec: 0.695916  v_Recall: 0.646441  v_F1: 0.670267  v_AUC: 0.896417
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.190636    reg_loss: 0.007129    l2_loss: 0.025604    loss: 0.223369
steps 7400    v_Prec: 0.669252  v_Recall: 0.679205  v_F1: 0.674192  v_AUC: 0.898321
steps 7400    running time 279 seconds

Early stop model F1: 0.675057
testing thre: 0.39744675
testing Prec: 0.5232852581746119
testing Recall: 0.6930255164034022
testing F1: 0.596311475409836
testing AUC: 0.8756256368574209
overall running time 282 seconds
(0.6593061674008811, 0.5819198055893074, 0.6182005937782368, 0.8756256368574209, 0.5970998)

2019-02-24 00:53:35.591393: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:53:36.352104: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:53:36.359633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:53:36.359687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 22.950000 seconds
loading data in 29.430000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.954931    reg_loss: 0.021635    l2_loss: 0.013311    loss: 0.989878
steps 200    v_Prec: 0.165523  v_Recall: 1.000000  v_F1: 0.284032  v_AUC: 0.484591
steps 200    running time 40 seconds

steps 400    base_loss: 0.659904    reg_loss: 0.021780    l2_loss: 0.013195    loss: 0.694879
steps 400    v_Prec: 0.165678  v_Recall: 0.999054  v_F1: 0.284221  v_AUC: 0.511745
steps 400    running time 47 seconds

steps 600    base_loss: 0.487056    reg_loss: 0.021966    l2_loss: 0.012986    loss: 0.522008
steps 600    v_Prec: 0.178510  v_Recall: 0.820826  v_F1: 0.293245  v_AUC: 0.562945
steps 600    running time 53 seconds

steps 800    base_loss: 0.465648    reg_loss: 0.021972    l2_loss: 0.012865    loss: 0.500485
steps 800    v_Prec: 0.220520  v_Recall: 0.608072  v_F1: 0.323662  v_AUC: 0.633489
steps 800    running time 60 seconds

steps 1000    base_loss: 0.441306    reg_loss: 0.021960    l2_loss: 0.012703    loss: 0.475970
steps 1000    v_Prec: 0.366215  v_Recall: 0.411162  v_F1: 0.387389  v_AUC: 0.707432
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.414030    reg_loss: 0.022024    l2_loss: 0.012581    loss: 0.448634
steps 1200    v_Prec: 0.440075  v_Recall: 0.480766  v_F1: 0.459522  v_AUC: 0.761232
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.388878    reg_loss: 0.022070    l2_loss: 0.012551    loss: 0.423499
steps 1400    v_Prec: 0.535696  v_Recall: 0.490935  v_F1: 0.512340  v_AUC: 0.797291
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.361243    reg_loss: 0.022165    l2_loss: 0.012611    loss: 0.396019
steps 1600    v_Prec: 0.591394  v_Recall: 0.515687  v_F1: 0.550952  v_AUC: 0.823247
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.341798    reg_loss: 0.022274    l2_loss: 0.012783    loss: 0.376854
steps 1800    v_Prec: 0.616617  v_Recall: 0.539965  v_F1: 0.575751  v_AUC: 0.840553
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.323171    reg_loss: 0.022349    l2_loss: 0.012927    loss: 0.358447
steps 2000    v_Prec: 0.609369  v_Recall: 0.583478  v_F1: 0.596142  v_AUC: 0.854619
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.312658    reg_loss: 0.022461    l2_loss: 0.013174    loss: 0.348293
steps 2200    v_Prec: 0.657398  v_Recall: 0.581428  v_F1: 0.617084  v_AUC: 0.863323
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.298931    reg_loss: 0.022488    l2_loss: 0.013447    loss: 0.334867
steps 2400    v_Prec: 0.660014  v_Recall: 0.599559  v_F1: 0.628335  v_AUC: 0.868813
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.292916    reg_loss: 0.022536    l2_loss: 0.013735    loss: 0.329186
steps 2600    v_Prec: 0.700720  v_Recall: 0.590966  v_F1: 0.641180  v_AUC: 0.875902
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.284493    reg_loss: 0.022573    l2_loss: 0.014093    loss: 0.321158
steps 2800    v_Prec: 0.686602  v_Recall: 0.609964  v_F1: 0.646018  v_AUC: 0.881049
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.284483    reg_loss: 0.022621    l2_loss: 0.014375    loss: 0.321479
steps 3000    v_Prec: 0.691119  v_Recall: 0.613432  v_F1: 0.649962  v_AUC: 0.883806
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.282014    reg_loss: 0.022734    l2_loss: 0.014775    loss: 0.319523
steps 3200    v_Prec: 0.674767  v_Recall: 0.634715  v_F1: 0.654129  v_AUC: 0.887776
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.286074    reg_loss: 0.022775    l2_loss: 0.015119    loss: 0.323968
steps 3400    v_Prec: 0.684394  v_Recall: 0.635031  v_F1: 0.658789  v_AUC: 0.890708
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.271353    reg_loss: 0.022717    l2_loss: 0.015542    loss: 0.309612
steps 3600    v_Prec: 0.671908  v_Recall: 0.653476  v_F1: 0.662564  v_AUC: 0.892429
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.272588    reg_loss: 0.022857    l2_loss: 0.015915    loss: 0.311360
steps 3800    v_Prec: 0.688770  v_Recall: 0.649298  v_F1: 0.668452  v_AUC: 0.894568
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.270078    reg_loss: 0.022804    l2_loss: 0.016382    loss: 0.309263
steps 4000    v_Prec: 0.694300  v_Recall: 0.642362  v_F1: 0.667322  v_AUC: 0.895267
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.266369    reg_loss: 0.022850    l2_loss: 0.016877    loss: 0.306096
steps 4200    v_Prec: 0.703903  v_Recall: 0.639760  v_F1: 0.670301  v_AUC: 0.896741
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.272582    reg_loss: 0.022890    l2_loss: 0.017228    loss: 0.312700
steps 4400    v_Prec: 0.705964  v_Recall: 0.643859  v_F1: 0.673483  v_AUC: 0.899175
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.271732    reg_loss: 0.022907    l2_loss: 0.017910    loss: 0.312549
steps 4600    v_Prec: 0.703013  v_Recall: 0.651033  v_F1: 0.676025  v_AUC: 0.901494
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.265740    reg_loss: 0.022863    l2_loss: 0.018474    loss: 0.307077
steps 4800    v_Prec: 0.702295  v_Recall: 0.660886  v_F1: 0.680962  v_AUC: 0.903165
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.263805    reg_loss: 0.022918    l2_loss: 0.019004    loss: 0.305727
steps 5000    v_Prec: 0.677784  v_Recall: 0.671212  v_F1: 0.674482  v_AUC: 0.901550
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.269146    reg_loss: 0.022950    l2_loss: 0.019612    loss: 0.311709
steps 5200    v_Prec: 0.705508  v_Recall: 0.647170  v_F1: 0.675081  v_AUC: 0.903833
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.250662    reg_loss: 0.022960    l2_loss: 0.020280    loss: 0.293902
steps 5400    v_Prec: 0.691508  v_Recall: 0.671449  v_F1: 0.681331  v_AUC: 0.903525
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.183531    reg_loss: 0.023345    l2_loss: 0.021069    loss: 0.227944
steps 5600    v_Prec: 0.675127  v_Recall: 0.668848  v_F1: 0.671973  v_AUC: 0.899221
steps 5600    running time 223 seconds

steps 5800    base_loss: 0.165329    reg_loss: 0.023343    l2_loss: 0.021819    loss: 0.210491
steps 5800    v_Prec: 0.700207  v_Recall: 0.641258  v_F1: 0.669437  v_AUC: 0.897097
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.171118    reg_loss: 0.023371    l2_loss: 0.022563    loss: 0.217052
steps 6000    v_Prec: 0.686892  v_Recall: 0.651427  v_F1: 0.668690  v_AUC: 0.894543
steps 6000    running time 236 seconds

steps 6200    base_loss: 0.169644    reg_loss: 0.023332    l2_loss: 0.023247    loss: 0.216224
steps 6200    v_Prec: 0.667400  v_Recall: 0.669399  v_F1: 0.668398  v_AUC: 0.894711
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.177044    reg_loss: 0.023318    l2_loss: 0.023800    loss: 0.224163
steps 6400    v_Prec: 0.690268  v_Recall: 0.652452  v_F1: 0.670827  v_AUC: 0.895675
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.178438    reg_loss: 0.023385    l2_loss: 0.024326    loss: 0.226149
steps 6600    v_Prec: 0.694182  v_Recall: 0.648983  v_F1: 0.670822  v_AUC: 0.895156
steps 6600    running time 255 seconds

steps 6800    base_loss: 0.181390    reg_loss: 0.023314    l2_loss: 0.024879    loss: 0.229583
steps 6800    v_Prec: 0.698445  v_Recall: 0.654895  v_F1: 0.675969  v_AUC: 0.897362
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.185365    reg_loss: 0.023360    l2_loss: 0.025360    loss: 0.234085
steps 7000    v_Prec: 0.689769  v_Recall: 0.658994  v_F1: 0.674030  v_AUC: 0.897395
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.183186    reg_loss: 0.023385    l2_loss: 0.025902    loss: 0.232474
steps 7200    v_Prec: 0.709500  v_Recall: 0.649377  v_F1: 0.678108  v_AUC: 0.898075
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.187371    reg_loss: 0.023394    l2_loss: 0.026324    loss: 0.237090
steps 7400    v_Prec: 0.716375  v_Recall: 0.648668  v_F1: 0.680842  v_AUC: 0.900549
steps 7400    running time 280 seconds

Early stop model F1: 0.681331
testing thre: 0.24891947
testing Prec: 0.5038522427440634
testing Recall: 0.6960874848116646
testing F1: 0.5845714285714285
testing AUC: 0.8700771085148931
overall running time 283 seconds
(0.6288541666666667, 0.5868286755771568, 0.6071150219987429, 0.8700771085148931, 0.4199586)

2019-02-24 00:57:08.423658: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 00:57:08.692521: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 00:57:08.697030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 00:57:08.697070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.090000 seconds
loading data in 30.190000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.122163    reg_loss: 0.021586    l2_loss: 0.013277    loss: 1.157026
steps 200    v_Prec: 0.164755  v_Recall: 1.000000  v_F1: 0.282901  v_AUC: 0.527679
steps 200    running time 40 seconds

steps 400    base_loss: 0.731527    reg_loss: 0.021487    l2_loss: 0.013141    loss: 0.766154
steps 400    v_Prec: 0.169620  v_Recall: 0.906700  v_F1: 0.285778  v_AUC: 0.548617
steps 400    running time 47 seconds

steps 600    base_loss: 0.520822    reg_loss: 0.021459    l2_loss: 0.012909    loss: 0.555190
steps 600    v_Prec: 0.187167  v_Recall: 0.714320  v_F1: 0.296614  v_AUC: 0.581390
steps 600    running time 53 seconds

steps 800    base_loss: 0.473929    reg_loss: 0.021345    l2_loss: 0.012741    loss: 0.508016
steps 800    v_Prec: 0.210461  v_Recall: 0.643751  v_F1: 0.317215  v_AUC: 0.625474
steps 800    running time 60 seconds

steps 1000    base_loss: 0.457243    reg_loss: 0.021304    l2_loss: 0.012638    loss: 0.491184
steps 1000    v_Prec: 0.273761  v_Recall: 0.531997  v_F1: 0.361498  v_AUC: 0.685386
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.429533    reg_loss: 0.021101    l2_loss: 0.012569    loss: 0.463203
steps 1200    v_Prec: 0.331171  v_Recall: 0.501267  v_F1: 0.398840  v_AUC: 0.724916
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.410588    reg_loss: 0.020963    l2_loss: 0.012630    loss: 0.444181
steps 1400    v_Prec: 0.423097  v_Recall: 0.456439  v_F1: 0.439136  v_AUC: 0.758764
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.387126    reg_loss: 0.020825    l2_loss: 0.012778    loss: 0.420728
steps 1600    v_Prec: 0.442933  v_Recall: 0.528671  v_F1: 0.482019  v_AUC: 0.789939
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.372240    reg_loss: 0.020707    l2_loss: 0.012966    loss: 0.405913
steps 1800    v_Prec: 0.502447  v_Recall: 0.512197  v_F1: 0.507275  v_AUC: 0.807971
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.358188    reg_loss: 0.020569    l2_loss: 0.013236    loss: 0.391993
steps 2000    v_Prec: 0.509367  v_Recall: 0.559876  v_F1: 0.533429  v_AUC: 0.826818
steps 2000    running time 103 seconds

steps 2200    base_loss: 0.338571    reg_loss: 0.020474    l2_loss: 0.013512    loss: 0.372557
steps 2200    v_Prec: 0.550491  v_Recall: 0.554808  v_F1: 0.552641  v_AUC: 0.835752
steps 2200    running time 110 seconds

steps 2400    base_loss: 0.333858    reg_loss: 0.020418    l2_loss: 0.013861    loss: 0.368137
steps 2400    v_Prec: 0.527774  v_Recall: 0.603517  v_F1: 0.563110  v_AUC: 0.843656
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.329814    reg_loss: 0.020337    l2_loss: 0.014243    loss: 0.364395
steps 2600    v_Prec: 0.548343  v_Recall: 0.602804  v_F1: 0.574285  v_AUC: 0.851181
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.333925    reg_loss: 0.020336    l2_loss: 0.014693    loss: 0.368953
steps 2800    v_Prec: 0.553616  v_Recall: 0.612942  v_F1: 0.581770  v_AUC: 0.855948
steps 2800    running time 130 seconds

steps 3000    base_loss: 0.320583    reg_loss: 0.020195    l2_loss: 0.015153    loss: 0.355931
steps 3000    v_Prec: 0.569739  v_Recall: 0.602725  v_F1: 0.585768  v_AUC: 0.859421
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.319985    reg_loss: 0.020106    l2_loss: 0.015633    loss: 0.355725
steps 3200    v_Prec: 0.588895  v_Recall: 0.594725  v_F1: 0.591796  v_AUC: 0.862412
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.316994    reg_loss: 0.020010    l2_loss: 0.016117    loss: 0.353121
steps 3400    v_Prec: 0.578340  v_Recall: 0.615397  v_F1: 0.596293  v_AUC: 0.865642
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.309164    reg_loss: 0.019890    l2_loss: 0.016776    loss: 0.345830
steps 3600    v_Prec: 0.592848  v_Recall: 0.611912  v_F1: 0.602229  v_AUC: 0.867814
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.303725    reg_loss: 0.019784    l2_loss: 0.017411    loss: 0.340920
steps 3800    v_Prec: 0.591691  v_Recall: 0.618169  v_F1: 0.604640  v_AUC: 0.869937
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.319985    reg_loss: 0.019720    l2_loss: 0.018038    loss: 0.357743
steps 4000    v_Prec: 0.601469  v_Recall: 0.609615  v_F1: 0.605515  v_AUC: 0.871919
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.307934    reg_loss: 0.019604    l2_loss: 0.018729    loss: 0.346267
steps 4200    v_Prec: 0.571349  v_Recall: 0.653255  v_F1: 0.609563  v_AUC: 0.873017
steps 4200    running time 177 seconds

steps 4400    base_loss: 0.305362    reg_loss: 0.019433    l2_loss: 0.019420    loss: 0.344216
steps 4400    v_Prec: 0.598492  v_Recall: 0.628782  v_F1: 0.613263  v_AUC: 0.876182
steps 4400    running time 184 seconds

steps 4600    base_loss: 0.308813    reg_loss: 0.019350    l2_loss: 0.020201    loss: 0.348364
steps 4600    v_Prec: 0.606512  v_Recall: 0.628465  v_F1: 0.617294  v_AUC: 0.877344
steps 4600    running time 191 seconds

steps 4800    base_loss: 0.309841    reg_loss: 0.019204    l2_loss: 0.020950    loss: 0.349994
steps 4800    v_Prec: 0.604956  v_Recall: 0.640029  v_F1: 0.621998  v_AUC: 0.878533
steps 4800    running time 197 seconds

steps 5000    base_loss: 0.301646    reg_loss: 0.019073    l2_loss: 0.021756    loss: 0.342475
steps 5000    v_Prec: 0.596809  v_Recall: 0.657690  v_F1: 0.625772  v_AUC: 0.881303
steps 5000    running time 204 seconds

steps 5200    base_loss: 0.295330    reg_loss: 0.018928    l2_loss: 0.022525    loss: 0.336782
steps 5200    v_Prec: 0.610584  v_Recall: 0.646998  v_F1: 0.628264  v_AUC: 0.883579
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.291274    reg_loss: 0.018882    l2_loss: 0.023436    loss: 0.333592
steps 5400    v_Prec: 0.618897  v_Recall: 0.649533  v_F1: 0.633845  v_AUC: 0.885112
steps 5400    running time 217 seconds

steps 5600    base_loss: 0.169650    reg_loss: 0.019809    l2_loss: 0.024142    loss: 0.213602
steps 5600    v_Prec: 0.596703  v_Recall: 0.659275  v_F1: 0.626430  v_AUC: 0.880211
steps 5600    running time 224 seconds

steps 5800    base_loss: 0.169669    reg_loss: 0.019961    l2_loss: 0.024552    loss: 0.214182
steps 5800    v_Prec: 0.598452  v_Recall: 0.636702  v_F1: 0.616985  v_AUC: 0.874329
steps 5800    running time 230 seconds

steps 6000    base_loss: 0.174955    reg_loss: 0.020087    l2_loss: 0.024937    loss: 0.219980
steps 6000    v_Prec: 0.577699  v_Recall: 0.657770  v_F1: 0.615140  v_AUC: 0.872909
steps 6000    running time 236 seconds

steps 6200    base_loss: 0.174508    reg_loss: 0.020085    l2_loss: 0.025487    loss: 0.220080
steps 6200    v_Prec: 0.614826  v_Recall: 0.603675  v_F1: 0.609200  v_AUC: 0.868908
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.167480    reg_loss: 0.020207    l2_loss: 0.025984    loss: 0.213671
steps 6400    v_Prec: 0.582910  v_Recall: 0.635910  v_F1: 0.608258  v_AUC: 0.868397
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.177697    reg_loss: 0.020145    l2_loss: 0.026538    loss: 0.224380
steps 6600    v_Prec: 0.588899  v_Recall: 0.636940  v_F1: 0.611978  v_AUC: 0.869975
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.172738    reg_loss: 0.020119    l2_loss: 0.026823    loss: 0.219680
steps 6800    v_Prec: 0.609775  v_Recall: 0.614605  v_F1: 0.612180  v_AUC: 0.870679
steps 6800    running time 260 seconds

steps 7000    base_loss: 0.180427    reg_loss: 0.020118    l2_loss: 0.027273    loss: 0.227818
steps 7000    v_Prec: 0.609084  v_Recall: 0.614922  v_F1: 0.611989  v_AUC: 0.871089
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.174623    reg_loss: 0.020142    l2_loss: 0.027694    loss: 0.222458
steps 7200    v_Prec: 0.593406  v_Recall: 0.627198  v_F1: 0.609834  v_AUC: 0.870133
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.184287    reg_loss: 0.020039    l2_loss: 0.028098    loss: 0.232424
steps 7400    v_Prec: 0.595317  v_Recall: 0.628227  v_F1: 0.611329  v_AUC: 0.872263
steps 7400    running time 279 seconds

Early stop model F1: 0.633845
testing thre: 0.3130002
testing Prec: 0.4538976021495955
testing Recall: 0.7553341433778857
testing F1: 0.5670449155325282
testing AUC: 0.8736930177812373
overall running time 282 seconds
(0.6673550259530056, 0.581142162818955, 0.6212719526135301, 0.8736930177812373, 0.60247236)

2019-02-24 01:00:40.345684: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:00:41.832125: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:00:41.834570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:00:41.834615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.140000 seconds
loading data in 29.320000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.595448    reg_loss: 0.021607    l2_loss: 0.013410    loss: 0.630465
steps 200    v_Prec: 0.162913  v_Recall: 1.000000  v_F1: 0.280181  v_AUC: 0.482638
steps 200    running time 39 seconds

steps 400    base_loss: 0.516456    reg_loss: 0.021728    l2_loss: 0.013422    loss: 0.551606
steps 400    v_Prec: 0.162913  v_Recall: 1.000000  v_F1: 0.280181  v_AUC: 0.507515
steps 400    running time 46 seconds

steps 600    base_loss: 0.493260    reg_loss: 0.021774    l2_loss: 0.013371    loss: 0.528404
steps 600    v_Prec: 0.163196  v_Recall: 0.994874  v_F1: 0.280397  v_AUC: 0.548214
steps 600    running time 53 seconds

steps 800    base_loss: 0.464619    reg_loss: 0.021836    l2_loss: 0.013244    loss: 0.499699
steps 800    v_Prec: 0.186989  v_Recall: 0.697501  v_F1: 0.294915  v_AUC: 0.589156
steps 800    running time 60 seconds

steps 1000    base_loss: 0.442407    reg_loss: 0.021867    l2_loss: 0.013192    loss: 0.477466
steps 1000    v_Prec: 0.266319  v_Recall: 0.462678  v_F1: 0.338054  v_AUC: 0.651911
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.437613    reg_loss: 0.022009    l2_loss: 0.013136    loss: 0.472758
steps 1200    v_Prec: 0.389854  v_Recall: 0.422233  v_F1: 0.405398  v_AUC: 0.717752
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.410001    reg_loss: 0.022050    l2_loss: 0.013120    loss: 0.445171
steps 1400    v_Prec: 0.484734  v_Recall: 0.441214  v_F1: 0.461951  v_AUC: 0.762879
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.391644    reg_loss: 0.022252    l2_loss: 0.013153    loss: 0.427049
steps 1600    v_Prec: 0.520302  v_Recall: 0.496716  v_F1: 0.508236  v_AUC: 0.795746
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.360095    reg_loss: 0.022349    l2_loss: 0.013269    loss: 0.395713
steps 1800    v_Prec: 0.547343  v_Recall: 0.533798  v_F1: 0.540486  v_AUC: 0.818478
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.342540    reg_loss: 0.022437    l2_loss: 0.013424    loss: 0.378401
steps 2000    v_Prec: 0.614472  v_Recall: 0.535239  v_F1: 0.572126  v_AUC: 0.835130
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.333166    reg_loss: 0.022541    l2_loss: 0.013658    loss: 0.369365
steps 2200    v_Prec: 0.619566  v_Recall: 0.565033  v_F1: 0.591044  v_AUC: 0.845961
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.328875    reg_loss: 0.022672    l2_loss: 0.013930    loss: 0.365477
steps 2400    v_Prec: 0.616002  v_Recall: 0.590101  v_F1: 0.602773  v_AUC: 0.854074
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.304051    reg_loss: 0.022691    l2_loss: 0.014140    loss: 0.340882
steps 2600    v_Prec: 0.667943  v_Recall: 0.572721  v_F1: 0.616678  v_AUC: 0.861690
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.300050    reg_loss: 0.022775    l2_loss: 0.014416    loss: 0.337241
steps 2800    v_Prec: 0.657778  v_Recall: 0.594666  v_F1: 0.624632  v_AUC: 0.868125
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.303042    reg_loss: 0.022799    l2_loss: 0.014705    loss: 0.340546
steps 3000    v_Prec: 0.660425  v_Recall: 0.604517  v_F1: 0.631236  v_AUC: 0.873650
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.289356    reg_loss: 0.022877    l2_loss: 0.015023    loss: 0.327256
steps 3200    v_Prec: 0.670811  v_Recall: 0.613647  v_F1: 0.640957  v_AUC: 0.877181
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.285005    reg_loss: 0.022936    l2_loss: 0.015312    loss: 0.323253
steps 3400    v_Prec: 0.674168  v_Recall: 0.621416  v_F1: 0.646718  v_AUC: 0.880863
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.278251    reg_loss: 0.022899    l2_loss: 0.015668    loss: 0.316818
steps 3600    v_Prec: 0.693534  v_Recall: 0.613327  v_F1: 0.650969  v_AUC: 0.885505
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.278381    reg_loss: 0.022942    l2_loss: 0.016055    loss: 0.317379
steps 3800    v_Prec: 0.685694  v_Recall: 0.623418  v_F1: 0.653075  v_AUC: 0.888072
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.274574    reg_loss: 0.022990    l2_loss: 0.016480    loss: 0.314043
steps 4000    v_Prec: 0.681944  v_Recall: 0.632789  v_F1: 0.656447  v_AUC: 0.889965
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.280114    reg_loss: 0.023017    l2_loss: 0.016920    loss: 0.320051
steps 4200    v_Prec: 0.687732  v_Recall: 0.637114  v_F1: 0.661456  v_AUC: 0.892267
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.277274    reg_loss: 0.023117    l2_loss: 0.017415    loss: 0.317806
steps 4400    v_Prec: 0.701695  v_Recall: 0.629986  v_F1: 0.663910  v_AUC: 0.894406
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.269728    reg_loss: 0.022972    l2_loss: 0.017844    loss: 0.310544
steps 4600    v_Prec: 0.667657  v_Recall: 0.666266  v_F1: 0.666961  v_AUC: 0.897503
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.266161    reg_loss: 0.023035    l2_loss: 0.018365    loss: 0.307562
steps 4800    v_Prec: 0.677787  v_Recall: 0.657376  v_F1: 0.667426  v_AUC: 0.898161
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.270376    reg_loss: 0.023107    l2_loss: 0.018965    loss: 0.312448
steps 5000    v_Prec: 0.696099  v_Recall: 0.640237  v_F1: 0.667000  v_AUC: 0.898846
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.267447    reg_loss: 0.023069    l2_loss: 0.019605    loss: 0.310121
steps 5200    v_Prec: 0.666085  v_Recall: 0.672593  v_F1: 0.669323  v_AUC: 0.899282
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.262617    reg_loss: 0.023166    l2_loss: 0.020231    loss: 0.306014
steps 5400    v_Prec: 0.686020  v_Recall: 0.656736  v_F1: 0.671059  v_AUC: 0.900363
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.166499    reg_loss: 0.023499    l2_loss: 0.021011    loss: 0.211009
steps 5600    v_Prec: 0.705814  v_Recall: 0.632949  v_F1: 0.667399  v_AUC: 0.895232
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.180838    reg_loss: 0.023434    l2_loss: 0.021843    loss: 0.226115
steps 5800    v_Prec: 0.696951  v_Recall: 0.635272  v_F1: 0.664683  v_AUC: 0.894102
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.174792    reg_loss: 0.023429    l2_loss: 0.022545    loss: 0.220767
steps 6000    v_Prec: 0.670223  v_Recall: 0.648967  v_F1: 0.659424  v_AUC: 0.891243
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.192403    reg_loss: 0.023456    l2_loss: 0.023189    loss: 0.239048
steps 6200    v_Prec: 0.711883  v_Recall: 0.620375  v_F1: 0.662986  v_AUC: 0.892953
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.183715    reg_loss: 0.023463    l2_loss: 0.023751    loss: 0.230928
steps 6400    v_Prec: 0.711554  v_Recall: 0.622938  v_F1: 0.664304  v_AUC: 0.892437
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.179193    reg_loss: 0.023389    l2_loss: 0.024298    loss: 0.226880
steps 6600    v_Prec: 0.698467  v_Recall: 0.635031  v_F1: 0.665240  v_AUC: 0.894530
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.184727    reg_loss: 0.023405    l2_loss: 0.024760    loss: 0.232892
steps 6800    v_Prec: 0.721087  v_Recall: 0.618693  v_F1: 0.665977  v_AUC: 0.892773
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.182469    reg_loss: 0.023403    l2_loss: 0.025213    loss: 0.231086
steps 7000    v_Prec: 0.708479  v_Recall: 0.631027  v_F1: 0.667514  v_AUC: 0.894416
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.190413    reg_loss: 0.023417    l2_loss: 0.025648    loss: 0.239478
steps 7200    v_Prec: 0.705701  v_Recall: 0.640477  v_F1: 0.671509  v_AUC: 0.896571
steps 7200    running time 269 seconds

steps 7400    base_loss: 0.180785    reg_loss: 0.023469    l2_loss: 0.026043    loss: 0.230297
steps 7400    v_Prec: 0.692153  v_Recall: 0.663383  v_F1: 0.677463  v_AUC: 0.898622
steps 7400    running time 275 seconds

steps 7600    base_loss: 0.198897    reg_loss: 0.023448    l2_loss: 0.026389    loss: 0.248734
steps 7600    v_Prec: 0.732902  v_Recall: 0.635111  v_F1: 0.680511  v_AUC: 0.899961
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.183272    reg_loss: 0.023416    l2_loss: 0.026711    loss: 0.233399
steps 7800    v_Prec: 0.723858  v_Recall: 0.643681  v_F1: 0.681419  v_AUC: 0.901676
steps 7800    running time 289 seconds

steps 8000    base_loss: 0.190315    reg_loss: 0.023543    l2_loss: 0.027037    loss: 0.240896
steps 8000    v_Prec: 0.719808  v_Recall: 0.648727  v_F1: 0.682421  v_AUC: 0.901427
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.185196    reg_loss: 0.023522    l2_loss: 0.027431    loss: 0.236150
steps 8200    v_Prec: 0.711098  v_Recall: 0.668669  v_F1: 0.689231  v_AUC: 0.905052
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.191090    reg_loss: 0.023480    l2_loss: 0.027710    loss: 0.242280
steps 8400    v_Prec: 0.710739  v_Recall: 0.669470  v_F1: 0.689487  v_AUC: 0.904843
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.186830    reg_loss: 0.023450    l2_loss: 0.028046    loss: 0.238326
steps 8600    v_Prec: 0.710202  v_Recall: 0.674596  v_F1: 0.691941  v_AUC: 0.906443
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.181718    reg_loss: 0.023401    l2_loss: 0.028159    loss: 0.233277
steps 8800    v_Prec: 0.748642  v_Recall: 0.651450  v_F1: 0.696673  v_AUC: 0.908532
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.190718    reg_loss: 0.023477    l2_loss: 0.028526    loss: 0.242721
steps 9000    v_Prec: 0.719683  v_Recall: 0.677319  v_F1: 0.697859  v_AUC: 0.909507
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.182192    reg_loss: 0.023500    l2_loss: 0.028799    loss: 0.234491
steps 9200    v_Prec: 0.752474  v_Recall: 0.657617  v_F1: 0.701855  v_AUC: 0.909170
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.186941    reg_loss: 0.023445    l2_loss: 0.028949    loss: 0.239335
steps 9400    v_Prec: 0.738558  v_Recall: 0.669470  v_F1: 0.702319  v_AUC: 0.911024
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.191185    reg_loss: 0.023471    l2_loss: 0.029200    loss: 0.243856
steps 9600    v_Prec: 0.761602  v_Recall: 0.651930  v_F1: 0.702511  v_AUC: 0.912000
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.175395    reg_loss: 0.023273    l2_loss: 0.029360    loss: 0.228029
steps 9800    v_Prec: 0.741808  v_Recall: 0.674435  v_F1: 0.706519  v_AUC: 0.912298
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.185501    reg_loss: 0.023363    l2_loss: 0.029450    loss: 0.238314
steps 10000    v_Prec: 0.734760  v_Recall: 0.690213  v_F1: 0.711790  v_AUC: 0.914347
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.184017    reg_loss: 0.023368    l2_loss: 0.029662    loss: 0.237047
steps 10200    v_Prec: 0.753029  v_Recall: 0.676918  v_F1: 0.712948  v_AUC: 0.916628
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.181951    reg_loss: 0.023463    l2_loss: 0.029797    loss: 0.235211
steps 10400    v_Prec: 0.742837  v_Recall: 0.685247  v_F1: 0.712881  v_AUC: 0.917013
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.183070    reg_loss: 0.023396    l2_loss: 0.030087    loss: 0.236553
steps 10600    v_Prec: 0.764219  v_Recall: 0.680122  v_F1: 0.719722  v_AUC: 0.918875
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.171565    reg_loss: 0.023470    l2_loss: 0.030274    loss: 0.225309
steps 10800    v_Prec: 0.761241  v_Recall: 0.682044  v_F1: 0.719469  v_AUC: 0.918789
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.078644    reg_loss: 0.023621    l2_loss: 0.030466    loss: 0.132731
steps 11000    v_Prec: 0.741768  v_Recall: 0.676598  v_F1: 0.707686  v_AUC: 0.910290
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.076298    reg_loss: 0.023522    l2_loss: 0.030539    loss: 0.130360
steps 11200    v_Prec: 0.752186  v_Recall: 0.654653  v_F1: 0.700039  v_AUC: 0.906886
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.073336    reg_loss: 0.023481    l2_loss: 0.030685    loss: 0.127502
steps 11400    v_Prec: 0.732386  v_Recall: 0.664344  v_F1: 0.696708  v_AUC: 0.904265
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.078031    reg_loss: 0.023532    l2_loss: 0.030790    loss: 0.132354
steps 11600    v_Prec: 0.727946  v_Recall: 0.653612  v_F1: 0.688779  v_AUC: 0.901438
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.076135    reg_loss: 0.023414    l2_loss: 0.030865    loss: 0.130414
steps 11800    v_Prec: 0.734047  v_Recall: 0.653212  v_F1: 0.691274  v_AUC: 0.901171
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.083787    reg_loss: 0.023422    l2_loss: 0.030839    loss: 0.138048
steps 12000    v_Prec: 0.737575  v_Recall: 0.640638  v_F1: 0.685697  v_AUC: 0.897226
steps 12000    running time 424 seconds

steps 12200    base_loss: 0.079198    reg_loss: 0.023346    l2_loss: 0.030929    loss: 0.133474
steps 12200    v_Prec: 0.726073  v_Recall: 0.651930  v_F1: 0.687007  v_AUC: 0.897401
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.081114    reg_loss: 0.023438    l2_loss: 0.031152    loss: 0.135704
steps 12400    v_Prec: 0.715420  v_Recall: 0.664024  v_F1: 0.688764  v_AUC: 0.897790
steps 12400    running time 435 seconds

steps 12600    base_loss: 0.088193    reg_loss: 0.023284    l2_loss: 0.031151    loss: 0.142628
steps 12600    v_Prec: 0.713457  v_Recall: 0.660259  v_F1: 0.685828  v_AUC: 0.897734
steps 12600    running time 442 seconds

Early stop model F1: 0.719722
testing thre: 0.40526384
testing Prec: 0.5603457871108968
testing Recall: 0.7340461725394897
testing F1: 0.6355411546877631
testing AUC: 0.8985184346028489
overall running time 444 seconds
(0.7328066914498141, 0.6131713244228433, 0.6676721970839617, 0.8985184346028489, 0.6957356)

2019-02-24 01:05:57.626354: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:05:58.046768: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:05:58.047656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:05:58.047691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.720000 seconds
loading data in 31.210000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.142031    reg_loss: 0.021575    l2_loss: 0.013252    loss: 1.176858
steps 200    v_Prec: 0.164048  v_Recall: 0.996257  v_F1: 0.281709  v_AUC: 0.521057
steps 200    running time 41 seconds

steps 400    base_loss: 0.673620    reg_loss: 0.021597    l2_loss: 0.013087    loss: 0.708304
steps 400    v_Prec: 0.163903  v_Recall: 0.999761  v_F1: 0.281635  v_AUC: 0.522227
steps 400    running time 48 seconds

steps 600    base_loss: 0.486509    reg_loss: 0.021697    l2_loss: 0.012887    loss: 0.521094
steps 600    v_Prec: 0.185856  v_Recall: 0.683762  v_F1: 0.292269  v_AUC: 0.570024
steps 600    running time 54 seconds

steps 800    base_loss: 0.472059    reg_loss: 0.021733    l2_loss: 0.012849    loss: 0.506642
steps 800    v_Prec: 0.216060  v_Recall: 0.563988  v_F1: 0.312430  v_AUC: 0.612928
steps 800    running time 60 seconds

steps 1000    base_loss: 0.456534    reg_loss: 0.021826    l2_loss: 0.012709    loss: 0.491069
steps 1000    v_Prec: 0.305144  v_Recall: 0.468663  v_F1: 0.369626  v_AUC: 0.690096
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.439099    reg_loss: 0.021871    l2_loss: 0.012675    loss: 0.473645
steps 1200    v_Prec: 0.374532  v_Recall: 0.462372  v_F1: 0.413842  v_AUC: 0.730722
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.424367    reg_loss: 0.021874    l2_loss: 0.012662    loss: 0.458904
steps 1400    v_Prec: 0.433002  v_Recall: 0.495899  v_F1: 0.462321  v_AUC: 0.769492
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.406337    reg_loss: 0.021983    l2_loss: 0.012683    loss: 0.441004
steps 1600    v_Prec: 0.491319  v_Recall: 0.500279  v_F1: 0.495758  v_AUC: 0.794088
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.383532    reg_loss: 0.022105    l2_loss: 0.012802    loss: 0.418439
steps 1800    v_Prec: 0.515375  v_Recall: 0.551246  v_F1: 0.532707  v_AUC: 0.818535
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.363010    reg_loss: 0.022178    l2_loss: 0.012982    loss: 0.398171
steps 2000    v_Prec: 0.567007  v_Recall: 0.539779  v_F1: 0.553058  v_AUC: 0.831708
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.342984    reg_loss: 0.022293    l2_loss: 0.013218    loss: 0.378495
steps 2200    v_Prec: 0.585250  v_Recall: 0.569404  v_F1: 0.577218  v_AUC: 0.844409
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.330392    reg_loss: 0.022513    l2_loss: 0.013510    loss: 0.366416
steps 2400    v_Prec: 0.618329  v_Recall: 0.567413  v_F1: 0.591777  v_AUC: 0.854725
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.320338    reg_loss: 0.022625    l2_loss: 0.013895    loss: 0.356858
steps 2600    v_Prec: 0.640122  v_Recall: 0.568448  v_F1: 0.602160  v_AUC: 0.861707
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.315772    reg_loss: 0.022677    l2_loss: 0.014214    loss: 0.352663
steps 2800    v_Prec: 0.646970  v_Recall: 0.577208  v_F1: 0.610101  v_AUC: 0.865725
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.308784    reg_loss: 0.022781    l2_loss: 0.014629    loss: 0.346194
steps 3000    v_Prec: 0.650645  v_Recall: 0.598312  v_F1: 0.623382  v_AUC: 0.872818
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.303852    reg_loss: 0.022903    l2_loss: 0.015053    loss: 0.341807
steps 3200    v_Prec: 0.626154  v_Recall: 0.626503  v_F1: 0.626329  v_AUC: 0.876989
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.298397    reg_loss: 0.022909    l2_loss: 0.015469    loss: 0.336776
steps 3400    v_Prec: 0.653665  v_Recall: 0.617902  v_F1: 0.635281  v_AUC: 0.881323
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.290218    reg_loss: 0.022876    l2_loss: 0.015834    loss: 0.328928
steps 3600    v_Prec: 0.658812  v_Recall: 0.627857  v_F1: 0.642962  v_AUC: 0.885455
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.290036    reg_loss: 0.022955    l2_loss: 0.016387    loss: 0.329378
steps 3800    v_Prec: 0.684671  v_Recall: 0.616787  v_F1: 0.648959  v_AUC: 0.886954
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.281439    reg_loss: 0.022916    l2_loss: 0.016772    loss: 0.321126
steps 4000    v_Prec: 0.690527  v_Recall: 0.619973  v_F1: 0.653351  v_AUC: 0.890174
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.277977    reg_loss: 0.023010    l2_loss: 0.017199    loss: 0.318186
steps 4200    v_Prec: 0.715610  v_Recall: 0.602373  v_F1: 0.654127  v_AUC: 0.891836
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.267627    reg_loss: 0.022987    l2_loss: 0.017771    loss: 0.308385
steps 4400    v_Prec: 0.690447  v_Recall: 0.622760  v_F1: 0.654859  v_AUC: 0.892712
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.276564    reg_loss: 0.023031    l2_loss: 0.018284    loss: 0.317878
steps 4600    v_Prec: 0.681566  v_Recall: 0.635104  v_F1: 0.657515  v_AUC: 0.896635
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.276909    reg_loss: 0.023005    l2_loss: 0.018856    loss: 0.318770
steps 4800    v_Prec: 0.682354  v_Recall: 0.640838  v_F1: 0.660945  v_AUC: 0.897452
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.269304    reg_loss: 0.022963    l2_loss: 0.019359    loss: 0.311625
steps 5000    v_Prec: 0.694727  v_Recall: 0.647368  v_F1: 0.670212  v_AUC: 0.900580
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.264659    reg_loss: 0.023016    l2_loss: 0.019989    loss: 0.307664
steps 5200    v_Prec: 0.683816  v_Recall: 0.660508  v_F1: 0.671960  v_AUC: 0.901881
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.258305    reg_loss: 0.023053    l2_loss: 0.020598    loss: 0.301956
steps 5400    v_Prec: 0.694750  v_Recall: 0.653420  v_F1: 0.673452  v_AUC: 0.903164
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.181936    reg_loss: 0.023464    l2_loss: 0.021482    loss: 0.226883
steps 5600    v_Prec: 0.685160  v_Recall: 0.647129  v_F1: 0.665602  v_AUC: 0.896941
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.181427    reg_loss: 0.023448    l2_loss: 0.022302    loss: 0.227177
steps 5800    v_Prec: 0.679905  v_Recall: 0.638050  v_F1: 0.658313  v_AUC: 0.893759
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.178228    reg_loss: 0.023454    l2_loss: 0.023101    loss: 0.224783
steps 6000    v_Prec: 0.665217  v_Recall: 0.657960  v_F1: 0.661569  v_AUC: 0.893781
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.190633    reg_loss: 0.023397    l2_loss: 0.023776    loss: 0.237805
steps 6200    v_Prec: 0.663124  v_Recall: 0.655889  v_F1: 0.659487  v_AUC: 0.893303
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.196877    reg_loss: 0.023401    l2_loss: 0.024346    loss: 0.244623
steps 6400    v_Prec: 0.695820  v_Recall: 0.631042  v_F1: 0.661850  v_AUC: 0.894619
steps 6400    running time 247 seconds

steps 6600    base_loss: 0.186446    reg_loss: 0.023415    l2_loss: 0.024956    loss: 0.234818
steps 6600    v_Prec: 0.712140  v_Recall: 0.626901  v_F1: 0.666808  v_AUC: 0.895564
steps 6600    running time 253 seconds

steps 6800    base_loss: 0.203308    reg_loss: 0.023406    l2_loss: 0.025545    loss: 0.252259
steps 6800    v_Prec: 0.698827  v_Recall: 0.645457  v_F1: 0.671083  v_AUC: 0.896888
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.185420    reg_loss: 0.023467    l2_loss: 0.025927    loss: 0.234814
steps 7000    v_Prec: 0.692288  v_Recall: 0.652704  v_F1: 0.671913  v_AUC: 0.896942
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.198716    reg_loss: 0.023388    l2_loss: 0.026534    loss: 0.248638
steps 7200    v_Prec: 0.694419  v_Recall: 0.660906  v_F1: 0.677248  v_AUC: 0.899625
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.192142    reg_loss: 0.023417    l2_loss: 0.026859    loss: 0.242418
steps 7400    v_Prec: 0.711258  v_Recall: 0.649518  v_F1: 0.678988  v_AUC: 0.899923
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.203840    reg_loss: 0.023500    l2_loss: 0.027187    loss: 0.254527
steps 7600    v_Prec: 0.730130  v_Recall: 0.636458  v_F1: 0.680083  v_AUC: 0.902816
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.196334    reg_loss: 0.023434    l2_loss: 0.027465    loss: 0.247233
steps 7800    v_Prec: 0.707119  v_Recall: 0.658915  v_F1: 0.682167  v_AUC: 0.903050
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.190181    reg_loss: 0.023474    l2_loss: 0.027861    loss: 0.241515
steps 8000    v_Prec: 0.728999  v_Recall: 0.651031  v_F1: 0.687813  v_AUC: 0.904354
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.190130    reg_loss: 0.023431    l2_loss: 0.028133    loss: 0.241693
steps 8200    v_Prec: 0.728723  v_Recall: 0.651191  v_F1: 0.687779  v_AUC: 0.905519
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.190111    reg_loss: 0.023356    l2_loss: 0.028362    loss: 0.241829
steps 8400    v_Prec: 0.712253  v_Recall: 0.673569  v_F1: 0.692371  v_AUC: 0.906772
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.189075    reg_loss: 0.023410    l2_loss: 0.028662    loss: 0.241147
steps 8600    v_Prec: 0.728109  v_Recall: 0.662180  v_F1: 0.693581  v_AUC: 0.907779
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.194263    reg_loss: 0.023469    l2_loss: 0.029025    loss: 0.246757
steps 8800    v_Prec: 0.749539  v_Recall: 0.646811  v_F1: 0.694396  v_AUC: 0.909458
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.188916    reg_loss: 0.023451    l2_loss: 0.029312    loss: 0.241679
steps 9000    v_Prec: 0.744591  v_Recall: 0.657721  v_F1: 0.698465  v_AUC: 0.911194
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.179778    reg_loss: 0.023410    l2_loss: 0.029565    loss: 0.232753
steps 9200    v_Prec: 0.708829  v_Recall: 0.693080  v_F1: 0.700866  v_AUC: 0.911103
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.188442    reg_loss: 0.023452    l2_loss: 0.029705    loss: 0.241600
steps 9400    v_Prec: 0.725040  v_Recall: 0.686470  v_F1: 0.705228  v_AUC: 0.912291
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.195870    reg_loss: 0.023481    l2_loss: 0.029889    loss: 0.249239
steps 9600    v_Prec: 0.724065  v_Recall: 0.681453  v_F1: 0.702113  v_AUC: 0.912804
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.193738    reg_loss: 0.023447    l2_loss: 0.030249    loss: 0.247434
steps 9800    v_Prec: 0.748870  v_Recall: 0.673011  v_F1: 0.708917  v_AUC: 0.915180
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.190134    reg_loss: 0.023538    l2_loss: 0.030422    loss: 0.244094
steps 10000    v_Prec: 0.758088  v_Recall: 0.668074  v_F1: 0.710240  v_AUC: 0.916238
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.190762    reg_loss: 0.023480    l2_loss: 0.030418    loss: 0.244660
steps 10200    v_Prec: 0.727890  v_Recall: 0.700008  v_F1: 0.713677  v_AUC: 0.918351
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.191337    reg_loss: 0.023391    l2_loss: 0.030722    loss: 0.245450
steps 10400    v_Prec: 0.766428  v_Recall: 0.673409  v_F1: 0.716914  v_AUC: 0.918838
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.189997    reg_loss: 0.023408    l2_loss: 0.030854    loss: 0.244259
steps 10600    v_Prec: 0.770651  v_Recall: 0.667914  v_F1: 0.715614  v_AUC: 0.921068
steps 10600    running time 385 seconds

steps 10800    base_loss: 0.179838    reg_loss: 0.023412    l2_loss: 0.030984    loss: 0.234234
steps 10800    v_Prec: 0.757323  v_Recall: 0.685673  v_F1: 0.719719  v_AUC: 0.920606
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.081591    reg_loss: 0.023582    l2_loss: 0.031060    loss: 0.136233
steps 11000    v_Prec: 0.747783  v_Recall: 0.671498  v_F1: 0.707590  v_AUC: 0.914294
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.077070    reg_loss: 0.023516    l2_loss: 0.031148    loss: 0.131734
steps 11200    v_Prec: 0.740012  v_Recall: 0.662340  v_F1: 0.699025  v_AUC: 0.909739
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.083330    reg_loss: 0.023497    l2_loss: 0.031360    loss: 0.138188
steps 11400    v_Prec: 0.721947  v_Recall: 0.662499  v_F1: 0.690947  v_AUC: 0.905355
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.080768    reg_loss: 0.023507    l2_loss: 0.031413    loss: 0.135689
steps 11600    v_Prec: 0.704538  v_Recall: 0.675082  v_F1: 0.689495  v_AUC: 0.902973
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.083102    reg_loss: 0.023537    l2_loss: 0.031609    loss: 0.138248
steps 11800    v_Prec: 0.726727  v_Recall: 0.645935  v_F1: 0.683953  v_AUC: 0.902399
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.086848    reg_loss: 0.023456    l2_loss: 0.031837    loss: 0.142141
steps 12000    v_Prec: 0.720782  v_Recall: 0.646333  v_F1: 0.681530  v_AUC: 0.900668
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.084813    reg_loss: 0.023422    l2_loss: 0.031812    loss: 0.140047
steps 12200    v_Prec: 0.724920  v_Recall: 0.649120  v_F1: 0.684929  v_AUC: 0.899373
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.091652    reg_loss: 0.023397    l2_loss: 0.031890    loss: 0.146939
steps 12400    v_Prec: 0.702539  v_Recall: 0.663375  v_F1: 0.682395  v_AUC: 0.899560
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.095117    reg_loss: 0.023475    l2_loss: 0.031958    loss: 0.150551
steps 12600    v_Prec: 0.713890  v_Recall: 0.656924  v_F1: 0.684224  v_AUC: 0.899327
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.086524    reg_loss: 0.023442    l2_loss: 0.032130    loss: 0.142096
steps 12800    v_Prec: 0.711773  v_Recall: 0.654296  v_F1: 0.681826  v_AUC: 0.898072
steps 12800    running time 453 seconds

Early stop model F1: 0.719719
testing thre: 0.38969046
testing Prec: 0.5456415348606284
testing Recall: 0.7478007290400972
testing F1: 0.6309228466569619
testing AUC: 0.9002410083133885
overall running time 456 seconds
(0.7245577762462669, 0.6131713244228433, 0.6642272356332429, 0.9002410083133885, 0.7362823)

2019-02-24 01:11:12.479378: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:11:12.872862: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:11:12.874436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:11:12.874472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 22.720000 seconds
loading data in 28.770000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.01
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.386631    reg_loss: 0.021546    l2_loss: 0.013339    loss: 1.421515
steps 200    v_Prec: 0.161348  v_Recall: 1.000000  v_F1: 0.277863  v_AUC: 0.471946
steps 200    running time 38 seconds

steps 400    base_loss: 0.735807    reg_loss: 0.021778    l2_loss: 0.013450    loss: 0.771035
steps 400    v_Prec: 0.161348  v_Recall: 1.000000  v_F1: 0.277863  v_AUC: 0.499314
steps 400    running time 45 seconds

steps 600    base_loss: 0.480625    reg_loss: 0.021822    l2_loss: 0.013586    loss: 0.516032
steps 600    v_Prec: 0.162866  v_Recall: 0.964985  v_F1: 0.278694  v_AUC: 0.533032
steps 600    running time 51 seconds

steps 800    base_loss: 0.467999    reg_loss: 0.021817    l2_loss: 0.013497    loss: 0.503314
steps 800    v_Prec: 0.176607  v_Recall: 0.732492  v_F1: 0.284597  v_AUC: 0.566860
steps 800    running time 58 seconds

steps 1000    base_loss: 0.464897    reg_loss: 0.021808    l2_loss: 0.013436    loss: 0.500142
steps 1000    v_Prec: 0.217390  v_Recall: 0.494744  v_F1: 0.302056  v_AUC: 0.605234
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.448527    reg_loss: 0.021751    l2_loss: 0.013328    loss: 0.483606
steps 1200    v_Prec: 0.249254  v_Recall: 0.466279  v_F1: 0.324854  v_AUC: 0.634091
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.437016    reg_loss: 0.021742    l2_loss: 0.013326    loss: 0.472084
steps 1400    v_Prec: 0.318672  v_Recall: 0.418324  v_F1: 0.361761  v_AUC: 0.668126
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.423433    reg_loss: 0.021790    l2_loss: 0.013327    loss: 0.458550
steps 1600    v_Prec: 0.431473  v_Recall: 0.386463  v_F1: 0.407730  v_AUC: 0.702001
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.403992    reg_loss: 0.021906    l2_loss: 0.013408    loss: 0.439307
steps 1800    v_Prec: 0.496218  v_Recall: 0.419133  v_F1: 0.454430  v_AUC: 0.738206
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.381665    reg_loss: 0.021925    l2_loss: 0.013644    loss: 0.417233
steps 2000    v_Prec: 0.517394  v_Recall: 0.472667  v_F1: 0.494020  v_AUC: 0.769683
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.359014    reg_loss: 0.021982    l2_loss: 0.013947    loss: 0.394943
steps 2200    v_Prec: 0.568496  v_Recall: 0.508410  v_F1: 0.536777  v_AUC: 0.799153
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.343591    reg_loss: 0.022073    l2_loss: 0.014239    loss: 0.379903
steps 2400    v_Prec: 0.629290  v_Recall: 0.499677  v_F1: 0.557043  v_AUC: 0.815199
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.334123    reg_loss: 0.022241    l2_loss: 0.014508    loss: 0.370872
steps 2600    v_Prec: 0.646072  v_Recall: 0.529355  v_F1: 0.581918  v_AUC: 0.831883
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.328103    reg_loss: 0.022374    l2_loss: 0.014887    loss: 0.365364
steps 2800    v_Prec: 0.681841  v_Recall: 0.538978  v_F1: 0.602050  v_AUC: 0.842144
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.302580    reg_loss: 0.022308    l2_loss: 0.015131    loss: 0.340019
steps 3000    v_Prec: 0.680876  v_Recall: 0.555394  v_F1: 0.611767  v_AUC: 0.848952
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.299358    reg_loss: 0.022401    l2_loss: 0.015441    loss: 0.337199
steps 3200    v_Prec: 0.698462  v_Recall: 0.569060  v_F1: 0.627156  v_AUC: 0.857306
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.296689    reg_loss: 0.022524    l2_loss: 0.015777    loss: 0.334989
steps 3400    v_Prec: 0.710752  v_Recall: 0.583212  v_F1: 0.640696  v_AUC: 0.864570
steps 3400    running time 145 seconds

steps 3600    base_loss: 0.295560    reg_loss: 0.022481    l2_loss: 0.016155    loss: 0.334196
steps 3600    v_Prec: 0.727893  v_Recall: 0.586447  v_F1: 0.649559  v_AUC: 0.869285
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.284061    reg_loss: 0.022539    l2_loss: 0.016477    loss: 0.323077
steps 3800    v_Prec: 0.741113  v_Recall: 0.590086  v_F1: 0.657032  v_AUC: 0.873047
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.284379    reg_loss: 0.022548    l2_loss: 0.016839    loss: 0.323766
steps 4000    v_Prec: 0.735196  v_Recall: 0.604399  v_F1: 0.663412  v_AUC: 0.876607
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.281988    reg_loss: 0.022522    l2_loss: 0.017181    loss: 0.321691
steps 4200    v_Prec: 0.738292  v_Recall: 0.613214  v_F1: 0.669965  v_AUC: 0.879285
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.268400    reg_loss: 0.022536    l2_loss: 0.017574    loss: 0.308510
steps 4400    v_Prec: 0.711681  v_Recall: 0.634563  v_F1: 0.670913  v_AUC: 0.882153
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.265292    reg_loss: 0.022621    l2_loss: 0.017897    loss: 0.305810
steps 4600    v_Prec: 0.723056  v_Recall: 0.639091  v_F1: 0.678486  v_AUC: 0.885276
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.266526    reg_loss: 0.022614    l2_loss: 0.018411    loss: 0.307551
steps 4800    v_Prec: 0.744721  v_Recall: 0.633188  v_F1: 0.684441  v_AUC: 0.887199
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.264339    reg_loss: 0.022611    l2_loss: 0.018797    loss: 0.305747
steps 5000    v_Prec: 0.763249  v_Recall: 0.623079  v_F1: 0.686078  v_AUC: 0.888791
steps 5000    running time 199 seconds

steps 5200    base_loss: 0.261707    reg_loss: 0.022595    l2_loss: 0.019282    loss: 0.303584
steps 5200    v_Prec: 0.744617  v_Recall: 0.646046  v_F1: 0.691838  v_AUC: 0.890523
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.253672    reg_loss: 0.022435    l2_loss: 0.019722    loss: 0.295828
steps 5400    v_Prec: 0.767245  v_Recall: 0.636827  v_F1: 0.695979  v_AUC: 0.892940
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.172674    reg_loss: 0.021645    l2_loss: 0.020087    loss: 0.214406
steps 5600    v_Prec: 0.751414  v_Recall: 0.644590  v_F1: 0.693915  v_AUC: 0.890656
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.172114    reg_loss: 0.021625    l2_loss: 0.020457    loss: 0.214196
steps 5800    v_Prec: 0.756757  v_Recall: 0.640789  v_F1: 0.693962  v_AUC: 0.887786
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.165549    reg_loss: 0.021466    l2_loss: 0.020771    loss: 0.207787
steps 6000    v_Prec: 0.778421  v_Recall: 0.630681  v_F1: 0.696806  v_AUC: 0.887847
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.162549    reg_loss: 0.021522    l2_loss: 0.021089    loss: 0.205160
steps 6200    v_Prec: 0.782503  v_Recall: 0.622028  v_F1: 0.693098  v_AUC: 0.887467
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.167085    reg_loss: 0.021551    l2_loss: 0.021222    loss: 0.209857
steps 6400    v_Prec: 0.757377  v_Recall: 0.645480  v_F1: 0.696966  v_AUC: 0.888605
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.166407    reg_loss: 0.021559    l2_loss: 0.021576    loss: 0.209542
steps 6600    v_Prec: 0.771473  v_Recall: 0.642083  v_F1: 0.700856  v_AUC: 0.890344
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.174461    reg_loss: 0.021462    l2_loss: 0.021855    loss: 0.217778
steps 6800    v_Prec: 0.780661  v_Recall: 0.632622  v_F1: 0.698888  v_AUC: 0.889802
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.175788    reg_loss: 0.021546    l2_loss: 0.022042    loss: 0.219376
steps 7000    v_Prec: 0.760305  v_Recall: 0.653324  v_F1: 0.702766  v_AUC: 0.891739
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.168644    reg_loss: 0.021580    l2_loss: 0.022214    loss: 0.212439
steps 7200    v_Prec: 0.771651  v_Recall: 0.648472  v_F1: 0.704719  v_AUC: 0.893023
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.169442    reg_loss: 0.021586    l2_loss: 0.022292    loss: 0.213320
steps 7400    v_Prec: 0.787713  v_Recall: 0.641841  v_F1: 0.707334  v_AUC: 0.894362
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.183863    reg_loss: 0.021603    l2_loss: 0.022453    loss: 0.227919
steps 7600    v_Prec: 0.798782  v_Recall: 0.636261  v_F1: 0.708318  v_AUC: 0.896837
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.182279    reg_loss: 0.021640    l2_loss: 0.022481    loss: 0.226400
steps 7800    v_Prec: 0.778608  v_Recall: 0.656963  v_F1: 0.712632  v_AUC: 0.899811
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.183042    reg_loss: 0.021734    l2_loss: 0.022645    loss: 0.227420
steps 8000    v_Prec: 0.774422  v_Recall: 0.663513  v_F1: 0.714690  v_AUC: 0.899437
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.178627    reg_loss: 0.021643    l2_loss: 0.022786    loss: 0.223057
steps 8200    v_Prec: 0.785942  v_Recall: 0.658257  v_F1: 0.716455  v_AUC: 0.899736
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.171729    reg_loss: 0.021605    l2_loss: 0.022748    loss: 0.216082
steps 8400    v_Prec: 0.772254  v_Recall: 0.665777  v_F1: 0.715074  v_AUC: 0.901509
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.176669    reg_loss: 0.021657    l2_loss: 0.022836    loss: 0.221163
steps 8600    v_Prec: 0.782403  v_Recall: 0.668769  v_F1: 0.721137  v_AUC: 0.903688
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.180448    reg_loss: 0.021669    l2_loss: 0.022973    loss: 0.225089
steps 8800    v_Prec: 0.788116  v_Recall: 0.667152  v_F1: 0.722607  v_AUC: 0.904542
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.176425    reg_loss: 0.021634    l2_loss: 0.022930    loss: 0.220989
steps 9000    v_Prec: 0.794874  v_Recall: 0.664645  v_F1: 0.723950  v_AUC: 0.904747
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.175150    reg_loss: 0.021663    l2_loss: 0.022898    loss: 0.219711
steps 9200    v_Prec: 0.800078  v_Recall: 0.663432  v_F1: 0.725376  v_AUC: 0.904152
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.177456    reg_loss: 0.021686    l2_loss: 0.023067    loss: 0.222209
steps 9400    v_Prec: 0.815734  v_Recall: 0.659065  v_F1: 0.729078  v_AUC: 0.906733
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.182299    reg_loss: 0.021704    l2_loss: 0.023128    loss: 0.227131
steps 9600    v_Prec: 0.797662  v_Recall: 0.673298  v_F1: 0.730223  v_AUC: 0.907352
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.173048    reg_loss: 0.021756    l2_loss: 0.023154    loss: 0.217958
steps 9800    v_Prec: 0.808277  v_Recall: 0.671276  v_F1: 0.733433  v_AUC: 0.908502
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.174892    reg_loss: 0.021836    l2_loss: 0.023252    loss: 0.219979
steps 10000    v_Prec: 0.796639  v_Recall: 0.678554  v_F1: 0.732870  v_AUC: 0.910116
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.175719    reg_loss: 0.021703    l2_loss: 0.023258    loss: 0.220681
steps 10200    v_Prec: 0.815922  v_Recall: 0.668850  v_F1: 0.735102  v_AUC: 0.909426
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.175970    reg_loss: 0.021687    l2_loss: 0.023282    loss: 0.220939
steps 10400    v_Prec: 0.796234  v_Recall: 0.690765  v_F1: 0.739759  v_AUC: 0.911789
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.176512    reg_loss: 0.021787    l2_loss: 0.023297    loss: 0.221597
steps 10600    v_Prec: 0.803228  v_Recall: 0.688258  v_F1: 0.741312  v_AUC: 0.913223
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.157631    reg_loss: 0.021506    l2_loss: 0.023338    loss: 0.202476
steps 10800    v_Prec: 0.793246  v_Recall: 0.697153  v_F1: 0.742102  v_AUC: 0.912841
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.052354    reg_loss: 0.020531    l2_loss: 0.023109    loss: 0.095994
steps 11000    v_Prec: 0.800340  v_Recall: 0.684943  v_F1: 0.738159  v_AUC: 0.910600
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.051933    reg_loss: 0.020425    l2_loss: 0.022701    loss: 0.095060
steps 11200    v_Prec: 0.803729  v_Recall: 0.676209  v_F1: 0.734475  v_AUC: 0.906407
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.055486    reg_loss: 0.020282    l2_loss: 0.022303    loss: 0.098071
steps 11400    v_Prec: 0.786621  v_Recall: 0.686560  v_F1: 0.733192  v_AUC: 0.905255
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.048804    reg_loss: 0.020274    l2_loss: 0.021922    loss: 0.091000
steps 11600    v_Prec: 0.787997  v_Recall: 0.685913  v_F1: 0.733420  v_AUC: 0.905062
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.050245    reg_loss: 0.020231    l2_loss: 0.021670    loss: 0.092145
steps 11800    v_Prec: 0.781039  v_Recall: 0.682193  v_F1: 0.728277  v_AUC: 0.903331
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.049532    reg_loss: 0.020264    l2_loss: 0.021350    loss: 0.091147
steps 12000    v_Prec: 0.785232  v_Recall: 0.676775  v_F1: 0.726981  v_AUC: 0.901612
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.050191    reg_loss: 0.020242    l2_loss: 0.021125    loss: 0.091558
steps 12200    v_Prec: 0.793541  v_Recall: 0.667637  v_F1: 0.725165  v_AUC: 0.901014
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.052814    reg_loss: 0.020214    l2_loss: 0.021023    loss: 0.094050
steps 12400    v_Prec: 0.772943  v_Recall: 0.683810  v_F1: 0.725650  v_AUC: 0.901913
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.056636    reg_loss: 0.020225    l2_loss: 0.020776    loss: 0.097637
steps 12600    v_Prec: 0.760276  v_Recall: 0.686560  v_F1: 0.721540  v_AUC: 0.900764
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.056425    reg_loss: 0.020147    l2_loss: 0.020627    loss: 0.097200
steps 12800    v_Prec: 0.781191  v_Recall: 0.668365  v_F1: 0.720387  v_AUC: 0.900128
steps 12800    running time 453 seconds

Early stop model F1: 0.742102
testing thre: 0.53542906
testing Prec: 0.6309909111061849
testing Recall: 0.6917132442284326
testing F1: 0.6599582657083237
testing AUC: 0.8875234677647272
overall running time 456 seconds
(0.7311234932908801, 0.6249817739975698, 0.6738988025050441, 0.8875234677647272, 0.74827784)

2019-02-24 01:16:41.293048: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:16:41.655283: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:16:41.656176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:16:41.656210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.110000 seconds
loading data in 29.490000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.023632    reg_loss: 0.064864    l2_loss: 0.013374    loss: 1.101869
steps 200    v_Prec: 0.167465  v_Recall: 0.944933  v_F1: 0.284508  v_AUC: 0.529999
steps 200    running time 40 seconds

steps 400    base_loss: 0.664101    reg_loss: 0.064703    l2_loss: 0.013499    loss: 0.742304
steps 400    v_Prec: 0.172929  v_Recall: 0.859124  v_F1: 0.287907  v_AUC: 0.544719
steps 400    running time 47 seconds

steps 600    base_loss: 0.516082    reg_loss: 0.064565    l2_loss: 0.013500    loss: 0.594147
steps 600    v_Prec: 0.186444  v_Recall: 0.723160  v_F1: 0.296456  v_AUC: 0.577046
steps 600    running time 54 seconds

steps 800    base_loss: 0.484005    reg_loss: 0.064375    l2_loss: 0.013416    loss: 0.561796
steps 800    v_Prec: 0.226246  v_Recall: 0.555424  v_F1: 0.321523  v_AUC: 0.627517
steps 800    running time 61 seconds

steps 1000    base_loss: 0.464318    reg_loss: 0.064225    l2_loss: 0.013226    loss: 0.541769
steps 1000    v_Prec: 0.278939  v_Recall: 0.484193  v_F1: 0.353963  v_AUC: 0.668479
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.436441    reg_loss: 0.063807    l2_loss: 0.013177    loss: 0.513425
steps 1200    v_Prec: 0.367091  v_Recall: 0.468426  v_F1: 0.411613  v_AUC: 0.718299
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.410624    reg_loss: 0.063374    l2_loss: 0.013253    loss: 0.487251
steps 1400    v_Prec: 0.495204  v_Recall: 0.437683  v_F1: 0.464670  v_AUC: 0.757473
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.383304    reg_loss: 0.062888    l2_loss: 0.013373    loss: 0.459565
steps 1600    v_Prec: 0.536612  v_Recall: 0.497029  v_F1: 0.516063  v_AUC: 0.789896
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.352968    reg_loss: 0.062272    l2_loss: 0.013582    loss: 0.428822
steps 1800    v_Prec: 0.577606  v_Recall: 0.531337  v_F1: 0.553506  v_AUC: 0.814370
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.338205    reg_loss: 0.061751    l2_loss: 0.013824    loss: 0.413781
steps 2000    v_Prec: 0.612059  v_Recall: 0.554156  v_F1: 0.581670  v_AUC: 0.832383
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.327838    reg_loss: 0.061241    l2_loss: 0.014049    loss: 0.403128
steps 2200    v_Prec: 0.638221  v_Recall: 0.571825  v_F1: 0.603201  v_AUC: 0.848748
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.305375    reg_loss: 0.060655    l2_loss: 0.014292    loss: 0.380322
steps 2400    v_Prec: 0.663144  v_Recall: 0.581650  v_F1: 0.619729  v_AUC: 0.858305
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.303046    reg_loss: 0.060291    l2_loss: 0.014500    loss: 0.377837
steps 2600    v_Prec: 0.700872  v_Recall: 0.573092  v_F1: 0.630574  v_AUC: 0.865167
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.302251    reg_loss: 0.059818    l2_loss: 0.014748    loss: 0.376817
steps 2800    v_Prec: 0.683488  v_Recall: 0.611679  v_F1: 0.645593  v_AUC: 0.870814
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.292472    reg_loss: 0.059227    l2_loss: 0.015038    loss: 0.366737
steps 3000    v_Prec: 0.705856  v_Recall: 0.615086  v_F1: 0.657352  v_AUC: 0.875481
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.276796    reg_loss: 0.058890    l2_loss: 0.015320    loss: 0.351007
steps 3200    v_Prec: 0.715245  v_Recall: 0.615958  v_F1: 0.661899  v_AUC: 0.879138
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.277104    reg_loss: 0.058885    l2_loss: 0.015618    loss: 0.351607
steps 3400    v_Prec: 0.715587  v_Recall: 0.635132  v_F1: 0.672963  v_AUC: 0.884473
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.284647    reg_loss: 0.058590    l2_loss: 0.015879    loss: 0.359116
steps 3600    v_Prec: 0.722570  v_Recall: 0.639727  v_F1: 0.678630  v_AUC: 0.887686
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.270331    reg_loss: 0.058077    l2_loss: 0.016243    loss: 0.344651
steps 3800    v_Prec: 0.730964  v_Recall: 0.640441  v_F1: 0.682715  v_AUC: 0.889309
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.279814    reg_loss: 0.057839    l2_loss: 0.016539    loss: 0.354192
steps 4000    v_Prec: 0.749293  v_Recall: 0.629903  v_F1: 0.684430  v_AUC: 0.891464
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.264397    reg_loss: 0.057608    l2_loss: 0.016881    loss: 0.338886
steps 4200    v_Prec: 0.724195  v_Recall: 0.659298  v_F1: 0.690224  v_AUC: 0.894955
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.257535    reg_loss: 0.057258    l2_loss: 0.017119    loss: 0.331911
steps 4400    v_Prec: 0.722915  v_Recall: 0.665637  v_F1: 0.693095  v_AUC: 0.896607
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.268237    reg_loss: 0.057094    l2_loss: 0.017499    loss: 0.342830
steps 4600    v_Prec: 0.744150  v_Recall: 0.647572  v_F1: 0.692510  v_AUC: 0.897991
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.256931    reg_loss: 0.056736    l2_loss: 0.017921    loss: 0.331588
steps 4800    v_Prec: 0.738599  v_Recall: 0.660883  v_F1: 0.697583  v_AUC: 0.899073
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.267337    reg_loss: 0.056728    l2_loss: 0.018284    loss: 0.342349
steps 5000    v_Prec: 0.760117  v_Recall: 0.656287  v_F1: 0.704397  v_AUC: 0.901218
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.259492    reg_loss: 0.056293    l2_loss: 0.018747    loss: 0.334531
steps 5200    v_Prec: 0.747427  v_Recall: 0.667538  v_F1: 0.705227  v_AUC: 0.903459
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.253869    reg_loss: 0.055882    l2_loss: 0.019165    loss: 0.328916
steps 5400    v_Prec: 0.744558  v_Recall: 0.674828  v_F1: 0.707980  v_AUC: 0.906103
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.160477    reg_loss: 0.051589    l2_loss: 0.019686    loss: 0.231753
steps 5600    v_Prec: 0.750494  v_Recall: 0.662547  v_F1: 0.703783  v_AUC: 0.902343
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.178360    reg_loss: 0.052244    l2_loss: 0.020457    loss: 0.251061
steps 5800    v_Prec: 0.756171  v_Recall: 0.657793  v_F1: 0.703559  v_AUC: 0.902474
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.170907    reg_loss: 0.051847    l2_loss: 0.021150    loss: 0.243904
steps 6000    v_Prec: 0.750652  v_Recall: 0.661437  v_F1: 0.703226  v_AUC: 0.901118
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.178447    reg_loss: 0.051709    l2_loss: 0.021615    loss: 0.251771
steps 6200    v_Prec: 0.735557  v_Recall: 0.670866  v_F1: 0.701724  v_AUC: 0.900476
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.174461    reg_loss: 0.051491    l2_loss: 0.022252    loss: 0.248204
steps 6400    v_Prec: 0.765089  v_Recall: 0.650820  v_F1: 0.703344  v_AUC: 0.902064
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.170971    reg_loss: 0.051167    l2_loss: 0.022572    loss: 0.244709
steps 6600    v_Prec: 0.758434  v_Recall: 0.664448  v_F1: 0.708337  v_AUC: 0.903686
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.177685    reg_loss: 0.050894    l2_loss: 0.022836    loss: 0.251415
steps 6800    v_Prec: 0.755771  v_Recall: 0.666667  v_F1: 0.708428  v_AUC: 0.903430
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.176694    reg_loss: 0.051036    l2_loss: 0.023246    loss: 0.250976
steps 7000    v_Prec: 0.750000  v_Recall: 0.682196  v_F1: 0.714493  v_AUC: 0.905868
steps 7000    running time 266 seconds

steps 7200    base_loss: 0.185680    reg_loss: 0.050936    l2_loss: 0.023516    loss: 0.260132
steps 7200    v_Prec: 0.770367  v_Recall: 0.665320  v_F1: 0.714000  v_AUC: 0.905911
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.173210    reg_loss: 0.050313    l2_loss: 0.023650    loss: 0.247172
steps 7400    v_Prec: 0.777726  v_Recall: 0.666191  v_F1: 0.717651  v_AUC: 0.907330
steps 7400    running time 279 seconds

steps 7600    base_loss: 0.181965    reg_loss: 0.050420    l2_loss: 0.023840    loss: 0.256224
steps 7600    v_Prec: 0.763385  v_Recall: 0.678948  v_F1: 0.718695  v_AUC: 0.907934
steps 7600    running time 285 seconds

steps 7800    base_loss: 0.170376    reg_loss: 0.050040    l2_loss: 0.024018    loss: 0.244435
steps 7800    v_Prec: 0.772946  v_Recall: 0.673243  v_F1: 0.719658  v_AUC: 0.908938
steps 7800    running time 292 seconds

steps 8000    base_loss: 0.180096    reg_loss: 0.050078    l2_loss: 0.024341    loss: 0.254515
steps 8000    v_Prec: 0.748423  v_Recall: 0.695824  v_F1: 0.721166  v_AUC: 0.908471
steps 8000    running time 299 seconds

steps 8200    base_loss: 0.180473    reg_loss: 0.050059    l2_loss: 0.024335    loss: 0.254866
steps 8200    v_Prec: 0.772686  v_Recall: 0.681404  v_F1: 0.724180  v_AUC: 0.911905
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.181154    reg_loss: 0.049953    l2_loss: 0.024537    loss: 0.255645
steps 8400    v_Prec: 0.782388  v_Recall: 0.682830  v_F1: 0.729227  v_AUC: 0.913476
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.182228    reg_loss: 0.049786    l2_loss: 0.024721    loss: 0.256734
steps 8600    v_Prec: 0.746495  v_Recall: 0.708819  v_F1: 0.727169  v_AUC: 0.912516
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.176934    reg_loss: 0.049497    l2_loss: 0.024750    loss: 0.251181
steps 8800    v_Prec: 0.776476  v_Recall: 0.693051  v_F1: 0.732396  v_AUC: 0.915391
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.182496    reg_loss: 0.049768    l2_loss: 0.024820    loss: 0.257084
steps 9000    v_Prec: 0.783808  v_Recall: 0.691150  v_F1: 0.734568  v_AUC: 0.916984
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.183046    reg_loss: 0.049660    l2_loss: 0.025012    loss: 0.257718
steps 9200    v_Prec: 0.772200  v_Recall: 0.702084  v_F1: 0.735475  v_AUC: 0.917593
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.179959    reg_loss: 0.049307    l2_loss: 0.025073    loss: 0.254340
steps 9400    v_Prec: 0.783825  v_Recall: 0.692655  v_F1: 0.735425  v_AUC: 0.918150
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.180558    reg_loss: 0.049161    l2_loss: 0.025242    loss: 0.254960
steps 9600    v_Prec: 0.766393  v_Recall: 0.711196  v_F1: 0.737764  v_AUC: 0.918453
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.184742    reg_loss: 0.049070    l2_loss: 0.025327    loss: 0.259139
steps 9800    v_Prec: 0.774551  v_Recall: 0.703668  v_F1: 0.737410  v_AUC: 0.920214
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.184689    reg_loss: 0.048766    l2_loss: 0.025333    loss: 0.258788
steps 10000    v_Prec: 0.772960  v_Recall: 0.704857  v_F1: 0.737339  v_AUC: 0.921411
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.184168    reg_loss: 0.048799    l2_loss: 0.025422    loss: 0.258389
steps 10200    v_Prec: 0.744141  v_Recall: 0.734649  v_F1: 0.739364  v_AUC: 0.921826
steps 10200    running time 369 seconds

steps 10400    base_loss: 0.177348    reg_loss: 0.048798    l2_loss: 0.025494    loss: 0.251640
steps 10400    v_Prec: 0.787833  v_Recall: 0.700816  v_F1: 0.741781  v_AUC: 0.922506
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.189232    reg_loss: 0.048714    l2_loss: 0.025569    loss: 0.263515
steps 10600    v_Prec: 0.768399  v_Recall: 0.714761  v_F1: 0.740610  v_AUC: 0.921464
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.160938    reg_loss: 0.047797    l2_loss: 0.025619    loss: 0.234354
steps 10800    v_Prec: 0.769744  v_Recall: 0.722051  v_F1: 0.745135  v_AUC: 0.922810
steps 10800    running time 388 seconds

steps 11000    base_loss: 0.070594    reg_loss: 0.043312    l2_loss: 0.025586    loss: 0.139492
steps 11000    v_Prec: 0.773984  v_Recall: 0.709532  v_F1: 0.740358  v_AUC: 0.920545
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.068285    reg_loss: 0.043204    l2_loss: 0.025415    loss: 0.136903
steps 11200    v_Prec: 0.797717  v_Recall: 0.692100  v_F1: 0.741165  v_AUC: 0.921511
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.064502    reg_loss: 0.043261    l2_loss: 0.025376    loss: 0.133139
steps 11400    v_Prec: 0.792847  v_Recall: 0.692021  v_F1: 0.739011  v_AUC: 0.919216
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.064181    reg_loss: 0.043115    l2_loss: 0.025366    loss: 0.132662
steps 11600    v_Prec: 0.787100  v_Recall: 0.694240  v_F1: 0.737759  v_AUC: 0.918395
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.061576    reg_loss: 0.043175    l2_loss: 0.025326    loss: 0.130077
steps 11800    v_Prec: 0.793057  v_Recall: 0.695032  v_F1: 0.740816  v_AUC: 0.918964
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.065363    reg_loss: 0.043301    l2_loss: 0.025336    loss: 0.134000
steps 12000    v_Prec: 0.776941  v_Recall: 0.702638  v_F1: 0.737924  v_AUC: 0.917231
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.068418    reg_loss: 0.043309    l2_loss: 0.025299    loss: 0.137026
steps 12200    v_Prec: 0.793075  v_Recall: 0.691467  v_F1: 0.738794  v_AUC: 0.918027
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.073392    reg_loss: 0.043543    l2_loss: 0.025318    loss: 0.142254
steps 12400    v_Prec: 0.789768  v_Recall: 0.693527  v_F1: 0.738525  v_AUC: 0.917951
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.074324    reg_loss: 0.043367    l2_loss: 0.025194    loss: 0.142885
steps 12600    v_Prec: 0.779893  v_Recall: 0.701291  v_F1: 0.738506  v_AUC: 0.916388
steps 12600    running time 445 seconds

steps 12800    base_loss: 0.074070    reg_loss: 0.043527    l2_loss: 0.025295    loss: 0.142892
steps 12800    v_Prec: 0.790216  v_Recall: 0.692417  v_F1: 0.738091  v_AUC: 0.918172
steps 12800    running time 451 seconds

Early stop model F1: 0.745135
testing thre: 0.4334672
testing Prec: 0.5602120495737517
testing Recall: 0.7601458080194411
testing F1: 0.6450415523890045
testing AUC: 0.9001288261220486
overall running time 454 seconds
(0.6992294564823913, 0.6571567436208992, 0.6775405892964522, 0.9001288261220486, 0.7592506)

2019-02-24 01:21:57.104185: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:21:57.575841: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:21:57.576775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:21:57.576819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.420000 seconds
loading data in 30.570000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.507006    reg_loss: 0.064623    l2_loss: 0.013356    loss: 0.584985
steps 200    v_Prec: 0.163683  v_Recall: 1.000000  v_F1: 0.281319  v_AUC: 0.495449
steps 200    running time 40 seconds

steps 400    base_loss: 0.502065    reg_loss: 0.064575    l2_loss: 0.013110    loss: 0.579750
steps 400    v_Prec: 0.165330  v_Recall: 0.971463  v_F1: 0.282571  v_AUC: 0.541330
steps 400    running time 48 seconds

steps 600    base_loss: 0.468901    reg_loss: 0.064270    l2_loss: 0.012859    loss: 0.546030
steps 600    v_Prec: 0.223724  v_Recall: 0.558230  v_F1: 0.319429  v_AUC: 0.631617
steps 600    running time 55 seconds

steps 800    base_loss: 0.447206    reg_loss: 0.064373    l2_loss: 0.012676    loss: 0.524254
steps 800    v_Prec: 0.307152  v_Recall: 0.487844  v_F1: 0.376963  v_AUC: 0.700134
steps 800    running time 61 seconds

steps 1000    base_loss: 0.430652    reg_loss: 0.064735    l2_loss: 0.012693    loss: 0.508079
steps 1000    v_Prec: 0.422411  v_Recall: 0.452850  v_F1: 0.437101  v_AUC: 0.753705
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.408137    reg_loss: 0.064913    l2_loss: 0.012665    loss: 0.485715
steps 1200    v_Prec: 0.460350  v_Recall: 0.501156  v_F1: 0.479887  v_AUC: 0.782656
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.376679    reg_loss: 0.065118    l2_loss: 0.012717    loss: 0.454514
steps 1400    v_Prec: 0.504916  v_Recall: 0.523954  v_F1: 0.514259  v_AUC: 0.806615
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.353158    reg_loss: 0.065420    l2_loss: 0.012862    loss: 0.431440
steps 1600    v_Prec: 0.572112  v_Recall: 0.514468  v_F1: 0.541761  v_AUC: 0.824380
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.338793    reg_loss: 0.065794    l2_loss: 0.013023    loss: 0.417610
steps 1800    v_Prec: 0.587314  v_Recall: 0.541012  v_F1: 0.563213  v_AUC: 0.838040
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.328569    reg_loss: 0.066139    l2_loss: 0.013234    loss: 0.407942
steps 2000    v_Prec: 0.626187  v_Recall: 0.552013  v_F1: 0.586765  v_AUC: 0.849505
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.315742    reg_loss: 0.066381    l2_loss: 0.013472    loss: 0.395595
steps 2200    v_Prec: 0.624957  v_Recall: 0.576485  v_F1: 0.599743  v_AUC: 0.858162
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.318128    reg_loss: 0.066965    l2_loss: 0.013731    loss: 0.398823
steps 2400    v_Prec: 0.624395  v_Recall: 0.607174  v_F1: 0.615664  v_AUC: 0.865373
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.302057    reg_loss: 0.066856    l2_loss: 0.013973    loss: 0.382886
steps 2600    v_Prec: 0.649156  v_Recall: 0.609725  v_F1: 0.628823  v_AUC: 0.873023
steps 2600    running time 123 seconds

steps 2800    base_loss: 0.298027    reg_loss: 0.067253    l2_loss: 0.014237    loss: 0.379516
steps 2800    v_Prec: 0.674035  v_Recall: 0.605261  v_F1: 0.637799  v_AUC: 0.879413
steps 2800    running time 130 seconds

steps 3000    base_loss: 0.289562    reg_loss: 0.067367    l2_loss: 0.014562    loss: 0.371491
steps 3000    v_Prec: 0.726614  v_Recall: 0.583260  v_F1: 0.647093  v_AUC: 0.882810
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.284174    reg_loss: 0.067372    l2_loss: 0.014917    loss: 0.366463
steps 3200    v_Prec: 0.695414  v_Recall: 0.608051  v_F1: 0.648805  v_AUC: 0.885034
steps 3200    running time 143 seconds

steps 3400    base_loss: 0.282825    reg_loss: 0.067475    l2_loss: 0.015255    loss: 0.365556
steps 3400    v_Prec: 0.692978  v_Recall: 0.615145  v_F1: 0.651746  v_AUC: 0.886494
steps 3400    running time 150 seconds

steps 3600    base_loss: 0.284211    reg_loss: 0.067545    l2_loss: 0.015584    loss: 0.367340
steps 3600    v_Prec: 0.711140  v_Recall: 0.615225  v_F1: 0.659715  v_AUC: 0.889749
steps 3600    running time 156 seconds

steps 3800    base_loss: 0.272567    reg_loss: 0.067356    l2_loss: 0.016061    loss: 0.355984
steps 3800    v_Prec: 0.702842  v_Recall: 0.628776  v_F1: 0.663750  v_AUC: 0.892970
steps 3800    running time 163 seconds

steps 4000    base_loss: 0.275951    reg_loss: 0.067522    l2_loss: 0.016508    loss: 0.359981
steps 4000    v_Prec: 0.704738  v_Recall: 0.629574  v_F1: 0.665039  v_AUC: 0.893673
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.274661    reg_loss: 0.067515    l2_loss: 0.016947    loss: 0.359123
steps 4200    v_Prec: 0.674179  v_Recall: 0.658111  v_F1: 0.666048  v_AUC: 0.896751
steps 4200    running time 177 seconds

steps 4400    base_loss: 0.270384    reg_loss: 0.067495    l2_loss: 0.017412    loss: 0.355291
steps 4400    v_Prec: 0.669092  v_Recall: 0.659705  v_F1: 0.664365  v_AUC: 0.895895
steps 4400    running time 184 seconds

steps 4600    base_loss: 0.272396    reg_loss: 0.067485    l2_loss: 0.017981    loss: 0.357862
steps 4600    v_Prec: 0.705617  v_Recall: 0.635871  v_F1: 0.668931  v_AUC: 0.897543
steps 4600    running time 190 seconds

steps 4800    base_loss: 0.265863    reg_loss: 0.067325    l2_loss: 0.018491    loss: 0.351679
steps 4800    v_Prec: 0.696210  v_Recall: 0.644320  v_F1: 0.669261  v_AUC: 0.899743
steps 4800    running time 197 seconds

steps 5000    base_loss: 0.257164    reg_loss: 0.067169    l2_loss: 0.019002    loss: 0.343335
steps 5000    v_Prec: 0.690221  v_Recall: 0.647031  v_F1: 0.667928  v_AUC: 0.898386
steps 5000    running time 204 seconds

steps 5200    base_loss: 0.264386    reg_loss: 0.067351    l2_loss: 0.019791    loss: 0.351527
steps 5200    v_Prec: 0.683358  v_Recall: 0.655959  v_F1: 0.669378  v_AUC: 0.902030
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.255881    reg_loss: 0.067290    l2_loss: 0.020478    loss: 0.343648
steps 5400    v_Prec: 0.684704  v_Recall: 0.657633  v_F1: 0.670895  v_AUC: 0.902131
steps 5400    running time 217 seconds

steps 5600    base_loss: 0.169950    reg_loss: 0.067723    l2_loss: 0.021282    loss: 0.258955
steps 5600    v_Prec: 0.681480  v_Recall: 0.650299  v_F1: 0.665525  v_AUC: 0.897353
steps 5600    running time 223 seconds

steps 5800    base_loss: 0.171718    reg_loss: 0.067646    l2_loss: 0.022018    loss: 0.261382
steps 5800    v_Prec: 0.660067  v_Recall: 0.659067  v_F1: 0.659567  v_AUC: 0.894127
steps 5800    running time 230 seconds

steps 6000    base_loss: 0.176580    reg_loss: 0.067806    l2_loss: 0.022691    loss: 0.267076
steps 6000    v_Prec: 0.705997  v_Recall: 0.636269  v_F1: 0.669322  v_AUC: 0.897267
steps 6000    running time 236 seconds

steps 6200    base_loss: 0.183658    reg_loss: 0.067798    l2_loss: 0.023431    loss: 0.274887
steps 6200    v_Prec: 0.692951  v_Recall: 0.633958  v_F1: 0.662143  v_AUC: 0.894989
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.182010    reg_loss: 0.067857    l2_loss: 0.024074    loss: 0.273941
steps 6400    v_Prec: 0.705835  v_Recall: 0.630610  v_F1: 0.666105  v_AUC: 0.897712
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.181944    reg_loss: 0.067609    l2_loss: 0.024618    loss: 0.274171
steps 6600    v_Prec: 0.684468  v_Recall: 0.646712  v_F1: 0.665055  v_AUC: 0.895119
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.183389    reg_loss: 0.067919    l2_loss: 0.025112    loss: 0.276419
steps 6800    v_Prec: 0.684703  v_Recall: 0.647589  v_F1: 0.665629  v_AUC: 0.895399
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.187675    reg_loss: 0.067791    l2_loss: 0.025687    loss: 0.281153
steps 7000    v_Prec: 0.703508  v_Recall: 0.637784  v_F1: 0.669036  v_AUC: 0.897218
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.187215    reg_loss: 0.067552    l2_loss: 0.026174    loss: 0.280941
steps 7200    v_Prec: 0.704858  v_Recall: 0.641929  v_F1: 0.671923  v_AUC: 0.897245
steps 7200    running time 273 seconds

steps 7400    base_loss: 0.188472    reg_loss: 0.067528    l2_loss: 0.026629    loss: 0.282630
steps 7400    v_Prec: 0.709783  v_Recall: 0.639059  v_F1: 0.672567  v_AUC: 0.896970
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.183857    reg_loss: 0.067394    l2_loss: 0.026924    loss: 0.278175
steps 7600    v_Prec: 0.709446  v_Recall: 0.645994  v_F1: 0.676235  v_AUC: 0.899176
steps 7600    running time 286 seconds

steps 7800    base_loss: 0.199330    reg_loss: 0.067775    l2_loss: 0.027263    loss: 0.294368
steps 7800    v_Prec: 0.721304  v_Recall: 0.643683  v_F1: 0.680286  v_AUC: 0.901232
steps 7800    running time 294 seconds

steps 8000    base_loss: 0.186660    reg_loss: 0.067395    l2_loss: 0.027585    loss: 0.281640
steps 8000    v_Prec: 0.727289  v_Recall: 0.642646  v_F1: 0.682353  v_AUC: 0.902985
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.193490    reg_loss: 0.067366    l2_loss: 0.027972    loss: 0.288827
steps 8200    v_Prec: 0.742147  v_Recall: 0.640335  v_F1: 0.687492  v_AUC: 0.904323
steps 8200    running time 307 seconds

steps 8400    base_loss: 0.180009    reg_loss: 0.067184    l2_loss: 0.028278    loss: 0.275472
steps 8400    v_Prec: 0.703108  v_Recall: 0.669031  v_F1: 0.685647  v_AUC: 0.903989
steps 8400    running time 314 seconds

steps 8600    base_loss: 0.194755    reg_loss: 0.067334    l2_loss: 0.028502    loss: 0.290592
steps 8600    v_Prec: 0.746835  v_Recall: 0.644320  v_F1: 0.691801  v_AUC: 0.907670
steps 8600    running time 320 seconds

steps 8800    base_loss: 0.177642    reg_loss: 0.067162    l2_loss: 0.028851    loss: 0.273654
steps 8800    v_Prec: 0.724093  v_Recall: 0.665046  v_F1: 0.693314  v_AUC: 0.908156
steps 8800    running time 327 seconds

steps 9000    base_loss: 0.187516    reg_loss: 0.067156    l2_loss: 0.029021    loss: 0.283692
steps 9000    v_Prec: 0.714635  v_Recall: 0.675329  v_F1: 0.694426  v_AUC: 0.908209
steps 9000    running time 334 seconds

steps 9200    base_loss: 0.192976    reg_loss: 0.067059    l2_loss: 0.029295    loss: 0.289329
steps 9200    v_Prec: 0.738087  v_Recall: 0.661778  v_F1: 0.697852  v_AUC: 0.910660
steps 9200    running time 340 seconds

steps 9400    base_loss: 0.186570    reg_loss: 0.067169    l2_loss: 0.029560    loss: 0.283299
steps 9400    v_Prec: 0.740499  v_Recall: 0.660104  v_F1: 0.697994  v_AUC: 0.910719
steps 9400    running time 347 seconds

steps 9600    base_loss: 0.187146    reg_loss: 0.066916    l2_loss: 0.029865    loss: 0.283926
steps 9600    v_Prec: 0.739525  v_Recall: 0.669669  v_F1: 0.702866  v_AUC: 0.913562
steps 9600    running time 354 seconds

steps 9800    base_loss: 0.190323    reg_loss: 0.067184    l2_loss: 0.030035    loss: 0.287542
steps 9800    v_Prec: 0.718840  v_Recall: 0.697409  v_F1: 0.707962  v_AUC: 0.913944
steps 9800    running time 360 seconds

steps 10000    base_loss: 0.184763    reg_loss: 0.066878    l2_loss: 0.030304    loss: 0.281945
steps 10000    v_Prec: 0.744713  v_Recall: 0.676445  v_F1: 0.708939  v_AUC: 0.915671
steps 10000    running time 367 seconds

steps 10200    base_loss: 0.184611    reg_loss: 0.066699    l2_loss: 0.030446    loss: 0.281756
steps 10200    v_Prec: 0.754359  v_Recall: 0.675887  v_F1: 0.712970  v_AUC: 0.917381
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.181363    reg_loss: 0.066601    l2_loss: 0.030540    loss: 0.278504
steps 10400    v_Prec: 0.761614  v_Recall: 0.676923  v_F1: 0.716776  v_AUC: 0.917856
steps 10400    running time 380 seconds

steps 10600    base_loss: 0.182131    reg_loss: 0.066676    l2_loss: 0.030961    loss: 0.279768
steps 10600    v_Prec: 0.751302  v_Recall: 0.689916  v_F1: 0.719302  v_AUC: 0.919765
steps 10600    running time 387 seconds

steps 10800    base_loss: 0.176675    reg_loss: 0.066659    l2_loss: 0.031106    loss: 0.274440
steps 10800    v_Prec: 0.768071  v_Recall: 0.674213  v_F1: 0.718088  v_AUC: 0.919288
steps 10800    running time 394 seconds

steps 11000    base_loss: 0.076202    reg_loss: 0.066021    l2_loss: 0.031202    loss: 0.173426
steps 11000    v_Prec: 0.737258  v_Recall: 0.676843  v_F1: 0.705760  v_AUC: 0.912326
steps 11000    running time 401 seconds

steps 11200    base_loss: 0.082691    reg_loss: 0.065874    l2_loss: 0.031266    loss: 0.179832
steps 11200    v_Prec: 0.711432  v_Recall: 0.687047  v_F1: 0.699027  v_AUC: 0.909335
steps 11200    running time 407 seconds

steps 11400    base_loss: 0.076312    reg_loss: 0.065911    l2_loss: 0.031446    loss: 0.173668
steps 11400    v_Prec: 0.713225  v_Recall: 0.674053  v_F1: 0.693086  v_AUC: 0.906938
steps 11400    running time 414 seconds

steps 11600    base_loss: 0.079398    reg_loss: 0.065621    l2_loss: 0.031477    loss: 0.176495
steps 11600    v_Prec: 0.715893  v_Recall: 0.659227  v_F1: 0.686392  v_AUC: 0.903171
steps 11600    running time 420 seconds

steps 11800    base_loss: 0.080651    reg_loss: 0.065518    l2_loss: 0.031731    loss: 0.177900
steps 11800    v_Prec: 0.719730  v_Recall: 0.654843  v_F1: 0.685755  v_AUC: 0.901558
steps 11800    running time 426 seconds

steps 12000    base_loss: 0.078070    reg_loss: 0.065467    l2_loss: 0.031718    loss: 0.175255
steps 12000    v_Prec: 0.709176  v_Recall: 0.654285  v_F1: 0.680625  v_AUC: 0.900049
steps 12000    running time 432 seconds

steps 12200    base_loss: 0.080979    reg_loss: 0.065602    l2_loss: 0.031811    loss: 0.178391
steps 12200    v_Prec: 0.681880  v_Recall: 0.684815  v_F1: 0.683344  v_AUC: 0.900940
steps 12200    running time 438 seconds

steps 12400    base_loss: 0.090058    reg_loss: 0.065407    l2_loss: 0.032037    loss: 0.187502
steps 12400    v_Prec: 0.700076  v_Recall: 0.659227  v_F1: 0.679038  v_AUC: 0.897820
steps 12400    running time 444 seconds

steps 12600    base_loss: 0.088103    reg_loss: 0.065338    l2_loss: 0.032021    loss: 0.185462
steps 12600    v_Prec: 0.701186  v_Recall: 0.655241  v_F1: 0.677435  v_AUC: 0.897422
steps 12600    running time 450 seconds

Early stop model F1: 0.719302
testing thre: 0.30442175
testing Prec: 0.5430533174525327
testing Recall: 0.7534386391251519
testing F1: 0.6311760754056309
testing AUC: 0.8972559934799356
overall running time 453 seconds
(0.7044496743473264, 0.6255650060753342, 0.6626679709622612, 0.8972559934799356, 0.6200292)

2019-02-24 01:27:12.343016: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:27:13.983589: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:27:13.984602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:27:13.984637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.980000 seconds
loading data in 30.250000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.881765    reg_loss: 0.064838    l2_loss: 0.013279    loss: 0.959881
steps 200    v_Prec: 0.163507  v_Recall: 0.972550  v_F1: 0.279948  v_AUC: 0.539800
steps 200    running time 41 seconds

steps 400    base_loss: 0.660726    reg_loss: 0.064429    l2_loss: 0.013177    loss: 0.738332
steps 400    v_Prec: 0.168130  v_Recall: 0.883859  v_F1: 0.282518  v_AUC: 0.554716
steps 400    running time 47 seconds

steps 600    base_loss: 0.491907    reg_loss: 0.063806    l2_loss: 0.012903    loss: 0.568616
steps 600    v_Prec: 0.185451  v_Recall: 0.694679  v_F1: 0.292750  v_AUC: 0.580763
steps 600    running time 54 seconds

steps 800    base_loss: 0.469838    reg_loss: 0.063087    l2_loss: 0.012711    loss: 0.545636
steps 800    v_Prec: 0.205280  v_Recall: 0.622843  v_F1: 0.308788  v_AUC: 0.607675
steps 800    running time 61 seconds

steps 1000    base_loss: 0.457029    reg_loss: 0.062541    l2_loss: 0.012599    loss: 0.532170
steps 1000    v_Prec: 0.277543  v_Recall: 0.489927  v_F1: 0.354348  v_AUC: 0.677513
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.438279    reg_loss: 0.061750    l2_loss: 0.012543    loss: 0.512572
steps 1200    v_Prec: 0.376946  v_Recall: 0.458544  v_F1: 0.413761  v_AUC: 0.730295
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.416034    reg_loss: 0.060629    l2_loss: 0.012625    loss: 0.489288
steps 1400    v_Prec: 0.442878  v_Recall: 0.494101  v_F1: 0.467089  v_AUC: 0.769447
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.392837    reg_loss: 0.059603    l2_loss: 0.012776    loss: 0.465216
steps 1600    v_Prec: 0.519652  v_Recall: 0.494502  v_F1: 0.506765  v_AUC: 0.797132
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.365831    reg_loss: 0.058556    l2_loss: 0.012971    loss: 0.437358
steps 1800    v_Prec: 0.539349  v_Recall: 0.536319  v_F1: 0.537830  v_AUC: 0.819390
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.350266    reg_loss: 0.057767    l2_loss: 0.013207    loss: 0.421240
steps 2000    v_Prec: 0.587545  v_Recall: 0.538406  v_F1: 0.561903  v_AUC: 0.835600
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.329353    reg_loss: 0.056922    l2_loss: 0.013498    loss: 0.399772
steps 2200    v_Prec: 0.628810  v_Recall: 0.543061  v_F1: 0.582799  v_AUC: 0.846850
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.319790    reg_loss: 0.056158    l2_loss: 0.013844    loss: 0.389792
steps 2400    v_Prec: 0.653493  v_Recall: 0.553415  v_F1: 0.599305  v_AUC: 0.856924
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.303199    reg_loss: 0.055230    l2_loss: 0.014248    loss: 0.372677
steps 2600    v_Prec: 0.686251  v_Recall: 0.556867  v_F1: 0.614826  v_AUC: 0.865189
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.306646    reg_loss: 0.054743    l2_loss: 0.014612    loss: 0.376000
steps 2800    v_Prec: 0.652814  v_Recall: 0.601413  v_F1: 0.626060  v_AUC: 0.868814
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.298422    reg_loss: 0.054169    l2_loss: 0.015016    loss: 0.367607
steps 3000    v_Prec: 0.675120  v_Recall: 0.598282  v_F1: 0.634383  v_AUC: 0.872256
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.290138    reg_loss: 0.053381    l2_loss: 0.015498    loss: 0.359016
steps 3200    v_Prec: 0.690465  v_Recall: 0.596918  v_F1: 0.640293  v_AUC: 0.874414
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.293704    reg_loss: 0.053150    l2_loss: 0.015890    loss: 0.362744
steps 3400    v_Prec: 0.678787  v_Recall: 0.621800  v_F1: 0.649045  v_AUC: 0.878507
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.291135    reg_loss: 0.052568    l2_loss: 0.016343    loss: 0.360047
steps 3600    v_Prec: 0.696816  v_Recall: 0.616502  v_F1: 0.654203  v_AUC: 0.883566
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.280056    reg_loss: 0.051802    l2_loss: 0.016821    loss: 0.348679
steps 3800    v_Prec: 0.715228  v_Recall: 0.609198  v_F1: 0.657969  v_AUC: 0.881832
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.281255    reg_loss: 0.051276    l2_loss: 0.017319    loss: 0.349850
steps 4000    v_Prec: 0.698864  v_Recall: 0.627177  v_F1: 0.661083  v_AUC: 0.883945
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.283374    reg_loss: 0.050763    l2_loss: 0.017764    loss: 0.351901
steps 4200    v_Prec: 0.722706  v_Recall: 0.613131  v_F1: 0.663424  v_AUC: 0.886067
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.278276    reg_loss: 0.050151    l2_loss: 0.018255    loss: 0.346682
steps 4400    v_Prec: 0.716730  v_Recall: 0.631993  v_F1: 0.671700  v_AUC: 0.889470
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.269659    reg_loss: 0.049615    l2_loss: 0.018769    loss: 0.338042
steps 4600    v_Prec: 0.730114  v_Recall: 0.626214  v_F1: 0.674184  v_AUC: 0.889098
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.270973    reg_loss: 0.049234    l2_loss: 0.019365    loss: 0.339572
steps 4800    v_Prec: 0.718247  v_Recall: 0.644514  v_F1: 0.679386  v_AUC: 0.890781
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.269989    reg_loss: 0.048750    l2_loss: 0.019802    loss: 0.338541
steps 5000    v_Prec: 0.725428  v_Recall: 0.642748  v_F1: 0.681590  v_AUC: 0.891504
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.269839    reg_loss: 0.048336    l2_loss: 0.020288    loss: 0.338463
steps 5200    v_Prec: 0.718611  v_Recall: 0.647725  v_F1: 0.681329  v_AUC: 0.892919
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.270560    reg_loss: 0.047920    l2_loss: 0.020799    loss: 0.339280
steps 5400    v_Prec: 0.726541  v_Recall: 0.651898  v_F1: 0.687199  v_AUC: 0.896442
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.184402    reg_loss: 0.046724    l2_loss: 0.021265    loss: 0.252391
steps 5600    v_Prec: 0.737640  v_Recall: 0.628702  v_F1: 0.678828  v_AUC: 0.891614
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.177487    reg_loss: 0.047001    l2_loss: 0.022024    loss: 0.246511
steps 5800    v_Prec: 0.761862  v_Recall: 0.607031  v_F1: 0.675690  v_AUC: 0.889647
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.181954    reg_loss: 0.047292    l2_loss: 0.022707    loss: 0.251953
steps 6000    v_Prec: 0.724977  v_Recall: 0.638334  v_F1: 0.678902  v_AUC: 0.889813
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.173726    reg_loss: 0.047072    l2_loss: 0.023380    loss: 0.244178
steps 6200    v_Prec: 0.718919  v_Recall: 0.638655  v_F1: 0.676414  v_AUC: 0.888577
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.173411    reg_loss: 0.046656    l2_loss: 0.023945    loss: 0.244012
steps 6400    v_Prec: 0.731186  v_Recall: 0.623084  v_F1: 0.672820  v_AUC: 0.885928
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.185002    reg_loss: 0.046673    l2_loss: 0.024448    loss: 0.256123
steps 6600    v_Prec: 0.731896  v_Recall: 0.637611  v_F1: 0.681508  v_AUC: 0.891497
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.187351    reg_loss: 0.046386    l2_loss: 0.024981    loss: 0.258718
steps 6800    v_Prec: 0.727923  v_Recall: 0.628542  v_F1: 0.674592  v_AUC: 0.887830
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.177146    reg_loss: 0.046171    l2_loss: 0.025361    loss: 0.248678
steps 7000    v_Prec: 0.741902  v_Recall: 0.630548  v_F1: 0.681708  v_AUC: 0.889213
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.185337    reg_loss: 0.046152    l2_loss: 0.025846    loss: 0.257334
steps 7200    v_Prec: 0.734394  v_Recall: 0.641143  v_F1: 0.684607  v_AUC: 0.889881
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.188322    reg_loss: 0.046102    l2_loss: 0.026266    loss: 0.260690
steps 7400    v_Prec: 0.709183  v_Recall: 0.664500  v_F1: 0.686114  v_AUC: 0.892868
steps 7400    running time 276 seconds

Early stop model F1: 0.687199
testing thre: 0.32249653
testing Prec: 0.5423244066411619
testing Recall: 0.7096476306196841
testing F1: 0.6148048338877428
testing AUC: 0.8786486399817905
overall running time 279 seconds
(0.6430205949656751, 0.6282381530984205, 0.6355434274897362, 0.8786486399817905, 0.488414)

2019-02-24 01:30:32.178334: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:30:32.920352: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:30:32.930975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:30:32.931019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.870000 seconds
loading data in 31.020000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.664515    reg_loss: 0.064747    l2_loss: 0.013291    loss: 0.742554
steps 200    v_Prec: 0.164499  v_Recall: 0.999365  v_F1: 0.282498  v_AUC: 0.510941
steps 200    running time 42 seconds

steps 400    base_loss: 0.564299    reg_loss: 0.064797    l2_loss: 0.013164    loss: 0.642261
steps 400    v_Prec: 0.167804  v_Recall: 0.919232  v_F1: 0.283800  v_AUC: 0.530291
steps 400    running time 49 seconds

steps 600    base_loss: 0.511381    reg_loss: 0.064447    l2_loss: 0.012948    loss: 0.588775
steps 600    v_Prec: 0.178145  v_Recall: 0.810616  v_F1: 0.292098  v_AUC: 0.568174
steps 600    running time 55 seconds

steps 800    base_loss: 0.455580    reg_loss: 0.063992    l2_loss: 0.012747    loss: 0.532319
steps 800    v_Prec: 0.236816  v_Recall: 0.549032  v_F1: 0.330903  v_AUC: 0.645080
steps 800    running time 62 seconds

steps 1000    base_loss: 0.442996    reg_loss: 0.064012    l2_loss: 0.012710    loss: 0.519717
steps 1000    v_Prec: 0.333391  v_Recall: 0.459140  v_F1: 0.386289  v_AUC: 0.705362
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.423586    reg_loss: 0.063793    l2_loss: 0.012599    loss: 0.499978
steps 1200    v_Prec: 0.435707  v_Recall: 0.445732  v_F1: 0.440662  v_AUC: 0.753340
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.398490    reg_loss: 0.063777    l2_loss: 0.012633    loss: 0.474899
steps 1400    v_Prec: 0.460045  v_Recall: 0.505633  v_F1: 0.481763  v_AUC: 0.783808
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.380449    reg_loss: 0.064041    l2_loss: 0.012701    loss: 0.457191
steps 1600    v_Prec: 0.510897  v_Recall: 0.533799  v_F1: 0.522097  v_AUC: 0.811038
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.364704    reg_loss: 0.064722    l2_loss: 0.012841    loss: 0.442266
steps 1800    v_Prec: 0.584229  v_Recall: 0.521977  v_F1: 0.551351  v_AUC: 0.830798
steps 1800    running time 96 seconds

steps 2000    base_loss: 0.348348    reg_loss: 0.065464    l2_loss: 0.013071    loss: 0.426882
steps 2000    v_Prec: 0.586421  v_Recall: 0.555062  v_F1: 0.570311  v_AUC: 0.842997
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.324665    reg_loss: 0.065767    l2_loss: 0.013300    loss: 0.403732
steps 2200    v_Prec: 0.620801  v_Recall: 0.563075  v_F1: 0.590531  v_AUC: 0.854451
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.316928    reg_loss: 0.066410    l2_loss: 0.013570    loss: 0.396907
steps 2400    v_Prec: 0.638097  v_Recall: 0.578864  v_F1: 0.607039  v_AUC: 0.861807
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.312181    reg_loss: 0.066560    l2_loss: 0.013891    loss: 0.392632
steps 2600    v_Prec: 0.634271  v_Recall: 0.599096  v_F1: 0.616182  v_AUC: 0.867942
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.302193    reg_loss: 0.066965    l2_loss: 0.014240    loss: 0.383397
steps 2800    v_Prec: 0.668672  v_Recall: 0.582037  v_F1: 0.622354  v_AUC: 0.872229
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.304067    reg_loss: 0.067051    l2_loss: 0.014609    loss: 0.385727
steps 3000    v_Prec: 0.650794  v_Recall: 0.608299  v_F1: 0.628829  v_AUC: 0.876536
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.297365    reg_loss: 0.067371    l2_loss: 0.014974    loss: 0.379710
steps 3200    v_Prec: 0.665408  v_Recall: 0.615202  v_F1: 0.639321  v_AUC: 0.881380
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.298528    reg_loss: 0.067570    l2_loss: 0.015336    loss: 0.381434
steps 3400    v_Prec: 0.691823  v_Recall: 0.609489  v_F1: 0.648051  v_AUC: 0.884773
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.277448    reg_loss: 0.067466    l2_loss: 0.015661    loss: 0.360576
steps 3600    v_Prec: 0.687373  v_Recall: 0.618058  v_F1: 0.650875  v_AUC: 0.886780
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.287127    reg_loss: 0.067701    l2_loss: 0.016102    loss: 0.370930
steps 3800    v_Prec: 0.683829  v_Recall: 0.629086  v_F1: 0.655316  v_AUC: 0.889656
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.281623    reg_loss: 0.067781    l2_loss: 0.016548    loss: 0.365953
steps 4000    v_Prec: 0.691735  v_Recall: 0.626150  v_F1: 0.657311  v_AUC: 0.892474
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.274752    reg_loss: 0.067605    l2_loss: 0.017126    loss: 0.359483
steps 4200    v_Prec: 0.681336  v_Recall: 0.647334  v_F1: 0.663900  v_AUC: 0.894313
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.271862    reg_loss: 0.067530    l2_loss: 0.017679    loss: 0.357071
steps 4400    v_Prec: 0.681485  v_Recall: 0.648286  v_F1: 0.664471  v_AUC: 0.895789
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.265626    reg_loss: 0.067417    l2_loss: 0.018112    loss: 0.351154
steps 4600    v_Prec: 0.683253  v_Recall: 0.652571  v_F1: 0.667559  v_AUC: 0.897603
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.279275    reg_loss: 0.067693    l2_loss: 0.018702    loss: 0.365670
steps 4800    v_Prec: 0.686587  v_Recall: 0.645351  v_F1: 0.665331  v_AUC: 0.899408
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.263816    reg_loss: 0.067694    l2_loss: 0.019346    loss: 0.350856
steps 5000    v_Prec: 0.700444  v_Recall: 0.637813  v_F1: 0.667663  v_AUC: 0.899293
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.273575    reg_loss: 0.067660    l2_loss: 0.020027    loss: 0.361262
steps 5200    v_Prec: 0.675902  v_Recall: 0.660029  v_F1: 0.667871  v_AUC: 0.901265
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.269402    reg_loss: 0.067355    l2_loss: 0.020728    loss: 0.357485
steps 5400    v_Prec: 0.692596  v_Recall: 0.660505  v_F1: 0.676170  v_AUC: 0.902246
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.170397    reg_loss: 0.068305    l2_loss: 0.021502    loss: 0.260204
steps 5600    v_Prec: 0.688512  v_Recall: 0.647652  v_F1: 0.667457  v_AUC: 0.896664
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.177203    reg_loss: 0.068195    l2_loss: 0.022224    loss: 0.267622
steps 5800    v_Prec: 0.680466  v_Recall: 0.648128  v_F1: 0.663903  v_AUC: 0.894475
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.184742    reg_loss: 0.068229    l2_loss: 0.022980    loss: 0.275951
steps 6000    v_Prec: 0.657360  v_Recall: 0.665027  v_F1: 0.661171  v_AUC: 0.894219
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.179354    reg_loss: 0.068151    l2_loss: 0.023674    loss: 0.271179
steps 6200    v_Prec: 0.668378  v_Recall: 0.650825  v_F1: 0.659485  v_AUC: 0.892643
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.192588    reg_loss: 0.068079    l2_loss: 0.024313    loss: 0.284980
steps 6400    v_Prec: 0.680669  v_Recall: 0.642812  v_F1: 0.661199  v_AUC: 0.894286
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.191609    reg_loss: 0.068007    l2_loss: 0.024894    loss: 0.284510
steps 6600    v_Prec: 0.699965  v_Recall: 0.629879  v_F1: 0.663075  v_AUC: 0.894569
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.198860    reg_loss: 0.068110    l2_loss: 0.025473    loss: 0.292443
steps 6800    v_Prec: 0.665610  v_Recall: 0.666455  v_F1: 0.666032  v_AUC: 0.895858
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.176828    reg_loss: 0.068050    l2_loss: 0.025947    loss: 0.270825
steps 7000    v_Prec: 0.672442  v_Recall: 0.662091  v_F1: 0.667226  v_AUC: 0.895739
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.180179    reg_loss: 0.067985    l2_loss: 0.026430    loss: 0.274593
steps 7200    v_Prec: 0.686797  v_Recall: 0.658680  v_F1: 0.672445  v_AUC: 0.898236
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.197692    reg_loss: 0.067668    l2_loss: 0.026749    loss: 0.292109
steps 7400    v_Prec: 0.697405  v_Recall: 0.654633  v_F1: 0.675343  v_AUC: 0.901825
steps 7400    running time 278 seconds

Early stop model F1: 0.676170
testing thre: 0.35258472
testing Prec: 0.5179880079946703
testing Recall: 0.6801944106925881
testing F1: 0.5881116970983129
testing AUC: 0.8670161899852789
overall running time 281 seconds
(0.6300483803113168, 0.5823086269744836, 0.6052385643201739, 0.8670161899852789, 0.50700635)

2019-02-24 01:33:48.722441: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:33:49.038149: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:33:49.039686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:33:49.039730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.790000 seconds
loading data in 31.000000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.03
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.768458    reg_loss: 0.064759    l2_loss: 0.013297    loss: 0.846514
steps 200    v_Prec: 0.167030  v_Recall: 0.938019  v_F1: 0.283567  v_AUC: 0.526937
steps 200    running time 41 seconds

steps 400    base_loss: 0.601091    reg_loss: 0.064474    l2_loss: 0.013333    loss: 0.678898
steps 400    v_Prec: 0.171869  v_Recall: 0.861886  v_F1: 0.286589  v_AUC: 0.550548
steps 400    running time 48 seconds

steps 600    base_loss: 0.501862    reg_loss: 0.063744    l2_loss: 0.013096    loss: 0.578702
steps 600    v_Prec: 0.192033  v_Recall: 0.693256  v_F1: 0.300756  v_AUC: 0.587468
steps 600    running time 55 seconds

steps 800    base_loss: 0.481055    reg_loss: 0.063148    l2_loss: 0.012873    loss: 0.557076
steps 800    v_Prec: 0.204982  v_Recall: 0.694126  v_F1: 0.316499  v_AUC: 0.623829
steps 800    running time 62 seconds

steps 1000    base_loss: 0.447739    reg_loss: 0.062474    l2_loss: 0.012694    loss: 0.522907
steps 1000    v_Prec: 0.259372  v_Recall: 0.516879  v_F1: 0.345414  v_AUC: 0.659772
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.430154    reg_loss: 0.061932    l2_loss: 0.012604    loss: 0.504690
steps 1200    v_Prec: 0.331667  v_Recall: 0.466914  v_F1: 0.387838  v_AUC: 0.712170
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.415097    reg_loss: 0.061297    l2_loss: 0.012601    loss: 0.488995
steps 1400    v_Prec: 0.406197  v_Recall: 0.457032  v_F1: 0.430118  v_AUC: 0.750600
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.387519    reg_loss: 0.060728    l2_loss: 0.012725    loss: 0.460973
steps 1600    v_Prec: 0.435396  v_Recall: 0.494980  v_F1: 0.463280  v_AUC: 0.781206
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.375807    reg_loss: 0.060280    l2_loss: 0.012969    loss: 0.449055
steps 1800    v_Prec: 0.496239  v_Recall: 0.516325  v_F1: 0.506083  v_AUC: 0.810428
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.363635    reg_loss: 0.059927    l2_loss: 0.013214    loss: 0.436776
steps 2000    v_Prec: 0.529581  v_Recall: 0.554115  v_F1: 0.541570  v_AUC: 0.831891
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.332968    reg_loss: 0.059190    l2_loss: 0.013574    loss: 0.405732
steps 2200    v_Prec: 0.554132  v_Recall: 0.560835  v_F1: 0.557463  v_AUC: 0.841758
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.333285    reg_loss: 0.058815    l2_loss: 0.013998    loss: 0.406098
steps 2400    v_Prec: 0.563874  v_Recall: 0.594276  v_F1: 0.578676  v_AUC: 0.855355
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.322022    reg_loss: 0.058438    l2_loss: 0.014354    loss: 0.394814
steps 2600    v_Prec: 0.614522  v_Recall: 0.576093  v_F1: 0.594687  v_AUC: 0.861734
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.313096    reg_loss: 0.057754    l2_loss: 0.014828    loss: 0.385678
steps 2800    v_Prec: 0.608298  v_Recall: 0.605028  v_F1: 0.606659  v_AUC: 0.867704
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.310610    reg_loss: 0.057476    l2_loss: 0.015337    loss: 0.383423
steps 3000    v_Prec: 0.600396  v_Recall: 0.623844  v_F1: 0.611895  v_AUC: 0.871919
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.305911    reg_loss: 0.056886    l2_loss: 0.015812    loss: 0.378609
steps 3200    v_Prec: 0.620844  v_Recall: 0.612697  v_F1: 0.616744  v_AUC: 0.875288
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.297790    reg_loss: 0.056389    l2_loss: 0.016385    loss: 0.370563
steps 3400    v_Prec: 0.623245  v_Recall: 0.617677  v_F1: 0.620449  v_AUC: 0.876473
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.298401    reg_loss: 0.055855    l2_loss: 0.016905    loss: 0.371162
steps 3600    v_Prec: 0.605944  v_Recall: 0.647956  v_F1: 0.626246  v_AUC: 0.880182
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.304281    reg_loss: 0.055396    l2_loss: 0.017439    loss: 0.377117
steps 3800    v_Prec: 0.604309  v_Recall: 0.658629  v_F1: 0.630301  v_AUC: 0.884394
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.291139    reg_loss: 0.054564    l2_loss: 0.018011    loss: 0.363715
steps 4000    v_Prec: 0.645903  v_Recall: 0.626295  v_F1: 0.635948  v_AUC: 0.884408
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.296895    reg_loss: 0.054237    l2_loss: 0.018728    loss: 0.369860
steps 4200    v_Prec: 0.647736  v_Recall: 0.631196  v_F1: 0.639359  v_AUC: 0.886575
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.297480    reg_loss: 0.053744    l2_loss: 0.019354    loss: 0.370578
steps 4400    v_Prec: 0.641914  v_Recall: 0.649221  v_F1: 0.645547  v_AUC: 0.888579
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.290450    reg_loss: 0.052910    l2_loss: 0.020084    loss: 0.363444
steps 4600    v_Prec: 0.658048  v_Recall: 0.633805  v_F1: 0.645699  v_AUC: 0.890642
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.286755    reg_loss: 0.052334    l2_loss: 0.020691    loss: 0.359779
steps 4800    v_Prec: 0.665609  v_Recall: 0.630247  v_F1: 0.647446  v_AUC: 0.891077
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.287492    reg_loss: 0.051844    l2_loss: 0.021465    loss: 0.360801
steps 5000    v_Prec: 0.660109  v_Recall: 0.641948  v_F1: 0.650902  v_AUC: 0.891755
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.287305    reg_loss: 0.051245    l2_loss: 0.022136    loss: 0.360686
steps 5200    v_Prec: 0.643474  v_Recall: 0.666061  v_F1: 0.654572  v_AUC: 0.894332
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.285577    reg_loss: 0.050836    l2_loss: 0.022973    loss: 0.359386
steps 5400    v_Prec: 0.639392  v_Recall: 0.661633  v_F1: 0.650322  v_AUC: 0.892399
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.174318    reg_loss: 0.052163    l2_loss: 0.023642    loss: 0.250123
steps 5600    v_Prec: 0.640128  v_Recall: 0.648984  v_F1: 0.644526  v_AUC: 0.890317
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.176754    reg_loss: 0.052726    l2_loss: 0.024183    loss: 0.253663
steps 5800    v_Prec: 0.657521  v_Recall: 0.628983  v_F1: 0.642935  v_AUC: 0.889055
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.171985    reg_loss: 0.053339    l2_loss: 0.024668    loss: 0.249993
steps 6000    v_Prec: 0.653715  v_Recall: 0.621156  v_F1: 0.637020  v_AUC: 0.887459
steps 6000    running time 234 seconds

steps 6200    base_loss: 0.178105    reg_loss: 0.053305    l2_loss: 0.025184    loss: 0.256594
steps 6200    v_Prec: 0.621554  v_Recall: 0.645189  v_F1: 0.633151  v_AUC: 0.882641
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.184548    reg_loss: 0.053516    l2_loss: 0.025719    loss: 0.263784
steps 6400    v_Prec: 0.638678  v_Recall: 0.632619  v_F1: 0.635634  v_AUC: 0.884169
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.177484    reg_loss: 0.053441    l2_loss: 0.026366    loss: 0.257291
steps 6600    v_Prec: 0.624848  v_Recall: 0.648905  v_F1: 0.636649  v_AUC: 0.883518
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.177752    reg_loss: 0.053280    l2_loss: 0.026800    loss: 0.257832
steps 6800    v_Prec: 0.640762  v_Recall: 0.645980  v_F1: 0.643360  v_AUC: 0.885835
steps 6800    running time 259 seconds

steps 7000    base_loss: 0.190287    reg_loss: 0.052922    l2_loss: 0.027344    loss: 0.270554
steps 7000    v_Prec: 0.650573  v_Recall: 0.637046  v_F1: 0.643739  v_AUC: 0.885799
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.185790    reg_loss: 0.052623    l2_loss: 0.027658    loss: 0.266071
steps 7200    v_Prec: 0.626016  v_Recall: 0.663926  v_F1: 0.644414  v_AUC: 0.886183
steps 7200    running time 272 seconds

Early stop model F1: 0.654572
testing thre: 0.40328544
testing Prec: 0.46796486270655446
testing Recall: 0.7405103280680437
testing F1: 0.5735042252460806
testing AUC: 0.8720387358565092
overall running time 274 seconds
(0.6267237516801911, 0.6118590522478736, 0.6192022035315528, 0.8720387358565092, 0.6251118)

2019-02-24 01:37:01.256696: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:37:02.176188: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:37:02.177784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:37:02.177823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.710000 seconds
loading data in 29.700000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.542051    reg_loss: 0.216524    l2_loss: 0.013301    loss: 0.771876
steps 200    v_Prec: 0.162111  v_Recall: 1.000000  v_F1: 0.278994  v_AUC: 0.489789
steps 200    running time 40 seconds

steps 400    base_loss: 0.530134    reg_loss: 0.216080    l2_loss: 0.013277    loss: 0.759490
steps 400    v_Prec: 0.162145  v_Recall: 0.999678  v_F1: 0.279032  v_AUC: 0.525313
steps 400    running time 47 seconds

steps 600    base_loss: 0.485647    reg_loss: 0.214144    l2_loss: 0.013155    loss: 0.712947
steps 600    v_Prec: 0.204992  v_Recall: 0.575821  v_F1: 0.302348  v_AUC: 0.601243
steps 600    running time 54 seconds

steps 800    base_loss: 0.449804    reg_loss: 0.212981    l2_loss: 0.013052    loss: 0.675836
steps 800    v_Prec: 0.282484  v_Recall: 0.447440  v_F1: 0.346323  v_AUC: 0.664996
steps 800    running time 60 seconds

steps 1000    base_loss: 0.423879    reg_loss: 0.210596    l2_loss: 0.012991    loss: 0.647466
steps 1000    v_Prec: 0.358682  v_Recall: 0.427479  v_F1: 0.390070  v_AUC: 0.712389
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.409099    reg_loss: 0.209275    l2_loss: 0.012974    loss: 0.631347
steps 1200    v_Prec: 0.407882  v_Recall: 0.476497  v_F1: 0.439528  v_AUC: 0.752544
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.392409    reg_loss: 0.208456    l2_loss: 0.013007    loss: 0.613871
steps 1400    v_Prec: 0.459062  v_Recall: 0.504990  v_F1: 0.480932  v_AUC: 0.782713
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.376681    reg_loss: 0.208226    l2_loss: 0.013095    loss: 0.598002
steps 1600    v_Prec: 0.494980  v_Recall: 0.543625  v_F1: 0.518163  v_AUC: 0.808032
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.357727    reg_loss: 0.207905    l2_loss: 0.013193    loss: 0.578825
steps 1800    v_Prec: 0.524881  v_Recall: 0.561172  v_F1: 0.542420  v_AUC: 0.823431
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.341317    reg_loss: 0.207509    l2_loss: 0.013393    loss: 0.562219
steps 2000    v_Prec: 0.590440  v_Recall: 0.542820  v_F1: 0.565629  v_AUC: 0.836772
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.331230    reg_loss: 0.208263    l2_loss: 0.013542    loss: 0.553035
steps 2200    v_Prec: 0.585645  v_Recall: 0.569382  v_F1: 0.577399  v_AUC: 0.845527
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.332375    reg_loss: 0.208105    l2_loss: 0.013737    loss: 0.554217
steps 2400    v_Prec: 0.611254  v_Recall: 0.572682  v_F1: 0.591340  v_AUC: 0.851733
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.325368    reg_loss: 0.208623    l2_loss: 0.013893    loss: 0.547884
steps 2600    v_Prec: 0.615417  v_Recall: 0.588619  v_F1: 0.601720  v_AUC: 0.859568
steps 2600    running time 120 seconds

steps 2800    base_loss: 0.309576    reg_loss: 0.208231    l2_loss: 0.014133    loss: 0.531939
steps 2800    v_Prec: 0.603919  v_Recall: 0.612766  v_F1: 0.608310  v_AUC: 0.862819
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.312747    reg_loss: 0.208305    l2_loss: 0.014328    loss: 0.535380
steps 3000    v_Prec: 0.633499  v_Recall: 0.605200  v_F1: 0.619026  v_AUC: 0.869760
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.304241    reg_loss: 0.207692    l2_loss: 0.014539    loss: 0.526472
steps 3200    v_Prec: 0.631105  v_Recall: 0.614697  v_F1: 0.622793  v_AUC: 0.875078
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.299749    reg_loss: 0.206741    l2_loss: 0.014842    loss: 0.521332
steps 3400    v_Prec: 0.631786  v_Recall: 0.619124  v_F1: 0.625391  v_AUC: 0.878160
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.292533    reg_loss: 0.207127    l2_loss: 0.015209    loss: 0.514870
steps 3600    v_Prec: 0.631969  v_Recall: 0.631359  v_F1: 0.631664  v_AUC: 0.881188
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.290410    reg_loss: 0.206127    l2_loss: 0.015612    loss: 0.512149
steps 3800    v_Prec: 0.640906  v_Recall: 0.628783  v_F1: 0.634786  v_AUC: 0.884160
steps 3800    running time 160 seconds

steps 4000    base_loss: 0.292904    reg_loss: 0.205497    l2_loss: 0.016116    loss: 0.514517
steps 4000    v_Prec: 0.644397  v_Recall: 0.635061  v_F1: 0.639695  v_AUC: 0.886200
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.286383    reg_loss: 0.205628    l2_loss: 0.016564    loss: 0.508575
steps 4200    v_Prec: 0.610302  v_Recall: 0.678042  v_F1: 0.642391  v_AUC: 0.889315
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.285182    reg_loss: 0.204047    l2_loss: 0.017195    loss: 0.506424
steps 4400    v_Prec: 0.653429  v_Recall: 0.635705  v_F1: 0.644445  v_AUC: 0.888475
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.285812    reg_loss: 0.204074    l2_loss: 0.017730    loss: 0.507617
steps 4600    v_Prec: 0.658172  v_Recall: 0.634015  v_F1: 0.645867  v_AUC: 0.890154
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.283865    reg_loss: 0.201124    l2_loss: 0.018270    loss: 0.503259
steps 4800    v_Prec: 0.678205  v_Recall: 0.622907  v_F1: 0.649381  v_AUC: 0.891301
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.280376    reg_loss: 0.200833    l2_loss: 0.018832    loss: 0.500041
steps 5000    v_Prec: 0.650153  v_Recall: 0.651722  v_F1: 0.650937  v_AUC: 0.894535
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.276329    reg_loss: 0.199113    l2_loss: 0.019488    loss: 0.494930
steps 5200    v_Prec: 0.644634  v_Recall: 0.657035  v_F1: 0.650775  v_AUC: 0.895347
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.268983    reg_loss: 0.197725    l2_loss: 0.020133    loss: 0.486841
steps 5400    v_Prec: 0.664064  v_Recall: 0.643432  v_F1: 0.653585  v_AUC: 0.894828
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.193650    reg_loss: 0.195410    l2_loss: 0.020953    loss: 0.410013
steps 5600    v_Prec: 0.646901  v_Recall: 0.641017  v_F1: 0.643946  v_AUC: 0.889065
steps 5600    running time 221 seconds

steps 5800    base_loss: 0.197200    reg_loss: 0.193822    l2_loss: 0.021830    loss: 0.412851
steps 5800    v_Prec: 0.641061  v_Recall: 0.640132  v_F1: 0.640596  v_AUC: 0.887292
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.199826    reg_loss: 0.192751    l2_loss: 0.022616    loss: 0.415193
steps 6000    v_Prec: 0.632627  v_Recall: 0.649227  v_F1: 0.640820  v_AUC: 0.887061
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.204223    reg_loss: 0.192871    l2_loss: 0.023284    loss: 0.420378
steps 6200    v_Prec: 0.638520  v_Recall: 0.645766  v_F1: 0.642123  v_AUC: 0.887336
steps 6200    running time 240 seconds

steps 6400    base_loss: 0.200852    reg_loss: 0.192809    l2_loss: 0.023949    loss: 0.417611
steps 6400    v_Prec: 0.642267  v_Recall: 0.644076  v_F1: 0.643170  v_AUC: 0.889179
steps 6400    running time 246 seconds

steps 6600    base_loss: 0.206425    reg_loss: 0.190681    l2_loss: 0.024434    loss: 0.421539
steps 6600    v_Prec: 0.644245  v_Recall: 0.653735  v_F1: 0.648955  v_AUC: 0.891409
steps 6600    running time 252 seconds

steps 6800    base_loss: 0.207816    reg_loss: 0.189569    l2_loss: 0.024991    loss: 0.422375
steps 6800    v_Prec: 0.646565  v_Recall: 0.656713  v_F1: 0.651599  v_AUC: 0.892265
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.209884    reg_loss: 0.189910    l2_loss: 0.025476    loss: 0.425271
steps 7000    v_Prec: 0.675242  v_Recall: 0.633773  v_F1: 0.653851  v_AUC: 0.892310
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.200093    reg_loss: 0.188640    l2_loss: 0.026092    loss: 0.414825
steps 7200    v_Prec: 0.650268  v_Recall: 0.663876  v_F1: 0.657002  v_AUC: 0.894357
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.214386    reg_loss: 0.188212    l2_loss: 0.026441    loss: 0.429039
steps 7400    v_Prec: 0.669476  v_Recall: 0.652125  v_F1: 0.660687  v_AUC: 0.896836
steps 7400    running time 277 seconds

steps 7600    base_loss: 0.205901    reg_loss: 0.187899    l2_loss: 0.026891    loss: 0.420691
steps 7600    v_Prec: 0.675182  v_Recall: 0.657357  v_F1: 0.666150  v_AUC: 0.898105
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.211363    reg_loss: 0.187076    l2_loss: 0.027270    loss: 0.425710
steps 7800    v_Prec: 0.667253  v_Recall: 0.671925  v_F1: 0.669581  v_AUC: 0.899631
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.208683    reg_loss: 0.185545    l2_loss: 0.027707    loss: 0.421935
steps 8000    v_Prec: 0.682375  v_Recall: 0.672489  v_F1: 0.677396  v_AUC: 0.903408
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.209333    reg_loss: 0.185392    l2_loss: 0.027953    loss: 0.422677
steps 8200    v_Prec: 0.693147  v_Recall: 0.665084  v_F1: 0.678825  v_AUC: 0.902630
steps 8200    running time 305 seconds

steps 8400    base_loss: 0.209198    reg_loss: 0.184726    l2_loss: 0.028366    loss: 0.422290
steps 8400    v_Prec: 0.694403  v_Recall: 0.667015  v_F1: 0.680434  v_AUC: 0.903787
steps 8400    running time 312 seconds

steps 8600    base_loss: 0.200580    reg_loss: 0.183472    l2_loss: 0.028819    loss: 0.412871
steps 8600    v_Prec: 0.708829  v_Recall: 0.661703  v_F1: 0.684456  v_AUC: 0.905946
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.205871    reg_loss: 0.183315    l2_loss: 0.029087    loss: 0.418273
steps 8800    v_Prec: 0.703117  v_Recall: 0.668142  v_F1: 0.685184  v_AUC: 0.908156
steps 8800    running time 325 seconds

steps 9000    base_loss: 0.201384    reg_loss: 0.181400    l2_loss: 0.029515    loss: 0.412299
steps 9000    v_Prec: 0.690847  v_Recall: 0.682228  v_F1: 0.686510  v_AUC: 0.908667
steps 9000    running time 331 seconds

steps 9200    base_loss: 0.205271    reg_loss: 0.180606    l2_loss: 0.029685    loss: 0.415562
steps 9200    v_Prec: 0.710815  v_Recall: 0.666533  v_F1: 0.687962  v_AUC: 0.909874
steps 9200    running time 338 seconds

steps 9400    base_loss: 0.201080    reg_loss: 0.179681    l2_loss: 0.029948    loss: 0.410708
steps 9400    v_Prec: 0.739059  v_Recall: 0.653815  v_F1: 0.693829  v_AUC: 0.911172
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.197518    reg_loss: 0.178988    l2_loss: 0.030167    loss: 0.406673
steps 9600    v_Prec: 0.710122  v_Recall: 0.680457  v_F1: 0.694973  v_AUC: 0.914087
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.203771    reg_loss: 0.177477    l2_loss: 0.030435    loss: 0.411683
steps 9800    v_Prec: 0.699289  v_Recall: 0.704524  v_F1: 0.701896  v_AUC: 0.916561
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.201159    reg_loss: 0.176813    l2_loss: 0.030735    loss: 0.408707
steps 10000    v_Prec: 0.733135  v_Recall: 0.673535  v_F1: 0.702072  v_AUC: 0.915258
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.199587    reg_loss: 0.177741    l2_loss: 0.030916    loss: 0.408245
steps 10200    v_Prec: 0.742994  v_Recall: 0.676433  v_F1: 0.708153  v_AUC: 0.918180
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.197644    reg_loss: 0.174973    l2_loss: 0.031208    loss: 0.403825
steps 10400    v_Prec: 0.726719  v_Recall: 0.691565  v_F1: 0.708706  v_AUC: 0.919261
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.202857    reg_loss: 0.174832    l2_loss: 0.031351    loss: 0.409041
steps 10600    v_Prec: 0.746174  v_Recall: 0.678847  v_F1: 0.710920  v_AUC: 0.918844
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.190321    reg_loss: 0.172150    l2_loss: 0.031645    loss: 0.394116
steps 10800    v_Prec: 0.733690  v_Recall: 0.695187  v_F1: 0.713920  v_AUC: 0.920775
steps 10800    running time 391 seconds

steps 11000    base_loss: 0.101327    reg_loss: 0.166734    l2_loss: 0.031925    loss: 0.299986
steps 11000    v_Prec: 0.708742  v_Recall: 0.680618  v_F1: 0.694395  v_AUC: 0.910273
steps 11000    running time 398 seconds

steps 11200    base_loss: 0.101697    reg_loss: 0.166310    l2_loss: 0.032316    loss: 0.300323
steps 11200    v_Prec: 0.722728  v_Recall: 0.657518  v_F1: 0.688583  v_AUC: 0.906439
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.096949    reg_loss: 0.164383    l2_loss: 0.032655    loss: 0.293987
steps 11400    v_Prec: 0.723085  v_Recall: 0.644398  v_F1: 0.681478  v_AUC: 0.904108
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.105262    reg_loss: 0.164259    l2_loss: 0.032820    loss: 0.302341
steps 11600    v_Prec: 0.700853  v_Recall: 0.661140  v_F1: 0.680417  v_AUC: 0.901006
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.105197    reg_loss: 0.163410    l2_loss: 0.033002    loss: 0.301609
steps 11800    v_Prec: 0.707485  v_Recall: 0.651964  v_F1: 0.678591  v_AUC: 0.901280
steps 11800    running time 424 seconds

steps 12000    base_loss: 0.112597    reg_loss: 0.163290    l2_loss: 0.033249    loss: 0.309136
steps 12000    v_Prec: 0.677111  v_Recall: 0.683596  v_F1: 0.680338  v_AUC: 0.901253
steps 12000    running time 430 seconds

steps 12200    base_loss: 0.113042    reg_loss: 0.163651    l2_loss: 0.033538    loss: 0.310231
steps 12200    v_Prec: 0.706772  v_Recall: 0.654379  v_F1: 0.679567  v_AUC: 0.902081
steps 12200    running time 436 seconds

steps 12400    base_loss: 0.110423    reg_loss: 0.161666    l2_loss: 0.033727    loss: 0.305816
steps 12400    v_Prec: 0.701118  v_Recall: 0.661220  v_F1: 0.680585  v_AUC: 0.901434
steps 12400    running time 442 seconds

steps 12600    base_loss: 0.119648    reg_loss: 0.162593    l2_loss: 0.033884    loss: 0.316124
steps 12600    v_Prec: 0.721262  v_Recall: 0.638361  v_F1: 0.677284  v_AUC: 0.901609
steps 12600    running time 449 seconds

steps 12800    base_loss: 0.110813    reg_loss: 0.160702    l2_loss: 0.034032    loss: 0.305548
steps 12800    v_Prec: 0.696376  v_Recall: 0.666613  v_F1: 0.681170  v_AUC: 0.900934
steps 12800    running time 455 seconds

Early stop model F1: 0.713920
testing thre: 0.37932286
testing Prec: 0.5890732430318251
testing Recall: 0.6954070473876063
testing F1: 0.6378388017118402
testing AUC: 0.8924936972753259
overall running time 457 seconds
(0.6869584173524442, 0.612636695018226, 0.6476723872161135, 0.8924936972753259, 0.58150005)

2019-02-24 01:42:16.422989: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:42:17.847577: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:42:17.860058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:42:17.860145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.570000 seconds
loading data in 30.870000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.815947    reg_loss: 0.216064    l2_loss: 0.013414    loss: 1.045425
steps 200    v_Prec: 0.161558  v_Recall: 1.000000  v_F1: 0.278175  v_AUC: 0.497617
steps 200    running time 41 seconds

steps 400    base_loss: 0.582458    reg_loss: 0.216058    l2_loss: 0.013552    loss: 0.812068
steps 400    v_Prec: 0.161563  v_Recall: 1.000000  v_F1: 0.278182  v_AUC: 0.504046
steps 400    running time 48 seconds

steps 600    base_loss: 0.515042    reg_loss: 0.215648    l2_loss: 0.013643    loss: 0.744333
steps 600    v_Prec: 0.165071  v_Recall: 0.946778  v_F1: 0.281127  v_AUC: 0.536074
steps 600    running time 55 seconds

steps 800    base_loss: 0.488675    reg_loss: 0.214275    l2_loss: 0.013516    loss: 0.716465
steps 800    v_Prec: 0.184734  v_Recall: 0.671620  v_F1: 0.289766  v_AUC: 0.574828
steps 800    running time 61 seconds

steps 1000    base_loss: 0.467980    reg_loss: 0.212331    l2_loss: 0.013308    loss: 0.693620
steps 1000    v_Prec: 0.195207  v_Recall: 0.623647  v_F1: 0.297343  v_AUC: 0.593790
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.453772    reg_loss: 0.208718    l2_loss: 0.013278    loss: 0.675768
steps 1200    v_Prec: 0.223284  v_Recall: 0.464384  v_F1: 0.301568  v_AUC: 0.607405
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.439671    reg_loss: 0.204998    l2_loss: 0.013210    loss: 0.657879
steps 1400    v_Prec: 0.259442  v_Recall: 0.480455  v_F1: 0.336939  v_AUC: 0.650760
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.430212    reg_loss: 0.200863    l2_loss: 0.013171    loss: 0.644246
steps 1600    v_Prec: 0.348590  v_Recall: 0.442255  v_F1: 0.389876  v_AUC: 0.697238
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.407932    reg_loss: 0.195081    l2_loss: 0.013268    loss: 0.616280
steps 1800    v_Prec: 0.451676  v_Recall: 0.429898  v_F1: 0.440518  v_AUC: 0.733747
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.394662    reg_loss: 0.190198    l2_loss: 0.013370    loss: 0.598230
steps 2000    v_Prec: 0.479309  v_Recall: 0.481748  v_F1: 0.480525  v_AUC: 0.765515
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.378970    reg_loss: 0.185551    l2_loss: 0.013585    loss: 0.578105
steps 2200    v_Prec: 0.543768  v_Recall: 0.490147  v_F1: 0.515567  v_AUC: 0.789927
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.369136    reg_loss: 0.181918    l2_loss: 0.013845    loss: 0.564899
steps 2400    v_Prec: 0.584446  v_Recall: 0.515910  v_F1: 0.548044  v_AUC: 0.809840
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.351397    reg_loss: 0.177871    l2_loss: 0.014091    loss: 0.543358
steps 2600    v_Prec: 0.604984  v_Recall: 0.548942  v_F1: 0.575602  v_AUC: 0.826121
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.336979    reg_loss: 0.174913    l2_loss: 0.014381    loss: 0.526272
steps 2800    v_Prec: 0.627245  v_Recall: 0.564125  v_F1: 0.594013  v_AUC: 0.838385
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.330822    reg_loss: 0.172736    l2_loss: 0.014652    loss: 0.518210
steps 3000    v_Prec: 0.628532  v_Recall: 0.591019  v_F1: 0.609199  v_AUC: 0.848553
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.322363    reg_loss: 0.169810    l2_loss: 0.014942    loss: 0.507115
steps 3200    v_Prec: 0.635993  v_Recall: 0.603941  v_F1: 0.619553  v_AUC: 0.855774
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.311146    reg_loss: 0.167007    l2_loss: 0.015214    loss: 0.493367
steps 3400    v_Prec: 0.667061  v_Recall: 0.591585  v_F1: 0.627060  v_AUC: 0.862113
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.313092    reg_loss: 0.165035    l2_loss: 0.015623    loss: 0.493750
steps 3600    v_Prec: 0.667114  v_Recall: 0.602407  v_F1: 0.633111  v_AUC: 0.868056
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.300095    reg_loss: 0.161695    l2_loss: 0.015954    loss: 0.477743
steps 3800    v_Prec: 0.676698  v_Recall: 0.608383  v_F1: 0.640725  v_AUC: 0.873080
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.291903    reg_loss: 0.159749    l2_loss: 0.016291    loss: 0.467944
steps 4000    v_Prec: 0.667869  v_Recall: 0.628008  v_F1: 0.647326  v_AUC: 0.875880
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.286848    reg_loss: 0.157559    l2_loss: 0.016791    loss: 0.461198
steps 4200    v_Prec: 0.704174  v_Recall: 0.604991  v_F1: 0.650825  v_AUC: 0.878396
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.289176    reg_loss: 0.155752    l2_loss: 0.017238    loss: 0.462167
steps 4400    v_Prec: 0.699442  v_Recall: 0.627362  v_F1: 0.661444  v_AUC: 0.882518
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.279056    reg_loss: 0.151963    l2_loss: 0.017723    loss: 0.448743
steps 4600    v_Prec: 0.686532  v_Recall: 0.633581  v_F1: 0.658994  v_AUC: 0.882954
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.280898    reg_loss: 0.150021    l2_loss: 0.018201    loss: 0.449120
steps 4800    v_Prec: 0.710607  v_Recall: 0.619528  v_F1: 0.661949  v_AUC: 0.883767
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.281926    reg_loss: 0.148430    l2_loss: 0.018664    loss: 0.449020
steps 5000    v_Prec: 0.703597  v_Recall: 0.630351  v_F1: 0.664963  v_AUC: 0.886328
steps 5000    running time 202 seconds

steps 5200    base_loss: 0.279101    reg_loss: 0.146851    l2_loss: 0.019228    loss: 0.445180
steps 5200    v_Prec: 0.703419  v_Recall: 0.636327  v_F1: 0.668193  v_AUC: 0.887110
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.270777    reg_loss: 0.142777    l2_loss: 0.019709    loss: 0.433263
steps 5400    v_Prec: 0.708841  v_Recall: 0.633904  v_F1: 0.669282  v_AUC: 0.889672
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.197443    reg_loss: 0.129654    l2_loss: 0.020292    loss: 0.347389
steps 5600    v_Prec: 0.698100  v_Recall: 0.637942  v_F1: 0.666667  v_AUC: 0.886253
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.199655    reg_loss: 0.128561    l2_loss: 0.020941    loss: 0.349156
steps 5800    v_Prec: 0.711287  v_Recall: 0.632127  v_F1: 0.669375  v_AUC: 0.884537
steps 5800    running time 228 seconds

steps 6000    base_loss: 0.200781    reg_loss: 0.128253    l2_loss: 0.021493    loss: 0.350527
steps 6000    v_Prec: 0.706487  v_Recall: 0.649087  v_F1: 0.676572  v_AUC: 0.888271
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.201845    reg_loss: 0.127169    l2_loss: 0.022016    loss: 0.351031
steps 6200    v_Prec: 0.708877  v_Recall: 0.641092  v_F1: 0.673282  v_AUC: 0.887907
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.210158    reg_loss: 0.127003    l2_loss: 0.022582    loss: 0.359743
steps 6400    v_Prec: 0.734100  v_Recall: 0.629220  v_F1: 0.677626  v_AUC: 0.888200
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.210020    reg_loss: 0.126570    l2_loss: 0.023001    loss: 0.359591
steps 6600    v_Prec: 0.737633  v_Recall: 0.638265  v_F1: 0.684361  v_AUC: 0.891978
steps 6600    running time 255 seconds

steps 6800    base_loss: 0.211185    reg_loss: 0.125136    l2_loss: 0.023565    loss: 0.359886
steps 6800    v_Prec: 0.707589  v_Recall: 0.661929  v_F1: 0.683997  v_AUC: 0.892515
steps 6800    running time 262 seconds

steps 7000    base_loss: 0.207928    reg_loss: 0.124551    l2_loss: 0.023728    loss: 0.356207
steps 7000    v_Prec: 0.728669  v_Recall: 0.655225  v_F1: 0.689998  v_AUC: 0.895493
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.215114    reg_loss: 0.124549    l2_loss: 0.024073    loss: 0.363735
steps 7200    v_Prec: 0.738148  v_Recall: 0.646341  v_F1: 0.689201  v_AUC: 0.896488
steps 7200    running time 275 seconds

steps 7400    base_loss: 0.215986    reg_loss: 0.124242    l2_loss: 0.024410    loss: 0.364637
steps 7400    v_Prec: 0.719637  v_Recall: 0.673316  v_F1: 0.695707  v_AUC: 0.898779
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.210996    reg_loss: 0.122525    l2_loss: 0.024679    loss: 0.358200
steps 7600    v_Prec: 0.752650  v_Recall: 0.642384  v_F1: 0.693159  v_AUC: 0.900713
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.211746    reg_loss: 0.121761    l2_loss: 0.024990    loss: 0.358497
steps 7800    v_Prec: 0.724804  v_Recall: 0.663867  v_F1: 0.692998  v_AUC: 0.900665
steps 7800    running time 294 seconds

steps 8000    base_loss: 0.208395    reg_loss: 0.119923    l2_loss: 0.025347    loss: 0.353664
steps 8000    v_Prec: 0.736034  v_Recall: 0.661848  v_F1: 0.696972  v_AUC: 0.901670
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.217902    reg_loss: 0.120720    l2_loss: 0.025550    loss: 0.364172
steps 8200    v_Prec: 0.724385  v_Recall: 0.670328  v_F1: 0.696309  v_AUC: 0.901649
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.214856    reg_loss: 0.119495    l2_loss: 0.025932    loss: 0.360283
steps 8400    v_Prec: 0.734015  v_Recall: 0.666613  v_F1: 0.698692  v_AUC: 0.902737
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.212425    reg_loss: 0.118218    l2_loss: 0.026065    loss: 0.356708
steps 8600    v_Prec: 0.748062  v_Recall: 0.662575  v_F1: 0.702728  v_AUC: 0.903910
steps 8600    running time 320 seconds

steps 8800    base_loss: 0.213993    reg_loss: 0.117785    l2_loss: 0.026294    loss: 0.358071
steps 8800    v_Prec: 0.752935  v_Recall: 0.657890  v_F1: 0.702211  v_AUC: 0.906344
steps 8800    running time 327 seconds

steps 9000    base_loss: 0.214528    reg_loss: 0.116941    l2_loss: 0.026458    loss: 0.357927
steps 9000    v_Prec: 0.733943  v_Recall: 0.681069  v_F1: 0.706518  v_AUC: 0.905560
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.206157    reg_loss: 0.116062    l2_loss: 0.026511    loss: 0.348730
steps 9200    v_Prec: 0.739058  v_Recall: 0.683250  v_F1: 0.710059  v_AUC: 0.908460
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.209574    reg_loss: 0.115231    l2_loss: 0.026858    loss: 0.351663
steps 9400    v_Prec: 0.732798  v_Recall: 0.692376  v_F1: 0.712014  v_AUC: 0.910704
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.217480    reg_loss: 0.115023    l2_loss: 0.027037    loss: 0.359541
steps 9600    v_Prec: 0.736977  v_Recall: 0.694718  v_F1: 0.715224  v_AUC: 0.910704
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.207830    reg_loss: 0.113792    l2_loss: 0.027102    loss: 0.348723
steps 9800    v_Prec: 0.747368  v_Recall: 0.688096  v_F1: 0.716508  v_AUC: 0.911289
steps 9800    running time 359 seconds

steps 10000    base_loss: 0.214720    reg_loss: 0.114044    l2_loss: 0.027260    loss: 0.356023
steps 10000    v_Prec: 0.754391  v_Recall: 0.690357  v_F1: 0.720955  v_AUC: 0.913372
steps 10000    running time 366 seconds

steps 10200    base_loss: 0.213174    reg_loss: 0.112693    l2_loss: 0.027443    loss: 0.353310
steps 10200    v_Prec: 0.747580  v_Recall: 0.698433  v_F1: 0.722171  v_AUC: 0.914825
steps 10200    running time 373 seconds

steps 10400    base_loss: 0.217329    reg_loss: 0.112087    l2_loss: 0.027473    loss: 0.356888
steps 10400    v_Prec: 0.741878  v_Recall: 0.700775  v_F1: 0.720741  v_AUC: 0.914808
steps 10400    running time 380 seconds

steps 10600    base_loss: 0.213880    reg_loss: 0.110613    l2_loss: 0.027618    loss: 0.352111
steps 10600    v_Prec: 0.762730  v_Recall: 0.682281  v_F1: 0.720266  v_AUC: 0.915215
steps 10600    running time 386 seconds

steps 10800    base_loss: 0.197411    reg_loss: 0.108072    l2_loss: 0.027775    loss: 0.333258
steps 10800    v_Prec: 0.731410  v_Recall: 0.712567  v_F1: 0.721865  v_AUC: 0.915220
steps 10800    running time 392 seconds

steps 11000    base_loss: 0.103766    reg_loss: 0.096662    l2_loss: 0.027865    loss: 0.228293
steps 11000    v_Prec: 0.753135  v_Recall: 0.688661  v_F1: 0.719457  v_AUC: 0.912707
steps 11000    running time 398 seconds

steps 11200    base_loss: 0.114289    reg_loss: 0.098526    l2_loss: 0.028122    loss: 0.240937
steps 11200    v_Prec: 0.762100  v_Recall: 0.690518  v_F1: 0.724546  v_AUC: 0.912557
steps 11200    running time 405 seconds

steps 11400    base_loss: 0.108658    reg_loss: 0.097765    l2_loss: 0.028121    loss: 0.234543
steps 11400    v_Prec: 0.759497  v_Recall: 0.683008  v_F1: 0.719224  v_AUC: 0.910071
steps 11400    running time 411 seconds

steps 11600    base_loss: 0.102784    reg_loss: 0.097390    l2_loss: 0.028312    loss: 0.228485
steps 11600    v_Prec: 0.764615  v_Recall: 0.679212  v_F1: 0.719388  v_AUC: 0.909772
steps 11600    running time 417 seconds

steps 11800    base_loss: 0.107630    reg_loss: 0.099496    l2_loss: 0.028503    loss: 0.235629
steps 11800    v_Prec: 0.762904  v_Recall: 0.683977  v_F1: 0.721288  v_AUC: 0.910155
steps 11800    running time 423 seconds

steps 12000    base_loss: 0.103329    reg_loss: 0.098516    l2_loss: 0.028475    loss: 0.230320
steps 12000    v_Prec: 0.758518  v_Recall: 0.679616  v_F1: 0.716902  v_AUC: 0.910268
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.116881    reg_loss: 0.099797    l2_loss: 0.028669    loss: 0.245347
steps 12200    v_Prec: 0.741672  v_Recall: 0.690518  v_F1: 0.715182  v_AUC: 0.908736
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.117312    reg_loss: 0.099605    l2_loss: 0.028697    loss: 0.245613
steps 12400    v_Prec: 0.758630  v_Recall: 0.681554  v_F1: 0.718029  v_AUC: 0.910378
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.105202    reg_loss: 0.098694    l2_loss: 0.028813    loss: 0.232709
steps 12600    v_Prec: 0.750000  v_Recall: 0.686642  v_F1: 0.716924  v_AUC: 0.910454
steps 12600    running time 448 seconds

steps 12800    base_loss: 0.117355    reg_loss: 0.099284    l2_loss: 0.028983    loss: 0.245622
steps 12800    v_Prec: 0.773086  v_Recall: 0.680181  v_F1: 0.723664  v_AUC: 0.913200
steps 12800    running time 454 seconds

steps 13000    base_loss: 0.125188    reg_loss: 0.099972    l2_loss: 0.029127    loss: 0.254286
steps 13000    v_Prec: 0.758771  v_Recall: 0.688176  v_F1: 0.721752  v_AUC: 0.910524
steps 13000    running time 460 seconds

steps 13200    base_loss: 0.121069    reg_loss: 0.100268    l2_loss: 0.029161    loss: 0.250498
steps 13200    v_Prec: 0.739826  v_Recall: 0.706186  v_F1: 0.722615  v_AUC: 0.912326
steps 13200    running time 466 seconds

Early stop model F1: 0.724546
testing thre: 0.7069582
testing Prec: 0.5020991021358747
testing Recall: 0.7963547995139733
testing F1: 0.61588482934897
testing AUC: 0.8968163988677234
overall running time 469 seconds
(0.7174640889944919, 0.6457351154313488, 0.6797124804952295, 0.8968163988677234, 0.9506776)

2019-02-24 01:47:47.085377: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:47:47.453770: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:47:47.454669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:47:47.454702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.210000 seconds
loading data in 30.640000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.482220    reg_loss: 0.215206    l2_loss: 0.013307    loss: 0.710733
steps 200    v_Prec: 0.164733  v_Recall: 1.000000  v_F1: 0.282869  v_AUC: 0.484835
steps 200    running time 40 seconds

steps 400    base_loss: 0.480381    reg_loss: 0.214728    l2_loss: 0.013243    loss: 0.708352
steps 400    v_Prec: 0.164795  v_Recall: 0.999604  v_F1: 0.282944  v_AUC: 0.496537
steps 400    running time 47 seconds

steps 600    base_loss: 0.458726    reg_loss: 0.211898    l2_loss: 0.013148    loss: 0.683773
steps 600    v_Prec: 0.167483  v_Recall: 0.958970  v_F1: 0.285162  v_AUC: 0.522629
steps 600    running time 53 seconds

steps 800    base_loss: 0.453039    reg_loss: 0.208543    l2_loss: 0.013020    loss: 0.674602
steps 800    v_Prec: 0.181231  v_Recall: 0.815287  v_F1: 0.296543  v_AUC: 0.568900
steps 800    running time 60 seconds

steps 1000    base_loss: 0.449342    reg_loss: 0.203269    l2_loss: 0.012902    loss: 0.665513
steps 1000    v_Prec: 0.240993  v_Recall: 0.474218  v_F1: 0.319579  v_AUC: 0.630364
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.444215    reg_loss: 0.197040    l2_loss: 0.012822    loss: 0.654077
steps 1200    v_Prec: 0.321278  v_Recall: 0.451723  v_F1: 0.375494  v_AUC: 0.685352
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.419236    reg_loss: 0.190948    l2_loss: 0.012882    loss: 0.623066
steps 1400    v_Prec: 0.395033  v_Recall: 0.461149  v_F1: 0.425538  v_AUC: 0.738322
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.386501    reg_loss: 0.186127    l2_loss: 0.012899    loss: 0.585527
steps 1600    v_Prec: 0.462845  v_Recall: 0.500752  v_F1: 0.481053  v_AUC: 0.782219
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.368831    reg_loss: 0.183925    l2_loss: 0.013154    loss: 0.565910
steps 1800    v_Prec: 0.530063  v_Recall: 0.511842  v_F1: 0.520793  v_AUC: 0.810898
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.349396    reg_loss: 0.181469    l2_loss: 0.013399    loss: 0.544263
steps 2000    v_Prec: 0.581618  v_Recall: 0.514772  v_F1: 0.546157  v_AUC: 0.830103
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.340807    reg_loss: 0.177831    l2_loss: 0.013687    loss: 0.532325
steps 2200    v_Prec: 0.562644  v_Recall: 0.581941  v_F1: 0.572129  v_AUC: 0.847020
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.325117    reg_loss: 0.174958    l2_loss: 0.013999    loss: 0.514074
steps 2400    v_Prec: 0.592321  v_Recall: 0.575525  v_F1: 0.583802  v_AUC: 0.854965
steps 2400    running time 111 seconds

steps 2600    base_loss: 0.313351    reg_loss: 0.171259    l2_loss: 0.014339    loss: 0.498949
steps 2600    v_Prec: 0.628958  v_Recall: 0.574257  v_F1: 0.600364  v_AUC: 0.861814
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.314829    reg_loss: 0.168973    l2_loss: 0.014732    loss: 0.498534
steps 2800    v_Prec: 0.626484  v_Recall: 0.601822  v_F1: 0.613905  v_AUC: 0.869335
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.312329    reg_loss: 0.165896    l2_loss: 0.015089    loss: 0.493314
steps 3000    v_Prec: 0.648775  v_Recall: 0.593584  v_F1: 0.619954  v_AUC: 0.873540
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.298931    reg_loss: 0.162504    l2_loss: 0.015429    loss: 0.476864
steps 3200    v_Prec: 0.632214  v_Recall: 0.618693  v_F1: 0.625380  v_AUC: 0.877761
steps 3200    running time 138 seconds

steps 3400    base_loss: 0.302102    reg_loss: 0.159593    l2_loss: 0.015857    loss: 0.477552
steps 3400    v_Prec: 0.652308  v_Recall: 0.621307  v_F1: 0.636430  v_AUC: 0.879056
steps 3400    running time 144 seconds

steps 3600    base_loss: 0.299497    reg_loss: 0.157318    l2_loss: 0.016324    loss: 0.473139
steps 3600    v_Prec: 0.634246  v_Recall: 0.638416  v_F1: 0.636324  v_AUC: 0.882229
steps 3600    running time 151 seconds

steps 3800    base_loss: 0.290945    reg_loss: 0.153541    l2_loss: 0.016753    loss: 0.461239
steps 3800    v_Prec: 0.663255  v_Recall: 0.621069  v_F1: 0.641469  v_AUC: 0.884653
steps 3800    running time 157 seconds

steps 4000    base_loss: 0.294272    reg_loss: 0.151185    l2_loss: 0.017280    loss: 0.462738
steps 4000    v_Prec: 0.650556  v_Recall: 0.643960  v_F1: 0.647241  v_AUC: 0.886376
steps 4000    running time 164 seconds

steps 4200    base_loss: 0.302794    reg_loss: 0.149152    l2_loss: 0.017757    loss: 0.469702
steps 4200    v_Prec: 0.640811  v_Recall: 0.653703  v_F1: 0.647193  v_AUC: 0.888075
steps 4200    running time 170 seconds

steps 4400    base_loss: 0.297632    reg_loss: 0.146049    l2_loss: 0.018226    loss: 0.461907
steps 4400    v_Prec: 0.637213  v_Recall: 0.664317  v_F1: 0.650483  v_AUC: 0.889516
steps 4400    running time 177 seconds

steps 4600    base_loss: 0.287606    reg_loss: 0.142580    l2_loss: 0.018813    loss: 0.448999
steps 4600    v_Prec: 0.662221  v_Recall: 0.641030  v_F1: 0.651453  v_AUC: 0.890739
steps 4600    running time 184 seconds

steps 4800    base_loss: 0.289230    reg_loss: 0.140886    l2_loss: 0.019417    loss: 0.449533
steps 4800    v_Prec: 0.667957  v_Recall: 0.642297  v_F1: 0.654876  v_AUC: 0.893864
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.287650    reg_loss: 0.138063    l2_loss: 0.019943    loss: 0.445656
steps 5000    v_Prec: 0.666394  v_Recall: 0.644752  v_F1: 0.655395  v_AUC: 0.894962
steps 5000    running time 197 seconds

steps 5200    base_loss: 0.282746    reg_loss: 0.134867    l2_loss: 0.020542    loss: 0.438156
steps 5200    v_Prec: 0.654744  v_Recall: 0.664079  v_F1: 0.659379  v_AUC: 0.895417
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.284346    reg_loss: 0.132299    l2_loss: 0.021210    loss: 0.437855
steps 5400    v_Prec: 0.674337  v_Recall: 0.638337  v_F1: 0.655843  v_AUC: 0.894888
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.201314    reg_loss: 0.127665    l2_loss: 0.021886    loss: 0.350865
steps 5600    v_Prec: 0.661406  v_Recall: 0.657267  v_F1: 0.659330  v_AUC: 0.892316
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.204963    reg_loss: 0.127649    l2_loss: 0.022283    loss: 0.354895
steps 5800    v_Prec: 0.668921  v_Recall: 0.658218  v_F1: 0.663526  v_AUC: 0.893628
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.204958    reg_loss: 0.127877    l2_loss: 0.022851    loss: 0.355686
steps 6000    v_Prec: 0.660398  v_Recall: 0.653703  v_F1: 0.657034  v_AUC: 0.894197
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.198955    reg_loss: 0.127506    l2_loss: 0.023335    loss: 0.349797
steps 6200    v_Prec: 0.656423  v_Recall: 0.668277  v_F1: 0.662297  v_AUC: 0.894535
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.205316    reg_loss: 0.127447    l2_loss: 0.023984    loss: 0.356746
steps 6400    v_Prec: 0.667978  v_Recall: 0.658931  v_F1: 0.663424  v_AUC: 0.898957
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.202523    reg_loss: 0.126189    l2_loss: 0.024419    loss: 0.353131
steps 6600    v_Prec: 0.675254  v_Recall: 0.662257  v_F1: 0.668693  v_AUC: 0.897037
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.204236    reg_loss: 0.124889    l2_loss: 0.024802    loss: 0.353927
steps 6800    v_Prec: 0.662346  v_Recall: 0.671842  v_F1: 0.667060  v_AUC: 0.895575
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.200580    reg_loss: 0.123521    l2_loss: 0.025260    loss: 0.349360
steps 7000    v_Prec: 0.670554  v_Recall: 0.674059  v_F1: 0.672302  v_AUC: 0.898013
steps 7000    running time 261 seconds

steps 7200    base_loss: 0.205504    reg_loss: 0.123281    l2_loss: 0.025673    loss: 0.354457
steps 7200    v_Prec: 0.684564  v_Recall: 0.662495  v_F1: 0.673349  v_AUC: 0.898562
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.205657    reg_loss: 0.121510    l2_loss: 0.025883    loss: 0.353050
steps 7400    v_Prec: 0.695265  v_Recall: 0.656000  v_F1: 0.675062  v_AUC: 0.899608
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.199679    reg_loss: 0.119093    l2_loss: 0.026267    loss: 0.345039
steps 7600    v_Prec: 0.682037  v_Recall: 0.663129  v_F1: 0.672450  v_AUC: 0.898688
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.210829    reg_loss: 0.119420    l2_loss: 0.026745    loss: 0.356994
steps 7800    v_Prec: 0.673710  v_Recall: 0.674297  v_F1: 0.674003  v_AUC: 0.900881
steps 7800    running time 288 seconds

steps 8000    base_loss: 0.206144    reg_loss: 0.118158    l2_loss: 0.026946    loss: 0.351248
steps 8000    v_Prec: 0.688783  v_Recall: 0.677545  v_F1: 0.683118  v_AUC: 0.904192
steps 8000    running time 294 seconds

steps 8200    base_loss: 0.210976    reg_loss: 0.116460    l2_loss: 0.027210    loss: 0.354646
steps 8200    v_Prec: 0.695182  v_Recall: 0.676515  v_F1: 0.685721  v_AUC: 0.904396
steps 8200    running time 300 seconds

steps 8400    base_loss: 0.205514    reg_loss: 0.115688    l2_loss: 0.027520    loss: 0.348723
steps 8400    v_Prec: 0.685493  v_Recall: 0.686416  v_F1: 0.685954  v_AUC: 0.905062
steps 8400    running time 307 seconds

steps 8600    base_loss: 0.198806    reg_loss: 0.114400    l2_loss: 0.027654    loss: 0.340860
steps 8600    v_Prec: 0.681202  v_Recall: 0.692911  v_F1: 0.687007  v_AUC: 0.904614
steps 8600    running time 314 seconds

steps 8800    base_loss: 0.208616    reg_loss: 0.113410    l2_loss: 0.027924    loss: 0.349949
steps 8800    v_Prec: 0.700666  v_Recall: 0.674693  v_F1: 0.687434  v_AUC: 0.906979
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.201114    reg_loss: 0.111741    l2_loss: 0.028244    loss: 0.341099
steps 9000    v_Prec: 0.687651  v_Recall: 0.697347  v_F1: 0.692465  v_AUC: 0.907141
steps 9000    running time 327 seconds

steps 9200    base_loss: 0.203647    reg_loss: 0.110696    l2_loss: 0.028500    loss: 0.342843
steps 9200    v_Prec: 0.687015  v_Recall: 0.701545  v_F1: 0.694204  v_AUC: 0.907894
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.213822    reg_loss: 0.110874    l2_loss: 0.028643    loss: 0.353339
steps 9400    v_Prec: 0.697473  v_Recall: 0.695208  v_F1: 0.696339  v_AUC: 0.909297
steps 9400    running time 341 seconds

steps 9600    base_loss: 0.210316    reg_loss: 0.109847    l2_loss: 0.029010    loss: 0.349173
steps 9600    v_Prec: 0.730005  v_Recall: 0.669465  v_F1: 0.698426  v_AUC: 0.911877
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.205226    reg_loss: 0.109987    l2_loss: 0.029196    loss: 0.344409
steps 9800    v_Prec: 0.712964  v_Recall: 0.683485  v_F1: 0.697913  v_AUC: 0.911067
steps 9800    running time 354 seconds

steps 10000    base_loss: 0.201462    reg_loss: 0.108306    l2_loss: 0.029333    loss: 0.339100
steps 10000    v_Prec: 0.712482  v_Recall: 0.688158  v_F1: 0.700109  v_AUC: 0.914075
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.206745    reg_loss: 0.108228    l2_loss: 0.029571    loss: 0.344545
steps 10200    v_Prec: 0.710088  v_Recall: 0.692990  v_F1: 0.701435  v_AUC: 0.913769
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.200657    reg_loss: 0.105697    l2_loss: 0.029671    loss: 0.336026
steps 10400    v_Prec: 0.731215  v_Recall: 0.679842  v_F1: 0.704593  v_AUC: 0.914718
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.207059    reg_loss: 0.105251    l2_loss: 0.029847    loss: 0.342157
steps 10600    v_Prec: 0.737651  v_Recall: 0.676594  v_F1: 0.705805  v_AUC: 0.914536
steps 10600    running time 380 seconds

steps 10800    base_loss: 0.194864    reg_loss: 0.104288    l2_loss: 0.030079    loss: 0.329231
steps 10800    v_Prec: 0.720303  v_Recall: 0.693545  v_F1: 0.706670  v_AUC: 0.912765
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.100352    reg_loss: 0.099522    l2_loss: 0.030003    loss: 0.229877
steps 11000    v_Prec: 0.718147  v_Recall: 0.690218  v_F1: 0.703906  v_AUC: 0.911752
steps 11000    running time 393 seconds

steps 11200    base_loss: 0.093422    reg_loss: 0.100903    l2_loss: 0.030036    loss: 0.224361
steps 11200    v_Prec: 0.722368  v_Recall: 0.676594  v_F1: 0.698732  v_AUC: 0.910751
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.095062    reg_loss: 0.102899    l2_loss: 0.029820    loss: 0.227781
steps 11400    v_Prec: 0.722831  v_Recall: 0.679604  v_F1: 0.700551  v_AUC: 0.909895
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.093058    reg_loss: 0.100680    l2_loss: 0.029824    loss: 0.223561
steps 11600    v_Prec: 0.713885  v_Recall: 0.684990  v_F1: 0.699139  v_AUC: 0.908344
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.101366    reg_loss: 0.102710    l2_loss: 0.029701    loss: 0.233777
steps 11800    v_Prec: 0.708221  v_Recall: 0.687129  v_F1: 0.697515  v_AUC: 0.908153
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.094233    reg_loss: 0.101256    l2_loss: 0.029660    loss: 0.225149
steps 12000    v_Prec: 0.697118  v_Recall: 0.686020  v_F1: 0.691525  v_AUC: 0.903474
steps 12000    running time 424 seconds

steps 12200    base_loss: 0.103496    reg_loss: 0.102663    l2_loss: 0.029550    loss: 0.235710
steps 12200    v_Prec: 0.681534  v_Recall: 0.699564  v_F1: 0.690432  v_AUC: 0.905862
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.099887    reg_loss: 0.102309    l2_loss: 0.029567    loss: 0.231763
steps 12400    v_Prec: 0.716111  v_Recall: 0.670337  v_F1: 0.692468  v_AUC: 0.905771
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.095210    reg_loss: 0.102214    l2_loss: 0.029568    loss: 0.226992
steps 12600    v_Prec: 0.707234  v_Recall: 0.670653  v_F1: 0.688458  v_AUC: 0.903414
steps 12600    running time 443 seconds

steps 12800    base_loss: 0.103744    reg_loss: 0.102967    l2_loss: 0.029566    loss: 0.236278
steps 12800    v_Prec: 0.728270  v_Recall: 0.662337  v_F1: 0.693740  v_AUC: 0.906781
steps 12800    running time 450 seconds

Early stop model F1: 0.706670
testing thre: 0.37558356
testing Prec: 0.49309533859977084
testing Recall: 0.7948481166464155
testing F1: 0.6086228391730708
testing AUC: 0.8957308591634217
overall running time 453 seconds
(0.6893800199485537, 0.6382503037667072, 0.6628306077124975, 0.8957308591634217, 0.81130433)

2019-02-24 01:53:10.725593: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:53:11.262358: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:53:11.263300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:53:11.263337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 22.880000 seconds
loading data in 29.060000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.622286    reg_loss: 0.216020    l2_loss: 0.013351    loss: 0.851657
steps 200    v_Prec: 0.165536  v_Recall: 0.928325  v_F1: 0.280970  v_AUC: 0.528274
steps 200    running time 39 seconds

steps 400    base_loss: 0.497251    reg_loss: 0.213847    l2_loss: 0.013182    loss: 0.724280
steps 400    v_Prec: 0.170760  v_Recall: 0.865559  v_F1: 0.285246  v_AUC: 0.556117
steps 400    running time 46 seconds

steps 600    base_loss: 0.480241    reg_loss: 0.211653    l2_loss: 0.013022    loss: 0.704916
steps 600    v_Prec: 0.195574  v_Recall: 0.625572  v_F1: 0.297987  v_AUC: 0.592876
steps 600    running time 53 seconds

steps 800    base_loss: 0.460311    reg_loss: 0.207783    l2_loss: 0.012896    loss: 0.680990
steps 800    v_Prec: 0.229684  v_Recall: 0.572598  v_F1: 0.327857  v_AUC: 0.645659
steps 800    running time 60 seconds

steps 1000    base_loss: 0.442166    reg_loss: 0.202609    l2_loss: 0.012780    loss: 0.657556
steps 1000    v_Prec: 0.277390  v_Recall: 0.526126  v_F1: 0.363259  v_AUC: 0.689311
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.429711    reg_loss: 0.197345    l2_loss: 0.012772    loss: 0.639827
steps 1200    v_Prec: 0.361708  v_Recall: 0.490087  v_F1: 0.416224  v_AUC: 0.738881
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.403073    reg_loss: 0.192173    l2_loss: 0.012791    loss: 0.608036
steps 1400    v_Prec: 0.404668  v_Recall: 0.528774  v_F1: 0.458471  v_AUC: 0.770667
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.387395    reg_loss: 0.188654    l2_loss: 0.012918    loss: 0.588967
steps 1600    v_Prec: 0.449288  v_Recall: 0.556786  v_F1: 0.497294  v_AUC: 0.797859
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.367568    reg_loss: 0.184912    l2_loss: 0.013082    loss: 0.565562
steps 1800    v_Prec: 0.525588  v_Recall: 0.536640  v_F1: 0.531056  v_AUC: 0.822796
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.349113    reg_loss: 0.181163    l2_loss: 0.013351    loss: 0.543627
steps 2000    v_Prec: 0.536426  v_Recall: 0.587447  v_F1: 0.560778  v_AUC: 0.841638
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.325307    reg_loss: 0.177440    l2_loss: 0.013626    loss: 0.516374
steps 2200    v_Prec: 0.594197  v_Recall: 0.560478  v_F1: 0.576845  v_AUC: 0.854083
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.316570    reg_loss: 0.174556    l2_loss: 0.013962    loss: 0.505089
steps 2400    v_Prec: 0.616791  v_Recall: 0.571394  v_F1: 0.593225  v_AUC: 0.862216
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.305543    reg_loss: 0.171132    l2_loss: 0.014324    loss: 0.490999
steps 2600    v_Prec: 0.605996  v_Recall: 0.616502  v_F1: 0.611204  v_AUC: 0.869752
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.304008    reg_loss: 0.167848    l2_loss: 0.014662    loss: 0.486518
steps 2800    v_Prec: 0.665363  v_Recall: 0.573722  v_F1: 0.616154  v_AUC: 0.873933
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.296339    reg_loss: 0.165025    l2_loss: 0.015073    loss: 0.476437
steps 3000    v_Prec: 0.635016  v_Recall: 0.629103  v_F1: 0.632046  v_AUC: 0.879754
steps 3000    running time 135 seconds

steps 3200    base_loss: 0.294669    reg_loss: 0.162316    l2_loss: 0.015438    loss: 0.472424
steps 3200    v_Prec: 0.642310  v_Recall: 0.632153  v_F1: 0.637191  v_AUC: 0.883795
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.294041    reg_loss: 0.159915    l2_loss: 0.015852    loss: 0.469807
steps 3400    v_Prec: 0.647632  v_Recall: 0.635364  v_F1: 0.641439  v_AUC: 0.888059
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.289021    reg_loss: 0.156608    l2_loss: 0.016335    loss: 0.461963
steps 3600    v_Prec: 0.658537  v_Recall: 0.634963  v_F1: 0.646535  v_AUC: 0.888183
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.286345    reg_loss: 0.153836    l2_loss: 0.016749    loss: 0.456930
steps 3800    v_Prec: 0.631555  v_Recall: 0.657356  v_F1: 0.644197  v_AUC: 0.889780
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.287714    reg_loss: 0.150669    l2_loss: 0.017201    loss: 0.455584
steps 4000    v_Prec: 0.680038  v_Recall: 0.625893  v_F1: 0.651843  v_AUC: 0.892207
steps 4000    running time 169 seconds

steps 4200    base_loss: 0.285920    reg_loss: 0.148347    l2_loss: 0.017673    loss: 0.451940
steps 4200    v_Prec: 0.676001  v_Recall: 0.639377  v_F1: 0.657179  v_AUC: 0.893871
steps 4200    running time 176 seconds

steps 4400    base_loss: 0.285177    reg_loss: 0.145725    l2_loss: 0.018220    loss: 0.449121
steps 4400    v_Prec: 0.698424  v_Recall: 0.622522  v_F1: 0.658292  v_AUC: 0.895057
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.280611    reg_loss: 0.143007    l2_loss: 0.018767    loss: 0.442385
steps 4600    v_Prec: 0.692193  v_Recall: 0.634080  v_F1: 0.661863  v_AUC: 0.894807
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.288536    reg_loss: 0.141557    l2_loss: 0.019376    loss: 0.449469
steps 4800    v_Prec: 0.670581  v_Recall: 0.655350  v_F1: 0.662878  v_AUC: 0.896460
steps 4800    running time 196 seconds

steps 5000    base_loss: 0.280408    reg_loss: 0.137678    l2_loss: 0.019917    loss: 0.438004
steps 5000    v_Prec: 0.669646  v_Recall: 0.655510  v_F1: 0.662503  v_AUC: 0.898998
steps 5000    running time 203 seconds

steps 5200    base_loss: 0.280966    reg_loss: 0.136093    l2_loss: 0.020541    loss: 0.437600
steps 5200    v_Prec: 0.666639  v_Recall: 0.654226  v_F1: 0.660374  v_AUC: 0.898055
steps 5200    running time 209 seconds

steps 5400    base_loss: 0.278809    reg_loss: 0.133306    l2_loss: 0.021224    loss: 0.433339
steps 5400    v_Prec: 0.679575  v_Recall: 0.652139  v_F1: 0.665574  v_AUC: 0.898825
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.196529    reg_loss: 0.128316    l2_loss: 0.021759    loss: 0.346604
steps 5600    v_Prec: 0.698840  v_Recall: 0.643310  v_F1: 0.669926  v_AUC: 0.898549
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.184945    reg_loss: 0.127020    l2_loss: 0.022315    loss: 0.334280
steps 5800    v_Prec: 0.657818  v_Recall: 0.674292  v_F1: 0.665953  v_AUC: 0.897124
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.200428    reg_loss: 0.127473    l2_loss: 0.022920    loss: 0.350820
steps 6000    v_Prec: 0.690559  v_Recall: 0.655751  v_F1: 0.672705  v_AUC: 0.897861
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.194988    reg_loss: 0.127369    l2_loss: 0.023479    loss: 0.345837
steps 6200    v_Prec: 0.695779  v_Recall: 0.649651  v_F1: 0.671924  v_AUC: 0.899579
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.201850    reg_loss: 0.126161    l2_loss: 0.023950    loss: 0.351962
steps 6400    v_Prec: 0.667993  v_Recall: 0.673730  v_F1: 0.670849  v_AUC: 0.901289
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.191625    reg_loss: 0.124271    l2_loss: 0.024531    loss: 0.340426
steps 6600    v_Prec: 0.680756  v_Recall: 0.670921  v_F1: 0.675802  v_AUC: 0.902371
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.197880    reg_loss: 0.124300    l2_loss: 0.025021    loss: 0.347201
steps 6800    v_Prec: 0.667538  v_Recall: 0.676057  v_F1: 0.671771  v_AUC: 0.901049
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.201714    reg_loss: 0.123377    l2_loss: 0.025372    loss: 0.350463
steps 7000    v_Prec: 0.673660  v_Recall: 0.682960  v_F1: 0.678278  v_AUC: 0.903518
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.185120    reg_loss: 0.121197    l2_loss: 0.025757    loss: 0.332074
steps 7200    v_Prec: 0.670013  v_Recall: 0.680231  v_F1: 0.675084  v_AUC: 0.902462
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.196873    reg_loss: 0.121217    l2_loss: 0.026246    loss: 0.344336
steps 7400    v_Prec: 0.678526  v_Recall: 0.681194  v_F1: 0.679857  v_AUC: 0.904146
steps 7400    running time 280 seconds

steps 7600    base_loss: 0.191550    reg_loss: 0.120155    l2_loss: 0.026542    loss: 0.338247
steps 7600    v_Prec: 0.689176  v_Recall: 0.672526  v_F1: 0.680749  v_AUC: 0.903956
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.201373    reg_loss: 0.119283    l2_loss: 0.026933    loss: 0.347589
steps 7800    v_Prec: 0.719092  v_Recall: 0.653584  v_F1: 0.684775  v_AUC: 0.905488
steps 7800    running time 293 seconds

steps 8000    base_loss: 0.195078    reg_loss: 0.117316    l2_loss: 0.027209    loss: 0.339603
steps 8000    v_Prec: 0.724098  v_Recall: 0.647323  v_F1: 0.683561  v_AUC: 0.908316
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.195958    reg_loss: 0.117551    l2_loss: 0.027518    loss: 0.341028
steps 8200    v_Prec: 0.703028  v_Recall: 0.661610  v_F1: 0.681690  v_AUC: 0.903218
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.207561    reg_loss: 0.116888    l2_loss: 0.027766    loss: 0.352215
steps 8400    v_Prec: 0.691274  v_Recall: 0.685448  v_F1: 0.688349  v_AUC: 0.907053
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.199293    reg_loss: 0.114828    l2_loss: 0.028070    loss: 0.342190
steps 8600    v_Prec: 0.695259  v_Recall: 0.690906  v_F1: 0.693076  v_AUC: 0.908826
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.198621    reg_loss: 0.114474    l2_loss: 0.028389    loss: 0.341485
steps 8800    v_Prec: 0.718956  v_Recall: 0.674292  v_F1: 0.695908  v_AUC: 0.911159
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.207174    reg_loss: 0.113976    l2_loss: 0.028576    loss: 0.349726
steps 9000    v_Prec: 0.702740  v_Recall: 0.691629  v_F1: 0.697140  v_AUC: 0.912222
steps 9000    running time 332 seconds

steps 9200    base_loss: 0.197341    reg_loss: 0.112432    l2_loss: 0.028802    loss: 0.338574
steps 9200    v_Prec: 0.709241  v_Recall: 0.681917  v_F1: 0.695311  v_AUC: 0.911739
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.202034    reg_loss: 0.111516    l2_loss: 0.028893    loss: 0.342443
steps 9400    v_Prec: 0.716490  v_Recall: 0.678305  v_F1: 0.696875  v_AUC: 0.913753
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.202410    reg_loss: 0.110333    l2_loss: 0.029201    loss: 0.341945
steps 9600    v_Prec: 0.721627  v_Recall: 0.680793  v_F1: 0.700615  v_AUC: 0.913715
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.198047    reg_loss: 0.108948    l2_loss: 0.029448    loss: 0.336442
steps 9800    v_Prec: 0.719963  v_Recall: 0.692110  v_F1: 0.705762  v_AUC: 0.915908
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.199468    reg_loss: 0.108377    l2_loss: 0.029540    loss: 0.337386
steps 10000    v_Prec: 0.722110  v_Recall: 0.690986  v_F1: 0.706206  v_AUC: 0.916693
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.201508    reg_loss: 0.107692    l2_loss: 0.029856    loss: 0.339055
steps 10200    v_Prec: 0.733927  v_Recall: 0.681676  v_F1: 0.706837  v_AUC: 0.917576
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.198197    reg_loss: 0.106564    l2_loss: 0.029916    loss: 0.334676
steps 10400    v_Prec: 0.711312  v_Recall: 0.699494  v_F1: 0.705354  v_AUC: 0.916758
steps 10400    running time 378 seconds

steps 10600    base_loss: 0.197444    reg_loss: 0.105812    l2_loss: 0.030227    loss: 0.333483
steps 10600    v_Prec: 0.735324  v_Recall: 0.685689  v_F1: 0.709640  v_AUC: 0.916201
steps 10600    running time 384 seconds

steps 10800    base_loss: 0.188805    reg_loss: 0.104463    l2_loss: 0.030182    loss: 0.323450
steps 10800    v_Prec: 0.740062  v_Recall: 0.687375  v_F1: 0.712746  v_AUC: 0.916516
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.089991    reg_loss: 0.098865    l2_loss: 0.030317    loss: 0.219173
steps 11000    v_Prec: 0.715934  v_Recall: 0.702143  v_F1: 0.708972  v_AUC: 0.916408
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.088369    reg_loss: 0.101132    l2_loss: 0.030042    loss: 0.219543
steps 11200    v_Prec: 0.732276  v_Recall: 0.678144  v_F1: 0.704171  v_AUC: 0.913543
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.089271    reg_loss: 0.101272    l2_loss: 0.030017    loss: 0.220561
steps 11400    v_Prec: 0.713670  v_Recall: 0.690585  v_F1: 0.701938  v_AUC: 0.912923
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.091667    reg_loss: 0.102611    l2_loss: 0.029865    loss: 0.224143
steps 11600    v_Prec: 0.699548  v_Recall: 0.695000  v_F1: 0.697266  v_AUC: 0.910898
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.091289    reg_loss: 0.102672    l2_loss: 0.029832    loss: 0.223793
steps 11800    v_Prec: 0.716896  v_Recall: 0.677021  v_F1: 0.696388  v_AUC: 0.910663
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.097865    reg_loss: 0.103398    l2_loss: 0.029735    loss: 0.230998
steps 12000    v_Prec: 0.713739  v_Recall: 0.673409  v_F1: 0.692988  v_AUC: 0.911858
steps 12000    running time 429 seconds

steps 12200    base_loss: 0.089893    reg_loss: 0.101612    l2_loss: 0.029678    loss: 0.221184
steps 12200    v_Prec: 0.715375  v_Recall: 0.669957  v_F1: 0.691922  v_AUC: 0.908965
steps 12200    running time 435 seconds

steps 12400    base_loss: 0.089403    reg_loss: 0.102009    l2_loss: 0.029673    loss: 0.221085
steps 12400    v_Prec: 0.725678  v_Recall: 0.667550  v_F1: 0.695401  v_AUC: 0.911249
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.096397    reg_loss: 0.102741    l2_loss: 0.029706    loss: 0.228845
steps 12600    v_Prec: 0.721046  v_Recall: 0.672606  v_F1: 0.695984  v_AUC: 0.909737
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.098609    reg_loss: 0.102806    l2_loss: 0.029710    loss: 0.231125
steps 12800    v_Prec: 0.709341  v_Recall: 0.682639  v_F1: 0.695734  v_AUC: 0.908791
steps 12800    running time 454 seconds

Early stop model F1: 0.712746
testing thre: 0.46441278
testing Prec: 0.5022065858099559
testing Recall: 0.7909113001215067
testing F1: 0.6143304768016914
testing AUC: 0.8988838564375556
overall running time 456 seconds
(0.7010803689064559, 0.6465613608748482, 0.6727180783817952, 0.8988838564375556, 0.8549779)

2019-02-24 01:58:24.161895: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 01:58:24.880999: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 01:58:24.909840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 01:58:24.909888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.690000 seconds
loading data in 30.860000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.1
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.498453    reg_loss: 0.215406    l2_loss: 0.013346    loss: 0.727205
steps 200    v_Prec: 0.163663  v_Recall: 1.000000  v_F1: 0.281290  v_AUC: 0.490850
steps 200    running time 41 seconds

steps 400    base_loss: 0.477977    reg_loss: 0.215685    l2_loss: 0.013290    loss: 0.706952
steps 400    v_Prec: 0.166327  v_Recall: 0.916926  v_F1: 0.281577  v_AUC: 0.534636
steps 400    running time 48 seconds

steps 600    base_loss: 0.463864    reg_loss: 0.214214    l2_loss: 0.013187    loss: 0.691265
steps 600    v_Prec: 0.205821  v_Recall: 0.598182  v_F1: 0.306264  v_AUC: 0.602519
steps 600    running time 55 seconds

steps 800    base_loss: 0.445045    reg_loss: 0.212584    l2_loss: 0.013060    loss: 0.670689
steps 800    v_Prec: 0.274465  v_Recall: 0.510484  v_F1: 0.356992  v_AUC: 0.673403
steps 800    running time 62 seconds

steps 1000    base_loss: 0.426241    reg_loss: 0.211184    l2_loss: 0.012918    loss: 0.650342
steps 1000    v_Prec: 0.373306  v_Recall: 0.472295  v_F1: 0.417007  v_AUC: 0.731195
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.396198    reg_loss: 0.209783    l2_loss: 0.012912    loss: 0.618893
steps 1200    v_Prec: 0.429055  v_Recall: 0.494937  v_F1: 0.459648  v_AUC: 0.765895
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.374471    reg_loss: 0.209310    l2_loss: 0.013004    loss: 0.596784
steps 1400    v_Prec: 0.513699  v_Recall: 0.496293  v_F1: 0.504846  v_AUC: 0.797477
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.352405    reg_loss: 0.209125    l2_loss: 0.013090    loss: 0.574620
steps 1600    v_Prec: 0.556887  v_Recall: 0.522523  v_F1: 0.539158  v_AUC: 0.815904
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.339955    reg_loss: 0.208975    l2_loss: 0.013220    loss: 0.562150
steps 1800    v_Prec: 0.588481  v_Recall: 0.540062  v_F1: 0.563233  v_AUC: 0.830721
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.327971    reg_loss: 0.208925    l2_loss: 0.013372    loss: 0.550268
steps 2000    v_Prec: 0.631057  v_Recall: 0.532648  v_F1: 0.577691  v_AUC: 0.840453
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.318173    reg_loss: 0.208779    l2_loss: 0.013537    loss: 0.540488
steps 2200    v_Prec: 0.621399  v_Recall: 0.570916  v_F1: 0.595089  v_AUC: 0.850363
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.320337    reg_loss: 0.208695    l2_loss: 0.013693    loss: 0.542724
steps 2400    v_Prec: 0.613310  v_Recall: 0.596588  v_F1: 0.604833  v_AUC: 0.856954
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.307599    reg_loss: 0.208427    l2_loss: 0.013930    loss: 0.529956
steps 2600    v_Prec: 0.631485  v_Recall: 0.594834  v_F1: 0.612612  v_AUC: 0.862988
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.314435    reg_loss: 0.208819    l2_loss: 0.014066    loss: 0.537319
steps 2800    v_Prec: 0.608865  v_Recall: 0.636291  v_F1: 0.622276  v_AUC: 0.868540
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.301613    reg_loss: 0.208262    l2_loss: 0.014358    loss: 0.524234
steps 3000    v_Prec: 0.639474  v_Recall: 0.616838  v_F1: 0.627952  v_AUC: 0.873779
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.302854    reg_loss: 0.208232    l2_loss: 0.014581    loss: 0.525667
steps 3200    v_Prec: 0.638498  v_Recall: 0.615642  v_F1: 0.626862  v_AUC: 0.877039
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.294596    reg_loss: 0.207121    l2_loss: 0.014947    loss: 0.516664
steps 3400    v_Prec: 0.635995  v_Recall: 0.637009  v_F1: 0.636501  v_AUC: 0.880950
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.285996    reg_loss: 0.206185    l2_loss: 0.015286    loss: 0.507468
steps 3600    v_Prec: 0.625980  v_Recall: 0.643148  v_F1: 0.634448  v_AUC: 0.881072
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.287780    reg_loss: 0.205368    l2_loss: 0.015768    loss: 0.508916
steps 3800    v_Prec: 0.648796  v_Recall: 0.625209  v_F1: 0.636784  v_AUC: 0.883817
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.291251    reg_loss: 0.205368    l2_loss: 0.016120    loss: 0.512739
steps 4000    v_Prec: 0.647740  v_Recall: 0.628478  v_F1: 0.637964  v_AUC: 0.885534
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.282460    reg_loss: 0.203627    l2_loss: 0.016639    loss: 0.502725
steps 4200    v_Prec: 0.647073  v_Recall: 0.632783  v_F1: 0.639848  v_AUC: 0.886829
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.282204    reg_loss: 0.202733    l2_loss: 0.017153    loss: 0.502090
steps 4400    v_Prec: 0.645161  v_Recall: 0.645779  v_F1: 0.645470  v_AUC: 0.889756
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.286591    reg_loss: 0.202118    l2_loss: 0.017636    loss: 0.506346
steps 4600    v_Prec: 0.624778  v_Recall: 0.674639  v_F1: 0.648752  v_AUC: 0.891513
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.281795    reg_loss: 0.201697    l2_loss: 0.018184    loss: 0.501676
steps 4800    v_Prec: 0.664799  v_Recall: 0.624412  v_F1: 0.643973  v_AUC: 0.891693
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.273165    reg_loss: 0.199325    l2_loss: 0.018750    loss: 0.491240
steps 5000    v_Prec: 0.655515  v_Recall: 0.642031  v_F1: 0.648703  v_AUC: 0.894700
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.282522    reg_loss: 0.198612    l2_loss: 0.019339    loss: 0.500473
steps 5200    v_Prec: 0.651298  v_Recall: 0.654309  v_F1: 0.652800  v_AUC: 0.896049
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.267354    reg_loss: 0.197408    l2_loss: 0.020017    loss: 0.484779
steps 5400    v_Prec: 0.649188  v_Recall: 0.656382  v_F1: 0.652765  v_AUC: 0.896533
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.197362    reg_loss: 0.193999    l2_loss: 0.020861    loss: 0.412223
steps 5600    v_Prec: 0.641573  v_Recall: 0.657020  v_F1: 0.649204  v_AUC: 0.891501
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.193316    reg_loss: 0.193350    l2_loss: 0.021736    loss: 0.408402
steps 5800    v_Prec: 0.650057  v_Recall: 0.637567  v_F1: 0.643751  v_AUC: 0.889246
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.205917    reg_loss: 0.191689    l2_loss: 0.022516    loss: 0.420121
steps 6000    v_Prec: 0.662217  v_Recall: 0.620984  v_F1: 0.640938  v_AUC: 0.888234
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.206948    reg_loss: 0.190568    l2_loss: 0.023201    loss: 0.420717
steps 6200    v_Prec: 0.651962  v_Recall: 0.640995  v_F1: 0.646432  v_AUC: 0.889117
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.207307    reg_loss: 0.189733    l2_loss: 0.023781    loss: 0.420821
steps 6400    v_Prec: 0.633917  v_Recall: 0.672327  v_F1: 0.652557  v_AUC: 0.894258
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.205463    reg_loss: 0.190099    l2_loss: 0.024319    loss: 0.419881
steps 6600    v_Prec: 0.650184  v_Recall: 0.648888  v_F1: 0.649535  v_AUC: 0.892743
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.197481    reg_loss: 0.189182    l2_loss: 0.024738    loss: 0.411402
steps 6800    v_Prec: 0.663984  v_Recall: 0.651280  v_F1: 0.657571  v_AUC: 0.894642
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.206515    reg_loss: 0.189343    l2_loss: 0.025406    loss: 0.421264
steps 7000    v_Prec: 0.664627  v_Recall: 0.658216  v_F1: 0.661406  v_AUC: 0.896104
steps 7000    running time 263 seconds

steps 7200    base_loss: 0.204443    reg_loss: 0.187683    l2_loss: 0.025873    loss: 0.417999
steps 7200    v_Prec: 0.638721  v_Recall: 0.675436  v_F1: 0.656566  v_AUC: 0.894248
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.205124    reg_loss: 0.187254    l2_loss: 0.026235    loss: 0.418614
steps 7400    v_Prec: 0.653121  v_Recall: 0.671450  v_F1: 0.662159  v_AUC: 0.897465
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.199977    reg_loss: 0.185331    l2_loss: 0.026746    loss: 0.412053
steps 7600    v_Prec: 0.688400  v_Recall: 0.643945  v_F1: 0.665431  v_AUC: 0.898502
steps 7600    running time 283 seconds

steps 7800    base_loss: 0.202568    reg_loss: 0.185499    l2_loss: 0.027102    loss: 0.415169
steps 7800    v_Prec: 0.700254  v_Recall: 0.636610  v_F1: 0.666917  v_AUC: 0.901273
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.204344    reg_loss: 0.185027    l2_loss: 0.027454    loss: 0.416825
steps 8000    v_Prec: 0.689015  v_Recall: 0.659571  v_F1: 0.673971  v_AUC: 0.903711
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.205321    reg_loss: 0.182904    l2_loss: 0.027813    loss: 0.416039
steps 8200    v_Prec: 0.670097  v_Recall: 0.690505  v_F1: 0.680148  v_AUC: 0.906341
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.204309    reg_loss: 0.182094    l2_loss: 0.028114    loss: 0.414517
steps 8400    v_Prec: 0.696975  v_Recall: 0.664913  v_F1: 0.680566  v_AUC: 0.907311
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.204729    reg_loss: 0.181154    l2_loss: 0.028461    loss: 0.414344
steps 8600    v_Prec: 0.690911  v_Recall: 0.682373  v_F1: 0.686615  v_AUC: 0.909678
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.202918    reg_loss: 0.180479    l2_loss: 0.028729    loss: 0.412125
steps 8800    v_Prec: 0.694498  v_Recall: 0.686359  v_F1: 0.690405  v_AUC: 0.910987
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.198425    reg_loss: 0.179420    l2_loss: 0.029112    loss: 0.406957
steps 9000    v_Prec: 0.728008  v_Recall: 0.660448  v_F1: 0.692584  v_AUC: 0.910439
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.200041    reg_loss: 0.179347    l2_loss: 0.029332    loss: 0.408721
steps 9200    v_Prec: 0.702295  v_Recall: 0.690425  v_F1: 0.696309  v_AUC: 0.913242
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.196116    reg_loss: 0.178016    l2_loss: 0.029611    loss: 0.403743
steps 9400    v_Prec: 0.734773  v_Recall: 0.664594  v_F1: 0.697924  v_AUC: 0.913433
steps 9400    running time 344 seconds

steps 9600    base_loss: 0.202959    reg_loss: 0.178672    l2_loss: 0.029953    loss: 0.411584
steps 9600    v_Prec: 0.731328  v_Recall: 0.674480  v_F1: 0.701754  v_AUC: 0.915186
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.210005    reg_loss: 0.177187    l2_loss: 0.030216    loss: 0.417408
steps 9800    v_Prec: 0.733742  v_Recall: 0.677350  v_F1: 0.704419  v_AUC: 0.916041
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.206218    reg_loss: 0.175574    l2_loss: 0.030503    loss: 0.412295
steps 10000    v_Prec: 0.731242  v_Recall: 0.696962  v_F1: 0.713691  v_AUC: 0.918958
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.200570    reg_loss: 0.176754    l2_loss: 0.030606    loss: 0.407929
steps 10200    v_Prec: 0.711363  v_Recall: 0.706769  v_F1: 0.709058  v_AUC: 0.918998
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.194261    reg_loss: 0.173676    l2_loss: 0.030916    loss: 0.398853
steps 10400    v_Prec: 0.728557  v_Recall: 0.702942  v_F1: 0.715520  v_AUC: 0.920163
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.200354    reg_loss: 0.172006    l2_loss: 0.031155    loss: 0.403515
steps 10600    v_Prec: 0.746856  v_Recall: 0.691302  v_F1: 0.718006  v_AUC: 0.922179
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.193305    reg_loss: 0.172471    l2_loss: 0.031373    loss: 0.397149
steps 10800    v_Prec: 0.734684  v_Recall: 0.705573  v_F1: 0.719834  v_AUC: 0.923086
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.096201    reg_loss: 0.166066    l2_loss: 0.031619    loss: 0.293886
steps 11000    v_Prec: 0.715095  v_Recall: 0.694172  v_F1: 0.704478  v_AUC: 0.912549
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.095391    reg_loss: 0.163982    l2_loss: 0.031929    loss: 0.291301
steps 11200    v_Prec: 0.720107  v_Recall: 0.663557  v_F1: 0.690677  v_AUC: 0.907504
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.105139    reg_loss: 0.164592    l2_loss: 0.032149    loss: 0.301879
steps 11400    v_Prec: 0.706035  v_Recall: 0.670573  v_F1: 0.687848  v_AUC: 0.907748
steps 11400    running time 410 seconds

steps 11600    base_loss: 0.101348    reg_loss: 0.163129    l2_loss: 0.032518    loss: 0.296995
steps 11600    v_Prec: 0.697455  v_Recall: 0.670653  v_F1: 0.683791  v_AUC: 0.903948
steps 11600    running time 416 seconds

steps 11800    base_loss: 0.110729    reg_loss: 0.163159    l2_loss: 0.032748    loss: 0.306636
steps 11800    v_Prec: 0.710078  v_Recall: 0.661166  v_F1: 0.684749  v_AUC: 0.905323
steps 11800    running time 422 seconds

steps 12000    base_loss: 0.113657    reg_loss: 0.161881    l2_loss: 0.032942    loss: 0.308480
steps 12000    v_Prec: 0.691788  v_Recall: 0.668899  v_F1: 0.680151  v_AUC: 0.903198
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.109123    reg_loss: 0.160702    l2_loss: 0.033211    loss: 0.303035
steps 12200    v_Prec: 0.716495  v_Recall: 0.650004  v_F1: 0.681632  v_AUC: 0.902703
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.113270    reg_loss: 0.160490    l2_loss: 0.033383    loss: 0.307142
steps 12400    v_Prec: 0.699175  v_Recall: 0.669298  v_F1: 0.683910  v_AUC: 0.904311
steps 12400    running time 441 seconds

steps 12600    base_loss: 0.109708    reg_loss: 0.157892    l2_loss: 0.033516    loss: 0.301115
steps 12600    v_Prec: 0.691508  v_Recall: 0.678386  v_F1: 0.684884  v_AUC: 0.904654
steps 12600    running time 447 seconds

steps 12800    base_loss: 0.119347    reg_loss: 0.159812    l2_loss: 0.033656    loss: 0.312815
steps 12800    v_Prec: 0.710758  v_Recall: 0.663159  v_F1: 0.686134  v_AUC: 0.904729
steps 12800    running time 454 seconds

Early stop model F1: 0.719834
testing thre: 0.35615107
testing Prec: 0.5839606135818042
testing Recall: 0.6975455650060753
testing F1: 0.635719347980156
testing AUC: 0.8897946096844005
overall running time 456 seconds
(0.6986139283299526, 0.6026245443499393, 0.6470787777574826, 0.8897946096844005, 0.59802747)

2019-02-24 02:03:43.596934: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:03:44.256808: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:03:44.391799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:03:44.391893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.700000 seconds
loading data in 31.400000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.674487    reg_loss: 0.647535    l2_loss: 0.013333    loss: 1.335355
steps 200    v_Prec: 0.164200  v_Recall: 0.999921  v_F1: 0.282079  v_AUC: 0.516294
steps 200    running time 41 seconds

steps 400    base_loss: 0.554383    reg_loss: 0.642277    l2_loss: 0.013198    loss: 1.209858
steps 400    v_Prec: 0.167531  v_Recall: 0.905969  v_F1: 0.282773  v_AUC: 0.536920
steps 400    running time 48 seconds

steps 600    base_loss: 0.526601    reg_loss: 0.631987    l2_loss: 0.013040    loss: 1.171629
steps 600    v_Prec: 0.193843  v_Recall: 0.625149  v_F1: 0.295927  v_AUC: 0.578831
steps 600    running time 54 seconds

steps 800    base_loss: 0.470443    reg_loss: 0.610984    l2_loss: 0.012882    loss: 1.094309
steps 800    v_Prec: 0.233180  v_Recall: 0.503299  v_F1: 0.318703  v_AUC: 0.622461
steps 800    running time 61 seconds

steps 1000    base_loss: 0.450198    reg_loss: 0.586994    l2_loss: 0.012770    loss: 1.049962
steps 1000    v_Prec: 0.279328  v_Recall: 0.465384  v_F1: 0.349115  v_AUC: 0.651061
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.436128    reg_loss: 0.562712    l2_loss: 0.012722    loss: 1.011562
steps 1200    v_Prec: 0.334187  v_Recall: 0.445752  v_F1: 0.381990  v_AUC: 0.678252
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.420163    reg_loss: 0.536278    l2_loss: 0.012689    loss: 0.969130
steps 1400    v_Prec: 0.431434  v_Recall: 0.407360  v_F1: 0.419052  v_AUC: 0.711990
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.402736    reg_loss: 0.515856    l2_loss: 0.012716    loss: 0.931308
steps 1600    v_Prec: 0.442734  v_Recall: 0.457197  v_F1: 0.449849  v_AUC: 0.741416
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.391449    reg_loss: 0.503592    l2_loss: 0.012800    loss: 0.907842
steps 1800    v_Prec: 0.482772  v_Recall: 0.496701  v_F1: 0.489638  v_AUC: 0.783085
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.370699    reg_loss: 0.492016    l2_loss: 0.012923    loss: 0.875638
steps 2000    v_Prec: 0.508320  v_Recall: 0.531754  v_F1: 0.519773  v_AUC: 0.804689
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.348914    reg_loss: 0.475809    l2_loss: 0.013075    loss: 0.837798
steps 2200    v_Prec: 0.563815  v_Recall: 0.528098  v_F1: 0.545372  v_AUC: 0.823806
steps 2200    running time 107 seconds

steps 2400    base_loss: 0.334737    reg_loss: 0.461668    l2_loss: 0.013317    loss: 0.809721
steps 2400    v_Prec: 0.555871  v_Recall: 0.575709  v_F1: 0.565616  v_AUC: 0.839591
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.332664    reg_loss: 0.452238    l2_loss: 0.013547    loss: 0.798450
steps 2600    v_Prec: 0.567004  v_Recall: 0.596614  v_F1: 0.581432  v_AUC: 0.849069
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.327338    reg_loss: 0.440041    l2_loss: 0.013715    loss: 0.781094
steps 2800    v_Prec: 0.571117  v_Recall: 0.625229  v_F1: 0.596949  v_AUC: 0.858786
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.318440    reg_loss: 0.427624    l2_loss: 0.013996    loss: 0.760060
steps 3000    v_Prec: 0.606243  v_Recall: 0.617518  v_F1: 0.611829  v_AUC: 0.865830
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.310907    reg_loss: 0.414354    l2_loss: 0.014296    loss: 0.739558
steps 3200    v_Prec: 0.659348  v_Recall: 0.580002  v_F1: 0.617135  v_AUC: 0.869863
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.314097    reg_loss: 0.402248    l2_loss: 0.014624    loss: 0.730970
steps 3400    v_Prec: 0.623429  v_Recall: 0.618870  v_F1: 0.621141  v_AUC: 0.872949
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.306411    reg_loss: 0.390681    l2_loss: 0.014983    loss: 0.712075
steps 3600    v_Prec: 0.633740  v_Recall: 0.614498  v_F1: 0.623971  v_AUC: 0.874556
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.305410    reg_loss: 0.379386    l2_loss: 0.015262    loss: 0.700058
steps 3800    v_Prec: 0.598024  v_Recall: 0.654161  v_F1: 0.624834  v_AUC: 0.877669
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.299760    reg_loss: 0.366518    l2_loss: 0.015638    loss: 0.681915
steps 4000    v_Prec: 0.613365  v_Recall: 0.640569  v_F1: 0.626672  v_AUC: 0.878477
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.305884    reg_loss: 0.358053    l2_loss: 0.016001    loss: 0.679938
steps 4200    v_Prec: 0.626877  v_Recall: 0.630316  v_F1: 0.628592  v_AUC: 0.880894
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.302153    reg_loss: 0.346926    l2_loss: 0.016379    loss: 0.665458
steps 4400    v_Prec: 0.613424  v_Recall: 0.658135  v_F1: 0.634994  v_AUC: 0.882257
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.297975    reg_loss: 0.332607    l2_loss: 0.016767    loss: 0.647349
steps 4600    v_Prec: 0.641369  v_Recall: 0.631428  v_F1: 0.636360  v_AUC: 0.883447
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.303486    reg_loss: 0.324063    l2_loss: 0.017107    loss: 0.644656
steps 4800    v_Prec: 0.634146  v_Recall: 0.648915  v_F1: 0.641446  v_AUC: 0.885014
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.301761    reg_loss: 0.315605    l2_loss: 0.017505    loss: 0.634871
steps 5000    v_Prec: 0.637189  v_Recall: 0.641443  v_F1: 0.639309  v_AUC: 0.884923
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.293828    reg_loss: 0.301906    l2_loss: 0.017895    loss: 0.613628
steps 5200    v_Prec: 0.621998  v_Recall: 0.656705  v_F1: 0.638880  v_AUC: 0.883350
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.295090    reg_loss: 0.293330    l2_loss: 0.018373    loss: 0.606793
steps 5400    v_Prec: 0.630164  v_Recall: 0.655910  v_F1: 0.642779  v_AUC: 0.886368
steps 5400    running time 212 seconds

steps 5600    base_loss: 0.248300    reg_loss: 0.264609    l2_loss: 0.018859    loss: 0.531768
steps 5600    v_Prec: 0.633863  v_Recall: 0.646610  v_F1: 0.640173  v_AUC: 0.883538
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.231791    reg_loss: 0.255627    l2_loss: 0.019192    loss: 0.506611
steps 5800    v_Prec: 0.646392  v_Recall: 0.638582  v_F1: 0.642463  v_AUC: 0.882764
steps 5800    running time 225 seconds

steps 6000    base_loss: 0.251617    reg_loss: 0.256951    l2_loss: 0.019512    loss: 0.528080
steps 6000    v_Prec: 0.603473  v_Recall: 0.682378  v_F1: 0.640504  v_AUC: 0.883770
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.250294    reg_loss: 0.254821    l2_loss: 0.019895    loss: 0.525010
steps 6200    v_Prec: 0.641656  v_Recall: 0.655274  v_F1: 0.648394  v_AUC: 0.887404
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.241656    reg_loss: 0.250406    l2_loss: 0.020184    loss: 0.512245
steps 6400    v_Prec: 0.637870  v_Recall: 0.657897  v_F1: 0.647729  v_AUC: 0.886720
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.247133    reg_loss: 0.245889    l2_loss: 0.020410    loss: 0.513433
steps 6600    v_Prec: 0.637200  v_Recall: 0.655433  v_F1: 0.646188  v_AUC: 0.888499
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.257685    reg_loss: 0.247684    l2_loss: 0.020634    loss: 0.526002
steps 6800    v_Prec: 0.646943  v_Recall: 0.653525  v_F1: 0.650217  v_AUC: 0.888603
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.255959    reg_loss: 0.239196    l2_loss: 0.020827    loss: 0.515981
steps 7000    v_Prec: 0.627519  v_Recall: 0.675701  v_F1: 0.650720  v_AUC: 0.890524
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.254941    reg_loss: 0.238359    l2_loss: 0.020988    loss: 0.514288
steps 7200    v_Prec: 0.647254  v_Recall: 0.666958  v_F1: 0.656958  v_AUC: 0.891510
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.249899    reg_loss: 0.232157    l2_loss: 0.021269    loss: 0.503325
steps 7400    v_Prec: 0.623965  v_Recall: 0.682537  v_F1: 0.651938  v_AUC: 0.891512
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.245255    reg_loss: 0.228135    l2_loss: 0.021335    loss: 0.494726
steps 7600    v_Prec: 0.643266  v_Recall: 0.670058  v_F1: 0.656389  v_AUC: 0.891392
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.254413    reg_loss: 0.226315    l2_loss: 0.021521    loss: 0.502250
steps 7800    v_Prec: 0.658047  v_Recall: 0.661394  v_F1: 0.659716  v_AUC: 0.893084
steps 7800    running time 290 seconds

steps 8000    base_loss: 0.262523    reg_loss: 0.229494    l2_loss: 0.021659    loss: 0.513676
steps 8000    v_Prec: 0.656245  v_Recall: 0.667356  v_F1: 0.661754  v_AUC: 0.895535
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.251509    reg_loss: 0.220583    l2_loss: 0.021925    loss: 0.494017
steps 8200    v_Prec: 0.619164  v_Recall: 0.707257  v_F1: 0.660285  v_AUC: 0.897151
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.251754    reg_loss: 0.223596    l2_loss: 0.022202    loss: 0.497552
steps 8400    v_Prec: 0.638372  v_Recall: 0.686829  v_F1: 0.661715  v_AUC: 0.898224
steps 8400    running time 309 seconds

steps 8600    base_loss: 0.260793    reg_loss: 0.220617    l2_loss: 0.022354    loss: 0.503764
steps 8600    v_Prec: 0.633307  v_Recall: 0.699150  v_F1: 0.664601  v_AUC: 0.898692
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.261590    reg_loss: 0.218252    l2_loss: 0.022475    loss: 0.502316
steps 8800    v_Prec: 0.658172  v_Recall: 0.679517  v_F1: 0.668674  v_AUC: 0.900166
steps 8800    running time 322 seconds

steps 9000    base_loss: 0.251030    reg_loss: 0.213209    l2_loss: 0.022771    loss: 0.487010
steps 9000    v_Prec: 0.650853  v_Recall: 0.688101  v_F1: 0.668959  v_AUC: 0.901857
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.261016    reg_loss: 0.216205    l2_loss: 0.022836    loss: 0.500057
steps 9200    v_Prec: 0.644098  v_Recall: 0.695652  v_F1: 0.668883  v_AUC: 0.902811
steps 9200    running time 335 seconds

steps 9400    base_loss: 0.252302    reg_loss: 0.210406    l2_loss: 0.022990    loss: 0.485698
steps 9400    v_Prec: 0.640046  v_Recall: 0.702011  v_F1: 0.669598  v_AUC: 0.902473
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.255288    reg_loss: 0.207704    l2_loss: 0.023226    loss: 0.486218
steps 9600    v_Prec: 0.649794  v_Recall: 0.690804  v_F1: 0.669672  v_AUC: 0.904698
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.254803    reg_loss: 0.207921    l2_loss: 0.023270    loss: 0.485995
steps 9800    v_Prec: 0.644322  v_Recall: 0.694460  v_F1: 0.668452  v_AUC: 0.905136
steps 9800    running time 355 seconds

steps 10000    base_loss: 0.255453    reg_loss: 0.207489    l2_loss: 0.023545    loss: 0.486488
steps 10000    v_Prec: 0.654714  v_Recall: 0.692234  v_F1: 0.672951  v_AUC: 0.906608
steps 10000    running time 361 seconds

steps 10200    base_loss: 0.247892    reg_loss: 0.202637    l2_loss: 0.023610    loss: 0.474138
steps 10200    v_Prec: 0.641877  v_Recall: 0.710039  v_F1: 0.674240  v_AUC: 0.907415
steps 10200    running time 368 seconds

steps 10400    base_loss: 0.255119    reg_loss: 0.202847    l2_loss: 0.023657    loss: 0.481623
steps 10400    v_Prec: 0.659539  v_Recall: 0.688896  v_F1: 0.673898  v_AUC: 0.908786
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.253698    reg_loss: 0.200911    l2_loss: 0.023803    loss: 0.478412
steps 10600    v_Prec: 0.639635  v_Recall: 0.719100  v_F1: 0.677044  v_AUC: 0.909305
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.244588    reg_loss: 0.197148    l2_loss: 0.023844    loss: 0.465580
steps 10800    v_Prec: 0.641624  v_Recall: 0.714808  v_F1: 0.676242  v_AUC: 0.906771
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.191499    reg_loss: 0.187780    l2_loss: 0.023877    loss: 0.403156
steps 11000    v_Prec: 0.663447  v_Recall: 0.682537  v_F1: 0.672857  v_AUC: 0.904092
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.187218    reg_loss: 0.186942    l2_loss: 0.023918    loss: 0.398078
steps 11200    v_Prec: 0.658674  v_Recall: 0.679040  v_F1: 0.668702  v_AUC: 0.904375
steps 11200    running time 399 seconds

steps 11400    base_loss: 0.191824    reg_loss: 0.191687    l2_loss: 0.023754    loss: 0.407265
steps 11400    v_Prec: 0.662847  v_Recall: 0.675860  v_F1: 0.669290  v_AUC: 0.903163
steps 11400    running time 405 seconds

steps 11600    base_loss: 0.190116    reg_loss: 0.187715    l2_loss: 0.023640    loss: 0.401470
steps 11600    v_Prec: 0.650933  v_Recall: 0.696050  v_F1: 0.672736  v_AUC: 0.903915
steps 11600    running time 412 seconds

steps 11800    base_loss: 0.187082    reg_loss: 0.189172    l2_loss: 0.023589    loss: 0.399843
steps 11800    v_Prec: 0.656690  v_Recall: 0.685399  v_F1: 0.670737  v_AUC: 0.905127
steps 11800    running time 418 seconds

steps 12000    base_loss: 0.191654    reg_loss: 0.188499    l2_loss: 0.023553    loss: 0.403706
steps 12000    v_Prec: 0.657953  v_Recall: 0.680232  v_F1: 0.668907  v_AUC: 0.902693
steps 12000    running time 424 seconds

steps 12200    base_loss: 0.193926    reg_loss: 0.190514    l2_loss: 0.023509    loss: 0.407950
steps 12200    v_Prec: 0.656858  v_Recall: 0.681345  v_F1: 0.668878  v_AUC: 0.903445
steps 12200    running time 430 seconds

steps 12400    base_loss: 0.195409    reg_loss: 0.192531    l2_loss: 0.023438    loss: 0.411378
steps 12400    v_Prec: 0.642031  v_Recall: 0.692552  v_F1: 0.666335  v_AUC: 0.901721
steps 12400    running time 437 seconds

steps 12600    base_loss: 0.203018    reg_loss: 0.196450    l2_loss: 0.023515    loss: 0.422984
steps 12600    v_Prec: 0.662177  v_Recall: 0.672125  v_F1: 0.667114  v_AUC: 0.903021
steps 12600    running time 443 seconds

Early stop model F1: 0.677044
testing thre: 0.31521073
testing Prec: 0.400315228540692
testing Recall: 0.7776913730255164
testing F1: 0.5285567997885906
testing AUC: 0.8554113297690306
overall running time 445 seconds
(0.5506188229008993, 0.6011178614823816, 0.5747612519459999, 0.8554113297690306, 0.70435035)

2019-02-24 02:08:59.359649: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:08:59.622691: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:08:59.623597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:08:59.623631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 25.020000 seconds
loading data in 31.150000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.101412    reg_loss: 0.649497    l2_loss: 0.013371    loss: 1.764280
steps 200    v_Prec: 0.162649  v_Recall: 0.999840  v_F1: 0.279784  v_AUC: 0.473134
steps 200    running time 41 seconds

steps 400    base_loss: 0.754327    reg_loss: 0.645527    l2_loss: 0.013569    loss: 1.413423
steps 400    v_Prec: 0.162748  v_Recall: 0.999438  v_F1: 0.279914  v_AUC: 0.492750
steps 400    running time 48 seconds

steps 600    base_loss: 0.504281    reg_loss: 0.635399    l2_loss: 0.013724    loss: 1.153403
steps 600    v_Prec: 0.162644  v_Recall: 1.000000  v_F1: 0.279782  v_AUC: 0.455075
steps 600    running time 55 seconds

steps 800    base_loss: 0.476222    reg_loss: 0.615098    l2_loss: 0.013534    loss: 1.104854
steps 800    v_Prec: 0.162639  v_Recall: 1.000000  v_F1: 0.279776  v_AUC: 0.456244
steps 800    running time 61 seconds

steps 1000    base_loss: 0.466947    reg_loss: 0.585789    l2_loss: 0.013312    loss: 1.066048
steps 1000    v_Prec: 0.162639  v_Recall: 1.000000  v_F1: 0.279776  v_AUC: 0.423320
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.462862    reg_loss: 0.554834    l2_loss: 0.013110    loss: 1.030807
steps 1200    v_Prec: 0.208403  v_Recall: 0.528440  v_F1: 0.298920  v_AUC: 0.593045
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.454005    reg_loss: 0.525467    l2_loss: 0.012959    loss: 0.992431
steps 1400    v_Prec: 0.249172  v_Recall: 0.573686  v_F1: 0.347440  v_AUC: 0.661034
steps 1400    running time 81 seconds

steps 1600    base_loss: 0.439921    reg_loss: 0.499310    l2_loss: 0.012932    loss: 0.952163
steps 1600    v_Prec: 0.288069  v_Recall: 0.577617  v_F1: 0.384420  v_AUC: 0.710653
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.420294    reg_loss: 0.477353    l2_loss: 0.013101    loss: 0.910748
steps 1800    v_Prec: 0.372356  v_Recall: 0.519775  v_F1: 0.433886  v_AUC: 0.759039
steps 1800    running time 94 seconds

steps 2000    base_loss: 0.407029    reg_loss: 0.462559    l2_loss: 0.013307    loss: 0.882896
steps 2000    v_Prec: 0.376950  v_Recall: 0.596951  v_F1: 0.462102  v_AUC: 0.783442
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.383419    reg_loss: 0.446645    l2_loss: 0.013524    loss: 0.843587
steps 2200    v_Prec: 0.438107  v_Recall: 0.590293  v_F1: 0.502939  v_AUC: 0.805963
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.371690    reg_loss: 0.433029    l2_loss: 0.013776    loss: 0.818496
steps 2400    v_Prec: 0.430007  v_Recall: 0.631849  v_F1: 0.511744  v_AUC: 0.816940
steps 2400    running time 114 seconds

steps 2600    base_loss: 0.361400    reg_loss: 0.420411    l2_loss: 0.014020    loss: 0.795832
steps 2600    v_Prec: 0.423093  v_Recall: 0.658484  v_F1: 0.515173  v_AUC: 0.825104
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.348422    reg_loss: 0.405905    l2_loss: 0.014239    loss: 0.768566
steps 2800    v_Prec: 0.472067  v_Recall: 0.641957  v_F1: 0.544058  v_AUC: 0.837864
steps 2800    running time 127 seconds

steps 3000    base_loss: 0.350631    reg_loss: 0.395600    l2_loss: 0.014493    loss: 0.760724
steps 3000    v_Prec: 0.483203  v_Recall: 0.653109  v_F1: 0.555453  v_AUC: 0.844191
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.350257    reg_loss: 0.382992    l2_loss: 0.014766    loss: 0.748015
steps 3200    v_Prec: 0.506385  v_Recall: 0.620377  v_F1: 0.557615  v_AUC: 0.847983
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.342179    reg_loss: 0.371288    l2_loss: 0.015103    loss: 0.728570
steps 3400    v_Prec: 0.504589  v_Recall: 0.643883  v_F1: 0.565789  v_AUC: 0.849956
steps 3400    running time 147 seconds

steps 3600    base_loss: 0.340142    reg_loss: 0.360697    l2_loss: 0.015340    loss: 0.716179
steps 3600    v_Prec: 0.507835  v_Recall: 0.662976  v_F1: 0.575127  v_AUC: 0.854660
steps 3600    running time 154 seconds

steps 3800    base_loss: 0.335308    reg_loss: 0.347984    l2_loss: 0.015616    loss: 0.698908
steps 3800    v_Prec: 0.524338  v_Recall: 0.633454  v_F1: 0.573754  v_AUC: 0.856406
steps 3800    running time 161 seconds

steps 4000    base_loss: 0.334253    reg_loss: 0.335981    l2_loss: 0.015880    loss: 0.686114
steps 4000    v_Prec: 0.546579  v_Recall: 0.613317  v_F1: 0.578028  v_AUC: 0.857188
steps 4000    running time 167 seconds

steps 4200    base_loss: 0.321377    reg_loss: 0.319172    l2_loss: 0.016165    loss: 0.656714
steps 4200    v_Prec: 0.536752  v_Recall: 0.641476  v_F1: 0.584460  v_AUC: 0.862346
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.323763    reg_loss: 0.312846    l2_loss: 0.016507    loss: 0.653116
steps 4400    v_Prec: 0.544976  v_Recall: 0.631849  v_F1: 0.585206  v_AUC: 0.863363
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.330864    reg_loss: 0.306650    l2_loss: 0.017007    loss: 0.654521
steps 4600    v_Prec: 0.549450  v_Recall: 0.640915  v_F1: 0.591668  v_AUC: 0.864408
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.327596    reg_loss: 0.295221    l2_loss: 0.017256    loss: 0.640073
steps 4800    v_Prec: 0.537339  v_Recall: 0.652868  v_F1: 0.589497  v_AUC: 0.863536
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.322960    reg_loss: 0.282797    l2_loss: 0.017692    loss: 0.623449
steps 5000    v_Prec: 0.545086  v_Recall: 0.647413  v_F1: 0.591859  v_AUC: 0.864077
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.315721    reg_loss: 0.271982    l2_loss: 0.018095    loss: 0.605799
steps 5200    v_Prec: 0.570751  v_Recall: 0.617409  v_F1: 0.593164  v_AUC: 0.864735
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.325360    reg_loss: 0.264511    l2_loss: 0.018501    loss: 0.608373
steps 5400    v_Prec: 0.544808  v_Recall: 0.657922  v_F1: 0.596046  v_AUC: 0.863070
steps 5400    running time 215 seconds

steps 5600    base_loss: 0.290264    reg_loss: 0.231831    l2_loss: 0.018827    loss: 0.540921
steps 5600    v_Prec: 0.552605  v_Recall: 0.649338  v_F1: 0.597079  v_AUC: 0.860302
steps 5600    running time 222 seconds

steps 5800    base_loss: 0.288764    reg_loss: 0.226833    l2_loss: 0.018976    loss: 0.534573
steps 5800    v_Prec: 0.552437  v_Recall: 0.642760  v_F1: 0.594186  v_AUC: 0.856466
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.298477    reg_loss: 0.230661    l2_loss: 0.019003    loss: 0.548141
steps 6000    v_Prec: 0.553038  v_Recall: 0.646209  v_F1: 0.596004  v_AUC: 0.862539
steps 6000    running time 235 seconds

steps 6200    base_loss: 0.283153    reg_loss: 0.221777    l2_loss: 0.019231    loss: 0.524161
steps 6200    v_Prec: 0.556295  v_Recall: 0.657601  v_F1: 0.602721  v_AUC: 0.864652
steps 6200    running time 241 seconds

steps 6400    base_loss: 0.292204    reg_loss: 0.219763    l2_loss: 0.019309    loss: 0.531276
steps 6400    v_Prec: 0.565850  v_Recall: 0.642840  v_F1: 0.601893  v_AUC: 0.865477
steps 6400    running time 248 seconds

steps 6600    base_loss: 0.291625    reg_loss: 0.216464    l2_loss: 0.019526    loss: 0.527614
steps 6600    v_Prec: 0.564361  v_Recall: 0.647894  v_F1: 0.603249  v_AUC: 0.866446
steps 6600    running time 254 seconds

steps 6800    base_loss: 0.289480    reg_loss: 0.212662    l2_loss: 0.019688    loss: 0.521831
steps 6800    v_Prec: 0.561045  v_Recall: 0.651424  v_F1: 0.602866  v_AUC: 0.866611
steps 6800    running time 261 seconds

steps 7000    base_loss: 0.292710    reg_loss: 0.212256    l2_loss: 0.019798    loss: 0.524764
steps 7000    v_Prec: 0.568444  v_Recall: 0.643963  v_F1: 0.603852  v_AUC: 0.866608
steps 7000    running time 267 seconds

steps 7200    base_loss: 0.294802    reg_loss: 0.211289    l2_loss: 0.019828    loss: 0.525919
steps 7200    v_Prec: 0.567856  v_Recall: 0.666667  v_F1: 0.613307  v_AUC: 0.869759
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.292283    reg_loss: 0.207886    l2_loss: 0.019832    loss: 0.520001
steps 7400    v_Prec: 0.591945  v_Recall: 0.635540  v_F1: 0.612968  v_AUC: 0.871595
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.295361    reg_loss: 0.207033    l2_loss: 0.019970    loss: 0.522364
steps 7600    v_Prec: 0.559819  v_Recall: 0.684717  v_F1: 0.616001  v_AUC: 0.871971
steps 7600    running time 287 seconds

steps 7800    base_loss: 0.285460    reg_loss: 0.198162    l2_loss: 0.020203    loss: 0.503825
steps 7800    v_Prec: 0.556466  v_Recall: 0.680706  v_F1: 0.612348  v_AUC: 0.875051
steps 7800    running time 294 seconds

steps 8000    base_loss: 0.292828    reg_loss: 0.203078    l2_loss: 0.020310    loss: 0.516215
steps 8000    v_Prec: 0.581514  v_Recall: 0.649579  v_F1: 0.613665  v_AUC: 0.871919
steps 8000    running time 300 seconds

steps 8200    base_loss: 0.295624    reg_loss: 0.201097    l2_loss: 0.020434    loss: 0.517155
steps 8200    v_Prec: 0.587888  v_Recall: 0.647172  v_F1: 0.616107  v_AUC: 0.872897
steps 8200    running time 306 seconds

steps 8400    base_loss: 0.289196    reg_loss: 0.196803    l2_loss: 0.020520    loss: 0.506519
steps 8400    v_Prec: 0.563293  v_Recall: 0.676855  v_F1: 0.614874  v_AUC: 0.876269
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.293973    reg_loss: 0.197488    l2_loss: 0.020530    loss: 0.511991
steps 8600    v_Prec: 0.559829  v_Recall: 0.694745  v_F1: 0.620033  v_AUC: 0.878026
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.288403    reg_loss: 0.194137    l2_loss: 0.020563    loss: 0.503103
steps 8800    v_Prec: 0.571037  v_Recall: 0.685840  v_F1: 0.623196  v_AUC: 0.877761
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.290874    reg_loss: 0.191920    l2_loss: 0.020662    loss: 0.503456
steps 9000    v_Prec: 0.605724  v_Recall: 0.643482  v_F1: 0.624032  v_AUC: 0.875106
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.291587    reg_loss: 0.189952    l2_loss: 0.020661    loss: 0.502199
steps 9200    v_Prec: 0.572369  v_Recall: 0.683353  v_F1: 0.622957  v_AUC: 0.877803
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.294756    reg_loss: 0.190263    l2_loss: 0.020671    loss: 0.505690
steps 9400    v_Prec: 0.579363  v_Recall: 0.676133  v_F1: 0.624019  v_AUC: 0.879563
steps 9400    running time 346 seconds

steps 9600    base_loss: 0.289527    reg_loss: 0.185968    l2_loss: 0.020633    loss: 0.496127
steps 9600    v_Prec: 0.582569  v_Recall: 0.683193  v_F1: 0.628882  v_AUC: 0.881721
steps 9600    running time 352 seconds

steps 9800    base_loss: 0.288567    reg_loss: 0.184346    l2_loss: 0.020753    loss: 0.493666
steps 9800    v_Prec: 0.580537  v_Recall: 0.680064  v_F1: 0.626372  v_AUC: 0.881158
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.292362    reg_loss: 0.186303    l2_loss: 0.020748    loss: 0.499413
steps 10000    v_Prec: 0.576688  v_Recall: 0.687445  v_F1: 0.627214  v_AUC: 0.880466
steps 10000    running time 365 seconds

steps 10200    base_loss: 0.294871    reg_loss: 0.184264    l2_loss: 0.020880    loss: 0.500015
steps 10200    v_Prec: 0.590687  v_Recall: 0.670678  v_F1: 0.628146  v_AUC: 0.881736
steps 10200    running time 371 seconds

steps 10400    base_loss: 0.287253    reg_loss: 0.182605    l2_loss: 0.020884    loss: 0.490742
steps 10400    v_Prec: 0.596676  v_Recall: 0.662495  v_F1: 0.627865  v_AUC: 0.884172
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.287707    reg_loss: 0.179486    l2_loss: 0.020940    loss: 0.488134
steps 10600    v_Prec: 0.564366  v_Recall: 0.709747  v_F1: 0.628762  v_AUC: 0.883141
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.284411    reg_loss: 0.180878    l2_loss: 0.020872    loss: 0.486161
steps 10800    v_Prec: 0.598719  v_Recall: 0.667308  v_F1: 0.631156  v_AUC: 0.880097
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.240757    reg_loss: 0.162279    l2_loss: 0.020999    loss: 0.424034
steps 11000    v_Prec: 0.604066  v_Recall: 0.650782  v_F1: 0.626554  v_AUC: 0.876697
steps 11000    running time 397 seconds

steps 11200    base_loss: 0.246884    reg_loss: 0.168975    l2_loss: 0.021032    loss: 0.436891
steps 11200    v_Prec: 0.619419  v_Recall: 0.630004  v_F1: 0.624667  v_AUC: 0.875634
steps 11200    running time 403 seconds

steps 11400    base_loss: 0.256436    reg_loss: 0.175094    l2_loss: 0.021128    loss: 0.452658
steps 11400    v_Prec: 0.596725  v_Recall: 0.663698  v_F1: 0.628433  v_AUC: 0.874252
steps 11400    running time 409 seconds

steps 11600    base_loss: 0.242131    reg_loss: 0.163945    l2_loss: 0.021135    loss: 0.427211
steps 11600    v_Prec: 0.584445  v_Recall: 0.674609  v_F1: 0.626299  v_AUC: 0.875244
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.241386    reg_loss: 0.167695    l2_loss: 0.020977    loss: 0.430058
steps 11800    v_Prec: 0.629121  v_Recall: 0.639872  v_F1: 0.634451  v_AUC: 0.879147
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.245447    reg_loss: 0.164122    l2_loss: 0.021120    loss: 0.430689
steps 12000    v_Prec: 0.587841  v_Recall: 0.675652  v_F1: 0.628695  v_AUC: 0.873805
steps 12000    running time 428 seconds

steps 12200    base_loss: 0.243666    reg_loss: 0.163776    l2_loss: 0.021083    loss: 0.428525
steps 12200    v_Prec: 0.588190  v_Recall: 0.680064  v_F1: 0.630800  v_AUC: 0.877833
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.250431    reg_loss: 0.170555    l2_loss: 0.021096    loss: 0.442082
steps 12400    v_Prec: 0.617115  v_Recall: 0.640433  v_F1: 0.628558  v_AUC: 0.877872
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.247919    reg_loss: 0.169300    l2_loss: 0.021042    loss: 0.438261
steps 12600    v_Prec: 0.598646  v_Recall: 0.666988  v_F1: 0.630972  v_AUC: 0.878264
steps 12600    running time 446 seconds

steps 12800    base_loss: 0.242878    reg_loss: 0.166004    l2_loss: 0.021111    loss: 0.429993
steps 12800    v_Prec: 0.606016  v_Recall: 0.657842  v_F1: 0.630866  v_AUC: 0.879654
steps 12800    running time 452 seconds

steps 13000    base_loss: 0.249897    reg_loss: 0.170757    l2_loss: 0.021287    loss: 0.441941
steps 13000    v_Prec: 0.597119  v_Recall: 0.668351  v_F1: 0.630730  v_AUC: 0.882908
steps 13000    running time 458 seconds

steps 13200    base_loss: 0.256667    reg_loss: 0.171675    l2_loss: 0.021060    loss: 0.449401
steps 13200    v_Prec: 0.606231  v_Recall: 0.657200  v_F1: 0.630688  v_AUC: 0.879599
steps 13200    running time 464 seconds

steps 13400    base_loss: 0.252060    reg_loss: 0.168200    l2_loss: 0.021104    loss: 0.441364
steps 13400    v_Prec: 0.586351  v_Recall: 0.676855  v_F1: 0.628361  v_AUC: 0.881925
steps 13400    running time 470 seconds

steps 13600    base_loss: 0.251052    reg_loss: 0.165578    l2_loss: 0.021073    loss: 0.437703
steps 13600    v_Prec: 0.634367  v_Recall: 0.625511  v_F1: 0.629908  v_AUC: 0.881779
steps 13600    running time 476 seconds

steps 13800    base_loss: 0.252040    reg_loss: 0.165498    l2_loss: 0.021041    loss: 0.438579
steps 13800    v_Prec: 0.610098  v_Recall: 0.652387  v_F1: 0.630534  v_AUC: 0.881568
steps 13800    running time 482 seconds

Early stop model F1: 0.634451
testing thre: 0.37162977
testing Prec: 0.3781615415382444
testing Recall: 0.7811907654921021
testing F1: 0.5096230064364755
testing AUC: 0.8371419083690381
overall running time 485 seconds
(0.5275548181695888, 0.5718104495747266, 0.5487918649127718, 0.8371419083690381, 0.7307165)

2019-02-24 02:14:35.288766: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:14:35.792735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:14:35.793629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:14:35.793661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.140000 seconds
loading data in 29.490000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.007613    reg_loss: 0.647909    l2_loss: 0.013403    loss: 1.668925
steps 200    v_Prec: 0.165410  v_Recall: 1.000000  v_F1: 0.283865  v_AUC: 0.480047
steps 200    running time 39 seconds

steps 400    base_loss: 0.682779    reg_loss: 0.643582    l2_loss: 0.013570    loss: 1.339931
steps 400    v_Prec: 0.165405  v_Recall: 1.000000  v_F1: 0.283859  v_AUC: 0.466826
steps 400    running time 46 seconds

steps 600    base_loss: 0.494670    reg_loss: 0.633919    l2_loss: 0.013574    loss: 1.142163
steps 600    v_Prec: 0.165405  v_Recall: 1.000000  v_F1: 0.283859  v_AUC: 0.451247
steps 600    running time 52 seconds

steps 800    base_loss: 0.482218    reg_loss: 0.612064    l2_loss: 0.013395    loss: 1.107677
steps 800    v_Prec: 0.165405  v_Recall: 1.000000  v_F1: 0.283859  v_AUC: 0.438293
steps 800    running time 58 seconds

steps 1000    base_loss: 0.469370    reg_loss: 0.583149    l2_loss: 0.013181    loss: 1.065699
steps 1000    v_Prec: 0.165425  v_Recall: 0.999842  v_F1: 0.283881  v_AUC: 0.493374
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.454761    reg_loss: 0.548887    l2_loss: 0.013051    loss: 1.016699
steps 1200    v_Prec: 0.231507  v_Recall: 0.481660  v_F1: 0.312711  v_AUC: 0.611664
steps 1200    running time 71 seconds

steps 1400    base_loss: 0.444240    reg_loss: 0.520321    l2_loss: 0.012990    loss: 0.977552
steps 1400    v_Prec: 0.282587  v_Recall: 0.546896  v_F1: 0.372632  v_AUC: 0.689067
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.434665    reg_loss: 0.499508    l2_loss: 0.013042    loss: 0.947215
steps 1600    v_Prec: 0.357065  v_Recall: 0.519445  v_F1: 0.423214  v_AUC: 0.734907
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.410744    reg_loss: 0.476543    l2_loss: 0.013248    loss: 0.900535
steps 1800    v_Prec: 0.415036  v_Recall: 0.496884  v_F1: 0.452287  v_AUC: 0.766067
steps 1800    running time 91 seconds

steps 2000    base_loss: 0.398836    reg_loss: 0.463674    l2_loss: 0.013362    loss: 0.875872
steps 2000    v_Prec: 0.450889  v_Recall: 0.540270  v_F1: 0.491549  v_AUC: 0.792709
steps 2000    running time 98 seconds

steps 2200    base_loss: 0.384106    reg_loss: 0.449774    l2_loss: 0.013671    loss: 0.847552
steps 2200    v_Prec: 0.464290  v_Recall: 0.574347  v_F1: 0.513488  v_AUC: 0.805192
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.374352    reg_loss: 0.437346    l2_loss: 0.013863    loss: 0.825561
steps 2400    v_Prec: 0.496266  v_Recall: 0.587126  v_F1: 0.537886  v_AUC: 0.819766
steps 2400    running time 111 seconds

steps 2600    base_loss: 0.365428    reg_loss: 0.423588    l2_loss: 0.014074    loss: 0.803090
steps 2600    v_Prec: 0.511167  v_Recall: 0.608425  v_F1: 0.555572  v_AUC: 0.833734
steps 2600    running time 118 seconds

steps 2800    base_loss: 0.352701    reg_loss: 0.407983    l2_loss: 0.014277    loss: 0.774962
steps 2800    v_Prec: 0.540166  v_Recall: 0.599905  v_F1: 0.568471  v_AUC: 0.840302
steps 2800    running time 125 seconds

steps 3000    base_loss: 0.346677    reg_loss: 0.395487    l2_loss: 0.014481    loss: 0.756644
steps 3000    v_Prec: 0.567638  v_Recall: 0.600773  v_F1: 0.583736  v_AUC: 0.846062
steps 3000    running time 132 seconds

steps 3200    base_loss: 0.350788    reg_loss: 0.387331    l2_loss: 0.014621    loss: 0.752740
steps 3200    v_Prec: 0.546698  v_Recall: 0.633510  v_F1: 0.586911  v_AUC: 0.849210
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.343313    reg_loss: 0.373036    l2_loss: 0.014880    loss: 0.731228
steps 3400    v_Prec: 0.526112  v_Recall: 0.654808  v_F1: 0.583448  v_AUC: 0.850395
steps 3400    running time 145 seconds

steps 3600    base_loss: 0.340053    reg_loss: 0.359229    l2_loss: 0.015201    loss: 0.714483
steps 3600    v_Prec: 0.586627  v_Recall: 0.595882  v_F1: 0.591219  v_AUC: 0.854922
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.333693    reg_loss: 0.344663    l2_loss: 0.015454    loss: 0.693811
steps 3800    v_Prec: 0.575223  v_Recall: 0.621914  v_F1: 0.597658  v_AUC: 0.856373
steps 3800    running time 158 seconds

steps 4000    base_loss: 0.335303    reg_loss: 0.334334    l2_loss: 0.015790    loss: 0.685426
steps 4000    v_Prec: 0.555139  v_Recall: 0.654414  v_F1: 0.600702  v_AUC: 0.857752
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.336326    reg_loss: 0.323034    l2_loss: 0.016047    loss: 0.675408
steps 4200    v_Prec: 0.567477  v_Recall: 0.639189  v_F1: 0.601202  v_AUC: 0.857946
steps 4200    running time 171 seconds

steps 4400    base_loss: 0.329520    reg_loss: 0.311940    l2_loss: 0.016378    loss: 0.657838
steps 4400    v_Prec: 0.577978  v_Recall: 0.643449  v_F1: 0.608959  v_AUC: 0.861993
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.334560    reg_loss: 0.300252    l2_loss: 0.016698    loss: 0.651510
steps 4600    v_Prec: 0.549260  v_Recall: 0.673740  v_F1: 0.605165  v_AUC: 0.861031
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.330028    reg_loss: 0.286609    l2_loss: 0.016973    loss: 0.633610
steps 4800    v_Prec: 0.559925  v_Recall: 0.655991  v_F1: 0.604163  v_AUC: 0.861838
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.332356    reg_loss: 0.278941    l2_loss: 0.017348    loss: 0.628645
steps 5000    v_Prec: 0.590769  v_Recall: 0.633036  v_F1: 0.611172  v_AUC: 0.866148
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.327302    reg_loss: 0.267169    l2_loss: 0.017700    loss: 0.612171
steps 5200    v_Prec: 0.560087  v_Recall: 0.672793  v_F1: 0.611288  v_AUC: 0.865754
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.323450    reg_loss: 0.258052    l2_loss: 0.018067    loss: 0.599569
steps 5400    v_Prec: 0.579360  v_Recall: 0.653625  v_F1: 0.614256  v_AUC: 0.866625
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.303597    reg_loss: 0.226726    l2_loss: 0.018380    loss: 0.548703
steps 5600    v_Prec: 0.533608  v_Recall: 0.705135  v_F1: 0.607496  v_AUC: 0.861688
steps 5600    running time 218 seconds

steps 5800    base_loss: 0.300044    reg_loss: 0.223326    l2_loss: 0.018626    loss: 0.541996
steps 5800    v_Prec: 0.531295  v_Recall: 0.699061  v_F1: 0.603740  v_AUC: 0.862582
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.298323    reg_loss: 0.218025    l2_loss: 0.018868    loss: 0.535215
steps 6000    v_Prec: 0.535027  v_Recall: 0.697641  v_F1: 0.605608  v_AUC: 0.862335
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.308209    reg_loss: 0.217932    l2_loss: 0.019066    loss: 0.545208
steps 6200    v_Prec: 0.545478  v_Recall: 0.680287  v_F1: 0.605469  v_AUC: 0.860745
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.302222    reg_loss: 0.213793    l2_loss: 0.019177    loss: 0.535192
steps 6400    v_Prec: 0.537619  v_Recall: 0.700639  v_F1: 0.608398  v_AUC: 0.864373
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.303703    reg_loss: 0.216121    l2_loss: 0.019336    loss: 0.539159
steps 6600    v_Prec: 0.560253  v_Recall: 0.678473  v_F1: 0.613722  v_AUC: 0.866350
steps 6600    running time 249 seconds

steps 6800    base_loss: 0.310953    reg_loss: 0.212523    l2_loss: 0.019588    loss: 0.543063
steps 6800    v_Prec: 0.565063  v_Recall: 0.677211  v_F1: 0.616075  v_AUC: 0.865988
steps 6800    running time 255 seconds

steps 7000    base_loss: 0.309333    reg_loss: 0.204966    l2_loss: 0.019778    loss: 0.534077
steps 7000    v_Prec: 0.551141  v_Recall: 0.699219  v_F1: 0.616412  v_AUC: 0.869398
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.301588    reg_loss: 0.204632    l2_loss: 0.019908    loss: 0.526128
steps 7200    v_Prec: 0.549743  v_Recall: 0.692198  v_F1: 0.612801  v_AUC: 0.867031
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.294942    reg_loss: 0.198725    l2_loss: 0.019969    loss: 0.513635
steps 7400    v_Prec: 0.591970  v_Recall: 0.644316  v_F1: 0.617035  v_AUC: 0.865864
steps 7400    running time 274 seconds

steps 7600    base_loss: 0.301902    reg_loss: 0.201492    l2_loss: 0.020214    loss: 0.523609
steps 7600    v_Prec: 0.573988  v_Recall: 0.669796  v_F1: 0.618202  v_AUC: 0.862340
steps 7600    running time 281 seconds

steps 7800    base_loss: 0.303171    reg_loss: 0.194945    l2_loss: 0.020313    loss: 0.518430
steps 7800    v_Prec: 0.551914  v_Recall: 0.705293  v_F1: 0.619247  v_AUC: 0.866111
steps 7800    running time 288 seconds

steps 8000    base_loss: 0.304449    reg_loss: 0.196198    l2_loss: 0.020334    loss: 0.520981
steps 8000    v_Prec: 0.590310  v_Recall: 0.660251  v_F1: 0.623324  v_AUC: 0.867342
steps 8000    running time 294 seconds

steps 8200    base_loss: 0.307577    reg_loss: 0.195619    l2_loss: 0.020362    loss: 0.523558
steps 8200    v_Prec: 0.558014  v_Recall: 0.708291  v_F1: 0.624235  v_AUC: 0.871614
steps 8200    running time 301 seconds

steps 8400    base_loss: 0.305607    reg_loss: 0.191366    l2_loss: 0.020434    loss: 0.517407
steps 8400    v_Prec: 0.547256  v_Recall: 0.707975  v_F1: 0.617326  v_AUC: 0.866925
steps 8400    running time 307 seconds

steps 8600    base_loss: 0.300032    reg_loss: 0.189126    l2_loss: 0.020486    loss: 0.509645
steps 8600    v_Prec: 0.559876  v_Recall: 0.700718  v_F1: 0.622429  v_AUC: 0.871152
steps 8600    running time 313 seconds

steps 8800    base_loss: 0.309840    reg_loss: 0.190748    l2_loss: 0.020723    loss: 0.521311
steps 8800    v_Prec: 0.578134  v_Recall: 0.684941  v_F1: 0.627022  v_AUC: 0.863512
steps 8800    running time 319 seconds

steps 9000    base_loss: 0.301253    reg_loss: 0.184109    l2_loss: 0.020663    loss: 0.506025
steps 9000    v_Prec: 0.554605  v_Recall: 0.720675  v_F1: 0.626827  v_AUC: 0.869937
steps 9000    running time 326 seconds

steps 9200    base_loss: 0.304945    reg_loss: 0.186067    l2_loss: 0.020716    loss: 0.511728
steps 9200    v_Prec: 0.558114  v_Recall: 0.711367  v_F1: 0.625490  v_AUC: 0.871236
steps 9200    running time 333 seconds

steps 9400    base_loss: 0.307224    reg_loss: 0.183842    l2_loss: 0.020704    loss: 0.511770
steps 9400    v_Prec: 0.580031  v_Recall: 0.673188  v_F1: 0.623147  v_AUC: 0.873320
steps 9400    running time 339 seconds

steps 9600    base_loss: 0.300712    reg_loss: 0.182425    l2_loss: 0.020673    loss: 0.503810
steps 9600    v_Prec: 0.571641  v_Recall: 0.697405  v_F1: 0.628291  v_AUC: 0.868910
steps 9600    running time 345 seconds

steps 9800    base_loss: 0.302790    reg_loss: 0.176128    l2_loss: 0.020907    loss: 0.499824
steps 9800    v_Prec: 0.572791  v_Recall: 0.701428  v_F1: 0.630616  v_AUC: 0.876138
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.305368    reg_loss: 0.180959    l2_loss: 0.020846    loss: 0.507173
steps 10000    v_Prec: 0.542447  v_Recall: 0.738424  v_F1: 0.625443  v_AUC: 0.872138
steps 10000    running time 359 seconds

steps 10200    base_loss: 0.304025    reg_loss: 0.176128    l2_loss: 0.020790    loss: 0.500942
steps 10200    v_Prec: 0.563441  v_Recall: 0.708291  v_F1: 0.627617  v_AUC: 0.875939
steps 10200    running time 365 seconds

steps 10400    base_loss: 0.303147    reg_loss: 0.175563    l2_loss: 0.020947    loss: 0.499657
steps 10400    v_Prec: 0.558616  v_Recall: 0.718309  v_F1: 0.628477  v_AUC: 0.879209
steps 10400    running time 371 seconds

steps 10600    base_loss: 0.303602    reg_loss: 0.172823    l2_loss: 0.020998    loss: 0.497423
steps 10600    v_Prec: 0.559839  v_Recall: 0.714759  v_F1: 0.627884  v_AUC: 0.866502
steps 10600    running time 378 seconds

steps 10800    base_loss: 0.300592    reg_loss: 0.173036    l2_loss: 0.020940    loss: 0.494568
steps 10800    v_Prec: 0.564941  v_Recall: 0.708527  v_F1: 0.628639  v_AUC: 0.871492
steps 10800    running time 384 seconds

steps 11000    base_loss: 0.253525    reg_loss: 0.155521    l2_loss: 0.020788    loss: 0.429834
steps 11000    v_Prec: 0.567140  v_Recall: 0.683995  v_F1: 0.620110  v_AUC: 0.861777
steps 11000    running time 390 seconds

steps 11200    base_loss: 0.264840    reg_loss: 0.158663    l2_loss: 0.020660    loss: 0.444162
steps 11200    v_Prec: 0.555611  v_Recall: 0.703400  v_F1: 0.620831  v_AUC: 0.863482
steps 11200    running time 396 seconds

steps 11400    base_loss: 0.269230    reg_loss: 0.163168    l2_loss: 0.020591    loss: 0.452989
steps 11400    v_Prec: 0.546331  v_Recall: 0.711130  v_F1: 0.617931  v_AUC: 0.860593
steps 11400    running time 402 seconds

steps 11600    base_loss: 0.266121    reg_loss: 0.163861    l2_loss: 0.020525    loss: 0.450507
steps 11600    v_Prec: 0.551495  v_Recall: 0.692751  v_F1: 0.614104  v_AUC: 0.855828
steps 11600    running time 408 seconds

steps 11800    base_loss: 0.262444    reg_loss: 0.162964    l2_loss: 0.020648    loss: 0.446056
steps 11800    v_Prec: 0.555964  v_Recall: 0.691962  v_F1: 0.616552  v_AUC: 0.862816
steps 11800    running time 414 seconds

Early stop model F1: 0.630616
testing thre: 0.25426596
testing Prec: 0.3636696324420759
testing Recall: 0.772782503037667
testing F1: 0.4945875326614408
testing AUC: 0.8207840499780303
overall running time 417 seconds
(0.5050924509332517, 0.5616038882138518, 0.5318512381478412, 0.8207840499780303, 0.5338435)

2019-02-24 02:19:22.576402: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:19:23.382267: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:19:23.383160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:19:23.383196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.190000 seconds
loading data in 30.470000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.578479    reg_loss: 0.648263    l2_loss: 0.013340    loss: 1.240082
steps 200    v_Prec: 0.163958  v_Recall: 0.999920  v_F1: 0.281722  v_AUC: 0.500729
steps 200    running time 40 seconds

steps 400    base_loss: 0.499162    reg_loss: 0.641703    l2_loss: 0.013379    loss: 1.154244
steps 400    v_Prec: 0.163926  v_Recall: 1.000000  v_F1: 0.281678  v_AUC: 0.501347
steps 400    running time 47 seconds

steps 600    base_loss: 0.479535    reg_loss: 0.630201    l2_loss: 0.013302    loss: 1.123037
steps 600    v_Prec: 0.163922  v_Recall: 1.000000  v_F1: 0.281672  v_AUC: 0.507219
steps 600    running time 53 seconds

steps 800    base_loss: 0.461735    reg_loss: 0.610827    l2_loss: 0.013147    loss: 1.085709
steps 800    v_Prec: 0.187450  v_Recall: 0.750279  v_F1: 0.299959  v_AUC: 0.587113
steps 800    running time 59 seconds

steps 1000    base_loss: 0.453603    reg_loss: 0.585225    l2_loss: 0.012987    loss: 1.051815
steps 1000    v_Prec: 0.228160  v_Recall: 0.506448  v_F1: 0.314592  v_AUC: 0.620167
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.443978    reg_loss: 0.556478    l2_loss: 0.012858    loss: 1.013314
steps 1200    v_Prec: 0.253193  v_Recall: 0.516001  v_F1: 0.339701  v_AUC: 0.654112
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.438937    reg_loss: 0.532078    l2_loss: 0.012799    loss: 0.983814
steps 1400    v_Prec: 0.325056  v_Recall: 0.448097  v_F1: 0.376786  v_AUC: 0.691648
steps 1400    running time 79 seconds

steps 1600    base_loss: 0.415432    reg_loss: 0.510481    l2_loss: 0.012859    loss: 0.938771
steps 1600    v_Prec: 0.382876  v_Recall: 0.505493  v_F1: 0.435722  v_AUC: 0.750893
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.386317    reg_loss: 0.488481    l2_loss: 0.013012    loss: 0.887810
steps 1800    v_Prec: 0.445990  v_Recall: 0.515682  v_F1: 0.478311  v_AUC: 0.779756
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.365778    reg_loss: 0.474180    l2_loss: 0.013204    loss: 0.853162
steps 2000    v_Prec: 0.521522  v_Recall: 0.522767  v_F1: 0.522144  v_AUC: 0.810865
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.348367    reg_loss: 0.460126    l2_loss: 0.013415    loss: 0.821908
steps 2200    v_Prec: 0.532753  v_Recall: 0.550310  v_F1: 0.541389  v_AUC: 0.824857
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.343987    reg_loss: 0.452216    l2_loss: 0.013675    loss: 0.809879
steps 2400    v_Prec: 0.549024  v_Recall: 0.564321  v_F1: 0.556567  v_AUC: 0.835840
steps 2400    running time 112 seconds

steps 2600    base_loss: 0.337461    reg_loss: 0.439731    l2_loss: 0.013871    loss: 0.791063
steps 2600    v_Prec: 0.562021  v_Recall: 0.578172  v_F1: 0.569982  v_AUC: 0.844767
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.328969    reg_loss: 0.426539    l2_loss: 0.014121    loss: 0.769629
steps 2800    v_Prec: 0.544432  v_Recall: 0.635488  v_F1: 0.586446  v_AUC: 0.854131
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.332694    reg_loss: 0.418599    l2_loss: 0.014384    loss: 0.765677
steps 3000    v_Prec: 0.560300  v_Recall: 0.618373  v_F1: 0.587906  v_AUC: 0.858011
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.323992    reg_loss: 0.406187    l2_loss: 0.014595    loss: 0.744774
steps 3200    v_Prec: 0.578389  v_Recall: 0.616144  v_F1: 0.596670  v_AUC: 0.861698
steps 3200    running time 140 seconds

steps 3400    base_loss: 0.320534    reg_loss: 0.393299    l2_loss: 0.014858    loss: 0.728691
steps 3400    v_Prec: 0.585239  v_Recall: 0.617338  v_F1: 0.600860  v_AUC: 0.865091
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.315875    reg_loss: 0.379318    l2_loss: 0.015096    loss: 0.710289
steps 3600    v_Prec: 0.597301  v_Recall: 0.609616  v_F1: 0.603396  v_AUC: 0.865160
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.308340    reg_loss: 0.369902    l2_loss: 0.015433    loss: 0.693676
steps 3800    v_Prec: 0.593610  v_Recall: 0.634533  v_F1: 0.613390  v_AUC: 0.870946
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.315829    reg_loss: 0.361808    l2_loss: 0.015750    loss: 0.693387
steps 4000    v_Prec: 0.593635  v_Recall: 0.644483  v_F1: 0.618015  v_AUC: 0.874390
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.310282    reg_loss: 0.347943    l2_loss: 0.016015    loss: 0.674239
steps 4200    v_Prec: 0.596449  v_Recall: 0.649817  v_F1: 0.621990  v_AUC: 0.874902
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.310913    reg_loss: 0.337882    l2_loss: 0.016393    loss: 0.665189
steps 4400    v_Prec: 0.615575  v_Recall: 0.633657  v_F1: 0.624485  v_AUC: 0.876339
steps 4400    running time 179 seconds

steps 4600    base_loss: 0.308475    reg_loss: 0.329398    l2_loss: 0.016785    loss: 0.654658
steps 4600    v_Prec: 0.610309  v_Recall: 0.639070  v_F1: 0.624358  v_AUC: 0.877457
steps 4600    running time 186 seconds

steps 4800    base_loss: 0.306527    reg_loss: 0.317628    l2_loss: 0.017101    loss: 0.641256
steps 4800    v_Prec: 0.603365  v_Recall: 0.653797  v_F1: 0.627569  v_AUC: 0.877189
steps 4800    running time 192 seconds

steps 5000    base_loss: 0.306946    reg_loss: 0.308404    l2_loss: 0.017425    loss: 0.632775
steps 5000    v_Prec: 0.601730  v_Recall: 0.653558  v_F1: 0.626574  v_AUC: 0.878916
steps 5000    running time 198 seconds

steps 5200    base_loss: 0.301113    reg_loss: 0.297489    l2_loss: 0.017810    loss: 0.616412
steps 5200    v_Prec: 0.618982  v_Recall: 0.640662  v_F1: 0.629635  v_AUC: 0.880314
steps 5200    running time 205 seconds

steps 5400    base_loss: 0.301715    reg_loss: 0.288918    l2_loss: 0.018131    loss: 0.608764
steps 5400    v_Prec: 0.595766  v_Recall: 0.667569  v_F1: 0.629627  v_AUC: 0.882144
steps 5400    running time 211 seconds

steps 5600    base_loss: 0.259691    reg_loss: 0.253657    l2_loss: 0.018613    loss: 0.531960
steps 5600    v_Prec: 0.611081  v_Recall: 0.637399  v_F1: 0.623963  v_AUC: 0.873923
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.262343    reg_loss: 0.253252    l2_loss: 0.019144    loss: 0.534739
steps 5800    v_Prec: 0.611224  v_Recall: 0.645916  v_F1: 0.628091  v_AUC: 0.875398
steps 5800    running time 224 seconds

steps 6000    base_loss: 0.258613    reg_loss: 0.246362    l2_loss: 0.019591    loss: 0.524566
steps 6000    v_Prec: 0.612972  v_Recall: 0.640981  v_F1: 0.626664  v_AUC: 0.875911
steps 6000    running time 231 seconds

steps 6200    base_loss: 0.264165    reg_loss: 0.248281    l2_loss: 0.019982    loss: 0.532428
steps 6200    v_Prec: 0.629653  v_Recall: 0.634214  v_F1: 0.631925  v_AUC: 0.878768
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.265381    reg_loss: 0.245541    l2_loss: 0.020215    loss: 0.531138
steps 6400    v_Prec: 0.636111  v_Recall: 0.636921  v_F1: 0.636516  v_AUC: 0.883811
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.260849    reg_loss: 0.239311    l2_loss: 0.020569    loss: 0.520729
steps 6600    v_Prec: 0.613741  v_Recall: 0.660643  v_F1: 0.636329  v_AUC: 0.880652
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.265050    reg_loss: 0.240520    l2_loss: 0.020673    loss: 0.526243
steps 6800    v_Prec: 0.621126  v_Recall: 0.660484  v_F1: 0.640201  v_AUC: 0.883776
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.262430    reg_loss: 0.237094    l2_loss: 0.020924    loss: 0.520447
steps 7000    v_Prec: 0.640969  v_Recall: 0.644643  v_F1: 0.642800  v_AUC: 0.885509
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.257505    reg_loss: 0.231473    l2_loss: 0.021198    loss: 0.510176
steps 7200    v_Prec: 0.632277  v_Recall: 0.663987  v_F1: 0.647744  v_AUC: 0.887194
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.259438    reg_loss: 0.231649    l2_loss: 0.021375    loss: 0.512461
steps 7400    v_Prec: 0.631732  v_Recall: 0.659290  v_F1: 0.645217  v_AUC: 0.889729
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.260537    reg_loss: 0.229398    l2_loss: 0.021593    loss: 0.511528
steps 7600    v_Prec: 0.645672  v_Recall: 0.656106  v_F1: 0.650847  v_AUC: 0.889610
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.268435    reg_loss: 0.225634    l2_loss: 0.021890    loss: 0.515959
steps 7800    v_Prec: 0.645903  v_Recall: 0.664464  v_F1: 0.655052  v_AUC: 0.891318
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.264411    reg_loss: 0.223449    l2_loss: 0.021857    loss: 0.509717
steps 8000    v_Prec: 0.650205  v_Recall: 0.656106  v_F1: 0.653142  v_AUC: 0.892908
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.257467    reg_loss: 0.219124    l2_loss: 0.022061    loss: 0.498653
steps 8200    v_Prec: 0.654286  v_Recall: 0.656265  v_F1: 0.655274  v_AUC: 0.892058
steps 8200    running time 303 seconds

steps 8400    base_loss: 0.256863    reg_loss: 0.216239    l2_loss: 0.022188    loss: 0.495290
steps 8400    v_Prec: 0.645024  v_Recall: 0.673778  v_F1: 0.659087  v_AUC: 0.892416
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.259434    reg_loss: 0.213871    l2_loss: 0.022269    loss: 0.495574
steps 8600    v_Prec: 0.646987  v_Recall: 0.676087  v_F1: 0.661217  v_AUC: 0.893190
steps 8600    running time 317 seconds

steps 8800    base_loss: 0.258886    reg_loss: 0.213850    l2_loss: 0.022452    loss: 0.495188
steps 8800    v_Prec: 0.628771  v_Recall: 0.688585  v_F1: 0.657320  v_AUC: 0.894611
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.257891    reg_loss: 0.210999    l2_loss: 0.022491    loss: 0.491381
steps 9000    v_Prec: 0.637566  v_Recall: 0.675529  v_F1: 0.655999  v_AUC: 0.894095
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.260914    reg_loss: 0.209225    l2_loss: 0.022495    loss: 0.492633
steps 9200    v_Prec: 0.654875  v_Recall: 0.677918  v_F1: 0.666197  v_AUC: 0.897831
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.261441    reg_loss: 0.208827    l2_loss: 0.022695    loss: 0.492963
steps 9400    v_Prec: 0.666747  v_Recall: 0.664783  v_F1: 0.665763  v_AUC: 0.899073
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.266209    reg_loss: 0.207960    l2_loss: 0.022707    loss: 0.496875
steps 9600    v_Prec: 0.643647  v_Recall: 0.695192  v_F1: 0.668427  v_AUC: 0.900459
steps 9600    running time 349 seconds

steps 9800    base_loss: 0.264647    reg_loss: 0.206379    l2_loss: 0.022941    loss: 0.493968
steps 9800    v_Prec: 0.629467  v_Recall: 0.708088  v_F1: 0.666467  v_AUC: 0.900402
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.257976    reg_loss: 0.205076    l2_loss: 0.023078    loss: 0.486130
steps 10000    v_Prec: 0.645104  v_Recall: 0.697023  v_F1: 0.670059  v_AUC: 0.901398
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.262949    reg_loss: 0.205236    l2_loss: 0.023131    loss: 0.491316
steps 10200    v_Prec: 0.656428  v_Recall: 0.680465  v_F1: 0.668230  v_AUC: 0.901818
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.266332    reg_loss: 0.206071    l2_loss: 0.023071    loss: 0.495475
steps 10400    v_Prec: 0.658458  v_Recall: 0.681102  v_F1: 0.669588  v_AUC: 0.902767
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.265807    reg_loss: 0.203302    l2_loss: 0.023295    loss: 0.492405
steps 10600    v_Prec: 0.660852  v_Recall: 0.681579  v_F1: 0.671056  v_AUC: 0.905827
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.251397    reg_loss: 0.197039    l2_loss: 0.023442    loss: 0.471878
steps 10800    v_Prec: 0.656081  v_Recall: 0.685798  v_F1: 0.670611  v_AUC: 0.903135
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.203995    reg_loss: 0.178422    l2_loss: 0.023765    loss: 0.406182
steps 11000    v_Prec: 0.671700  v_Recall: 0.662235  v_F1: 0.666934  v_AUC: 0.901117
steps 11000    running time 395 seconds

steps 11200    base_loss: 0.204379    reg_loss: 0.177316    l2_loss: 0.023916    loss: 0.405612
steps 11200    v_Prec: 0.662434  v_Recall: 0.664385  v_F1: 0.663408  v_AUC: 0.897276
steps 11200    running time 401 seconds

steps 11400    base_loss: 0.206112    reg_loss: 0.177124    l2_loss: 0.024031    loss: 0.407267
steps 11400    v_Prec: 0.663802  v_Recall: 0.664066  v_F1: 0.663934  v_AUC: 0.896761
steps 11400    running time 407 seconds

steps 11600    base_loss: 0.202272    reg_loss: 0.178629    l2_loss: 0.024210    loss: 0.405111
steps 11600    v_Prec: 0.647495  v_Recall: 0.681977  v_F1: 0.664289  v_AUC: 0.898578
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.209809    reg_loss: 0.181710    l2_loss: 0.024422    loss: 0.415942
steps 11800    v_Prec: 0.674605  v_Recall: 0.662952  v_F1: 0.668728  v_AUC: 0.899111
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.208510    reg_loss: 0.182870    l2_loss: 0.024607    loss: 0.415986
steps 12000    v_Prec: 0.665186  v_Recall: 0.667410  v_F1: 0.666296  v_AUC: 0.899005
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.212164    reg_loss: 0.187811    l2_loss: 0.024728    loss: 0.424703
steps 12200    v_Prec: 0.652951  v_Recall: 0.672027  v_F1: 0.662351  v_AUC: 0.897687
steps 12200    running time 432 seconds

steps 12400    base_loss: 0.208614    reg_loss: 0.183932    l2_loss: 0.024778    loss: 0.417324
steps 12400    v_Prec: 0.636645  v_Recall: 0.688187  v_F1: 0.661413  v_AUC: 0.897076
steps 12400    running time 438 seconds

steps 12600    base_loss: 0.212874    reg_loss: 0.184007    l2_loss: 0.024954    loss: 0.421835
steps 12600    v_Prec: 0.663365  v_Recall: 0.671708  v_F1: 0.667510  v_AUC: 0.900517
steps 12600    running time 444 seconds

Early stop model F1: 0.671056
testing thre: 0.3428388
testing Prec: 0.4282385834109972
testing Recall: 0.7593195625759417
testing F1: 0.5476278107857054
testing AUC: 0.8586015119668466
overall running time 447 seconds
(0.5593367044781559, 0.5967436208991495, 0.5774349809528289, 0.8586015119668466, 0.6382276)

2019-02-24 02:24:27.654569: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:24:27.910377: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:24:27.911940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:24:27.911975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 23.720000 seconds
loading data in 29.800000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	0.3
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.128808    reg_loss: 0.649711    l2_loss: 0.013273    loss: 1.791792
steps 200    v_Prec: 0.165288  v_Recall: 1.000000  v_F1: 0.283686  v_AUC: 0.471690
steps 200    running time 39 seconds

steps 400    base_loss: 0.704481    reg_loss: 0.643552    l2_loss: 0.013315    loss: 1.361348
steps 400    v_Prec: 0.165288  v_Recall: 1.000000  v_F1: 0.283686  v_AUC: 0.482263
steps 400    running time 46 seconds

steps 600    base_loss: 0.492666    reg_loss: 0.631141    l2_loss: 0.013266    loss: 1.137073
steps 600    v_Prec: 0.165292  v_Recall: 1.000000  v_F1: 0.283692  v_AUC: 0.459258
steps 600    running time 52 seconds

steps 800    base_loss: 0.485098    reg_loss: 0.614055    l2_loss: 0.013089    loss: 1.112242
steps 800    v_Prec: 0.165290  v_Recall: 1.000000  v_F1: 0.283689  v_AUC: 0.449549
steps 800    running time 59 seconds

steps 1000    base_loss: 0.472510    reg_loss: 0.588206    l2_loss: 0.012907    loss: 1.073623
steps 1000    v_Prec: 0.165299  v_Recall: 1.000000  v_F1: 0.283702  v_AUC: 0.434025
steps 1000    running time 65 seconds

steps 1200    base_loss: 0.465554    reg_loss: 0.560330    l2_loss: 0.012759    loss: 1.038643
steps 1200    v_Prec: 0.199436  v_Recall: 0.585886  v_F1: 0.297576  v_AUC: 0.583343
steps 1200    running time 72 seconds

steps 1400    base_loss: 0.454555    reg_loss: 0.533501    l2_loss: 0.012717    loss: 1.000774
steps 1400    v_Prec: 0.247996  v_Recall: 0.520287  v_F1: 0.335890  v_AUC: 0.646464
steps 1400    running time 78 seconds

steps 1600    base_loss: 0.450948    reg_loss: 0.512122    l2_loss: 0.012608    loss: 0.975678
steps 1600    v_Prec: 0.307006  v_Recall: 0.510578  v_F1: 0.383448  v_AUC: 0.698567
steps 1600    running time 85 seconds

steps 1800    base_loss: 0.421489    reg_loss: 0.488547    l2_loss: 0.012783    loss: 0.922819
steps 1800    v_Prec: 0.362882  v_Recall: 0.538680  v_F1: 0.433642  v_AUC: 0.745561
steps 1800    running time 92 seconds

steps 2000    base_loss: 0.407093    reg_loss: 0.471744    l2_loss: 0.013008    loss: 0.891845
steps 2000    v_Prec: 0.425921  v_Recall: 0.534654  v_F1: 0.474134  v_AUC: 0.779612
steps 2000    running time 99 seconds

steps 2200    base_loss: 0.385219    reg_loss: 0.455231    l2_loss: 0.013226    loss: 0.853676
steps 2200    v_Prec: 0.452158  v_Recall: 0.555810  v_F1: 0.498654  v_AUC: 0.796839
steps 2200    running time 105 seconds

steps 2400    base_loss: 0.369094    reg_loss: 0.442214    l2_loss: 0.013443    loss: 0.824752
steps 2400    v_Prec: 0.482139  v_Recall: 0.572150  v_F1: 0.523302  v_AUC: 0.814603
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.365034    reg_loss: 0.431820    l2_loss: 0.013717    loss: 0.810571
steps 2600    v_Prec: 0.488903  v_Recall: 0.601674  v_F1: 0.539458  v_AUC: 0.827707
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.351931    reg_loss: 0.418627    l2_loss: 0.013939    loss: 0.784497
steps 2800    v_Prec: 0.524474  v_Recall: 0.590385  v_F1: 0.555481  v_AUC: 0.834335
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.344311    reg_loss: 0.402540    l2_loss: 0.014218    loss: 0.761069
steps 3000    v_Prec: 0.518071  v_Recall: 0.612172  v_F1: 0.561204  v_AUC: 0.839638
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.338597    reg_loss: 0.391509    l2_loss: 0.014440    loss: 0.744545
steps 3200    v_Prec: 0.537261  v_Recall: 0.603252  v_F1: 0.568347  v_AUC: 0.846104
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.334981    reg_loss: 0.384572    l2_loss: 0.014752    loss: 0.734305
steps 3400    v_Prec: 0.538922  v_Recall: 0.611541  v_F1: 0.572939  v_AUC: 0.850206
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.328068    reg_loss: 0.367680    l2_loss: 0.014983    loss: 0.710731
steps 3600    v_Prec: 0.531977  v_Recall: 0.637591  v_F1: 0.580015  v_AUC: 0.855342
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.331698    reg_loss: 0.361508    l2_loss: 0.015265    loss: 0.708471
steps 3800    v_Prec: 0.554149  v_Recall: 0.625276  v_F1: 0.587568  v_AUC: 0.857191
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.327671    reg_loss: 0.346464    l2_loss: 0.015510    loss: 0.689644
steps 4000    v_Prec: 0.574137  v_Recall: 0.602463  v_F1: 0.587959  v_AUC: 0.859107
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.322864    reg_loss: 0.336683    l2_loss: 0.015822    loss: 0.675369
steps 4200    v_Prec: 0.562552  v_Recall: 0.637512  v_F1: 0.597691  v_AUC: 0.863147
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.326168    reg_loss: 0.330082    l2_loss: 0.016135    loss: 0.672385
steps 4400    v_Prec: 0.592171  v_Recall: 0.603015  v_F1: 0.597544  v_AUC: 0.865271
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.327649    reg_loss: 0.318308    l2_loss: 0.016449    loss: 0.662406
steps 4600    v_Prec: 0.587679  v_Recall: 0.622750  v_F1: 0.604706  v_AUC: 0.868566
steps 4600    running time 184 seconds

steps 4800    base_loss: 0.319521    reg_loss: 0.304538    l2_loss: 0.016773    loss: 0.640831
steps 4800    v_Prec: 0.577173  v_Recall: 0.632302  v_F1: 0.603481  v_AUC: 0.869477
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.320404    reg_loss: 0.294063    l2_loss: 0.017255    loss: 0.631722
steps 5000    v_Prec: 0.570192  v_Recall: 0.639643  v_F1: 0.602924  v_AUC: 0.868708
steps 5000    running time 197 seconds

steps 5200    base_loss: 0.314992    reg_loss: 0.287321    l2_loss: 0.017722    loss: 0.620035
steps 5200    v_Prec: 0.556953  v_Recall: 0.657326  v_F1: 0.602991  v_AUC: 0.870946
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.312134    reg_loss: 0.273114    l2_loss: 0.017907    loss: 0.603156
steps 5400    v_Prec: 0.582238  v_Recall: 0.639643  v_F1: 0.609592  v_AUC: 0.868986
steps 5400    running time 210 seconds

steps 5600    base_loss: 0.278960    reg_loss: 0.236669    l2_loss: 0.018249    loss: 0.533878
steps 5600    v_Prec: 0.582394  v_Recall: 0.636091  v_F1: 0.608059  v_AUC: 0.863290
steps 5600    running time 217 seconds

steps 5800    base_loss: 0.287232    reg_loss: 0.240060    l2_loss: 0.018485    loss: 0.545778
steps 5800    v_Prec: 0.572059  v_Recall: 0.645169  v_F1: 0.606418  v_AUC: 0.864973
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.274285    reg_loss: 0.233019    l2_loss: 0.018742    loss: 0.526046
steps 6000    v_Prec: 0.600046  v_Recall: 0.623776  v_F1: 0.611681  v_AUC: 0.862158
steps 6000    running time 230 seconds

steps 6200    base_loss: 0.281382    reg_loss: 0.232629    l2_loss: 0.018938    loss: 0.532949
steps 6200    v_Prec: 0.596503  v_Recall: 0.624803  v_F1: 0.610325  v_AUC: 0.867235
steps 6200    running time 237 seconds

steps 6400    base_loss: 0.281922    reg_loss: 0.229616    l2_loss: 0.019049    loss: 0.530587
steps 6400    v_Prec: 0.583498  v_Recall: 0.651484  v_F1: 0.615620  v_AUC: 0.867272
steps 6400    running time 243 seconds

steps 6600    base_loss: 0.281939    reg_loss: 0.227234    l2_loss: 0.019330    loss: 0.528503
steps 6600    v_Prec: 0.579375  v_Recall: 0.647932  v_F1: 0.611738  v_AUC: 0.868643
steps 6600    running time 250 seconds

steps 6800    base_loss: 0.278515    reg_loss: 0.218734    l2_loss: 0.019607    loss: 0.516856
steps 6800    v_Prec: 0.572522  v_Recall: 0.661509  v_F1: 0.613807  v_AUC: 0.869526
steps 6800    running time 256 seconds

steps 7000    base_loss: 0.285651    reg_loss: 0.221592    l2_loss: 0.019758    loss: 0.527001
steps 7000    v_Prec: 0.580401  v_Recall: 0.666719  v_F1: 0.620573  v_AUC: 0.872924
steps 7000    running time 262 seconds

steps 7200    base_loss: 0.284556    reg_loss: 0.216934    l2_loss: 0.019833    loss: 0.521323
steps 7200    v_Prec: 0.592277  v_Recall: 0.653852  v_F1: 0.621544  v_AUC: 0.876376
steps 7200    running time 268 seconds

steps 7400    base_loss: 0.289088    reg_loss: 0.219593    l2_loss: 0.020189    loss: 0.528869
steps 7400    v_Prec: 0.586236  v_Recall: 0.657641  v_F1: 0.619889  v_AUC: 0.876146
steps 7400    running time 275 seconds

steps 7600    base_loss: 0.285927    reg_loss: 0.214079    l2_loss: 0.020165    loss: 0.520171
steps 7600    v_Prec: 0.583025  v_Recall: 0.672403  v_F1: 0.624533  v_AUC: 0.878417
steps 7600    running time 281 seconds

steps 7800    base_loss: 0.287504    reg_loss: 0.211765    l2_loss: 0.020320    loss: 0.519589
steps 7800    v_Prec: 0.577240  v_Recall: 0.685507  v_F1: 0.626732  v_AUC: 0.877892
steps 7800    running time 287 seconds

steps 8000    base_loss: 0.294198    reg_loss: 0.211869    l2_loss: 0.020271    loss: 0.526337
steps 8000    v_Prec: 0.592826  v_Recall: 0.660167  v_F1: 0.624687  v_AUC: 0.881975
steps 8000    running time 294 seconds

steps 8200    base_loss: 0.282131    reg_loss: 0.209308    l2_loss: 0.020510    loss: 0.511949
steps 8200    v_Prec: 0.592263  v_Recall: 0.676745  v_F1: 0.631691  v_AUC: 0.881919
steps 8200    running time 300 seconds

steps 8400    base_loss: 0.281150    reg_loss: 0.203726    l2_loss: 0.020692    loss: 0.505568
steps 8400    v_Prec: 0.588705  v_Recall: 0.674771  v_F1: 0.628807  v_AUC: 0.878806
steps 8400    running time 307 seconds

steps 8600    base_loss: 0.283313    reg_loss: 0.200968    l2_loss: 0.020744    loss: 0.505025
steps 8600    v_Prec: 0.613496  v_Recall: 0.653063  v_F1: 0.632662  v_AUC: 0.883063
steps 8600    running time 313 seconds

steps 8800    base_loss: 0.277586    reg_loss: 0.200876    l2_loss: 0.020880    loss: 0.499341
steps 8800    v_Prec: 0.613299  v_Recall: 0.658904  v_F1: 0.635284  v_AUC: 0.884407
steps 8800    running time 320 seconds

steps 9000    base_loss: 0.279336    reg_loss: 0.195424    l2_loss: 0.021024    loss: 0.495784
steps 9000    v_Prec: 0.623342  v_Recall: 0.653063  v_F1: 0.637857  v_AUC: 0.884824
steps 9000    running time 327 seconds

steps 9200    base_loss: 0.278676    reg_loss: 0.196248    l2_loss: 0.021053    loss: 0.495977
steps 9200    v_Prec: 0.593551  v_Recall: 0.684402  v_F1: 0.635747  v_AUC: 0.885810
steps 9200    running time 333 seconds

steps 9400    base_loss: 0.282184    reg_loss: 0.199473    l2_loss: 0.021101    loss: 0.502758
steps 9400    v_Prec: 0.597127  v_Recall: 0.685744  v_F1: 0.638374  v_AUC: 0.887013
steps 9400    running time 340 seconds

steps 9600    base_loss: 0.276953    reg_loss: 0.189920    l2_loss: 0.021137    loss: 0.488009
steps 9600    v_Prec: 0.601645  v_Recall: 0.681244  v_F1: 0.638975  v_AUC: 0.886607
steps 9600    running time 347 seconds

steps 9800    base_loss: 0.278400    reg_loss: 0.191677    l2_loss: 0.021230    loss: 0.491306
steps 9800    v_Prec: 0.593583  v_Recall: 0.684954  v_F1: 0.636004  v_AUC: 0.887303
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.285238    reg_loss: 0.194021    l2_loss: 0.021255    loss: 0.500515
steps 10000    v_Prec: 0.603826  v_Recall: 0.682665  v_F1: 0.640830  v_AUC: 0.888821
steps 10000    running time 359 seconds

steps 10200    base_loss: 0.273442    reg_loss: 0.186638    l2_loss: 0.021298    loss: 0.481378
steps 10200    v_Prec: 0.605752  v_Recall: 0.685033  v_F1: 0.642958  v_AUC: 0.889299
steps 10200    running time 366 seconds

steps 10400    base_loss: 0.284791    reg_loss: 0.193225    l2_loss: 0.021379    loss: 0.499395
steps 10400    v_Prec: 0.600681  v_Recall: 0.696558  v_F1: 0.645076  v_AUC: 0.888704
steps 10400    running time 373 seconds

steps 10600    base_loss: 0.283252    reg_loss: 0.188896    l2_loss: 0.021315    loss: 0.493463
steps 10600    v_Prec: 0.639222  v_Recall: 0.656378  v_F1: 0.647687  v_AUC: 0.890460
steps 10600    running time 379 seconds

steps 10800    base_loss: 0.272366    reg_loss: 0.184835    l2_loss: 0.021415    loss: 0.478616
steps 10800    v_Prec: 0.631882  v_Recall: 0.666798  v_F1: 0.648871  v_AUC: 0.886384
steps 10800    running time 386 seconds

steps 11000    base_loss: 0.230211    reg_loss: 0.163950    l2_loss: 0.021575    loss: 0.415736
steps 11000    v_Prec: 0.627206  v_Recall: 0.653694  v_F1: 0.640176  v_AUC: 0.883203
steps 11000    running time 392 seconds

steps 11200    base_loss: 0.236036    reg_loss: 0.168563    l2_loss: 0.021614    loss: 0.426214
steps 11200    v_Prec: 0.648233  v_Recall: 0.625513  v_F1: 0.636670  v_AUC: 0.879049
steps 11200    running time 398 seconds

steps 11400    base_loss: 0.232965    reg_loss: 0.173555    l2_loss: 0.021763    loss: 0.428283
steps 11400    v_Prec: 0.624868  v_Recall: 0.654563  v_F1: 0.639371  v_AUC: 0.879805
steps 11400    running time 404 seconds

steps 11600    base_loss: 0.241309    reg_loss: 0.171516    l2_loss: 0.021787    loss: 0.434613
steps 11600    v_Prec: 0.619890  v_Recall: 0.660799  v_F1: 0.639691  v_AUC: 0.884601
steps 11600    running time 410 seconds

steps 11800    base_loss: 0.240034    reg_loss: 0.171579    l2_loss: 0.021972    loss: 0.433585
steps 11800    v_Prec: 0.596171  v_Recall: 0.693164  v_F1: 0.641019  v_AUC: 0.885700
steps 11800    running time 416 seconds

steps 12000    base_loss: 0.234073    reg_loss: 0.170426    l2_loss: 0.021925    loss: 0.426425
steps 12000    v_Prec: 0.610383  v_Recall: 0.676587  v_F1: 0.641782  v_AUC: 0.886721
steps 12000    running time 422 seconds

steps 12200    base_loss: 0.232263    reg_loss: 0.170586    l2_loss: 0.022021    loss: 0.424870
steps 12200    v_Prec: 0.643186  v_Recall: 0.640038  v_F1: 0.641608  v_AUC: 0.884546
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.235106    reg_loss: 0.170645    l2_loss: 0.022041    loss: 0.427792
steps 12400    v_Prec: 0.657089  v_Recall: 0.628197  v_F1: 0.642318  v_AUC: 0.883066
steps 12400    running time 434 seconds

steps 12600    base_loss: 0.233169    reg_loss: 0.170509    l2_loss: 0.022048    loss: 0.425726
steps 12600    v_Prec: 0.633318  v_Recall: 0.652116  v_F1: 0.642579  v_AUC: 0.882299
steps 12600    running time 441 seconds

steps 12800    base_loss: 0.243391    reg_loss: 0.177103    l2_loss: 0.022152    loss: 0.442646
steps 12800    v_Prec: 0.620760  v_Recall: 0.668930  v_F1: 0.643945  v_AUC: 0.882594
steps 12800    running time 448 seconds

Early stop model F1: 0.648871
testing thre: 0.37113485
testing Prec: 0.40750364576428477
testing Recall: 0.7469744835965978
testing F1: 0.5273288728769944
testing AUC: 0.8400590411084361
overall running time 451 seconds
(0.5341325937192449, 0.5803159173754556, 0.5562673251182184, 0.8400590411084361, 0.6739575)

2019-02-24 02:29:38.799191: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:29:39.313221: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:29:39.314111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:29:39.314144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.440000 seconds
loading data in 30.650000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.675622    reg_loss: 2.160135    l2_loss: 0.013319    loss: 2.849076
steps 200    v_Prec: 0.167085  v_Recall: 0.926527  v_F1: 0.283114  v_AUC: 0.541857
steps 200    running time 40 seconds

steps 400    base_loss: 0.534855    reg_loss: 2.133881    l2_loss: 0.013272    loss: 2.682008
steps 400    v_Prec: 0.176875  v_Recall: 0.772705  v_F1: 0.287859  v_AUC: 0.561463
steps 400    running time 48 seconds

steps 600    base_loss: 0.486227    reg_loss: 2.083716    l2_loss: 0.013200    loss: 2.583144
steps 600    v_Prec: 0.192353  v_Recall: 0.685401  v_F1: 0.300401  v_AUC: 0.590784
steps 600    running time 54 seconds

steps 800    base_loss: 0.469415    reg_loss: 2.002846    l2_loss: 0.013151    loss: 2.485412
steps 800    v_Prec: 0.217254  v_Recall: 0.539175  v_F1: 0.309713  v_AUC: 0.609665
steps 800    running time 61 seconds

steps 1000    base_loss: 0.448196    reg_loss: 1.910848    l2_loss: 0.013077    loss: 2.372121
steps 1000    v_Prec: 0.241915  v_Recall: 0.504157  v_F1: 0.326948  v_AUC: 0.631389
steps 1000    running time 68 seconds

steps 1200    base_loss: 0.437983    reg_loss: 1.808870    l2_loss: 0.013083    loss: 2.259936
steps 1200    v_Prec: 0.283684  v_Recall: 0.440358  v_F1: 0.345070  v_AUC: 0.654341
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.425683    reg_loss: 1.709984    l2_loss: 0.013132    loss: 2.148799
steps 1400    v_Prec: 0.306956  v_Recall: 0.446274  v_F1: 0.363731  v_AUC: 0.683405
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.420091    reg_loss: 1.642295    l2_loss: 0.013235    loss: 2.075621
steps 1600    v_Prec: 0.343386  v_Recall: 0.506156  v_F1: 0.409178  v_AUC: 0.723723
steps 1600    running time 89 seconds

steps 1800    base_loss: 0.412766    reg_loss: 1.581777    l2_loss: 0.013381    loss: 2.007924
steps 1800    v_Prec: 0.345695  v_Recall: 0.555964  v_F1: 0.426312  v_AUC: 0.745907
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.391304    reg_loss: 1.517425    l2_loss: 0.013596    loss: 1.922325
steps 2000    v_Prec: 0.413033  v_Recall: 0.560441  v_F1: 0.475577  v_AUC: 0.779867
steps 2000    running time 102 seconds

steps 2200    base_loss: 0.374781    reg_loss: 1.462953    l2_loss: 0.013873    loss: 1.851607
steps 2200    v_Prec: 0.446107  v_Recall: 0.574432  v_F1: 0.502202  v_AUC: 0.801253
steps 2200    running time 109 seconds

steps 2400    base_loss: 0.361670    reg_loss: 1.413145    l2_loss: 0.014045    loss: 1.788860
steps 2400    v_Prec: 0.476794  v_Recall: 0.568356  v_F1: 0.518564  v_AUC: 0.813389
steps 2400    running time 116 seconds

steps 2600    base_loss: 0.359682    reg_loss: 1.375610    l2_loss: 0.014337    loss: 1.749629
steps 2600    v_Prec: 0.484484  v_Recall: 0.595379  v_F1: 0.534237  v_AUC: 0.822496
steps 2600    running time 122 seconds

steps 2800    base_loss: 0.348439    reg_loss: 1.329577    l2_loss: 0.014668    loss: 1.692683
steps 2800    v_Prec: 0.515270  v_Recall: 0.588104  v_F1: 0.549283  v_AUC: 0.830354
steps 2800    running time 129 seconds

steps 3000    base_loss: 0.338914    reg_loss: 1.270853    l2_loss: 0.014924    loss: 1.624691
steps 3000    v_Prec: 0.519724  v_Recall: 0.589862  v_F1: 0.552576  v_AUC: 0.835498
steps 3000    running time 136 seconds

steps 3200    base_loss: 0.343122    reg_loss: 1.240736    l2_loss: 0.015232    loss: 1.599090
steps 3200    v_Prec: 0.546269  v_Recall: 0.575312  v_F1: 0.560414  v_AUC: 0.839682
steps 3200    running time 142 seconds

steps 3400    base_loss: 0.344662    reg_loss: 1.201490    l2_loss: 0.015574    loss: 1.561726
steps 3400    v_Prec: 0.522506  v_Recall: 0.618084  v_F1: 0.566291  v_AUC: 0.845627
steps 3400    running time 149 seconds

steps 3600    base_loss: 0.341922    reg_loss: 1.158437    l2_loss: 0.015939    loss: 1.516298
steps 3600    v_Prec: 0.558248  v_Recall: 0.585785  v_F1: 0.571685  v_AUC: 0.847888
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.335641    reg_loss: 1.102756    l2_loss: 0.016214    loss: 1.454611
steps 3800    v_Prec: 0.523682  v_Recall: 0.624960  v_F1: 0.569856  v_AUC: 0.849798
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.330732    reg_loss: 1.058732    l2_loss: 0.016577    loss: 1.406040
steps 4000    v_Prec: 0.537126  v_Recall: 0.625760  v_F1: 0.578065  v_AUC: 0.852325
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.329381    reg_loss: 1.018557    l2_loss: 0.016915    loss: 1.364854
steps 4200    v_Prec: 0.530308  v_Recall: 0.634394  v_F1: 0.577700  v_AUC: 0.852847
steps 4200    running time 174 seconds

steps 4400    base_loss: 0.336056    reg_loss: 0.992159    l2_loss: 0.017295    loss: 1.345511
steps 4400    v_Prec: 0.539304  v_Recall: 0.634074  v_F1: 0.582862  v_AUC: 0.855770
steps 4400    running time 181 seconds

steps 4600    base_loss: 0.326427    reg_loss: 0.932705    l2_loss: 0.017622    loss: 1.276754
steps 4600    v_Prec: 0.548103  v_Recall: 0.612168  v_F1: 0.578367  v_AUC: 0.854360
steps 4600    running time 188 seconds

steps 4800    base_loss: 0.323359    reg_loss: 0.899182    l2_loss: 0.017991    loss: 1.240532
steps 4800    v_Prec: 0.531107  v_Recall: 0.642229  v_F1: 0.581406  v_AUC: 0.855202
steps 4800    running time 194 seconds

steps 5000    base_loss: 0.333610    reg_loss: 0.883184    l2_loss: 0.018447    loss: 1.235240
steps 5000    v_Prec: 0.571750  v_Recall: 0.609690  v_F1: 0.590111  v_AUC: 0.858642
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.319709    reg_loss: 0.840464    l2_loss: 0.018959    loss: 1.179132
steps 5200    v_Prec: 0.562190  v_Recall: 0.626239  v_F1: 0.592489  v_AUC: 0.860775
steps 5200    running time 207 seconds

steps 5400    base_loss: 0.330325    reg_loss: 0.817295    l2_loss: 0.019361    loss: 1.166982
steps 5400    v_Prec: 0.562342  v_Recall: 0.623441  v_F1: 0.591318  v_AUC: 0.860825
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.298111    reg_loss: 0.698213    l2_loss: 0.019581    loss: 1.015905
steps 5600    v_Prec: 0.556042  v_Recall: 0.619923  v_F1: 0.586247  v_AUC: 0.854290
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.299858    reg_loss: 0.680612    l2_loss: 0.019684    loss: 1.000153
steps 5800    v_Prec: 0.598588  v_Recall: 0.582987  v_F1: 0.590684  v_AUC: 0.855544
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.300892    reg_loss: 0.680119    l2_loss: 0.019690    loss: 1.000702
steps 6000    v_Prec: 0.582505  v_Recall: 0.600016  v_F1: 0.591131  v_AUC: 0.855208
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.301360    reg_loss: 0.674709    l2_loss: 0.019997    loss: 0.996065
steps 6200    v_Prec: 0.557385  v_Recall: 0.622402  v_F1: 0.588102  v_AUC: 0.857370
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.301138    reg_loss: 0.673024    l2_loss: 0.020075    loss: 0.994237
steps 6400    v_Prec: 0.567709  v_Recall: 0.622402  v_F1: 0.593799  v_AUC: 0.859432
steps 6400    running time 244 seconds

steps 6600    base_loss: 0.300744    reg_loss: 0.663218    l2_loss: 0.020414    loss: 0.984375
steps 6600    v_Prec: 0.566880  v_Recall: 0.637672  v_F1: 0.600196  v_AUC: 0.861409
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.301264    reg_loss: 0.654213    l2_loss: 0.020583    loss: 0.976060
steps 6800    v_Prec: 0.560112  v_Recall: 0.655181  v_F1: 0.603928  v_AUC: 0.864983
steps 6800    running time 257 seconds

steps 7000    base_loss: 0.297238    reg_loss: 0.635399    l2_loss: 0.020810    loss: 0.953447
steps 7000    v_Prec: 0.579675  v_Recall: 0.627039  v_F1: 0.602427  v_AUC: 0.864286
steps 7000    running time 264 seconds

steps 7200    base_loss: 0.303643    reg_loss: 0.643267    l2_loss: 0.020847    loss: 0.967757
steps 7200    v_Prec: 0.540084  v_Recall: 0.679725  v_F1: 0.601912  v_AUC: 0.866138
steps 7200    running time 270 seconds

steps 7400    base_loss: 0.296808    reg_loss: 0.617072    l2_loss: 0.021065    loss: 0.934944
steps 7400    v_Prec: 0.561392  v_Recall: 0.663096  v_F1: 0.608020  v_AUC: 0.866100
steps 7400    running time 276 seconds

steps 7600    base_loss: 0.297099    reg_loss: 0.610677    l2_loss: 0.021096    loss: 0.928872
steps 7600    v_Prec: 0.562427  v_Recall: 0.657979  v_F1: 0.606463  v_AUC: 0.868680
steps 7600    running time 282 seconds

steps 7800    base_loss: 0.300625    reg_loss: 0.618932    l2_loss: 0.021339    loss: 0.940897
steps 7800    v_Prec: 0.570149  v_Recall: 0.646546  v_F1: 0.605949  v_AUC: 0.869445
steps 7800    running time 288 seconds

steps 8000    base_loss: 0.306700    reg_loss: 0.612590    l2_loss: 0.021346    loss: 0.940635
steps 8000    v_Prec: 0.551509  v_Recall: 0.693796  v_F1: 0.614524  v_AUC: 0.872993
steps 8000    running time 295 seconds

steps 8200    base_loss: 0.297802    reg_loss: 0.600092    l2_loss: 0.021318    loss: 0.919213
steps 8200    v_Prec: 0.583890  v_Recall: 0.643268  v_F1: 0.612142  v_AUC: 0.871824
steps 8200    running time 302 seconds

steps 8400    base_loss: 0.298998    reg_loss: 0.589271    l2_loss: 0.021379    loss: 0.909648
steps 8400    v_Prec: 0.571331  v_Recall: 0.666933  v_F1: 0.615441  v_AUC: 0.872026
steps 8400    running time 308 seconds

steps 8600    base_loss: 0.296504    reg_loss: 0.586531    l2_loss: 0.021527    loss: 0.904562
steps 8600    v_Prec: 0.587921  v_Recall: 0.642869  v_F1: 0.614168  v_AUC: 0.871697
steps 8600    running time 315 seconds

steps 8800    base_loss: 0.300821    reg_loss: 0.585275    l2_loss: 0.021561    loss: 0.907657
steps 8800    v_Prec: 0.561886  v_Recall: 0.689958  v_F1: 0.619371  v_AUC: 0.871287
steps 8800    running time 321 seconds

steps 9000    base_loss: 0.293252    reg_loss: 0.569784    l2_loss: 0.021768    loss: 0.884804
steps 9000    v_Prec: 0.549276  v_Recall: 0.700911  v_F1: 0.615898  v_AUC: 0.872204
steps 9000    running time 328 seconds

steps 9200    base_loss: 0.297193    reg_loss: 0.571923    l2_loss: 0.021648    loss: 0.890763
steps 9200    v_Prec: 0.552298  v_Recall: 0.703310  v_F1: 0.618723  v_AUC: 0.874578
steps 9200    running time 334 seconds

steps 9400    base_loss: 0.295415    reg_loss: 0.574438    l2_loss: 0.021746    loss: 0.891600
steps 9400    v_Prec: 0.554311  v_Recall: 0.696434  v_F1: 0.617298  v_AUC: 0.875133
steps 9400    running time 340 seconds

steps 9600    base_loss: 0.293522    reg_loss: 0.559526    l2_loss: 0.021767    loss: 0.874815
steps 9600    v_Prec: 0.556296  v_Recall: 0.700752  v_F1: 0.620224  v_AUC: 0.875924
steps 9600    running time 346 seconds

steps 9800    base_loss: 0.298742    reg_loss: 0.568942    l2_loss: 0.021745    loss: 0.889430
steps 9800    v_Prec: 0.539939  v_Recall: 0.719300  v_F1: 0.616845  v_AUC: 0.876352
steps 9800    running time 353 seconds

steps 10000    base_loss: 0.305098    reg_loss: 0.582140    l2_loss: 0.021892    loss: 0.909130
steps 10000    v_Prec: 0.560262  v_Recall: 0.703150  v_F1: 0.623626  v_AUC: 0.875834
steps 10000    running time 359 seconds

steps 10200    base_loss: 0.295353    reg_loss: 0.554362    l2_loss: 0.021964    loss: 0.871679
steps 10200    v_Prec: 0.558021  v_Recall: 0.701631  v_F1: 0.621640  v_AUC: 0.877176
steps 10200    running time 366 seconds

steps 10400    base_loss: 0.294230    reg_loss: 0.547947    l2_loss: 0.021924    loss: 0.864101
steps 10400    v_Prec: 0.568481  v_Recall: 0.687240  v_F1: 0.622245  v_AUC: 0.877351
steps 10400    running time 371 seconds

steps 10600    base_loss: 0.302454    reg_loss: 0.555493    l2_loss: 0.021833    loss: 0.879779
steps 10600    v_Prec: 0.554051  v_Recall: 0.712984  v_F1: 0.623549  v_AUC: 0.876731
steps 10600    running time 377 seconds

steps 10800    base_loss: 0.296369    reg_loss: 0.555199    l2_loss: 0.021891    loss: 0.873458
steps 10800    v_Prec: 0.575883  v_Recall: 0.680764  v_F1: 0.623947  v_AUC: 0.875639
steps 10800    running time 383 seconds

steps 11000    base_loss: 0.255069    reg_loss: 0.500972    l2_loss: 0.021868    loss: 0.777908
steps 11000    v_Prec: 0.563927  v_Recall: 0.685161  v_F1: 0.618661  v_AUC: 0.871445
steps 11000    running time 390 seconds

steps 11200    base_loss: 0.261101    reg_loss: 0.507411    l2_loss: 0.021992    loss: 0.790505
steps 11200    v_Prec: 0.580301  v_Recall: 0.660377  v_F1: 0.617755  v_AUC: 0.872759
steps 11200    running time 396 seconds

steps 11400    base_loss: 0.252651    reg_loss: 0.492573    l2_loss: 0.021929    loss: 0.767153
steps 11400    v_Prec: 0.594357  v_Recall: 0.648385  v_F1: 0.620197  v_AUC: 0.870819
steps 11400    running time 402 seconds

steps 11600    base_loss: 0.258745    reg_loss: 0.501781    l2_loss: 0.021729    loss: 0.782255
steps 11600    v_Prec: 0.616543  v_Recall: 0.618564  v_F1: 0.617552  v_AUC: 0.870441
steps 11600    running time 409 seconds

steps 11800    base_loss: 0.257698    reg_loss: 0.502285    l2_loss: 0.021700    loss: 0.781684
steps 11800    v_Prec: 0.601775  v_Recall: 0.628957  v_F1: 0.615066  v_AUC: 0.868377
steps 11800    running time 415 seconds

steps 12000    base_loss: 0.260682    reg_loss: 0.507924    l2_loss: 0.021441    loss: 0.790047
steps 12000    v_Prec: 0.536854  v_Recall: 0.716821  v_F1: 0.613920  v_AUC: 0.870076
steps 12000    running time 421 seconds

steps 12200    base_loss: 0.267460    reg_loss: 0.516008    l2_loss: 0.021594    loss: 0.805062
steps 12200    v_Prec: 0.622295  v_Recall: 0.606972  v_F1: 0.614538  v_AUC: 0.872015
steps 12200    running time 428 seconds

steps 12400    base_loss: 0.269049    reg_loss: 0.514973    l2_loss: 0.021625    loss: 0.805648
steps 12400    v_Prec: 0.546024  v_Recall: 0.704269  v_F1: 0.615132  v_AUC: 0.872931
steps 12400    running time 434 seconds

steps 12600    base_loss: 0.265250    reg_loss: 0.508267    l2_loss: 0.021596    loss: 0.795113
steps 12600    v_Prec: 0.554273  v_Recall: 0.691158  v_F1: 0.615193  v_AUC: 0.870567
steps 12600    running time 440 seconds

steps 12800    base_loss: 0.270148    reg_loss: 0.517632    l2_loss: 0.021555    loss: 0.809335
steps 12800    v_Prec: 0.596777  v_Recall: 0.633515  v_F1: 0.614597  v_AUC: 0.869272
steps 12800    running time 447 seconds

Early stop model F1: 0.623947
testing thre: 0.355392
testing Prec: 0.35792215888849305
testing Recall: 0.7812879708383961
testing F1: 0.49093713256066085
testing AUC: 0.8150967229429553
overall running time 449 seconds
(0.46189475184380235, 0.6300850546780072, 0.5330372928744707, 0.8150967229429553, 0.6487132)

2019-02-24 02:34:45.093645: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:34:45.600908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:34:45.602021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:34:45.602057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.890000 seconds
loading data in 31.220000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.842856    reg_loss: 2.158150    l2_loss: 0.013315    loss: 3.014321
steps 200    v_Prec: 0.164085  v_Recall: 0.987626  v_F1: 0.281415  v_AUC: 0.515135
steps 200    running time 41 seconds

steps 400    base_loss: 0.572654    reg_loss: 2.134318    l2_loss: 0.013265    loss: 2.720237
steps 400    v_Prec: 0.165027  v_Recall: 0.966629  v_F1: 0.281922  v_AUC: 0.527739
steps 400    running time 48 seconds

steps 600    base_loss: 0.479911    reg_loss: 2.084980    l2_loss: 0.013203    loss: 2.578094
steps 600    v_Prec: 0.172303  v_Recall: 0.836660  v_F1: 0.285757  v_AUC: 0.555271
steps 600    running time 55 seconds

steps 800    base_loss: 0.475863    reg_loss: 2.014657    l2_loss: 0.013034    loss: 2.503553
steps 800    v_Prec: 0.196737  v_Recall: 0.611368  v_F1: 0.297681  v_AUC: 0.590043
steps 800    running time 62 seconds

steps 1000    base_loss: 0.469283    reg_loss: 1.915031    l2_loss: 0.012953    loss: 2.397267
steps 1000    v_Prec: 0.238666  v_Recall: 0.477008  v_F1: 0.318149  v_AUC: 0.615155
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.454887    reg_loss: 1.812946    l2_loss: 0.012856    loss: 2.280689
steps 1200    v_Prec: 0.287963  v_Recall: 0.404519  v_F1: 0.336432  v_AUC: 0.632073
steps 1200    running time 77 seconds

steps 1400    base_loss: 0.444032    reg_loss: 1.717714    l2_loss: 0.012837    loss: 2.174583
steps 1400    v_Prec: 0.327791  v_Recall: 0.410746  v_F1: 0.364609  v_AUC: 0.657302
steps 1400    running time 84 seconds

steps 1600    base_loss: 0.431062    reg_loss: 1.634340    l2_loss: 0.012904    loss: 2.078305
steps 1600    v_Prec: 0.343812  v_Recall: 0.426952  v_F1: 0.380898  v_AUC: 0.684547
steps 1600    running time 91 seconds

steps 1800    base_loss: 0.415193    reg_loss: 1.564653    l2_loss: 0.013053    loss: 1.992899
steps 1800    v_Prec: 0.413503  v_Recall: 0.408750  v_F1: 0.411113  v_AUC: 0.724484
steps 1800    running time 97 seconds

steps 2000    base_loss: 0.408054    reg_loss: 1.515338    l2_loss: 0.013239    loss: 1.936631
steps 2000    v_Prec: 0.436760  v_Recall: 0.436133  v_F1: 0.436446  v_AUC: 0.756033
steps 2000    running time 104 seconds

steps 2200    base_loss: 0.389894    reg_loss: 1.452863    l2_loss: 0.013457    loss: 1.856214
steps 2200    v_Prec: 0.455916  v_Recall: 0.449146  v_F1: 0.452505  v_AUC: 0.776527
steps 2200    running time 111 seconds

steps 2400    base_loss: 0.381955    reg_loss: 1.412761    l2_loss: 0.013775    loss: 1.808492
steps 2400    v_Prec: 0.409552  v_Recall: 0.635319  v_F1: 0.498044  v_AUC: 0.800406
steps 2400    running time 118 seconds

steps 2600    base_loss: 0.369975    reg_loss: 1.358449    l2_loss: 0.014096    loss: 1.742519
steps 2600    v_Prec: 0.439655  v_Recall: 0.630209  v_F1: 0.517962  v_AUC: 0.815256
steps 2600    running time 124 seconds

steps 2800    base_loss: 0.365862    reg_loss: 1.316121    l2_loss: 0.014429    loss: 1.696412
steps 2800    v_Prec: 0.462803  v_Recall: 0.606898  v_F1: 0.525145  v_AUC: 0.824912
steps 2800    running time 131 seconds

steps 3000    base_loss: 0.350310    reg_loss: 1.259897    l2_loss: 0.014752    loss: 1.624959
steps 3000    v_Prec: 0.485058  v_Recall: 0.616797  v_F1: 0.543052  v_AUC: 0.832122
steps 3000    running time 137 seconds

steps 3200    base_loss: 0.344441    reg_loss: 1.213070    l2_loss: 0.015158    loss: 1.572669
steps 3200    v_Prec: 0.484733  v_Recall: 0.627335  v_F1: 0.546891  v_AUC: 0.833855
steps 3200    running time 144 seconds

steps 3400    base_loss: 0.343110    reg_loss: 1.177944    l2_loss: 0.015493    loss: 1.536547
steps 3400    v_Prec: 0.519269  v_Recall: 0.603465  v_F1: 0.558210  v_AUC: 0.838270
steps 3400    running time 151 seconds

steps 3600    base_loss: 0.340747    reg_loss: 1.124592    l2_loss: 0.015940    loss: 1.481279
steps 3600    v_Prec: 0.516125  v_Recall: 0.618394  v_F1: 0.562650  v_AUC: 0.843175
steps 3600    running time 157 seconds

steps 3800    base_loss: 0.339585    reg_loss: 1.090254    l2_loss: 0.016298    loss: 1.446136
steps 3800    v_Prec: 0.494190  v_Recall: 0.645138  v_F1: 0.559665  v_AUC: 0.844732
steps 3800    running time 164 seconds

steps 4000    base_loss: 0.335184    reg_loss: 1.035321    l2_loss: 0.016683    loss: 1.387189
steps 4000    v_Prec: 0.525871  v_Recall: 0.616637  v_F1: 0.567649  v_AUC: 0.846201
steps 4000    running time 170 seconds

steps 4200    base_loss: 0.340368    reg_loss: 1.016464    l2_loss: 0.017050    loss: 1.373881
steps 4200    v_Prec: 0.526673  v_Recall: 0.618713  v_F1: 0.568995  v_AUC: 0.849210
steps 4200    running time 177 seconds

steps 4400    base_loss: 0.328552    reg_loss: 0.961027    l2_loss: 0.017457    loss: 1.307035
steps 4400    v_Prec: 0.520563  v_Recall: 0.652802  v_F1: 0.579231  v_AUC: 0.853732
steps 4400    running time 183 seconds

steps 4600    base_loss: 0.330854    reg_loss: 0.929288    l2_loss: 0.017871    loss: 1.278013
steps 4600    v_Prec: 0.542639  v_Recall: 0.629411  v_F1: 0.582813  v_AUC: 0.855139
steps 4600    running time 190 seconds

steps 4800    base_loss: 0.323443    reg_loss: 0.880702    l2_loss: 0.018165    loss: 1.222311
steps 4800    v_Prec: 0.535620  v_Recall: 0.644659  v_F1: 0.585103  v_AUC: 0.858152
steps 4800    running time 197 seconds

steps 5000    base_loss: 0.332396    reg_loss: 0.869608    l2_loss: 0.018591    loss: 1.220595
steps 5000    v_Prec: 0.535826  v_Recall: 0.640588  v_F1: 0.583542  v_AUC: 0.859041
steps 5000    running time 204 seconds

steps 5200    base_loss: 0.328718    reg_loss: 0.831411    l2_loss: 0.019037    loss: 1.179166
steps 5200    v_Prec: 0.528723  v_Recall: 0.666454  v_F1: 0.589652  v_AUC: 0.859589
steps 5200    running time 210 seconds

steps 5400    base_loss: 0.329182    reg_loss: 0.802905    l2_loss: 0.019503    loss: 1.151590
steps 5400    v_Prec: 0.543584  v_Recall: 0.643222  v_F1: 0.589220  v_AUC: 0.859428
steps 5400    running time 216 seconds

steps 5600    base_loss: 0.290270    reg_loss: 0.678221    l2_loss: 0.019702    loss: 0.988193
steps 5600    v_Prec: 0.547172  v_Recall: 0.631087  v_F1: 0.586142  v_AUC: 0.853918
steps 5600    running time 223 seconds

steps 5800    base_loss: 0.304701    reg_loss: 0.692367    l2_loss: 0.019737    loss: 1.016805
steps 5800    v_Prec: 0.539386  v_Recall: 0.652163  v_F1: 0.590438  v_AUC: 0.856212
steps 5800    running time 229 seconds

steps 6000    base_loss: 0.298953    reg_loss: 0.674619    l2_loss: 0.019933    loss: 0.993506
steps 6000    v_Prec: 0.549665  v_Recall: 0.642344  v_F1: 0.592402  v_AUC: 0.861157
steps 6000    running time 236 seconds

steps 6200    base_loss: 0.300148    reg_loss: 0.666236    l2_loss: 0.020096    loss: 0.986480
steps 6200    v_Prec: 0.555240  v_Recall: 0.639151  v_F1: 0.594248  v_AUC: 0.857279
steps 6200    running time 242 seconds

steps 6400    base_loss: 0.304324    reg_loss: 0.659023    l2_loss: 0.020229    loss: 0.983577
steps 6400    v_Prec: 0.546575  v_Recall: 0.658630  v_F1: 0.597393  v_AUC: 0.859998
steps 6400    running time 249 seconds

steps 6600    base_loss: 0.307444    reg_loss: 0.645795    l2_loss: 0.020380    loss: 0.973618
steps 6600    v_Prec: 0.532767  v_Recall: 0.681463  v_F1: 0.598010  v_AUC: 0.858437
steps 6600    running time 255 seconds

steps 6800    base_loss: 0.302816    reg_loss: 0.641554    l2_loss: 0.020420    loss: 0.964790
steps 6800    v_Prec: 0.543692  v_Recall: 0.667092  v_F1: 0.599104  v_AUC: 0.860173
steps 6800    running time 262 seconds

steps 7000    base_loss: 0.300657    reg_loss: 0.637779    l2_loss: 0.020610    loss: 0.959046
steps 7000    v_Prec: 0.564501  v_Recall: 0.637554  v_F1: 0.598808  v_AUC: 0.863782
steps 7000    running time 268 seconds

steps 7200    base_loss: 0.301578    reg_loss: 0.621775    l2_loss: 0.020791    loss: 0.944144
steps 7200    v_Prec: 0.554369  v_Recall: 0.663021  v_F1: 0.603846  v_AUC: 0.867582
steps 7200    running time 274 seconds

steps 7400    base_loss: 0.300084    reg_loss: 0.611971    l2_loss: 0.020926    loss: 0.932981
steps 7400    v_Prec: 0.547594  v_Recall: 0.677870  v_F1: 0.605808  v_AUC: 0.867668
steps 7400    running time 281 seconds

steps 7600    base_loss: 0.303346    reg_loss: 0.609257    l2_loss: 0.021024    loss: 0.933627
steps 7600    v_Prec: 0.556711  v_Recall: 0.675555  v_F1: 0.610402  v_AUC: 0.869589
steps 7600    running time 288 seconds

steps 7800    base_loss: 0.305353    reg_loss: 0.616168    l2_loss: 0.021154    loss: 0.942674
steps 7800    v_Prec: 0.541751  v_Recall: 0.685774  v_F1: 0.605313  v_AUC: 0.869283
steps 7800    running time 295 seconds

steps 8000    base_loss: 0.307382    reg_loss: 0.611901    l2_loss: 0.021050    loss: 0.940333
steps 8000    v_Prec: 0.540480  v_Recall: 0.695513  v_F1: 0.608274  v_AUC: 0.869098
steps 8000    running time 301 seconds

steps 8200    base_loss: 0.305852    reg_loss: 0.605207    l2_loss: 0.021160    loss: 0.932219
steps 8200    v_Prec: 0.550729  v_Recall: 0.684257  v_F1: 0.610274  v_AUC: 0.871635
steps 8200    running time 307 seconds

steps 8400    base_loss: 0.305780    reg_loss: 0.596915    l2_loss: 0.021119    loss: 0.923815
steps 8400    v_Prec: 0.537308  v_Recall: 0.703656  v_F1: 0.609333  v_AUC: 0.869794
steps 8400    running time 313 seconds

steps 8600    base_loss: 0.297671    reg_loss: 0.580540    l2_loss: 0.021168    loss: 0.899379
steps 8600    v_Prec: 0.555995  v_Recall: 0.685295  v_F1: 0.613910  v_AUC: 0.871600
steps 8600    running time 319 seconds

steps 8800    base_loss: 0.305347    reg_loss: 0.586924    l2_loss: 0.021204    loss: 0.913474
steps 8800    v_Prec: 0.573236  v_Recall: 0.672681  v_F1: 0.618990  v_AUC: 0.872985
steps 8800    running time 326 seconds

steps 9000    base_loss: 0.295021    reg_loss: 0.573169    l2_loss: 0.021134    loss: 0.889324
steps 9000    v_Prec: 0.555648  v_Recall: 0.695913  v_F1: 0.617920  v_AUC: 0.873807
steps 9000    running time 333 seconds

steps 9200    base_loss: 0.302972    reg_loss: 0.571306    l2_loss: 0.021269    loss: 0.895547
steps 9200    v_Prec: 0.539894  v_Recall: 0.710362  v_F1: 0.613507  v_AUC: 0.872277
steps 9200    running time 339 seconds

steps 9400    base_loss: 0.299138    reg_loss: 0.571600    l2_loss: 0.021136    loss: 0.891874
steps 9400    v_Prec: 0.543994  v_Recall: 0.721619  v_F1: 0.620342  v_AUC: 0.874665
steps 9400    running time 345 seconds

steps 9600    base_loss: 0.299784    reg_loss: 0.562484    l2_loss: 0.021138    loss: 0.883405
steps 9600    v_Prec: 0.561581  v_Recall: 0.701102  v_F1: 0.623633  v_AUC: 0.874587
steps 9600    running time 351 seconds

steps 9800    base_loss: 0.300623    reg_loss: 0.575934    l2_loss: 0.021259    loss: 0.897816
steps 9800    v_Prec: 0.552620  v_Recall: 0.701341  v_F1: 0.618161  v_AUC: 0.872092
steps 9800    running time 358 seconds

steps 10000    base_loss: 0.298264    reg_loss: 0.571716    l2_loss: 0.021201    loss: 0.891181
steps 10000    v_Prec: 0.558965  v_Recall: 0.703816  v_F1: 0.623083  v_AUC: 0.872459
steps 10000    running time 364 seconds

steps 10200    base_loss: 0.294621    reg_loss: 0.546379    l2_loss: 0.021139    loss: 0.862139
steps 10200    v_Prec: 0.538647  v_Recall: 0.731039  v_F1: 0.620267  v_AUC: 0.875749
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.290651    reg_loss: 0.548142    l2_loss: 0.021203    loss: 0.859997
steps 10400    v_Prec: 0.556256  v_Recall: 0.718346  v_F1: 0.626995  v_AUC: 0.875365
steps 10400    running time 377 seconds

steps 10600    base_loss: 0.298426    reg_loss: 0.558422    l2_loss: 0.021175    loss: 0.878024
steps 10600    v_Prec: 0.552453  v_Recall: 0.728165  v_F1: 0.628255  v_AUC: 0.879452
steps 10600    running time 383 seconds

steps 10800    base_loss: 0.288181    reg_loss: 0.539052    l2_loss: 0.021128    loss: 0.848362
steps 10800    v_Prec: 0.551665  v_Recall: 0.724573  v_F1: 0.626406  v_AUC: 0.874761
steps 10800    running time 390 seconds

steps 11000    base_loss: 0.249484    reg_loss: 0.497091    l2_loss: 0.021105    loss: 0.767681
steps 11000    v_Prec: 0.571335  v_Recall: 0.694396  v_F1: 0.626883  v_AUC: 0.871535
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.267079    reg_loss: 0.520759    l2_loss: 0.021018    loss: 0.808856
steps 11200    v_Prec: 0.554334  v_Recall: 0.716749  v_F1: 0.625165  v_AUC: 0.870430
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.268149    reg_loss: 0.512426    l2_loss: 0.021181    loss: 0.801757
steps 11400    v_Prec: 0.571240  v_Recall: 0.692320  v_F1: 0.625979  v_AUC: 0.874203
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.261510    reg_loss: 0.500567    l2_loss: 0.021030    loss: 0.783107
steps 11600    v_Prec: 0.553662  v_Recall: 0.710841  v_F1: 0.622483  v_AUC: 0.873906
steps 11600    running time 415 seconds

steps 11800    base_loss: 0.267189    reg_loss: 0.521284    l2_loss: 0.021017    loss: 0.809490
steps 11800    v_Prec: 0.567788  v_Recall: 0.679387  v_F1: 0.618594  v_AUC: 0.872269
steps 11800    running time 421 seconds

steps 12000    base_loss: 0.266696    reg_loss: 0.517101    l2_loss: 0.020935    loss: 0.804732
steps 12000    v_Prec: 0.539534  v_Recall: 0.732157  v_F1: 0.621257  v_AUC: 0.871549
steps 12000    running time 427 seconds

steps 12200    base_loss: 0.263801    reg_loss: 0.511627    l2_loss: 0.020869    loss: 0.796297
steps 12200    v_Prec: 0.545438  v_Recall: 0.722098  v_F1: 0.621457  v_AUC: 0.871338
steps 12200    running time 434 seconds

steps 12400    base_loss: 0.264967    reg_loss: 0.497321    l2_loss: 0.020836    loss: 0.783125
steps 12400    v_Prec: 0.544916  v_Recall: 0.719623  v_F1: 0.620201  v_AUC: 0.873351
steps 12400    running time 440 seconds

steps 12600    base_loss: 0.266813    reg_loss: 0.510646    l2_loss: 0.020864    loss: 0.798323
steps 12600    v_Prec: 0.543411  v_Recall: 0.716031  v_F1: 0.617891  v_AUC: 0.874260
steps 12600    running time 447 seconds

Early stop model F1: 0.628255
testing thre: 0.29813972
testing Prec: 0.3821875924647401
testing Recall: 0.7533414337788579
testing F1: 0.5071076867710327
testing AUC: 0.8164874908978504
overall running time 450 seconds
(0.5027485817318263, 0.555625759416768, 0.5278662788013113, 0.8164874908978504, 0.59142303)

2019-02-24 02:39:54.853914: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:39:55.088832: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:39:55.090524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:39:55.090562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.520000 seconds
loading data in 30.650000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.779736    reg_loss: 2.153512    l2_loss: 0.013312    loss: 2.946560
steps 200    v_Prec: 0.165019  v_Recall: 0.996911  v_F1: 0.283166  v_AUC: 0.518049
steps 200    running time 40 seconds

steps 400    base_loss: 0.568672    reg_loss: 2.129860    l2_loss: 0.013352    loss: 2.711884
steps 400    v_Prec: 0.167525  v_Recall: 0.925313  v_F1: 0.283688  v_AUC: 0.522074
steps 400    running time 47 seconds

steps 600    base_loss: 0.495424    reg_loss: 2.096331    l2_loss: 0.013313    loss: 2.605068
steps 600    v_Prec: 0.167569  v_Recall: 0.916680  v_F1: 0.283343  v_AUC: 0.522068
steps 600    running time 53 seconds

steps 800    base_loss: 0.486900    reg_loss: 2.028228    l2_loss: 0.013306    loss: 2.528433
steps 800    v_Prec: 0.169177  v_Recall: 0.892127  v_F1: 0.284419  v_AUC: 0.529801
steps 800    running time 60 seconds

steps 1000    base_loss: 0.468877    reg_loss: 1.932080    l2_loss: 0.013180    loss: 2.414137
steps 1000    v_Prec: 0.180940  v_Recall: 0.770078  v_F1: 0.293029  v_AUC: 0.565251
steps 1000    running time 66 seconds

steps 1200    base_loss: 0.465648    reg_loss: 1.840706    l2_loss: 0.013226    loss: 2.319581
steps 1200    v_Prec: 0.224450  v_Recall: 0.586171  v_F1: 0.324605  v_AUC: 0.635678
steps 1200    running time 73 seconds

steps 1400    base_loss: 0.451395    reg_loss: 1.750522    l2_loss: 0.013297    loss: 2.215214
steps 1400    v_Prec: 0.276273  v_Recall: 0.545937  v_F1: 0.366883  v_AUC: 0.686716
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.434348    reg_loss: 1.668051    l2_loss: 0.013425    loss: 2.115823
steps 1600    v_Prec: 0.335506  v_Recall: 0.485110  v_F1: 0.396671  v_AUC: 0.713199
steps 1600    running time 86 seconds

steps 1800    base_loss: 0.418017    reg_loss: 1.605482    l2_loss: 0.013606    loss: 2.037105
steps 1800    v_Prec: 0.391964  v_Recall: 0.482892  v_F1: 0.432703  v_AUC: 0.738696
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.391400    reg_loss: 1.535222    l2_loss: 0.013804    loss: 1.940426
steps 2000    v_Prec: 0.430956  v_Recall: 0.509187  v_F1: 0.466817  v_AUC: 0.761016
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.386016    reg_loss: 1.501122    l2_loss: 0.014075    loss: 1.901214
steps 2200    v_Prec: 0.490741  v_Recall: 0.495327  v_F1: 0.493023  v_AUC: 0.780157
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.369567    reg_loss: 1.452123    l2_loss: 0.014407    loss: 1.836098
steps 2400    v_Prec: 0.488296  v_Recall: 0.546887  v_F1: 0.515934  v_AUC: 0.792791
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.363366    reg_loss: 1.419499    l2_loss: 0.014696    loss: 1.797561
steps 2600    v_Prec: 0.552955  v_Recall: 0.509029  v_F1: 0.530084  v_AUC: 0.802707
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.355447    reg_loss: 1.370246    l2_loss: 0.014989    loss: 1.740681
steps 2800    v_Prec: 0.571166  v_Recall: 0.517424  v_F1: 0.542969  v_AUC: 0.811306
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.351328    reg_loss: 1.339805    l2_loss: 0.015321    loss: 1.706454
steps 3000    v_Prec: 0.555765  v_Recall: 0.538334  v_F1: 0.546910  v_AUC: 0.815550
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.348938    reg_loss: 1.296451    l2_loss: 0.015622    loss: 1.661011
steps 3200    v_Prec: 0.550339  v_Recall: 0.559797  v_F1: 0.555028  v_AUC: 0.824154
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.342634    reg_loss: 1.253543    l2_loss: 0.015899    loss: 1.612076
steps 3400    v_Prec: 0.554648  v_Recall: 0.570331  v_F1: 0.562380  v_AUC: 0.831797
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.335642    reg_loss: 1.212133    l2_loss: 0.016269    loss: 1.564044
steps 3600    v_Prec: 0.606063  v_Recall: 0.527245  v_F1: 0.563914  v_AUC: 0.832551
steps 3600    running time 152 seconds

steps 3800    base_loss: 0.336198    reg_loss: 1.186233    l2_loss: 0.016436    loss: 1.538867
steps 3800    v_Prec: 0.604114  v_Recall: 0.546650  v_F1: 0.573947  v_AUC: 0.837002
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.336206    reg_loss: 1.138715    l2_loss: 0.016814    loss: 1.491735
steps 4000    v_Prec: 0.595596  v_Recall: 0.554887  v_F1: 0.574521  v_AUC: 0.839792
steps 4000    running time 166 seconds

steps 4200    base_loss: 0.335020    reg_loss: 1.095709    l2_loss: 0.017075    loss: 1.447805
steps 4200    v_Prec: 0.566805  v_Recall: 0.582607  v_F1: 0.574598  v_AUC: 0.840238
steps 4200    running time 173 seconds

steps 4400    base_loss: 0.326973    reg_loss: 1.058359    l2_loss: 0.017407    loss: 1.402739
steps 4400    v_Prec: 0.587401  v_Recall: 0.550927  v_F1: 0.568579  v_AUC: 0.838370
steps 4400    running time 180 seconds

steps 4600    base_loss: 0.329898    reg_loss: 1.021703    l2_loss: 0.017767    loss: 1.369367
steps 4600    v_Prec: 0.589638  v_Recall: 0.566054  v_F1: 0.577605  v_AUC: 0.840883
steps 4600    running time 187 seconds

steps 4800    base_loss: 0.334816    reg_loss: 0.991949    l2_loss: 0.018118    loss: 1.344883
steps 4800    v_Prec: 0.570887  v_Recall: 0.596388  v_F1: 0.583359  v_AUC: 0.847351
steps 4800    running time 193 seconds

steps 5000    base_loss: 0.334103    reg_loss: 0.958445    l2_loss: 0.018514    loss: 1.311062
steps 5000    v_Prec: 0.604556  v_Recall: 0.573816  v_F1: 0.588785  v_AUC: 0.853432
steps 5000    running time 200 seconds

steps 5200    base_loss: 0.323615    reg_loss: 0.928168    l2_loss: 0.018945    loss: 1.270728
steps 5200    v_Prec: 0.568988  v_Recall: 0.614684  v_F1: 0.590954  v_AUC: 0.854765
steps 5200    running time 206 seconds

steps 5400    base_loss: 0.313997    reg_loss: 0.874375    l2_loss: 0.019217    loss: 1.207589
steps 5400    v_Prec: 0.600114  v_Recall: 0.583241  v_F1: 0.591557  v_AUC: 0.852969
steps 5400    running time 213 seconds

steps 5600    base_loss: 0.277080    reg_loss: 0.747054    l2_loss: 0.019691    loss: 1.043825
steps 5600    v_Prec: 0.587475  v_Recall: 0.575796  v_F1: 0.581577  v_AUC: 0.842323
steps 5600    running time 219 seconds

steps 5800    base_loss: 0.283103    reg_loss: 0.747089    l2_loss: 0.020102    loss: 1.050294
steps 5800    v_Prec: 0.605430  v_Recall: 0.573974  v_F1: 0.589283  v_AUC: 0.841248
steps 5800    running time 226 seconds

steps 6000    base_loss: 0.285839    reg_loss: 0.746187    l2_loss: 0.020438    loss: 1.052464
steps 6000    v_Prec: 0.626813  v_Recall: 0.558055  v_F1: 0.590439  v_AUC: 0.850083
steps 6000    running time 232 seconds

steps 6200    base_loss: 0.286179    reg_loss: 0.725968    l2_loss: 0.020751    loss: 1.032899
steps 6200    v_Prec: 0.606815  v_Recall: 0.565579  v_F1: 0.585472  v_AUC: 0.851023
steps 6200    running time 238 seconds

steps 6400    base_loss: 0.291322    reg_loss: 0.727661    l2_loss: 0.020936    loss: 1.039919
steps 6400    v_Prec: 0.615581  v_Recall: 0.571994  v_F1: 0.592988  v_AUC: 0.851583
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.284407    reg_loss: 0.710889    l2_loss: 0.021222    loss: 1.016517
steps 6600    v_Prec: 0.611616  v_Recall: 0.586330  v_F1: 0.598706  v_AUC: 0.853247
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.291744    reg_loss: 0.701755    l2_loss: 0.021354    loss: 1.014853
steps 6800    v_Prec: 0.622137  v_Recall: 0.580944  v_F1: 0.600836  v_AUC: 0.855895
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.300829    reg_loss: 0.707434    l2_loss: 0.021527    loss: 1.029791
steps 7000    v_Prec: 0.619972  v_Recall: 0.594488  v_F1: 0.606962  v_AUC: 0.860697
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.292674    reg_loss: 0.697447    l2_loss: 0.021765    loss: 1.011886
steps 7200    v_Prec: 0.636055  v_Recall: 0.578726  v_F1: 0.606038  v_AUC: 0.862270
steps 7200    running time 271 seconds

steps 7400    base_loss: 0.292483    reg_loss: 0.682515    l2_loss: 0.021777    loss: 0.996775
steps 7400    v_Prec: 0.625519  v_Recall: 0.597180  v_F1: 0.611021  v_AUC: 0.863537
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.291632    reg_loss: 0.664522    l2_loss: 0.022008    loss: 0.978162
steps 7600    v_Prec: 0.623125  v_Recall: 0.602249  v_F1: 0.612510  v_AUC: 0.863948
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.291656    reg_loss: 0.649588    l2_loss: 0.021981    loss: 0.963225
steps 7800    v_Prec: 0.623700  v_Recall: 0.607793  v_F1: 0.615644  v_AUC: 0.866273
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.290693    reg_loss: 0.648154    l2_loss: 0.022209    loss: 0.961057
steps 8000    v_Prec: 0.615990  v_Recall: 0.613892  v_F1: 0.614939  v_AUC: 0.867980
steps 8000    running time 298 seconds

steps 8200    base_loss: 0.296000    reg_loss: 0.649149    l2_loss: 0.022490    loss: 0.967639
steps 8200    v_Prec: 0.633785  v_Recall: 0.607081  v_F1: 0.620146  v_AUC: 0.868546
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.298507    reg_loss: 0.647988    l2_loss: 0.022517    loss: 0.969012
steps 8400    v_Prec: 0.633015  v_Recall: 0.619278  v_F1: 0.626071  v_AUC: 0.872361
steps 8400    running time 311 seconds

steps 8600    base_loss: 0.293101    reg_loss: 0.633272    l2_loss: 0.022681    loss: 0.949055
steps 8600    v_Prec: 0.635025  v_Recall: 0.611437  v_F1: 0.623008  v_AUC: 0.872503
steps 8600    running time 318 seconds

steps 8800    base_loss: 0.289194    reg_loss: 0.615337    l2_loss: 0.022676    loss: 0.927208
steps 8800    v_Prec: 0.617489  v_Recall: 0.629178  v_F1: 0.623279  v_AUC: 0.870838
steps 8800    running time 324 seconds

steps 9000    base_loss: 0.300731    reg_loss: 0.629425    l2_loss: 0.022649    loss: 0.952805
steps 9000    v_Prec: 0.622595  v_Recall: 0.625455  v_F1: 0.624022  v_AUC: 0.874581
steps 9000    running time 330 seconds

steps 9200    base_loss: 0.292091    reg_loss: 0.613230    l2_loss: 0.022702    loss: 0.928023
steps 9200    v_Prec: 0.623602  v_Recall: 0.631554  v_F1: 0.627553  v_AUC: 0.873727
steps 9200    running time 337 seconds

steps 9400    base_loss: 0.288904    reg_loss: 0.613335    l2_loss: 0.022793    loss: 0.925031
steps 9400    v_Prec: 0.642751  v_Recall: 0.614446  v_F1: 0.628280  v_AUC: 0.875527
steps 9400    running time 343 seconds

steps 9600    base_loss: 0.298646    reg_loss: 0.616372    l2_loss: 0.022723    loss: 0.937742
steps 9600    v_Prec: 0.649283  v_Recall: 0.609377  v_F1: 0.628697  v_AUC: 0.877599
steps 9600    running time 350 seconds

steps 9800    base_loss: 0.293174    reg_loss: 0.595180    l2_loss: 0.022993    loss: 0.911347
steps 9800    v_Prec: 0.614846  v_Recall: 0.646206  v_F1: 0.630136  v_AUC: 0.879152
steps 9800    running time 357 seconds

steps 10000    base_loss: 0.292879    reg_loss: 0.601150    l2_loss: 0.022968    loss: 0.916997
steps 10000    v_Prec: 0.607759  v_Recall: 0.652622  v_F1: 0.629392  v_AUC: 0.881044
steps 10000    running time 363 seconds

steps 10200    base_loss: 0.290614    reg_loss: 0.585856    l2_loss: 0.023042    loss: 0.899512
steps 10200    v_Prec: 0.620902  v_Recall: 0.647949  v_F1: 0.634137  v_AUC: 0.881144
steps 10200    running time 370 seconds

steps 10400    base_loss: 0.295028    reg_loss: 0.589668    l2_loss: 0.023123    loss: 0.907819
steps 10400    v_Prec: 0.640339  v_Recall: 0.634405  v_F1: 0.637358  v_AUC: 0.883563
steps 10400    running time 376 seconds

steps 10600    base_loss: 0.290935    reg_loss: 0.580502    l2_loss: 0.022903    loss: 0.894340
steps 10600    v_Prec: 0.629839  v_Recall: 0.636623  v_F1: 0.633213  v_AUC: 0.879565
steps 10600    running time 382 seconds

steps 10800    base_loss: 0.281979    reg_loss: 0.569172    l2_loss: 0.023086    loss: 0.874237
steps 10800    v_Prec: 0.635316  v_Recall: 0.632900  v_F1: 0.634106  v_AUC: 0.877402
steps 10800    running time 389 seconds

steps 11000    base_loss: 0.248035    reg_loss: 0.519634    l2_loss: 0.023187    loss: 0.790855
steps 11000    v_Prec: 0.646823  v_Recall: 0.612704  v_F1: 0.629301  v_AUC: 0.872237
steps 11000    running time 396 seconds

steps 11200    base_loss: 0.243680    reg_loss: 0.515431    l2_loss: 0.023279    loss: 0.782390
steps 11200    v_Prec: 0.660156  v_Recall: 0.604942  v_F1: 0.631344  v_AUC: 0.872383
steps 11200    running time 402 seconds

steps 11400    base_loss: 0.241823    reg_loss: 0.517724    l2_loss: 0.023279    loss: 0.782825
steps 11400    v_Prec: 0.629420  v_Recall: 0.634405  v_F1: 0.631903  v_AUC: 0.873514
steps 11400    running time 408 seconds

steps 11600    base_loss: 0.254611    reg_loss: 0.521016    l2_loss: 0.023319    loss: 0.798946
steps 11600    v_Prec: 0.653507  v_Recall: 0.610962  v_F1: 0.631519  v_AUC: 0.873464
steps 11600    running time 414 seconds

steps 11800    base_loss: 0.257050    reg_loss: 0.535061    l2_loss: 0.023410    loss: 0.815521
steps 11800    v_Prec: 0.667256  v_Recall: 0.598289  v_F1: 0.630893  v_AUC: 0.870738
steps 11800    running time 420 seconds

steps 12000    base_loss: 0.253082    reg_loss: 0.524964    l2_loss: 0.023392    loss: 0.801438
steps 12000    v_Prec: 0.624660  v_Recall: 0.636385  v_F1: 0.630468  v_AUC: 0.873020
steps 12000    running time 426 seconds

steps 12200    base_loss: 0.256550    reg_loss: 0.529094    l2_loss: 0.023534    loss: 0.809178
steps 12200    v_Prec: 0.649392  v_Recall: 0.613338  v_F1: 0.630850  v_AUC: 0.872800
steps 12200    running time 433 seconds

steps 12400    base_loss: 0.257231    reg_loss: 0.518305    l2_loss: 0.023362    loss: 0.798898
steps 12400    v_Prec: 0.634336  v_Recall: 0.621575  v_F1: 0.627890  v_AUC: 0.872765
steps 12400    running time 439 seconds

Early stop model F1: 0.637358
testing thre: 0.26574838
testing Prec: 0.387949718248808
testing Recall: 0.7394896719319562
testing F1: 0.5089139378532963
testing AUC: 0.8316029238714144
overall running time 442 seconds
(0.5264066903008817, 0.5629161603888214, 0.544049604246424, 0.8316029238714144, 0.49681813)

2019-02-24 02:44:58.865047: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:44:59.436152: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:44:59.437110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:44:59.437146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.620000 seconds
loading data in 30.780000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 1.017692    reg_loss: 2.158016    l2_loss: 0.013280    loss: 3.188988
steps 200    v_Prec: 0.163239  v_Recall: 1.000000  v_F1: 0.280664  v_AUC: 0.467994
steps 200    running time 40 seconds

steps 400    base_loss: 0.659320    reg_loss: 2.136030    l2_loss: 0.013233    loss: 2.808583
steps 400    v_Prec: 0.163244  v_Recall: 1.000000  v_F1: 0.280670  v_AUC: 0.458129
steps 400    running time 47 seconds

steps 600    base_loss: 0.496469    reg_loss: 2.091834    l2_loss: 0.013146    loss: 2.601450
steps 600    v_Prec: 0.163242  v_Recall: 1.000000  v_F1: 0.280667  v_AUC: 0.451421
steps 600    running time 54 seconds

steps 800    base_loss: 0.477217    reg_loss: 2.009552    l2_loss: 0.013037    loss: 2.499805
steps 800    v_Prec: 0.163394  v_Recall: 0.999041  v_F1: 0.280854  v_AUC: 0.463696
steps 800    running time 60 seconds

steps 1000    base_loss: 0.474948    reg_loss: 1.906546    l2_loss: 0.012923    loss: 2.394417
steps 1000    v_Prec: 0.166879  v_Recall: 0.962033  v_F1: 0.284421  v_AUC: 0.513540
steps 1000    running time 67 seconds

steps 1200    base_loss: 0.460668    reg_loss: 1.798997    l2_loss: 0.012853    loss: 2.272518
steps 1200    v_Prec: 0.218392  v_Recall: 0.532252  v_F1: 0.309707  v_AUC: 0.612199
steps 1200    running time 74 seconds

steps 1400    base_loss: 0.444154    reg_loss: 1.696677    l2_loss: 0.012866    loss: 2.153697
steps 1400    v_Prec: 0.268307  v_Recall: 0.407961  v_F1: 0.323714  v_AUC: 0.636974
steps 1400    running time 80 seconds

steps 1600    base_loss: 0.441185    reg_loss: 1.624389    l2_loss: 0.012911    loss: 2.078486
steps 1600    v_Prec: 0.300885  v_Recall: 0.415794  v_F1: 0.349128  v_AUC: 0.665449
steps 1600    running time 87 seconds

steps 1800    base_loss: 0.429622    reg_loss: 1.560154    l2_loss: 0.013063    loss: 2.002838
steps 1800    v_Prec: 0.322377  v_Recall: 0.449205  v_F1: 0.375367  v_AUC: 0.694384
steps 1800    running time 93 seconds

steps 2000    base_loss: 0.423037    reg_loss: 1.516458    l2_loss: 0.013215    loss: 1.952709
steps 2000    v_Prec: 0.364636  v_Recall: 0.493166  v_F1: 0.419272  v_AUC: 0.733460
steps 2000    running time 100 seconds

steps 2200    base_loss: 0.403601    reg_loss: 1.449913    l2_loss: 0.013482    loss: 1.866996
steps 2200    v_Prec: 0.403451  v_Recall: 0.502678  v_F1: 0.447632  v_AUC: 0.756578
steps 2200    running time 106 seconds

steps 2400    base_loss: 0.400294    reg_loss: 1.416297    l2_loss: 0.013720    loss: 1.830311
steps 2400    v_Prec: 0.455391  v_Recall: 0.528335  v_F1: 0.489159  v_AUC: 0.785651
steps 2400    running time 113 seconds

steps 2600    base_loss: 0.385685    reg_loss: 1.363837    l2_loss: 0.014064    loss: 1.763586
steps 2600    v_Prec: 0.472181  v_Recall: 0.553513  v_F1: 0.509622  v_AUC: 0.799064
steps 2600    running time 119 seconds

steps 2800    base_loss: 0.368717    reg_loss: 1.300008    l2_loss: 0.014436    loss: 1.683161
steps 2800    v_Prec: 0.539437  v_Recall: 0.547198  v_F1: 0.543290  v_AUC: 0.814615
steps 2800    running time 126 seconds

steps 3000    base_loss: 0.366303    reg_loss: 1.262502    l2_loss: 0.014844    loss: 1.643648
steps 3000    v_Prec: 0.539065  v_Recall: 0.554792  v_F1: 0.546815  v_AUC: 0.819194
steps 3000    running time 133 seconds

steps 3200    base_loss: 0.354856    reg_loss: 1.204891    l2_loss: 0.015247    loss: 1.574994
steps 3200    v_Prec: 0.522178  v_Recall: 0.595636  v_F1: 0.556493  v_AUC: 0.826725
steps 3200    running time 139 seconds

steps 3400    base_loss: 0.351799    reg_loss: 1.157357    l2_loss: 0.015669    loss: 1.524825
steps 3400    v_Prec: 0.557271  v_Recall: 0.582927  v_F1: 0.569810  v_AUC: 0.832871
steps 3400    running time 146 seconds

steps 3600    base_loss: 0.350985    reg_loss: 1.112052    l2_loss: 0.016158    loss: 1.479195
steps 3600    v_Prec: 0.542508  v_Recall: 0.596755  v_F1: 0.568340  v_AUC: 0.833370
steps 3600    running time 153 seconds

steps 3800    base_loss: 0.356389    reg_loss: 1.074309    l2_loss: 0.016573    loss: 1.447271
steps 3800    v_Prec: 0.553138  v_Recall: 0.601551  v_F1: 0.576330  v_AUC: 0.836602
steps 3800    running time 159 seconds

steps 4000    base_loss: 0.354433    reg_loss: 1.037759    l2_loss: 0.016974    loss: 1.409166
steps 4000    v_Prec: 0.537644  v_Recall: 0.610743  v_F1: 0.571867  v_AUC: 0.836570
steps 4000    running time 165 seconds

steps 4200    base_loss: 0.343507    reg_loss: 0.996420    l2_loss: 0.017474    loss: 1.357401
steps 4200    v_Prec: 0.530244  v_Recall: 0.626409  v_F1: 0.574329  v_AUC: 0.837248
steps 4200    running time 172 seconds

steps 4400    base_loss: 0.344409    reg_loss: 0.956123    l2_loss: 0.017947    loss: 1.318478
steps 4400    v_Prec: 0.537175  v_Recall: 0.626569  v_F1: 0.578439  v_AUC: 0.841994
steps 4400    running time 178 seconds

steps 4600    base_loss: 0.341863    reg_loss: 0.911381    l2_loss: 0.018335    loss: 1.271579
steps 4600    v_Prec: 0.544584  v_Recall: 0.632164  v_F1: 0.585115  v_AUC: 0.847313
steps 4600    running time 185 seconds

steps 4800    base_loss: 0.345442    reg_loss: 0.895929    l2_loss: 0.018805    loss: 1.260176
steps 4800    v_Prec: 0.560347  v_Recall: 0.620094  v_F1: 0.588708  v_AUC: 0.847808
steps 4800    running time 191 seconds

steps 5000    base_loss: 0.343495    reg_loss: 0.860401    l2_loss: 0.019197    loss: 1.223094
steps 5000    v_Prec: 0.524666  v_Recall: 0.669011  v_F1: 0.588111  v_AUC: 0.845000
steps 5000    running time 197 seconds

steps 5200    base_loss: 0.341246    reg_loss: 0.824705    l2_loss: 0.019634    loss: 1.185584
steps 5200    v_Prec: 0.553429  v_Recall: 0.626329  v_F1: 0.587627  v_AUC: 0.844639
steps 5200    running time 204 seconds

steps 5400    base_loss: 0.341656    reg_loss: 0.799147    l2_loss: 0.020069    loss: 1.160872
steps 5400    v_Prec: 0.547596  v_Recall: 0.629926  v_F1: 0.585883  v_AUC: 0.843630
steps 5400    running time 210 seconds

steps 5600    base_loss: 0.316700    reg_loss: 0.680612    l2_loss: 0.020505    loss: 1.017817
steps 5600    v_Prec: 0.517320  v_Recall: 0.655343  v_F1: 0.578209  v_AUC: 0.843684
steps 5600    running time 216 seconds

steps 5800    base_loss: 0.324623    reg_loss: 0.691717    l2_loss: 0.020689    loss: 1.037030
steps 5800    v_Prec: 0.547771  v_Recall: 0.630565  v_F1: 0.586259  v_AUC: 0.840466
steps 5800    running time 223 seconds

steps 6000    base_loss: 0.316686    reg_loss: 0.668726    l2_loss: 0.021016    loss: 1.006428
steps 6000    v_Prec: 0.536561  v_Recall: 0.649269  v_F1: 0.587559  v_AUC: 0.842844
steps 6000    running time 229 seconds

steps 6200    base_loss: 0.316665    reg_loss: 0.663987    l2_loss: 0.021395    loss: 1.002047
steps 6200    v_Prec: 0.518623  v_Recall: 0.677804  v_F1: 0.587624  v_AUC: 0.844457
steps 6200    running time 235 seconds

steps 6400    base_loss: 0.318444    reg_loss: 0.649431    l2_loss: 0.021785    loss: 0.989660
steps 6400    v_Prec: 0.532290  v_Recall: 0.673967  v_F1: 0.594808  v_AUC: 0.848833
steps 6400    running time 241 seconds

steps 6600    base_loss: 0.323135    reg_loss: 0.653754    l2_loss: 0.021933    loss: 0.998822
steps 6600    v_Prec: 0.515674  v_Recall: 0.686356  v_F1: 0.588897  v_AUC: 0.850010
steps 6600    running time 247 seconds

steps 6800    base_loss: 0.318288    reg_loss: 0.642056    l2_loss: 0.022273    loss: 0.982617
steps 6800    v_Prec: 0.548660  v_Recall: 0.664215  v_F1: 0.600933  v_AUC: 0.848976
steps 6800    running time 253 seconds

steps 7000    base_loss: 0.319628    reg_loss: 0.634994    l2_loss: 0.022451    loss: 0.977073
steps 7000    v_Prec: 0.525032  v_Recall: 0.684837  v_F1: 0.594381  v_AUC: 0.852982
steps 7000    running time 260 seconds

steps 7200    base_loss: 0.318039    reg_loss: 0.616737    l2_loss: 0.022604    loss: 0.957380
steps 7200    v_Prec: 0.572622  v_Recall: 0.641276  v_F1: 0.605007  v_AUC: 0.850868
steps 7200    running time 266 seconds

steps 7400    base_loss: 0.313498    reg_loss: 0.605438    l2_loss: 0.022765    loss: 0.941702
steps 7400    v_Prec: 0.536346  v_Recall: 0.681161  v_F1: 0.600141  v_AUC: 0.850574
steps 7400    running time 272 seconds

steps 7600    base_loss: 0.314720    reg_loss: 0.609949    l2_loss: 0.022944    loss: 0.947614
steps 7600    v_Prec: 0.539914  v_Recall: 0.690352  v_F1: 0.605935  v_AUC: 0.856566
steps 7600    running time 278 seconds

steps 7800    base_loss: 0.313643    reg_loss: 0.600685    l2_loss: 0.023119    loss: 0.937447
steps 7800    v_Prec: 0.533203  v_Recall: 0.699544  v_F1: 0.605151  v_AUC: 0.855505
steps 7800    running time 285 seconds

steps 8000    base_loss: 0.321092    reg_loss: 0.604950    l2_loss: 0.022965    loss: 0.949006
steps 8000    v_Prec: 0.545367  v_Recall: 0.676445  v_F1: 0.603875  v_AUC: 0.855292
steps 8000    running time 291 seconds

steps 8200    base_loss: 0.318111    reg_loss: 0.601426    l2_loss: 0.023246    loss: 0.942783
steps 8200    v_Prec: 0.564371  v_Recall: 0.660139  v_F1: 0.608510  v_AUC: 0.857186
steps 8200    running time 297 seconds

steps 8400    base_loss: 0.319492    reg_loss: 0.599875    l2_loss: 0.023266    loss: 0.942633
steps 8400    v_Prec: 0.554144  v_Recall: 0.686756  v_F1: 0.613364  v_AUC: 0.853790
steps 8400    running time 304 seconds

steps 8600    base_loss: 0.316965    reg_loss: 0.591799    l2_loss: 0.023420    loss: 0.932184
steps 8600    v_Prec: 0.545871  v_Recall: 0.685796  v_F1: 0.607886  v_AUC: 0.859505
steps 8600    running time 311 seconds

steps 8800    base_loss: 0.317078    reg_loss: 0.586511    l2_loss: 0.023426    loss: 0.927015
steps 8800    v_Prec: 0.541538  v_Recall: 0.701303  v_F1: 0.611152  v_AUC: 0.861293
steps 8800    running time 317 seconds

steps 9000    base_loss: 0.321262    reg_loss: 0.585597    l2_loss: 0.023448    loss: 0.930308
steps 9000    v_Prec: 0.526663  v_Recall: 0.715211  v_F1: 0.606624  v_AUC: 0.862076
steps 9000    running time 324 seconds

steps 9200    base_loss: 0.322570    reg_loss: 0.571705    l2_loss: 0.023543    loss: 0.917818
steps 9200    v_Prec: 0.557660  v_Recall: 0.691871  v_F1: 0.617558  v_AUC: 0.863580
steps 9200    running time 330 seconds

steps 9400    base_loss: 0.316687    reg_loss: 0.580169    l2_loss: 0.023611    loss: 0.920466
steps 9400    v_Prec: 0.559230  v_Recall: 0.685237  v_F1: 0.615854  v_AUC: 0.859793
steps 9400    running time 336 seconds

steps 9600    base_loss: 0.306710    reg_loss: 0.548086    l2_loss: 0.023640    loss: 0.878437
steps 9600    v_Prec: 0.545477  v_Recall: 0.699864  v_F1: 0.613101  v_AUC: 0.860793
steps 9600    running time 342 seconds

steps 9800    base_loss: 0.316413    reg_loss: 0.564534    l2_loss: 0.023773    loss: 0.904720
steps 9800    v_Prec: 0.546361  v_Recall: 0.709296  v_F1: 0.617257  v_AUC: 0.860148
steps 9800    running time 349 seconds

steps 10000    base_loss: 0.319487    reg_loss: 0.567660    l2_loss: 0.023905    loss: 0.911052
steps 10000    v_Prec: 0.553173  v_Recall: 0.707218  v_F1: 0.620782  v_AUC: 0.861624
steps 10000    running time 355 seconds

steps 10200    base_loss: 0.309427    reg_loss: 0.545629    l2_loss: 0.023813    loss: 0.878869
steps 10200    v_Prec: 0.578868  v_Recall: 0.674367  v_F1: 0.622979  v_AUC: 0.862587
steps 10200    running time 362 seconds

steps 10400    base_loss: 0.307617    reg_loss: 0.544255    l2_loss: 0.023759    loss: 0.875631
steps 10400    v_Prec: 0.558521  v_Recall: 0.710974  v_F1: 0.625593  v_AUC: 0.865120
steps 10400    running time 368 seconds

steps 10600    base_loss: 0.312784    reg_loss: 0.562177    l2_loss: 0.023687    loss: 0.898648
steps 10600    v_Prec: 0.567554  v_Recall: 0.700743  v_F1: 0.627155  v_AUC: 0.867987
steps 10600    running time 375 seconds

steps 10800    base_loss: 0.308079    reg_loss: 0.549424    l2_loss: 0.023887    loss: 0.881390
steps 10800    v_Prec: 0.563481  v_Recall: 0.708417  v_F1: 0.627691  v_AUC: 0.864172
steps 10800    running time 382 seconds

steps 11000    base_loss: 0.287049    reg_loss: 0.524899    l2_loss: 0.023761    loss: 0.835708
steps 11000    v_Prec: 0.553710  v_Recall: 0.703301  v_F1: 0.619604  v_AUC: 0.856190
steps 11000    running time 389 seconds

steps 11200    base_loss: 0.284610    reg_loss: 0.515559    l2_loss: 0.023759    loss: 0.823928
steps 11200    v_Prec: 0.551949  v_Recall: 0.702742  v_F1: 0.618284  v_AUC: 0.861861
steps 11200    running time 396 seconds

steps 11400    base_loss: 0.282826    reg_loss: 0.514225    l2_loss: 0.023797    loss: 0.820848
steps 11400    v_Prec: 0.534538  v_Recall: 0.711933  v_F1: 0.610612  v_AUC: 0.853864
steps 11400    running time 402 seconds

steps 11600    base_loss: 0.287948    reg_loss: 0.533448    l2_loss: 0.023877    loss: 0.845273
steps 11600    v_Prec: 0.529798  v_Recall: 0.729038  v_F1: 0.613651  v_AUC: 0.860030
steps 11600    running time 408 seconds

steps 11800    base_loss: 0.287359    reg_loss: 0.516800    l2_loss: 0.023861    loss: 0.828020
steps 11800    v_Prec: 0.543209  v_Recall: 0.715450  v_F1: 0.617545  v_AUC: 0.856038
steps 11800    running time 414 seconds

steps 12000    base_loss: 0.285071    reg_loss: 0.513947    l2_loss: 0.023735    loss: 0.822752
steps 12000    v_Prec: 0.553021  v_Recall: 0.695708  v_F1: 0.616212  v_AUC: 0.859463
steps 12000    running time 421 seconds

steps 12200    base_loss: 0.286480    reg_loss: 0.515846    l2_loss: 0.023726    loss: 0.826052
steps 12200    v_Prec: 0.564783  v_Recall: 0.678363  v_F1: 0.616385  v_AUC: 0.862560
steps 12200    running time 427 seconds

steps 12400    base_loss: 0.280750    reg_loss: 0.502469    l2_loss: 0.023419    loss: 0.806638
steps 12400    v_Prec: 0.550684  v_Recall: 0.710814  v_F1: 0.620586  v_AUC: 0.862323
steps 12400    running time 433 seconds

steps 12600    base_loss: 0.288396    reg_loss: 0.516787    l2_loss: 0.023315    loss: 0.828498
steps 12600    v_Prec: 0.533087  v_Recall: 0.726321  v_F1: 0.614880  v_AUC: 0.859881
steps 12600    running time 439 seconds

steps 12800    base_loss: 0.288577    reg_loss: 0.526285    l2_loss: 0.023429    loss: 0.838290
steps 12800    v_Prec: 0.538102  v_Recall: 0.736552  v_F1: 0.621879  v_AUC: 0.863723
steps 12800    running time 445 seconds

Early stop model F1: 0.627691
testing thre: 0.28313538
testing Prec: 0.3959571277836397
testing Recall: 0.6930741190765493
testing F1: 0.5039848733852867
testing AUC: 0.8019785860270111
overall running time 447 seconds
(0.4670891089108911, 0.5732199270959902, 0.5147408619749044, 0.8019785860270111, 0.42864573)

2019-02-24 02:50:05.074703: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2019-02-24 02:50:05.915020: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:892] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-02-24 02:50:05.921453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:00:10.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2019-02-24 02:50:05.921536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:00:10.0, compute capability: 6.1)
user_feat_size is 11, in 24.430000 seconds
loading data in 30.520000 seconds
train/valid/test size: 689776/76642/125268
poi_feat_size 	3
dim 	64
action_feat_size 	1
cuda_devices 	6
epsilon 	1e-06
dropout 	0.4
fnn_hidden 	16
item_size 	231017
batch_size 	128
patience 	10
warmup_steps 	5388
reg_weight 	1.0
user_feat_size 	11
l2_weight 	1e-05
max_steps 	100000
dir 	../nyc/
steps 200    base_loss: 0.721504    reg_loss: 2.155439    l2_loss: 0.013319    loss: 2.890262
steps 200    v_Prec: 0.163899  v_Recall: 0.998167  v_F1: 0.281565  v_AUC: 0.529687
steps 200    running time 41 seconds

steps 400    base_loss: 0.543825    reg_loss: 2.133088    l2_loss: 0.013281    loss: 2.690194
steps 400    v_Prec: 0.164943  v_Recall: 0.972344  v_F1: 0.282042  v_AUC: 0.541337
steps 400    running time 48 seconds

steps 600    base_loss: 0.491682    reg_loss: 2.078777    l2_loss: 0.013169    loss: 2.583628
steps 600    v_Prec: 0.180118  v_Recall: 0.744560  v_F1: 0.290066  v_AUC: 0.568091
steps 600    running time 55 seconds

steps 800    base_loss: 0.473494    reg_loss: 2.006603    l2_loss: 0.013132    loss: 2.493229
steps 800    v_Prec: 0.214695  v_Recall: 0.549853  v_F1: 0.308811  v_AUC: 0.608642
steps 800    running time 62 seconds

steps 1000    base_loss: 0.449968    reg_loss: 1.916539    l2_loss: 0.013031    loss: 2.379538
steps 1000    v_Prec: 0.245650  v_Recall: 0.504105  v_F1: 0.330330  v_AUC: 0.633367
steps 1000    running time 69 seconds

steps 1200    base_loss: 0.435549    reg_loss: 1.813700    l2_loss: 0.013014    loss: 2.262263
steps 1200    v_Prec: 0.318104  v_Recall: 0.398980  v_F1: 0.353981  v_AUC: 0.658841
steps 1200    running time 75 seconds

steps 1400    base_loss: 0.426182    reg_loss: 1.725037    l2_loss: 0.013003    loss: 2.164222
steps 1400    v_Prec: 0.346006  v_Recall: 0.407667  v_F1: 0.374314  v_AUC: 0.678280
steps 1400    running time 82 seconds

steps 1600    base_loss: 0.428660    reg_loss: 1.662384    l2_loss: 0.013120    loss: 2.104163
steps 1600    v_Prec: 0.363128  v_Recall: 0.466247  v_F1: 0.408277  v_AUC: 0.709915
steps 1600    running time 88 seconds

steps 1800    base_loss: 0.407470    reg_loss: 1.587226    l2_loss: 0.013284    loss: 2.007980
steps 1800    v_Prec: 0.411974  v_Recall: 0.470551  v_F1: 0.439318  v_AUC: 0.738896
steps 1800    running time 95 seconds

steps 2000    base_loss: 0.395005    reg_loss: 1.528705    l2_loss: 0.013435    loss: 1.937145
steps 2000    v_Prec: 0.452929  v_Recall: 0.489280  v_F1: 0.470403  v_AUC: 0.767390
steps 2000    running time 101 seconds

steps 2200    base_loss: 0.377655    reg_loss: 1.471207    l2_loss: 0.013641    loss: 1.862503
steps 2200    v_Prec: 0.472543  v_Recall: 0.522595  v_F1: 0.496310  v_AUC: 0.789478
steps 2200    running time 108 seconds

steps 2400    base_loss: 0.372037    reg_loss: 1.434459    l2_loss: 0.013847    loss: 1.820343
steps 2400    v_Prec: 0.504372  v_Recall: 0.560851  v_F1: 0.531114  v_AUC: 0.809731
steps 2400    running time 115 seconds

steps 2600    base_loss: 0.357723    reg_loss: 1.376233    l2_loss: 0.014091    loss: 1.748046
steps 2600    v_Prec: 0.525069  v_Recall: 0.561728  v_F1: 0.542780  v_AUC: 0.822225
steps 2600    running time 121 seconds

steps 2800    base_loss: 0.349373    reg_loss: 1.327809    l2_loss: 0.014379    loss: 1.691561
steps 2800    v_Prec: 0.505262  v_Recall: 0.612258  v_F1: 0.553638  v_AUC: 0.831746
steps 2800    running time 128 seconds

steps 3000    base_loss: 0.338749    reg_loss: 1.275797    l2_loss: 0.014617    loss: 1.629163
steps 3000    v_Prec: 0.524737  v_Recall: 0.603571  v_F1: 0.561400  v_AUC: 0.835928
steps 3000    running time 134 seconds

steps 3200    base_loss: 0.339967    reg_loss: 1.232343    l2_loss: 0.014879    loss: 1.587188
steps 3200    v_Prec: 0.535206  v_Recall: 0.608831  v_F1: 0.569650  v_AUC: 0.841239
steps 3200    running time 141 seconds

steps 3400    base_loss: 0.334083    reg_loss: 1.187338    l2_loss: 0.015203    loss: 1.536623
steps 3400    v_Prec: 0.549668  v_Recall: 0.601100  v_F1: 0.574235  v_AUC: 0.845165
steps 3400    running time 148 seconds

steps 3600    base_loss: 0.337398    reg_loss: 1.146378    l2_loss: 0.015518    loss: 1.499295
steps 3600    v_Prec: 0.545763  v_Recall: 0.615924  v_F1: 0.578725  v_AUC: 0.847693
steps 3600    running time 155 seconds

steps 3800    base_loss: 0.330477    reg_loss: 1.092246    l2_loss: 0.015800    loss: 1.438523
steps 3800    v_Prec: 0.537554  v_Recall: 0.624611  v_F1: 0.577822  v_AUC: 0.849556
steps 3800    running time 162 seconds

steps 4000    base_loss: 0.333831    reg_loss: 1.067079    l2_loss: 0.016100    loss: 1.417010
steps 4000    v_Prec: 0.559003  v_Recall: 0.620308  v_F1: 0.588062  v_AUC: 0.852196
steps 4000    running time 168 seconds

steps 4200    base_loss: 0.331337    reg_loss: 1.013276    l2_loss: 0.016449    loss: 1.361062
steps 4200    v_Prec: 0.571799  v_Recall: 0.615047  v_F1: 0.592635  v_AUC: 0.854637
steps 4200    running time 175 seconds

steps 4400    base_loss: 0.331468    reg_loss: 0.984529    l2_loss: 0.016761    loss: 1.332758
steps 4400    v_Prec: 0.531768  v_Recall: 0.662389  v_F1: 0.589935  v_AUC: 0.857201
steps 4400    running time 182 seconds

steps 4600    base_loss: 0.331378    reg_loss: 0.951373    l2_loss: 0.017087    loss: 1.299839
steps 4600    v_Prec: 0.567427  v_Recall: 0.628118  v_F1: 0.596232  v_AUC: 0.859877
steps 4600    running time 189 seconds

steps 4800    base_loss: 0.323766    reg_loss: 0.899486    l2_loss: 0.017476    loss: 1.240728
steps 4800    v_Prec: 0.535126  v_Recall: 0.655057  v_F1: 0.589049  v_AUC: 0.857975
steps 4800    running time 195 seconds

steps 5000    base_loss: 0.323880    reg_loss: 0.861497    l2_loss: 0.017790    loss: 1.203167
steps 5000    v_Prec: 0.556537  v_Recall: 0.653144  v_F1: 0.600983  v_AUC: 0.862410
steps 5000    running time 201 seconds

steps 5200    base_loss: 0.328084    reg_loss: 0.847991    l2_loss: 0.018239    loss: 1.194314
steps 5200    v_Prec: 0.565241  v_Recall: 0.650116  v_F1: 0.604715  v_AUC: 0.864169
steps 5200    running time 208 seconds

steps 5400    base_loss: 0.332402    reg_loss: 0.821810    l2_loss: 0.018701    loss: 1.172914
steps 5400    v_Prec: 0.559950  v_Recall: 0.648761  v_F1: 0.601093  v_AUC: 0.865060
steps 5400    running time 214 seconds

steps 5600    base_loss: 0.297227    reg_loss: 0.695433    l2_loss: 0.018830    loss: 1.011490
steps 5600    v_Prec: 0.546758  v_Recall: 0.656571  v_F1: 0.596654  v_AUC: 0.858671
steps 5600    running time 220 seconds

steps 5800    base_loss: 0.293271    reg_loss: 0.679258    l2_loss: 0.019141    loss: 0.991669
steps 5800    v_Prec: 0.579799  v_Recall: 0.628596  v_F1: 0.603212  v_AUC: 0.862842
steps 5800    running time 227 seconds

steps 6000    base_loss: 0.299285    reg_loss: 0.680226    l2_loss: 0.019336    loss: 0.998846
steps 6000    v_Prec: 0.566960  v_Recall: 0.632661  v_F1: 0.598011  v_AUC: 0.862965
steps 6000    running time 233 seconds

steps 6200    base_loss: 0.294440    reg_loss: 0.658174    l2_loss: 0.019434    loss: 0.972048
steps 6200    v_Prec: 0.559763  v_Recall: 0.655057  v_F1: 0.603672  v_AUC: 0.865694
steps 6200    running time 239 seconds

steps 6400    base_loss: 0.295767    reg_loss: 0.653202    l2_loss: 0.019730    loss: 0.968699
steps 6400    v_Prec: 0.564595  v_Recall: 0.637762  v_F1: 0.598952  v_AUC: 0.861172
steps 6400    running time 245 seconds

steps 6600    base_loss: 0.298827    reg_loss: 0.656749    l2_loss: 0.020019    loss: 0.975595
steps 6600    v_Prec: 0.580464  v_Recall: 0.634176  v_F1: 0.606132  v_AUC: 0.865914
steps 6600    running time 251 seconds

steps 6800    base_loss: 0.303098    reg_loss: 0.646845    l2_loss: 0.020151    loss: 0.970094
steps 6800    v_Prec: 0.555857  v_Recall: 0.669403  v_F1: 0.607369  v_AUC: 0.867416
steps 6800    running time 258 seconds

steps 7000    base_loss: 0.296037    reg_loss: 0.638841    l2_loss: 0.020399    loss: 0.955277
steps 7000    v_Prec: 0.580422  v_Recall: 0.647406  v_F1: 0.612087  v_AUC: 0.868002
steps 7000    running time 265 seconds

steps 7200    base_loss: 0.306184    reg_loss: 0.642818    l2_loss: 0.020560    loss: 0.969562
steps 7200    v_Prec: 0.579012  v_Recall: 0.638958  v_F1: 0.607510  v_AUC: 0.868393
steps 7200    running time 272 seconds

steps 7400    base_loss: 0.296399    reg_loss: 0.622529    l2_loss: 0.020557    loss: 0.939485
steps 7400    v_Prec: 0.596690  v_Recall: 0.626365  v_F1: 0.611167  v_AUC: 0.869351
steps 7400    running time 278 seconds

steps 7600    base_loss: 0.304792    reg_loss: 0.624803    l2_loss: 0.020638    loss: 0.950234
steps 7600    v_Prec: 0.593838  v_Recall: 0.640552  v_F1: 0.616311  v_AUC: 0.872925
steps 7600    running time 284 seconds

steps 7800    base_loss: 0.303580    reg_loss: 0.612904    l2_loss: 0.020894    loss: 0.937377
steps 7800    v_Prec: 0.574222  v_Recall: 0.657607  v_F1: 0.613093  v_AUC: 0.872306
steps 7800    running time 291 seconds

steps 8000    base_loss: 0.294781    reg_loss: 0.597470    l2_loss: 0.020893    loss: 0.913145
steps 8000    v_Prec: 0.574208  v_Recall: 0.677453  v_F1: 0.621572  v_AUC: 0.875378
steps 8000    running time 297 seconds

steps 8200    base_loss: 0.301476    reg_loss: 0.602946    l2_loss: 0.021100    loss: 0.925522
steps 8200    v_Prec: 0.582728  v_Recall: 0.664701  v_F1: 0.621021  v_AUC: 0.874293
steps 8200    running time 304 seconds

steps 8400    base_loss: 0.299694    reg_loss: 0.601454    l2_loss: 0.021139    loss: 0.922287
steps 8400    v_Prec: 0.578124  v_Recall: 0.671475  v_F1: 0.621313  v_AUC: 0.876382
steps 8400    running time 310 seconds

steps 8600    base_loss: 0.300592    reg_loss: 0.601996    l2_loss: 0.021139    loss: 0.923727
steps 8600    v_Prec: 0.557553  v_Recall: 0.699530  v_F1: 0.620524  v_AUC: 0.875733
steps 8600    running time 316 seconds

steps 8800    base_loss: 0.296190    reg_loss: 0.583565    l2_loss: 0.021261    loss: 0.901016
steps 8800    v_Prec: 0.554600  v_Recall: 0.709174  v_F1: 0.622434  v_AUC: 0.877067
steps 8800    running time 323 seconds

steps 9000    base_loss: 0.299473    reg_loss: 0.587301    l2_loss: 0.021143    loss: 0.907917
steps 9000    v_Prec: 0.595166  v_Recall: 0.653463  v_F1: 0.622953  v_AUC: 0.877152
steps 9000    running time 329 seconds

steps 9200    base_loss: 0.298733    reg_loss: 0.580375    l2_loss: 0.021214    loss: 0.900322
steps 9200    v_Prec: 0.555720  v_Recall: 0.718180  v_F1: 0.626591  v_AUC: 0.879451
steps 9200    running time 336 seconds

steps 9400    base_loss: 0.295734    reg_loss: 0.568471    l2_loss: 0.021311    loss: 0.885516
steps 9400    v_Prec: 0.553623  v_Recall: 0.720411  v_F1: 0.626100  v_AUC: 0.878896
steps 9400    running time 342 seconds

steps 9600    base_loss: 0.292142    reg_loss: 0.558904    l2_loss: 0.021372    loss: 0.872418
steps 9600    v_Prec: 0.565475  v_Recall: 0.698653  v_F1: 0.625049  v_AUC: 0.877713
steps 9600    running time 348 seconds

steps 9800    base_loss: 0.297267    reg_loss: 0.555733    l2_loss: 0.021489    loss: 0.874490
steps 9800    v_Prec: 0.566108  v_Recall: 0.705029  v_F1: 0.627977  v_AUC: 0.878387
steps 9800    running time 354 seconds

steps 10000    base_loss: 0.301097    reg_loss: 0.559782    l2_loss: 0.021294    loss: 0.882173
steps 10000    v_Prec: 0.594883  v_Recall: 0.674584  v_F1: 0.632232  v_AUC: 0.881300
steps 10000    running time 360 seconds

steps 10200    base_loss: 0.286020    reg_loss: 0.545157    l2_loss: 0.021387    loss: 0.852564
steps 10200    v_Prec: 0.584995  v_Recall: 0.689806  v_F1: 0.633092  v_AUC: 0.881663
steps 10200    running time 367 seconds

steps 10400    base_loss: 0.301263    reg_loss: 0.568612    l2_loss: 0.021293    loss: 0.891168
steps 10400    v_Prec: 0.582226  v_Recall: 0.701761  v_F1: 0.636429  v_AUC: 0.880972
steps 10400    running time 374 seconds

steps 10600    base_loss: 0.298587    reg_loss: 0.552256    l2_loss: 0.021362    loss: 0.872205
steps 10600    v_Prec: 0.568406  v_Recall: 0.710927  v_F1: 0.631728  v_AUC: 0.883158
steps 10600    running time 381 seconds

steps 10800    base_loss: 0.292345    reg_loss: 0.537831    l2_loss: 0.021413    loss: 0.851589
steps 10800    v_Prec: 0.584465  v_Recall: 0.689647  v_F1: 0.632714  v_AUC: 0.879657
steps 10800    running time 387 seconds

steps 11000    base_loss: 0.259211    reg_loss: 0.503951    l2_loss: 0.021237    loss: 0.784400
steps 11000    v_Prec: 0.595978  v_Recall: 0.668367  v_F1: 0.630100  v_AUC: 0.876884
steps 11000    running time 394 seconds

steps 11200    base_loss: 0.257080    reg_loss: 0.507353    l2_loss: 0.021306    loss: 0.785739
steps 11200    v_Prec: 0.595228  v_Recall: 0.672033  v_F1: 0.631303  v_AUC: 0.878876
steps 11200    running time 400 seconds

steps 11400    base_loss: 0.256954    reg_loss: 0.496081    l2_loss: 0.021378    loss: 0.774412
steps 11400    v_Prec: 0.538835  v_Recall: 0.742568  v_F1: 0.624506  v_AUC: 0.877749
steps 11400    running time 406 seconds

steps 11600    base_loss: 0.262864    reg_loss: 0.506369    l2_loss: 0.021423    loss: 0.790656
steps 11600    v_Prec: 0.626402  v_Recall: 0.623257  v_F1: 0.624825  v_AUC: 0.876082
steps 11600    running time 413 seconds

steps 11800    base_loss: 0.264906    reg_loss: 0.510486    l2_loss: 0.021325    loss: 0.796716
steps 11800    v_Prec: 0.618420  v_Recall: 0.628278  v_F1: 0.623310  v_AUC: 0.878216
steps 11800    running time 419 seconds

steps 12000    base_loss: 0.266579    reg_loss: 0.515823    l2_loss: 0.021405    loss: 0.803807
steps 12000    v_Prec: 0.543910  v_Recall: 0.737467  v_F1: 0.626070  v_AUC: 0.878552
steps 12000    running time 425 seconds

steps 12200    base_loss: 0.267830    reg_loss: 0.502873    l2_loss: 0.021288    loss: 0.791991
steps 12200    v_Prec: 0.577227  v_Recall: 0.681199  v_F1: 0.624918  v_AUC: 0.876352
steps 12200    running time 431 seconds

steps 12400    base_loss: 0.270619    reg_loss: 0.517617    l2_loss: 0.021324    loss: 0.809560
steps 12400    v_Prec: 0.571001  v_Recall: 0.698653  v_F1: 0.628410  v_AUC: 0.874704
steps 12400    running time 438 seconds

Early stop model F1: 0.636429
testing thre: 0.30666643
testing Prec: 0.38609590596069926
testing Recall: 0.7439125151883353
testing F1: 0.5083529841575609
testing AUC: 0.8201972796954826
overall running time 441 seconds
(0.470829450139795, 0.6138517618469016, 0.5329113924050632, 0.8201972796954826, 0.51876354)

